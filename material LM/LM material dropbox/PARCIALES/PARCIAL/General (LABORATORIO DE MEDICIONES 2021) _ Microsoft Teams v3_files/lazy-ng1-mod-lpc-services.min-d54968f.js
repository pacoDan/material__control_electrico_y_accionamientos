webpackJsonp([19],{2290:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(2291)},2291:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},a=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,a&&(o=2&n[0]?a.return:n[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,n[1])).done)return o;switch(a=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,a=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(o=c.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){c.label=n[1];break}if(6===n[0]&&c.label<o[1]){c.label=o[1],o=n;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(n);break}o[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],a=0}finally{i=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,a,o,s,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var s=n(2292),c=n(92),l=n(318),u=n(2293),p=n(2294),f=n(2295),d=n(2296),h=n(2300),g=function(e){function t(t,n,r,i,a,o,s,c,l,u,p,f,d,h){var g=e.call(this,l)||this;return g.constants=t,g.utilityService=n,g.settingsService=r,g.authenticationService=i,g.sxConfig=a,g.localizationService=o,g.eventingService=s,g.appStateService=c,g.loggingService=u,g.logger=p,g.actionCallbacks=f,g.dataCallbacks=d,g.telemetryCallbacks=h,g.changeTheme=function(e){var t=window.LPC;t&&t.loadTheme(g.getTheme(e))},g.initializeOnAppLaunchAndReinit("First Initialize"),g}return r(t,e),Object.defineProperty(t.prototype,"isLivePersonaCardInitialized",{get:function(){return!(null==this.lpcPromise||null==window.LPC)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLivePersonaCardEnabled",{get:function(){return!!this.settingsService.valueAsBoolean(this.constants.settings.names.enableLivePersonaCard)},enumerable:!0,configurable:!0}),t.prototype.mtmaTelemetryIdentifier=function(){return"LivePersonaCardService"},t.prototype.cleanupOnAppTeardown=function(e){this.logger.log("LivePersonaCardService onAppTeardown: reason = {0}",e),this.lpcPromise=null,window.LPC=null,this.unbsubscribeFromAppStateChanges&&(this.unbsubscribeFromAppStateChanges(),this.unbsubscribeFromAppStateChanges=null)},t.prototype.initializeOnAppLaunchAndReinit=function(e){var t=this;this.logger.log("LivePersonaCardService Initialize reason {0}",e),this.eventingService.unsafeOnWithTenantScope(this.constants.events.layout.themeChanged,function(e,n){t.isLivePersonaCardInitialized&&t.changeTheme(n)}),this.unbsubscribeFromAppStateChanges&&this.unbsubscribeFromAppStateChanges(),this.unbsubscribeFromAppStateChanges=this.eventingService.unsafeOnWithTenantScope(this.constants.events.appState.changed,function(e,n){t.onAppStateChanged(n)})},t.prototype.initializeLPC=function(){return a(this,void 0,void 0,function(){var e,t,n,r,a,c,l,u,p,f,d,h,g,v,m,y,b,C,S,P,T,w;return o(this,function(o){if(this.isLivePersonaCardInitialized)return[2,this.lpcPromise];if(e=this.loggingService.newScenario("LivePersonaCard_Initialize"),t=this.utilityService.generateUUID(),n=this.localizationService.getLocale(),r=this.settingsService.getVersion().clientVersion,a=this.settingsService.valueFor(this.constants.settings.names.lpcComplianceEnvironment),c="Prod"!==a,l=this.settingsService.isInternalRing()&&!c,u=this.authenticationService.getUserTypeInTenant(),p=this.sxConfig.getCurrentSkypeMri(),f=u===teamspace.services.UserTypeInTenant.Guest,d=this.settingsService.valueAsBoolean(this.constants.settings.names.enableTimeZoneInLPC),h=this.settingsService.valueAsBoolean(this.constants.settings.names.enablePronounsInLPC),g=this.settingsService.valueAsBoolean(this.constants.settings.names.enableNextAvailabilityInLPC),v=l&&!f?"df":"",!this.appStateService.isOnline)throw w="App is Offline",e.fail({message:w,clientCorrelationId:t,lpcRegion:v,userTypeInTenant:u}),new Error(w);m=this.getTeamsConfig(t,n,v,a),y=this.settingsService.getRing(),b=this.settingsService.valueAsBoolean(this.constants.settings.names.enableLivePersonaCardV2),C={isLivePersonaCardV2Enabled:b},this.logger.info("Client Correlation ID for LivePersonaCard in Teams Main Window: clientCorrelationId="+t);try{return S=y&&y.id?y.id:void 0,P=r,this.lpcPromise=s.initializeLivePersonaCardAsync(i(i({},m),{actionCallbacks:this.actionCallbacks,dataCallbacks:this.dataCallbacks,telemetryCallbacks:this.telemetryCallbacks,getAuthToken:this.getAuthToken(t),logMessage:function(e,t,n){this.logger.debug("LogType="+e+", LogResultType="+t+", Message="+n)},theme:this.getTheme(this.settingsService.getActiveTheme()),hostAppRing:S,hostAppVersion:P,options:{hostAppRing:S,hostAppVersion:P,isLoggedInAsTeamsGuestUser:f,isTimeZoneEnabled:d,isPronounsEnabled:h,isNextAvailabilityEnabled:g},hostAppConfiguration:C,loggedInUserTeamsMri:p})),T=b?"LPCv2":"LPCv1",this.lpcPromise.then(function(){var n=window.LPC&&window.LPC.version||"";e.stop({message:"LivePersonaCard loaded",version:n,clientCorrelationId:t,lpcRegion:v,userTypeInTenant:u,lpcArchitectureVersion:T})}).catch(function(n){throw e.fail({message:"Could not load LivePersonaCard",clientCorrelationId:t,lpcRegion:v,userTypeInTenant:u,lpcArchitectureVersion:T}),n}),[2,this.lpcPromise]}catch(n){throw w="Could not load live persona card: "+n,e.fail({message:w,clientCorrelationId:t,lpcRegion:v,userTypeInTenant:u}),new Error(w)}return[2]})})},t.prototype.createLPC=function(e,t){var n=t.profile,r=t.behavior,a=t.ariaLabel,o=t.externalAppSessionCorrelationId,s=t.disableAccessibilityDefaults,c=t.tabIndex,u=t.clientScenario,p=t.isSharedChannel,f=t.hostTenantId,d=t.hostConversationId,h=t.isExchangeOnlyContact,g=t.contactId;{if(this.isLivePersonaCardInitialized){var v=l.determineLPCPersonaType(n.role,n.type),m=l.getCleanUpn(n.userPrincipalName),y={personaInfo:{identifiers:{PersonaType:v,AadObjectId:n.objectId,TeamsMri:n.mri,OlsPersonaId:g,HostAppPersonaId:l.serializeHostAppPersonaId({userId:n.mri,isSharedChannel:p,hostTenantId:f,hostConversationId:d,isExchangeOnlyContact:h}),Upn:m,Smtp:n.email},skypeId:n.skypeId},behavior:i({disableHover:!1,locationToOpen:"Card",cardPlacementMode:"AnchorSide"},r),ariaLabel:a,disableAccessibilityDefaults:!!s,tabIndex:c,externalAppSessionCorrelationId:o,clientScenario:u};this.attachHoverTargetAsync(e,y);var b=function(){window.requestIdleCallback&&window.requestIdleCallback(function(){window.LPC&&window.LPC.removedPersonaFromPage(e)})}.bind(this);return{destroy:function(){b()}}}this.logger.error("Not initialized")}},t.prototype.onAppStateChanged=function(e){var t=e.prevState,n=t===teamspace.services.ApplicationState.Offline||t===teamspace.services.ApplicationState.Disconnected||t===teamspace.services.ApplicationState.Disabled;this.appStateService.isOnline&&n&&(s.freeBootstrapperMemory(window),this.initializeLPC())},t.prototype.attachHoverTargetAsync=function(e,t){window.LPC.addedPersonaToPageV2(e,t)},t.prototype.getTheme=function(e){switch(e){case c.LpcTheme.Dark:case c.LpcTheme.DarkV2:return d.darkTheme;case c.LpcTheme.HighContrast:return d.highContrastTheme;case c.LpcTheme.Default:case c.LpcTheme.DefaultV2:default:return d.defaultTheme}},t.prototype.getTeamsConfig=function(e,t,n,r){var i=this.authenticationService.isCurrentUserTFLOrMsaAccount();return{culture:t||window.navigator.language||"en-us",region:n,clientCorrelationId:e,clientType:"MicrosoftTeamsAngular",clientContextType:"Generic",complianceEnvironment:r,options:{isImmersiveProfileEnabled:!1,isLinkedInIntegrationEnabled:!1},isConsumer:i}},t.prototype.getAuthToken=function(e){var t=this;return function(n,r){return a(t,void 0,void 0,function(){var t,i,a,s,c,l,u,p,f,d,h,g,v;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),t=this.constants.settings.names,i=t.lokiTokenResourceUrl,a=t.enableSilentLokiAuthTokenRetrieval,s=this.settingsService.valueAsBoolean(a),[4,this.authenticationService.getAuthTokens([this.settingsService.valueFor(i)],[],s)];case 1:return(c=o.sent())?n(c,e):r("[AuthError] Error retrieving auth token, details: Empty token",e),[3,3];case 2:return l=o.sent(),this.logger.error("Error acquiring access token for LOKI"),u=!1,p="Unexpected Error",f=void 0,l&&(f=_.isString(l)?l:l.authStatus+"-"+l.message,f=f.toLowerCase()),f&&(d=f.includes("retry fetch of adal tokens"),h=f.includes("nativewam:3")||f.includes("tokenrevoked"),g=f.includes("mt_token_expired")||f.includes("receivedexpiredtoken"),v=f.includes("renewaltimeout")||f.includes("token renewal"),u=d||v||g||h,d?p="Retry fetch of ADAL tokens failed":v?p="Token renewal call timed out":h?p="Token revoked":g&&(p="Token expired")),r("[AuthError] Error retrieving auth token, details: "+p,e,u),[3,3];case 3:return[2]}})})}},t}(teamspace.services.MTMABase);t.LivePersonaCardService=g,angular.module("teamspace.lpcService",["teamspace.loggingService","teamspace.authenticationService","teamspace.dialogService","teamspace.utilityService","teamspace.peopleService","teamspace.navigationService","teamspace.conversationsService","teamspace.localizationService","teamspace.eventingService","teamspace.messageService","teamspace.settingsService","teamspace.callingUserActionService","teamspace.presenceManagerService","teamspace.htmlSanitizer","teamspace.dateFormatService","teamspace.platformDetectService"]).factory("lpcService",["constants","callingPolicyStore","messagingPolicySettingsStore","utilityService","settingsService","loggingService","authenticationService","$rootScope","navigationService","conversationsService","localizationService","eventingService","messageService","peopleService","dialogService","callingUserActionService","presenceManagerService","htmlSanitizer","dateFormatService","presenceService","$translate","resources","timeagoCalcService","platformDetectService","profilePictureLoaderService","orchestrationService","analyticsService","callBlockingService","appStateService","sxConfig","flatContactListService","telemetryProvider",function(e,t,n,r,i,a,o,s,c,l,d,v,m,y,b,C,S,P,T,w,k,A,I,L,O,x,E,M,U,_,j,F){var D=a.newLogger("LivePersonaCardService"),N=new h.LpcTelemetryHelper(E,a,l),R=N.logPanelActionEvent.bind(N),B=o.getUserTypeInTenant(),G=u.LPCActionCallbackFactory(s,e,D,y,l,o,c,C,m,M,b,i,R),H=p.LPCDataCallbackFactory(D,l,S,y,r,P,T,i,e,w,k,A,I,L,d,O,M,t,n,B,_,o,j),z=i.valueAsBoolean(e.settings.names.enableLpcSecondPartyTelemetry)?f.LPCTelemetryCallbackFactory(F):void 0;return new g(e,r,i,o,_,d,v,U,x,a,D,G,H,z)}])},2292:function(e,t,n){!function(t,n){e.exports=n()}(window,function(){return function(e){function t(t){for(var n,r,a=t[0],o=t[1],s=0,l=[];s<a.length;s++)r=a[s],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&l.push(i[r][0]),i[r]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(c&&c(t);l.length;)l.shift()()}function n(t){if(r[t])return r[t].exports;var i=r[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,n),i.l=!0,i.exports}var r={},i={1:0};n.e=function(e){var t=[],r=i[e];if(0!==r)if(r)t.push(r[2]);else{var a=new Promise(function(t,n){r=i[e]=[t,n]});t.push(r[2]=a);var o,s=document.createElement("script");s.charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.src=function(e){return n.p+""+({0:"loggingdependencies",2:"vendors~loggingdependencies"}[e]||e)+"_"+{0:"1ce2ea2bbd5eceb043b3",2:"58a9bd5d70dd9db494af"}[e]+".js"}(e),0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous");var c=new Error;o=function(t){s.onerror=s.onload=null,clearTimeout(l);var n=i[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+r+": "+a+")",c.name="ChunkLoadError",c.type=r,c.request=a,n[1](c)}i[e]=void 0}};var l=setTimeout(function(){o({type:"timeout",target:s})},12e4);s.onerror=s.onload=o,document.head.appendChild(s)}return Promise.all(t)},n.m=e,n.c=r,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="https://res-1.cdn.office.net/midgard/versionless/",n.oe=function(e){throw console.error(e),e};var a=window.webpackJsonpMidgardBootstrapper=window.webpackJsonpMidgardBootstrapper||[],o=a.push.bind(a);a.push=t,a=a.slice();for(var s=0;s<a.length;s++)t(a[s]);var c=o;return n(n.s=13)}([function(e,t,n){"use strict";t.a={START:"Start",SUCCESS:"Success",EXPECTED_FAILURE:"ExpectedFailure",UNEXPECTED_FAILURE:"UnexpectedFailure",MONITOR_IN_INVALID_STATE:"MonitorInInvalidState"}},function(e,t,n){"use strict";var r=n(2),i="object"==typeof self&&self&&self.Object===Object&&self,a=r.a||i||Function("return this")();t.a=a},function(e,t,n){"use strict";(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.a=n}).call(this,n(12))},function(e,t,n){"use strict";function r(e){return e}n.d(t,"a",function(){return r})},function(e,t,n){"use strict";function r(e){return a.indexOf(e)>-1}function i(e){return-1===o.indexOf(e)}n.d(t,"b",function(){return r}),n.d(t,"a",function(){return i});var a=["Network","RESTAuthToken","TTLCacheUtils","BundleDownload","OfficeFeedIsReadyStatus","OfficeFeedVerbose"],o=["Stikkontakt","DataLoadStartAction","NoLogging","None"]},function(e,t,n){"use strict";t.a={CLIENT_TIMESTAMP:"ClientTimeStamp",TRANSACTION_ID:"QoSTransactionId",SOURCE_CORRELATION_ID:"SourceCorrelationId"}},function(e,n,r){"use strict";(function(e){var i=r(2),a="object"==typeof t&&t&&!t.nodeType&&t,o=a&&"object"==typeof e&&e&&!e.nodeType&&e,s=o&&o.exports===a&&i.a.process,c=function(){try{return o&&o.require&&o.require("util").types||s&&s.binding&&s.binding("util")}catch(e){}}();n.a=c}).call(this,r(9)(e))},function(e,t,n){"use strict";function r(e,t){return e.hasOwnProperty(t)}n.d(t,"a",function(){return r});var i,a=n(1),o=a.a.Symbol,s=Object.prototype,c=s.hasOwnProperty,l=s.toString,u=o?o.toStringTag:void 0,p=function(e){var t=c.call(e,u),n=e[u];try{e[u]=void 0;var r=!0}catch(e){}var i=l.call(e);return r&&(t?e[u]=n:delete e[u]),i},f=Object.prototype.toString,d=function(e){return f.call(e)},h=o?o.toStringTag:void 0,g=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":h&&h in Object(e)?p(e):d(e)},v=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},m=function(e){if(!v(e))return!1;var t=g(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},y=a.a["__core-js_shared__"],b=(i=/[^.]+$/.exec(y&&y.keys&&y.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"",C=function(e){return!!b&&b in e},S=Function.prototype.toString,P=function(e){if(null!=e){try{return S.call(e)}catch(e){}try{return e+""}catch(e){}}return""},T=/^\[object .+?Constructor\]$/,w=Function.prototype,k=Object.prototype,A=w.toString,I=k.hasOwnProperty,L=RegExp("^"+A.call(I).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),O=function(e){return!(!v(e)||C(e))&&(m(e)?L:T).test(P(e))},x=function(e,t){return null==e?void 0:e[t]},E=function(e,t){var n=x(e,t);return O(n)?n:void 0},M=function(){try{var e=E(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),U=function(e,t,n){"__proto__"==t&&M?M(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n},_=function(e,t){return e===t||e!=e&&t!=t},j=Object.prototype.hasOwnProperty,F=function(e,t,n){var r=e[t];j.call(e,t)&&_(r,n)&&(void 0!==n||t in e)||U(e,t,n)},D=function(e,t,n,r){var i=!n;n||(n={});for(var a=-1,o=t.length;++a<o;){var s=t[a],c=r?r(n[s],e[s],s,n,e):void 0;void 0===c&&(c=e[s]),i?U(n,s,c):F(n,s,c)}return n},N=function(e){return e},R=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)},B=Math.max,G=function(e,t,n){return t=B(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,a=B(r.length-t,0),o=Array(a);++i<a;)o[i]=r[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=r[i];return s[t]=n(o),R(e,this,s)}},H=function(e){return function(){return e}},z=M?function(e,t){return M(e,"toString",{configurable:!0,enumerable:!1,value:H(t),writable:!0})}:N,X=Date.now,V=function(e){var t=0,n=0;return function(){var r=X(),i=16-(r-n);if(n=r,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(z),W=function(e,t){return V(G(e,t,N),e+"")},q=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},Q=function(e){return null!=e&&q(e.length)&&!m(e)},J=/^(?:0|[1-9]\d*)$/,K=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&J.test(e))&&e>-1&&e%1==0&&e<t},$=function(e,t,n){if(!v(n))return!1;var r=typeof t;return!!("number"==r?Q(n)&&K(t,n.length):"string"==r&&t in n)&&_(n[t],e)},Z=Object.prototype,Y=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Z)},ee=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r},te=function(e){return null!=e&&"object"==typeof e},ne=function(e){return te(e)&&"[object Arguments]"==g(e)},re=Object.prototype,ie=re.hasOwnProperty,ae=re.propertyIsEnumerable,oe=ne(function(){return arguments}())?ne:function(e){return te(e)&&ie.call(e,"callee")&&!ae.call(e,"callee")},se=Array.isArray,ce=n(10),le={};le["[object Float32Array]"]=le["[object Float64Array]"]=le["[object Int8Array]"]=le["[object Int16Array]"]=le["[object Int32Array]"]=le["[object Uint8Array]"]=le["[object Uint8ClampedArray]"]=le["[object Uint16Array]"]=le["[object Uint32Array]"]=!0,le["[object Arguments]"]=le["[object Array]"]=le["[object ArrayBuffer]"]=le["[object Boolean]"]=le["[object DataView]"]=le["[object Date]"]=le["[object Error]"]=le["[object Function]"]=le["[object Map]"]=le["[object Number]"]=le["[object Object]"]=le["[object RegExp]"]=le["[object Set]"]=le["[object String]"]=le["[object WeakMap]"]=!1;var ue=n(6),pe=ue.a&&ue.a.isTypedArray,fe=pe?function(e){return function(t){return e(t)}}(pe):function(e){return te(e)&&q(e.length)&&!!le[g(e)]},de=Object.prototype.hasOwnProperty,he=function(e,t){var n=se(e),r=!n&&oe(e),i=!n&&!r&&Object(ce.a)(e),a=!n&&!r&&!i&&fe(e),o=n||r||i||a,s=o?ee(e.length,String):[],c=s.length;for(var l in e)!t&&!de.call(e,l)||o&&("length"==l||i&&("offset"==l||"parent"==l)||a&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||K(l,c))||s.push(l);return s},ge=function(e,t){return function(n){return e(t(n))}}(Object.keys,Object),ve=Object.prototype.hasOwnProperty,me=function(e){if(!Y(e))return ge(e);var t=[];for(var n in Object(e))ve.call(e,n)&&"constructor"!=n&&t.push(n);return t},ye=function(e){return Q(e)?he(e):me(e)},be=Object.prototype.hasOwnProperty;!function(e){W(function(t,n){var r=-1,i=n.length,a=i>1?n[i-1]:void 0,o=i>2?n[2]:void 0;for(a=e.length>3&&"function"==typeof a?(i--,a):void 0,o&&$(n[0],n[1],o)&&(a=i<3?void 0:a,i=1),t=Object(t);++r<i;){var s=n[r];s&&e(t,s,r,a)}return t})}(function(e,t){if(Y(t)||Q(t))D(t,ye(t),e);else for(var n in t)be.call(t,n)&&F(e,n,t[n])})},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r="Unknown"},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,n,r){"use strict";(function(e){var i=r(1),a=r(11),o="object"==typeof t&&t&&!t.nodeType&&t,s=o&&"object"==typeof e&&e&&!e.nodeType&&e,c=s&&s.exports===o?i.a.Buffer:void 0,l=(c?c.isBuffer:void 0)||a.a;n.a=l}).call(this,r(9)(e))},function(e,t,n){"use strict";t.a=function(){return!1}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";function r(e,t,n){try{n.sessionStorage&&n.sessionStorage.setItem&&n.sessionStorage.setItem(e,t)}catch(e){}}function i(e,t,n){return new Promise(function(i,a){e?(r(U,e,n),i(e)):t(function(e,t){e?(r(U,e,n),i(e)):a(new M("GetAuthTokenError","Auth token is undefined",t))},function(e,t,n){var r=function(e,t){var n=/^AADSTS\d+?:/.test(e),r=function(e,t){if(t&&e){if(e.indexOf("3399942148"))return!0;if(e.indexOf("3399942154"))return!0;if(e.indexOf("nativeWam:3"))return!0}return!1}(e,t);return n||r}(e,n)?e:"";a(new M("GetAuthTokenError",r,t,n))})})}function a(e,t){var n=function(e){return"df"===e?x.Dogfood:"msit"===e?x.MSIT:void 0}(e);return n||(n=function(e){switch(e){case"Df":return x.Dogfood;case"Msit":return x.MSIT;case"Blackforest":return x.Blackforest;case"GccModerate":return x.GccModerate;case"GccHigh":return x.GccHigh;case"DoD":return x.DOD;case"Gallatin":return x.Gallatin;case"Prod":return x.TopLevel;case"AG08":return x.AG08;case"AG09":return x.AG09;case"Unknown":throw new Error("'Unknown' is not an expected environment type in Loki");default:return Object(_.a)(e)}}(t)),n}function o(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t.location.search),r=t.decodeURIComponent||window.decodeURIComponent;return null===n?"":r&&r(n[1].replace(/\+/g," "))||""}function s(e,t,n){return l(function(e,t){var n=t||e.culture,r=a(e.region,e.complianceEnvironment);return D.replace("{0}",r).replace("{1}",n)}(t,o(z,n)),e,B(B({},t),{clientFeature:"LivePersonaCard"}),n)}function c(e,t,n){return l(function(e,t){var n=t||e.culture,r=a(e.region,e.complianceEnvironment);return N.replace("{0}",r).replace("{1}",n)}(t,o(q,n)),e,B(B({},t),{clientFeature:"LivePersonaEditor"}),n)}function l(e,t,n,r){return new Promise(function(i,a){var s=new XMLHttpRequest;s.open("GET",e,!0),s.setRequestHeader("Authorization","Bearer "+t),s.setRequestHeader("Accept","application/json");var c=R.replace(/[xy]/g,function(e){var t;if(window.crypto){var n=new Uint8Array(1);window.crypto.getRandomValues(n),t=n[0]}else t=Math.floor(16*Math.random());return("x"===e?t%16:t%4+8).toString(16)});s.setRequestHeader("X-RootCorrelationId",c),s.setRequestHeader("X-CorrelationId",c),s.setRequestHeader("X-ClientCorrelationId",n.clientCorrelationId),s.setRequestHeader("X-ClientFeature",n.clientFeature);var l=o(J,r)||n.clientType;l&&s.setRequestHeader("X-ClientType",l),n.hostAppRing&&s.setRequestHeader("X-HostAppRing",n.hostAppRing),n.hostAppVersion&&s.setRequestHeader("X-HostAppVersion",n.hostAppVersion),n.hostAppConfiguration&&s.setRequestHeader("X-HostAppConfiguration",JSON.stringify(n.hostAppConfiguration));var u=o(W,r);if(u){var p={};u.split(";").forEach(function(e){var t=e.split(":"),n=t[0],r=t[1];p[n]=r}),s.setRequestHeader(W,JSON.stringify(p))}r&&r.React&&r.React.version&&r.ReactDOM&&s.setRequestHeader("X-HostAppReactVersion",r.React.version);var f=o(X,r)||o(H,r);f&&(s.setRequestHeader(H,f),s.setRequestHeader(X,f));var d=o(Q,r);d&&s.setRequestHeader("X-"+Q,d);var h=o(V,r);h&&(s.setRequestHeader(V,h),s.setRequestHeader("X-"+V,h)),s.addEventListener("load",function(){if(200===s.status)try{var e=JSON.parse(s.response);e.RootCorrelationId=c,e.LokiVersion=s.getResponseHeader("x-serverversion")||"",i(e)}catch(e){a(new M("GetLokiConfigError","Failed to parse initialization config.",c))}else a(new M("GetLokiConfigError","Couldn't retrieve initialization config. Status code is "+s.status,c,!1,s.status))}),s.addEventListener("error",function(){a(new M("GetLokiConfigError","Couldn't retrieve initialization config, request failed to complete.",c))}),s.addEventListener("timeout",function(){a(new M("GetLokiConfigError","Loki config request timed out after "+G+" ms.",c))}),s.timeout=G,s.send()})}function u(e){var t=e.targetWindow||window,n=ne.get(t);return n?n.bootstrapperConfig=te(te({},n.bootstrapperConfig),e):n={bootstrapperConfig:te(te({},e),{targetWindow:t}),ariaLogger:new ee(e),initializationPromise:void 0,lpeInitializationPromise:void 0,forceRefreshInitializationPromise:!1,forceRefreshLpeInitializationPromise:!1,forceRefreshInitializationTimeout:void 0},ne.set(t,n),n}function p(e,t,n){return re(this,void 0,void 0,function(){var r,i;return ie(this,function(a){switch(a.label){case 0:return(i=u(t)).lpcConfig?(r=i.lpcConfig,[3,3]):[3,1];case 1:return[4,f(e,t,n)];case 2:r=a.sent(),i.lpcConfig=r,a.label=3;case 3:return[2,r]}})})}function f(e,t,n){return re(this,void 0,void 0,function(){var r,a;return ie(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,8]),[4,s(e,t,n)];case 1:return r=o.sent(),[3,8];case 2:return(a=o.sent()).statusCode&&401===a.statusCode?[4,i(void 0,t.getAuthToken,n)]:[3,4];case 3:e=o.sent(),o.label=4;case 4:return oe<ae?(oe++,[4,f(e,t,n)]):[3,6];case 5:return r=o.sent(),[3,7];case 6:throw a.numberOfRetries=oe,a;case 7:return[3,8];case 8:return[2,r]}})})}function d(e,t){var n=this,r=0,i=function(e,t){return se(n,void 0,void 0,function(){var n;return ce(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,6]),[4,h(e,t)];case 1:return a.sent(),[3,6];case 2:return n=a.sent(),r<le?(r++,[4,i(e,t)]):[3,4];case 3:return a.sent(),[3,5];case 4:throw n.numberOfRetries=r,n;case 5:return[3,6];case 6:return[2]}})})};return i(e,t)}function h(e,t){return new Promise(function(n,r){var i=t.document.createElement("script");i.type="text/javascript",i.charset="utf-8",i.crossOrigin="anonymous",i.src=e,i.addEventListener("load",function(){n()}),i.addEventListener("error",function(){r(new M("LoadScriptError","Unexpected error while loading script on page."))}),t.document.body.appendChild(i)})}function g(e,t){var n=e.ResourceUrls||[];if(0===n.length){var r=e.Resources[fe],i=e.Resources[ue];"OwaPeopleHub"===e.Workload&&(i=e.Resources[pe]),n=[r,i]}return Promise.all(n.map(function(e){return d(e,t)})).then(function(){return n})}function v(e,t){var n=t.targetWindow;return new Promise(function(r,i){setTimeout(function(){try{n.LPC||i(new M("StartLivePersonaCardError","targetWindow.LPC is undefined.")),n.LivePersonaCardStrings&&n.LivePersonaCardStrings.strings||n.LivePersonaCardStringsLpcMini&&n.LivePersonaCardStringsLpcMini.strings||i(new M("StartLivePersonaCardError","targetWindow.LivePersonaCardStrings is undefined."));var a=function(e,t){var n=t.targetWindow;return{refreshAuthToken:(r=t.getAuthToken,function(e){r(function(t,n){e(t,"",n,void 0)},function(t,n){e("",t,n,void 0)})}),logToExternalApplication:t.logMessage,contextType:t.clientContextType,strings:n.LivePersonaCardStringsLpcMini&&n.LivePersonaCardStringsLpcMini.strings||n.LivePersonaCardStrings&&n.LivePersonaCardStrings.strings,source:t.clientType,consumerCorrelationId:t.clientCorrelationId,activeFlights:e.Flights,isDebug:!1,culture:t.culture,dataCallbacks:t.dataCallbacks,actionCallbacks:t.actionCallbacks,telemetryCallbacks:t.telemetryCallbacks,dataUpdateBroadcaster:t.dataUpdateBroadcaster,privateDataCallbacks:t.privateDataCallbacks,options:t.options?t.options:{hideDocumentFilter:!1},theme:t.theme,lokiUrl:e.LokiUrl,lokiVersion:e.LokiVersion,tenantAadObjectId:e.TenantAadObjectId,userAadObjectId:e.UserAadObjectId,userPuid:e.UserPuid,ecsConfigIds:e.EcsConfigIds,ecsETag:e.EcsEtag,loggedInUserUpn:e.Upn,loggedInUserTeamsMri:t.loggedInUserTeamsMri,complianceEnvironment:t.complianceEnvironment,userDisplayName:e.UserDisplayName};var r}(e,t);n.LPC.start(a),r()}catch(e){i(new M("StartLivePersonaCardError",e.name))}},0)})}function m(e){switch(e.complianceEnvironment){case"Blackforest":return he;case"GccHigh":return ge;case"DoD":return ve;case"Gallatin":return me;case"AG08":return ye;case"AG09":return be;case"GccModerate":case"Prod":default:return de}}function y(e){return{ErrorType:e.name,ErrorMessage:e.message||"",RootCorrelationId:e.rootCorrelationId||"",IsExpected:e.isExpected||!1,IsClientOnline:navigator&&void 0!==typeof navigator.onLine?navigator.onLine:""}}function b(e){var t={};return Object.keys(e).forEach(function(n){t["Perf_"+n]=e[n].toString()}),t}function C(e){return void 0===e||"string"!=typeof e||""===e||null===e}function S(e){return void 0===e||"function"!=typeof e}function P(e){var t="";if(e){var n=[];C(e.culture)&&n.push("culture"),C(e.clientType)&&n.push("clientType"),C(e.clientContextType)&&n.push("clientContextType"),C(e.clientCorrelationId)&&n.push("clientCorrelationId"),S(e.logMessage)&&n.push("logMessage"),S(e.getAuthToken)&&n.push("getAuthToken"),n.length>0&&(t="Invalid required parameter(s): "+n.join(", ")+". Check the values and types you're passing. "),e.region&&-1===Se.indexOf(e.region.toLowerCase().trim())&&(t+="Invalid region value. Allowed values are: empty string for production environments, and "+Se.join(", ")+" for pre-production environments. "),-1===Pe.indexOf(e.complianceEnvironment)&&(t+="Environment is missing or wrong. Allowed values are: "+Pe.join(", ")+". We currently don't support other Sovereign Clouds.")}else t="Config must be defined.";if(t)throw new M("ValidateBootstrapperConfigError",t)}function T(e,t,n){return Te(this,void 0,void 0,function(){var r,i;return we(this,function(a){switch(a.label){case 0:return(i=u(t)).lpeConfig?(r=i.lpeConfig,[3,3]):[3,1];case 1:return[4,w(e,t,n)];case 2:r=a.sent(),i.lpeConfig=r,a.label=3;case 3:return[2,r]}})})}function w(e,t,n){return Te(this,void 0,void 0,function(){var r,a;return we(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,8]),[4,c(e,t,n)];case 1:return r=o.sent(),[3,8];case 2:return(a=o.sent()).statusCode&&401===a.statusCode?[4,i(void 0,t.getAuthToken,n)]:[3,4];case 3:e=o.sent(),o.label=4;case 4:return Ae<ke?(Ae++,[4,T(e,t,n)]):[3,6];case 5:return r=o.sent(),[3,7];case 6:throw a.numberOfRetries=Ae,a;case 7:return[3,8];case 8:return[2,r]}})})}function k(e,t){if(-1===e.Flights.indexOf(xe))return Promise.reject(new M("LoadLivePersonaEditorScriptError","LPE not enabled",e.RootCorrelationId));var n=[e.Resources[Oe],e.Flights.indexOf(Ee)>-1?e.Resources[Ie]:e.Resources[Le]];return Promise.all(n.map(function(e){return d(e,t)})).then(function(){return n})}function A(e){return Ue(this,void 0,void 0,function(){var t,n,r,a=this;return _e(this,function(o){return t=new Ce(window),n=u(e),r=function(){return u(e).ariaLogger},!n.forceRefreshLpeInitializationPromise&&n.lpeInitializationPromise?[2,n.lpeInitializationPromise]:(n.lpeInitializationPromise=new Promise(function(n,o){return Ue(a,void 0,void 0,function(){var a,s,c,l,u,p;return _e(this,function(f){switch(f.label){case 0:a=m(e),f.label=1;case 1:return f.trys.push([1,6,,7]),P(e),t.startCustomTiming(F.getAuthToken),[4,i(e.authToken,e.getAuthToken,window)];case 2:return s=f.sent(),t.endCustomTiming(F.getAuthToken),t.measureFromStart(F.getAuthTokenFromStart),t.startCustomTiming(F.getLokiConfig),[4,T(s,e,window)];case 3:return c=f.sent(),t.endCustomTiming(F.getLokiConfig),t.measureFromStart(F.getLokiConfigFromStart),t.startCustomTiming(F.getLpeBundles),[4,k(c,window)];case 4:return f.sent(),t.endCustomTiming(F.getLpeBundles),t.measureFromStart(F.getLpeBundlesFromStart),[4,r().updateContextWithLokiDataAsync(c,a).catch(function(){console.log("Live Persona Editor ERROR: Bootstrapper failed to initialize Aria, continuing without.")})];case 5:return f.sent(),(l=b(t.getAllTimings())).RootCorrelationId=c.RootCorrelationId,l.isConsumer=e.isConsumer,r().logEventAsync({name:"initializeLivePersonaEditor_success",properties:l},a),n(c),[3,7];case 6:return u=f.sent(),p=b(t.getAllTimings()),r().logEventAsync({name:"initializeLivePersonaEditor_failure",properties:Me(Me(Me({},y(u)),p),{isConsumer:e.isConsumer})},a),o("Failed to initialize Live Persona Editor: "+u.name+" "+u.message),[3,7];case 7:return[2]}})})}),n.lpeInitializationPromise.catch(function(){setTimeout(function(){n.forceRefreshLpeInitializationPromise=!0},E)}),[2,n.lpeInitializationPromise])})})}function I(e){return Fe(this,void 0,void 0,function(){var t,n,r,a,o=this;return De(this,function(s){return t=u(e),n=function(){return u(e).ariaLogger},!t.forceRefreshInitializationPromise&&t.initializationPromise?[2,t.initializationPromise]:(r=t.bootstrapperConfig.targetWindow,a=new Ce(r),t.forceRefreshInitializationPromise=!1,t.initializationPromise=new Promise(function(s,c){return Fe(o,void 0,void 0,function(){var o,l,u,f,d,h;return De(this,function(C){switch(C.label){case 0:o=m(e),C.label=1;case 1:return C.trys.push([1,7,,8]),P(e),a.startCustomTiming(F.getAuthToken),[4,i(e.authToken,e.getAuthToken,r)];case 2:return l=C.sent(),a.endCustomTiming(F.getAuthToken),a.measureFromStart(F.getAuthTokenFromStart),a.startCustomTiming(F.getLokiConfig),[4,p(l,e,r)];case 3:return u=C.sent(),a.endCustomTiming(F.getLokiConfig),a.measureFromStart(F.getLokiConfigFromStart),a.startCustomTiming(F.getLpcBundles),[4,g(u,r)];case 4:return C.sent(),a.endCustomTiming(F.getLpcBundles),a.measureFromStart(F.getLpcBundlesFromStart),a.startCustomTiming(F.startLpc),[4,v(u,t.bootstrapperConfig)];case 5:return C.sent(),a.endCustomTiming(F.startLpc),a.measureFromStart(F.startLpcFromStart),[4,n().updateContextWithLokiDataAsync(u,o).catch(function(){console.log("Live Persona Card ERROR: Bootstrapper failed to initialize Aria, continuing without.")})];case 6:return C.sent(),(f=b(a.getAllTimings())).RootCorrelationId=u.RootCorrelationId,f.isConsumer=e.isConsumer,n().logEventAsync({name:"initializeLivePersonaCard_success",properties:f},o),s(),[3,8];case 7:return d=C.sent(),h=b(a.getAllTimings()),n().logEventAsync({name:"initializeLivePersonaCard_failure",properties:je(je(je({},y(d)),h),{isConsumer:e.isConsumer})},o),c("Failed to initialize Live Persona Card: "+d.name+" "+d.message),[3,8];case 8:return[2]}})})}),t.initializationPromise.catch(function(){t.forceRefreshInitializationTimeout=window.setTimeout(function(){t&&(t.forceRefreshInitializationPromise=!0)},E)}),[2,t.initializationPromise])})})}function L(e){!function(e){var t=ne.get(e);if(t){var n=t.bootstrapperConfig.targetWindow;n&&(delete n.LPC,delete n.LivePersonaCardHoverTarget,delete n.LivePersonaCardHoverTargetV2,delete n.LivePersonaCardStrings,delete n.LivePersonaCardStringsLpcMini,delete n.MeetingInsightsV2,delete n.MidgardBootstrapper,delete n.PersonaInsightRing,delete n.LPE),delete t.bootstrapperConfig.targetWindow,delete t.ariaLogger,delete t.initializationPromise,delete t.bootstrapperConfig,clearTimeout(t.forceRefreshInitializationTimeout)}ne.delete(e)}(e)}function O(e){return Fe(this,void 0,void 0,function(){var t;return De(this,function(n){switch(n.label){case 0:return t=u(e),[4,i(e.authToken,e.getAuthToken,t.bootstrapperConfig.targetWindow)];case 1:return[2,p(n.sent(),e,t.bootstrapperConfig.targetWindow)]}})})}n.r(t),n.d(t,"initializeLivePersonaEditorAsync",function(){return A}),n.d(t,"initializeLivePersonaCardAsync",function(){return I}),n.d(t,"freeBootstrapperMemory",function(){return L}),n.d(t,"fetchLokiConfigAsync",function(){return O});var x,E=3e5,M=function(e,t,n,r,i,a){this.name=e,this.message=t,this.rootCorrelationId=n,this.isExpected=r,this.statusCode=i,this.numberOfRetries=a},U="LokiAuthToken",_=n(3);!function(e){e.TopLevel="https://loki.delve.office.com",e.Blackforest="https://loki.delve.office.de",e.GccModerate="https://gcc.loki.delve.office.com",e.GccHigh="https://gcchigh.loki.office365.us",e.DOD="https://dod.loki.office365.us",e.Gallatin="https://loki.office365.cn",e.Dogfood="https://df.loki.delve.office.com",e.LegacyDogfood="https://sfdf.loki.delve.office.com",e.MSIT="https://msit.loki.delve.office.com",e.LegacyMSIT="https://sfmsit.loki.delve.office.com",e.AG08="https://loki.officenet.eaglex.ic.gov",e.AG09="https://loki.officenet.microsoft.scloud"}(x||(x={}));var j,F,D="{0}/api/v1/livepersonacard/configuration?cultureName={1}",N="{0}/api/v1/livepersonaeditor/configuration?cultureName={1}",R="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",B=function(){return(B=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},G=6e4,H="LivePersonaCardVersionOverride",z="LivePersonaCardCultureOverride",X="MidgardVersion",V="MidgardBranch",W="HostAppConfiguration",q="LivePersonaEditorCultureOverride",Q="LivePersonaEditorVersionOverride",J="ClientTypeOverride",K=(n(17),function(){return Promise.all([n.e(2),n.e(0)]).then(n.bind(null,52))}),$=function(){return K().then(function(e){return e.AWTLogManager})},Z=(j=function(){return K().then(function(e){return e.Logger})},function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((r=r.apply(e,t||[])).next())})}),Y=function(e,t){function n(n){return function(o){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,o])}}var r,i,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},ee=function(){function e(e){this.bootstrapperConfig=e,this.loggers=new Map}return e.prototype.logEventAsync=function(e,t){return Z(this,void 0,void 0,function(){return Y(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,this.getLoggerAsync(t)];case 1:return n.sent().logEvent(e),[4,$()];case 2:return n.sent().flush(this.noOp),[3,4];case 3:return n.sent(),console.log("Live Persona Card ERROR: Failed to log an event to Aria"),[3,4];case 4:return[2]}})})},e.prototype.updateContextWithLokiDataAsync=function(e,t){return Z(this,void 0,void 0,function(){var n;return Y(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.getLoggerAsync(t)];case 1:return(n=r.sent()).setContext("LokiUrl",e.LokiUrl),n.setContext("tenantAadObjectId",e.TenantAadObjectId),n.setContext("userAadObjectId",e.UserAadObjectId),n.setContext("userPuid",e.UserPuid),n.setContext("flights",e.Flights.join(",")),n.setContext("settings",JSON.stringify(e.Settings)),[3,3];case 2:throw r.sent(),new Error("Live Persona Card ERROR: Failed to update Aria's context");case 3:return[2]}})})},e.prototype.getLoggerAsync=function(e){return Z(this,void 0,void 0,function(){var t,n,r;return Y(this,function(i){switch(i.label){case 0:return(t=this.loggers.get(e))?[3,3]:[4,$()];case 1:return n=i.sent(),[4,this.getCollectorUrlAsync()];case 2:r=i.sent(),(t=n.initialize(e,{collectorUri:r,disableCookiesUsage:!0}))||(t=n.getLogger(e)),this.loggers.set(e,t),t.setContext("culture",this.bootstrapperConfig.culture),t.setContext("region",this.bootstrapperConfig.region),t.setContext("clientType",this.bootstrapperConfig.clientType),t.setContext("clientContextType",this.bootstrapperConfig.clientContextType),t.setContext("clientCorrelationId",this.bootstrapperConfig.clientCorrelationId),t.setContext("bootstrapperVersion","1.20210906.6.0"),t.setContext("complianceEnvironment",this.bootstrapperConfig.complianceEnvironment),i.label=3;case 3:return[2,t]}})})},e.prototype.getCollectorUrlAsync=function(){return Z(this,void 0,void 0,function(){return Y(this,function(e){switch(this.bootstrapperConfig.complianceEnvironment){case"Blackforest":return[2,"https://de.pipe.aria.microsoft.com/Collector/3.0/"];case"GccHigh":return[2,"https://tb.pipe.aria.microsoft.com/Collector/3.0"];case"DoD":return[2,"https://pf.pipe.aria.microsoft.com/Collector/3.0"];case"AG08":case"AG09":return[2,""];case"Gallatin":case"GccModerate":case"Prod":default:return[2,void 0]}return[2]})})},e.prototype.noOp=function(){},e}(),te=function(){return(te=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},ne=new WeakMap,re=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((r=r.apply(e,t||[])).next())})},ie=function(e,t){function n(n){return function(o){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,o])}}var r,i,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},ae=2,oe=0,se=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((r=r.apply(e,t||[])).next())})},ce=function(e,t){function n(n){return function(o){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,o])}}var r,i,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},le=2,ue="livepersonacard_with-react",pe="livepersonacard_without-react",fe="livepersonacardstrings",de="e5ad760145754ffc9704e67c800087f2-dc72ff20-3e8a-401a-b9a8-ec72e4dd3e22-7257",he="e5ad760145754ffc9704e67c800087f2-fe4f92a6-9453-4f06-a3f9-52484ba9c6a1-7193",ge="e5ad760145754ffc9704e67c800087f2-5eda57b1-3b30-42c8-a461-bf3c6ee769d8-7057",ve="e5ad760145754ffc9704e67c800087f2-e57f210b-942a-4f32-aaa3-2fd7b8d44a62-7359",me="e5ad760145754ffc9704e67c800087f2-e2685720-0f91-4c64-acd6-32359f3b1c29-6998",ye="",be="";!function(e){e.getAuthToken="GetAuthTokenDuration",e.getAuthTokenFromStart="GetAuthTokenFromStartDuration",e.getLokiConfig="GetLokiConfigDuration",e.getLokiConfigFromStart="GetLokiConfigFromStartDuration",e.getLpcBundles="GetLpcBundlesDuration",e.getLpcBundlesFromStart="GetLpcBundlesFromStartDuration",e.startLpc="StartLpcDuration",e.startLpcFromStart="StartLpcFromStartDuration",e.getLpeBundles="GetLpeBundlesDuration",e.getLpeBundlesFromStart="GetLpeBundlesFromStartDuration"}(F||(F={}));var Ce=function(){function e(e){this.targetWindow=e,this.start=this.getCurrentTime(),this.timings={}}return e.prototype.measureFromStart=function(e){this.timings[e]=Math.round(this.getCurrentTime()-this.start)},e.prototype.startCustomTiming=function(e){try{this.targetWindow.performance.mark(e+"-start")}catch(e){}},e.prototype.endCustomTiming=function(e){try{this.targetWindow.performance.mark(e+"-end"),this.targetWindow.performance.measure(e,e+"-start",e+"-end");var t=this.targetWindow.performance.getEntriesByName(e)[0];this.timings[e]=Math.round(t.duration)}catch(e){}},e.prototype.getAllTimings=function(){var e=this;try{var t=this.targetWindow.performance.getEntriesByType("resource");t&&t.forEach(function(t){if(t&&t.name){var n=t.name.toLowerCase(),r=!1;-1!==n.indexOf("authtoken/loki")?(n="AuthRequestDuration",r=!0):-1!==n.indexOf("service.svc?action=getclientaccesstoken&ep=1&app=mail")?(n="AuthRequestDuration",r=!0):-1!==n.indexOf("/lpc/versionless/livepersonacard_")?(n="LpcBundleRequestDuration",r=!0):-1!==n.indexOf("/lpc/versionless/livepersonacardstrings")?(n="LpcStringsRequestDuration",r=!0):-1!==n.indexOf("/api/v1/configuration/")&&(n="InitConfigRequestDuration",r=!0),r&&(e.timings[n]=Math.round(t.duration))}})}catch(e){}return this.timings},e.prototype.getCurrentTime=function(){return this.targetWindow.performance&&"function"==typeof this.targetWindow.performance.now?performance.now():Date.now()},e}(),Se=["msit","df","ppe"],Pe=["Prod","Blackforest","GccModerate","GccHigh","DoD","Gallatin","AG08","AG09"],Te=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((r=r.apply(e,t||[])).next())})},we=function(e,t){function n(n){return function(o){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,o])}}var r,i,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},ke=2,Ae=0,Ie="livepersonaeditor_with-react",Le="livepersonaeditor_without-react",Oe="livepersonaeditorstrings",xe="iscapiv3enabled",Ee="withreact",Me=function(){return(Me=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Ue=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((r=r.apply(e,t||[])).next())})},_e=function(e,t){function n(n){return function(o){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,o])}}var r,i,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},je=function(){return(je=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Fe=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((r=r.apply(e,t||[])).next())})},De=function(e,t){function n(n){return function(o){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,o])}}var r,i,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o};try{var Ne=window.document.createElement("link"),Re=Boolean("onmscontentzoom"in window.document);Ne.rel=Re?"dns-prefetch":"preconnect",Ne.href="https://res-1.cdn.office.net/",window.document.head.appendChild(Ne)}catch(e){console.log("Live Persona Card ERROR: Bootstrapper failed to warm up the connection to Midgard CDN.",e)}},,,,function(e,t,n){"use strict";function r(){return"object"==typeof window&&window.crypto&&(e=new Uint8Array(31),window.crypto.getRandomValues(e),e)||function(){for(var e=new Array(31),t=0;t<31;t++)e[t]=Math.floor(16*Math.random());return e}();var e}var i=n(20),a=n(8),o=n(5),s=n(0),c=n(4),l=function(){return(l=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},u=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((r=r.apply(e,t||[])).next())})},p=function(e,t){function n(n){return function(o){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,o])}}var r,i,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},f=function(){function e(e,t,n,i,a,o,c){this.eventHubPromise=e,this.monitoringData=t,this.scenarioName=n,this.featureName=i,this.staticProperties=a,this.lookupError=o,this.isVerboseLoggingEnabled=c,this.isFinished=!1,this.isInvalid=!1,this.lastScenarioState=s.a.MONITOR_IN_INVALID_STATE,this.transactionId=function(){for(var e=r(),t=0,n="",i=0;i<36;i++)switch(i){case 8:case 13:case 18:case 23:t+=1,n+="-";break;case 14:t+=1,n+="4";break;case 19:n+=(e[i-t]%4+8).toString(16);break;default:n+=(e[i-t]%16).toString(16)}return n}(),this.start()}return e.prototype.flush=function(){return this.eventHubPromise.then(function(e){return e.broadcastFlush()})},e.prototype.success=function(e,t){this.endEvent(e,s.a.SUCCESS,t)},e.prototype.expectedFailure=function(e,t){this.endEvent(e,s.a.EXPECTED_FAILURE,t)},e.prototype.unexpectedFailure=function(e,t){this.endEvent(e,s.a.UNEXPECTED_FAILURE,t)},e.prototype.dispose=function(){this.isInvalid||!this.isFinished?this.broadcastEvent(void 0,s.a.MONITOR_IN_INVALID_STATE):this.broadcastEvent(this.lastTag,this.lastScenarioState,this.lastProperties)},e.prototype.start=function(){this.startTime=(new Date).getTime()},e.prototype.endEvent=function(e,t,n){this.isFinished&&(this.isInvalid=!0),this.startTime?(this.duration=(new Date).getTime()-this.startTime,this.lastScenarioState=t):this.lastScenarioState=s.a.MONITOR_IN_INVALID_STATE,this.lastTag=e,this.lastProperties=n,this.isFinished=!0,this.dispose()},e.prototype.broadcastEvent=function(e,t,n){return u(this,void 0,void 0,function(){var r,o,s,l,u,f;return p(this,function(p){switch(p.label){case 0:return!Object(c.a)(this.featureName)||Object(c.b)(this.featureName)&&!this.isVerboseLoggingEnabled?[2]:this.scenarioName&&this.monitoringData.source&&this.monitoringData.clientCorrelationId?(r=e?this.scenarioName+"_"+t+"_"+e:this.scenarioName+"_"+t,[4,this.eventHubPromise]):[3,5];case 1:return o=p.sent(),l=(s=o).broadcastEvent,f={eventId:r,version:this.monitoringData.version?this.monitoringData.version:a.a,type:"QoS"},n&&Object(i.a)(n.midgardError)?[4,this.lookupError(n.midgardError)]:[3,3];case 2:return u=p.sent(),[3,4];case 3:u=void 0,p.label=4;case 4:l.apply(s,[(f.midgardError=u,f.source=this.monitoringData.source,f.featureName=this.featureName,f.clientCorrelationid=this.monitoringData.clientCorrelationId,f.qosScenarioName=this.scenarioName,f.qosEventType=t,f.qosTagId=null===e?void 0:e,f.duration=this.duration,f.properties=this.getProperties(n),f)]),p.label=5;case 5:return[2]}})})},e.prototype.getProperties=function(e){var t;return l(l(l(l({},e),((t={})[o.a.CLIENT_TIMESTAMP]=(new Date).getTime().toString(),t[o.a.TRANSACTION_ID]=this.transactionId,t)),this.monitoringData.properties),this.staticProperties())},e}();t.a=f},,,function(e,t,n){"use strict";function r(e){return"object"==typeof e&&!!e&&Object(i.a)(e,"family")&&Object(i.a)(e,"code")&&"string"==typeof e.family&&"number"==typeof e.code}n.d(t,"a",function(){return r});var i=n(7)}])})},2293:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,a&&(o=2&n[0]?a.return:n[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,n[1])).done)return o;switch(a=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,a=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(o=c.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){c.label=n[1];break}if(6===n[0]&&c.label<o[1]){c.label=o[1],o=n;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(n);break}o[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],a=0}finally{i=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,a,o,s,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var o=n(92),s=n(319),c=function(e,t,n){return function(r){var i={slug:r.peopleSlug||r.slug,groupName:r.groupName||r.teamName,middlePane:r.middlePane,threadId:r.threadId,messageId:void 0,ctx:r.ctx,navCtx:e.navContext.livePersonaCard,appId:null};return n.navigatePromise(t,e.states.appConversation,i)}},l=function(e,t){return function(n,r){return void 0===r&&(r=!1),i(void 0,void 0,void 0,function(){var i;return a(this,function(a){return(i=e.getChatConversationWith(n))?[2,t.placeCall({conversationId:i.id,withVideo:r,context:teamspace.services.CallTelemetryContext.LivePersonCard,checkUserMode:!0,isChannelMeeting:!1})]:[2,Promise.reject("Cannot find the chat")]})})}},u=function(e,t){return function(n,r){var i=e.getChatConversationWith(n);if(!i)return Promise.reject("Cannot find the chat");var a=SkypeX.Services.Utilities.newClientMessageId();return t.createMessage({conversationId:i.id,replyChainId:null,messageSubject:null,messageBody:r,messagePreview:r,fileAttachments:null,extensions:null,mentions:null,inputExtensionAttachments:null,embeddedLinks:null,isHtml:!1,importance:null,clientId:a,externalId:null,draftObjectId:null,inlineImages:null})}},p=function(e,t,n,c,l,u,p){return function(f,d){var h=f.persona;return i(void 0,void 0,void 0,function(){var i,f,g,v,m,y,b,C;return a(this,function(a){switch(a.label){case 0:t.info("LPC::Starting chat"),a.label=1;case 1:return a.trys.push([1,4,,5]),i=n.getFreshnessInMs(),f=e.scenarios.people.lpcStartChat,[4,n.getAllPeopleProfile([h.TeamsMri],f,!1,!1,i)];case 2:return g=a.sent()[0],v=l.isCurrentUserTFLOrMsaAccount(),(m=s.getIsMixedChatUser(v,h.TeamsMri,g.type))&&g.type===e.userTypes.tflConsumer&&(g=r(r({},g),{mri:h.TeamsMri.replace("8:","8:tfl:")})),y=c.getPrivateChatUserMri(g,f),[4,u({groupName:g.displayName,peopleSlug:y,middlePane:e.messages.panes.conversations,ctx:e.navigation.context.chat})];case 3:return a.sent(),d(!0),p(o.LpcCallbackTelemetryType.lpcStartChat,g.mri),[3,5];case 4:return b=a.sent(),C="Failed to navigate to chat",t.error(C),d(!1,C),[3,5];case 5:return[2]}})})}},f=function(e,t,n,r,s,c){return function(r,l){return i(void 0,void 0,void 0,function(){var i,u,p,f,d;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),t.info("LPC::Navigating to user's org chart"),i=n.getFreshnessInMs(),u=e.scenarios.people.lpcOrgChart,[4,n.getAllPeopleProfile([r.TeamsMri],u,!1,!1,i)];case 1:return p=a.sent()[0],[4,s({groupName:p.displayName,slug:r.TeamsMri,middlePane:e.peopleTab.panes.organization,ctx:e.navigation.context.chat})];case 2:return a.sent(),l(!0),c(o.LpcCallbackTelemetryType.lpcOrgChart,r.TeamsMri),[3,4];case 3:return f=a.sent(),d="Failed to navigate to org chat",t.error(d),l(!1,d),[3,4];case 4:return[2]}})})}},d=function(e,t,n){return function(r,s){return i(void 0,void 0,void 0,function(){var i,c;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),e.info("LPC::Starting audio call"),[4,t(r.TeamsMri)];case 1:return a.sent(),s(!0),n(o.LpcCallbackTelemetryType.lpcAudioCall,r.TeamsMri),[3,3];case 2:return i=a.sent(),c="Failed to start audio call with",e.error(c),s(!1,c),[3,3];case 3:return[2]}})})}},h=function(e,t,n){return function(r,s){return i(void 0,void 0,void 0,function(){var i,c;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),e.info("LPC::Starting video call"),[4,t(r.TeamsMri,!0)];case 1:return a.sent(),s(!0),n(o.LpcCallbackTelemetryType.lpcVideoCall,r.TeamsMri),[3,3];case 2:return i=a.sent(),c="Failed to start video call with",e.error(c),s(!1,c),[3,3];case 3:return[2]}})})}},g=function(e,t,n){return function(r,s,c){return i(void 0,void 0,void 0,function(){var i,l;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),e.info("LPC::Sending message to user, message length {0}",s&&s.length),[4,t(r.TeamsMri,s)];case 1:return a.sent(),c(!0),n(o.LpcCallbackTelemetryType.lpcQuickIM,r.TeamsMri),[3,3];case 2:return i=a.sent(),l="Failed to send message",e.error(l),c(!1,l),[3,3];case 3:return[2]}})})}},v=function(e,t,n,r){return function(s,c){return i(void 0,void 0,void 0,function(){var i,l,u;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,5,,6]),e.info("LPC::Blocking contact"),(i=t.getChatConversationWith(s.TeamsMri))?[4,t.acceptBlockSfCChat(i.id,!1,"LivePersonaCard")]:[3,2];case 1:return a.sent(),[3,4];case 2:return[4,n.addBlockedMri(s.TeamsMri,"LivePersonaCard")];case 3:a.sent(),a.label=4;case 4:return c(!0),r(o.LpcCallbackTelemetryType.lpcBlockContact,s.TeamsMri),[3,6];case 5:return l=a.sent(),u="Failed to block contact",e.error(u),c(!1,u),[3,6];case 6:return[2]}})})}},m=function(e,t,n,r){return function(s,c){return i(void 0,void 0,void 0,function(){var i,l,u;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,5,,6]),e.info("LPC::Unblocking contact"),(i=t.getChatConversationWith(s.TeamsMri))?[4,t.acceptBlockSfCChat(i.id,!0,"LivePersonaCard")]:[3,2];case 1:return a.sent(),[3,4];case 2:return[4,n.deleteBlockedMri(s.TeamsMri,"LivePersonaCard")];case 3:a.sent(),a.label=4;case 4:return c(!0),r(o.LpcCallbackTelemetryType.lpcUnblockContact,s.TeamsMri),[3,6];case 5:return l=a.sent(),u="Failed to unblock contact",e.error(u),c(!1,u),[3,6];case 6:return[2]}})})}},y=function(e,t,n,r,s){return function(c,l){return i(void 0,void 0,void 0,function(){var i,u,p,f;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),e.info("LPC::Edit Me Profile"),[4,r.getMeMSAProfile(n.scenarios.people.lpcEditProfile,!1)];case 1:return i=a.sent(),u=n.appHeaderBar.buttonid.profileButton,t.open(n.dialogs.updateUserProfile,{isFre:!1,preActiveElementIds:[u],user:i,isMSAEditNameClick:!0}),l(!0),s(o.LpcCallbackTelemetryType.lpcEditMeProfile,c.TeamsMri),[3,3];case 2:return p=a.sent(),f="Failed to edit me user profile",e.error(f),l(!1,f),[3,3];case 3:return[2]}})})}},b=function(e,t,n,r,s){if(n.valueAsBoolean(r.settings.names.enableManageAliasPrivacy))return function(n,c){return i(void 0,void 0,void 0,function(){var i;return a(this,function(a){try{e.info("LPC::Manage discoverability settings"),t.open(r.dialogs.manageAliasPrivacyDialog,{backButtonShouldOpenSettings:!0}),c(!0),s(o.LpcCallbackTelemetryType.lpcManageDiscoverabilitySettings,n.TeamsMri)}catch(t){i="Failed to manage discoverability settings",e.error(i),c(!1,i)}return[2]})})}};t.LPCActionCallbackFactory=function(e,t,n,r,i,a,o,s,C,S,P,T,w){var k=c(t,e,o),A=l(i,s),I=u(i,C);return{startChat:p(t,n,r,i,a,k,w),showOrgChart:f(t,n,r,0,k,w),sendQuickMessage:g(n,I,w),startVideoCall:h(n,A,w),startAudioCall:d(n,A,w),blockContact:v(n,i,S,w),unblockContact:m(n,i,S,w),editMeProfile:y(n,P,t,r,w),manageDiscoverabilitySettings:b(n,P,T,t,w)}}},2294:function(e,t,n){"use strict";function r(e,t){return{disableChatFromKillSwitch:e.valueAsBoolean(t.settings.names.disableLpcStartChatHeaderButton),disableOrgChartFromKillSwitch:e.valueAsBoolean(t.settings.names.disableLpcOrgChartHeaderButton),disableVideoFromKillSwitch:e.valueAsBoolean(t.settings.names.disableLpcStartVideoCallHeaderButton),disableAudioCallFromKillSwitch:e.valueAsBoolean(t.settings.names.disableLpcStartAudioCallHeaderButton)}}function i(e){return e&&validator.isEmail(e)}function a(e,t,n){var r=this;return function(i,a,o){return l(r,void 0,void 0,function(){var r,a,s,c,l,p;return u(this,function(u){switch(u.label){case 0:r=t.service.newScenario(n.scenarios.people.lpcGetOrgChart),a=i.TeamsMri||i.Smtp||i.Upn,u.label=1;case 1:return u.trys.push([1,3,,4]),[4,e.getOrgChart(a)];case 2:return(s=u.sent())?(c=d.getDirectReportsAndManager(s.value),r.stop(),o(c,void 0)):(p="No orgChart returned",t.error(p),r.stop({reason:p}),o(void 0,p)),[3,4];case 3:return l=u.sent(),p="Exception in orgChart call",t.error("getOrgChart failed in LPC data callback"),r.fail({reason:p}),o(void 0,p),[3,4];case 4:return[2]}})})}}function o(e,t,n,r,i,a,o){var s=this;return function(c,p,h){return l(s,void 0,void 0,function(){var s,l,p,g,v,m,y,b,C,S,P,T,w,k,A,I,O,x,E,M;return u(this,function(u){switch(u.label){case 0:s=t.service.newScenario(i.scenarios.people.lpcGetHeaderInfo),l=c.TeamsMri||c.Smtp||c.Upn,u.label=1;case 1:return u.trys.push([1,8,,9]),p=f.deserializeHostAppPersonaId(c.HostAppPersonaId),g=p.isSharedChannel,v=p.hostTenantId,m=p.hostConversationId,y=p.isExchangeOnlyContact,b=void 0,g?[4,e.getAllPeopleProfileForConversation([l],m,!1,i.scenarios.people.lpcGetHeaderInfoSC,void 0,g,v)]:[3,3];case 2:return b=u.sent(),s.mark(i.scenarios.people.lpcGetHeaderInfoSC),[3,7];case 3:return y?[4,d.getPersonaProfileByContactId(c.OlsPersonaId,t,a,s,i.scenarios.people.lpcGetHeaderInfoEC)]:[3,5];case 4:return(b=u.sent())?[3,7]:[2,h(void 0,"No profile returned for exchange contact in LPC getHeaderInfoAndCardType callback")];case 5:return[4,e.getAllPeopleProfile([l],i.scenarios.people.lpcGetHeaderInfo,!Boolean(c.TeamsMri))];case 6:b=u.sent(),s.mark(i.scenarios.people.lpcGetHeaderInfo),u.label=7;case 7:return(C=b[0])?(S=C,P=n.getCurrentSkypeMri(),T=P===c.TeamsMri,w=f.determineCardTypeForTargetUser(S.role,S.type,T),k=r.valueAsBoolean(i.settings.names.showOnlySearchablePhonesAndEmailsInLPC),A=o.isCurrentUserTFLOrMsaAccount(),I=d.getIsMixedChatUser(A,c.TeamsMri,S.type),O=g&&S.xtapUser?S.tenantName:void 0,x=L(w,S,k,I,O),s.stop(),h(x,void 0)):(M="No profile returned",t.error("getAllPeopleProfile returned no profile in LPC GetHeaderInfoAndCardType callback"),s.fail({reason:M}),h(void 0,M)),[3,9];case 8:return E=u.sent(),M="Exception in profile call",t.error("getAllPeopleProfile failed in LPC GetHeaderInfoAndCardType callback"),s.fail({reason:M}),h(void 0,M),[3,9];case 9:return[2]}})})}}function s(e,t,n,r,i,a){var o=this;return function(s,c){return l(o,void 0,void 0,function(){var o,l,p,h,g,v,m,y,b,C,S,P,T,w,k,A,I,L;return u(this,function(u){switch(u.label){case 0:o=t.service.newScenario(r.scenarios.people.lpcGetPersonaInfo),l=s.TeamsMri||s.Smtp||s.Upn,u.label=1;case 1:return u.trys.push([1,8,,9]),p=f.deserializeHostAppPersonaId(s.HostAppPersonaId),h=p.isSharedChannel,g=p.hostTenantId,v=p.hostConversationId,m=p.isExchangeOnlyContact,y=void 0,h?[4,e.getAllPeopleProfileForConversation([l],v,!1,r.scenarios.people.lpcGetPersonaInfoSC,void 0,h,g)]:[3,3];case 2:return y=u.sent(),o.mark(r.scenarios.people.lpcGetPersonaInfoSC),[3,7];case 3:return m?[4,d.getPersonaProfileByContactId(s.OlsPersonaId,t,i,o,r.scenarios.people.lpcGetPersonaInfoEC)]:[3,5];case 4:return(y=u.sent())?[3,7]:[2,c(void 0,"No profile returned for exchange contact in LPC getPersonaInfo callback")];case 5:return[4,e.getAllPeopleProfile([l],r.scenarios.people.lpcGetPersonaInfo,!Boolean(s.TeamsMri))];case 6:y=u.sent(),o.mark(r.scenarios.people.lpcGetPersonaInfo),u.label=7;case 7:return(b=y[0])?(C=b,S=a.isCurrentUserTFLOrMsaAccount(),P=d.getIsMixedChatUser(S,s.TeamsMri,C.type),T=S&&P,w=h&&!!C.xtapUser,k=n.valueAsBoolean(r.settings.names.showOnlySearchablePhonesAndEmailsInLPC)&&!T,A={hostAppPersonaId:s.HostAppPersonaId,aadObjectId:C.objectId,email:d.getEmail(C,k),extraEmails:d.getEmails(C,k),upn:C.userPrincipalName,userType:f.determineLPCPersonaType(C.role,C.type),displayName:C.displayName,firstName:C.givenName,lastName:C.surname,skypeId:C.skypeId,isInformationBarrierBarred:C.isIbBarred,teamsMri:s.TeamsMri||C.mri,jobTitle:C.jobTitle,department:w?C.tenantName:C.department,officeLocation:C.userLocation,phoneNumbersAndUrls:d.getPhoneNumbers(C,k),isMixedChatUser:P},o.stop(),c(A,void 0)):(L="No profile returned",t.error("getAllPeopleProfile returned no profile in LPC GetPersonaInfo callback"),o.fail({reason:L}),c(void 0,L)),[3,9];case 8:return I=u.sent(),L="Exception in profile call",t.error("getAllPeopleProfile failed in LPC GetPersonaInfo callback"),o.fail({reason:L}),c(void 0,L),[3,9];case 9:return[2]}})})}}var c=this&&this.__assign||function(){return(c=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},l=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},u=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,a&&(o=2&n[0]?a.return:n[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,n[1])).done)return o;switch(a=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,a=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(o=c.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){c.label=n[1];break}if(6===n[0]&&c.label<o[1]){c.label=o[1],o=n;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(n);break}o[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],a=0}finally{i=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,a,o,s,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var p=n(92),f=n(318),d=n(319);t.convertHTMLEntities=function(e,t){return e=t.decodeHtml(e),e=t.replaceNewlines(e),e=e.replace(/=""/g,"")},t.unescapeHtmlEntities=function(e,n){if(!e)return e;var r=document.createElement("textarea"),i=(new DOMParser).parseFromString(e,"text/html").body.innerHTML.toString(),a=t.convertHTMLEntities(i,n);return r.textContent=a,r.value};var h=function(e,t,n,r,a){return function(o,s){return l(void 0,void 0,void 0,function(){var l,p,h,g,v,m,y,b,C,S,P,T,w,k;return u(this,function(u){switch(u.label){case 0:if(l=e.service.newScenario(n.scenarios.people.lpcGetImageUri),p=f.deserializeHostAppPersonaId(o.HostAppPersonaId),h=p.isSharedChannel,g=p.hostTenantId,v=p.hostConversationId,m=p.isExchangeOnlyContact,y={mri:o.TeamsMri,principalName:o.Upn||o.Smtp||o.TeamsMri,displayName:o.DisplayName||"",size:n.profilePictureSizes.medium},b=!1,C=i(y.principalName),S=h&&!C,o.DisplayName&&!S)return[3,9];P=o.TeamsMri||o.Smtp||o.Upn,u.label=1;case 1:return u.trys.push([1,8,,9]),T=void 0,h?[4,r.getAllPeopleProfileForConversation([P],v,!0,n.scenarios.people.lpcGetImageUriSC,void 0,h,g)]:[3,3];case 2:return T=u.sent(),l.mark(n.scenarios.people.lpcGetImageUriSC),[3,7];case 3:return m?[4,d.getPersonaProfileByContactId(o.OlsPersonaId,e,a,l,n.scenarios.people.lpcGetImageUriEC)]:[3,5];case 4:return T=u.sent(),[3,7];case 5:return[4,r.getAllShortPeopleProfile([P],n.scenarios.people.lpcGetImageUri,!Boolean(o.TeamsMri))];case 6:T=u.sent(),l.mark(n.scenarios.people.lpcGetImageUri),u.label=7;case 7:return(w=T[0])&&(y=c(c({},y),{displayName:w.displayName}),S&&(y=c(c({},y),{principalName:w.userPrincipalName})),w.isIbBarred&&(b=!0)),[3,9];case 8:return k=u.sent(),e.error("Failed to fetch persona profile in getAndPrefetchPersonaImageUri callback"),[3,9];case 9:return h&&(y=c(c({},y),{isSharedChannel:h,hostTenantId:g,conversationId:v})),m&&(y=c(c({},y),{isExchangeOnlyContact:m})),t.loadImage(y,!1,b,!1,h?n.scenarios.people.lpcGetImageUriSC:n.scenarios.people.lpcGetImageUri).then(function(e){var t=e&&e.imgUrl||"";l.stop(),s(t,{})}).catch(function(e){l.fail({reason:"Failed to fetch persona"}),s(void 0,void 0,e)}),[2]}})})}};t.getSkypeConsumerChatStatus=function(e,t,n){var r=t.findConversationWith(n);if(r&&r.isSfC())return r.InteropConversationStatus()===e.interopConversationStatus.blocked?p.PersonaPresence.blocked:p.PersonaPresence.none};var g=function(e,n,r,i,a,o){var s=t.getSkypeConsumerChatStatus(r,i,o);if(void 0!==s)return s;if(a.isBlockedContact(o))return p.PersonaPresence.blocked;var c=e.status,l=e.flwPresence;if(n.valueAsBoolean(r.settings.names.enableFlwPresence)){if(l===SkypeX.Services.UserFlwPresence.OffShift)return p.PersonaPresence.offline;if(l===SkypeX.Services.UserFlwPresence.OnShift)switch(c){case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.OnThePhone:case SkypeX.Services.UserStatus.InAMeeting:return p.PersonaPresence.busy;default:return p.PersonaPresence.online}}switch(c){case SkypeX.Services.UserStatus.Online:return p.PersonaPresence.online;case SkypeX.Services.UserStatus.Offline:case SkypeX.Services.UserStatus.OutOfOffice:case SkypeX.Services.UserStatus.Unknown:return p.PersonaPresence.offline;case SkypeX.Services.UserStatus.Away:case SkypeX.Services.UserStatus.Idle:case SkypeX.Services.UserStatus.BeRightBack:case SkypeX.Services.UserStatus.AppearAway:return p.PersonaPresence.away;case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.InAMeeting:case SkypeX.Services.UserStatus.OnThePhone:return p.PersonaPresence.busy;case SkypeX.Services.UserStatus.OutToLunch:case SkypeX.Services.UserStatus.Presenting:case SkypeX.Services.UserStatus.Focusing:return p.PersonaPresence.dnd;default:return p.PersonaPresence.offline}},v=function(e,t,n,r,i,a,o){if(!t||0===t.length)return e;var s=r.getLocalTimezone();if(n&&s!==n){var c=(new Date).toLocaleDateString(i.getLocale(),{timeZoneName:"short"}).split(" "),l=c.length>0?c[c.length-1]:null;l&&(t=a.instant(o.strings.person_card_on_shift_end_time_with_timezone,{shiftEndTime:t,timeZoneCode:l}))}return a.instant(o.strings.person_card_on_shift_status_label,{onShiftStatus:e,shiftEndTime:t})},m=function(e,t,n,r,i,a,o,s,c){var l=e.status,u=e.calendarData,p=e.lastSeenAt,f=e.flwPresence,d=e.extensions;if(t.valueAsBoolean(i.settings.names.enableFlwPresence)){if(f===SkypeX.Services.UserFlwPresence.OffShift)return n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OffShift);if(f===SkypeX.Services.UserFlwPresence.OnShift){var h=void 0,g=void 0,m=SkypeX.Services.UnifiedPresenceExtensionsParser.getShiftsData(d);switch(m&&m.currentShift&&(h=c.getDate(new Date(m.currentShift.endTime),"shortTime"),g=m.currentShift.teamOlsonCode),l){case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.OnThePhone:case SkypeX.Services.UserStatus.InAMeeting:case SkypeX.Services.UserStatus.Presenting:var y=r.instant(a.strings.status_label_person_card_with_primary_and_secondary_status,{primaryStatus:n.GetTranslatedStatusText(l),secondaryStatus:n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OnShift)});return v(y,h,g,s,c,r,a);default:var b=n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OnShift);return v(b,h,g,s,c,r,a)}}}var C=p&&(new Date).getTime()-p.getTime()<=i.timeInMiliseconds.year;if(u&&u.isOutOfOffice)switch(l){case SkypeX.Services.UserStatus.Online:case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.OnThePhone:case SkypeX.Services.UserStatus.InAMeeting:case SkypeX.Services.UserStatus.OutToLunch:case SkypeX.Services.UserStatus.Presenting:case SkypeX.Services.UserStatus.Focusing:return r.instant(a.strings.status_label_person_card_with_primary_and_secondary_status,{primaryStatus:n.GetTranslatedStatusText(l),secondaryStatus:n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OutOfOffice)});case SkypeX.Services.UserStatus.Away:case SkypeX.Services.UserStatus.BeRightBack:case SkypeX.Services.UserStatus.Idle:case SkypeX.Services.UserStatus.Offline:return C?r.instant(a.strings.person_card_last_seen_time_with_prefix,{lastSeenTime:o.transformIntoTimeago(p)}):n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OutOfOffice);default:return n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OutOfOffice)}else switch(l){case SkypeX.Services.UserStatus.Away:case SkypeX.Services.UserStatus.BeRightBack:case SkypeX.Services.UserStatus.Idle:case SkypeX.Services.UserStatus.Offline:return C?r.instant(a.strings.person_card_last_seen_time_with_prefix,{lastSeenTime:o.transformIntoTimeago(p)}):n.GetTranslatedStatusText(l);default:return n.GetTranslatedStatusText(l)}},y=function(e,t,n,r,i){var a="";return e.calendarData&&e.calendarData.outOfOfficeNote&&e.calendarData.outOfOfficeNote.message&&(a=r.stripHtml(i.sanitizeHtml(e.calendarData.outOfOfficeNote.message)).trim()),a},b=function(e,t,n,r,i,a){var o={message:"",publishTime:""};if(e.note){var s=e.note.message,c=e.note.publishTime;if(c&&c.trim()){var l=new Date(c);o.publishTime=a.getMessageDisplayableDateTime(l)}if(s){var u=r.stripHtml(i.sanitizeHtml(s)).trim(),p=y(e,0,0,r,i);u.length&&!p.length&&(o.message=u)}}return o.message&&o.publishTime?o:void 0},C=function(e,n,r,i){var a=[],o=function(i){_.each(i,function(i){if("span"===i.name&&i.attribs&&i.attribs.itemtype===n.semanticObjectSchemas.mention&&i.attribs["data-itemprops"]){var s=r.DomUtils.getText(i),c=e.decodeHtml(i.attribs["data-itemprops"]),l=d.removeZeroWidthSpace(c),u=JSON.parse(l).mri;a.push({text:t.unescapeHtmlEntities(s,e),hostAppPersonaId:u,mri:u})}else"text"===i.type?a.push({text:t.unescapeHtmlEntities(r.DomUtils.getText(i),e),hostAppPersonaId:void 0}):"br"===i.name?a.push({text:" ",hostAppPersonaId:void 0}):i.children&&i.children.length>0&&o(i.children)})};return o(i),a},S=function(e,t,n,r,i,a){if(t.valueAsBoolean(n.settings.names.enableStatusNoteV2)&&e.note){var o={message:[],publishTime:""},s=e.note.message,c=e.note.publishTime;if(s){var l=i.sanitizeHtml(s).trim(),u=window.htmlparser2,p=u.parseDOM("<div>"+l+"</div>"),f=C(r,n,u,p);o.message=f}if(c&&c.trim()){var d=new Date(c);o.publishTime=a.getMessageDisplayableDateTime(d)}return o.message.length&&o.publishTime?o:void 0}},P=function(e,t,n,r,i,a,o,s,c,l,u,p,f,d){return function(h,v){var C=e.getPresence(h,v);return{presence:g(C,i,a,f,d,h),isOutOfOffice:C&&!!C.calendarData&&!!C.calendarData.isOutOfOffice,oofMessage:C&&y(C,0,0,t,n),presenceText:C&&m(C,i,o,s,a,c,l,u,p),statusNote:C&&b(C,0,0,t,n,r),statusNoteV2:C&&S(C,i,a,t,n,r)}}},T=function(e){return function(t){var n=e.findConversationWith(t);return n&&n.isInteropChat()?SkypeX.Services.PresenceSource.SFB:SkypeX.Services.PresenceSource.UPS}},w=function(e,t,n,r,i,a,o,s,c,l,u,p,d,h,g){return function(v,m){if(f.deserializeHostAppPersonaId(v.HostAppPersonaId).isExchangeOnlyContact)return m(null,void 0);var y=g.service.newScenario(o.scenarios.people.lpcGetRichPresence),b=T(e),C=P(t,n,r,i,a,o,s,c,l,u,p,d,e,h)(v.TeamsMri,b(v.TeamsMri));y.stop(),m(C,void 0)}},k=function(e,t,n,i,a,o,s,c,p,h){return function(g){return l(void 0,void 0,void 0,function(){var l,v,m,y,b,C,S,P,T,w,k,A,I,L,O,x,E,M,U,_,j,F,D,N,R,B,G,H,z,X,V,W,q,Q;return u(this,function(u){switch(u.label){case 0:if(l=i.service.newScenario(a.scenarios.people.lpcGetHeaderActionsPolicy),v=p.getCurrentSkypeMri(),m=v===g.TeamsMri,y=f.deserializeHostAppPersonaId(g.HostAppPersonaId),b=y.isSharedChannel,C=y.hostTenantId,S=y.hostConversationId,P=y.isExchangeOnlyContact,m||P)return m?l.stop({reason:"User is me"}):l.stop({reason:"Out-of-tenant outlook Contact"}),[2,{disableChat:!0,disableOrg:!0,disableCall:!0,disableVideo:!0,disableBlockUnblock:!0}];if(T=!c.isCurrentUserTFLOrMsaAccount(),w={disableChat:!1,disableOrg:!0,disableCall:!1,disableVideo:!1,disableBlockUnblock:T},k=s.isBlockedContact(g.TeamsMri))return l.stop({reason:"Blocked Contact"}),[2,{disableChat:!0,disableOrg:!0,disableCall:!0,disableVideo:!0,disableBlockUnblock:T}];A=r(h,a),I=A.disableChatFromKillSwitch,L=A.disableOrgChartFromKillSwitch,O=A.disableVideoFromKillSwitch,x=A.disableAudioCallFromKillSwitch,E=e.getSettingValue(SkypeX.Services.CallingPolicyStorageKey.allowPrivateCalling),w.disableCall=x||!E,w.disableVideo=O||!E,M=t.getSettingValue(SkypeX.Services.MessagingPolicySettingsStorageKey.allowUserChat),u.label=1;case 1:return u.trys.push([1,6,,7]),U=void 0,b?[4,n.getAllPeopleProfileForConversation([g.TeamsMri],S,!1,a.scenarios.people.lpcGetHeaderActionsPolicySC,void 0,b,C)]:[3,3];case 2:return U=u.sent(),l.mark(a.scenarios.people.lpcGetHeaderActionsPolicySC),[3,5];case 3:return[4,n.getAllPeopleProfile([g.TeamsMri],a.scenarios.people.lpcGetHeaderActionsPolicy,!g.TeamsMri)];case 4:U=u.sent(),l.mark(a.scenarios.people.lpcGetHeaderActionsPolicy),u.label=5;case 5:if(_=U[0]){if(j=_.featureSettings,F=_.type,D=_.userType,N=_.isAnonymousUser,R=_.mri,B=_.isIbBarred,N||B)return N?l.stop({reason:"Anonymous User"}):l.stop({reason:"IB Barred User"}),[2,{disableChat:!0,disableOrg:!0,disableCall:!0,disableVideo:!0,disableBlockUnblock:!0}];if(G=c.isCurrentUserTFLOrMsaAccount(),H=d.getIsMixedChatUser(G,g.TeamsMri,_.type))return[2,{disableChat:I||!1,disableOrg:!0,disableCall:!0,disableVideo:!0,disableBlockUnblock:T}];if(z=SkypeX.Services.ChatServiceUtils.isPstnMri(R))return l.stop({reason:"PSTN User"}),[2,{disableChat:!0,disableOrg:!0,disableCall:x||!1,disableVideo:!0,disableBlockUnblock:!0}];X=j&&j.isPrivateChatEnabled,V=F&&F.toLowerCase()===a.userTypes.person.toLowerCase(),W=D&&D.toLowerCase()===a.userTypes.guest.toLowerCase(),q=o===teamspace.services.UserTypeInTenant.Guest,w.disableChat=I||!1===X||!M,w.disableOrg=L||!(V&&!W)||q,l.stop()}return[3,7];case 6:return Q=u.sent(),l.fail({reason:"Error while fetching persona"}),i.error("Failed to fetch persona profile in LPC data callbacks"),[3,7];case 7:return[2,w]}})})}},A=function(e,t,n,r,i){var a=d.getEmail(t,n);return{cardType:e,headerInfo:{userHeaderInfo:{displayName:t.displayName,firstName:t.givenName,lastName:t.surname,title:t.jobTitle,department:t.department,location:t.userLocation,profilePictureUrl:t.imageUri,mobilePhone:t.mobile,phone:d.getPhoneNumber(t,n),userPrincipalName:t.userPrincipalName,email:a&&a.Address,imAddress:t.skypeId,tenantName:i},isMixedChatUser:r}}},I=function(e,t){return{cardType:e,headerInfo:{unresolvedHeaderInfo:{email:t}}}},L=function(e,t,n,r,i){return"NotResolved"===e?I(e,t.email):A(e,t,n,r,i)};t.makeGetHeaderInfoAndCardTypeCallback=o,t.GetPresenceSourceFunction=T,t.GetRichPresenceFunction=P,t.LPCDataCallbackFactory=function(e,t,n,r,i,c,l,u,p,f,d,g,v,m,y,b,C,S,P,T,A,I,L){return{getAndPrefetchPersonaImageUri:h(e,b,p,r,L),getRichPresence:w(t,n,i,c,l,u,p,f,d,g,v,m,y,C,e),getHeaderActionsPolicyAsync:k(S,P,r,e,p,T,C,I,A,u),getPersonaInfo:s(r,e,u,p,L,I),getOrgChart:a(r,e,p),getHeaderInfoAndCardType:o(r,e,A,u,p,L,I)}}},2295:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,a&&(o=2&n[0]?a.return:n[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,n[1])).done)return o;switch(a=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,a=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(o=c.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){c.label=n[1];break}if(6===n[0]&&c.label<o[1]){c.label=o[1],o=n;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(n);break}o[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],a=0}finally{i=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,a,o,s,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){return function(t,n){return r(void 0,void 0,void 0,function(){return i(this,function(r){return e.newSecondPartyOneDsLogger(t,n),[2]})})}},o=function(e){return function(t,n){return r(void 0,void 0,void 0,function(){return i(this,function(r){return e.logSecondPartyEvent(t,n),[2]})})}};t.LPCTelemetryCallbackFactory=function(e){return{initializeExternalOneDsTelemetry:a(e),sendExternalOneDsTelemetryEvent:o(e)}}},2296:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2297);t.defaultTheme=r.defaultTheme;var i=n(2298);t.darkTheme=i.darkTheme;var a=n(2299);t.highContrastTheme=a.highContrastTheme},2297:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="rgba(37,36,36,0.75)",i={themePrimary:r,themeSecondary:r,neutralPrimary:"#252424",neutralSecondary:r,neutralLight:"#FAF9F8",neutralLighter:"#f3f2f1",neutralLighterAlt:"#ffffff",neutralPrimaryAlt:"#FAF9F8",neutralSecondaryAlt:"#2A2828",neutralTertiary:"#c8c6c4",neutralTertiaryAlt:"#FAF9F8",neutralQuaternary:"#f3f2f1",neutralQuaternaryAlt:"#ffffff",purple:"#6264a7",magenta:"#943670",magentaDark:"rgba(148,54,112,0.05)"};t.defaultTheme={palette:i}},2298:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fontColor="rgba(255,255,255,0.75)",t.white="#2d2c2c",t.darkThemePalette={themePrimary:t.fontColor,themeSecondary:t.fontColor,neutralPrimary:"#ffffff",neutralSecondary:t.fontColor,neutralLight:"#3b3a39",neutralLighter:"#201F1F",neutralLighterAlt:t.white,neutralPrimaryAlt:"#3B3A3A",neutralSecondaryAlt:t.fontColor,neutralTertiary:"#605e5c",neutralTertiaryAlt:"#3b3a39",neutralQuaternary:"#201F1F",neutralQuaternaryAlt:"#201F1F",white:t.white,purple:"#a6a7dc",magenta:"#ae3d84",magentaDark:"rgba(207,96,152,0.1)",black:"#ffffff"},t.darkTheme={palette:t.darkThemePalette}},2299:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="#000000",i="#ffffff",a={themePrimary:"#ffffff",themeSecondary:"#ffffff",neutralPrimary:i,neutralSecondary:"#ffffff",neutralLight:r,neutralLighter:i,neutralLighterAlt:i,neutralPrimaryAlt:r,neutralSecondaryAlt:"#ffffff",neutralTertiary:"#30f42c",neutralTertiaryAlt:r,neutralQuaternary:r,neutralQuaternaryAlt:i,white:r,black:i,purple:"#ffff00",magenta:i,magentaDark:r};t.highContrastTheme={palette:a}},2300:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=teamspace.components.PanelActionGesture,i=teamspace.components.PanelActionOutcome,a=teamspace.components.PanelActionScenario,o=teamspace.components.PanelActionScenarioType,s=teamspace.components.PanelModuleName,c=teamspace.components.PanelModuleType,l=teamspace.components.WorkLoad,u=teamspace.components.SubWorkLoad,p=n(92),f=function(){function e(e,t,n){this.analyticsService=e,this.loggingService=t,this.conversationsService=n}return e.prototype.logPanelActionEvent=function(e,t){var n,f,d,h,g,v,m=this,y=c.people,b=i.nav,C=i.nav,S=o.people,P=teamspace.PanelRegion.popover,T=l.chatContent,w=u.composeMsg;switch(e){case p.LpcCallbackTelemetryType.lpcAudioCall:f=r.click,d=a.navCalling,h=s.lpcAudioCall,n="lpcAudioCall";break;case p.LpcCallbackTelemetryType.lpcStartChat:f=r.click,d=a.navChat,h=s.lpcStartChat,n="lpcStartChat";break;case p.LpcCallbackTelemetryType.lpcOrgChart:f=r.click,d=a.orgChart,h=s.lpcOrgChart,n="lpcOrgChart";break;case p.LpcCallbackTelemetryType.lpcQuickIM:f=r.click,b=i.submit,C=i.submit,d=a.quickIM,h=s.lpcQuickIM,g=s.sendButton,v=c.compose,n="lpcQuickIM";break;case p.LpcCallbackTelemetryType.lpcVideoCall:f=r.click,d=a.navCalling,h=s.lpcVideoCall,n="lpcVideoCall";break;case p.LpcCallbackTelemetryType.lpcBlockContact:f=r.click,d=a.blockUser,h=s.lpcBlockContact,n="lpcBlockContact";break;case p.LpcCallbackTelemetryType.lpcUnblockContact:f=r.click,d=a.unblockUser,h=s.lpcUnblockContact,n="lpcUnblockContact";break;default:return}var k={action:{gesture:f,outcome:b,outcomeNew:C,scenario:d?teamspace.shared.AttributeHelper.tryGetEnum(d.toString(),a,this.loggingService):null,scenarioType:S?teamspace.shared.AttributeHelper.tryGetEnum(S.toString(),o,this.loggingService):null,workLoad:teamspace.shared.AttributeHelper.tryGetEnum(T.toString(),l,this.loggingService),subWorkLoad:teamspace.shared.AttributeHelper.tryGetEnum(w.toString(),u,this.loggingService)},module:{name:h?teamspace.shared.AttributeHelper.tryGetEnum(h.toString(),s,this.loggingService):null,nameNew:g?teamspace.shared.AttributeHelper.tryGetEnum(g.toString(),s,this.loggingService):null,type:y?teamspace.shared.AttributeHelper.tryGetEnum(y.toString(),c,this.loggingService):null,typeNew:v?teamspace.shared.AttributeHelper.tryGetEnum(v.toString(),c,this.loggingService):null,summary:n},targetThread:this.getTargetThreadType(t)};this.analyticsService.getAnalyticsPanelActionEventData(k,P).then(function(e){m.analyticsService.sendPanelAction(e)})},e.prototype.getTargetThreadType=function(e){if(!e)return null;var t=this.conversationsService.getConversation(e);return{type:t&&t.conversationType||"OneOnOneChat"}},e}();t.LpcTelemetryHelper=f},318:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.determineLPCPersonaType=function(e,t){switch(t){case"Federated":case"SkypeConsumer":return"External";case"person":return"Guest"===e?"NotResolved":"User";default:return"User"}},t.determineCardTypeForTargetUser=function(e,t,n){if(n)return"Me";switch(t){case"Federated":case"SkypeConsumer":case"TflConsumer":return"External";case"person":return"Guest"===e?"NotResolved":"User";default:return"User"}},t.getCleanUpn=function(e){return!e||SkypeX.Services.ChatServiceUtils.isMri(e)?void 0:e},t.serializeHostAppPersonaId=function(e){return JSON.stringify(e)},t.deserializeHostAppPersonaId=function(e){if(!e)return{userId:void 0,isSharedChannel:!1,hostTenantId:void 0,hostConversationId:void 0,isExchangeOnlyContact:!1};var t=JSON.parse(e);return{userId:t.userId,isSharedChannel:!0===t.isSharedChannel,hostTenantId:t.hostTenantId,hostConversationId:t.hostConversationId,isExchangeOnlyContact:!0===t.isExchangeOnlyContact}}},319:function(e,t,n){"use strict";function r(e,t){var n=[];return e.emailsInfo&&e.emailsInfo.forEach(function(e){!e.searchable&&t||n.push({Address:e.address})}),n}function i(e,t){if(t){var n=[];return e.phonesInfo&&e.phonesInfo.forEach(function(e){e.searchable&&n.push({PhoneNumber:e.number,Type:"Home",PhoneUrl:"tel:"+e.number})}),n}var r=[];return e.phones&&e.phones.length>0&&e.phones.forEach(function(e){return r.push({PhoneNumber:e.number,PhoneUrl:"tel:"+e.number,Type:e.type})}),e.telephoneNumber&&r.push({PhoneNumber:e.telephoneNumber,PhoneUrl:"tel:"+e.telephoneNumber,Type:"Business"}),r}var a=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,a&&(o=2&n[0]?a.return:n[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,n[1])).done)return o;switch(a=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,a=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(o=c.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){c.label=n[1];break}if(6===n[0]&&c.label<o[1]){c.label=o[1],o=n;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(n);break}o[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],a=0}finally{i=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,a,o,s,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0}),t.getDirectReportsAndManager=function(e){return{Managers:e.filter(function(e){return 1===e.managerLevel}).map(function(e){return{DisplayName:e.displayName,Smtp:e.smtpAddresses[0],Department:e.department,JobTitle:e.jobTitle}}),Directs:e.filter(function(e){return!e.userClassification}).map(function(e){return{DisplayName:e.displayName,Smtp:e.smtpAddresses[0],Department:e.department,JobTitle:e.jobTitle}})}},t.getEmails=r,t.getEmail=function(e,t){if(!t)return e.email?{Address:e.email}:void 0;var n=r(e,t);return n.length>0?n[0]:void 0},t.getPhoneNumbers=i,t.getPhoneNumber=function(e,t){if(t){var n=i(e,t);if(n.length>0){var r=n[0];return{number:r.PhoneNumber,type:r.Type,url:r.PhoneUrl}}}else{if(e.telephoneNumber)return{number:e.telephoneNumber,type:"Business",url:"tel:"+e.telephoneNumber};if(e.phones&&e.phones.length>0){var a=e.phones[0];return{number:a.number,type:a.type,url:"tel:"+a.number}}}},t.removeZeroWidthSpace=function(e){var t=/[\u200B-\u200D\uFEFF]/g;return e.replace(t,"")},t.getPersonaProfileByContactId=function(e,t,n,r,i){return a(this,void 0,void 0,function(){var a,s,c;return o(this,function(o){switch(o.label){case 0:return e?[4,n.getCachedExchangeContactById(e)]:[3,2];case 1:return(s=o.sent())?a=[{displayName:n.getDisplayNameForUserContact(s),id:s.id,jobTitle:s.jobTitle,mri:s.mri,phones:s.phones,email:s.emails[0]||"",objectId:s.id}]:(c="No profile returned for exchange contact",t.error("getCachedExchangeContactById returned no profile in LPC {0}",i),r.fail({reason:c})),[3,3];case 2:c="Empty OlsPersonaId to look for Exchange contact profile",t.error("Empty OlsPersonaId to look for Exchange contact profile in LPC {0}",i),r.fail({reason:c}),o.label=3;case 3:return a&&r.mark(i),[2,a]}})})},t.getIsMixedChatUser=function(e,t,n){var r=t&&SkypeX.Services.ChatServiceUtils.isTeamsMri(t),i=e&&r||!e&&"TflConsumer"===n;return Boolean(i)}},92:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.none=0]="none",e[e.offline=1]="offline",e[e.online=2]="online",e[e.away=3]="away",e[e.dnd=4]="dnd",e[e.blocked=5]="blocked",e[e.busy=6]="busy",e[e.oof=7]="oof"}(t.PersonaPresence||(t.PersonaPresence={}));!function(e){e.Default="default",e.HighContrast="contrast",e.Dark="dark",e.DefaultV2="defaultV2",e.DarkV2="darkV2"}(t.LpcTheme||(t.LpcTheme={}));!function(e){e[e.lpcAudioCall=0]="lpcAudioCall",e[e.lpcStartChat=1]="lpcStartChat",e[e.lpcEditMeProfile=2]="lpcEditMeProfile",e[e.lpcOrgChart=3]="lpcOrgChart",e[e.lpcQuickIM=4]="lpcQuickIM",e[e.lpcVideoCall=5]="lpcVideoCall",e[e.lpcBlockContact=6]="lpcBlockContact",e[e.lpcUnblockContact=7]="lpcUnblockContact",e[e.lpcManageDiscoverabilitySettings=8]="lpcManageDiscoverabilitySettings",e[e.personImageCallback=9]="personImageCallback",e[e.richPresenceCallback=10]="richPresenceCallback"}(t.LpcCallbackTelemetryType||(t.LpcCallbackTelemetryType={}))}},[2290]);