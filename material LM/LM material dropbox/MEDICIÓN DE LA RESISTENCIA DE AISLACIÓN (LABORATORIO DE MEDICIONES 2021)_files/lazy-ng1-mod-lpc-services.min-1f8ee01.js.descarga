webpackJsonp([21],{2255:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(2256)},2256:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?n(e.value):i(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(a=2&n[0]?o.return:n[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,o=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break}a[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],o=0}finally{i=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var s=n(2257),c=n(90),l=n(314),u=n(2258),p=n(2259),f=n(2261),d=n(2265),h=function(e){function t(t,n,r,i,o,a,s,c,l,u,p,f,d){var h=e.call(this,l)||this;return h.constants=t,h.utilityService=n,h.settingsService=r,h.authenticationService=i,h.sxConfig=o,h.localizationService=a,h.eventingService=s,h.appStateService=c,h.loggingService=u,h.logger=p,h.actionCallbacks=f,h.dataCallbacks=d,h.changeTheme=function(e){var t=window.LPC;t&&t.loadTheme(h.getTheme(e))},h.initializeOnAppLaunchAndReinit("First Initialize"),h}return r(t,e),Object.defineProperty(t.prototype,"isLivePersonaCardInitialized",{get:function(){return!(null==this.lpcPromise||null==window.LPC)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLivePersonaCardEnabled",{get:function(){return!!this.settingsService.valueAsBoolean(this.constants.settings.names.enableLivePersonaCard)},enumerable:!0,configurable:!0}),t.prototype.mtmaTelemetryIdentifier=function(){return"LivePersonaCardService"},t.prototype.cleanupOnAppTeardown=function(e){this.logger.log("LivePersonaCardService onAppTeardown: reason = {0}",e),this.lpcPromise=null,window.LPC=null,this.unbsubscribeFromAppStateChanges&&(this.unbsubscribeFromAppStateChanges(),this.unbsubscribeFromAppStateChanges=null)},t.prototype.initializeOnAppLaunchAndReinit=function(e){var t=this;this.logger.log("LivePersonaCardService Initialize reason {0}",e),this.eventingService.unsafeOnWithTenantScope(this.constants.events.layout.themeChanged,function(e,n){t.isLivePersonaCardInitialized&&t.changeTheme(n)}),this.unbsubscribeFromAppStateChanges&&this.unbsubscribeFromAppStateChanges(),this.unbsubscribeFromAppStateChanges=this.eventingService.unsafeOnWithTenantScope(this.constants.events.appState.changed,function(e,n){t.onAppStateChanged(n)})},t.prototype.initializeLPC=function(){return o(this,void 0,void 0,function(){var e,t,n,r,o,c,l,u,p,f,d,h,g,v,m,y,b,S,C,P;return a(this,function(a){if(this.isLivePersonaCardInitialized)return[2,this.lpcPromise];if(e=this.loggingService.newScenario("LivePersonaCard_Initialize"),t=this.utilityService.generateUUID(),n=this.localizationService.getLocale(),r=this.settingsService.getVersion().clientVersion,o=this.settingsService.valueFor(this.constants.settings.names.lpcComplianceEnvironment),c="Prod"!==o,l=this.settingsService.isInternalRing()&&!c,u=this.authenticationService.getUserTypeInTenant(),p=this.sxConfig.getCurrentSkypeMri(),f=u===teamspace.services.UserTypeInTenant.Guest,d=this.settingsService.valueAsBoolean(this.constants.settings.names.enableTimeZoneInLPC),h=l&&!f?"df":"",!this.appStateService.isOnline)throw P="App is Offline",e.fail({message:P,clientCorrelationId:t,lpcRegion:h,userTypeInTenant:u}),new Error(P);g=this.getTeamsConfig(t,n,h,o),v=this.settingsService.getRing(),m=this.settingsService.valueAsBoolean(this.constants.settings.names.enableLivePersonaCardV2),y={isLivePersonaCardV2Enabled:m},this.logger.info("Client Correlation ID for LivePersonaCard in Teams Main Window: clientCorrelationId="+t);try{return b=v&&v.id?v.id:void 0,S=r,this.lpcPromise=s.initializeLivePersonaCardAsync(i(i({},g),{actionCallbacks:this.actionCallbacks,dataCallbacks:this.dataCallbacks,getAuthToken:this.getAuthToken(t),logMessage:function(e,t,n){this.logger.debug("LogType="+e+", LogResultType="+t+", Message="+n)},theme:this.getTheme(this.settingsService.getActiveTheme()),hostAppRing:b,hostAppVersion:S,options:{hostAppRing:b,hostAppVersion:S,isLoggedInAsTeamsGuestUser:f,isTimeZoneEnabled:d},hostAppConfiguration:y,loggedInUserTeamsMri:p})),C=m?"LPCv2":"LPCv1",this.lpcPromise.then(function(){var n=window.LPC&&window.LPC.version||"";e.stop({message:"LivePersonaCard loaded",version:n,clientCorrelationId:t,lpcRegion:h,userTypeInTenant:u,lpcArchitectureVersion:C})}).catch(function(n){throw e.fail({message:"Could not load LivePersonaCard",clientCorrelationId:t,lpcRegion:h,userTypeInTenant:u,lpcArchitectureVersion:C}),n}),[2,this.lpcPromise]}catch(n){throw P="Could not load live persona card: "+n,e.fail({message:P,clientCorrelationId:t,lpcRegion:h,userTypeInTenant:u}),new Error(P)}return[2]})})},t.prototype.createLPC=function(e,t){var n=t.profile,r=t.behavior,o=t.ariaLabel,a=t.externalAppSessionCorrelationId,s=t.disableAccessibilityDefaults,c=t.tabIndex,u=t.clientScenario,p=t.isSharedChannel,f=t.hostTenantId,d=t.hostConversationId,h=t.isExchangeOnlyContact,g=t.contactId;{if(this.isLivePersonaCardInitialized){var v=l.determineLPCPersonaType(n.role,n.type),m=l.getCleanUpn(n.userPrincipalName),y={personaInfo:{identifiers:{PersonaType:v,AadObjectId:n.objectId,TeamsMri:n.mri,OlsPersonaId:g,HostAppPersonaId:l.serializeHostAppPersonaId({userId:n.mri,isSharedChannel:p,hostTenantId:f,hostConversationId:d,isExchangeOnlyContact:h}),Upn:m,Smtp:n.email},skypeId:n.skypeId},behavior:i({disableHover:!1,locationToOpen:"Card",cardPlacementMode:"AnchorSide"},r),ariaLabel:o,disableAccessibilityDefaults:!!s,tabIndex:c,externalAppSessionCorrelationId:a,clientScenario:u};this.attachHoverTargetAsync(e,y);var b=function(){window.requestIdleCallback&&window.requestIdleCallback(function(){window.LPC&&window.LPC.removedPersonaFromPage(e)})}.bind(this);return{destroy:function(){b()}}}this.logger.error("Not initialized")}},t.prototype.onAppStateChanged=function(e){var t=e.prevState,n=t===teamspace.services.ApplicationState.Offline||t===teamspace.services.ApplicationState.Disconnected||t===teamspace.services.ApplicationState.Disabled;this.appStateService.isOnline&&n&&(s.freeBootstrapperMemory(window),this.initializeLPC())},t.prototype.attachHoverTargetAsync=function(e,t){window.LPC.addedPersonaToPageV2(e,t)},t.prototype.getTheme=function(e){switch(e){case c.LpcTheme.Dark:case c.LpcTheme.DarkV2:return f.darkTheme;case c.LpcTheme.HighContrast:return f.highContrastTheme;case c.LpcTheme.Default:case c.LpcTheme.DefaultV2:default:return f.defaultTheme}},t.prototype.getTeamsConfig=function(e,t,n,r){var i=this.authenticationService.isCurrentUserTFLOrMsaAccount();return{culture:t||window.navigator.language||"en-us",region:n,clientCorrelationId:e,clientType:"MicrosoftTeamsAngular",clientContextType:"Generic",complianceEnvironment:r,options:{isImmersiveProfileEnabled:!1,isLinkedInIntegrationEnabled:!1},isConsumer:i}},t.prototype.getAuthToken=function(e){var t=this;return function(n,r){return o(t,void 0,void 0,function(){var t,i,o,s,c,l,u,p,f,d,h,g,v;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),t=this.constants.settings.names,i=t.lokiTokenResourceUrl,o=t.enableSilentLokiAuthTokenRetrieval,s=this.settingsService.valueAsBoolean(o),[4,this.authenticationService.getAuthTokens([this.settingsService.valueFor(i)],[],s)];case 1:return(c=a.sent())?n(c,e):r("[AuthError] Error retrieving auth token, details: Empty token",e),[3,3];case 2:return l=a.sent(),this.logger.error("Error acquiring access token for LOKI"),u=!1,p="Unexpected Error",f=void 0,l&&(f=_.isString(l)?l:l.authStatus+"-"+l.message,f=f.toLowerCase()),f&&(d=f.includes("retry fetch of adal tokens"),h=f.includes("nativewam:3")||f.includes("tokenrevoked"),g=f.includes("mt_token_expired")||f.includes("receivedexpiredtoken"),v=f.includes("renewaltimeout")||f.includes("token renewal"),u=d||v||g||h,d?p="Retry fetch of ADAL tokens failed":v?p="Token renewal call timed out":h?p="Token revoked":g&&(p="Token expired")),r("[AuthError] Error retrieving auth token, details: "+p,e,u),[3,3];case 3:return[2]}})})}},t}(teamspace.services.MTMABase);t.LivePersonaCardService=h,angular.module("teamspace.lpcService",["teamspace.loggingService","teamspace.authenticationService","teamspace.dialogService","teamspace.utilityService","teamspace.peopleService","teamspace.navigationService","teamspace.conversationsService","teamspace.localizationService","teamspace.eventingService","teamspace.messageService","teamspace.settingsService","teamspace.callingUserActionService","teamspace.presenceManagerService","teamspace.htmlSanitizer","teamspace.dateFormatService","teamspace.platformDetectService"]).factory("lpcService",["constants","callingPolicyStore","messagingPolicySettingsStore","utilityService","settingsService","loggingService","authenticationService","$rootScope","navigationService","conversationsService","localizationService","eventingService","messageService","peopleService","dialogService","callingUserActionService","presenceManagerService","htmlSanitizer","dateFormatService","presenceService","$translate","resources","timeagoCalcService","platformDetectService","profilePictureLoaderService","orchestrationService","analyticsService","callBlockingService","appStateService","sxConfig","flatContactListService",function(e,t,n,r,i,o,a,s,c,l,f,g,v,m,y,b,S,C,P,T,w,k,A,I,L,O,x,E,M,U,_){var j=o.newLogger("LivePersonaCardService"),F=new d.LpcTelemetryHelper(x,o,l),D=F.logPanelActionEvent.bind(F),N=a.getUserTypeInTenant(),R=u.LPCActionCallbackFactory(s,e,j,m,l,c,b,v,E,y,i,D),G=p.LPCDataCallbackFactory(j,l,S,m,r,C,P,i,e,T,w,k,A,I,f,L,E,t,n,N,U,a,_);return new h(e,r,i,a,U,f,g,M,O,o,j,R,G)}])},2257:function(e,t,n){!function(t,n){e.exports=n()}(window,function(){return function(e){function t(t){for(var n,r,o=t[0],a=t[1],s=0,l=[];s<o.length;s++)r=o[s],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&l.push(i[r][0]),i[r]=0;for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n]);for(c&&c(t);l.length;)l.shift()()}function n(t){if(r[t])return r[t].exports;var i=r[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,n),i.l=!0,i.exports}var r={},i={1:0};n.e=function(e){var t=[],r=i[e];if(0!==r)if(r)t.push(r[2]);else{var o=new Promise(function(t,n){r=i[e]=[t,n]});t.push(r[2]=o);var a,s=document.createElement("script");s.charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.src=function(e){return n.p+""+({0:"loggingdependencies",2:"vendors~loggingdependencies"}[e]||e)+"_"+{0:"0ccdd695a0103f8aeb98",2:"58a9bd5d70dd9db494af"}[e]+".js"}(e),0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous");var c=new Error;a=function(t){s.onerror=s.onload=null,clearTimeout(l);var n=i[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+r+": "+o+")",c.name="ChunkLoadError",c.type=r,c.request=o,n[1](c)}i[e]=void 0}};var l=setTimeout(function(){a({type:"timeout",target:s})},12e4);s.onerror=s.onload=a,document.head.appendChild(s)}return Promise.all(t)},n.m=e,n.c=r,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="https://lpcres.delve.office.com/lpc/versionless/",n.oe=function(e){throw console.error(e),e};var o=window.webpackJsonpMidgardBootstrapper=window.webpackJsonpMidgardBootstrapper||[],a=o.push.bind(o);o.push=t,o=o.slice();for(var s=0;s<o.length;s++)t(o[s]);var c=a;return n(n.s=13)}([function(e,t,n){"use strict";t.a={START:"Start",SUCCESS:"Success",EXPECTED_FAILURE:"ExpectedFailure",UNEXPECTED_FAILURE:"UnexpectedFailure",MONITOR_IN_INVALID_STATE:"MonitorInInvalidState"}},function(e,t,n){"use strict";var r=n(2),i="object"==typeof self&&self&&self.Object===Object&&self,o=r.a||i||Function("return this")();t.a=o},function(e,t,n){"use strict";(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.a=n}).call(this,n(12))},function(e,t,n){"use strict";function r(e){return e}n.d(t,"a",function(){return r})},function(e,t,n){"use strict";function r(e){return o.indexOf(e)>-1}function i(e){return-1===a.indexOf(e)}n.d(t,"b",function(){return r}),n.d(t,"a",function(){return i});var o=["Network","RESTAuthToken","TTLCacheUtils","BundleDownload","OfficeFeedIsReadyStatus"],a=["Stikkontakt","DataLoadStartAction","NoLogging","None"]},function(e,t,n){"use strict";t.a={CLIENT_TIMESTAMP:"ClientTimeStamp",TRANSACTION_ID:"QoSTransactionId",SOURCE_CORRELATION_ID:"SourceCorrelationId"}},function(e,n,r){"use strict";(function(e){var i=r(2),o="object"==typeof t&&t&&!t.nodeType&&t,a=o&&"object"==typeof e&&e&&!e.nodeType&&e,s=a&&a.exports===o&&i.a.process,c=function(){try{return a&&a.require&&a.require("util").types||s&&s.binding&&s.binding("util")}catch(e){}}();n.a=c}).call(this,r(9)(e))},function(e,t,n){"use strict";function r(e,t){return e.hasOwnProperty(t)}n.d(t,"a",function(){return r});var i,o=n(1),a=o.a.Symbol,s=Object.prototype,c=s.hasOwnProperty,l=s.toString,u=a?a.toStringTag:void 0,p=function(e){var t=c.call(e,u),n=e[u];try{e[u]=void 0;var r=!0}catch(e){}var i=l.call(e);return r&&(t?e[u]=n:delete e[u]),i},f=Object.prototype.toString,d=function(e){return f.call(e)},h=a?a.toStringTag:void 0,g=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":h&&h in Object(e)?p(e):d(e)},v=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},m=function(e){if(!v(e))return!1;var t=g(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},y=o.a["__core-js_shared__"],b=(i=/[^.]+$/.exec(y&&y.keys&&y.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"",S=function(e){return!!b&&b in e},C=Function.prototype.toString,P=function(e){if(null!=e){try{return C.call(e)}catch(e){}try{return e+""}catch(e){}}return""},T=/^\[object .+?Constructor\]$/,w=Function.prototype,k=Object.prototype,A=w.toString,I=k.hasOwnProperty,L=RegExp("^"+A.call(I).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),O=function(e){return!(!v(e)||S(e))&&(m(e)?L:T).test(P(e))},x=function(e,t){return null==e?void 0:e[t]},E=function(e,t){var n=x(e,t);return O(n)?n:void 0},M=function(){try{var e=E(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),U=function(e,t,n){"__proto__"==t&&M?M(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n},_=function(e,t){return e===t||e!=e&&t!=t},j=Object.prototype.hasOwnProperty,F=function(e,t,n){var r=e[t];j.call(e,t)&&_(r,n)&&(void 0!==n||t in e)||U(e,t,n)},D=function(e,t,n,r){var i=!n;n||(n={});for(var o=-1,a=t.length;++o<a;){var s=t[o],c=r?r(n[s],e[s],s,n,e):void 0;void 0===c&&(c=e[s]),i?U(n,s,c):F(n,s,c)}return n},N=function(e){return e},R=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)},G=Math.max,B=function(e,t,n){return t=G(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,o=G(r.length-t,0),a=Array(o);++i<o;)a[i]=r[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=r[i];return s[t]=n(a),R(e,this,s)}},H=function(e){return function(){return e}},X=M?function(e,t){return M(e,"toString",{configurable:!0,enumerable:!1,value:H(t),writable:!0})}:N,z=Date.now,V=function(e){var t=0,n=0;return function(){var r=z(),i=16-(r-n);if(n=r,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(X),W=function(e,t){return V(B(e,t,N),e+"")},q=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},Q=function(e){return null!=e&&q(e.length)&&!m(e)},J=/^(?:0|[1-9]\d*)$/,$=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&J.test(e))&&e>-1&&e%1==0&&e<t},Z=function(e,t,n){if(!v(n))return!1;var r=typeof t;return!!("number"==r?Q(n)&&$(t,n.length):"string"==r&&t in n)&&_(n[t],e)},K=Object.prototype,Y=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||K)},ee=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r},te=function(e){return null!=e&&"object"==typeof e},ne=function(e){return te(e)&&"[object Arguments]"==g(e)},re=Object.prototype,ie=re.hasOwnProperty,oe=re.propertyIsEnumerable,ae=ne(function(){return arguments}())?ne:function(e){return te(e)&&ie.call(e,"callee")&&!oe.call(e,"callee")},se=Array.isArray,ce=n(10),le={};le["[object Float32Array]"]=le["[object Float64Array]"]=le["[object Int8Array]"]=le["[object Int16Array]"]=le["[object Int32Array]"]=le["[object Uint8Array]"]=le["[object Uint8ClampedArray]"]=le["[object Uint16Array]"]=le["[object Uint32Array]"]=!0,le["[object Arguments]"]=le["[object Array]"]=le["[object ArrayBuffer]"]=le["[object Boolean]"]=le["[object DataView]"]=le["[object Date]"]=le["[object Error]"]=le["[object Function]"]=le["[object Map]"]=le["[object Number]"]=le["[object Object]"]=le["[object RegExp]"]=le["[object Set]"]=le["[object String]"]=le["[object WeakMap]"]=!1;var ue=n(6),pe=ue.a&&ue.a.isTypedArray,fe=pe?function(e){return function(t){return e(t)}}(pe):function(e){return te(e)&&q(e.length)&&!!le[g(e)]},de=Object.prototype.hasOwnProperty,he=function(e,t){var n=se(e),r=!n&&ae(e),i=!n&&!r&&Object(ce.a)(e),o=!n&&!r&&!i&&fe(e),a=n||r||i||o,s=a?ee(e.length,String):[],c=s.length;for(var l in e)!t&&!de.call(e,l)||a&&("length"==l||i&&("offset"==l||"parent"==l)||o&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||$(l,c))||s.push(l);return s},ge=function(e,t){return function(n){return e(t(n))}}(Object.keys,Object),ve=Object.prototype.hasOwnProperty,me=function(e){if(!Y(e))return ge(e);var t=[];for(var n in Object(e))ve.call(e,n)&&"constructor"!=n&&t.push(n);return t},ye=function(e){return Q(e)?he(e):me(e)},be=Object.prototype.hasOwnProperty;!function(e){W(function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,a=i>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,a&&Z(n[0],n[1],a)&&(o=i<3?void 0:o,i=1),t=Object(t);++r<i;){var s=n[r];s&&e(t,s,r,o)}return t})}(function(e,t){if(Y(t)||Q(t))D(t,ye(t),e);else for(var n in t)be.call(t,n)&&F(e,n,t[n])})},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r="Unknown"},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,n,r){"use strict";(function(e){var i=r(1),o=r(11),a="object"==typeof t&&t&&!t.nodeType&&t,s=a&&"object"==typeof e&&e&&!e.nodeType&&e,c=s&&s.exports===a?i.a.Buffer:void 0,l=(c?c.isBuffer:void 0)||o.a;n.a=l}).call(this,r(9)(e))},function(e,t,n){"use strict";t.a=function(){return!1}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";function r(e,t,n){try{n.sessionStorage&&n.sessionStorage.setItem&&n.sessionStorage.setItem(e,t)}catch(e){}}function i(e,t,n){return new Promise(function(i,o){e?(r(_,e,n),i(e)):t(function(e,t){e?(r(_,e,n),i(e)):o(new U("GetAuthTokenError","Auth token is undefined",t))},function(e,t,n){var r=function(e,t){var n=/^AADSTS\d+?:/.test(e),r=function(e,t){if(t&&e){if(e.indexOf("3399942148"))return!0;if(e.indexOf("3399942154"))return!0;if(e.indexOf("nativeWam:3"))return!0}return!1}(e,t);return n||r}(e,n)?e:"";o(new U("GetAuthTokenError",r,t,n))})})}function o(e,t){var n=function(e){return"df"===e?E.Dogfood:"msit"===e?E.MSIT:void 0}(e);return n||(n=function(e){switch(e){case"Df":return E.Dogfood;case"Msit":return E.MSIT;case"Blackforest":return E.Blackforest;case"GccModerate":return E.GccModerate;case"GccHigh":return E.GccHigh;case"DoD":return E.DOD;case"Gallatin":return E.Gallatin;case"Prod":return E.TopLevel;case"AG08":return E.AG08;case"AG09":return E.AG09;case"Unknown":throw new Error("'Unknown' is not an expected environment type in Loki");default:return Object(j.a)(e)}}(t)),n}function a(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t.location.search),r=t.decodeURIComponent||window.decodeURIComponent;return null===n?"":r&&r(n[1].replace(/\+/g," "))||""}function s(e,t,n){return l(function(e,t){var n=t||e.culture,r=o(e.region,e.complianceEnvironment);return N.replace("{0}",r).replace("{1}",n)}(t,a(z,n)),e,B(B({},t),{clientFeature:"LivePersonaCard"}),n)}function c(e,t,n){return l(function(e,t){var n=t||e.culture,r=o(e.region,e.complianceEnvironment);return R.replace("{0}",r).replace("{1}",n)}(t,a(Q,n)),e,B(B({},t),{clientFeature:"LivePersonaEditor"}),n)}function l(e,t,n,r){return new Promise(function(i,o){var s=new XMLHttpRequest;s.open("GET",e,!0),s.setRequestHeader("Authorization","Bearer "+t),s.setRequestHeader("Accept","application/json");var c=G.replace(/[xy]/g,function(e){var t;if(window.crypto){var n=new Uint8Array(1);window.crypto.getRandomValues(n),t=n[0]}else t=Math.floor(16*Math.random());return("x"===e?t%16:t%4+8).toString(16)});s.setRequestHeader("X-RootCorrelationId",c),s.setRequestHeader("X-CorrelationId",c),s.setRequestHeader("X-ClientCorrelationId",n.clientCorrelationId),s.setRequestHeader("X-ClientFeature",n.clientFeature);var l=a($,r)||n.clientType;l&&s.setRequestHeader("X-ClientType",l),n.hostAppRing&&s.setRequestHeader("X-HostAppRing",n.hostAppRing),n.hostAppVersion&&s.setRequestHeader("X-HostAppVersion",n.hostAppVersion),n.hostAppConfiguration&&s.setRequestHeader("X-HostAppConfiguration",JSON.stringify(n.hostAppConfiguration));var u=a(q,r);if(u){var p={};u.split(";").forEach(function(e){var t=e.split(":"),n=t[0],r=t[1];p[n]=r}),s.setRequestHeader(q,JSON.stringify(p))}r&&r.React&&r.React.version&&r.ReactDOM&&s.setRequestHeader("X-HostAppReactVersion",r.React.version);var f=a(V,r)||a(X,r);f&&(s.setRequestHeader(X,f),s.setRequestHeader(V,f));var d=a(J,r);d&&s.setRequestHeader("X-"+J,d);var h=a(W,r);h&&(s.setRequestHeader(W,h),s.setRequestHeader("X-"+W,h)),s.addEventListener("load",function(){if(200===s.status)try{var e=JSON.parse(s.response);e.RootCorrelationId=c,e.LokiVersion=s.getResponseHeader("x-serverversion")||"",i(e)}catch(e){o(new U("GetLokiConfigError","Failed to parse initialization config.",c))}else o(new U("GetLokiConfigError","Couldn't retrieve initialization config. Status code is "+s.status,c,!1,s.status))}),s.addEventListener("error",function(){o(new U("GetLokiConfigError","Couldn't retrieve initialization config, request failed to complete.",c))}),s.addEventListener("timeout",function(){o(new U("GetLokiConfigError","Loki config request timed out after "+H+" ms.",c))}),s.timeout=H,s.send()})}function u(e){var t=e.targetWindow||window,n=re.get(t);return n?n.bootstrapperConfig=ne(ne({},n.bootstrapperConfig),e):n={bootstrapperConfig:ne(ne({},e),{targetWindow:t}),ariaLogger:new te(e),initializationPromise:void 0,forceRefreshInitializationPromise:!1,forceRefreshInitializationTimeout:void 0},re.set(t,n),n}function p(e,t,n){return ie(this,void 0,void 0,function(){var r,i;return oe(this,function(o){switch(o.label){case 0:return(i=u(t)).lpcConfig?(r=i.lpcConfig,[3,3]):[3,1];case 1:return[4,f(e,t,n)];case 2:r=o.sent(),i.lpcConfig=r,o.label=3;case 3:return[2,r]}})})}function f(e,t,n){return ie(this,void 0,void 0,function(){var r,o;return oe(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,8]),[4,s(e,t,n)];case 1:return r=a.sent(),[3,8];case 2:return(o=a.sent()).statusCode&&401===o.statusCode?[4,i(void 0,t.getAuthToken,n)]:[3,4];case 3:e=a.sent(),a.label=4;case 4:return se<ae?(se++,[4,f(e,t,n)]):[3,6];case 5:return r=a.sent(),[3,7];case 6:throw o.numberOfRetries=se,o;case 7:return[3,8];case 8:return[2,r]}})})}function d(e,t){var n=this,r=0,i=function(e,t){return ce(n,void 0,void 0,function(){var n;return le(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,6]),[4,h(e,t)];case 1:return o.sent(),[3,6];case 2:return n=o.sent(),r<ue?(r++,[4,i(e,t)]):[3,4];case 3:return o.sent(),[3,5];case 4:throw n.numberOfRetries=r,n;case 5:return[3,6];case 6:return[2]}})})};return i(e,t)}function h(e,t){return new Promise(function(n,r){var i=t.document.createElement("script");i.type="text/javascript",i.charset="utf-8",i.crossOrigin="anonymous",i.src=e,i.addEventListener("load",function(){n()}),i.addEventListener("error",function(){r(new U("LoadScriptError","Unexpected error while loading script on page."))}),t.document.body.appendChild(i)})}function g(e,t){var n=e.ResourceUrls||[];if(0===n.length){var r=e.Resources[de],i=e.Resources[pe];"OwaPeopleHub"===e.Workload&&(i=e.Resources[fe]),n=[r,i]}return Promise.all(n.map(function(e){return d(e,t)})).then(function(){return n})}function v(e,t){var n=t.targetWindow;return new Promise(function(r,i){setTimeout(function(){try{n.LPC||i(new U("StartLivePersonaCardError","targetWindow.LPC is undefined.")),n.LivePersonaCardStrings&&n.LivePersonaCardStrings.strings||n.LivePersonaCardStringsLpcMini&&n.LivePersonaCardStringsLpcMini.strings||i(new U("StartLivePersonaCardError","targetWindow.LivePersonaCardStrings is undefined."));var o=function(e,t){var n=t.targetWindow;return{refreshAuthToken:m(t),logToExternalApplication:t.logMessage,contextType:t.clientContextType,strings:n.LivePersonaCardStringsLpcMini&&n.LivePersonaCardStringsLpcMini.strings||n.LivePersonaCardStrings&&n.LivePersonaCardStrings.strings,source:t.clientType,consumerCorrelationId:t.clientCorrelationId,activeFlights:e.Flights,isDebug:!1,culture:t.culture,dataCallbacks:t.dataCallbacks,actionCallbacks:t.actionCallbacks,telemetryCallbacks:t.telemetryCallbacks,dataUpdateBroadcaster:t.dataUpdateBroadcaster,privateDataCallbacks:t.privateDataCallbacks,options:t.options?t.options:{hideDocumentFilter:!1},theme:t.theme,lokiUrl:e.LokiUrl,lokiVersion:e.LokiVersion,tenantAadObjectId:e.TenantAadObjectId,userAadObjectId:e.UserAadObjectId,userPuid:e.UserPuid,ecsConfigIds:e.EcsConfigIds,ecsETag:e.EcsEtag,loggedInUserUpn:e.Upn,loggedInUserTeamsMri:t.loggedInUserTeamsMri,complianceEnvironment:t.complianceEnvironment,userDisplayName:e.UserDisplayName}}(e,t);n.LPC.start(o),r()}catch(e){i(new U("StartLivePersonaCardError",e.name))}},0)})}function m(e){return function(t){e.getAuthToken(function(e,n){t(e,"",n,void 0)},function(e,n){t("",e,n,void 0)})}}function y(e){switch(e.complianceEnvironment){case"Blackforest":return ge;case"GccHigh":return ve;case"DoD":return me;case"Gallatin":return ye;case"AG08":return be;case"AG09":return Se;case"GccModerate":case"Prod":default:return he}}function b(e){return{ErrorType:e.name,ErrorMessage:e.message||"",RootCorrelationId:e.rootCorrelationId||"",IsExpected:e.isExpected||!1,IsClientOnline:navigator&&void 0!==typeof navigator.onLine?navigator.onLine:""}}function S(e){var t={};return Object.keys(e).forEach(function(n){t["Perf_"+n]=e[n].toString()}),t}function C(e){return void 0===e||"string"!=typeof e||""===e||null===e}function P(e){return void 0===e||"function"!=typeof e}function T(e){var t="";if(e){var n=[];C(e.culture)&&n.push("culture"),C(e.clientType)&&n.push("clientType"),C(e.clientContextType)&&n.push("clientContextType"),C(e.clientCorrelationId)&&n.push("clientCorrelationId"),P(e.logMessage)&&n.push("logMessage"),P(e.getAuthToken)&&n.push("getAuthToken"),n.length>0&&(t="Invalid required parameter(s): "+n.join(", ")+". Check the values and types you're passing. "),e.region&&-1===Te.indexOf(e.region.toLowerCase().trim())&&(t+="Invalid region value. Allowed values are: empty string for production environments, and "+Te.join(", ")+" for pre-production environments. "),-1===we.indexOf(e.complianceEnvironment)&&(t+="Environment is missing or wrong. Allowed values are: "+we.join(", ")+". We currently don't support other Sovereign Clouds.")}else t="Config must be defined.";if(t)throw new U("ValidateBootstrapperConfigError",t)}function w(e,t,n){return ke(this,void 0,void 0,function(){var r,i;return Ae(this,function(o){switch(o.label){case 0:return(i=u(t)).lpeConfig?(r=i.lpeConfig,[3,3]):[3,1];case 1:return[4,k(e,t,n)];case 2:r=o.sent(),i.lpeConfig=r,o.label=3;case 3:return[2,r]}})})}function k(e,t,n){return ke(this,void 0,void 0,function(){var r,o;return Ae(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,8]),[4,c(e,t,n)];case 1:return r=a.sent(),[3,8];case 2:return(o=a.sent()).statusCode&&401===o.statusCode?[4,i(void 0,t.getAuthToken,n)]:[3,4];case 3:e=a.sent(),a.label=4;case 4:return Le<Ie?(Le++,[4,w(e,t,n)]):[3,6];case 5:return r=a.sent(),[3,7];case 6:throw o.numberOfRetries=Le,o;case 7:return[3,8];case 8:return[2,r]}})})}function A(e,t){if(-1===e.Flights.indexOf(Me))return Promise.reject(new U("LoadLivePersonaEditorScriptError","LPE not enabled",e.RootCorrelationId));var n=[e.Resources[Ee],e.Flights.indexOf(Ue)>-1?e.Resources[Oe]:e.Resources[xe]];return Promise.all(n.map(function(e){return d(e,t)})).then(function(){return n})}function I(e){return je(this,void 0,void 0,function(){var t,n,r=this;return Fe(this,function(o){return!De&&Ce?[2,Ce]:(t=new Pe(window),n=u(e).ariaLogger,De=!1,(Ce=new Promise(function(o,a){return je(r,void 0,void 0,function(){var r,s,c,l,u,p;return Fe(this,function(f){switch(f.label){case 0:r=y(e),f.label=1;case 1:return f.trys.push([1,6,,7]),T(e),t.startCustomTiming(D.getAuthToken),[4,i(e.authToken,e.getAuthToken,window)];case 2:return s=f.sent(),t.endCustomTiming(D.getAuthToken),t.measureFromStart(D.getAuthTokenFromStart),t.startCustomTiming(D.getLokiConfig),[4,w(s,e,window)];case 3:return c=f.sent(),t.endCustomTiming(D.getLokiConfig),t.measureFromStart(D.getLokiConfigFromStart),t.startCustomTiming(D.getLpeBundles),[4,A(c,window)];case 4:return f.sent(),t.endCustomTiming(D.getLpeBundles),t.measureFromStart(D.getLpeBundlesFromStart),[4,n.updateContextWithLokiDataAsync(c,r).catch(function(){console.log("Live Persona Editor ERROR: Bootstrapper failed to initialize Aria, continuing without.")})];case 5:return f.sent(),(l=S(t.getAllTimings())).RootCorrelationId=c.RootCorrelationId,l.isConsumer=e.isConsumer,n.logEventAsync({name:"initializeLivePersonaEditor_success",properties:l},r),o(c),[3,7];case 6:return u=f.sent(),p=S(t.getAllTimings()),n.logEventAsync({name:"initializeLivePersonaEditor_failure",properties:_e(_e(_e({},b(u)),p),{isConsumer:e.isConsumer})},r),a("Failed to initialize Live Persona Editor: "+u.name+" "+u.message),[3,7];case 7:return[2]}})})})).catch(function(){setTimeout(function(){De=!0},M)}),[2,Ce])})})}function L(e){return Re(this,void 0,void 0,function(){var t,n,r,o,a=this;return Ge(this,function(s){return t=u(e),n=function(){return u(e).ariaLogger},!t.forceRefreshInitializationPromise&&t.initializationPromise?[2,t.initializationPromise]:(r=t.bootstrapperConfig.targetWindow,o=new Pe(r),t.forceRefreshInitializationPromise=!1,t.initializationPromise=new Promise(function(s,c){return Re(a,void 0,void 0,function(){var a,l,u,f,d,h;return Ge(this,function(m){switch(m.label){case 0:a=y(e),m.label=1;case 1:return m.trys.push([1,7,,8]),T(e),o.startCustomTiming(D.getAuthToken),[4,i(e.authToken,e.getAuthToken,r)];case 2:return l=m.sent(),o.endCustomTiming(D.getAuthToken),o.measureFromStart(D.getAuthTokenFromStart),o.startCustomTiming(D.getLokiConfig),[4,p(l,e,r)];case 3:return u=m.sent(),o.endCustomTiming(D.getLokiConfig),o.measureFromStart(D.getLokiConfigFromStart),o.startCustomTiming(D.getLpcBundles),[4,g(u,r)];case 4:return m.sent(),o.endCustomTiming(D.getLpcBundles),o.measureFromStart(D.getLpcBundlesFromStart),o.startCustomTiming(D.startLpc),[4,v(u,t.bootstrapperConfig)];case 5:return m.sent(),o.endCustomTiming(D.startLpc),o.measureFromStart(D.startLpcFromStart),[4,n().updateContextWithLokiDataAsync(u,a).catch(function(){console.log("Live Persona Card ERROR: Bootstrapper failed to initialize Aria, continuing without.")})];case 6:return m.sent(),(f=S(o.getAllTimings())).RootCorrelationId=u.RootCorrelationId,f.isConsumer=e.isConsumer,n().logEventAsync({name:"initializeLivePersonaCard_success",properties:f},a),s(),[3,8];case 7:return d=m.sent(),h=S(o.getAllTimings()),n().logEventAsync({name:"initializeLivePersonaCard_failure",properties:Ne(Ne(Ne({},b(d)),h),{isConsumer:e.isConsumer})},a),c("Failed to initialize Live Persona Card: "+d.name+" "+d.message),[3,8];case 8:return[2]}})})}),t.initializationPromise.catch(function(){t.forceRefreshInitializationTimeout=window.setTimeout(function(){t&&(t.forceRefreshInitializationPromise=!0)},M)}),[2,t.initializationPromise])})})}function O(e){!function(e){var t=re.get(e);if(t){var n=t.bootstrapperConfig.targetWindow;n&&(delete n.LPC,delete n.LivePersonaCardHoverTarget,delete n.LivePersonaCardHoverTargetV2,delete n.LivePersonaCardStrings,delete n.LivePersonaCardStringsLpcMini,delete n.MeetingInsightsV2,delete n.MidgardBootstrapper,delete n.PersonaInsightRing,delete n.LPE),delete t.bootstrapperConfig.targetWindow,delete t.ariaLogger,delete t.initializationPromise,delete t.bootstrapperConfig,clearTimeout(t.forceRefreshInitializationTimeout)}re.delete(e)}(e)}function x(e){return Re(this,void 0,void 0,function(){var t;return Ge(this,function(n){switch(n.label){case 0:return t=u(e),[4,i(e.authToken,e.getAuthToken,t.bootstrapperConfig.targetWindow)];case 1:return[2,p(n.sent(),e,t.bootstrapperConfig.targetWindow)]}})})}n.r(t),n.d(t,"initializeLivePersonaEditorAsync",function(){return I}),n.d(t,"initializeLivePersonaCardAsync",function(){return L}),n.d(t,"freeBootstrapperMemory",function(){return O}),n.d(t,"fetchLokiConfigAsync",function(){return x});var E,M=3e5,U=function(e,t,n,r,i,o){this.name=e,this.message=t,this.rootCorrelationId=n,this.isExpected=r,this.statusCode=i,this.numberOfRetries=o},_="LokiAuthToken",j=n(3);!function(e){e.TopLevel="https://loki.delve.office.com",e.Blackforest="https://loki.delve.office.de",e.GccModerate="https://gcc.loki.delve.office.com",e.GccHigh="https://gcchigh.loki.office365.us",e.DOD="https://dod.loki.office365.us",e.Gallatin="https://loki.office365.cn",e.Dogfood="https://df.loki.delve.office.com",e.LegacyDogfood="https://sfdf.loki.delve.office.com",e.MSIT="https://msit.loki.delve.office.com",e.LegacyMSIT="https://sfmsit.loki.delve.office.com",e.AG08="https://loki.officenet.eaglex.ic.gov",e.AG09="https://loki.officenet.microsoft.scloud"}(E||(E={}));var F,D,N="{0}/api/v1/livepersonacard/configuration?cultureName={1}",R="{0}/api/v1/livepersonaeditor/configuration?cultureName={1}",G="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",B=function(){return(B=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},H=6e4,X="LivePersonaCardVersionOverride",z="LivePersonaCardCultureOverride",V="MidgardVersion",W="MidgardBranch",q="HostAppConfiguration",Q="LivePersonaEditorCultureOverride",J="LivePersonaEditorVersionOverride",$="ClientTypeOverride",Z=(n(17),function(){return Promise.all([n.e(2),n.e(0)]).then(n.bind(null,52))}),K=function(){return Z().then(function(e){return e.AWTLogManager})},Y=(F=function(){return Z().then(function(e){return e.Logger})},function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})}),ee=function(e,t){function n(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},te=function(){function e(e){this.bootstrapperConfig=e,this.loggers=new Map}return e.prototype.logEventAsync=function(e,t){return Y(this,void 0,void 0,function(){return ee(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,this.getLoggerAsync(t)];case 1:return n.sent().logEvent(e),[4,K()];case 2:return n.sent().flush(this.noOp),[3,4];case 3:return n.sent(),console.log("Live Persona Card ERROR: Failed to log an event to Aria"),[3,4];case 4:return[2]}})})},e.prototype.updateContextWithLokiDataAsync=function(e,t){return Y(this,void 0,void 0,function(){var n;return ee(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.getLoggerAsync(t)];case 1:return(n=r.sent()).setContext("LokiUrl",e.LokiUrl),n.setContext("tenantAadObjectId",e.TenantAadObjectId),n.setContext("userAadObjectId",e.UserAadObjectId),n.setContext("userPuid",e.UserPuid),[3,3];case 2:throw r.sent(),new Error("Live Persona Card ERROR: Failed to update Aria's context");case 3:return[2]}})})},e.prototype.getLoggerAsync=function(e){return Y(this,void 0,void 0,function(){var t,n,r;return ee(this,function(i){switch(i.label){case 0:return(t=this.loggers.get(e))?[3,3]:[4,K()];case 1:return n=i.sent(),[4,this.getCollectorUrlAsync()];case 2:r=i.sent(),(t=n.initialize(e,{collectorUri:r}))||(t=n.getLogger(e)),this.loggers.set(e,t),t.setContext("culture",this.bootstrapperConfig.culture),t.setContext("region",this.bootstrapperConfig.region),t.setContext("clientType",this.bootstrapperConfig.clientType),t.setContext("clientContextType",this.bootstrapperConfig.clientContextType),t.setContext("clientCorrelationId",this.bootstrapperConfig.clientCorrelationId),t.setContext("bootstrapperVersion","1.20210519.8.0"),t.setContext("complianceEnvironment",this.bootstrapperConfig.complianceEnvironment),i.label=3;case 3:return[2,t]}})})},e.prototype.getCollectorUrlAsync=function(){return Y(this,void 0,void 0,function(){return ee(this,function(e){switch(this.bootstrapperConfig.complianceEnvironment){case"Blackforest":return[2,"https://de.pipe.aria.microsoft.com/Collector/3.0/"];case"GccHigh":return[2,"https://tb.pipe.aria.microsoft.com/Collector/3.0"];case"DoD":return[2,"https://pf.pipe.aria.microsoft.com/Collector/3.0"];case"AG08":case"AG09":return[2,""];case"Gallatin":case"GccModerate":case"Prod":default:return[2,void 0]}return[2]})})},e.prototype.noOp=function(){},e}(),ne=function(){return(ne=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},re=new Map,ie=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},oe=function(e,t){function n(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},ae=2,se=0,ce=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},le=function(e,t){function n(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},ue=2,pe="livepersonacard_with-react",fe="livepersonacard_without-react",de="livepersonacardstrings",he="e5ad760145754ffc9704e67c800087f2-dc72ff20-3e8a-401a-b9a8-ec72e4dd3e22-7257",ge="e5ad760145754ffc9704e67c800087f2-fe4f92a6-9453-4f06-a3f9-52484ba9c6a1-7193",ve="e5ad760145754ffc9704e67c800087f2-5eda57b1-3b30-42c8-a461-bf3c6ee769d8-7057",me="e5ad760145754ffc9704e67c800087f2-e57f210b-942a-4f32-aaa3-2fd7b8d44a62-7359",ye="e5ad760145754ffc9704e67c800087f2-e2685720-0f91-4c64-acd6-32359f3b1c29-6998",be="",Se="";!function(e){e.getAuthToken="GetAuthTokenDuration",e.getAuthTokenFromStart="GetAuthTokenFromStartDuration",e.getLokiConfig="GetLokiConfigDuration",e.getLokiConfigFromStart="GetLokiConfigFromStartDuration",e.getLpcBundles="GetLpcBundlesDuration",e.getLpcBundlesFromStart="GetLpcBundlesFromStartDuration",e.startLpc="StartLpcDuration",e.startLpcFromStart="StartLpcFromStartDuration",e.getOfficeFeedBundles="GetOfficeFeedBundlesFromStartDuration",e.getLpeBundles="GetLpeBundlesDuration",e.getLpeBundlesFromStart="GetLpeBundlesFromStartDuration"}(D||(D={}));var Ce,Pe=function(){function e(e){this.targetWindow=e,this.start=this.getCurrentTime(),this.timings={}}return e.prototype.measureFromStart=function(e){this.timings[e]=Math.round(this.getCurrentTime()-this.start)},e.prototype.startCustomTiming=function(e){try{this.targetWindow.performance.mark(e+"-start")}catch(e){}},e.prototype.endCustomTiming=function(e){try{this.targetWindow.performance.mark(e+"-end"),this.targetWindow.performance.measure(e,e+"-start",e+"-end");var t=this.targetWindow.performance.getEntriesByName(e)[0];this.timings[e]=Math.round(t.duration)}catch(e){}},e.prototype.getAllTimings=function(){var e=this;try{var t=this.targetWindow.performance.getEntriesByType("resource");t&&t.forEach(function(t){if(t&&t.name){var n=t.name.toLowerCase(),r=!1;-1!==n.indexOf("authtoken/loki")?(n="AuthRequestDuration",r=!0):-1!==n.indexOf("service.svc?action=getclientaccesstoken&ep=1&app=mail")?(n="AuthRequestDuration",r=!0):-1!==n.indexOf("/lpc/versionless/livepersonacard_")?(n="LpcBundleRequestDuration",r=!0):-1!==n.indexOf("/lpc/versionless/livepersonacardstrings")?(n="LpcStringsRequestDuration",r=!0):-1!==n.indexOf("/api/v1/configuration/")&&(n="InitConfigRequestDuration",r=!0),r&&(e.timings[n]=Math.round(t.duration))}})}catch(e){}return this.timings},e.prototype.getCurrentTime=function(){return this.targetWindow.performance&&"function"==typeof this.targetWindow.performance.now?performance.now():Date.now()},e}(),Te=["msit","df","ppe"],we=["Prod","Blackforest","GccModerate","GccHigh","DoD","Gallatin","AG08","AG09"],ke=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},Ae=function(e,t){function n(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},Ie=2,Le=0,Oe="livepersonaeditor_with-react",xe="livepersonaeditor_without-react",Ee="livepersonaeditorstrings",Me="iscapiv3enabled",Ue="withreact",_e=function(){return(_e=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},je=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},Fe=function(e,t){function n(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},De=!1,Ne=function(){return(Ne=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Re=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},Ge=function(e,t){function n(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};try{var Be=window.document.createElement("link"),He=Boolean("onmscontentzoom"in window.document);Be.rel=He?"dns-prefetch":"preconnect",Be.href="https://lpcres.delve.office.com/",window.document.head.appendChild(Be)}catch(e){console.log("Live Persona Card ERROR: Bootstrapper failed to warm up the connection to Midgard CDN.",e)}},,,,function(e,t,n){"use strict";function r(){return"object"==typeof window&&window.crypto&&(e=new Uint8Array(31),window.crypto.getRandomValues(e),e)||function(){for(var e=new Array(31),t=0;t<31;t++)e[t]=Math.floor(16*Math.random());return e}();var e}var i=n(20),o=n(8),a=n(5),s=n(0),c=n(4),l=function(){return(l=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},u=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},p=function(e,t){function n(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},f=function(){function e(e,t,n,i,o,a,c){this.eventHubPromise=e,this.monitoringData=t,this.scenarioName=n,this.featureName=i,this.staticProperties=o,this.lookupError=a,this.isVerboseLoggingEnabled=c,this.isFinished=!1,this.isInvalid=!1,this.lastScenarioState=s.a.MONITOR_IN_INVALID_STATE,this.transactionId=function(){for(var e=r(),t=0,n="",i=0;i<36;i++)switch(i){case 8:case 13:case 18:case 23:t+=1,n+="-";break;case 14:t+=1,n+="4";break;case 19:n+=(e[i-t]%4+8).toString(16);break;default:n+=(e[i-t]%16).toString(16)}return n}(),this.start()}return e.prototype.flush=function(){return this.eventHubPromise.then(function(e){return e.broadcastFlush()})},e.prototype.success=function(e,t){this.endEvent(e,s.a.SUCCESS,t)},e.prototype.expectedFailure=function(e,t){this.endEvent(e,s.a.EXPECTED_FAILURE,t)},e.prototype.unexpectedFailure=function(e,t){this.endEvent(e,s.a.UNEXPECTED_FAILURE,t)},e.prototype.dispose=function(){this.isInvalid||!this.isFinished?this.broadcastEvent(void 0,s.a.MONITOR_IN_INVALID_STATE):this.broadcastEvent(this.lastTag,this.lastScenarioState,this.lastProperties)},e.prototype.start=function(){this.startTime=(new Date).getTime()},e.prototype.endEvent=function(e,t,n){this.isFinished&&(this.isInvalid=!0),this.startTime?(this.duration=(new Date).getTime()-this.startTime,this.lastScenarioState=t):this.lastScenarioState=s.a.MONITOR_IN_INVALID_STATE,this.lastTag=e,this.lastProperties=n,this.isFinished=!0,this.dispose()},e.prototype.broadcastEvent=function(e,t,n){return u(this,void 0,void 0,function(){var r,a,s,l,u,f;return p(this,function(p){switch(p.label){case 0:return!Object(c.a)(this.featureName)||Object(c.b)(this.featureName)&&!this.isVerboseLoggingEnabled?[2]:this.scenarioName&&this.monitoringData.source&&this.monitoringData.clientCorrelationId?(r=e?this.scenarioName+"_"+t+"_"+e:this.scenarioName+"_"+t,[4,this.eventHubPromise]):[3,5];case 1:return a=p.sent(),l=(s=a).broadcastEvent,f={eventId:r,version:this.monitoringData.version?this.monitoringData.version:o.a,type:"QoS"},n&&Object(i.a)(n.midgardError)?[4,this.lookupError(n.midgardError)]:[3,3];case 2:return u=p.sent(),[3,4];case 3:u=void 0,p.label=4;case 4:l.apply(s,[(f.midgardError=u,f.source=this.monitoringData.source,f.featureName=this.featureName,f.clientCorrelationid=this.monitoringData.clientCorrelationId,f.qosScenarioName=this.scenarioName,f.qosEventType=t,f.qosTagId=null===e?void 0:e,f.duration=this.duration,f.properties=this.getProperties(n),f)]),p.label=5;case 5:return[2]}})})},e.prototype.getProperties=function(e){var t;return l(l(l(l({},e),((t={})[a.a.CLIENT_TIMESTAMP]=(new Date).getTime().toString(),t[a.a.TRANSACTION_ID]=this.transactionId,t)),this.monitoringData.properties),this.staticProperties())},e}();t.a=f},,,function(e,t,n){"use strict";function r(e){return"object"==typeof e&&!!e&&Object(i.a)(e,"family")&&Object(i.a)(e,"code")&&"string"==typeof e.family&&"number"==typeof e.code}n.d(t,"a",function(){return r});var i=n(7)}])})},2258:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?n(e.value):i(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(a=2&n[0]?o.return:n[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,o=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break}a[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],o=0}finally{i=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var o=n(90),a=function(e,t,n){return function(r){var i={slug:r.peopleSlug||r.slug,groupName:r.groupName||r.teamName,middlePane:r.middlePane,threadId:r.threadId,messageId:void 0,ctx:r.ctx,navCtx:e.navContext.livePersonaCard,appId:null};return n.navigatePromise(t,e.states.appConversation,i)}},s=function(e,t){return function(n,o){return void 0===o&&(o=!1),r(void 0,void 0,void 0,function(){var r;return i(this,function(i){return(r=e.getChatConversationWith(n))?[2,t.placeCall({conversationId:r.id,withVideo:o,context:teamspace.services.CallTelemetryContext.LivePersonCard,checkUserMode:!0,isChannelMeeting:!1})]:[2,Promise.reject("Cannot find the chat")]})})}},c=function(e,t){return function(n,r){var i=e.getChatConversationWith(n);if(!i)return Promise.reject("Cannot find the chat");var o=SkypeX.Services.Utilities.newClientMessageId();return t.createMessage({conversationId:i.id,replyChainId:null,messageSubject:null,messageBody:r,messagePreview:r,fileAttachments:null,extensions:null,mentions:null,inputExtensionAttachments:null,embeddedLinks:null,isHtml:!1,importance:null,clientId:o,externalId:null,draftObjectId:null,inlineImages:null})}},l=function(e,t,n,a,s,c){return function(l,u){var p=l.persona;return r(void 0,void 0,void 0,function(){var r,l,f,d,h,g;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),t.info("LPC::Starting chat"),r=n.getFreshnessInMs(),l=e.scenarios.people.lpcStartChat,[4,n.getAllPeopleProfile([p.TeamsMri],l,!1,!1,r)];case 1:return f=i.sent()[0],d=a.getPrivateChatUserMri(f,l),[4,s({groupName:f.displayName,peopleSlug:d,middlePane:e.messages.panes.conversations,ctx:e.navigation.context.chat})];case 2:return i.sent(),u(!0),c(o.LpcCallbackTelemetryType.lpcStartChat,p.TeamsMri),[3,4];case 3:return h=i.sent(),g="Failed to navigate to chat",t.error(g),u(!1,g),[3,4];case 4:return[2]}})})}},u=function(e,t,n,a,s,c){return function(a,l){return r(void 0,void 0,void 0,function(){var r,u,p,f,d;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),t.info("LPC::Navigating to user's org chart"),r=n.getFreshnessInMs(),u=e.scenarios.people.lpcOrgChart,[4,n.getAllPeopleProfile([a.TeamsMri],u,!1,!1,r)];case 1:return p=i.sent()[0],[4,s({groupName:p.displayName,slug:a.TeamsMri,middlePane:e.peopleTab.panes.organization,ctx:e.navigation.context.chat})];case 2:return i.sent(),l(!0),c(o.LpcCallbackTelemetryType.lpcOrgChart,a.TeamsMri),[3,4];case 3:return f=i.sent(),d="Failed to navigate to org chat",t.error(d),l(!1,d),[3,4];case 4:return[2]}})})}},p=function(e,t,n){return function(a,s){return r(void 0,void 0,void 0,function(){var r,c;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),e.info("LPC::Starting audio call"),[4,t(a.TeamsMri)];case 1:return i.sent(),s(!0),n(o.LpcCallbackTelemetryType.lpcAudioCall,a.TeamsMri),[3,3];case 2:return r=i.sent(),c="Failed to start audio call with",e.error(c),s(!1,c),[3,3];case 3:return[2]}})})}},f=function(e,t,n){return function(a,s){return r(void 0,void 0,void 0,function(){var r,c;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),e.info("LPC::Starting video call"),[4,t(a.TeamsMri,!0)];case 1:return i.sent(),s(!0),n(o.LpcCallbackTelemetryType.lpcVideoCall,a.TeamsMri),[3,3];case 2:return r=i.sent(),c="Failed to start video call with",e.error(c),s(!1,c),[3,3];case 3:return[2]}})})}},d=function(e,t,n){return function(a,s,c){return r(void 0,void 0,void 0,function(){var r,l;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),e.info("LPC::Sending message to user, message length {0}",s&&s.length),[4,t(a.TeamsMri,s)];case 1:return i.sent(),c(!0),n(o.LpcCallbackTelemetryType.lpcQuickIM,a.TeamsMri),[3,3];case 2:return r=i.sent(),l="Failed to send message",e.error(l),c(!1,l),[3,3];case 3:return[2]}})})}},h=function(e,t,n,a){return function(s,c){return r(void 0,void 0,void 0,function(){var r,l,u;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,5,,6]),e.info("LPC::Blocking contact"),(r=t.getChatConversationWith(s.TeamsMri))?[4,t.acceptBlockSfCChat(r.id,!1,"LivePersonaCard")]:[3,2];case 1:return i.sent(),[3,4];case 2:return[4,n.addBlockedMri(s.TeamsMri,"LivePersonaCard")];case 3:i.sent(),i.label=4;case 4:return c(!0),a(o.LpcCallbackTelemetryType.lpcBlockContact,s.TeamsMri),[3,6];case 5:return l=i.sent(),u="Failed to block contact",e.error(u),c(!1,u),[3,6];case 6:return[2]}})})}},g=function(e,t,n,a){return function(s,c){return r(void 0,void 0,void 0,function(){var r,l,u;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,5,,6]),e.info("LPC::Unblocking contact"),(r=t.getChatConversationWith(s.TeamsMri))?[4,t.acceptBlockSfCChat(r.id,!0,"LivePersonaCard")]:[3,2];case 1:return i.sent(),[3,4];case 2:return[4,n.deleteBlockedMri(s.TeamsMri,"LivePersonaCard")];case 3:i.sent(),i.label=4;case 4:return c(!0),a(o.LpcCallbackTelemetryType.lpcUnblockContact,s.TeamsMri),[3,6];case 5:return l=i.sent(),u="Failed to unblock contact",e.error(u),c(!1,u),[3,6];case 6:return[2]}})})}},v=function(e,t,n,a,s){return function(c,l){return r(void 0,void 0,void 0,function(){var r,u,p,f;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),e.info("LPC::Edit Me Profile"),[4,a.getMeMSAProfile(n.scenarios.people.lpcEditProfile,!1)];case 1:return r=i.sent(),u=n.appHeaderBar.buttonid.profileButton,t.open(n.dialogs.updateUserProfile,{isFre:!1,preActiveElementIds:[u],user:r,isMSAEditNameClick:!0}),l(!0),s(o.LpcCallbackTelemetryType.lpcEditMeProfile,c.TeamsMri),[3,3];case 2:return p=i.sent(),f="Failed to edit me user profile",e.error(f),l(!1,f),[3,3];case 3:return[2]}})})}},m=function(e,t,n,a,s){if(n.valueAsBoolean(a.settings.names.enableManageAliasPrivacy))return function(n,c){return r(void 0,void 0,void 0,function(){var r;return i(this,function(i){try{e.info("LPC::Manage discoverability settings"),t.open(a.dialogs.manageAliasPrivacyDialog,{backButtonShouldOpenSettings:!0}),c(!0),s(o.LpcCallbackTelemetryType.lpcManageDiscoverabilitySettings,n.TeamsMri)}catch(t){r="Failed to manage discoverability settings",e.error(r),c(!1,r)}return[2]})})}};t.LPCActionCallbackFactory=function(e,t,n,r,i,o,y,b,S,C,P,T){var w=a(t,e,o),k=s(i,y),A=c(i,b);return{startChat:l(t,n,r,i,w,T),showOrgChart:u(t,n,r,0,w,T),sendQuickMessage:d(n,A,T),startVideoCall:f(n,k,T),startAudioCall:p(n,k,T),blockContact:h(n,i,S,T),unblockContact:g(n,i,S,T),editMeProfile:v(n,C,t,r,T),manageDiscoverabilitySettings:m(n,C,P,t,T)}}},2259:function(e,t,n){"use strict";function r(e){return e&&validator.isEmail(e)}function i(e,t,n){var r=this;return function(i,o,a){return c(r,void 0,void 0,function(){var r,o,s,c,u,p;return l(this,function(l){switch(l.label){case 0:r=t.service.newScenario(n.scenarios.people.lpcGetOrgChart),o=i.TeamsMri||i.Smtp||i.Upn,l.label=1;case 1:return l.trys.push([1,3,,4]),[4,e.getOrgChart(o)];case 2:return(s=l.sent())?(c=f.getDirectReportsAndManager(s.value),r.stop(),a(c,void 0)):(p="No orgChart returned",t.error(p),r.stop({reason:p}),a(void 0,p)),[3,4];case 3:return u=l.sent(),p="Exception in orgChart call",t.error("getOrgChart failed in LPC data callback"),r.fail({reason:p}),a(void 0,p),[3,4];case 4:return[2]}})})}}function o(e,t,n,r,i,o,a){var s=this;return function(u,d,h){return c(s,void 0,void 0,function(){var s,c,d,g,v,m,y,b,S,C,P,T,w,k,A,L,O,x,E;return l(this,function(l){switch(l.label){case 0:s=t.service.newScenario(i.scenarios.people.lpcGetHeaderInfo),c=u.TeamsMri||u.Smtp||u.Upn,l.label=1;case 1:return l.trys.push([1,8,,9]),d=p.deserializeHostAppPersonaId(u.HostAppPersonaId),g=d.isSharedChannel,v=d.hostTenantId,m=d.hostConversationId,y=d.isExchangeOnlyContact,b=void 0,g?[4,e.getAllPeopleProfileForConversation([c],m,!1,i.scenarios.people.lpcGetHeaderInfoSC,void 0,g,v)]:[3,3];case 2:return b=l.sent(),s.mark(i.scenarios.people.lpcGetHeaderInfoSC),[3,7];case 3:return y?[4,f.getPersonaProfileByContactId(u.OlsPersonaId,t,o,s,i.scenarios.people.lpcGetHeaderInfoEC)]:[3,5];case 4:return(b=l.sent())?[3,7]:[2,h(void 0,"No profile returned for exchange contact in LPC getHeaderInfoAndCardType callback")];case 5:return[4,e.getAllPeopleProfile([c],i.scenarios.people.lpcGetHeaderInfo,!Boolean(u.TeamsMri))];case 6:b=l.sent(),s.mark(i.scenarios.people.lpcGetHeaderInfo),l.label=7;case 7:return(S=b[0])?(C=S,P=n.getCurrentSkypeMri(),T=P===u.TeamsMri,w=p.determineCardTypeForTargetUser(C.role,C.type,T),k=r.valueAsBoolean(i.settings.names.showOnlySearchablePhonesAndEmailsInLPC),A=a.isCurrentUserTFLOrMsaAccount(),L=f.getIsMixedChatUser(A,u.TeamsMri,C.type),O=I(w,C,k,L),s.stop(),h(O,void 0)):(E="No profile returned",t.error("getAllPeopleProfile returned no profile in LPC GetHeaderInfoAndCardType callback"),s.fail({reason:E}),h(void 0,E)),[3,9];case 8:return x=l.sent(),E="Exception in profile call",t.error("getAllPeopleProfile failed in LPC GetHeaderInfoAndCardType callback"),s.fail({reason:E}),h(void 0,E),[3,9];case 9:return[2]}})})}}function a(e,t,n,r,i,o){var a=this;return function(s,u){return c(a,void 0,void 0,function(){var a,c,d,h,g,v,m,y,b,S,C,P,T,w,k,A,I,L;return l(this,function(l){switch(l.label){case 0:a=t.service.newScenario(r.scenarios.people.lpcGetPersonaInfo),c=s.TeamsMri||s.Smtp||s.Upn,l.label=1;case 1:return l.trys.push([1,8,,9]),d=p.deserializeHostAppPersonaId(s.HostAppPersonaId),h=d.isSharedChannel,g=d.hostTenantId,v=d.hostConversationId,m=d.isExchangeOnlyContact,y=void 0,h?[4,e.getAllPeopleProfileForConversation([c],v,!1,r.scenarios.people.lpcGetPersonaInfoSC,void 0,h,g)]:[3,3];case 2:return y=l.sent(),a.mark(r.scenarios.people.lpcGetPersonaInfoSC),[3,7];case 3:return m?[4,f.getPersonaProfileByContactId(s.OlsPersonaId,t,i,a,r.scenarios.people.lpcGetPersonaInfoEC)]:[3,5];case 4:return(y=l.sent())?[3,7]:[2,u(void 0,"No profile returned for exchange contact in LPC getPersonaInfo callback")];case 5:return[4,e.getAllPeopleProfile([c],r.scenarios.people.lpcGetPersonaInfo,!Boolean(s.TeamsMri))];case 6:y=l.sent(),a.mark(r.scenarios.people.lpcGetPersonaInfo),l.label=7;case 7:return(b=y[0])?(S=b,C=o.isCurrentUserTFLOrMsaAccount(),P=f.getIsMixedChatUser(C,s.TeamsMri,S.type),T=C&&P,w=h&&!!S.xtapUser,k=n.valueAsBoolean(r.settings.names.showOnlySearchablePhonesAndEmailsInLPC)&&!T,A={hostAppPersonaId:s.HostAppPersonaId,aadObjectId:S.objectId,email:f.getEmail(S,k),extraEmails:f.getEmails(S,k),upn:S.userPrincipalName,userType:p.determineLPCPersonaType(S.role,S.type),displayName:S.displayName,firstName:S.givenName,lastName:S.surname,skypeId:S.skypeId,isInformationBarrierBarred:S.isIbBarred,teamsMri:s.TeamsMri||S.mri,jobTitle:S.jobTitle,department:w?S.tenantName:S.department,officeLocation:S.userLocation,phoneNumbersAndUrls:f.getPhoneNumbers(S,k),isMixedChatUser:P},a.stop(),u(A,void 0)):(L="No profile returned",t.error("getAllPeopleProfile returned no profile in LPC GetPersonaInfo callback"),a.fail({reason:L}),u(void 0,L)),[3,9];case 8:return I=l.sent(),L="Exception in profile call",t.error("getAllPeopleProfile failed in LPC GetPersonaInfo callback"),a.fail({reason:L}),u(void 0,L),[3,9];case 9:return[2]}})})}}var s=this&&this.__assign||function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},c=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?n(e.value):i(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())})},l=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(a=2&n[0]?o.return:n[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,o=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break}a[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],o=0}finally{i=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var u=n(90),p=n(314),f=n(2260);t.convertHTMLEntities=function(e,t){return e=t.decodeHtml(e),e=t.replaceNewlines(e),e=e.replace(/=""/g,"")},t.unescapeHtmlEntities=function(e,n){if(!e)return e;var r=document.createElement("textarea"),i=(new DOMParser).parseFromString(e,"text/html").body.innerHTML.toString(),o=t.convertHTMLEntities(i,n);return r.textContent=o,r.value};var d=function(e,t,n,i,o){return function(a,u){return c(void 0,void 0,void 0,function(){var c,d,h,g,v,m,y,b,S,C,P,T,w,k;return l(this,function(l){switch(l.label){case 0:if(c=e.service.newScenario(n.scenarios.people.lpcGetImageUri),d=p.deserializeHostAppPersonaId(a.HostAppPersonaId),h=d.isSharedChannel,g=d.hostTenantId,v=d.hostConversationId,m=d.isExchangeOnlyContact,y={mri:a.TeamsMri,principalName:a.Upn||a.Smtp||a.TeamsMri,displayName:a.DisplayName||"",size:n.profilePictureSizes.medium},b=!1,S=r(y.principalName),C=h&&!S,a.DisplayName&&!C)return[3,9];P=a.TeamsMri||a.Smtp||a.Upn,l.label=1;case 1:return l.trys.push([1,8,,9]),T=void 0,h?[4,i.getAllPeopleProfileForConversation([P],v,!0,n.scenarios.people.lpcGetImageUriSC,void 0,h,g)]:[3,3];case 2:return T=l.sent(),c.mark(n.scenarios.people.lpcGetImageUriSC),[3,7];case 3:return m?[4,f.getPersonaProfileByContactId(a.OlsPersonaId,e,o,c,n.scenarios.people.lpcGetImageUriEC)]:[3,5];case 4:return T=l.sent(),[3,7];case 5:return[4,i.getAllShortPeopleProfile([P],n.scenarios.people.lpcGetImageUri,!Boolean(a.TeamsMri))];case 6:T=l.sent(),c.mark(n.scenarios.people.lpcGetImageUri),l.label=7;case 7:return(w=T[0])&&(y=s(s({},y),{displayName:w.displayName}),C&&(y=s(s({},y),{principalName:w.userPrincipalName})),w.isIbBarred&&(b=!0)),[3,9];case 8:return k=l.sent(),e.error("Failed to fetch persona profile in getAndPrefetchPersonaImageUri callback"),[3,9];case 9:return h&&(y=s(s({},y),{isSharedChannel:h,hostTenantId:g,conversationId:v})),m&&(y=s(s({},y),{isExchangeOnlyContact:m})),t.loadImage(y,!1,b,!1,h?n.scenarios.people.lpcGetImageUriSC:n.scenarios.people.lpcGetImageUri).then(function(e){var t=e&&e.imgUrl||"";c.stop(),u(t,{})}).catch(function(e){c.fail({reason:"Failed to fetch persona"}),u(void 0,void 0,e)}),[2]}})})}};t.getSkypeConsumerChatStatus=function(e,t,n){var r=t.findConversationWith(n);if(r&&r.isSfC())return r.InteropConversationStatus()===e.interopConversationStatus.blocked?u.PersonaPresence.blocked:u.PersonaPresence.none};var h=function(e,n,r,i,o,a){var s=t.getSkypeConsumerChatStatus(r,i,a);if(void 0!==s)return s;if(o.isBlockedContact(a))return u.PersonaPresence.blocked;var c=e.status,l=e.flwPresence;if(n.valueAsBoolean(r.settings.names.enableFlwPresence)){if(l===SkypeX.Services.UserFlwPresence.OffShift)return u.PersonaPresence.offline;if(l===SkypeX.Services.UserFlwPresence.OnShift)switch(c){case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.OnThePhone:case SkypeX.Services.UserStatus.InAMeeting:return u.PersonaPresence.busy;default:return u.PersonaPresence.online}}switch(c){case SkypeX.Services.UserStatus.Online:return u.PersonaPresence.online;case SkypeX.Services.UserStatus.Offline:case SkypeX.Services.UserStatus.OutOfOffice:case SkypeX.Services.UserStatus.Unknown:return u.PersonaPresence.offline;case SkypeX.Services.UserStatus.Away:case SkypeX.Services.UserStatus.Idle:case SkypeX.Services.UserStatus.BeRightBack:case SkypeX.Services.UserStatus.AppearAway:return u.PersonaPresence.away;case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.InAMeeting:case SkypeX.Services.UserStatus.OnThePhone:return u.PersonaPresence.busy;case SkypeX.Services.UserStatus.OutToLunch:case SkypeX.Services.UserStatus.Presenting:case SkypeX.Services.UserStatus.Focusing:return u.PersonaPresence.dnd;default:return u.PersonaPresence.offline}},g=function(e,t,n,r,i,o,a){if(!t||0===t.length)return e;var s=r.getLocalTimezone();if(n&&s!==n){var c=(new Date).toLocaleDateString(i.getLocale(),{timeZoneName:"short"}).split(" "),l=c.length>0?c[c.length-1]:null;l&&(t=o.instant(a.strings.person_card_on_shift_end_time_with_timezone,{shiftEndTime:t,timeZoneCode:l}))}return o.instant(a.strings.person_card_on_shift_status_label,{onShiftStatus:e,shiftEndTime:t})},v=function(e,t,n,r,i,o,a,s,c){var l=e.status,u=e.calendarData,p=e.lastSeenAt,f=e.flwPresence,d=e.extensions;if(t.valueAsBoolean(i.settings.names.enableFlwPresence)){if(f===SkypeX.Services.UserFlwPresence.OffShift)return n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OffShift);if(f===SkypeX.Services.UserFlwPresence.OnShift){var h=void 0,v=void 0,m=SkypeX.Services.UnifiedPresenceExtensionsParser.getShiftsData(d);switch(m&&m.currentShift&&(h=c.getDate(new Date(m.currentShift.endTime),"shortTime"),v=m.currentShift.teamOlsonCode),l){case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.OnThePhone:case SkypeX.Services.UserStatus.InAMeeting:case SkypeX.Services.UserStatus.Presenting:var y=r.instant(o.strings.status_label_person_card_with_primary_and_secondary_status,{primaryStatus:n.GetTranslatedStatusText(l),secondaryStatus:n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OnShift)});return g(y,h,v,s,c,r,o);default:var b=n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OnShift);return g(b,h,v,s,c,r,o)}}}var S=p&&(new Date).getTime()-p.getTime()<=i.timeInMiliseconds.year;if(u&&u.isOutOfOffice)switch(l){case SkypeX.Services.UserStatus.Online:case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.OnThePhone:case SkypeX.Services.UserStatus.InAMeeting:case SkypeX.Services.UserStatus.OutToLunch:case SkypeX.Services.UserStatus.Presenting:case SkypeX.Services.UserStatus.Focusing:return r.instant(o.strings.status_label_person_card_with_primary_and_secondary_status,{primaryStatus:n.GetTranslatedStatusText(l),secondaryStatus:n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OutOfOffice)});case SkypeX.Services.UserStatus.Away:case SkypeX.Services.UserStatus.BeRightBack:case SkypeX.Services.UserStatus.Idle:case SkypeX.Services.UserStatus.Offline:return S?r.instant(o.strings.person_card_last_seen_time_with_prefix,{lastSeenTime:a.transformIntoTimeago(p)}):n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OutOfOffice);default:return n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OutOfOffice)}else switch(l){case SkypeX.Services.UserStatus.Away:case SkypeX.Services.UserStatus.BeRightBack:case SkypeX.Services.UserStatus.Idle:case SkypeX.Services.UserStatus.Offline:return S?r.instant(o.strings.person_card_last_seen_time_with_prefix,{lastSeenTime:a.transformIntoTimeago(p)}):n.GetTranslatedStatusText(l);default:return n.GetTranslatedStatusText(l)}},m=function(e,t,n,r,i){var o="";return e.calendarData&&e.calendarData.outOfOfficeNote&&e.calendarData.outOfOfficeNote.message&&(o=r.stripHtml(i.sanitizeHtml(e.calendarData.outOfOfficeNote.message)).trim()),o},y=function(e,t,n,r,i,o){var a={message:"",publishTime:""};if(e.note){var s=e.note.message,c=e.note.publishTime;if(c&&c.trim()){var l=new Date(c);a.publishTime=o.getMessageDisplayableDateTime(l)}if(s){var u=r.stripHtml(i.sanitizeHtml(s)).trim(),p=m(e,0,0,r,i);u.length&&!p.length&&(a.message=u)}}return a.message&&a.publishTime?a:void 0},b=function(e,n,r,i){var o=[],a=function(i){_.each(i,function(i){if("span"===i.name&&i.attribs&&i.attribs.itemtype===n.semanticObjectSchemas.mention&&i.attribs["data-itemprops"]){var s=r.DomUtils.getText(i),c=e.decodeHtml(i.attribs["data-itemprops"]),l=f.removeZeroWidthSpace(c),u=JSON.parse(l).mri;o.push({text:t.unescapeHtmlEntities(s,e),hostAppPersonaId:u,mri:u})}else"text"===i.type?o.push({text:t.unescapeHtmlEntities(r.DomUtils.getText(i),e),hostAppPersonaId:void 0}):"br"===i.name?o.push({text:" ",hostAppPersonaId:void 0}):i.children&&i.children.length>0&&a(i.children)})};return a(i),o},S=function(e,t,n,r,i,o){if(t.valueAsBoolean(n.settings.names.enableStatusNoteV2)&&e.note){var a={message:[],publishTime:""},s=e.note.message,c=e.note.publishTime;if(s){var l=i.sanitizeHtml(s).trim(),u=window.htmlparser2,p=u.parseDOM("<div>"+l+"</div>"),f=b(r,n,u,p);a.message=f}if(c&&c.trim()){var d=new Date(c);a.publishTime=o.getMessageDisplayableDateTime(d)}return a.message.length&&a.publishTime?a:void 0}},C=function(e,t,n,r,i,o,a,s,c,l,u,p,f,d){return function(g,b){var C=e.getPresence(g,b);return{presence:h(C,i,o,f,d,g),isOutOfOffice:C&&!!C.calendarData&&!!C.calendarData.isOutOfOffice,oofMessage:C&&m(C,0,0,t,n),presenceText:C&&v(C,i,a,s,o,c,l,u,p),statusNote:C&&y(C,0,0,t,n,r),statusNoteV2:C&&S(C,i,o,t,n,r)}}},P=function(e){return function(t){var n=e.findConversationWith(t);return n&&n.isInteropChat()?SkypeX.Services.PresenceSource.SFB:SkypeX.Services.PresenceSource.UPS}},T=function(e,t,n,r,i,o,a,s,c,l,u,f,d,h,g){return function(v,m){if(p.deserializeHostAppPersonaId(v.HostAppPersonaId).isExchangeOnlyContact)return m(null,void 0);var y=g.service.newScenario(a.scenarios.people.lpcGetRichPresence),b=P(e),S=C(t,n,r,i,o,a,s,c,l,u,f,d,e,h)(v.TeamsMri,b(v.TeamsMri));y.stop(),m(S,void 0)}},w=function(e,t,n,r,i,o,a,s,u){return function(d){return c(void 0,void 0,void 0,function(){var c,h,g,v,m,y,b,S,C,P,T,w,k,A,I,L,O,x,E,M,U,_,j,F,D,N,R,G,B;return l(this,function(l){switch(l.label){case 0:if(c=r.service.newScenario(i.scenarios.people.lpcGetHeaderActionsPolicy),h=u.getCurrentSkypeMri(),g=h===d.TeamsMri,v=p.deserializeHostAppPersonaId(d.HostAppPersonaId),m=v.isSharedChannel,y=v.hostTenantId,b=v.hostConversationId,S=v.isExchangeOnlyContact,g||S)return g?c.stop({reason:"User is me"}):c.stop({reason:"Out-of-tenant outlook Contact"}),[2,{disableChat:!0,disableOrg:!0,disableCall:!0,disableVideo:!0,disableBlockUnblock:!0}];if(C=!s.isCurrentUserTFLOrMsaAccount(),P={disableChat:!1,disableOrg:!0,disableCall:!1,disableVideo:!1,disableBlockUnblock:C},T=a.isBlockedContact(d.TeamsMri))return c.stop({reason:"Blocked Contact"}),[2,{disableChat:!0,disableOrg:!0,disableCall:!0,disableVideo:!0,disableBlockUnblock:C}];w=e.getSettingValue(SkypeX.Services.CallingPolicyStorageKey.allowPrivateCalling),P.disableCall=!w,P.disableVideo=!w,k=t.getSettingValue(SkypeX.Services.MessagingPolicySettingsStorageKey.allowUserChat),l.label=1;case 1:return l.trys.push([1,6,,7]),A=void 0,m?[4,n.getAllPeopleProfileForConversation([d.TeamsMri],b,!1,i.scenarios.people.lpcGetHeaderActionsPolicySC,void 0,m,y)]:[3,3];case 2:return A=l.sent(),c.mark(i.scenarios.people.lpcGetHeaderActionsPolicySC),[3,5];case 3:return[4,n.getAllPeopleProfile([d.TeamsMri],i.scenarios.people.lpcGetHeaderActionsPolicy,!d.TeamsMri)];case 4:A=l.sent(),c.mark(i.scenarios.people.lpcGetHeaderActionsPolicy),l.label=5;case 5:if(I=A[0]){if(L=I.featureSettings,O=I.type,x=I.userType,E=I.isAnonymousUser,M=I.mri,U=I.isIbBarred,E||U)return E?c.stop({reason:"Anonymous User"}):c.stop({reason:"IB Barred User"}),[2,{disableChat:!0,disableOrg:!0,disableCall:!0,disableVideo:!0,disableBlockUnblock:!0}];if(_=s.isCurrentUserTFLOrMsaAccount(),j=f.getIsMixedChatUser(_,d.TeamsMri,I.type))return[2,{disableChat:!1,disableOrg:!0,disableCall:!0,disableVideo:!0,disableBlockUnblock:C}];if(F=SkypeX.Services.ChatServiceUtils.isPstnMri(M))return c.stop({reason:"PSTN User"}),[2,{disableChat:!0,disableOrg:!0,disableCall:!1,disableVideo:!0,disableBlockUnblock:!0}];D=L&&L.isPrivateChatEnabled,N=O&&O.toLowerCase()===i.userTypes.person.toLowerCase(),R=x&&x.toLowerCase()===i.userTypes.guest.toLowerCase(),G=o===teamspace.services.UserTypeInTenant.Guest,P.disableChat=!1===D||!k,P.disableOrg=!(N&&!R)||G,c.stop()}return[3,7];case 6:return B=l.sent(),c.fail({reason:"Error while fetching persona"}),r.error("Failed to fetch persona profile in LPC data callbacks"),[3,7];case 7:return[2,P]}})})}},k=function(e,t,n,r){var i=f.getEmail(t,n);return{cardType:e,headerInfo:{userHeaderInfo:{displayName:t.displayName,firstName:t.givenName,lastName:t.surname,title:t.jobTitle,department:t.department,location:t.userLocation,profilePictureUrl:t.imageUri,mobilePhone:t.mobile,phone:f.getPhoneNumber(t,n),userPrincipalName:t.userPrincipalName,email:i&&i.Address,imAddress:t.skypeId},isMixedChatUser:r}}},A=function(e,t){return{cardType:e,headerInfo:{unresolvedHeaderInfo:{email:t}}}},I=function(e,t,n,r){return"NotResolved"===e?A(e,t.email):k(e,t,n,r)};t.makeGetHeaderInfoAndCardTypeCallback=o,t.GetPresenceSourceFunction=P,t.GetRichPresenceFunction=C,t.LPCDataCallbackFactory=function(e,t,n,r,s,c,l,u,p,f,h,g,v,m,y,b,S,C,P,k,A,I,L){return{getAndPrefetchPersonaImageUri:d(e,b,p,r,L),getRichPresence:T(t,n,s,c,l,u,p,f,h,g,v,m,y,S,e),getHeaderActionsPolicyAsync:w(C,P,r,e,p,k,S,I,A),getPersonaInfo:a(r,e,u,p,L,I),getOrgChart:i(r,e,p),getHeaderInfoAndCardType:o(r,e,A,u,p,L,I)}}},2260:function(e,t,n){"use strict";function r(e,t){var n=[];return e.emailsInfo&&e.emailsInfo.forEach(function(e){!e.searchable&&t||n.push({Address:e.address})}),n}function i(e,t){if(t){var n=[];return e.phonesInfo&&e.phonesInfo.forEach(function(e){e.searchable&&n.push({PhoneNumber:e.number,Type:"Home",PhoneUrl:"tel:"+e.number})}),n}var r=[];return e.phones&&e.phones.length>0&&e.phones.forEach(function(e){return r.push({PhoneNumber:e.number,PhoneUrl:"tel:"+e.number,Type:e.type})}),e.telephoneNumber&&r.push({PhoneNumber:e.telephoneNumber,PhoneUrl:"tel:"+e.telephoneNumber,Type:"Business"}),r}var o=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?n(e.value):i(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(a=2&n[0]?o.return:n[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,o=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break}a[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],o=0}finally{i=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0}),t.getDirectReportsAndManager=function(e){return{Managers:e.filter(function(e){return 1===e.managerLevel}).map(function(e){return{DisplayName:e.displayName,Smtp:e.smtpAddresses[0],Department:e.department,JobTitle:e.jobTitle}}),Directs:e.filter(function(e){return!e.userClassification}).map(function(e){return{DisplayName:e.displayName,Smtp:e.smtpAddresses[0],Department:e.department,JobTitle:e.jobTitle}})}},t.getEmails=r,t.getEmail=function(e,t){if(!t)return e.email?{Address:e.email}:void 0;var n=r(e,t);return n.length>0?n[0]:void 0},t.getPhoneNumbers=i,t.getPhoneNumber=function(e,t){if(t){var n=i(e,t);if(n.length>0){var r=n[0];return{number:r.PhoneNumber,type:r.Type,url:r.PhoneUrl}}}else{if(e.telephoneNumber)return{number:e.telephoneNumber,type:"Business",url:"tel:"+e.telephoneNumber};if(e.phones&&e.phones.length>0){var o=e.phones[0];return{number:o.number,type:o.type,url:"tel:"+o.number}}}},t.removeZeroWidthSpace=function(e){var t=/[\u200B-\u200D\uFEFF]/g;return e.replace(t,"")},t.getPersonaProfileByContactId=function(e,t,n,r,i){return o(this,void 0,void 0,function(){var o,s,c;return a(this,function(a){switch(a.label){case 0:return e?[4,n.getCachedExchangeContactById(e)]:[3,2];case 1:return(s=a.sent())?o=[{displayName:n.getDisplayNameForUserContact(s),id:s.id,jobTitle:s.jobTitle,mri:s.mri,phones:s.phones,email:s.emails[0]||"",objectId:s.id}]:(c="No profile returned for exchange contact",t.error("getCachedExchangeContactById returned no profile in LPC {0}",i),r.fail({reason:c})),[3,3];case 2:c="Empty OlsPersonaId to look for Exchange contact profile",t.error("Empty OlsPersonaId to look for Exchange contact profile in LPC {0}",i),r.fail({reason:c}),a.label=3;case 3:return o&&r.mark(i),[2,o]}})})},t.getIsMixedChatUser=function(e,t,n){var r=t&&SkypeX.Services.ChatServiceUtils.isTeamsMri(t),i=e&&r||!e&&"TflConsumer"===n;return Boolean(i)}},2261:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2262);t.defaultTheme=r.defaultTheme;var i=n(2263);t.darkTheme=i.darkTheme;var o=n(2264);t.highContrastTheme=o.highContrastTheme},2262:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="rgba(37,36,36,0.75)",i={themePrimary:r,themeSecondary:r,neutralPrimary:"#252424",neutralSecondary:r,neutralLight:"#FAF9F8",neutralLighter:"#f3f2f1",neutralLighterAlt:"#ffffff",neutralPrimaryAlt:"#FAF9F8",neutralSecondaryAlt:"#2A2828",neutralTertiary:"#c8c6c4",neutralTertiaryAlt:"#FAF9F8",neutralQuaternary:"#f3f2f1",neutralQuaternaryAlt:"#ffffff",purple:"#6264a7",magenta:"#943670",magentaDark:"rgba(148,54,112,0.05)"};t.defaultTheme={palette:i}},2263:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fontColor="rgba(255,255,255,0.75)",t.white="#2d2c2c",t.darkThemePalette={themePrimary:t.fontColor,themeSecondary:t.fontColor,neutralPrimary:"#ffffff",neutralSecondary:t.fontColor,neutralLight:"#3b3a39",neutralLighter:"#201F1F",neutralLighterAlt:t.white,neutralPrimaryAlt:"#3B3A3A",neutralSecondaryAlt:t.fontColor,neutralTertiary:"#605e5c",neutralTertiaryAlt:"#3b3a39",neutralQuaternary:"#201F1F",neutralQuaternaryAlt:"#201F1F",white:t.white,purple:"#a6a7dc",magenta:"#ae3d84",magentaDark:"rgba(207,96,152,0.1)",black:"#ffffff"},t.darkTheme={palette:t.darkThemePalette}},2264:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="#000000",i="#ffffff",o={themePrimary:"#ffffff",themeSecondary:"#ffffff",neutralPrimary:i,neutralSecondary:"#ffffff",neutralLight:r,neutralLighter:i,neutralLighterAlt:i,neutralPrimaryAlt:r,neutralSecondaryAlt:"#ffffff",neutralTertiary:"#30f42c",neutralTertiaryAlt:r,neutralQuaternary:r,neutralQuaternaryAlt:i,white:r,black:i,purple:"#ffff00",magenta:i,magentaDark:r};t.highContrastTheme={palette:o}},2265:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=teamspace.components.PanelActionGesture,i=teamspace.components.PanelActionOutcome,o=teamspace.components.PanelActionScenario,a=teamspace.components.PanelActionScenarioType,s=teamspace.components.PanelModuleName,c=teamspace.components.PanelModuleType,l=teamspace.components.WorkLoad,u=teamspace.components.SubWorkLoad,p=n(90),f=function(){function e(e,t,n){this.analyticsService=e,this.loggingService=t,this.conversationsService=n}return e.prototype.logPanelActionEvent=function(e,t){var n,f,d,h,g,v,m=this,y=c.people,b=i.nav,S=i.nav,C=a.people,P=teamspace.PanelRegion.popover,T=l.chatContent,w=u.composeMsg;switch(e){case p.LpcCallbackTelemetryType.lpcAudioCall:f=r.click,d=o.navCalling,h=s.lpcAudioCall,n="lpcAudioCall";break;case p.LpcCallbackTelemetryType.lpcStartChat:f=r.click,d=o.navChat,h=s.lpcStartChat,n="lpcStartChat";break;case p.LpcCallbackTelemetryType.lpcOrgChart:f=r.click,d=o.orgChart,h=s.lpcOrgChart,n="lpcOrgChart";break;case p.LpcCallbackTelemetryType.lpcQuickIM:f=r.click,b=i.submit,S=i.submit,d=o.quickIM,h=s.lpcQuickIM,g=s.sendButton,v=c.compose,n="lpcQuickIM";break;case p.LpcCallbackTelemetryType.lpcVideoCall:f=r.click,d=o.navCalling,h=s.lpcVideoCall,n="lpcVideoCall";break;case p.LpcCallbackTelemetryType.lpcBlockContact:f=r.click,d=o.blockUser,h=s.lpcBlockContact,n="lpcBlockContact";break;case p.LpcCallbackTelemetryType.lpcUnblockContact:f=r.click,d=o.unblockUser,h=s.lpcUnblockContact,n="lpcUnblockContact";break;default:return}var k={action:{gesture:f,outcome:b,outcomeNew:S,scenario:d?teamspace.shared.AttributeHelper.tryGetEnum(d.toString(),o,this.loggingService):null,scenarioType:C?teamspace.shared.AttributeHelper.tryGetEnum(C.toString(),a,this.loggingService):null,workLoad:teamspace.shared.AttributeHelper.tryGetEnum(T.toString(),l,this.loggingService),subWorkLoad:teamspace.shared.AttributeHelper.tryGetEnum(w.toString(),u,this.loggingService)},module:{name:h?teamspace.shared.AttributeHelper.tryGetEnum(h.toString(),s,this.loggingService):null,nameNew:g?teamspace.shared.AttributeHelper.tryGetEnum(g.toString(),s,this.loggingService):null,type:y?teamspace.shared.AttributeHelper.tryGetEnum(y.toString(),c,this.loggingService):null,typeNew:v?teamspace.shared.AttributeHelper.tryGetEnum(v.toString(),c,this.loggingService):null,summary:n},targetThread:this.getTargetThreadType(t)};this.analyticsService.getAnalyticsPanelActionEventData(k,P).then(function(e){m.analyticsService.sendPanelAction(e)})},e.prototype.getTargetThreadType=function(e){if(!e)return null;var t=this.conversationsService.getConversation(e);return{type:t&&t.conversationType||"OneOnOneChat"}},e}();t.LpcTelemetryHelper=f},314:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.determineLPCPersonaType=function(e,t){switch(t){case"Federated":case"SkypeConsumer":return"External";case"person":return"Guest"===e?"NotResolved":"User";default:return"User"}},t.determineCardTypeForTargetUser=function(e,t,n){if(n)return"Me";switch(t){case"Federated":case"SkypeConsumer":case"TflConsumer":return"External";case"person":return"Guest"===e?"NotResolved":"User";default:return"User"}},t.getCleanUpn=function(e){return!e||SkypeX.Services.ChatServiceUtils.isMri(e)?void 0:e},t.serializeHostAppPersonaId=function(e){return JSON.stringify(e)},t.deserializeHostAppPersonaId=function(e){if(!e)return{userId:void 0,isSharedChannel:!1,hostTenantId:void 0,hostConversationId:void 0,isExchangeOnlyContact:!1};var t=JSON.parse(e);return{userId:t.userId,isSharedChannel:!0===t.isSharedChannel,hostTenantId:t.hostTenantId,hostConversationId:t.hostConversationId,isExchangeOnlyContact:!0===t.isExchangeOnlyContact}}},90:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.none=0]="none",e[e.offline=1]="offline",e[e.online=2]="online",e[e.away=3]="away",e[e.dnd=4]="dnd",e[e.blocked=5]="blocked",e[e.busy=6]="busy",e[e.oof=7]="oof"}(t.PersonaPresence||(t.PersonaPresence={}));!function(e){e.Default="default",e.HighContrast="contrast",e.Dark="dark",e.DefaultV2="defaultV2",e.DarkV2="darkV2"}(t.LpcTheme||(t.LpcTheme={}));!function(e){e[e.lpcAudioCall=0]="lpcAudioCall",e[e.lpcStartChat=1]="lpcStartChat",e[e.lpcEditMeProfile=2]="lpcEditMeProfile",e[e.lpcOrgChart=3]="lpcOrgChart",e[e.lpcQuickIM=4]="lpcQuickIM",e[e.lpcVideoCall=5]="lpcVideoCall",e[e.lpcBlockContact=6]="lpcBlockContact",e[e.lpcUnblockContact=7]="lpcUnblockContact",e[e.lpcManageDiscoverabilitySettings=8]="lpcManageDiscoverabilitySettings",e[e.personImageCallback=9]="personImageCallback",e[e.richPresenceCallback=10]="richPresenceCallback"}(t.LpcCallbackTelemetryType||(t.LpcCallbackTelemetryType={}))}},[2255]);