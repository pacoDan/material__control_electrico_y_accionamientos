(window.webPackBridgeJsonp=window.webPackBridgeJsonp||[]).push([[16],{cf694d8109b055738d55:function(e,t,n){"use strict";var i=n("64328bb588b46459132d"),a=n("56e93fab5efcffbf24fb"),l=n("e88a8106e72c3f2e7fd4"),r=n("2cb027059b5fbe2cc8a6"),o=n("640a68d4e52093ac8444"),s=n("6871d1ea20c032a12e30"),g=n("06c58f420a0677aad466"),d=n("d3bb8f02f954659262db"),c=n("604f694397cd1f47d3c5"),u={allowBroadcastSchedulingPolicy:"allowBroadcastSchedulingPolicy",allowChannelMeetingSchedulingPolicy:"allowChannelMeetingSchedulingPolicy",allowEngagementReportPolicy:"allowEngagementReportPolicy",allowFluidCollaboratePolicy:"allowFluidCollaboratePolicy",allowMeetingRegistrationPolicy:"allowMeetingRegistrationPolicy",allowPrivateMeetingSchedulingPolicy:"allowPrivateMeetingSchedulingPolicy",calendarAgendaPagePollingInterval:"calendarAgendaPagePollingInterval",calendarEventsPollIntervalInMs:"calendarEventsPollIntervalInMs",calendarRESTEnabledAPIs:"calendarRESTEnabledAPIs",debounceSchedulingFormPeoplePickerGuestSearchinMillis:"debounceSchedulingFormPeoplePickerGuestSearchinMillis",disableCalendarFeaturesInMultiwindow:"disableCalendarFeaturesInMultiwindow",disableFormOptimization:"disableFormOptimization",enableAllowFluidCollaboratePolicyBypass:"enableAllowFluidCollaboratePolicyBypass",enableAppsGalleryinMeetingChat:"enableAppsGalleryinMeetingChat",enableAutoEnableFluidWithAttendee:"enableAutoEnableFluidWithAttendee",enableBIMCalendarSurface:"enableBIMCalendarSurface",enableCalendarAgendaView:"enableCalendarAgendaView",enableCalendarAttachments:"enableCalendarAttachments",enableCalendarBIMSpecificOperations:"enableCalendarBIMSpecificOperations",enableCalendarCategories:"enableCalendarCategories",enableCalendarCopyLink:"enableCalendarCopyLink",enableCalendarDialogBridge:"enableCalendarDialogBridge",enableCalendarEventGroupChiclet:"enableCalendarEventGroupChiclet",enableCalendarEventsBackgroundSync:"enableCalendarEventsBackgroundSync",enableCalendarEventsPrefetchPrevNextWeek:"enableCalendarEventsPrefetchPrevNextWeek",enableCalendarExtensibilityTabs:"enableCalendarExtensibilityTabs",enableCalendarOnlineOfflineMeeting:"enableCalendarOnlineOfflineMeeting",enableCalendarOnlineOfflineChannelMeeting:"enableCalendarOnlineOfflineChannelMeeting",enableCalendarJoinButtonWithIcon:"enableCalendarJoinButtonWithIcon",enableCalendarNavBarNavigationIcons:"enableCalendarNavBarNavigationIcons",enableCalendarNavBarViewModeSelector:"enableCalendarNavBarViewModeSelector",enableCalendarNstarExtensibilityTabs:"enableCalendarNstarExtensibilityTabs",enableCalendarSchedulingFormNewPeoplePill:"enableCalendarSchedulingFormNewPeoplePill",enableCalendarSchedulingFormPreReleaseFeatures:"enableCalendarSchedulingFormPreReleaseFeatures",enableCalendarShareLinkDialog:"enableCalendarShareLinkDialog",enableCalendarShareLinkDialogPostMeetingCreation:"enableCalendarShareLinkDialogPostMeetingCreation",enableCalendarSyncEngine:"enableCalendarSyncEngine",enableCalendarTenantCheckForPeopleSearch:"enableCalendarTenantCheckForPeopleSearch",enableCalendarV2ApiService:"enableCalendarV2ApiService",enableCalendarV2ApiServiceEnterprise:"enableCalendarV2ApiServiceEnterprise",enableCalendarV2EventForwarding:"enableCalendarV2EventForwarding",enableCalendarV2MeetingPrep:"enableCalendarV2MeetingPrep",enableCalendarV2PreReleaseFeatures:"enableCalendarV2PreReleaseFeatures",enableCalendarV2ShowAs:"enableCalendarV2ShowAs",enableCallTranscriptPostMeetingSpeakerAttribution:"enableCallTranscriptPostMeetingSpeakerAttribution",enableCallTranscriptPostMeetingSpeakerAttributionEdit:"enableCallTranscriptPostMeetingSpeakerAttributionEdit",enableEngagementReportPolicyCheck:"enableEngagementReportPolicyCheck",enableEngagementReportPolicyTestHook:"enableEngagementReportPolicyTestHook",enableFreemiumAgendaView:"enableFreemiumAgendaView",enableThirdPartyCalendar:"enableThirdPartyCalendar",enableFreemiumCalendarShareViaGoogle:"enableFreemiumCalendarShareViaGoogle",enableFreemiumCalendarShareViaOutlook:"enableFreemiumCalendarShareViaOutlook",enableFreemiumMeetingInviteWithDate:"enableFreemiumMeetingInviteWithDate",enableGetCalendarEventsFromRest:"enableGetCalendarEventsFromRest",enableGroupEventsInGeneralChannelCalendar:"enableGroupEventsInGeneralChannelCalendar",enableInlineMeetingOptions:"enableInlineMeetingOptions",enableSharedChannelMeetingScheduling:"enableSharedChannelMeetingScheduling",enableMeetingArtifacts:"enableMeetingArtifacts",enableMeetingInfoDropdown:"enableMeetingInfoDropdown",enableMeetingOptionsButton:"enableMeetingOptionsButton",maxRoomListsToFetch:"maxRoomListsToFetch",maxRoomsInRoomListToFetch:"maxRoomListsToFetch",maxRoomsToFetch:"maxRoomListsToFetch",maxCourseMembersAndOwnersLimit:"maxCourseMembersAndOwnersLimit",meetingCodeConfiguration:"meetingCodeConfiguration",enableMeetNowFromCodePanelInCalendar:"enableMeetNowFromCodePanelInCalendar",enableMeetNowSharePanelInCalendar:"enableMeetNowSharePanelInCalendar",enableMultiWindowCalendarSchedulingForm:"enableMultiWindowCalendarSchedulingForm",enableMultiWindowCalendarSchedulingFormViewAndEdit:"enableMultiWindowCalendarSchedulingFormViewAndEdit",enableMultiWindowWebinarRegistration:"enableMultiWindowWebinarRegistration",enableMultiWindowUseProjectStyles:"enableMultiWindowUseProjectStyles",enableInstantMeeting:"enableInstantMeeting",enableOnlineAppointment:"enableOnlineAppointment",enablePeoplePickerForTflCalendar:"enablePeoplePickerForTflCalendar",enableQuickCreateForFreemiumCalendar:"enableQuickCreateForFreemiumCalendar",enableRecordingPostMeeting:"enableRecordingPostMeeting",enableCachedRecordingPostMeeting:"enableCachedRecordingPostMeeting",enableRequireRegistrationInMeetingSchedulingForm:"enableRequireRegistrationInMeetingSchedulingForm",enableRockfallCalendarMeetingSchedulingEnhancements:"enableRockfallCalendarMeetingSchedulingEnhancements",enableSchedulingFormTrackingViewSummary:"enableSchedulingFormTrackingViewSummary",enableSchedulingWebinars:"enableSchedulingWebinars",enableSFCloseRouteToCalendarSurface:"enableSFCloseRouteToCalendarSurface",enableSpeedyMeetings:"enableSpeedyMeetings",enableSchedulingFormEditModeInLMS:"enableSchedulingFormEditModeInLMS",enableViewAndEditViaDeepLink:"enableViewAndEditViaDeepLink",enableWebinarPolicyCheck:"enableWebinarPolicyCheck",engagementReportPolicyTestHookOverride:"engagementReportPolicyTestHookOverride",freemiumCalendarShareViaGoogleAllowedDomains:"freemiumCalendarShareViaGoogleAllowedDomains",freemiumCalendarShareViaOutlookAllowedDomains:"freemiumCalendarShareViaOutlookAllowedDomains",isConsumerWindow:"isConsumerWindow",isLmsCourseCalendar:"isLmsCourseCalendar",enableAddEntireClass:"enableAddEntireClass",isMeetingOnenoteAgendaEnabled:"isMeetingOnenoteAgendaEnabled",isPrivateWebinarSupportedForGuest:"isPrivateWebinarSupportedForGuest",meetingOptionsUrl:"meetingOptionsUrl",noOfAttendeesForShowingTrackingViewSummary:"noOfAttendeesForShowingTrackingViewSummary",pageSizeForCalendarAgendaView:"pageSizeForCalendarAgendaView",transcriptVoiceRecognitionUrl:"transcriptVoiceRecognitionUrl",useWebviewForFluid:"useWebviewForFluid",enableFluidPendingDialog:"enableFluidPendingDialog",enableCalendarViewDescriptionCollapsible:"enableCalendarViewDescriptionCollapsible",whoCanRegisterPolicy:"whoCanRegisterPolicy",enableAttendanceReportTab:"enableAttendanceReportTab",enableAttendanceReportTabForWebinars:"enableAttendanceReportTabForWebinars",meetingAttendanceReportAppDefinitionId:"meetingAttendanceReportAppDefinitionId",meetingAttendanceReportTabUrl:"meetingAttendanceReportTabUrl",breakoutRoomsAppDefinitionId:"breakoutRoomsAppDefinitionId",breakoutRoomsAppTabUrl:"breakoutRoomsAppTabUrl",enableBreakoutRoomsPreMeetingAssignmentTab:"enableBreakoutRoomsPreMeetingAssignmentTab",enableCalendarSchedulingFormInNewWindow:"enableCalendarSchedulingFormInNewWindow",enableCalendarSurfaceUseProjectStyles:"enableCalendarSurfaceUseProjectStyles",enableTabsInChannelMeeting:"enableTabsInChannelMeeting",coachReportAppDefinitionId:"coachReportAppDefinitionId",coachReportTabUrl:"coachReportTabUrl",enableCoachReportTab:"enableCoachReportTab",enableCalendarSchedulingFormMultiSlot:"enableCalendarSchedulingFormMultiSlot",calendarFluidDefaultOneNoteUrl:"calendarFluidDefaultOneNoteUrl",enableConnectedCalendar:"enableConnectedCalendar",enableConnectedCalendarSettingsSync:"enableConnectedCalendarSettingsSync",connectedCalendarSettingsRefreshIntervalInMs:"connectedCalendarSettingsRefreshIntervalInMs"},b=n("94a755535d135f12850c"),S=n("4044e44e608d1baef794");n.d(t,"a",function(){return h});var h=function(){function e(e,t,n){var i,r,o;this.settingsService=e,this.policySettingsStoreService=t,this.settingsCache={},this.itProSettings={isBroadcastSchedulingAllowed:!1,isPrivateMeetingSchedulingAllowed:!0,isChannelMeetingSchedulingAllowed:!0,allowEngagementReport:a.b.AllowEngagementReport.Disabled,allowMeetingRegistration:!1,whoCanRegister:a.b.WebinarRegisterPolicy.EveryoneInCompany,allowFluidCollaborate:!0},this.userPropertiesSettings={},this.userResourcesSettings={},this.settingsByCategoryMap=new Map([[a.a.Metadata,{getSettings:this.getMetadataSettings.bind(this),namespace:l.a}],[a.a.Test,{getSettings:this.getTestSettings.bind(this),namespace:l.a}],[a.a.Auth,{getSettings:this.getAuthSettings.bind(this),namespace:l.a}],[a.a.Telemetry,{getSettings:this.getTelemetrySettings.bind(this),namespace:l.a}],[a.a.Host,{getSettings:this.getHostSettings.bind(this),namespace:l.a}],[a.a.Localization,{getSettings:this.getLocalizationSettings.bind(this),namespace:l.a}],[a.a.Calendar,{getSettings:this.getCalendarSettings.bind(this),namespace:l.a}],[a.a.Platform,{getSettings:this.getPlatformSettings.bind(this),namespace:l.a}],[a.a.ChatList,{getSettings:this.getChatListSettings.bind(this),namespace:l.a}],[a.a.Shortcuts,{getSettings:this.getShortcutsSettings.bind(this),namespace:l.a}],[a.a.WebinarRegistration,{getSettings:this.getWebinarRegistrationSettings.bind(this),namespace:l.a}],[a.a.Sdk,{getSettings:this.getSDKSettings.bind(this),namespace:l.a}],[a.a.UserResources,{getSettings:this.getUserResourcesSettings.bind(this),namespace:l.a}]]),this.userPropertiesSettings=null!==(i=null==t?void 0:t.getUserPropertiesSettings())&&void 0!==i?i:{},this.userResourcesSettings=null!==(o=null===(r=null==t?void 0:t.getUserResourcesSettings)||void 0===r?void 0:r.call(t))&&void 0!==o?o:{},this.logger=null==n?void 0:n.newLogger("CoreSettingsAdapter")}return e.prototype.get=function(e){return this.getSubject(e).value},e.prototype.getObservable=function(e){return this.getSubject(e).asObservable()},e.prototype.getSubject=function(e){var t=this;if(this.settingsCache[e])return this.settingsCache[e];var n=this.getSettingsForCategory(e),i=n.subscriptionNamespace,l=n.settings,r=new g.a(l||{});this.settingsCache[e]=r;e===a.a.Calendar&&this.policySettingsStoreService&&this.getCalendarPolicySettings(r),e===a.a.UserResources&&this.policySettingsStoreService&&this.getUserResourcesSettings(r);var o=new s.a("adapter-"+e+"-"+i,function(){var n=t.getSettingsForCategory(e).settings;r.next(n)},i);return this.settingsService.addListener(o),r},e.prototype.getSettingsForCategory=function(e){var t=this.settingsByCategoryMap.get(e),n=e.toString().toLowerCase(),i=t?t.getSettings():this.settingsService.getSettingsForNamespace(n)||{};return{subscriptionNamespace:t?t.namespace:n,settings:i}},e.prototype.getMetadataSettings=function(){var e,t=new d.a(this.settingsService).ring,n=this.settingsService.get(c.a.EnvironmentType,c.a.EnvironmentKey);return t&&(e={id:t.id||"general",friendlyName:t.friendlyName,shortName:t.shortName}),{ring:e,eTag:null==t?void 0:t.eTag,environment:n}},e.prototype.getTestSettings=function(){return{isRunningGlassjar:this.settingsService.getBoolean("isRunningGlassjar"),mtAuthResourceOverride:this.settingsService.getString("skypeAuthEndpointAddressV2"),mtOverrideBaseUrl:this.settingsService.getString("mtOverrideBaseURL"),lokiUrlOverride:this.settingsService.getString("lokiUrlOverride")}},e.prototype.getAuthSettings=function(){var e=this.settingsService.get("authConstants");if(e){var t=e.skypeAuthEndpointAddressV2,n=Object(b.isArray)(e.resources)&&e.resources.length>0&&e.resources[0];return{authzEndpointUrl:t,mtResource:n,authzResource:this.settingsService.get("isConsumerWindow")?e.consumerAuthzResource:n}}return{}},e.prototype.getTelemetrySettings=function(){var e,t,n,i,a,l,o=this.settingsService.get("loggingConstants"),s=this.isScenarioMemorySnapshotEnabled();o&&(n=o.telemetryserver,i=null===(e=o.appTokens)||void 0===e?void 0:e.default,a=null===(t=o.appTokens)||void 0===t?void 0:t.userBi,l=!!o.silent&&o.silent,this.settingsService.get(c.a.EnvironmentType,c.a.EnvironmentKey)!==r.a.Prod&&o.appTokens&&o.appTokens.test&&(i=o.appTokens.test,a=o.appTokens.test));return{defaultToken:i,isSilent:l,telemetryServer:n,userBiToken:a,isScenarioMemorySnapshotEnabled:s}},e.prototype.getHostSettings=function(){return{keyboardLayoutLanguage:this.settingsService.getString("keyboardLayoutLanguage")}},e.prototype.getLocalizationSettings=function(){return{enableLocalizedKeyboardStrategies:this.settingsService.getBoolean("enableLocalizedKeyboardStrategies")}},e.prototype.getCalendarSettings=function(){var e=this,t=Object(b.mapValues)(u,function(t){return e.settingsService.get(t)}),n=this.itProSettings,a={allowChannelMeetingSchedulingPolicy:n.isChannelMeetingSchedulingAllowed,allowPrivateMeetingSchedulingPolicy:n.isPrivateMeetingSchedulingAllowed,allowBroadcastSchedulingPolicy:n.isBroadcastSchedulingAllowed,allowEngagementReportPolicy:n.allowEngagementReport,allowMeetingRegistrationPolicy:n.allowMeetingRegistration,whoCanRegisterPolicy:n.whoCanRegister,allowFluidCollaboratePolicy:n.allowFluidCollaborate};return Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},t),a),this.userPropertiesSettings)},e.prototype.getCalendarPolicySettings=function(e){var t=this,n=this.initializeCalendarPolicySettings(),i=n.isChannelMeetingSchedulingAllowedPromise,l=n.isPrivateMeetingSchedulingAllowedPromise,r=n.broadcastPolicySettingsPromise,o=n.allowMeetingRegistrationPromise,s=n.allowEngagementReportPromise,g=n.whoCanRegisterPromise,d=n.allowFluidCollaboratePromise;this.initializeBroadcastPolicySettingsPromise(r,e),Promise.all([i,l,s,o,g,d]).then(function(n){var i=n[0],a=n[1],l=n[2],r=n[3],o=n[4],s=n[5];t.itProSettings.isChannelMeetingSchedulingAllowed=i,t.itProSettings.isPrivateMeetingSchedulingAllowed=a,t.itProSettings.allowEngagementReport=l,t.itProSettings.allowMeetingRegistration=r,t.itProSettings.whoCanRegister=o,t.itProSettings.allowFluidCollaborate=null==s||s;var g=t.getCalendarSettings();e.next(g)}).catch(function(){t.itProSettings.isChannelMeetingSchedulingAllowed=!1,t.itProSettings.isPrivateMeetingSchedulingAllowed=!1,t.itProSettings.allowEngagementReport=a.b.AllowEngagementReport.Disabled,t.itProSettings.allowMeetingRegistration=!1,t.itProSettings.whoCanRegister=a.b.WebinarRegisterPolicy.EveryoneInCompany,t.itProSettings.allowFluidCollaborate=!0;var n=t.getCalendarSettings();e.next(n)}),this.updateUserPropertiesSettings(e)},e.prototype.getUserResourcesSettings=function(e){var t,n,a=this;null===(n=null===(t=this.policySettingsStoreService)||void 0===t?void 0:t.waitAndGetUserResourcesSettings)||void 0===n||n.call(t).then(function(t){var n=t.licenseType;a.userResourcesSettings=Object(i.__assign)(Object(i.__assign)({},a.userResourcesSettings),{licenseType:n}),e.next(Object(i.__assign)(Object(i.__assign)({},a.userResourcesSettings),{licenseType:n}))}).catch(function(){var e;null===(e=a.logger)||void 0===e||e.error("getUserResourcesSettings: could not fetch user resource setttings")})},e.prototype.initializeCalendarPolicySettings=function(){return{isChannelMeetingSchedulingAllowedPromise:this.policySettingsStoreService.isChannelMeetingSchedulingAllowed(),isPrivateMeetingSchedulingAllowedPromise:this.policySettingsStoreService.isPrivateMeetingSchedulingAllowed(),broadcastPolicySettingsPromise:this.policySettingsStoreService.getBroadcastPolicySettings(),allowEngagementReportPromise:this.policySettingsStoreService.allowEngagementReport(),allowMeetingRegistrationPromise:this.policySettingsStoreService.allowMeetingRegistration(),whoCanRegisterPromise:this.policySettingsStoreService.whoCanRegister(),allowFluidCollaboratePromise:this.policySettingsStoreService.allowFluidCollaborate()}},e.prototype.initializeBroadcastPolicySettingsPromise=function(e,t){var n=this;e.then(function(e){n.itProSettings.isBroadcastSchedulingAllowed=e.allowBroadcastScheduling;var i=n.getCalendarSettings();t.next(i)}).catch(function(){})},e.prototype.getPlatformSettings=function(){return{sessionId:this.settingsService.getString(c.a.SessionIdKey,c.a.PlatformKey)||this.settingsService.getString(c.a.SessionIdKey,c.a.CookiesKey)}},e.prototype.getChatListSettings=function(){return{enableBuddyList:this.settingsService.getBoolean(c.a.EnableBuddyList),hideSelectedChatLeftRailTypingIndicator:this.settingsService.getBoolean(c.a.HideSelectedChatLeftRailTypingIndicator)}},e.prototype.getShortcutsSettings=function(){var e=this.settingsService.get(c.a.ClientType,c.a.PlatformKey)===o.b.Desktop,t=this.settingsService.get(c.a.RingKey);return{applyDesktopKeymappingStrategy:e,enableDevShortcuts:!(!t||t.isPublic)}},e.prototype.isScenarioMemorySnapshotEnabled=function(){return this.settingsService.get(c.a.ClientType,c.a.PlatformKey)===o.b.Desktop&&this.settingsService.getBoolean(c.a.EnableMemoryDumpApi,c.a.DesktopSettingsKey)},e.prototype.getWebinarRegistrationSettings=function(){var e=this.settingsService.get("webinarSettings");return{webinarServiceEndpoint:e.serviceEndpoint,webinarServiceResource:e.serviceResource}},e.prototype.getSDKSettings=function(){var e=Object(S.a)().navigator.userAgent;return{sdkHostType:this.getHostType(e)}},e.prototype.getHostType=function(e){return-1!==(null==e?void 0:e.indexOf("Electron"))?a.b.SdkHostType.Desktop:a.b.SdkHostType.Web},e.prototype.updateUserPropertiesSettings=function(e){var t,n=this;null===(t=this.policySettingsStoreService)||void 0===t||t.waitAndGetUserPropertiesSettings().then(function(t){var a=t.autodiscoverSettings,l=t.isOnCloud,r=n.getCalendarSettings();Object(b.isEqual)(a,r.autodiscoverSettings)&&l===r.isOnCloud||(n.userPropertiesSettings={autodiscoverSettings:a,isOnCloud:l},e.next(Object(i.__assign)(Object(i.__assign)({},r),n.userPropertiesSettings)))}).catch(function(){})},e}()}}]);