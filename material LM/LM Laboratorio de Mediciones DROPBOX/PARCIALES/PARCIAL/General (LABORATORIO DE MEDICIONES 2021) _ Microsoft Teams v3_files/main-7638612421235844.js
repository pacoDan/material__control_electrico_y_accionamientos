(()=>{var __webpack_modules__={388258:e=>{e.exports={kind:"Document",definitions:[{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"WindowStateEvent"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"isFocused"},arguments:[],type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"correlation"},arguments:[],type:{kind:"NamedType",name:{kind:"Name",value:"ServerCorrelation"}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"shouldClose"},arguments:[],type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"ServerCorrelation"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"startTimestamp"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"source"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}]},{kind:"ObjectTypeExtension",name:{kind:"Name",value:"Subscription"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"windowStateEvent"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"windowId"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"WindowStateEvent"}}},directives:[]}]}]}},854621:e=>{e.exports={kind:"Document",definitions:[{kind:"ObjectTypeExtension",name:{kind:"Name",value:"Query"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"authenticationUsers"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"filter"},type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUserFilter"}},directives:[]}],type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUser"}}}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"authenticatedUser"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"allowAnon"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"InputValueDefinition",name:{kind:"Name",value:"correlationId"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"InputValueDefinition",name:{kind:"Name",value:"loginHint"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"InputValueDefinition",name:{kind:"Name",value:"tenantId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}],type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUser"}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"authenticationToken"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"resource"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"InputValueDefinition",name:{kind:"Name",value:"acquireTokenOptions"},type:{kind:"NamedType",name:{kind:"Name",value:"AcquireTokenOptions"}},directives:[]}],type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationToken"}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"hostMachineUsers"},arguments:[],type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"HostMachineUser"}}}}},directives:[]}]},{kind:"ObjectTypeExtension",name:{kind:"Name",value:"Mutation"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"authenticateUser"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"id"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"InputValueDefinition",name:{kind:"Name",value:"correlationId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"InputValueDefinition",name:{kind:"Name",value:"loginHint"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}],type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUser"}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"loginUser"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"InputValueDefinition",name:{kind:"Name",value:"correlationId"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"InputValueDefinition",name:{kind:"Name",value:"loginHint"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUser"}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"authenticationLogout"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"reason"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],type:{kind:"NamedType",name:{kind:"Name",value:"authenticationLogoutResponse"}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"reauthenticateUser"},arguments:[],type:{kind:"NamedType",name:{kind:"Name",value:"ReauthenticateResponse"}},directives:[]}]},{kind:"ObjectTypeExtension",name:{kind:"Name",value:"Subscription"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"authenticationUsersEvent"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationServiceEvent"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"authenticationStateChanged"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationStateChangedEvent"}}},directives:[]}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"AuthenticationUser"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"profile"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUserProfile"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"isAuthenticated"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"type"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationAccountType"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"role"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUserRole"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"loginUserName"},arguments:[],type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"authenticationLogoutResponse"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"succeed"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"ReauthenticateResponse"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"success"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]}]},{kind:"EnumTypeDefinition",name:{kind:"Name",value:"AuthenticationAccountType"},directives:[],values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"Anonymous"},directives:[]},{kind:"EnumValueDefinition",name:{kind:"Name",value:"Aad"},directives:[]},{kind:"EnumValueDefinition",name:{kind:"Name",value:"Msa"},directives:[]},{kind:"EnumValueDefinition",name:{kind:"Name",value:"MsaLife"},directives:[]},{kind:"EnumValueDefinition",name:{kind:"Name",value:"GFed"},directives:[]},{kind:"EnumValueDefinition",name:{kind:"Name",value:"Otp"},directives:[]}]},{kind:"EnumTypeDefinition",name:{kind:"Name",value:"AuthenticationUserRole"},directives:[],values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"Member"},directives:[]},{kind:"EnumValueDefinition",name:{kind:"Name",value:"Anonymous"},directives:[]},{kind:"EnumValueDefinition",name:{kind:"Name",value:"Guest"},directives:[]}]},{kind:"EnumTypeDefinition",name:{kind:"Name",value:"AuthenticationState"},directives:[],values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"Up"},directives:[]},{kind:"EnumValueDefinition",name:{kind:"Name",value:"InteractionRequired"},directives:[]},{kind:"EnumValueDefinition",name:{kind:"Name",value:"AADReconnecting"},directives:[]},{kind:"EnumValueDefinition",name:{kind:"Name",value:"SkypeReconnecting"},directives:[]}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"AuthenticationUserFilter"},directives:[],fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"isAuthenticated"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"AcquireTokenOptions"},directives:[],fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"claim"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"InputValueDefinition",name:{kind:"Name",value:"silent"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"AuthenticationToken"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"token"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"AuthenticationUserProfile"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"objectId"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"tenantId"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"upn"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"puid"},arguments:[],type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},directives:[]}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"AuthenticationServiceEvent"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"authenticationUsers"},arguments:[],type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUser"}}}}},directives:[]}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"AuthenticationStateChangedEvent"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"authenticationState"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationState"}}},directives:[]}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"HostMachineUser"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"accountType"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"id"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"displayName"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"emailPhone"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"picture"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}]}]}},56023:e=>{e.exports={kind:"Document",definitions:[{kind:"ObjectTypeExtension",name:{kind:"Name",value:"Query"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"allClientPreferences"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ClientPreferences"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"clientPreferences"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"category"},type:{kind:"NamedType",name:{kind:"Name",value:"ClientPreferencesCategory"}},directives:[]}],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ClientPreferenceCategoryTypes"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"userExperiencePreferences"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserExperiencePreferences"}}},directives:[]}]},{kind:"ObjectTypeExtension",name:{kind:"Name",value:"Mutation"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"updateClientPreferences"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"value"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ClientPreferencesInput"}}},directives:[]}],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ClientPreferences"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"updateUserExperiencePreferences"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"value"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserExperiencePreferencesInput"}}},directives:[]}],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserExperiencePreferences"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"clearUserExperiencePreferences"},arguments:[],type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]}]},{kind:"ObjectTypeExtension",name:{kind:"Name",value:"Subscription"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"clientPreferencesChangedEvent"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"category"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ClientPreferencesCategory"}}},directives:[]}],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ClientPreferenceCategoryTypes"}}},directives:[]}]},{kind:"EnumTypeDefinition",name:{kind:"Name",value:"UserTheme"},directives:[],values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"light"},directives:[]},{kind:"EnumValueDefinition",name:{kind:"Name",value:"dark"},directives:[]},{kind:"EnumValueDefinition",name:{kind:"Name",value:"contrast"},directives:[]}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"ThemePreferences"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"userTheme"},arguments:[],type:{kind:"NamedType",name:{kind:"Name",value:"UserTheme"}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"followOsTheme"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"AnimationPreferences"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"disableAnimations"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"ClientPreferences"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"animation"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AnimationPreferences"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"theme"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ThemePreferences"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"performance"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PerformancePreferences"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"videoEffect"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"VideoEffectPreferences"}}},directives:[]}]},{kind:"EnumTypeDefinition",name:{kind:"Name",value:"UserExperiencePreferencesCategory"},directives:[],values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"tflGroupTemplatesHidden"},directives:[]}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"TflGroupTemplateHidden"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"groupTemplate"},arguments:[],type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"isHidden"},arguments:[],type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"TflGroupTemplatesHidden"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"items"},arguments:[],type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"TflGroupTemplateHidden"}}},directives:[]}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"UserExperiencePreferences"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"tflGroupTemplatesHidden"},arguments:[],type:{kind:"NamedType",name:{kind:"Name",value:"TflGroupTemplatesHidden"}},directives:[]}]},{kind:"UnionTypeDefinition",name:{kind:"Name",value:"ClientPreferenceCategoryTypes"},directives:[],types:[{kind:"NamedType",name:{kind:"Name",value:"PerformancePreferences"}},{kind:"NamedType",name:{kind:"Name",value:"ThemePreferences"}},{kind:"NamedType",name:{kind:"Name",value:"AnimationPreferences"}},{kind:"NamedType",name:{kind:"Name",value:"VideoEffectPreferences"}}]},{kind:"EnumTypeDefinition",name:{kind:"Name",value:"ClientPreferencesCategory"},directives:[],values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"performance"},directives:[]},{kind:"EnumValueDefinition",name:{kind:"Name",value:"theme"},directives:[]},{kind:"EnumValueDefinition",name:{kind:"Name",value:"animation"},directives:[]},{kind:"EnumValueDefinition",name:{kind:"Name",value:"videoEffect"},directives:[]}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"PerformancePreferences"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"mode"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PerformanceMode"}}},directives:[]}]},{kind:"EnumTypeDefinition",name:{kind:"Name",value:"PerformanceMode"},directives:[],values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"normal"},directives:[]},{kind:"EnumValueDefinition",name:{kind:"Name",value:"low"},directives:[]}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"VideoEffectPreferences"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"lastUsedVideoFilter"},arguments:[],type:{kind:"NamedType",name:{kind:"Name",value:"VideoFilter"}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"lastUsedBackgroundImage"},arguments:[],type:{kind:"NamedType",name:{kind:"Name",value:"VideoCustomBackgroundImage"}},directives:[]}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"VideoFilter"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"appId"},arguments:[],type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"filterId"},arguments:[],type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"appName"},arguments:[],type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"VideoCustomBackgroundImage"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"imageId"},arguments:[],type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"imagePath"},arguments:[],type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"TflGroupTemplatesHiddenInput"},directives:[],fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"InputValueDefinition",name:{kind:"Name",value:"items"},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"TflGroupTemplateHiddenInput"}}},directives:[]}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"TflGroupTemplateHiddenInput"},directives:[],fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"groupTemplate"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"InputValueDefinition",name:{kind:"Name",value:"isHidden"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"UserExperiencePreferencesInput"},directives:[],fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"tflGroupTemplatesHidden"},type:{kind:"NamedType",name:{kind:"Name",value:"TflGroupTemplatesHiddenInput"}},directives:[]}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"AnimationPreferencesInput"},directives:[],fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"disableAnimations"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"PerformancePreferencesInput"},directives:[],fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"mode"},type:{kind:"NamedType",name:{kind:"Name",value:"PerformanceMode"}},directives:[]}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"ThemePreferencesInput"},directives:[],fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"userTheme"},type:{kind:"NamedType",name:{kind:"Name",value:"UserTheme"}},directives:[]},{kind:"InputValueDefinition",name:{kind:"Name",value:"followOsTheme"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"VideoEffectPreferencesInput"},directives:[],fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"lastUsedVideoFilter"},type:{kind:"NamedType",name:{kind:"Name",value:"VideoFilterInput"}},directives:[]},{kind:"InputValueDefinition",name:{kind:"Name",value:"lastUsedBackgroundImage"},type:{kind:"NamedType",name:{kind:"Name",value:"VideoCustomBackgroundImageInput"}},directives:[]}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"VideoFilterInput"},directives:[],fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"appId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"InputValueDefinition",name:{kind:"Name",value:"filterId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"InputValueDefinition",name:{kind:"Name",value:"appName"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"VideoCustomBackgroundImageInput"},directives:[],fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"imageId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"InputValueDefinition",name:{kind:"Name",value:"imagePath"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"ClientPreferencesInput"},directives:[],fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"animation"},type:{kind:"NamedType",name:{kind:"Name",value:"AnimationPreferencesInput"}},directives:[]},{kind:"InputValueDefinition",name:{kind:"Name",value:"theme"},type:{kind:"NamedType",name:{kind:"Name",value:"ThemePreferencesInput"}},directives:[]},{kind:"InputValueDefinition",name:{kind:"Name",value:"performance"},type:{kind:"NamedType",name:{kind:"Name",value:"PerformancePreferencesInput"}},directives:[]},{kind:"InputValueDefinition",name:{kind:"Name",value:"videoEffect"},type:{kind:"NamedType",name:{kind:"Name",value:"VideoEffectPreferencesInput"}},directives:[]}]}]}},931473:module=>{module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<link\n  rel="icon"\n  type="image/png"\n  href="https://statics.teams.cdn.office.net/hashedassets/favicon/prod/favicon-32x32-04b7d908.png"\n/>\n<link\n  rel="icon"\n  type="image/png"\n  href="https://statics.teams.cdn.office.net/hashedassets/favicon/prod/favicon-16x16-aedbfeac.png"\n/>\n<link\n  rel="icon"\n  type="image/png"\n  href="https://statics.teams.cdn.office.net/hashedassets/favicon/prod/favicon-96x96-6b9521ce.png"\n/>\n<link\n  rel="shortcut icon"\n  type="image/x-icon"\n  href="https://statics.teams.cdn.office.net/hashedassets/favicon/prod/favicon-34ed16c5.ico"\n/>';return __p}},346701:module=>{module.exports=function(obj){obj||(obj={});var __t,__p="",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,"")}with(obj)__p+="<style>\n  .preload-title-bar-trim {\n    ","mac"===osPlatform?__p+="\n    --preload-title-bar-background-color: rgb(98, 100, 167);\n    ":__p+="\n    --preload-title-bar-background-color: rgb(70, 71, 117);\n    ",__p+='\n\n    background-color: var(--preload-title-bar-background-color);\n    padding: .3rem .3rem 0 .3rem;\n    height: 4rem;\n    width: 100%;\n    position: fixed;\n    top: 0;\n    left: 0;\n    box-sizing: border-box;\n    -webkit-app-region: drag;\n    z-index: -20;\n  }\n\n  .preload-title-bar-trim * {\n    margin: 0;\n    padding: 0;\n    -webkit-margin-before: 0;\n    -webkit-margin-after: 0;\n    box-sizing: inherit;\n  }\n\n  .preload-title-bar {\n    height: 100%;\n    width: 100%;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    color: white;\n    position: relative;\n  }\n\n\n  /**\n   * Allows resizing around the edges of the title bar by creating a region that isn\'t draggable\n   * The \'top\' value must be greater than zero, otherwise when the app is maximized,\n   * you won\'t be able to click and drag the window from the very top\n   */\n  .preload-title-bar::before {\n    content: "";\n    top: .2rem;\n    position: absolute;\n    height: .2rem;\n    -webkit-app-region: no-drag;\n    width: 100%;\n    left: 0;\n  }\n\n  .preload-title-bar-text {\n    margin: auto;\n    text-align: center;\n    font-size: 1.4rem;\n    pointer-events: none;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n  }\n\n  .preload-title-bar-buttons {\n    height: 4rem;\n    display: flex;\n    flex-basis: 0;\n    align-items: center;\n    position: absolute;\n    top: 0;\n    right: 0;\n    margin-top: -.3rem;\n    margin-right: -.3rem;\n  }\n\n  .preload-title-bar-button {\n    background-color: var(--preload-title-bar-background-color);\n    -webkit-app-region: no-drag;\n    user-select: none;\n    border: 0;\n    border-radius: 0;\n    cursor: pointer;\n    height: 100%;\n    width: 4rem;\n    outline: none;\n  }\n\n  .preload-title-bar-button>svg {\n    fill: white;\n    background-color: inherit;\n    width: 1.6rem;\n    height: 1.6rem;\n    display: block;\n    margin: auto;\n  }\n\n  .preload-title-bar-button-close-filled {\n    display: none;\n  }\n\n  .preload-title-bar-button-close-outline {\n    display: block;\n  }\n\n  .preload-title-bar-button:hover {\n    background-color: rgb(51, 52, 74);\n  }\n\n  .preload-title-bar-button-close:hover {\n    background-color: rgb(196, 49, 75);\n  }\n\n  .preload-title-bar-button-close:hover .preload-title-bar-button-close-filled {\n    display: block;\n  }\n\n  .preload-title-bar-button-close:hover .preload-title-bar-button-close-outline {\n    display: none;\n  }\n</style>\n<div class="preload-title-bar-trim">\n  <div id="preload-title-bar" class="preload-title-bar">\n    <span class="preload-title-bar-text" aria-hidden="true">Microsoft Teams</span>\n\n    ',"windows"===osPlatform&&(__p+='\n    <div class="preload-title-bar-buttons">\n      \x3c!-- TODO: Hook button up to minimize/maximize/collapse API --\x3e\n      <button class="preload-title-bar-button">\n        <svg role="presentation" focusable="false" viewBox="8 8 16 16">\n          <path d="M10 16v-1h12v1H10z"></path>\n        </svg>\n      </button>\n      \x3c!-- TODO: Hook button up to minimize/maximize/collapse API --\x3e\n      <button class="preload-title-bar-button">\n        <svg role="presentation" focusable="false" viewBox="8 8 16 16">\n          <path d="M10 10h12v12H10V10zm11 11V11H11v10h10z"></path>\n        </svg>\n      </button>\n      \x3c!-- TODO: toggle on when maximized --\x3e\n      \x3c!-- TODO: Hook button up to minimize/maximize/collapse API --\x3e\n      <button class="preload-title-bar-button" style="display:none;">\n        <svg role="presentation" focusable="false" viewBox="8 8 16 16">\n          <path d="M11 9v2H9v12h12v-2h2V9H11zm9 13H10V12h10v10zm2-2h-1v-9h-9v-1h10v10z"></path>\n        </svg>\n      </button>\n      <button class="preload-title-bar-button preload-title-bar-button-close" onclick="window.close()">\n        <svg role="presentation" focusable="false" viewBox="8 8 16 16">\n          <g>\n            <path class="preload-title-bar-button-close-outline"\n              d="M16.707 16l4.243-4.243a.5.5 0 1 0-.707-.707L16 15.293l-4.243-4.243a.5.5 0 1 0-.707.707L15.293 16l-4.243 4.243a.5.5 0 1 0 .707.707L16 16.707l4.243 4.243a.498.498 0 0 0 .707 0 .5.5 0 0 0 0-.707L16.707 16z">\n            </path>\n            <path class="preload-title-bar-button-close-filled"\n              d="M17.414 16l3.89-3.89a1 1 0 1 0-1.415-1.413L16 14.586l-3.89-3.89a1 1 0 1 0-1.413 1.415L14.586 16l-3.89 3.89a1 1 0 1 0 1.415 1.413L16 17.414l3.89 3.89a.997.997 0 0 0 1.413 0 1 1 0 0 0 0-1.415L17.414 16z">\n            </path>\n          </g>\n        </svg>\n      </button>\n    </div>\n    '),__p+="\n  </div>\n\n\n</div>";return __p}},871177:module=>{module.exports=function(obj){obj||(obj={});var __t,__p="",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,"")}with(obj)0;return __p}},406364:module=>{module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<style type="text/css" id="splash-styles">\n  /** Remove outline, when focusing splash screen, because it is not necessary to inform user about focus on that element. */\n  div[id="splash-screen"] {\n    outline: none;\n  }\n\n\n  /** Below styles are dedicated for the pre-loading wheel (before React loads) */\n  .ui.loader {\n    display: none;\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    margin: 0;\n    text-align: center;\n    z-index: 1000;\n    -webkit-transform: translateX(-50%) translateY(-50%);\n    transform: translateX(-50%) translateY(-50%);\n  }\n\n  .ui.loader:before {\n    position: absolute;\n    content: "";\n    top: 0;\n    left: 50%;\n    width: 100%;\n    height: 100%;\n    border-radius: 500rem;\n    border: 0.2em solid rgba(0, 0, 0, 0.1);\n  }\n\n  .ui.loader:after {\n    position: absolute;\n    content: "";\n    top: 0;\n    left: 50%;\n    width: 100%;\n    height: 100%;\n    -webkit-animation: loader 0.6s linear;\n    animation: loader 0.6s linear;\n    -webkit-animation-iteration-count: infinite;\n    animation-iteration-count: infinite;\n    border-radius: 500rem;\n    border-color: #767676 transparent transparent;\n    border-style: solid;\n    border-width: 0.2em;\n    -webkit-box-shadow: 0 0 0 1px transparent;\n    box-shadow: 0 0 0 1px transparent;\n  }\n\n  @-webkit-keyframes loader {\n    from {\n      -webkit-transform: rotate(0);\n      transform: rotate(0);\n    }\n\n    to {\n      -webkit-transform: rotate(360deg);\n      transform: rotate(360deg);\n    }\n  }\n\n  @keyframes loader {\n    from {\n      -webkit-transform: rotate(0);\n      transform: rotate(0);\n    }\n\n    to {\n      -webkit-transform: rotate(360deg);\n      transform: rotate(360deg);\n    }\n  }\n\n  .ui.large.loader:after,\n  .ui.large.loader:before {\n    width: 3.42857143rem;\n    height: 3.42857143rem;\n    margin: 0 0 0 -1.71428571rem;\n  }\n\n  .ui.text.loader {\n    width: auto !important;\n    height: auto !important;\n    text-align: center;\n    font-style: normal;\n  }\n\n  .ui.loader.active,\n  .ui.loader.visible {\n    display: block;\n  }\n\n  .ui.loader.disabled,\n  .ui.loader.hidden {\n    display: none;\n  }\n\n  .ui.large.text.loader {\n    min-width: 3.42857143rem;\n    padding-top: 4.21428571rem;\n  }\n\n  @-webkit-keyframes fadeOut {\n    from {\n      opacity: 1;\n    }\n\n    to {\n      opacity: 0;\n    }\n  }\n\n  @keyframes fadeOut {\n    from {\n      opacity: 1;\n    }\n\n    to {\n      opacity: 0;\n    }\n  }\n\n  .ui.loader.fadeOut {\n    -webkit-animation: fadeOut 500ms linear;\n    animation: fadeOut 500ms linear;\n  }\n</style>';return __p}},874645:module=>{module.exports=function(obj){obj||(obj={});var __t,__p="",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,"")}with(obj)__p+='<div id="splash-screen" tabindex="-1" role="progressbar" aria-valuetext="Loading..."\nstyle="height: 100vh; overflow: hidden; -webkit-app-region: drag;">\n  \x3c!-- Inline styles below as once React loads, all of the below will be removed. --\x3e\n  <div style="height: calc(100% - 4rem);\n                -webkit-user-select: none;\n                background-color: transparent;">\n    ',titleBar&&(__p+='\n      <div style="height:4rem;background-color:#464775"></div>\n    '),__p+='\n    <div class="ui large active text loader">\n      <span id="splash-screen-label">Loading...</span>\n    </div>\n  </div>\n</div>\n';return __p}},706827:module=>{module.exports=function(obj){obj||(obj={});var __t,__p="",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,"")}with(obj){if(__p+='<!DOCTYPE html>\n<html lang="en">\n<head data-config="'+(null==(__t=htmlWebpackPlugin.options.platformConfig)?"":__t)+'">\n  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />\n  <meta name="containerVer" content="'+(null==(__t=htmlWebpackPlugin.options.containerVer)?"":__t)+'" />\n  <script nonce="'+(null==(__t=htmlWebpackPlugin.options.cspNonce)?"":__t)+'">'+(null==(__t=htmlWebpackPlugin.options.publicPathScript)?"":__t)+"<\/script>\n  "+(null==(__t=htmlWebpackPlugin.options.partials.devtools)?"":__t)+"\n  "+(null==(__t=htmlWebpackPlugin.options.partials.favicons)?"":__t)+"\n\n  ",htmlWebpackPlugin.options.isMainWindow&&(__p+='\n    <script type="text/javascript" nonce="'+(null==(__t=htmlWebpackPlugin.options.cspNonce)?"":__t)+"\">\n      __webpack_nonce__ = '"+(null==(__t=htmlWebpackPlugin.options.cspNonce)?"":__t)+'\';\n      // TODO Remove the copy step once OnePlayer Loader supports dynamic importing. (https://onedrive.visualstudio.com/OMG/_workitems/edit/1170258)\n      onePlayerLoaderFullStaticPath = window.__webpack_public_path__;\n      function postExperienceStarted(message, errorCode) {\n        if (window.desktop && window.desktop.ipcRenderer) {\n          // Notifies the host of the experienceStarted event\n          window.desktop.ipcRenderer.sendToHost("experience-renderer-channel", {\n            eventId: "experienceStarted",\n            payload: {\n              message: message,\n              errorCode: errorCode,\n              errorDescription: errorCode && message\n            }\n          });\n        }\n      }\n\n      function registerPostExperienceStartedEvents(chunkId) {\n        const chunkLoader = document.getElementById(chunkId);\n        if (chunkLoader) {\n          chunkLoader.onload = function() {\n            postExperienceStarted(chunkId + " loaded");\n          };\n          chunkLoader.onerror = function() {\n            postExperienceStarted(chunkId + " failed", -1);\n          };\n        }\n      }\n    <\/script>\n\n    <script nonce="'+(null==(__t=htmlWebpackPlugin.options.cspNonce)?"":__t)+'">\n      performance.mark("execute-index-html-script");\n      postExperienceStarted("start");\n    <\/script>\n  '),__p+='\n\n   <style>\n    html,\n    body {\n      font-family: "Segoe UI", system-ui, "Apple Color Emoji", "Segoe UI Emoji", sans-serif;\n      width: 100%;\n      height: 100%;\n      padding: 0;\n      margin: 0;\n    }\n\n    html {\n      font-size: calc(1em * .625);\n    }\n\n    body {\n      font-size: 1.4rem;\n      overflow: hidden;\n    }\n\n    /** Enable antialiasing and font smoothing across supporting browsers for all elements */\n    * {\n      -webkit-font-smoothing: antialiased;\n      -moz-osx-font-smoothing: grayscale;\n    }\n\n    /*!*Remove hidden ADAL iframes borders as to not cause unnecessary vertical scrolling*!*/\n    body > iframe[id^="adal"] {\n      border: 0;\n    }\n  </style>\n\n  '+(null==(__t=void 0!==htmlWebpackPlugin.options.partials.splashStyles?htmlWebpackPlugin.options.partials.splashStyles:"")?"":__t)+"\n\n</head>\n\n<body ",htmlWebpackPlugin.options.isMainWindow?__p+='\n        id="main-window-body"\n      ':__p+='\n        id="child-window-body"\n      ',__p+="\n>\n\n",htmlWebpackPlugin.options.partials.preloadTitleBar&&(__p+="\n  "+(null==(__t=htmlWebpackPlugin.options.partials.preloadTitleBar)?"":__t)+"\n"),__p+="\n\n",htmlWebpackPlugin.options.partials.splash&&!htmlWebpackPlugin.options.isMainWindow?__p+='\n  <div style="display: none; height: inherit;" id="app"></div>\n  '+(null==(__t=htmlWebpackPlugin.options.partials.splash)?"":__t)+"\n":__p+='\n  <div style="height: inherit;" id="app"></div>\n',__p+='\n\n  <script id="initialize-bootstrap-data" nonce="'+(null==(__t=htmlWebpackPlugin.options.cspNonce)?"":__t)+'">\n    // Wrap in an IIFE to prevent leaking to the global scope\n    (function() {\n      function setInitialThemeColors() {\n        const theme = "'+(null==(__t=htmlWebpackPlugin.options.theme)?"":__t)+'" || "default";\n\n        const bodyStyle = document.body.style;\n        switch (theme) {\n          case "default":\n            bodyStyle.backgroundColor = "#F3F2F1";\n            bodyStyle.color = "#252424";\n            break;\n          case "dark":\n            bodyStyle.backgroundColor = "#201F1F";\n            bodyStyle.color = "#FFF";\n            break;\n          case "contrast":\n            bodyStyle.backgroundColor = "#000";\n            bodyStyle.color = "#FFF";\n            break;\n          case "defaultV2":\n          case "tfl-default":\n            bodyStyle.backgroundColor = "#F5F5F5";\n            bodyStyle.color = "#252424";\n            break;\n          case "darkV2":\n          case "tfl-dark":\n            bodyStyle.backgroundColor = "#1F1F1F";\n            bodyStyle.color = "#FFF";\n            break;\n        }\n      }\n\n      function setInitialWindowTitle() {\n        const isMainWindow = "'+(null==(__t=htmlWebpackPlugin.options.isMainWindow)?"":__t)+"\";\n\n        if (isMainWindow) {\n          document.title = \"\";\n        } else {\n          document.title = \"New Window | Microsoft Teams\";\n        }\n      }\n\n      function focusSplashScreen() {\n        const splashScreen = document.getElementById(\"splash-screen\");\n        if (splashScreen) {\n          splashScreen.focus();\n        }\n      }\n\n      /*\n       * Stub console error to prevent the console from leaking objects.\n       * See bug: 1911460.\n       */\n      function stubConsoleError() {\n        const originalConsoleError = console.error;\n        console.error = function (...args) {\n          const newArgs = [];\n          args.forEach(arg => {\n            if (!arg || typeof arg === 'string') {\n              newArgs.push(arg);\n            } else if (typeof arg.stack === 'string') {\n              newArgs.push(arg.stack);\n            } else if (typeof arg.message === 'string') {\n              newArgs.push(arg.message);\n            } else {\n              newArgs.push(JSON.stringify(arg));\n            }\n          });\n          originalConsoleError(...newArgs);\n        };\n      }\n      stubConsoleError();\n\n      /*\n       * Force unhandledrejections to errors to be serialized to prevent object leaks.\n       * See bug: 1911460.\n       */\n      const handleError = e => {\n        console.error((e && e.reason) || e);\n        e && e.preventDefault && e.preventDefault();\n      };\n      window.addEventListener('unhandledrejection', handleError);\n      window.addEventListener('error', handleError);\n\n      setInitialThemeColors();\n      setInitialWindowTitle();\n      // focus splash screen in order to narrate loading message and title of the window\n      focusSplashScreen();\n    })();\n  <\/script>\n\n  \x3c!-- Only use custom inject logic if `inject: false` is set --\x3e\n  ",!htmlWebpackPlugin.options.inject&&htmlWebpackPlugin.files.js){var allEntryAssets=htmlWebpackPlugin.files.js.concat(htmlWebpackPlugin.files.css).map((e=>({id:e.split("/").pop().replace(/(-[0-9a-g]+)?\..+/,""),path:e})));for(var file of(__p+='\n    \x3c!-- Chunk loader configuration --\x3e\n    <script id="cache-chunks" type="application/javascript" nonce="'+(null==(__t=htmlWebpackPlugin.options.cspNonce)?"":__t)+"\">\n      window.__experienceWindowChunks__ = JSON.parse('"+(null==(__t=JSON.stringify(Object.fromEntries(allEntryAssets.map((e=>[e.id,e.path])))))?"":__t)+"');\n    <\/script>\n\n    \x3c!-- Include the javascript entries that are expliclity mentioned, in the order they are mentioned --\x3e\n    ",allEntryAssets)){var fileId=file.id,fileLocation=file.path,lazy=htmlWebpackPlugin.options.lazy,isLazy=lazy&&lazy.includes(fileId),isPolyfill=/polyfill/.test(fileId);isPolyfill?__p+='\n        <script nomodule id="'+(null==(__t=fileId)?"":__t)+'" src="'+(null==(__t=fileLocation)?"":__t)+'"><\/script>\n      ':isLazy||(__p+='\n        <script id="'+(null==(__t=fileId)?"":__t)+'" src="'+(null==(__t=fileLocation)?"":__t)+'"><\/script>\n        <script nonce="'+(null==(__t=htmlWebpackPlugin.options.cspNonce)?"":__t)+'">\n          registerPostExperienceStartedEvents("'+(null==(__t=fileId)?"":__t)+'");\n        <\/script>\n      '),__p+="\n    "}__p+="\n  "}__p+='\n\n  <script type="application/javascript" nonce="'+(null==(__t=htmlWebpackPlugin.options.cspNonce)?"":__t)+'">\n    // This code is required to provide post message communication between hosted iframe and MWv2 experience.\n    (function() {\n      function proxyPostMessage(target, message, targetOrigin) {\n        if (targetOrigin && target && target.contentWindow) {\n          target.contentWindow.postMessage(message, targetOrigin);\n        } else {\n          console.log("either targetOrigin or target is invalid");\n        }\n      }\n      window.proxyPostMessage = proxyPostMessage;\n    })();\n  <\/script>\n</body>\n</html>\n\n'}return __p}},674257:(e,t,n)=>{"use strict";n.d(t,{J:()=>u});var i=n(977528),a=n(359261),o=n(837824),r=n(23285),s=n(876850),l=n(738632),c=n(800189),d=n(723508);const u={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"chat"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"chat"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"groupTemplate"}},{kind:"Field",name:{kind:"Name",value:"picture"}},{kind:"Field",name:{kind:"Name",value:"isOneOnOne"}},{kind:"Field",name:{kind:"Name",value:"isOneOnOneBotChat"}},{kind:"Field",name:{kind:"Name",value:"isDisabled"}},{kind:"Field",name:{kind:"Name",value:"disabledReason"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"code"}},{kind:"Field",name:{kind:"Name",value:"newlyCreatedUserId"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingChatPolicy"}},{kind:"Field",name:{kind:"Name",value:"chatSubType"}},{kind:"Field",name:{kind:"Name",value:"chatType"}},{kind:"Field",name:{kind:"Name",value:"isSfB"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"isMeeting"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"isMuted"}},{kind:"Field",name:{kind:"Name",value:"isFederated"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"isRetentionHorizonSet"}},{kind:"Field",name:{kind:"Name",value:"isModerator"}},{kind:"Field",name:{kind:"Name",value:"isAdmin"}},{kind:"Field",name:{kind:"Name",value:"substrateGroupId"}},{kind:"Field",name:{kind:"Name",value:"lastMessage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"lastMessageFields"}}]}},{kind:"Field",name:{kind:"Name",value:"lastMessageSender"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userFields"}}]}},{kind:"Field",name:{kind:"Name",value:"me"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userFields"}}]}},{kind:"Field",name:{kind:"Name",value:"consumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonFields"}}]}},{kind:"Field",name:{kind:"Name",value:"consumptionHorizonBookmark"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonBookmarkFields"}}]}},{kind:"Field",name:{kind:"Name",value:"userConsumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonBookmarkFields"}}]}},{kind:"Field",name:{kind:"Name",value:"memberIds"}},{kind:"Field",name:{kind:"Name",value:"membersLimited"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userFields"}}]}},{kind:"Field",name:{kind:"Name",value:"memberDisplayNamesLimited"}},{kind:"Field",name:{kind:"Name",value:"hasFederatedUser"}},{kind:"Field",name:{kind:"Name",value:"hasTflConsumerUser"}},{kind:"Field",name:{kind:"Name",value:"cfet"}},{kind:"Field",name:{kind:"Name",value:"hasEnterpriseUser"}},{kind:"Field",name:{kind:"Name",value:"hasUnknownConsumerUser"}},{kind:"Field",name:{kind:"Name",value:"hasUnknownEnterpriseUser"}},{kind:"Field",name:{kind:"Name",value:"hasUnresolvedFederatedUser"}},{kind:"Field",name:{kind:"Name",value:"hasTflSmsUnverifiedUser"}},{kind:"Field",name:{kind:"Name",value:"hasTflSmsVerifiedUser"}},{kind:"Field",name:{kind:"Name",value:"nonTeamsFederatedUserLimitedNames"}},{kind:"Field",name:{kind:"Name",value:"nonTeamsFederatedUsersLength"}},{kind:"Field",name:{kind:"Name",value:"isPrivateChatPolicyDefinedScenario"}},{kind:"Field",name:{kind:"Name",value:"isChatDisabledForRecipients"}},{kind:"Field",name:{kind:"Name",value:"guardianChatInfo"}},{kind:"Field",name:{kind:"Name",value:"tflOffNetworkUser"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userFields"}}]}},{kind:"Field",name:{kind:"Name",value:"tflOffNetworkUserLength"}},{kind:"Field",name:{kind:"Name",value:"hasBotMember"}},{kind:"Field",name:{kind:"Name",value:"isUserMember"}},{kind:"Field",name:{kind:"Name",value:"botMembers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userFields"}}]}},{kind:"Field",name:{kind:"Name",value:"userAdminSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"adminDeleteEnabled"}},{kind:"Field",name:{kind:"Name",value:"deleteMessagesEnabled"}}]}},{kind:"Field",name:{kind:"Name",value:"creator"}},{kind:"Field",name:{kind:"Name",value:"meetingInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"meetingInformationFields"}}]}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"chatDisabledContext"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isUIDisabled"}},{kind:"Field",name:{kind:"Name",value:"disabledReason"}},{kind:"Field",name:{kind:"Name",value:"extendedData"}},{kind:"Field",name:{kind:"Name",value:"lastUpdatedTime"}}]}},{kind:"Field",name:{kind:"Name",value:"interopConversationStatus"}},{kind:"Field",name:{kind:"Name",value:"chatHistoryHiddenTime"}},{kind:"Field",name:{kind:"Name",value:"clearHistoryTime"}},{kind:"Field",name:{kind:"Name",value:"typingUsers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"typingUserFields"}}]}},{kind:"Field",name:{kind:"Name",value:"userProperties"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userProperties"}}]}},{kind:"Field",name:{kind:"Name",value:"pinnedConversationItems"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"pinnedMessageItemFields"}}]}}]}}]}}]}},...i.T.definitions,...a.f.definitions,...o.T.definitions,...r.v.definitions,...s.q.definitions,...l.l.definitions,...c.I.definitions,...d.E.definitions]}},562273:(e,t,n)=>{"use strict";n.d(t,{i:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"newChatIntentId"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"newChatIntentId"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}]}]}}]}},505341:(e,t,n)=>{"use strict";n.d(t,{$Z:()=>d,$g:()=>y,zf:()=>c});var i=n(805216),a=n(892891),o=n(933922),r=n(726352);const s={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"messageIdList"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"replyChainId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"cursor"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"messages"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}},{kind:"Argument",name:{kind:"Name",value:"replyChainId"},value:{kind:"Variable",name:{kind:"Name",value:"replyChainId"}}},{kind:"Argument",name:{kind:"Name",value:"cursor"},value:{kind:"Variable",name:{kind:"Name",value:"cursor"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"messages"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"messageIdFields"}}]}},{kind:"Field",name:{kind:"Name",value:"cursor"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"messageIdFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"from"}}]}}]};var l=n(740946);function c(e,t,n,i,r,l=!1,c){try{if((0,a.isEmpty)(i))return void(null==c||c.log(`convId: ${t}, replyChainId: ${n}:: newMessageBatch is empty!`));const o=s,d=u(e,o,t,n);if(!d)return void(null==c||c.warn(`convId: ${t}, replyChainId: ${n}:: cachedMessages is undefined!`));const{messages:m,typeName:h}=d;null==c||c.log(`convId: ${t}, replyChainId: ${n}:: newMessageBatch: [${i.map((e=>e.id))}]`);const v=g(e,i,m,r,l,c);v?p(e,t,n,o,v,h,c):null==c||c.log(`convId: ${t}, replyChainId: ${n}:: skipped writeCacheQuery. message list not updated!`)}catch(e){null==c||c.error((0,o.A)(e.message))}}const d=(e,t,n,i,r,l)=>{var c;const d=s,u={convId:t,replyChainId:n};try{const o=null===(c=e.readQuery({query:d,variables:u}))||void 0===c?void 0:c.messages;if(!o)return;const{messages:s,cursor:m,__typename:p}=o,g=(0,a.findLast)(s,(e=>e.id===i&&e.from===r));if(s&&g){const o=(0,a.without)(s,g);e.writeQuery({query:d,variables:u,data:{messages:{messages:o,cursor:m,__typename:p}}}),null==l||l.log(`convId: ${t}, replyChainId: ${n}:: deleted from cache. message: ${i}`)}}catch(e){null==l||l.error((0,o.A)(e.message))}},u=(e,t,n,i)=>{const a=e.readQuery({query:t,variables:{convId:n,replyChainId:i}});return m(a)},m=e=>{if(!e||!e.messages)return;const{messages:t,__typename:n}=e.messages;return t?{messages:t,typeName:n}:void 0},p=(e,t,n,i,a,o,r)=>{const s=a.length>0&&a[a.length-1].id,l={convId:t,replyChainId:n};e.writeQuery({query:i,variables:l,data:{messages:{messages:a,cursor:s,__typename:o}}}),null==r||r.log(`cache.writeQuery message: [${a.map((e=>e.id))}]`)},g=(e,t,n,i,a,o)=>{let r;const s=[];return t.forEach((t=>{let o=!1,l=!1;t.from===i&&n.find((e=>e.id===t.clientMessageId))?(l=!0,o=!0):n.find((e=>e.id===t.id))||(o=!0),a&&f(e,t),o?(r||(r=[...n]),l&&v(r,t),h(r,t)):s.push(t.id)})),s.length>0&&(null==o||o.log(`Skipped message ids [${s.map((e=>e))}]`)),r},h=(e,t)=>{(0,r.M)(e,t,(e=>-new Date(e.originalArrivalTime)))},v=(e,t)=>{const n=e.findIndex((e=>e.clientMessageId===t.clientMessageId));n>=0&&e.splice(n,1)},f=(e,t)=>{e.writeFragment({id:`${(0,i.uG)(t)}`,fragment:l.U,data:Object.assign({},t)})},y=(e,t,n,i)=>{if(!n||!i)return null;try{return e.readFragment({id:`Message:${i}`,fragment:l.U})}catch(e){return t.error(`failed to read message from cache for ${n} and ${i}`),null}}},971646:(e,t,n)=>{"use strict";n.d(t,{K:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"controllerConnectedServicesEnabled"}},{kind:"Field",name:{kind:"Name",value:"readReceiptsEnabled"}}]}}]}}]}},665207:(e,t,n)=>{"use strict";n.d(t,{yx:()=>r,Cs:()=>s});var i=n(632735);const a={isInEmbedContext:()=>!1,sendHeartbeat:()=>{},sendServerError:()=>{},sendDataLoadError:()=>{},sendConveneError:()=>{},sendMetadata:()=>{}},o=i.createContext(null),r=i.memo((e=>{const{conveneHostMessaging:t,children:n}=e,r={conveneHostMessaging:t||Object.assign({},a)};return i.createElement(o.Provider,{value:r},n)}));r.displayName="ConveneHostMessagingContextProvider";const s=()=>i.useContext(o)},869766:(e,t,n)=>{"use strict";n.d(t,{H:()=>i});class i{constructor(){this.registerAppPhase=({phase:e,signals:t,timeout:n})=>{const i=this._phasesMap.get(e);this._phasesMap.set(e,Object.assign(Object.assign({},i),{signals:t,timeout:n}))},this._phasesMap=new Map}get appPhases(){return{phases:this._phasesMap}}}},471687:(e,t,n)=>{"use strict";n.d(t,{SM:()=>l,mM:()=>c});var i=n(231191),a=n(632735),o=n(430969),r=n(892891);const s=a.createContext(void 0);s.displayName="CoreContext";const l=e=>{const{children:t}=e,n=(0,i.__rest)(e,["children"]);return a.createElement(s.Provider,{value:(0,o.Q)(n,r.isEqual)},t)};l.displayName="CoreContextProvider";s.Consumer;const c=()=>a.useContext(s)},702886:(e,t,n)=>{"use strict";var i;n.d(t,{fS:()=>E,B4:()=>F,SE:()=>R,G7:()=>P,TE:()=>D,Ix:()=>j,wR:()=>x,Od:()=>O,cJ:()=>L});var a=n(231191),o=n(632735),r=n(430969),s=n(331182),l=n(906386),c=n(946101),d=n(352367),u=n(471687);const{memo:m,useCallback:p,useEffect:g,useMemo:h,useRef:v,useState:f}=i||(i=n.t(o,2)),y=d.eT.Uninitialized,S=o.createContext(void 0);S.displayName="UserContext";const k=o.createContext({appState:y}),b=o.createContext({clientState:l.pk.Initializing}),_=o.createContext({amsV2Domain:""}),C=o.createContext({isOnline:!0}),w=m((({renderingContext:e,children:t})=>{const{discover:n,loggerFactory:i}=e,[s,l]=f(""),d=i&&i.newLogger("AmsContext");g((()=>{let e=!1;return!e&&(0,a.__awaiter)(void 0,void 0,void 0,(function*(){if(e)return;const t=yield n.regionGtm(c.Pn.amsV2);t&&!e&&(e=!0,l(t))})).catch((()=>{d&&d.warn("failed to get amsV2Domain")})),()=>{e=!0}}));const u=(0,r.Q)({amsV2Domain:s});return o.createElement(_.Provider,{value:u},t)})),T=({globalEntityCommanding:e,regenerateEntityCommandingServices:t,viewEntity:n,viewEntityName:i})=>{const a=v(n),o=(r=a.current,h((()=>{var e,t,n,i,a,o;return(null==r?void 0:r.action)!==(null==s?void 0:s.action)||(null==r?void 0:r.type)!==(null==s?void 0:s.type)||(null==r?void 0:r.id)!==(null==s?void 0:s.id)||(null===(e=null==r?void 0:r.linkedEntity)||void 0===e?void 0:e.action)!==(null===(t=null==s?void 0:s.linkedEntity)||void 0===t?void 0:t.action)||(null===(n=null==r?void 0:r.linkedEntity)||void 0===n?void 0:n.id)!==(null===(i=null==s?void 0:s.linkedEntity)||void 0===i?void 0:i.id)||(null===(a=null==r?void 0:r.linkedEntity)||void 0===a?void 0:a.type)!==(null===(o=null==s?void 0:s.linkedEntity)||void 0===o?void 0:o.type)?s:r}),[s=n,r]));var r,s;return g((()=>{a.current=n}),[n]),h((()=>o&&i?t(o,i):e),[e,t,i,o])};w.displayName="AmsContextProvider";const E=o.memo((({userId:e,viewEntity:t,viewEntityName:n,children:i})=>{var c;const{renderingContexts:d,defaultContext:m}=(0,u.mM)(),h=e&&d.get(e)||m,{appStateService:v,clientState:S,networkState:k,windowProvider:b,localStorage:_,interprocessStoreService:C,coreSettingsContext:E,entityCommanding:F,client:R,commandReportingService:P,loggerFactory:D,scenarioFactory:j,regenerateEntityCommandingServices:x,profilerService:O}=h,L=(0,a.__rest)(h,["appStateService","clientState","networkState","windowProvider","localStorage","interprocessStoreService","coreSettingsContext","entityCommanding","client","commandReportingService","loggerFactory","scenarioFactory","regenerateEntityCommandingServices","profilerService"]),U=T({globalEntityCommanding:F,regenerateEntityCommandingServices:x,viewEntity:t,viewEntityName:n}),B=p((()=>{U.destroy()}),[U]);g((()=>B),[B]);const W=Object.assign(Object.assign({},L),{entityCommanding:U,localStorageService:_,host:b,DEBUG_ONLY__getCoreSettingsDebugService:o.useCallback((()=>E.getDebugService()),[E]),loggerFactory:D,scenarioFactory:j,profilerService:O}),[H,$]=f(S&&S.getState()||l.pk.Initializing),V=o.useMemo((()=>S.observe()),[S]);(0,s.m)(V,{next:$});const[z,G]=f(null!==(c=v&&v.getState())&&void 0!==c?c:y),q=o.useMemo((()=>v.observe()),[v]);(0,s.m)(q,{next:G});const[J,K]=f(k&&k.isOnline()||!0),Q=o.useMemo((()=>k.observeIsOnline()),[k]);(0,s.m)(Q,{next:K});const Y=(0,r.Q)(W),X=(0,r.Q)({clientState:H}),Z=(0,r.Q)({appState:z}),ee=(0,r.Q)({isOnline:J});return o.createElement(I,{userContextValue:Y},o.createElement(N,{clientStateContextValue:X},o.createElement(A,{appStateContextValue:Z},o.createElement(w,{renderingContext:h},o.createElement(M,{networkStateContextValue:ee},i)))))}));E.displayName="UserContextProvider";const I=m((({children:e,userContextValue:t})=>o.createElement(S.Provider,{value:t},e)));I.displayName="UserContextProviderInner";const N=m((({children:e,clientStateContextValue:t})=>o.createElement(b.Provider,{value:t},e)));N.displayName="ClientStateContextProviderInner";const A=m((({children:e,appStateContextValue:t})=>o.createElement(k.Provider,{value:t},e)));A.displayName="AppStateContextProviderInner";const M=m((({children:e,networkStateContextValue:t})=>o.createElement(C.Provider,{value:t},e)));M.displayName="NetworkStateContextProvider";const F=S.Consumer,R=()=>o.useContext(S),P=e=>function(t){const n=R();return o.createElement(e,Object.assign({},Object.assign(Object.assign({},t),{userContext:n})))},D=(b.Consumer,()=>o.useContext(b)),j=(k.Consumer,()=>o.useContext(k)),x=(_.Consumer,()=>o.useContext(_)),O=C.Consumer,L=()=>o.useContext(C)},450571:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var i=n(231191),a=n(312788),o=n(632735),r=n(709712),s=n(775214),l=n(352367),c=n(708362),d=n(755537),u=n(980633);(0,c.J)().performance.mark("resolve-main-imports-end");const m=()=>Promise.all([n.e(89962),n.e(85256),n.e(61874),n.e(2845),n.e(41574),n.e(29138),n.e(38811),n.e(68865),n.e(29084),n.e(21439),n.e(55837),n.e(87851),n.e(63506),n.e(4655),n.e(21996),n.e(23741),n.e(89197),n.e(81222),n.e(2054)]).then(n.bind(n,800538));class p{constructor(e){this._activationOptions=e,this._mounted=!1,this._logger=this._activationOptions.coreServices.loggerFactory.newLogger("CoreReactRenderer")}activate(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){this.deactivate();try{return this._activateRoot()}catch(e){const t=(0,s.Tr)("Experience",l.jK.Undefined,"activate",e);return this._logger.error(t.message),this._activationOptions.coreServices.errorState.error=t,Promise.reject(t)}}))}deactivate(){this._mounted&&(a.unmountComponentAtNode(this._activationOptions.rootElement),this._mounted=!1)}_activateRoot(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{window:t,rootElement:n,coreServices:{altScenarioService:i,scenarioFactory:s}}=this._activationOptions,{RootRenderer:l}=yield(0,d.mT)(m,"core-essentials",s);return null===(e=null==i?void 0:i.altScenario)||void 0===e||e.mark(u.ck.CoreEssentialsChunkLoad),new Promise((e=>{a.render(o.createElement(l,Object.assign({},this._activationOptions)),n,(()=>{this._mounted=!0,t&&(0,r.rx)(t.document,n),e()}))}))}))}}},557351:(e,t,n)=>{"use strict";n.d(t,{c:()=>i});const i=e=>t=>t.reduce(((t,n)=>(t[n]=e[n],t)),{})},755641:(e,t,n)=>{"use strict";n.d(t,{F:()=>i,Z:()=>o});var i,a=n(480177);!function(e){e.CALLS_MONITOR="calls_monitor",e.DEFAULT="default",e.HEADER_AT_BOTTOM="header_at_bottom",e.HYER="hyer"}(i||(i={}));class o{constructor({layoutKey:e=i.DEFAULT,layoutMode:t,layoutTemplatesPerLayoutMode:n}){this.getTemplate=({layoutKey:e=i.DEFAULT,layoutMode:t,slots:n,slotsDimensionsOverrides:a={}})=>{const o=this._layoutTemplates[t][this._getKeyFromSlotNameArray(e,n)];return"function"==typeof o?o(a):o},this._getKeyFromSlotNameArray=(e=i.DEFAULT,t)=>[e,...[...t].sort()].join("-"),this._layoutTemplates={[a.lO.focus]:{},[a.lO.minimal]:{},[a.lO.standard]:{}},n[t].forEach((n=>{(n.layoutKey||i.DEFAULT)===e&&this._registerTemplates(Object.assign({layoutMode:t},n))}))}_registerTemplates({layoutKey:e=i.DEFAULT,layoutMode:t,responsiveTemplates:n,slots:a}){const o=this._getKeyFromSlotNameArray(e,a);if(void 0!==this._layoutTemplates[t][o])throw new Error(`You can't have two templates with same slots for same layoutMode, slots: ${o} layoutMode: ${t}`);this._layoutTemplates[t][o]="function"==typeof n?n:()=>n}}},191833:(e,t,n)=>{"use strict";n.d(t,{L:()=>l});var i=n(874645),a=n(406364),o=n(931473),r=n(346701),s=n(871177);const l={splashStyles:a,favicons:o,splash:i,preloadTitleBar:r,devtools:s}},709712:(e,t,n)=>{"use strict";n.d(t,{rx:()=>i});const i=(e,t)=>{((e,t)=>{const n=e.getElementById("splash-screen");n&&(n.setAttribute("aria-hidden","true"),e.body.removeChild(n),t&&(t.style.display="block"))})(e,t),(e=>{const t=e.getElementsByClassName("preload-title-bar-trim")[0];t&&e.body.removeChild(t)})(e)}},142029:(e,t,n)=>{"use strict";n.d(t,{o:()=>y});var i=n(231191),a=n(682796),o=n(755537),r=n(324273),s=n(450571),l=n(632735),c=n(312788),d=n(16381),u=n(722433),m=n(575379);const p=()=>((0,u.Qj)("ApolloCleaner"),l.createElement(m.eT,{client:{}},l.createElement("div",null)));class g extends l.PureComponent{constructor(){super(...arguments),this.divRef=l.createRef(),this.siblingEl=l.createRef()}componentDidMount(){const{document:e}=this.props.mainWindow,t=e.createElement("div");this.divRef.current&&(this.divRef.current.appendChild(t),t.dispatchEvent(new MouseEvent("mouseout",{bubbles:!0,cancelable:!0,relatedTarget:this.siblingEl.current})))}render(){return l.createElement("div",{ref:this.divRef},l.createElement("div",{ref:this.siblingEl,onMouseEnter:()=>{}}))}}class h extends l.PureComponent{constructor(){super(...arguments),this.state={mounted:!1}}componentDidMount(){this.setState({mounted:!0})}render(){return l.createElement("div",null)}}const v=e=>{(e=>{e.document.body.dispatchEvent(new MouseEvent("click",{bubbles:!0}))})(e)};var f=n(980633);const y=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const a=yield S(t);return e.pipe((0,r.j)((({id:e,window:i,context$:o})=>((e,t,n,i,a,o)=>{if(!e)return null;const r=e.document.getElementById("app");if(!r)return a.loggerFactory.newLogger("entry").error("element with ID 'app' not found on the document."),null;a.scenarioFactory.startStep(f.RG.ExperienceReady,f.ck.RenderProviders);const l=new s.Z({context$:t,coreServices:a,getExperienceProps:n,reactDiagnosticsService:o,rootElement:r,windowId:i,window:e});return l.activate(),{coreRenderer:l,host:e,windowId:i}})(i,o,n,e,t,a)),(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(!e)return;const{host:n,coreRenderer:a,windowId:o}=e;v(n),a.deactivate();const r=t.windowProvider;yield(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const t=e.document,n=t.body,i=t.createElement("div");i.setAttribute("id","memory-cleanup");const a=n.appendChild(i);yield(0,d._)(0),c.render(l.createElement(l.Fragment,null,l.createElement(p,null),l.createElement(g,{mainWindow:e}),l.createElement(h,null)),a),c.unmountComponentAtNode(a),n.removeChild(a)})))(r);const{dataCleanupService:s}=t;s.markDataForWindowAsInactive(o)}))),(({id:e})=>e))).subscribe()})),S=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{enableReactDiagnostics:t,enableReactDiagnosticsConsoleLog:i,enableReactDiagnosticsDisplayNameFix:r}=e.coreSettings.get(a.J.Diagnostics);if(t)try{const{initReactDiagnostics:t,ReactDiagnosticsService:a}=yield(0,o.mT)((()=>Promise.all([n.e(66475),n.e(23741),n.e(82271)]).then(n.bind(n,154470))),"react-diagnostics",e.scenarioFactory),s=new a(!!i,!!r);return t(s),s}catch(t){e.loggerFactory.newLogger("react-diagnostics").error(`Failed to load react-diagnostic ${t}`)}}))},303683:(e,t,n)=>{"use strict";n.d(t,{e:()=>i});const i=()=>null;i.displayName="EmptyRenderComponent"},902024:(e,t,n)=>{"use strict";n.d(t,{f:()=>s});var i=n(632735),a=n(397737),o=n(270154);class r extends i.Component{constructor(e){super(e),this.mounted=!1;const{i18n:t,namespace:n,namespaces:i}=e,a=(i||[]).filter((e=>!t.isNamespaceLoaded(e)));!n||t.isNamespaceLoaded(n)||a.includes(n)||a.push(n),this.state={namespacesToLoad:a}}componentDidMount(){const{i18n:e}=this.props;this.mounted=!0;const t=()=>{this.mounted&&this.setState((t=>({namespacesToLoad:t.namespacesToLoad.filter((t=>!e.isNamespaceLoaded(t)))})))};this.state.namespacesToLoad.length&&Promise.all(this.state.namespacesToLoad.map((t=>e.waitForNamespace(t)))).then(t).catch(t)}componentWillUnmount(){this.mounted=!1}render(){const{loaderRenderer:e,children:t}=this.props;return this.state.namespacesToLoad.length?e?e():null:t&&i.createElement(a.dE,null,t)||null}}const s=(0,o.G)(r);s.displayName="GenericNamespaceProvider"},397737:(e,t,n)=>{"use strict";n.d(t,{dE:()=>d,dL:()=>c});var i=n(632735),a=n(430969),o=n(850476);const r=(e,t,n)=>{var i,a;if(!(null===(i=e[t])||void 0===i?void 0:i.value))return!1;const r=null===(a=e[t])||void 0===a?void 0:a.params;return(0,o.V)(n,r)};var s=n(587248);const l=i.createContext({}),c=()=>i.useContext(l),d=e=>{const t=(e=>{let t;const n=Object.create(e),i=Object.getPrototypeOf(e);for(const e of Object.getOwnPropertyNames(i))"stringTranslate"!==e&&Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(i,e));return Object.defineProperty(n,"stringTranslate",{enumerable:!1,configurable:!0,value:(n,i,a)=>(t||(t={}),r(t,i,a)||(t[i]={value:e.stringTranslate(n,i,a),params:a}),t[i].value)}),n})((0,s.Cq)());return i.createElement(l.Provider,{value:(0,a.Q)(t)},e.children)}},587248:(e,t,n)=>{"use strict";n.d(t,{tL:()=>m,xR:()=>u,OO:()=>l,bd:()=>d,Cq:()=>c});var i=n(632735),a=n(638942),o=n(900984);class r{constructor(e){this.i18nextWrapper=e,this._i18n=new o.o(e)}get locale(){return this._i18n.locale}get isRtl(){return this._i18n.isRtl}get osDateTimeLocale(){return this._i18n.osDateTimeLocale}get osFirstDayOfWeek(){return this._i18n.osFirstDayOfWeek}get osLocaleInfo(){return this._i18n.osLocaleInfo}get firstDayOfWeek(){return this._i18n.firstDayOfWeek}translate(e,t,n){return this.stringTranslate(e,t,n)}stringTranslate(e,t,n){return this._i18n.stringTranslate(e,t,n)}getTransForNs(e){this.i18nextWrapper.latestTranslation.namespace=e;const t=this.i18nextWrapper.i18next.getFixedT(this.locale,e);return n=>i.createElement(a.cC,Object.assign({},n,{tOptions:(0,o.E)(n.i18nKey||"",n.tOptions),t,ns:e}))}waitForNamespace(e){return this._i18n.waitForNamespace(e)}getNamespaceState(e){return this._i18n.getNamespaceState(e)}isNamespaceLoaded(e){return this._i18n.isNamespaceLoaded(e)}formatDateTime(e,t,n){return this._i18n.formatDateTime(e,t,n)}formatNumber(e,t){return this._i18n.formatNumber(e,t)}getStringComparer(e){return this._i18n.getStringComparer(e)}sortStrings(e,t){return this._i18n.sortStrings(e,t)}getLocaleTimeSettings(){return this._i18n.getLocaleTimeSettings()}}var s=n(990461);const l=i.createContext({}),c=()=>i.useContext(l),d=({locale:e,i18NextWrapper:t,host:n,children:o})=>{const[c,d]=i.useState(null);return i.useEffect((()=>{let i=!0;return e?t.setLocale(e).then((()=>{var a;if(!i)return;d(new r(t));const o=null===(a=null==n?void 0:n.document)||void 0===a?void 0:a.documentElement;o&&(s.p0.setLangAttribute(o,e),s.p0.setDirAttribute(o,void 0,e))})):d(new r(t)),()=>{i=!1}}),[n,t,e]),c?i.createElement(l.Provider,{value:c},i.createElement(a.a3,{i18n:t.i18next},o)):null},u=l.Consumer,m=({host:e,locale:t})=>{var n;const i=null===(n=e.document)||void 0===n?void 0:n.documentElement;return i&&(s.p0.setLangAttribute(i,t),s.p0.setDirAttribute(i,void 0,t)),null}},270154:(e,t,n)=>{"use strict";n.d(t,{G:()=>o});var i=n(632735),a=n(587248);const o=e=>t=>i.createElement(a.OO.Consumer,null,(n=>i.createElement(e,Object.assign({},Object.assign(Object.assign({},t),{i18n:n})))))},722433:(e,t,n)=>{"use strict";n.d(t,{Fd:()=>a,t$:()=>o,Qj:()=>r,RI:()=>s});var i=n(632735);const a=i.createContext({track:()=>{}}),o=i.memo((({children:e,service:t})=>{const n=i.useMemo((()=>{const e=null==t?void 0:t.create();return e?{track:(t,n)=>{e.track(t,n)}}:{track:()=>{}}}),[t]);return i.createElement(a.Provider,{value:n},e)}));o.displayName="LeakDetectorContextProvider";a.Consumer;const r=e=>{const t=i.useRef({}),n=i.useContext(a);i.useEffect((()=>n.track(e,t.current)),[n,e])},s=e=>t=>{const{track:n}=i.useContext(a);return i.createElement(e,Object.assign({},Object.assign(Object.assign({},t),{track:n})))}},381031:(e,t,n)=>{"use strict";n.d(t,{p3:()=>u,Lk:()=>m});var i=n(632735),a=n(4289),o=n(298241);const r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"lpcState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lpcState"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isLivePersonaCardInitialized"}}]}}]}}]};var s=n(430969),l=n(892891);const c=i.createContext({IsLivePersonaCardInitialized:!1}),d=e=>{const t={IsLivePersonaCardInitialized:e.IsLivePersonaCardInitialized};return i.createElement(c.Provider,{value:(0,s.Q)(t,l.isEqual)},e.children)},u=(0,o.CG)((e=>i.createElement(a.AE,{query:r},(({data:t,loading:n,error:a})=>{const o=!n&&!a&&!!t&&!!t.lpcState&&t.lpcState.isLivePersonaCardInitialized;return i.createElement(d,{children:e.children,IsLivePersonaCardInitialized:o})})))),m=()=>i.useContext(c)},590158:(e,t,n)=>{"use strict";var i,a;n.d(t,{Rd:()=>i,Ai:()=>a,rG:()=>o}),function(e){e[e.IS_GREATER_THAN_0=1]="IS_GREATER_THAN_0",e[e.IS_AT_LEAST_320=320]="IS_AT_LEAST_320",e[e.IS_AT_LEAST_360=360]="IS_AT_LEAST_360",e[e.IS_AT_LEAST_375=375]="IS_AT_LEAST_375",e[e.IS_AT_LEAST_414=414]="IS_AT_LEAST_414",e[e.IS_AT_LEAST_480=480]="IS_AT_LEAST_480",e[e.IS_AT_LEAST_640=640]="IS_AT_LEAST_640",e[e.IS_AT_LEAST_720=720]="IS_AT_LEAST_720",e[e.IS_AT_LEAST_768=768]="IS_AT_LEAST_768",e[e.IS_AT_LEAST_834=834]="IS_AT_LEAST_834",e[e.IS_AT_LEAST_947=947]="IS_AT_LEAST_947",e[e.IS_AT_LEAST_1000=1e3]="IS_AT_LEAST_1000",e[e.IS_AT_LEAST_1024=1024]="IS_AT_LEAST_1024",e[e.IS_AT_LEAST_1280=1280]="IS_AT_LEAST_1280",e[e.IS_AT_LEAST_1350=1350]="IS_AT_LEAST_1350",e[e.IS_AT_LEAST_1440=1440]="IS_AT_LEAST_1440",e[e.IS_AT_LEAST_1500=1500]="IS_AT_LEAST_1500",e[e.IS_AT_LEAST_1680=1680]="IS_AT_LEAST_1680",e[e.IS_AT_LEAST_1920=1920]="IS_AT_LEAST_1920",e[e.IS_AT_LEAST_2048=2048]="IS_AT_LEAST_2048",e[e.IS_AT_LEAST_2560=2560]="IS_AT_LEAST_2560"}(i||(i={})),function(e){e[e.IS_GREATER_THAN_0=1]="IS_GREATER_THAN_0",e[e.IS_AT_LEAST_320=320]="IS_AT_LEAST_320",e[e.IS_AT_LEAST_480=480]="IS_AT_LEAST_480",e[e.IS_AT_LEAST_568=568]="IS_AT_LEAST_568",e[e.IS_AT_LEAST_667=667]="IS_AT_LEAST_667",e[e.IS_AT_LEAST_768=768]="IS_AT_LEAST_768",e[e.IS_AT_LEAST_1024=1024]="IS_AT_LEAST_1024",e[e.IS_AT_LEAST_1366=1366]="IS_AT_LEAST_1366"}(a||(a={}));const o=(e,t={})=>{const{isMinWidthBreakpointAtLeast360:n,isMinWidthBreakpointAtLeast720:i}=e,{offsetForMinWidthBreakpointIsGreaterThan0:a,offsetForMinWidthBreakpointAtLeast360:o,offsetForMinWidthBreakpointAtLeast720:r}=t;let s=a;i?s=r:n&&(s=o),s=s||0;const l=((({isMinWidthBreakpointAtLeast320:e,isMinWidthBreakpointAtLeast360:t,isMinWidthBreakpointAtLeast375:n,isMinWidthBreakpointAtLeast414:i,isMinWidthBreakpointAtLeast480:a,isMinWidthBreakpointAtLeast640:o,isMinWidthBreakpointAtLeast720:r,isMinWidthBreakpointAtLeast768:s,isMinWidthBreakpointAtLeast834:l,isMinWidthBreakpointAtLeast947:c,isMinWidthBreakpointAtLeast1000:d,isMinWidthBreakpointAtLeast1024:u,isMinWidthBreakpointAtLeast1280:m,isMinWidthBreakpointAtLeast1350:p,isMinWidthBreakpointAtLeast1440:g,isMinWidthBreakpointAtLeast1500:h,isMinWidthBreakpointAtLeast1680:v,isMinWidthBreakpointAtLeast1920:f,isMinWidthBreakpointAtLeast2048:y,isMinWidthBreakpointAtLeast2560:S})=>S?2560:y?2048:f?1920:v?1680:h?1500:g?1440:p?1350:m?1280:u?1024:d?1e3:c?947:l?834:s?768:r?720:o?640:a?480:i?414:n?375:t?360:e?320:319)(e)-s)/10+"rem";return{"--width":l,width:[l,"var(--width)"]}}},891836:(e,t,n)=>{"use strict";n.d(t,{r:()=>m,P:()=>u});var i=n(632735),a=n(503008),o=n(682796),r=n(575379);const s={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"FetchSearchPrefetchConfigs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"searchPrefetchConfigs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"verticals"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"searchVerticalConfig"}}]}},{kind:"Field",name:{kind:"Name",value:"ecsSettings"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"searchVerticalConfig"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"SearchVerticalConfig"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"queryTemplate"}},{kind:"Field",name:{kind:"Name",value:"entities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entity"}}]}},{kind:"Field",name:{kind:"Name",value:"refiners"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"refiner"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"entity"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"SearchEntity"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"contentSources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"contentSource"}}]}},{kind:"Field",name:{kind:"Name",value:"entityType"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"contentSource"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"SearchContentSource"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"refiner"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"SearchRefiner"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"layout"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"layout"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"layout"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"RefinerLayout"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"fieldName"}},{kind:"Field",name:{kind:"Name",value:"displayInterface"}}]}}]}.definitions]}.definitions]};var l=n(702886),c=n(980633);const d=i.createContext({verticals:[],isInitialized:!1,initLokiCall:()=>null}),u=()=>i.useContext(d),m=i.memo((e=>{const t=e.callImmediately||!1,{enableCustomVerticals:n}=(0,a.NC)(o.J.Serp),[u,m]=i.useState(0),{scenarioFactory:p,host:{requestIdleCallback:g,cancelIdleCallback:h}}=(0,l.SE)(),v=(0,r.useApolloClient)(),[f,y]=i.useState([]),[S,k]=i.useState(),[b,_]=i.useState(!1),[C,w]=i.useState(t),T=n&&(C||t),E=n&&!T,I=i.useCallback((()=>{const e=p.newScenario(c.RG.CustomSearchPreFetch,{startTime:Date.now()});v.query({query:s,fetchPolicy:"cache-first"}).then((t=>{var n;const i=null===(n=t.data)||void 0===n?void 0:n.searchPrefetchConfigs;i&&(y(i.verticals),i.ecsSettings&&k(i.ecsSettings)),_(!0),null==e||e.stop()}))}),[v,p]);i.useEffect((()=>{T&&(h(u),I())}),[I,T,h,u]),i.useEffect((()=>{E&&m(g(I))}),[E,I,g,m]);const N=i.useCallback((()=>w(!0)),[]);return n?i.createElement(d.Provider,{value:{verticals:f,ecsSettings:S,isInitialized:b,initLokiCall:N}},e.children):i.createElement(i.Fragment,null,e.children)}))},503008:(e,t,n)=>{"use strict";n.d(t,{NC:()=>o,h_:()=>r});var i=n(632735),a=n(702886);const o=e=>{const{coreSettings:t}=(0,a.SE)(),[n,o]=(0,i.useState)((()=>t?t.get(e):{}));return(0,i.useEffect)((()=>{if(t){const n=t.getObservable(e).subscribe(o);return()=>n.unsubscribe()}return()=>{}}),[t,e]),n},r=({category:e,children:t})=>t(o(e))},430969:(e,t,n)=>{"use strict";n.d(t,{Q:()=>o});var i=n(632735),a=n(850476);const o=(e,t=a.V)=>{const n=(0,i.useRef)(e);return t(n.current,e)||(n.current=e),n.current}},331182:(e,t,n)=>{"use strict";n.d(t,{m:()=>c});var i=n(632735),a=n(550070),o=n(537330),r=n(276053),s=n(157459),l=n(430969);const c=(e,t,n)=>{const c=(0,i.useRef)(),{next:d,error:u,complete:m}=(0,l.Q)(t),p=(0,i.useCallback)((()=>{var e;null===(e=c.current)||void 0===e||e.unsubscribe(),c.current=void 0}),[]),g=(0,i.useMemo)((()=>{let t=[];return e?(n&&(t=[(0,r.K)((e=>(u&&u(e),(0,o._)(e)))),(0,s.a)((e=>n?e:a.E))]),e.pipe.apply(e,t)):a.E}),[e,n,u]);return(0,i.useEffect)((()=>(p(),c.current=g.subscribe({next:d,error:u,complete:m}),p)),[g,d,u,m,p]),p}},283232:(e,t,n)=>{"use strict";n.d(t,{g:()=>r,j:()=>s});var i=n(635649),a=n(775214),o=n(352367);const r=(e,t)=>{var n,a;return e.isGeneral?t!==i.GeneralChannelPosting.OwnersPost||e.memberRole===i.TeamMemberRole.Admin:e.memberRole===i.TeamMemberRole.Admin||e.isModerator||(null===(n=e.channelSettings)||void 0===n?void 0:n.channelPostPermissions)===i.ChannelPostPermissions.Everyone||(null===(a=e.channelSettings)||void 0===a?void 0:a.channelPostPermissions)===i.ChannelPostPermissions.EveryoneButGuests&&e.memberRole!==i.TeamMemberRole.Guest&&e.memberRole!==i.TeamMemberRole.Undefined},s=(e,t)=>{const n=decodeURIComponent(e),{channelId:i,replyChainId:r}=l(n,t),s="string"==typeof i,c="string"==typeof r||null==r;if(!s||!c)throw null==t||t.error("!!! throwing error because",!s,!c),(0,a.Tr)("TeamsAndChannelsHelper",o.jK.InvalidInput,"extractChannelMessageCompoundId",{compoundId:e});return{channelId:i,replyChainId:r}},l=(e,t)=>{try{const{channelId:t,replyChainId:n}=JSON.parse(e);return{channelId:t,replyChainId:n}}catch(n){return null==t||t.warn(`Exception parsing channel navigation args JSON, will assume the passed id is a channel id: ${e}`),{channelId:e}}}},684703:(e,t,n)=>{"use strict";n.d(t,{J:()=>c,k:()=>g});var i=n(231191),a=n(132887),o=n(705186),r=n(975883),s=n(238091);const l=[a.aw,a.qx];let c;const d=e=>{const t=e.typeName;return{user:e.user?JSON.stringify(e.user):"GLOBAL",typeName:t,key:e.key?e.key.toUpperCase():t}},u=(e,t)=>({storageKey:`$[${t.user}][${t.typeName}][${t.key}]`,loggingKey:`$[${e.user?`${e.user.oid}-${e.user.tenantId}`:t.user}][${t.typeName}][${t.key}]`});class m{constructor(e){this._expireOffsetSeconds=a.rF.SECONDS_FIVE_MINUTES,this._expireOffsetSecondsMin=a.rF.SECONDS_PER_MINUTE,this.internalCache={GLOBAL:{User:{},Token:{},MsalAccount:{}}},this._initializeCacheForCacheItem=(e,t)=>{void 0===this.internalCache[t]?(this.internalCache[t]={},this.internalCache[t][e]={}):void 0===this.internalCache[t][e]&&(this.internalCache[t][e]={})},this._addToExternalCache=(e,t)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=d(e),{storageKey:i,loggingKey:a}=u(e,n);try{this._storage.setItem(i,(0,r.u4)(t))}catch(e){o.k.error(`error in putting key [${a}] in storage, error - [${(0,r.VK)(e)}]`)}})),this._deleteFromExternalCache=e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=d(e),{storageKey:n,loggingKey:i}=u(e,t);try{this._storage.removeItem(n)}catch(e){o.k.error(`error in deleting key [${i}] in storage, error - [${(0,r.VK)(e)}]`)}})),this._flushExternalCache=e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const t={};Object.keys(this._storage).forEach((n=>{l.forEach((e=>{if(-1!==n.indexOf(e)){const e=this._storage.getItem(n);e&&(t[n]=e)}})),(!e&&0===n.indexOf("$[")||e&&-1!==n.indexOf(e.oid))&&this._storage.removeItem(n)})),Object.keys(t).forEach((e=>{this._storage.setItem(e,t[e])}))}catch(e){o.k.error(`error in clearing storage, error - [${(0,r.VK)(e)}]`)}})),this._isGlobalUser=e=>{var t,n;const i=null===(n=null===(t=this.internalCache.GLOBAL)||void 0===t?void 0:t.User)||void 0===n?void 0:n.User;return i&&(0,s.FG)((0,s.Xx)(i.item),e)},this._putGlobalUserInCache=(e,t)=>{var n,i;if((null===(i=null===(n=this.internalCache.GLOBAL)||void 0===n?void 0:n.User)||void 0===i?void 0:i.User)&&e.user)return;const a=e.user?"GLOBAL":JSON.stringify((0,s.Xx)(t.item));this._initializeCacheForCacheItem("User",a),this.internalCache[a].User.User=t;const o=`$[${a}][User][User]`;this._storage.setItem(o,JSON.stringify(t))},this._validateValue=(e,t)=>{var n,i;if(!("Token"!==e.typeName||"object"==typeof t&&t.token&&t.expires))throw new Error("Invalid value for Token.");if(!("Discover"!==e.typeName||e.key!==a.rz||"object"==typeof t&&t.skypeToken&&t.expiration))throw new Error("Invalid value for Skype token.");if("User"!==e.typeName)return;if(!(t.userName&&t.type&&t.role&&t.profile&&void 0!==t.isAuthenticated))throw new Error("Invalid value for user.");const o=null===(i=null===(n=this.internalCache.GLOBAL)||void 0===n?void 0:n.User)||void 0===i?void 0:i.User,r=(0,s.Xx)(t);if(o&&!e.user&&!this._isGlobalUser(r))throw new Error("there is already global user in auth cache")},this._storage=e.localStorage,o.k.info("auth_cache initialized")}setExpiryOffset(e,t){e&&(this._expireOffsetSeconds=e),t&&(this._expireOffsetSecondsMin=t)}put(e,t){var n,i;p(e),this._validateValue(e,t);const{typeName:a,key:o,user:r}=d(e);"Token"===a&&(t.fromCache=!0);let s=null===(i=null===(n=this.internalCache[r])||void 0===n?void 0:n[a])||void 0===i?void 0:i[o];return s?(s.hitCount=0,s.item=t):s={item:t,shouldRefresh:!1,hitCount:0},"User"===a&&this._putGlobalUserInCache(e,s),this._initializeCacheForCacheItem(a,r),this.internalCache[r][a][o]=s,this._addToExternalCache(e,s),!0}get(e){var t,n,i;p(e);const a=d(e),{storageKey:s,loggingKey:l}=u(e,a),{typeName:c,key:m,user:g}=a;let h=null===(n=null===(t=this.internalCache[g])||void 0===t?void 0:t[c])||void 0===n?void 0:n[m];if(!h){o.k.info(`value for key [${l}] not found in memory. checking in storage`);try{const e=null===(i=this._storage)||void 0===i?void 0:i.getItem(s);e&&(h=JSON.parse(e))}catch(e){o.k.error(`value for key [${l}] throw error. ${(0,r.VK)(e)}`)}}if(h)return this._initializeCacheForCacheItem(c,g),this.internalCache[g][c][m]=h,("Token"===c||"Discover"===c&&"SKYPE-TOKEN"===m)&&(h.shouldRefresh=this._shouldRefresh(h.item,c),h.hitCount++,this.internalCache[g][c][m]=h,this._addToExternalCache(e,h)),void 0===h.shouldRefresh?(o.k.info(`cacheItem '[${s}]' need to refresh`),void this.del(e)):(o.k.info(`returning cacheItem '[${s}]' from cache. found: [${!!h}]`),h);o.k.info(`value for key [${l}] not found in storgae`)}getValue(e){const t=this.get(e);return t?this._value(t):void 0}del(e){var t,n,i,a;if(!e)return o.k.error(`Invalid cacheKey: ${e}`),!1;if(!e.typeName)return o.k.error(`Invalid cacheKey type: ${e.typeName}`),!1;if("User"===e.typeName)return this.flush(e.user),!0;const r=d(e),{loggingKey:s}=u(e,r),{typeName:l,key:c,user:m}=r;(null===(n=null===(t=this.internalCache[m])||void 0===t?void 0:t[l])||void 0===n?void 0:n[c])&&o.k.info(`Value of key: [${s}] exists before deletion]`);const p=(null===(a=null===(i=this.internalCache[m])||void 0===i?void 0:i[l])||void 0===a?void 0:a[c])&&delete this.internalCache[m][l][c],g=this._deleteFromExternalCache(e);return o.k.info(`deleted from local auth-cache. key: [${s}], done - local: [${p}], storage: [${g}]`),p}delTokensWithError(e,t){var n,i,a,o;const{user:r,typeName:s}=d({user:e,typeName:"Token"});if(null===(n=this.internalCache[r])||void 0===n?void 0:n[s]){const n=this.internalCache[r][s];for(const r in n)(null===(o=null===(a=null===(i=n[r])||void 0===i?void 0:i.item)||void 0===a?void 0:a.error)||void 0===o?void 0:o.errorCode)===t&&this.del({user:e,typeName:s,key:r})}}deleteType(e,t){var n;const{user:i,typeName:a}=d({user:e,typeName:t});if(null===(n=this.internalCache[i])||void 0===n?void 0:n[a]){let t;if("Token"===a)t=this.internalCache[i][a];else{if("Discover"!==a)return;t=this.internalCache[i][a]}for(const n in t)n&&this.del({user:e,typeName:a,key:n})}}flush(e){if(o.k.info("flushing data from cache"),!e||this._isGlobalUser(e))this.internalCache={},this._flushExternalCache();else{const t=JSON.stringify(e);this.internalCache[t]={},this._flushExternalCache(e)}o.k.info("flushing completed")}_value(e){return e.item}_shouldRefresh(e,t){var n,i;const o="Token"===t?null===(n=e)||void 0===n?void 0:n.expires:null===(i=e)||void 0===i?void 0:i.expiration,r=Math.round(Date.now()/a.rF.MILLI_PER_SECOND);let s;if(s="Discover"===t?Math.round(o/a.rF.MILLI_PER_SECOND):"Token"===t?o:void 0,e&&s){const e=s-this._expireOffsetSeconds;if(r<=s-this._expireOffsetSecondsMin)return r>=e}}}const p=e=>{if(!(-1===["Token","Discover"].indexOf(e.typeName)||e.key&&e.user))throw new Error(`key/user cannot be empty for type [${e.typeName}]: key: ${e.key}, user: ${+!!e.user}`)},g=e=>{c||(c=new m(e))}},277373:(e,t,n)=>{"use strict";n.d(t,{VF:()=>i,Jl:()=>a});const i=e=>({userDetail:{user:e,typeName:"Discover",key:"discover-user-details"},regionGtm:{user:e,typeName:"Discover",key:"discover-region-gtm"},skypeToken:{user:e,typeName:"Discover",key:"skype-token"},user:{user:e,typeName:"User"},loginValidation:{user:e,typeName:"LoginValidation"}}),a={LogoutState:{typeName:"LogoutState"}}},132887:(e,t,n)=>{"use strict";n.d(t,{aw:()=>i,qx:()=>a,l6:()=>o,$N:()=>r,yc:()=>s,DT:()=>l,SM:()=>c,wK:()=>d,rz:()=>u,ru:()=>m,op:()=>p,ej:()=>g,QN:()=>v,gX:()=>f,ex:()=>S,s9:()=>k,uI:()=>b,rF:()=>_,zP:()=>C,j:()=>w});const i="TflFreProfileCardDisplayed",a="LogoutState",o="tmp.previous.silent.signin",r="in-progress",s={nopa:"2"},l={coa:"1"},c={AuthProviderLoadError:"AuthProviderLoadError",InitFailure:"Core-auth init failure",InvalidScopeResource:"invalid_scope",NoAccountFound:"NoAccountFound",SignInRestrictions:"SignInRestrictions",UserNotFoundError:"User not found",NativeAuthModuleNotPresent:"NativeAuthModuleNotPresent",RemoteOperationFailed:"RemoteOperationFailed",SsoFirstAccountFailed:"SsoFirstAccountFailed"},d={NoNetwork:"NoNetwork",ApiContractViolation:"ApiContractViolation",UiAlreadyShowing:"Cannot sign in when UI is showing"},u="skype-token",m="discover-user-details",p="discover-region-gtm";var g;!function(e){e.LOKI_TFL_AUTH_TOKEN_AUDIENCE="liveprofilecard.access",e.MT_AAD_KEY="https://api.spaces.skype.com",e.MT_KEY="middleTier",e.SKYPE_KEY="skype",e.SIGNIN_RESTRICTIONS_KEY="SignInRestrictions",e.AUTHZ_DEFAULT_BASE_URL="https://authsvc.teams.microsoft.com/v1.0/authz"}(g||(g={}));let h=["[auth][authserviceBack][error] Due to current app state '[isOnline=false]' cannot start retry fetch of ADAL tokens","[auth][authservice][error] Due to current app state '[isOnline=false]' cannot start retry fetch of ADAL tokens","[auth][authservice][error] Cannot start retry fetch of ADAL tokens without relogin. Rejecting token request","aborted","A silent sign-in request was sent but none of the currently signed in user(s) match the requested login hint","Cannot start retry fetch of ADAL tokens without relogin. Rejecting token request","Cannot start retry fetch of ADAL tokens, isPassive: false","Cancelling all retries due to: orchestration authenticationService_offline","Cancelling all retries due to: Relogin succeeded. Need to refresh tokens","Due to current app state cannot start retry fetch of ADAL tokens","noAccessForResource","resourceRequiresConsent","resourceDisabled","Seamless single sign on failed for the user. This can happen if the user is unable to access on premises AD or intranet zone is not configured correctly","tokenRevoked","tpmError","Webclient Auth request reached maximum timeout - 60000.","popup_window_error"];const v=e=>(e&&(h=[...h,...e]),h),f=()=>h;let y=[];const S=e=>(e&&(y=[...y,...e]),y),k=e=>y.includes(e);var b,_;!function(e){e[e.ONE=1]="ONE",e[e.TWO=2]="TWO",e[e.FOUR=4]="FOUR",e[e.FIVE=5]="FIVE",e[e.FIFTEEN=15]="FIFTEEN",e[e.SIXTEEN=16]="SIXTEEN",e[e.THIRTY=30]="THIRTY"}(b||(b={})),function(e){e[e.SECONDS_PER_MINUTE=60]="SECONDS_PER_MINUTE",e[e.MINUTES_PER_HOUR=60]="MINUTES_PER_HOUR",e[e.MILLI_PER_SECOND=1e3]="MILLI_PER_SECOND",e[e.SECONDS_FIVE_MINUTES=300]="SECONDS_FIVE_MINUTES",e[e.ONE_HOUR=36e5]="ONE_HOUR"}(_||(_={}));const C="9188040d-6c67-4c5b-b112-36a304b66dad",w=(b.TWO,_.MILLI_PER_SECOND,_.SECONDS_PER_MINUTE,{SKYPE_REQUEST:"skype_request_start",SKYPE_REQUEST_STOP:"skype_request_stop",SKYPE_SEND_REQUEST:"skype_send_request_start",SKYPE_SEND_REQUEST_STOP:"skype_send_request_stop",SKYPE_RECEIVED_RESPONSE:"skype_received_response",SKYPE_SEND_REQUEST_DESKTOP:"skype_send_request_desktop",SKYPE_SEND_REQUEST_WORKER:"skype_send_request_worker",SKYPE_TOKEN_RECEIVED_WORKER:"skype_token_received_worker",RECEIVE_CLAIM:"receive_claim"})},705186:(e,t,n)=>{"use strict";n.d(t,{k:()=>a});var i=n(920909);const a=new class{constructor(){this.logLevel=i.in.Info,this.localCallback=void 0,this.error=(e,t)=>this.logMessage(i.in.Error,e,t),this.warning=(e,t)=>this.logMessage(i.in.Warning,e,t),this.warn=(e,t)=>this.warning(e,t),this.info=(e,t)=>this.logMessage(i.in.Info,e,t),this.log=(e,t)=>this.info(e,t),this.verbose=(e,t)=>this.logMessage(i.in.Verbose,e,t),this.debug=(e,t)=>this.verbose(e,t)}initialize(e,t=i.in.Info){this.localCallback=e,this.logLevel=t}executeCallback(e,t,n){this.localCallback?this.localCallback(e,t,n):console&&console.log(t)}logMessage(e,t,n){if(e>this.logLevel)return;const i=`[Core-Auth][${e}]: ${(new Date).toUTCString()} : ${n?`: ${n}`:""} - ${t}`;this.executeCallback(e,i,n)}}},295556:(e,t,n)=>{"use strict";n.d(t,{c:()=>c,T:()=>d});var i=n(705186),a=n(975883),o=n(547514);class r{}r._authTelemetryCollection={},r._correlationMap={},r.getAuthTelemetry=e=>r._authTelemetryCollection[e],r.setAuthTelemetry=(e,t)=>r._authTelemetryCollection[e]=t,r.delete=e=>{delete r._authTelemetryCollection[e];const t=Object.keys(r._correlationMap);for(const n in t)if(r._correlationMap.hasOwnProperty(t[n])){const i=t[n],a=r._correlationMap[i];a&&(r._correlationMap[i]=a.filter((t=>t!==e)))}},r.getCorrelation=e=>r._correlationMap[e],r.setCorrelation=e=>{const t=r.getCorrelation(e.scenarioName)||[];-1===t.indexOf(e.id)&&t.push(e.id),r._correlationMap[e.scenarioName]=t};class s{constructor(e,t,n,s,l){this._scenarioFactory=e,this._correlation=t,this._subContext=n,this._shouldCreateScenario=s,this._eventData=[],this.appendScenarioEventData=e=>{this._scenario?this._scenario.appendEventData(e):this.addEventData([(0,a.u4)(e)])},this.addEventData=e=>{this._eventData=this._eventData.concat(e)},this.getEventData=()=>[...this._eventData],this.addScenarioMark=(e,t={},n)=>{var r;const s=`[${this._subContext}][${(0,a.u4)(this._correlation)}][${e}]`;if(t.subContext=t.subContext||this._subContext,t.reason=`{reason: ${t.reason}, eventData: ${this._eventData.join(";")}}`,t.scenarioPhase=this._correlation.scenarioPhase,t.error&&(this.addEventData([`err:${t.error.errorCode}`]),t.message=`message - [${t.message}], errorMessage - [${t.error.message}]`,t.errorCode=null!==(r=t.error.code)&&void 0!==r?r:t.error.errorCode),!n&&t.error&&(n=(0,o.ZG)(t.error)?"incomplete":"failure"),n=n||"success",!this._scenario)return this.addEventData([`${e}:${n}`]),void i.k.debug(`addScenarioMark called with ${s}, but there was no such scenario`);this._scenario.mark(e,t,n),i.k.log(`${s} ${e} - ${n}. eventData: [${(0,a.u4)(t)}]`)},this.closeScenario=(e={},t)=>{var n,s;const l=`[${this._subContext}][${(0,a.u4)(this._correlation)}][closeScenario]`;if(this._scenario){if(e.subContext=e.subContext||this._subContext,e.reason=`{reason: ${e.reason}, eventData: ${this._eventData.join(";")}}`,e.scenarioPhase=this._correlation.scenarioPhase,e.error)return this.addEventData([`err:${e.error.errorCode}`]),e.message=`message - [${e.message}], errorMessage - [${e.error.message}]`,e.errorCode=null!==(s=null!==(n=e.errorCode)&&void 0!==n?n:e.error.code)&&void 0!==s?s:e.error.errorCode,(0,o.ZG)(e.error)?this._scenario.incomplete(e):this._scenario.fail(e),r.delete(this._correlation.id),void i.k.log(`${l} - ${t}. eventData: [${(0,a.u4)(e)}]`);i.k.log(`${l} - ${t}. eventData: [${(0,a.u4)(e)}]`),"abandoned"===t?this._scenario.cancel(e):this._scenario.stop(e),r.delete(this._correlation.id)}else i.k.warn(`closeScenario called with ${l}, but there was no such scenario. . eventData: [${(0,a.u4)(e)}]`)},this.createScenario=(e,t,n)=>{this._scenario?i.k.warn(`createScenario called with [${this._subContext}][${(0,a.u4)(this._correlation)}]::${e}, but there was is already a scenario with that correltion id`):(this._shouldCreateScenario=!0,this._createScenario(e,n),t&&this.appendScenarioEventData(t))},this._createScenario=(e,t)=>{var n,o,r;const s=t?{timeoutMs:t}:{};this._scenario=null!==(n=this._scenarioFactory.findScenario(e))&&void 0!==n?n:this._scenarioFactory.newScenario(e,s),null===(r=(o=this._scenarioFactory).hoistScenarioToCore)||void 0===r||r.call(o,this._scenario),this._scenario.appendEventData({secondaryCorrelationId:this._correlation.id,commandSource:this._correlation.source}),i.k.log(`createScenario called with [${this._subContext}][${(0,a.u4)(this._correlation)}] scenario created.`)},this._shouldCreateScenario&&this._createScenario(this._correlation.scenarioName,l),this._eventData.push(`^fn:${this._subContext}`)}get correlation(){return Object.assign({},this._correlation)}}class l{constructor(e){this._scenarioProvider=e,this.getCorrelation=e=>r.getCorrelation(e)||[],this._createScenario=(e,t)=>{const{correlation:n,subContext:o,scenarioEventData:l,timeoutMs:c}=e;let d=r.getAuthTelemetry(n.id);return d?(d.addEventData([`fn:${o}`]),i.k.log(`Scenario [${(0,a.u4)(n)}] continue in sub context ${o}`)):(d=new s(this._scenarioProvider,n,o,t,c),r.setAuthTelemetry(n.id,d)),l&&d.appendScenarioEventData(l),r.setCorrelation(n),d}}create(e){return this._createScenario(e,!0)}createNew(e){const t=new s(this._scenarioProvider,e.correlation,e.subContext,!0,e.timeoutMs);return e.scenarioEventData&&t.appendScenarioEventData(e.scenarioEventData),t}createWithoutScenario(e){return this._createScenario(e,!1)}}let c;const d=e=>{c||(c=new l(e),i.k.log("authTelemetryProvider initialized"))}},238091:(e,t,n)=>{"use strict";n.d(t,{B$:()=>g,Ig:()=>h,Xx:()=>f,qv:()=>y,nW:()=>S,FG:()=>k,fM:()=>b,MY:()=>_,jV:()=>C,PU:()=>w,dW:()=>T,CK:()=>E,S1:()=>I});var i,a=n(892891),o=n(926353),r=n(920909),s=n(705186),l=n(132887),c=n(684703),d=n(547514),u=n(975883),m=n(277373),p=n(603250);!function(e){e.Otp="mail",e.GFed="google.com"}(i||(i={}));const g=(e,t,n,i)=>{var a;const r=(null==t?void 0:t.profile.tid)||n||e.tenantId;if(r&&(t||i||e.isAnonEligible&&e.isAnonRestrictionSatisfied))return s.k.info("Anon flow - anonymous user created"),{isAuthenticated:!0,userName:(null==t?void 0:t.userName)||"anonymous",profile:{oid:y(r),tid:r,upn:(null===(a=null==t?void 0:t.profile)||void 0===a?void 0:a.upn)||"",puid:""},role:o.w.Anonymous,type:o.C.Anonymous}},h=(e,t,n,c)=>{var d,u,m,p,h,f;if(!t||(0,a.isEmpty)(t.profile)||t.role===o.w.Anonymous||t.userRole===l.uI.TWO||!t.isAuthenticated&&e.isAnonEligible||!t.isAuthenticated&&c)return s.k.info("checking anon flow"),g(e,t,n,c);t.role=1===(null===(d=t.profile)||void 0===d?void 0:d.acct)?o.w.Guest:o.w.Member;let y=0===(null===(m=null===(u=t.profile)||void 0===u?void 0:u.altsecid)||void 0===m?void 0:m.indexOf("1:"))?o.C.Msa:o.C.Aad;return(null===(p=t.profile)||void 0===p?void 0:p.idp)&&(null===(h=t.profile)||void 0===h?void 0:h.iss)!==t.profile.idp?(y=t.profile.idp===i.Otp?o.C.Otp:y,y=t.profile.idp===i.GFed?o.C.GFed:y):(null===(f=t.profile)||void 0===f?void 0:f.tid)===r.e0&&(y=o.C.MsaLife),v(t,y)},v=(e,t)=>(e.type=t,e.profile.oid=e.profile.oid||y(e.profile.tid),!e.profile.hasOwnProperty("upn")&&e.hasOwnProperty("userName")&&(e.profile.upn=e.userName||""),s.k.info(`User role = [${e.role}], type = [${t}]`),e),f=e=>{if(!e)throw new Error("getUserIdentifier: User cannot be null");return{tenantId:e.profile.tid,oid:e.profile.oid,accountType:e.type,userName:e.userName}},y=e=>`8:defaultOid:${e}`,S=e=>{const t=[];for(const n in e)Object.hasOwnProperty.call(e,n)&&t.push({name:n,key:n,value:e[n]});return t},k=(e,t)=>!!e&&!!t&&e.tenantId===t.tenantId&&e.oid===t.oid&&e.userName===t.userName,b=(e,t,n)=>{var i;const a=new CustomEvent(t,{detail:n});null===(i=null==e?void 0:e.dispatchEvent)||void 0===i||i.call(e,a)},_=(e,t)=>{var n;if(void 0!==(null===(n=e.document)||void 0===n?void 0:n.cookie))try{const n=new Date,i=n.setMonth(n.getMonth()+l.uI.FIVE);e.document.cookie=`ringFinder=${encodeURIComponent(JSON.stringify(t))};expires=${new Date(i).toUTCString()};path=/;secure;samesite=none;`}catch(e){s.k.error("_setAuthCookie",e)}},C=(e,t,n,i,a)=>{const o=h(e,t,i,a);return o&&(s.k.info(`[auth-helper][getMappedUserAndSetItToCache][${n}] put user in cache.`),c.J.put((0,m.VF)(f(o)).user,o)),o},w=(e,t,n,i)=>{if(l.s9(e))throw i.addEventData(["scope_invalid:1"]),s.k.warning(`[core-auth-base][acquireToken][${n.source}][${n.id}] invalid scope. resource: [${e}]`),(0,d.Tr)({context:"core-auth-base",subContext:"acquireToken",message:`request with [${null==t?void 0:t.tenantId}-${null==t?void 0:t.oid}] sent from invalid resource: ${e}`,errorCode:l.SM.InvalidScopeResource,isExpected:!0,correlationId:n.id})},T=(e,t,n,i,a)=>(i.push("user_missing"),(0,d.Tr)({context:"core-auth-base",subContext:e,errorCode:l.SM.UserNotFoundError,isExpected:n,message:`request sent with [${t}] failed as user not found`,innerError:new Error("User Null or empty"),correlationId:a}));const E=(e,t,n,i,a)=>{const o=e instanceof p.l?null==e?void 0:e.code:null==e?void 0:e.errorCode;i.push(`errorCode:${o||"undefined"},errorMessage:${(null==e?void 0:e.message)||"undefined"}`),(null==i?void 0:i.length)>0&&i.push("$");const r={errorCode:o,message:null==e?void 0:e.message,reason:null==i?void 0:i.join(";"),correlationId:n},l=e instanceof p.l||(null==e?void 0:e.isExpected),c=`Login unsuccessful. Expected: ${!!l}. Message: ${null==e?void 0:e.message}. eventData: ${r.reason}`;l?(a?null==t||t.mark(a,r,"incomplete"):null==t||t.incomplete(r),s.k.warn(c)):(a?null==t||t.mark(a,r,"failure"):null==t||t.fail(r),s.k.error(c))},I=(e,t,n,i,a,o)=>{var r,c;null==i||i.push(`errorCode:${(null==t?void 0:t.errorCode)||"undefined"},errorMessage:${(null==t?void 0:t.message)||"undefined"}`),i&&i.length>0&&i.push("$");const d=function(e,t,n="",i,a){return{contentType:n,context:"core-auth-base",correlationId:null==t?void 0:t.correlationId,endpointUrl:a||"unset",errorCode:(null==t?void 0:t.errorCode)||"AcquireToken Error",innerError:t,isExpected:null==t?void 0:t.isExpected,message:(0,u.VK)(t),reason:(null==i?void 0:i.join(";"))||"",subContext:e}}(e,t,a,i,o),m=d.errorCode.includes(l.SM.InvalidScopeResource)||(null===(r=d.message)||void 0===r?void 0:r.includes(l.SM.InvalidScopeResource))||d.isExpected||(null===(c=d.innerError)||void 0===c?void 0:c.isExpected);return m?s.k.warning(`Error found ${(0,u.VK)(t)}`):s.k.error(`Error found ${(0,u.VK)(t)}`),m?null==n||n.incomplete(d):null==n||n.fail(d),d}},738051:(e,t,n)=>{"use strict";function i(e){const t={};return(n,...i)=>{try{let a=t[n];return a||(a=t[n]=e(...i).then((e=>(delete t[n],e))).catch((e=>{throw delete t[n],e}))),a}catch(e){throw e}}}n.d(t,{k:()=>i})},547514:(e,t,n)=>{"use strict";n.d(t,{Tr:()=>a,Yf:()=>o,ZG:()=>r});var i=n(132887);function a(e){const t=new Error(e.message);return Object.assign(t,{context:e.context,subContext:e.subContext,reason:e.reason,errorCode:e.errorCode,serverResponse:e.serverResponse,correlationId:e.correlationId,isExpected:e.isExpected,innerError:e.innerError})}function o(e){return(0,i.gX)().indexOf(e)>=0}function r(e){return e&&(e.isExpected||o(e.errorCode)||!!(t=e.message)&&(0,i.gX)().map((e=>t.indexOf(e)>=0)).filter(Boolean).length>0);var t}},149073:(e,t,n)=>{"use strict";n.d(t,{g:()=>m});var i=n(926353),a=n(975883),o=n(238091),r=n(132887),s=n(705186),l=n(381500);let c,d,u;function m(e,t,n,i){if(Object.getOwnPropertyDescriptor(Window,"mockApi")||Object.defineProperty(Window,"mockApi",{value:{enable:()=>{u=!0},disable:()=>{u=!1},setConfig:p}}),function(e,t){c||(c={});c[t]=e}(e,t),u=i,u){try{d="string"==typeof n?Object.assign(Object.assign({},d),JSON.parse(decodeURIComponent(n))):Object.assign(Object.assign({},d),n)}catch(e){s.k.warning(`[MOCK-API] cannot parse config: ${n}`)}g(e,t)}else d={}}function p(e,t={}){d||(d={}),d[e]=t;const n=e.split(".")[0];g(null==c?void 0:c[n],n)}function g(e,t){Object.getOwnPropertyNames(d).filter((e=>e.startsWith(`${t}.`))).map((e=>e.replace(`${t}.`,""))).forEach((n=>{var i,o;const r=(null===(i=Object.getOwnPropertyDescriptor(e,n))||void 0===i?void 0:i.value)||(null===(o=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(e),n))||void 0===o?void 0:o.value);Object.defineProperty(e,n,{configurable:!0,value:(...i)=>u?(s.k.warning(`[MOCK-API] returning mocked responce for ${t}.${n}`),function(e,t){var n;const i=null==d?void 0:d[`${e}.${t}`];if(i&&i.error)throw function(e,t,n){return{context:(null==e?void 0:e.context)||t,subContext:(null==e?void 0:e.subContext)||n,reason:null==e?void 0:e.reason,errorCode:(null==e?void 0:e.errorCode)||"ErrorCodeNotFound",correlationId:(null==e?void 0:e.correlationId)||(0,a.pW)(),isExpected:(null==e?void 0:e.isExpected)||!1,message:(null==e?void 0:e.message)||`[FailApi][${t}][${n}]`}}(i.error,e,t);if(i&&i.success){const e=function(e){switch(e){case"aquireToken":return v;case"user":return h();case"hostMachineUsers":return[f];case"users":return[h()];case"emptyList":return[]}return{}}(i.success.defaultValue);return Array.isArray(e)?i.success.returnValue?[...e,i.success.returnValue]:e:Object.assign(Object.assign({},e),null===(n=i.success)||void 0===n?void 0:n.returnValue)}return}(t,n)||r.apply(e,i)):r.apply(e,i)})}))}const h=()=>(0,o.Ig)(new l.N("https://test.msft.com"),{userName:"TestUserName@email.com",role:i.w.Member,profile:{name:"Test",oid:(0,o.qv)("123456789"),tid:"123456789"}}),v={token:"TestToken",expires:Date.now()+r.rF.SECONDS_FIVE_MINUTES,fromCache:!1},f={accountType:"Aad",id:"TestHostMachineUserId",displayName:"Test User",emailPhone:"test@email.com",picture:""}},975883:(e,t,n)=>{"use strict";n.d(t,{u4:()=>a,VK:()=>o,pW:()=>l});const i=globalThis;function a(e,t){const n=new WeakSet;return JSON.stringify(e,((e,t)=>{if(!n.has(t)){if(t&&"object"==typeof t){if(n.add(t),t instanceof Map||t instanceof Set)return Array.from(t);if(null==t?void 0:t.errorCode)return t;if(t instanceof Error)return`${t.name}: ${t.message}`;if(t.constructor&&t.constructor!==Object&&t.constructor!==Array||t.prototype)return}return t}}),t)}function o(e,t=!0){if(null==e)return"";if("string"==typeof e)return e;try{return JSON.stringify(e,s(r(t)))}catch(e){return"Stringifying error failed"}}const r=(e=!0)=>(t,n)=>{if(n instanceof Error){const t={};return Object.getOwnPropertyNames(n).forEach((i=>{"stack"===i?e||(t[i]=("string"==typeof n.stack?n.stack:"").split("\n").map((e=>e.trim())).filter((e=>!!e))):t[i]=n[i]})),t}return n},s=e=>{const t=new WeakSet;return(n,i)=>{if("object"==typeof i&&null!==i){if(t.has(i))return;t.add(i)}return e(n,i)}},l=()=>{try{const e=i.msCrypto||i.crypto;return`${[1e7]}-1000-4000-8000-100000000000`.replace(/[018]/g,(t=>(t^e.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)))}catch(e){const t="xxxxxxxx-xxxx-8xxx-yxxx-xxxxxxxxxxxx",n="0123456789abcdef";let i=0,a="";for(let e=0;e<36;e++)"-"!==t[e]&&"4"!==t[e]&&(i=16*Math.random()|0),"x"===t[e]?a+=n[i]:"y"===t[e]?(i&=3,i|=8,a+=n[i]):a+=t[e];return a}}},381500:(e,t,n)=>{"use strict";n.d(t,{N:()=>o,j:()=>c});var i=n(132887),a=n(705186);class o{constructor(e){this._hash="",this._search="",this._pathname="",this._isAnonEligible=!1,this._isAnonRestrictionSatisfied=!1,this._tid=void 0,this._queryStrings={},this._parse=e=>{let t=Object.create(null);return"string"!=typeof e?t:(e=e.trim().replace(/^[?#&]/,""))?(e.split("&").forEach((e=>{const n=e.replace(/\+/g," ").split("=");let i=n.shift();const o=n.length>0?decodeURIComponent(n.join("=")):null;if(i){if(i=decodeURIComponent(i),"context"===i&&0===(null==o?void 0:o.indexOf("{")))try{const e=JSON.parse(o);for(const t in e)!e.hasOwnProperty(t)||"tid"!==t.toLowerCase()&&"tenantid"!==t.toLowerCase()||(this._tid=e[t]);t=Object.assign(Object.assign({},t),e)}catch(e){a.k.error(e)}if(Object.prototype.hasOwnProperty.call(t,i))Array.isArray(t[i])?t[i].push(o):t[i]=[t[i],o];else{t[i]=o;const e=i.toLowerCase();!o||"tid"!==e&&"tenantid"!==e||(this._tid=o)}}})),t):t};try{this._currenttUrl=Object.freeze(new URL(e))}catch(t){throw new Error(`[TeamsUrl::ctor] - error - ${t} url ${e}`)}if(this._currenttUrl.hash&&-1!==this._currenttUrl.hash.indexOf("#/")){const e=this._currenttUrl.href.substring(this._currenttUrl.origin.length),t=e.indexOf("#");t>=0&&(this._hash=e.substr(t),this._pathname=e.substr(0,t));const n=this._hash.indexOf("?");n>=0&&(this._search=this._hash.substr(n))}this._queryStrings=this._parse(this._search||this._currenttUrl.search);const t=r(this._currenttUrl);this._isAnonEligible=t[0],this._isAnonRestrictionSatisfied=t[1]}get href(){return this._currenttUrl.href}get isLocal(){return 0===this._currenttUrl.host.indexOf("local.teams.office.com")}get hash(){return this._hash||this._currenttUrl.hash}get pathname(){return this._pathname||this._currenttUrl.pathname}get search(){return this._search||this._currenttUrl.search}get origin(){return this._currenttUrl.origin}get searchParams(){return{get:e=>this._queryStrings[e]}}get queryStrings(){return this._queryStrings}get tenantId(){return 0===this._currenttUrl.host.indexOf("teams.live.")?i.zP:this._tid}get isAnonEligible(){return this._isAnonEligible}get isAnonRestrictionSatisfied(){return this._isAnonRestrictionSatisfied}get alternateUrl(){const e=new URL(this._currenttUrl.href);return this.isLocal?(e.port?e.port="":e.port="8080",e.href):(0===e.host.indexOf("teams.live.")?e.host="teams.microsoft.com":e.host="teams.live.com",e.href)}}const r=e=>{if(!l)return[!1,!1];for(const t of l)if(t.anonUrlMatch&&e.href.indexOf(t.anonUrlMatch)>-1)return[!0,s(t,e.href)];return[!1,!1]},s=(e,t)=>{if(!e.restrictions||0===e.restrictions.length)return!0;for(const n of e.restrictions)if(t.indexOf(n)>-1)return!0;return!1};let l=[];const c=e=>{e&&(l=e)}},926353:(e,t,n)=>{"use strict";var i,a;n.d(t,{C:()=>i,w:()=>a}),function(e){e.Anonymous="Anonymous",e.Aad="Aad",e.Msa="Msa",e.MsaLife="MsaLife",e.GFed="GFed",e.Otp="Otp"}(i||(i={})),function(e){e.Member="Member",e.Anonymous="Anonymous",e.Guest="Guest"}(a||(a={}))},920909:(e,t,n)=>{"use strict";var i,a,o,r;n.d(t,{in:()=>a,s_:()=>o,O_:()=>r,e0:()=>s}),function(e){e.POP="pop",e.BEARER="Bearer"}(i||(i={})),function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(a||(a={})),function(e){e.prod="prod",e.life="life"}(o||(o={})),function(e){e.LOKI_TFL_AUTH_TOKEN_AUDIENCE="liveprofilecard.access",e.MT="https://api.spaces.skype.com"}(r||(r={}));const s="9188040d-6c67-4c5b-b112-36a304b66dad"},351626:(e,t,n)=>{"use strict";n.d(t,{Y:()=>a});let i=[];function a(e){i.push(e)}},892753:(e,t,n)=>{"use strict";n.d(t,{TL:()=>r});var i=n(231191);const a=Symbol("ForEachAsyncIteratorContinue"),o=Symbol("ForEachAsyncIteratorBreak");function r(e,t){let n,r=!1,l=e=>Promise.reject(e);"function"==typeof e.return&&(n=e.return,l=t=>{const i=()=>Promise.reject(t);return n.call(e).then(i,i)});const c=function(e,t){return function(n){return n.done?Promise.resolve(n):function(e,t){return new Promise((n=>n(t(e))))}(n.value,e).then(s,t)}}(t,l);return{next(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(r)return this.return();{let t=yield e.next(),n=yield c(t);for(;!n.done&&n.value===a;)t=yield e.next(),n=yield c(t);return n.value===o||n.value===a?this.return():n}}))},return:()=>(r=!0,n?n.call(e).then(c):Promise.resolve({value:void 0,done:!0})),throw:t=>(r=!0,"function"==typeof e.throw?e.throw(t).then(c):Promise.reject(t).catch(l)),[Symbol.asyncIterator](){return this}}}function s(e){return{value:e,done:!1}}},497999:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i,a=n(231191);!function(e){e[e.Value=0]="Value",e[e.Error=1]="Error"}(i||(i={}));var o=n(980633),r=n(892891);class s{constructor(e=100,t,n,i,a){if(this.newScenario=t,this.logger=i,this.getDroppedEventMetadataFn=a,e<0)throw new TypeError("BufferLimit has to be > 0");this._isComplete=!1,this._values=[],this._promiseResolutionFunctions=[],this._bufferLimit=e,this._overflowScenario=null,this._droppedEvents=0,this._operationName=n,this._droppedEventMetadataToCount=new Map}next(e){this._push({type:i.Value,value:e})}error(e){this._push({type:i.Error,error:e})}complete(){for(this._isComplete=!0;this._promiseResolutionFunctions.length>0;)this._promiseResolutionFunctions.shift().resolve({done:!0})}nextPromise(){if(this._overflowScenario&&this._values.length<this._bufferLimit){let e=`AsyncIterableObserver buffer is no longer full for operation ${this._operationName}. Dropped ${this._droppedEvents} events.`;if(this.getDroppedEventMetadataFn){const t=(0,r.maxBy)(Array.from(this._droppedEventMetadataToCount.keys()),(e=>this._droppedEventMetadataToCount.get(e)));e=`${e} Max dropped event metadata: ${t}.`,this._overflowScenario.appendEventData({context:JSON.stringify(Array.from(this._droppedEventMetadataToCount.entries())),reason:t})}this.logger&&this.logger.warn(e),this._overflowScenario.stop({size:this._droppedEvents}),this._overflowScenario=null,this._droppedEvents=0,this._droppedEventMetadataToCount=new Map}if(this._values.length>0){const{type:e,value:t,error:n}=this._values.shift();return e===i.Error?Promise.reject(n):Promise.resolve({done:!1,value:t})}return this._isComplete?Promise.resolve({done:!0}):new Promise(((e,t)=>{this._promiseResolutionFunctions.push({resolve:e,reject:t})}))}_push(e){if(this._promiseResolutionFunctions.length>0){const{resolve:t,reject:n}=this._promiseResolutionFunctions.shift();e.type===i.Error?n(e.error):t({done:!1,value:e.value})}else{if(this._values.length>this._bufferLimit-1){if(this._droppedEvents+=1,this.getDroppedEventMetadataFn&&e.value){const t=this.getDroppedEventMetadataFn(e.value),n=this._droppedEventMetadataToCount.get(t);this._droppedEventMetadataToCount.set(t,n?n+1:1)}throw!this._overflowScenario&&this.newScenario&&(this._overflowScenario=this.newScenario(o.RG.OnAsyncIterableObserverOverflow),this._overflowScenario.appendEventData({operationName:this._operationName})),new Error("AsyncIterableObserver buffer is full, all future events will be dropped")}this._values.push(e)}}}function l(e,t,n,i,a,o){return new c(e,t,n,i,a,o)}class c{constructor(e,t,n,i,a,o){this.error=null;try{this.observer=new s(t,n,i,a,o),this.subscription=e.subscribe(this.observer),this.running=!0}catch(e){this.running=!1,this.error=e}}[Symbol.asyncIterator](){return this}next(){return(0,a.__awaiter)(this,void 0,void 0,(function*(){if(this.running&&this.observer)try{const e=yield this.observer.nextPromise();if(this.running&&!e.done)return e}catch(e){return this.throw(e)}return this.error?this.throw(this.error):this.return()}))}return(e){var t;return this.running=!1,null===(t=this.subscription)||void 0===t||t.unsubscribe(),Promise.resolve({done:!0,value:void 0})}throw(e){var t;return this.running=!1,null===(t=this.subscription)||void 0===t||t.unsubscribe(),Promise.reject(e)}}},377692:(e,t,n)=>{"use strict";n.d(t,{q:()=>c});var i,a=n(231191),o=n(356452),r=n(352367),s=n(775214),l=n(892891);!function(e){e[e.clean=0]="clean",e[e.registrationToken=1]="registrationToken",e[e.skypeToken=2]="skypeToken"}(i||(i={}));class c{constructor(e){this.discover=e}authorizeRequest(e,t="Authentication"){return(0,a.__awaiter)(this,void 0,void 0,(function*(){let n,i;const r=(e,o)=>(0,a.__awaiter)(this,void 0,void 0,(function*(){const a=Object.assign({},e.headers);if(this.registrationToken)a.RegistrationToken=this.registrationToken;else{n=i;const r=performance.now(),s=yield this._validateSkypeToken({invalidSkypeToken:i,forceRenew:o});e.authPerformanceLogs=Object.assign(Object.assign({},e.authPerformanceLogs),{skypeTokenDelta:performance.now()-r,skypeTokenFromCache:s.fromCache}),i=s.skypeToken,a[t]=this.formatAuthHeader(t,i)}return e.headers=a,e}));return{request:yield r(e),resolver:(e,t)=>(0,a.__awaiter)(this,void 0,void 0,(function*(){const{status:i,headers:{"set-registrationtoken":a}}=e;if(i===o.qb.NOT_AUTHORIZED){if(this.registrationToken&&delete this.registrationToken,!n)return r(t,!0)}else a&&i!==o.qb.NOT_FOUND&&this.parseToken(a)}))}}))}authorize(e,t="Authentication"){return n=>(0,a.__awaiter)(this,void 0,void 0,(function*(){let a,r,s=!1,l=i.clean;for(let c=0;c<=2;++c){const c=Object.assign({},n.headers),d=this.registrationToken;if(d)c.RegistrationToken=d;else{const e=performance.now(),i=yield this._validateSkypeToken({invalidSkypeToken:a,forceRenew:s});n.authPerformanceLogs=Object.assign(Object.assign({},n.authPerformanceLogs),{skypeTokenDelta:performance.now()-e,skypeTokenFromCache:i.fromCache}),a=i.skypeToken,c[t]=this.formatAuthHeader(t,a)}n.headers=c,r=yield e(n);const{status:u,headers:{"set-registrationtoken":m}}=r;if(u===o.qb.NOT_AUTHORIZED)if(d){if(d===this.registrationToken&&delete this.registrationToken,l===i.clean){a=void 0,l=i.registrationToken;continue}}else if(!s&&l!==i.skypeToken){s=!0,l=i.skypeToken;continue}return m&&u!==o.qb.NOT_FOUND&&this.parseToken(m),r}return this.validateResponse(r)}))}_validateSkypeToken(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){return this.discover.validateSkypeTokenV2?this.discover.validateSkypeTokenV2(e):{skypeToken:yield this.discover.validateSkypeToken(e)}}))}validateResponse(e){if(!e)throw(0,s.Tr)(r.w5.Authentication,r.jK.UndefinedGlobalError,"",void 0,"Failed to authenticate response");return e}formatAuthHeader(e,t){return"Authentication"===e?`skypetoken=${t}`:"x-skypetoken"===e?t:`skype_token ${t}`}parseToken(e){const t=(0,l.fromPairs)(e.split(";").map((e=>e.split("=",2).map((e=>e.trim()))))),{expires:n}=t,i=(0,a.__rest)(t,["expires"]);i.endpointId&&(this.registrationToken=(0,l.toPairs)(i).map((e=>e.join("="))).join("; "))}}},946101:(e,t,n)=>{"use strict";var i,a,o,r,s,l,c,d,u,m,p,g,h,v,f,y,S,k,b,_,C,w,T,E,I,N,A,M,F,R,P,D,j,x,O,L,U,B,W,H,$,V,z,G,q,J;n.d(t,{zH:()=>i,jE:()=>o,Yl:()=>r,m6:()=>s,yX:()=>m,Kk:()=>g,Io:()=>v,Ry:()=>f,IC:()=>y,Z8:()=>S,EM:()=>_,Pn:()=>C,C5:()=>w,LQ:()=>T,uN:()=>E,Qb:()=>I,f4:()=>N,C7:()=>A,in:()=>F,B6:()=>R,m1:()=>P,vG:()=>D,zO:()=>j,$w:()=>z,PG:()=>G,oj:()=>q}),function(e){e.Adult="Adult",e.MinorNoParentalConsentRequired="MinorNoParentalConsentRequired",e.MinorWithMsaParentalConsent="MinorWithMsaParentalConsent",e.MinorWithoutMsaParentalConsent="MinorWithoutMsaParentalConsent",e.NotAdult="NotAdult"}(i||(i={})),function(e){e.Msa="Msa",e.Aad="Aad"}(a||(a={})),function(e){e.Discoverable="Discoverable",e.Undiscoverable="Undiscoverable",e.Unknown="Unknown"}(o||(o={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled"}(r||(r={})),function(e){e.EveryoneInCompany="EveryoneInCompany",e.Everyone="Everyone"}(s||(s={})),function(e){e.cancel="cancel",e.fail="fail",e.incomplete="incomplete",e.success="success"}(l||(l={})),function(e){e.AlwaysEnabled="AlwaysEnabled",e.AlwaysDisabled="AlwaysDisabled",e.UserOverride="UserOverride"}(c||(c={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled",e.UserOverride="UserOverride"}(d||(d={})),function(e){e.Disabled="Disabled",e.Enabled="Enabled"}(u||(u={})),function(e){e.v0="v0",e.v1="v1",e.international="international"}(m||(m={})),function(e){e.Disabled="Disabled",e.SingleApplication="SingleApplication",e.EntireScreen="EntireScreen"}(p||(p={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled"}(g||(g={})),function(e){e.Unknown="Unknown",e.Online="Online",e.OnPrem="OnPrem"}(h||(h={})),function(e){e.Immediate="Immediate",e.Simultaneous="Simultaneous",e.Unanswered="Unanswered"}(v||(v={})),function(e){e.Voicemail="Voicemail",e.SingleTarget="SingleTarget",e.MyDelegates="MyDelegates",e.DoNothing="DoNothing",e.Group="Group"}(f||(f={})),function(e){e.Ring="Ring",e.Mute="Mute"}(y||(y={})),function(e){e.BackgroundEffect="BackgroundEffect",e.BackgroundAPL="BackgroundAPL"}(S||(S={})),function(e){e.Cameo="Cameo",e.ContentOnly="ContentOnly",e.Weatherperson="Weatherperson",e.SideBySide="SideBySide",e.NewsAnchor="NewsAnchor"}(k||(k={})),function(e){e.Disabled="Disabled",e.ReceiveOnly="ReceiveOnly",e.SendOnly="SendOnly",e.Inactive="Inactive",e.Bidirectional="Bidirectional"}(b||(b={})),function(e){e.Mac="Mac",e.Windows="Windows"}(_||(_={})),function(e){e.ams="ams",e.amsV2="amsV2",e.calling_registrarUrl="calling_registrarUrl",e.calling_trouterUrl="calling_trouterUrl",e.chatService="chatService",e.chatServiceAfd="chatServiceAfd",e.cmdArtifactsService="cmdArtifactsService",e.middleTier="middleTier",e.mtImageService="mtImageService",e.powerPointStateService="powerPointStateService",e.search="search",e.teamsAndChannelsProvisioningService="teamsAndChannelsProvisioningService",e.unifiedPresence="unifiedPresence",e.urlp="urlp",e.urlpV2="urlpV2",e.userEntitlementService="userEntitlementService",e.userProfileService="userProfileService",e.consumerLicenses="consumerLicenses"}(C||(C={})),function(e){e.Coachmark="Coachmark",e.Modal="Modal"}(w||(w={})),function(e){e.AppReady="AppReady",e.Manual="Manual"}(T||(T={})),function(e){e.above="above",e.below="below",e.before="before",e.after="after"}(E||(E={})),function(e){e.bottom="bottom",e.top="top",e.start="start",e.end="end",e.center="center"}(I||(I={})),function(e){e.close="close",e.navigateToUrl="navigateToUrl",e.navigateWithEntityCommand="navigateWithEntityCommand"}(N||(N={})),function(e){e.Legacy="Legacy",e.Graph="Graph",e.Vroom="Vroom"}(A||(A={})),function(e){e.Osearch="Osearch",e.AllFiles="AllFiles"}(M||(M={})),function(e){e.Full="Full",e.Limited="Limited",e.Restricted="Restricted"}(F||(F={})),function(e){e.Everyone="Everyone",e.None="None",e.UserPreference="UserPreference"}(R||(R={})),function(e){e.Strict="Strict",e.Moderate="Moderate",e.NoRestriction="NoRestriction"}(P||(P={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled"}(D||(D={})),function(e){e.Chat="Chat",e.ChannelPost="ChannelPost",e.ChannelReply="ChannelReply"}(j||(j={})),function(e){e.Automation="Automation",e.SyntheticTraffic="SyntheticTraffic",e.Local="Local",e.Staging="Staging",e.Dogfood="Dogfood",e.Preview="Preview",e.Microsoft="Microsoft",e.Production="Production"}(x||(x={})),function(e){e.Staging="Staging",e.Dogfood="Dogfood",e.Prod="Prod"}(O||(O={})),function(e){e.Small="Small",e.Medium="Medium",e.Large="Large"}(L||(L={})),function(e){e.small="small",e.medium="medium",e.large="large"}(U||(U={})),function(e){e.Discoverable="Discoverable",e.Undiscoverable="Undiscoverable",e.Unknown="Unknown"}(B||(B={})),function(e){e.df="df",e.msit="msit"}(W||(W={})),function(e){e.Disabled="Disabled",e.EnabledTeamOwner="EnabledTeamOwner",e.EnabledTeamOwnerMember="EnabledTeamOwnerMember"}(H||(H={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled"}($||($={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled"}(V||(V={})),function(e){e.None="None",e.CitrixXenDesktop="CitrixXenDesktop",e.CitrixXenApp="CitrixXenApp",e.VMWare="VMWare",e.WVD="WVD"}(z||(z={})),function(e){e.Web="Web",e.Desktop="Desktop",e.Rigel="Rigel",e.SurfaceHub="SurfaceHub"}(G||(G={})),function(e){e.Unknown="Unknown",e.Teacher="Teacher",e.Student="Student"}(q||(q={})),function(e){e.SingleChoice="SingleChoice",e.MultiChoice="MultiChoice",e.SingleLineText="SingleLineText",e.MultiLineText="MultiLineText"}(J||(J={}))},720782:(e,t,n)=>{"use strict";var i,a;n.d(t,{t:()=>i,D:()=>a}),function(e){e.Compose="Compose",e.MessagePane="MessagePane",e.DeeplinkedMessage="DeeplinkedMessage",e.DoNotMove="DoNotMove"}(i||(i={})),function(e){e.LeftRailSelectedItem="LeftRailSelectedItem"}(a||(a={}))},110391:(e,t,n)=>{"use strict";var i;n.d(t,{S:()=>i}),function(e){e.HorizontalBar="HorizontalBar",e.Main="Main",e.Modal="Modal",e.Rail="Rail",e.ThinHorizontalBar="ThinHorizontalBar",e.Thumbnail="Thumbnail",e.TitleBar="TitleBar",e.VerticalBar="VerticalBar"}(i||(i={}))},143076:(e,t,n)=>{"use strict";var i;n.d(t,{hO:()=>i,K$:()=>a,v4:()=>o,F_:()=>r,jq:()=>s,QI:()=>l}),function(e){e.POP="pop",e.BEARER="Bearer"}(i||(i={}));const a="https://api.spaces.skype.com",o="ForceFallbackToWebAuth",r="ForceReloadIfSkypeAuthFail";var s,l;!function(e){e.Up="Up",e.InteractionRequired="InteractionRequired",e.AADReconnecting="AADReconnecting",e.SkypeReconnecting="SkypeReconnecting"}(s||(s={})),function(e){e.Success="Success",e.Failure="Failure",e.InteractionRequired="InteractionRequired"}(l||(l={}))},638739:(e,t,n)=>{"use strict";var i,a,o;n.d(t,{yU:()=>i,FV:()=>a,c4:()=>o}),function(e){e.ActiveEntitiesResolved="active_entities_resolved",e.ActiveEntitiesDestroyed="active_entities_destroyed",e.CoreDeepLinkResolved="core_deep_link_resolved",e.UserAuthenticated="user_authenticated",e.UserConsentedToConsumeResources="user_consented_to_consume_resources"}(i||(i={})),function(e){e.LayoutRenderComplete="layout_render_complete",e.WindowStateChange="window_state_change"}(a||(a={})),function(e){e.Started="app_started",e.Initialized="app_initialized",e.Warm="app_warm"}(o||(o={}))},906386:(e,t,n)=>{"use strict";var i,a,o;n.d(t,{pk:()=>i,kZ:()=>a,UV:()=>o}),function(e){e.Initializing="Initializing",e.Unrecoverable="Unrecoverable",e.LongInactive="LongInactive",e.Inactive="Inactive",e.Active="Active",e.VeryActive="VeryActive"}(i||(i={})),function(e){e.Minimized="Minimized",e.Background="Background",e.InFocus="InFocus"}(a||(a={})),function(e){e.Locked="Locked",e.Active="Active"}(o||(o={}))},937791:(e,t,n)=>{"use strict";var i;n.d(t,{R:()=>i}),function(e){e[e.Legacy=1]="Legacy",e[e.Store=2]="Store",e[e.InContextGalleryDialogFromChannel=3]="InContextGalleryDialogFromChannel",e[e.InContextGalleryDialogFromGroupChat=4]="InContextGalleryDialogFromGroupChat",e[e.InContextGalleryDialogMoreAppsFromChannel=5]="InContextGalleryDialogMoreAppsFromChannel",e[e.InContextGalleryDialogMoreAppsFromGroupChat=6]="InContextGalleryDialogMoreAppsFromGroupChat",e[e.Flyout=7]="Flyout",e[e.AppsManagementTabView=8]="AppsManagementTabView",e[e.GroupChatAppsManagementView=9]="GroupChatAppsManagementView",e[e.MoreAppFromSameDeveloper=10]="MoreAppFromSameDeveloper",e[e.MessagingExtensionFlyoutFromChannel=11]="MessagingExtensionFlyoutFromChannel",e[e.MessagingExtensionFlyoutFromChat=12]="MessagingExtensionFlyoutFromChat",e[e.StoreSideload=13]="StoreSideload",e[e.DeepLink=14]="DeepLink",e[e.ConnectorManagementDialog=15]="ConnectorManagementDialog",e[e.AppsManagementTabUpgrade=16]="AppsManagementTabUpgrade",e[e.GroupChatAppsManagementUpgrade=17]="GroupChatAppsManagementUpgrade",e[e.AppsList=18]="AppsList",e[e.TabSdkSideload=19]="TabSdkSideload",e[e.AppsManagementTabFromTeam=20]="AppsManagementTabFromTeam",e[e.AppsManagementTabFromGroupChat=21]="AppsManagementTabFromGroupChat",e[e.AppSuggestionInEmptyChannel=22]="AppSuggestionInEmptyChannel",e[e.MeetingFromGroupchat=23]="MeetingFromGroupchat",e[e.MeetingFromTeam=24]="MeetingFromTeam",e[e.MessagingExtensionFeaturedItem=25]="MessagingExtensionFeaturedItem",e[e.NewMessageUpgrade=26]="NewMessageUpgrade",e[e.AtMentionDirectInstallationFromTeam=27]="AtMentionDirectInstallationFromTeam",e[e.AtMentionDirectInstallationFromGroupChat=28]="AtMentionDirectInstallationFromGroupChat",e[e.PersonalAppBannerUpgrade=29]="PersonalAppBannerUpgrade",e[e.AppBarNew=30]="AppBarNew",e[e.AppsListNew=31]="AppsListNew",e[e.MessagingExtensionFlyoutV2=34]="MessagingExtensionFlyoutV2",e[e.AppsManagementTabFromTeamSideload=35]="AppsManagementTabFromTeamSideload",e[e.AppsManagementTabFromGroupChatSideload=36]="AppsManagementTabFromGroupChatSideload",e[e.FlyoutSuggestedApps=37]="FlyoutSuggestedApps",e[e.PersonalAppAbout=38]="PersonalAppAbout",e[e.PersonalFlyoutAppSuggestions=39]="PersonalFlyoutAppSuggestions",e[e.ChannelInfoPaneAppWidgetView=40]="ChannelInfoPaneAppWidgetView",e[e.ChannelInfoPaneAppWidgetUpgrade=41]="ChannelInfoPaneAppWidgetUpgrade",e[e.MoreAppsUsedTogether=42]="MoreAppsUsedTogether",e[e.PowerBar=43]="PowerBar",e[e.ManageAppsInstalledApp=45]="ManageAppsInstalledApp",e[e.ManageAppsInstalledAppUpgrade=46]="ManageAppsInstalledAppUpgrade",e[e.MessageExtensionFlyout=100]="MessageExtensionFlyout",e[e.Meeting=101]="Meeting",e[e.JITInstallCardAction=102]="JITInstallCardAction",e[e.CardHeaderInstallAction=103]="CardHeaderInstallAction",e[e.ScenePicker=104]="ScenePicker",e[e.MeetingFromChannel=105]="MeetingFromChannel",e[e.Url=106]="Url",e[e.LobNotifications=200]="LobNotifications"}(i||(i={}))},492661:(e,t,n)=>{"use strict";var i,a;n.d(t,{M:()=>i,y:()=>a}),function(e){e.Abandoned="Abandoned",e.ApplicationHookReceivedCommand="ApplicationHookReceivedCommand",e.ApplicationHookContinuedCommand="ApplicationHookContinuedCommand",e.Blanked="Blanked",e.ChunkLoadStarted="ChunkLoadStarted",e.ChunkLoadSucceeded="ChunkLoadSucceeded",e.Close="Close",e.CommandHandledPriorToResolution="CommandHandledPriorToResolution",e.CommandReceived="CommandReceived",e.CommandReportingTimedOut="CommandReportingTimedOut",e.DeeplinkReceived="DeeplinkReceived",e.DeeplinkParsed="DeeplinkParsed",e.IntentReceived="IntentReceived",e.IntentExecuted="IntentExecuted",e.Failure="Failure",e.Focus="Focus",e.Incomplete="Incomplete",e.LayoutRendered="LayoutRendered",e.LayoutRenderUpdated="LayoutRenderUpdated",e.NotHandled="NotHandled",e.Rendered="Rendered",e.RenderStarted="RenderStarted",e.SlotPhasedRenderingTimedOut="SlotPhasedRenderingTimedOut",e.UnmountStarted="UnmountStarted",e.WindowCreated="WindowCreated",e.WindowUpdated="WindowUpdated"}(i||(i={})),function(e){e.AlreadyRendered="AlreadyRendered",e.CallHistoryContainerError="CallHistoryContainerError",e.ChatErrorBoundaryError="ChatErrorBoundaryError",e.CreateWindowError="CreateWindowError",e.ErrorBoundaryError="ErrorBoundaryError",e.GuardiansError="GuardiansError",e.NetworkOffline="NetworkOffline",e.OnBeforeIntentAuthenticatedReturnedUndefined="OnBeforeIntentAuthenticatedReturnedUndefined",e.OnBeforeIntentAuthenticatedRejected="OnBeforeIntentAuthenticatedRejected",e.OnAfterIntentAuthenticatedReturnedUndefined="OnAfterIntentAuthenticatedReturnedUndefined",e.OnAfterIntentAuthenticatedRejected="OnAfterIntentAuthenticatedRejected",e.OnBeforeCommandHandledRejected="OnBeforeCommandHandledRejected",e.PlatformErrorBoundaryError="PlatformErrorBoundaryError",e.RenderingError="RenderingError",e.SlotPhasedRenderingTimedOut="SlotPhasedRenderingTimedOut",e.TimeoutRunningApp="TimeoutRunningApp",e.TimeoutRunningCore="TimeoutRunningCore",e.UnknownCommandError="UnknownCommandError",e.WindowCacheFailedToUpdate="WindowCacheFailedToUpdate",e.WindowCloseRunningApp="WindowCloseRunningApp",e.WindowCloseRunningCore="WindowCloseRunningCore"}(a||(a={}))},342790:(e,t,n)=>{"use strict";var i;n.d(t,{D:()=>i}),function(e){e.Authentication="Authentication",e.ActivityFeed="ActivityFeed",e.ActivityFeedBellClick="ActivityFeedBellClick",e.AltTextMenuItem="AltTextMenuItem",e.AppBar="AppBar",e.AppProfileCard="AppProfileCard",e.Avatar="Avatar",e.AuthApp="AuthApp",e.Autosuggest="Autosuggest",e.BrbForm="BrbForm",e.Breadcrumb="Breadcrumb",e.BreakoutRoomsCreateButton="BreakoutRoomsCreateButton",e.BreakoutRoomsPanel="BreakoutRoomsPanel",e.BreakoutRoomsRecreateButton="BreakoutRoomsRecreateButton",e.BreakoutRoomsSettingPresenter="BreakoutRoomsSettingPresenter",e.BroadcastQnaPanelButton="BroadcastQnaPanelButton",e.BroadcastQnaPanelWrapper="BroadcastQnaPanelWrapper",e.BroadcastInfoPanelButton="BroadcastInfoPanelButton",e.BroadcastInfoPanelContainer="BroadcastInfoPanelContainer",e.Calendar="Calendar",e.CalendarAnswer="CalendarAnswer",e.CalendarEventAction="CalendarEventAction",e.CalendarSettings="CalendarSettings",e.CallDebug="CallDebug",e.CallHealthButton="CallHealthButton",e.Calling="Calling",e.CallingAlert="CallingAlert",e.CallingAppEvent="CallingAppEvent",e.CallingBreakoutRoomsWrapper="CallingBreakoutRoomsWrapper",e.CallingCameraEffectsPanelWrapper="CallingCameraEffectsPanelWrapper",e.CallingCustomVideoBackgroundsPanelContainer="CallingCustomVideoBackgroundsPanelContainer",e.CallingCustomVideoBackgroundsPanelWrapper="CallingCustomVideoBackgroundsPanelWrapper",e.CallingDevicesPanelWrapper="CallingDevicesPanelWrapper",e.CallingEndScreen="CallingEndScreen",e.CallingOnBeforeDeeplinkParsed="CallingOnBeforeDeeplinkParsed",e.CallingPreJoinScreenCancelButton="CallingPreJoinScreenCancelButton",e.CallingPrejoinScreenHideAllPanels="CallingPrejoinScreenHideAllPanels",e.CallingPreJoinScreenVideoEffectsButton="CallingPreJoinScreenVideoEffectsButton",e.CallingRosterWrapper="CallingRosterWrapper",e.CallingScreen="CallingScreen",e.CallingScreenHideAllPanels="CallingScreenHideAllPanels",e.CallMonitor="CallMonitor",e.CallTransferButton="CallTransferButton",e.CameraEffectsButton="CameraEffectsButton",e.CameraEffectsPrejoinPanelButton="CameraEffectsPrejoinPanelButton",e.CameraEffectsVideoPreviewButton="CameraEffectsVideoPreviewButton",e.Card="Card",e.ChannelInfoPane="ChannelInfoPane",e.ChannelList="ChannelList",e.ChannelListItem="ChannelListItem",e.ChannelHeader="ChannelHeader",e.ChannelPostMessage="ChannelPostMessage",e.ChannelRepliesPane="ChannelRepliesPane",e.ChatAddMembers="ChatAddMembers",e.ChatBubbles="ChatBubbles",e.ChatButton="ChatButton",e.ChatCallButton="ChatCallButton",e.ChatClaimed="ChatClaimed",e.ChatClaimLink="ChatClaimLink",e.ChatDeprovisioned="ChatDeprovisioned",e.ChatDisabledComposeLink="ChatDisabledComposeLink",e.ChatDiscardConversation="ChatDiscardConversation",e.ChatEmbedSdk="ChatEmbedSdk",e.ChatError="ChatError",e.ChatInfoPane="ChatInfoPane",e.ChatEscalation="ChatEscalation",e.ChatHeader="ChatHeader",e.ChatInviteLink="ChatInviteLink",e.ChatJoinShareButton="ChatJoinShareButton",e.ChatListFilterItem="ChatListFilterItem",e.ChatListItem="ChatListItem",e.ChatListSuggestedContact="ChatListSuggestedContact",e.ChatListMeetingItem="ChatListMeetingItem",e.ChatListItemDeleteChatButton="ChatListItemDeleteChatButton",e.ChatListItemInviteLinkButton="ChatListItemInviteLinkButton",e.ChatListItemMenuLeaveButton="ChatListItemMenuLeaveButton",e.ChatListItemMenuPinButton="ChatListItemMenuPinButton",e.ChatMeetingChiclet="ChatMeetingChiclet",e.ChatPane="ChatPane",e.ChatRailHeader="ChatRailHeader",e.ChatResolveConversationLie="ChatResolveConversationLie",e.ChatRoster="ChatRoster",e.ChatSendMessage="ChatSendMessage",e.ChatWith="ChatWith",e.ChatWithUser="ChatWithUser",e.CodeSnippetDiscardButton="CodeSnippetDiscardButton",e.ComposeChat="ComposeChat",e.ComposeChatDisabled="ComposeChatDisabled",e.ConnectedCalendarStatusBanner="ConnectedCalendarStatusBanner",e.ContactsSyncBanner="ContactsSyncBanner",e.ContactsSyncDialog="ContactsSyncDialog",e.ContactsSyncMobileSyncDialog="ContactsSyncMobileSyncDialog",e.ContentCameraSettingsButton="ContentCameraSettingsButton",e.Conversation="Conversation",e.Core="Core",e.CoreResolvers="CoreResolvers",e.CustomVideoBackgroundsPanelButton="CustomVideoBackgroundsPanelButton",e.CustomVideoBackgroundsPrejoinPanelButton="CustomVideoBackgroundsPrejoinPanelButton",e.CustomVideoBackgroundsVideoPreviewButton="CustomVideoBackgroundsVideoPreviewButton",e.DefaultChatNewChat="DefaultChatNewChat",e.DefaultChatNewGroup="DefaultChatNewGroup",e.DevicePanelButton="DevicePanelButton",e.DocumentCameraSharingButton="DocumentCameraSharingButton",e.Dlp="Dlp",e.EducationGuardians="EducationGuardians",e.Esp="Esp",e.ExtensionCommanding="ExtensionCommanding",e.ExternalCommand="ExternalCommand",e.FaceEnrollmentGetStartedButton="FaceEnrollmentGetStartedButton",e.FluidAltText="FluidAltText",e.FluidDiscardButton="FluidDiscardButton",e.FluidShareServicePermissionsCallback="FluidShareServicePermissionsCallback",e.Flyout="Flyout",e.FlyoutAuthLanding="FlyoutAuthLanding",e.GalleryImage="GalleryImage",e.HangupButton="HangupButton",e.ChatInfoPaneButton="ChatInfoPaneButton",e.InsertHyperlink="InsertHyperlink",e.InternalDeeplink="InternalDeeplink",e.KeypadButton="KeypadButton",e.KeyboardShortcut="KeyboardShortcut",e.LayoutError="LayoutError",e.LivePersonaCard="LivePersonaCard",e.LmsCourseCalendar="LmsCourseCalendar",e.MediaStreamsButton="MediaStreamsButton",e.MeetingDetailsButton="MeetingDetailsButton",e.MeetingDetailsPanelWrapper="MeetingDetailsPanelWrapper",e.MeetingInfoButton="MeetingInfoButton",e.MeetingInfoPanelWrapper="MeetingInfoPanelWrapper",e.MeetingNotesButton="MeetingNotesButton",e.MeetingOptions="MeetingOptions",e.MeetingRoomDefault="MeetingRoomDefault",e.MessageAction="MessageAction",e.MessageDraftDiscardButton="MessageDraftDiscardButton",e.MessageExtensionFlyout="MessageExtensionFlyout",e.MessageLeaveChatButton="MessageLeaveChatButton",e.MessageRemoveChatUserButton="MessageRemoveChatUserButton",e.MessageReaction="MessageReaction",e.MessageReadReceipt="MessageReadReceipt",e.MessageShareChatButton="MessageShareChatButton",e.MessageGiphyConsent="MessageGiphyConsent",e.MoreOptionsMenu="MoreOptionsMenu",e.NewChat="NewChat",e.NotificationSettings="NotificationSettings",e.Notifications="Notifications",e.Nova="Nova",e.PlatformAppDetailsDialog="PlatformAppDetailsDialog",e.PlatformExtension="PlatformExtension",e.PlatformPersonalAppHeader="PlatformPersonalAppHeader",e.PlatformTabHeader="PlatformTabHeader",e.PopOutButton="PopOutButton",e.PreviewButton="PreviewButton",e.ReplaceChatItemButton="ReplaceChatItemButton",e.RosterButton="RosterButton",e.SchoolTeams="SchoolTeams",e.Search="Search",e.Settings="Settings",e.SettingsHeader="SettingsHeader",e.ShareMeetingInviteDialog="ShareMeetingInviteDialog",e.ShareToTeamsMultiWindow="ShareToTeamsMultiWindow",e.ShellAuthState="ShellAuthState",e.ShellNetworkState="ShellNetworkState",e.SideloadedAppUploadButton="SideloadedAppUploadButton",e.SignOutLink="SignOutLink",e.StagingAppUploadButton="StagingAppUploadButton",e.StandAlone="StandAlone",e.Store="Store",e.StreamCameraButton="StreamCameraButton",e.Survey="Survey",e.TagCard="TagCard",e.TabConfigurationDialog="TabConfigurationDialog",e.TabInfoButton="TabInfoButton",e.TakeSnapshot="TakeSnapshot",e.TenantAppUploadButton="TenantAppUploadButton",e.TflFre="TflFre",e.TranscriptButton="TranscriptButton",e.TranscriptPanelButton="TranscriptPanelButton",e.TranscriptPanelWrapper="TranscriptPanelWrapper",e.TwoWaySmsFriendlyName="TwoWaySmsFriendlyName",e.UnifiedSearch="UnifiedSearch",e.Unknown="Unknown",e.UnpinChatItemButton="UnpinChatItemButton",e.UpdateGroupChatAvatarButton="UpdateGroupChatAvatarButton",e.VideoCallPreviewPopup="VideoCallPreviewPopup",e.VideoEffectsButton="VideoEffectsButton",e.VideoEffectsCustomizationButton="VideoEffectsCustomizationButton",e.VideoEffectsPickerMoreButton="VideoEffectsPickerMoreButton",e.VideoEffectsMoreViewPanel="VideoEffectsMoreViewPanel",e.VideoEffectsVideoAppPanel="VideoEffectsVideoAppPanel",e.VideoPreviewDeviceSettingsButton="VideoPreviewDeviceSettingsButton",e.VideoSharingButton="VideoSharingButton",e.WhiteboardCameraSharingButton="WhiteboardCameraSharingButton"}(i||(i={}))},480177:(e,t,n)=>{"use strict";var i,a,o,r,s,l,c,d,u,m,p,g,h,v,f,y,S;n.d(t,{fe:()=>i,su:()=>a,PL:()=>o,oz:()=>r,oq:()=>s,Jm:()=>l,DL:()=>c,IC:()=>p,WR:()=>h,fX:()=>v,LQ:()=>f,tF:()=>y,lO:()=>S}),function(e){e.show="show",e.showWithoutFocusing="showWithoutFocusing",e.hide="hide",e.toggle="toggle"}(i||(i={})),function(e){e.none="none",e.flush="flush",e.forceFlush="forceFlush",e.flow="flow",e.forceFlow="forceFlow",e.new="new",e.extend="extend"}(a||(a={})),function(e){e.UnableToCreateChat="UnableToCreateChat",e.UnableToCreateGuardianChatTFL="UnableToCreateGuardianChatTFL",e.UnableToAddParticipant="UnableToAddParticipant",e.UnableToAddParticipantGuardianChatTFL="UnableToAddParticipantGuardianChatTFL",e.UnableToRemoveParticipant="UnableToRemoveParticipant",e.UnableToRemoveParticipantGuardianChatTFL="UnableToRemoveParticipantGuardianChatTFL",e.UnableToLeaveChat="UnableToLeaveChat",e.UnableToLeaveGuardianChatTFL="UnableToLeaveGuardianChatTFL"}(o||(o={})),function(e){e.organization="organization"}(r||(r={})),function(e){e.Closed="Closed",e.Confirmed="Confirmed",e.Error="Error",e.Open="Open"}(s||(s={})),function(e){e.Voicemail="voicemail",e.MissedCalls="missed-calls"}(l||(l={})),function(e){e.Invite="Invite",e.Claim="Claim"}(c||(c={})),function(e){e.Relevance="Relevance",e.DateTime="DateTime"}(d||(d={})),function(e){e.Standard="Standard",e.Private="Private",e.Shared="Shared"}(u||(u={})),function(e){e.Messages="Messages",e.People="People",e.Files="Files",e.All="All",e.Apps="Apps",e.Emails="Emails",e.Default="Default"}(m||(m={})),function(e){e.template="template",e.group="group",e.team="team"}(p||(p={})),function(e){e[e.ComposeBox=0]="ComposeBox",e[e.MessageExtensionsFlyout=1]="MessageExtensionsFlyout",e[e.MeetingAppsFlyout=2]="MeetingAppsFlyout",e[e.ChannelMeetingAppsFlyout=3]="ChannelMeetingAppsFlyout"}(g||(g={})),function(e){e[e.Whiteboard=0]="Whiteboard",e[e.Document=1]="Document",e[e.Video=2]="Video"}(h||(h={})),function(e){e.JoinByCode="JoinByCode",e.Dialpad="Dialpad",e.Cortana="Cortana"}(v||(v={})),function(e){e.sideload="sideload",e.staging="staging",e.tenant="tenant"}(f||(f={})),function(e){e.subNavEntity="subNavEntity",e.headerEntity="headerEntity",e.startEntity="startEntity",e.mainEntity="mainEntity",e.endEntity="endEntity"}(y||(y={})),function(e){e.minimal="minimal",e.focus="focus",e.standard="standard"}(S||(S={}))},439146:(e,t,n)=>{"use strict";var i,a;n.d(t,{u:()=>i,p:()=>a}),function(e){e.config="config",e.create="create",e.default="default",e.delete="delete",e.error="error",e.health="health",e.info="info",e.join="join",e.list="list",e.signin="signin",e.update="update",e.view="view",e.manage="manage",e.mutate="mutate"}(i||(i={})),function(e){e.accounts="accounts",e.activity="activity",e.addchannel="addchannel",e.addmember="addmember",e.addmembernewteam="addmembernewteam",e.agendapage="agendapage",e.alertdialog="alertdialog",e.alttext="alttext",e.annotation="annotation",e.attendeeview="attendeeview",e.bannerNotification="bannerNotification",e.blank="blank",e.brbfeedbackdialog="brbfeedbackdialog",e.breakoutrooms="breakoutrooms",e.broadcastfeedback="broadcastfeedback",e.broadcastliveevent="broadcastliveevent",e.broadcastqna="broadcastqna",e.broadcasts="broadcasts",e.calendar="calendar",e.callablechannels="callablechannels",e.callingconfirmdialog="callingconfirmdialog",e.callingdeeplink="callingdeeplink",e.calls="calls",e.callscontent="callscontent",e.callsgallery="callsgallery",e.callsgalleryandcontent="callsgalleryandcontent",e.callskeypad="callskeypad",e.callsmain="callsmain",e.callsmonitor="callsmonitor",e.callstransfer="callstransfer",e.cameraeffects="cameraeffects",e.cast="cast",e.channelconnectors="channelconnectors",e.channeldeeplink="channeldeeplink",e.channeldelete="channeldelete",e.channeledit="channeledit",e.channelemail="channelemail",e.channelmanage="channelmanage",e.channels="channels",e.chats="chats",e.coachreport="coachreport",e.connectedcalendardialog="connectedcalendardialog",e.codesnippet="codesnippet",e.contactssync="contactssync",e.contentcamerasetup="contentcamerasetup",e.coursecalendar="coursecalendar",e.courseteams="courseteams",e.customapp="customapp",e.default="default",e.deletechat="deletechat",e.devicesettings="devicesettings",e.dlp="dlp",e.email="email",e.esp="esp",e.error="error",e.extensions="extensions",e.faceenrollment="faceenrollment",e.file="file",e.fileopensettings="fileopensettings",e.fluid="fluid",e.floodgate="floodgate",e.flyout="flyout",e.gallery="gallery",e.galleryImages="galleryImages",e.giphyconsent="giphyconsent",e.guardians="guardians",e.hybridplaceholder="hybridplaceholder",e.hyperlink="hyperlink",e.identity="identity",e.invisionwhiteboard="invisionwhiteboard",e.leavechat="leavechat",e.lobnotifications="lobnotifications",e.locationapi="locationapi",e.selectpeoplepicker="selectpeoplepicker",e.selectMediaApi="selectMediaApi",e.viewImagesApi="viewImagesApi",e.licenses="licenses",e.linkedin="linkedin",e.manageapps="manageapps",e.mediastreams="mediastreams",e.meetinganalytics="meetinganalytics",e.meetingdetails="meetingdetails",e.meetingjoincrossclouddialog="meetingjoincrossclouddialog",e.meetingoptionscreatedialog="meetingoptionscreatedialog",e.meetingroomconsolecall="meetingroomconsolecall",e.meet="meet",e.meetings="meetings",e.meetingsettings="meetingsettings",e.meetingstream="meetingstream",e.messagedraft="messagedraft",e.messages="messages",e.updatemsaprofileavatardialog="updatemsaprofileavatardialog",e.updatemsaprofilenamedialog="updatemsaprofilenamedialog",e.notes="notes",e.noux="noux",e.open3sfeedback="open3sfeedback",e.optionssettingsdialog="optionssettingsdialog",e.pinnedchatsmaxreached="pinnedchatsmaxreached",e.pinnedconversationitems="pinnedconversationitems",e.platformapp="platformapp",e.platformsubscriptionplans="platformsubscriptionplans",e.platformappdetails="platformappdetails",e.platformtab="platformtab",e.platformapps="platformapps",e.stagedapps="stagedapps",e.platformauthconsentdialog="platformauthconsentdialog",e.platformStage="platformStage",e.prejoinoverlaydialog="prejoinoverlaydialog",e.ptzextension="ptzextension",e.registration="registration",e.removechatuser="removechatuser",e.reportConcern="reportConcern",e.roomremote="roomremote",e.roster="roster",e.schedulingform="schedulingform",e.schoolteams="schoolteams",e.search="search",e.settingsstore="settingsstore",e.sharechatlink="sharechatlink",e.shareformdialog="shareformdialog",e.shareMeetingInfo="shareMeetingInfo",e.signoutdialog="signoutdialog",e.stagecontent="stagecontent",e.store="store",e.streamcamera="streamcamera",e.survey="survey",e.tabapps="tabapps",e.taskmodule="taskmodule",e.teamcreate="teamcreate",e.teamdeeplink="teamdeeplink",e.teamdiscover="teamdiscover",e.teamedit="teamedit",e.teamgallery="teamgallery",e.teamjoin="teamjoin",e.teamjoincode="teamjoincode",e.teamleave="teamleave",e.teammanage="teammanage",e.teammanagetags="teammanagetags",e.teampicture="teampicture",e.teamrenewal="teamrenewal",e.teams="teams",e.teamsettings="teamsettings",e.tflfre="tflfre",e.toasts="toasts",e.tpndialog="tpndialog",e.transcript="transcript",e.transcriptcontent="transcriptcontent",e.transcripttab="transcripttab",e.translationfeedback="translationfeedback",e.unparkcalldialog="unparkcalldialog",e.updategroupchatavatar="updategroupchatavatar",e.usermediadialog="usermediadialog",e.twowaysmsfriendlyname="twowaysmsfriendlyname",e.videobackgrounds="videobackgrounds",e.videoeffectscustomization="videoeffectscustomization",e.videoeffectsmoreview="videoeffectsmoreview",e.virtualevents="virtualevents",e.voiceenrollment="voiceenrollment",e.workflows="workflows",e.windowingerrordialog="windowingerrordialog",e.restartrecomendeddialog="restartrecomendeddialog",e.stagingroomstartmeetingconfirmationdialog="stagingroomstartmeetingconfirmationdialog"}(a||(a={}))},121327:(e,t,n)=>{"use strict";var i,a,o,r,s,l,c,d,u;n.d(t,{gV:()=>i,Jc:()=>a}),function(e){e[e.Card=0]="Card",e[e.MessageExtension=1]="MessageExtension",e[e.PlatformExtensionTab=2]="PlatformExtensionTab",e[e.DeepLink=3]="DeepLink",e[e.ShareToOutlook=4]="ShareToOutlook",e[e.ContentBubble=5]="ContentBubble",e[e.AdaptiveCardTab=6]="AdaptiveCardTab"}(i||(i={})),function(e){e.Small="small",e.Medium="medium",e.Large="large"}(a||(a={})),function(e){e.message="message",e.compose="compose",e.commandBox="commandBox"}(o||(o={})),function(e){e.normal="normal",e.high="high",e.urgent="urgent"}(r||(r={})),function(e){e.aadApplication="aadApplication",e.bot="bot",e.tenantBot="tenantBot",e.office365Connector="office365Connector",e.webhook="webhook"}(s||(s={})),function(e){e.team="team",e.channel="channel"}(l||(l={})),function(e){e.html="html",e.text="text"}(c||(c={})),function(e){e.like="like",e.heart="heart",e.laugh="laugh",e.surprised="surprised",e.sad="sad",e.angry="angry"}(d||(d={})),function(e){e.aadUser="aadUser",e.onPremiseAadUser="onPremiseAadUser",e.anonymousGuest="anonymousGuest",e.federatedUser="federatedUser"}(u||(u={}))},91087:(e,t,n)=>{"use strict";var i;n.d(t,{p:()=>i}),function(e){e[e.chat=0]="chat",e[e.channel=1]="channel",e[e.tab=2]="tab"}(i||(i={}))},352367:(e,t,n)=>{"use strict";n.d(t,{eT:()=>i,L3:()=>o,B:()=>s,jK:()=>l,w5:()=>c,lX:()=>d,in:()=>u,w:()=>m,sM:()=>p,fO:()=>g,Yg:()=>h,f_:()=>v,ew:()=>f,QU:()=>y,ZW:()=>S,eL:()=>b,ir:()=>_});var i,a,o,r=n(356452);!function(e){e[e.Presenting=0]="Presenting",e[e.InCall=1]="InCall",e[e.InBroadcast=2]="InBroadcast",e[e.Interactive=3]="Interactive",e[e.Inactive=4]="Inactive",e[e.LongInactive=5]="LongInactive",e[e.Disabled=6]="Disabled",e[e.Disconnected=7]="Disconnected",e[e.Offline=8]="Offline",e[e.Uninitialized=9]="Uninitialized"}(i||(i={})),function(e){e.AppLogout="appLogout"}(a||(a={})),function(e){e[e.error=0]="error",e[e.warn=1]="warn",e[e.info=2]="info",e[e.verbose=3]="verbose"}(o||(o={}));const s={second:1e3,minute:6e4,tenMinutes:6e5};var l,c;!function(e){e.Deserialization="Deserialization",e.Unknown="Unknown",e.Undefined="Undefined",e.TimedOut="TimedOut",e.AlreadyInitialized="AlreadyInitialized",e.NotImplemented="NotImplemented",e.NotPresent="NotPresent",e.ResourceNotFound="ResourceNotFound",e.Unauthorized="Unauthorized",e.AlreadyPresent="AlreadyPresent",e.FileLocked="FileLocked",e.SpQuotaReached="SpQuotaReached",e.FailedToLazyLoadService="FailedToLazyLoadService",e.FileAccessDenied="FileAccessDenied",e.FileNameTooLong="FileNameTooLong",e.InvalidAudienceUri="InvalidAudienceUri",e.InvalidResponse="InvalidResponse",e.RemoteOperationFailed="RemoteOperationFailed",e.UnknownRenderer="UnknownRenderer",e.UnknownRequestId="UnknownRequestId",e.UnknownDocumentOperation="UnknownDocumentOperation",e.UrlUndefined="UrlUndefined",e.UserConsentRequired="UserConsentRequired",e.InvalidRequestFormat="InvalidRequestFormat",e.MaxLimitReached="MaxLimitReached",e.NotAFileLink="NotAFileLink",e.ApolloError="ApolloError",e.InvalidInput="InvalidInput",e.ThirdPartyError="ThirdPartyError",e.AlreadyInProgress="AlreadyInProgress",e.NotInitialized="NotInitialized",e.UnhandledRuntimeException="UnhandledRuntimeException",e.Paused="Paused",e.PollCreationFailure="PollCreationFailure",e.PollRuntimeFailure="PollRuntimeFailure",e.PreviousFailure="PreviousFailure",e.FeatureNotSupported="FeatureNotSupported",e.IndexDbException="IndexDbException",e.FailedToCreate="FailedToCreate",e.FailedToFetch="FailedToFetch",e.FailedToUpdate="FailedToUpdate",e.FailedToGet="FailedToGet",e.FailedToDelete="FailedToDelete",e.FailedToSubscribe="FailedToSubscribe",e.UndefinedGlobalError="UndefinedGlobalError",e.UndefinedWindowError="UndefinedWindowError",e.UnhandledPromiseRejection="UnhandledPromiseRejection",e.UndefinedDependencies="UndefinedDependencies",e.DuplicateFound="DuplicateFound",e.Empty="Empty",e.MissingParameter="MissingParameter",e.MaxCallCountReached="MaxCallCountReached",e.PayloadTooBig="PayloadTooBig",e.BotError="BotError",e.WriteToStoreFailed="WriteToStoreFailed",e.CorruptedSyncState="CorruptedSyncState",e.CorruptedConversation="CorruptedConversation",e.Aborted="Aborted",e.Forbidden="Forbidden",e.WaitToFetchMore="WaitToFetchMore",e.AuthSafariITPBlocked="AuthSafariITPBlocked",e.AuthSafariITPBlockedAlways="AuthSafariITPBlockedAlways",e.ScriptLoadError="ScriptLoadError",e.ScriptEvalError="ScriptEvalError",e.ScriptCodeError="ScriptCodeError",e.CSSLoadError="CSSLoadError",e.Disabled="Disabled",e.AuthPopupWindowClosed="AuthPopupWindowClosed",e.AuthPopupWindowBlocked="AuthPopupWindowBlocked",e.NetworkOffline="NetworkOffline",e.DBCleanupError="DBCleanupError",e.DBUnexpectedClosureError="DBUnexpectedClosureError",e.DBExpectedClosureError="DBExpectedClosureError",e.ComponentLoadError="ComponentLoadError",e.ChunkLoadTimedOut="ChunkLoadTimedOut",e.Throttled="Throttled",e.ServiceUnavailable="ServiceUnavailable",e.ExperienceDisabled="ExperienceDisabled",e.CallingServiceStateQueryError="CallingServiceStateQueryError",e.CallingServiceStateFailed="CallingServiceStateFailed",e.ShadowTokenRevoked="ShadowTokenRevoked",e.ShadowMailboxDeleted="ShadowMailboxDeleted",e.ConnectedAccountNotFound="ConnectedAccountNotFound",e.ErrorParsingQueryParams="ErrorParsingQueryParams",e.InvalidUrl="InvalidUrl",e.HTTPMethodNotSupportedForDownload="HTTPMethodNotSupportedForDownload",e.InvalidDomReference="InvalidDomReference",e.VersionMismatch="VersionMismatch",e.CoreInitFailure="CoreInitFailure",e.ConversationSyncFailure="ConversationSyncFailure",e.CoreServiceMissing="CoreServiceMissing",e.CoreNavigationServicesMissing="CoreNavigationServicesMissing",e.Authentication="Authentication",e.LayoutPhaseStateMachineTimeoutError="LayoutPhaseStateMachineTimeoutError",e.SignInRestrictions="SignInRestrictions",e.MaxTenantWideTeamLimitExceeded="MaxTenantWideTeamLimitExceeded",e.StandupCallingJobError="StandupCallingJobError",e.SetupCallingAppEventsJobError="SetupCallingAppEventsJobError",e.LayoutError="LayoutError"}(l||(l={})),function(e){e.AddShareUrlOnSendMessage="AddShareUrlOnSendMEssage",e.Apollo="Apollo",e.Authentication="Authentication",e.Commanding="Commanding",e.Core="Core",e.CSAService="CSAService",e.DataLayerClient="DataLayerClient",e.Discover="Discover",e.DistributionListService="DistributionListService",e.DriveDetailsService="DriveDetailsService",e.DriveItemShareService="DriveItemShareService",e.ErrorInRootLayout="ErrorInRootLayout",e.FileDownloadManagerService="FileDownloadManagerService",e.IndexDb="IndexDb",e.ItemDeleteService="ItemDeleteService",e.ItemDetailsService="ItemDetailsService",e.ItemUploadService="ItemUploadService",e.LayoutErrorInSlot="LayoutErrorInSlot",e.LayoutPhaseStateMachine="LayoutPhaseStateMachine",e.LazyComponentRenderer="LazyComponentRenderer",e.LongPoll="LongPoll",e.PeopleTargetingService="PeopleTargetingService",e.PostMessageClient="PostMessageClient",e.RejectHttpError="RejectHttpError",e.RequireStatus="RequireStatus",e.RequireStatusWithSsm="RequireStatusWithSsm",e.ServicesTasks="ServicesTasks",e.SettingsService="SettingsService",e.ShellService="ShellService",e.Tasks="Tasks",e.Theme="Theme",e.Timed="Timed"}(c||(c={}));const d=new Map([[r.qb.BAD_REQUEST,l.InvalidRequestFormat],[r.qb.NOT_AUTHORIZED,l.Unauthorized],[r.qb.FORBIDDEN,l.Forbidden],[r.qb.NOT_FOUND,l.ResourceNotFound],[r.qb.NOT_ALLOWED,l.InvalidRequestFormat],[r.qb.NOT_ACCEPTABLE,l.InvalidRequestFormat],[r.qb.CONFLICT,l.InvalidRequestFormat],[r.qb.GONE,l.ResourceNotFound],[r.qb.LENGTH_REQUIRED,l.InvalidRequestFormat],[r.qb.PRECONDITION_FAILED,l.InvalidRequestFormat],[r.qb.REQUEST_ENTITY_TOO_LARGE,l.PayloadTooBig],[r.qb.UNSUPPORTED_MEDIA_TYPE,l.InvalidRequestFormat],[r.qb.REQUEST_RANGE_NOT_SATISFIABLE,l.InvalidRequestFormat],[r.qb.UNPROCESSABLE_ENTITY,l.InvalidRequestFormat],[r.qb.THROTTLED,l.Throttled],[r.qb.SERVER_ERROR,l.RemoteOperationFailed],[r.qb.NOT_IMPLEMENTED,l.FeatureNotSupported],[r.qb.SERVICE_UNAVAILABLE,l.ServiceUnavailable],[r.qb.INSUFFICIENT_STORAGE,l.SpQuotaReached],[r.qb.BANDWIDTH_LIMIT_EXCEEDED,l.MaxCallCountReached]]);var u;!function(e){e[e.None=0]="None",e[e.Error=1]="Error",e[e.Warn=2]="Warn",e[e.Info=3]="Info",e[e.Debug=4]="Debug",e[e.Verbose=5]="Verbose",e[e.Max=6]="Max"}(u||(u={}));const m="default";var p,g,h,v;!function(e){e.Initialization="Initialization",e.OnUserAuthenticated="OnUserAuthenticated"}(p||(p={})),function(e){e.Experience="Experience",e.Global="Global",e.User="User",e.UserAndExperience="UserAndExperience"}(g||(g={})),function(e){e[e.CreateCDLWorkerTask=0]="CreateCDLWorkerTask",e[e.CreateCDLWorkerAuthTask=1]="CreateCDLWorkerAuthTask",e[e.CreateUserOnContextContext=2]="CreateUserOnContextContext",e[e.ClearHostSettingsTask=3]="ClearHostSettingsTask",e[e.ConfigOverride=4]="ConfigOverride",e[e.CreateAppState=5]="CreateAppState",e[e.CreateAsyncMediaAuth=6]="CreateAsyncMediaAuth",e[e.CreateAuth=7]="CreateAuth",e[e.CreateCacheClearing=8]="CreateCacheClearing",e[e.CreateCacheStorageAndOfflineCacheManager=9]="CreateCacheStorageAndOfflineCacheManager",e[e.CreateChangeReporting=10]="CreateChangeReporting",e[e.CreateClientPreferences=11]="CreateClientPreferences",e[e.CreateCommandHandler=12]="CreateCommandHandler",e[e.CreateCommandResultHooksService=13]="CreateCommandResultHooksService",e[e.CreateCoreUtilities=14]="CreateCoreUtilities",e[e.CreateDataClient=15]="CreateDataClient",e[e.CreateDiscovery=16]="CreateDiscovery",e[e.CreateEndpointsManager=17]="CreateEndpointsManager",e[e.CreateEntityCommanding=18]="CreateEntityCommanding",e[e.CreateExternalCommandListener=19]="CreateExternalCommandListener",e[e.CreateGtmRegistry=20]="CreateGtmRegistry",e[e.CreateHostedWindowContext=21]="CreateHostedWindowContext",e[e.CreateI18n=22]="CreateI18n",e[e.CreateI18NextWrapper=23]="CreateI18NextWrapper",e[e.CreateLocalStorage=24]="CreateLocalStorage",e[e.CreateDeeplinkService=25]="CreateDeeplinkService",e[e.CreateLpc=26]="CreateLpc",e[e.CreatePlatform=27]="CreatePlatform",e[e.CreateReboot=28]="CreateReboot",e[e.CreateRouting=29]="CreateRouting",e[e.CreateSettings=30]="CreateSettings",e[e.CreateWindow=31]="CreateWindow",e[e.CreateProfiler=32]="CreateProfiler",e[e.DisableExperience=33]="DisableExperience",e[e.EnableHostRouting=34]="EnableHostRouting",e[e.FetchBootstrapData=35]="FetchBootstrapData",e[e.FetchCriticalDynamicImportsTask=36]="FetchCriticalDynamicImportsTask",e[e.FetchHostSettingsTask=37]="FetchHostSettingsTask",e[e.InitATPPolicyTask=38]="InitATPPolicyTask",e[e.InitAuthenticationService=39]="InitAuthenticationService",e[e.InitInterprocessStore=40]="InitInterprocessStore",e[e.InitSettingsEcsProvider=41]="InitSettingsEcsProvider",e[e.InitSettingsMaglevHostProvider=42]="InitSettingsMaglevHostProvider",e[e.InitDesktopEcsContext=43]="InitDesktopEcsContext",e[e.InitSettingsPolicyProvider=44]="InitSettingsPolicyProvider",e[e.InitTelemetry=45]="InitTelemetry",e[e.InitExperimentation=46]="InitExperimentation",e[e.LeakDetector=47]="LeakDetector",e[e.Polyfills=48]="Polyfills",e[e.ReinitSettingsEcsProvider=49]="ReinitSettingsEcsProvider",e[e.ReloadExperience=50]="ReloadExperience",e[e.Scheduling=51]="Scheduling",e[e.UserSettings=52]="UserSettings",e[e.CreateWebClientUpdate=53]="CreateWebClientUpdate",e[e.CreateHostCommunication=54]="CreateHostCommunication",e[e.CreateAuthStateTask=55]="CreateAuthStateTask",e[e.StoreBuildInfoTask=56]="StoreBuildInfoTask",e[e.UpdateDataClientContext=57]="UpdateDataClientContext",e[e.WindowDebugEvents=58]="WindowDebugEvents",e[e.SignalCoreLifecycleChangesTask=59]="SignalCoreLifecycleChangesTask",e[e.DiscoverUser=60]="DiscoverUser",e[e.SetUserOnTelemetryContext=61]="SetUserOnTelemetryContext"}(h||(h={})),function(e){e.Blur="blur",e.Click="click",e.Focus="focus",e.Keydown="keydown",e.Keyup="keyup",e.Keypress="keypress",e.Mousedown="mousedown",e.Mousemove="mousemove",e.Mouseup="mouseup",e.Mouseleave="mouseleave",e.Touchstart="touchstart",e.Touchmove="touchmove",e.Touchend="touchend",e.Paste="paste",e.Resize="resize",e.Scroll="scroll",e.System="system"}(v||(v={}));const f="main",y="core",S="en-us";var k;!function(e){e.CDN="CDN",e.Shared="Shared",e.Browser="Browser",e.None="None"}(k||(k={}));const b="teams-precache-v2",_="/v2/"},682796:(e,t,n)=>{"use strict";var i;n.d(t,{J:()=>i}),function(e){e.Activity="activity",e.AgeConsent="ageConsent",e.Auth="auth",e.Autosuggest="autosuggest",e.BiometricEnrollment="biometricEnrollment",e.Brb="brb",e.BreakoutRoom="breakoutRoom",e.Broadcast="broadcast",e.Calendar="calendar",e.Calling="calling",e.Cdl="cdl",e.CdlWorker="cdlWorker",e.Chat="chat",e.ChatList="chatList",e.ChatService="chatService",e.Channels="channels",e.CMDMeetingArtifactsService="cmdMeetingArtifactsService",e.Core="core",e.Cortana="cortana",e.ConsumerGroups="consumerGroups",e.CsaService="csaService",e.Default="default",e.Diagnostics="diagnostics",e.DistributionLists="distributionLists",e.DynamicsMarketing="dynamicsMarketing",e.EmbedClient="embedClient",e.Esp="esp",e.Extensibility="extensibility",e.ExternalAccounts="externalAccounts",e.Federated="federated",e.Feedback="feedback",e.Files="files",e.Fre="fre",e.Freemium="freemium",e.Gallery="gallery",e.Giphy="giphy",e.Growth="growth",e.Guardians="guardians",e.Host="host",e.InviteLinks="inviteLinks",e.LiveStateService="liveStateService",e.Localization="localization",e.LmsIntegration="lmsIntegration",e.MeetingArtifacts="meetingArtifacts",e.MeetingOptions="meetingOptions",e.MeetingStream="meetingStream",e.MeetingTemplates="meetingTemplates",e.Meetup="meetup",e.Messaging="messaging",e.Metadata="metadata",e.Mobile="mobile",e.Organization="organization",e.Outlook="outlook",e.People="people",e.PeopleTargeting="peopleTargeting",e.Platform="platform",e.Presence="presence",e.Sdk="sdk",e.Search="search",e.Serp="serp",e.Shortcuts="shortcuts",e.Sync="sync",e.TeamsAndChannels="teamsAndChannels",e.Telemetry="telemetry",e.Tenant="tenant",e.Test="test",e.TrouterService="trouterService",e.Ufd="ufd",e.UserResources="userResources",e.WebinarRegistration="webinarRegistration"}(i||(i={}))},558210:(e,t,n)=>{"use strict";n.d(t,{Jk:()=>o,UH:()=>r});var i=n(737188);const a=i.string.pipe(new i.Type("URL",(e=>e instanceof URL),((e,t)=>{try{return(0,i.success)(new URL(e))}catch(n){return(0,i.failure)(e,t)}}),(e=>e.href))).pipe(new i.Type("GTM URL",(e=>e instanceof URL&&e.pathname.endsWith("/")),(e=>(e.pathname.endsWith("/")||(e.pathname+="/"),(0,i.success)(e))),i.identity)),o=(0,i.partial)({isFreemium:i.boolean,isBasicLiveEventsEnabled:i.boolean,isAdvComms:i.boolean,isTranscriptEnabled:i.boolean}),r=(0,i.partial)({ams:a,amsV2:a,chatService:a,chatServiceAfd:a,cmdArtifactsService:a,middleTier:a,mtImageService:a,powerPointStateService:a,search:a,teamsAndChannelsProvisioningService:a,unifiedPresence:a,urlp:a,urlpV2:a,userEntitlementService:a,userProfileService:a,calling_trouterUrl:a,calling_registrarUrl:a,consumerLicenses:a},"region Gtms")},459012:(e,t,n)=>{"use strict";var i;n.d(t,{EJ:()=>i}),function(e){e.Attendee="attendee",e.Auth="auth",e.BRB="brb",e.ECS="ecs",e.CDN="cdn",e.CNS="cns",e.ChatService="chatservice",e.CMDArtifactsService="cmdArtifactsService",e.CSA="csa",e.DynamicsMarketing="dynamicsMarketing",e.Graph="graph",e.Vroom="vroom",e.MeetingArtifacts="meetingArtifacts",e.MeetingTemplates="meetingTemplates",e.MiddleTier="mt",e.MsaContacts="msaContacts",e.Sharepoint="sharepoint",e.Skype="skype",e.Substrate="substrate",e.TeamsAndChannelsProvisioningService="teamsAndChannelsProvisioningService",e.UnifiedPresence="unifiedPresence",e.UserEntitlement="ues",e.LokiWrapper="lokiWrapper",e.NetworkPing="networkPing",e.OCV="ocv",e.InstantAnswers="instantanswers",e.OSearch="osearch",e.PPTCast="pptcast",e.Webinar="webinar",e.Workflows="workflows"}(i||(i={}))},416350:(e,t,n)=>{"use strict";var i;n.d(t,{i:()=>i}),function(e){e[e.Missing=0]="Missing",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded",e[e.Failed=3]="Failed"}(i||(i={}))},789284:(e,t,n)=>{"use strict";var i,a,o,r,s;n.d(t,{nh:()=>i,WL:()=>a,Ug:()=>o,GZ:()=>r,Fm:()=>s}),function(e){e[e.CRITICAL=0]="CRITICAL",e[e.POST_CRITICAL=1]="POST_CRITICAL",e[e.COMPLETE=2]="COMPLETE"}(i||(i={})),function(e){e.END="end",e.HEADER="header",e.MAIN="main",e.MODAL="modal",e.MONITOR="monitor",e.NAV="nav",e.NOTIFICATIONS="notifications",e.START="start",e.SUBNAV="sub-nav",e.TITLE_BAR="title-bar"}(a||(a={})),function(e){e.ALL_PHASE_SIGNALS_RECEIVED="all-phase-signals-received",e.PHASE_TIMEOUT_FIRED="phase-timeout-fired",e.PHASE_PREVIOUSLY_COMPLETED="phase-previously-completed",e.TARGET_AND_PREVIOUS_PHASES_DO_NOT_EXIST="target-and-previous-phases-do-not-exist"}(o||(o={})),function(e){e.AGENDA_VIEW_RENDERED="agenda_view_rendered",e.CALLING_SCREEN_RENDERED="calling-screen-rendered",e.CHAT_HEADER_BUTTONS_RENDERED="chat-header-buttons-rendered",e.CHAT_LIST_ITEMS_RENDERED="chat-list-items-rendered",e.COMPOSE_LAYOUT_LOADED="compose-layout-loaded",e.COMPOSE_LOADED="compose-loaded",e.COURSE_TEAMS_MAIN_PANE_RENDERED="course-teams-main-pane-rendered",e.GUARDIANS_TABLE_RENDERED="guardians-table-rendered",e.MESSAGE_REACTIONS_RENDERED="message-reactions-rendered",e.MESSAGES_RENDERED="messages-rendered",e.PRESENCES_RENDERED="presences-rendered",e.P2P_FILES_LIST_VIEW_RENDERED="p2p_files_list_view_rendered",e.SEARCH_RESULTS_RENDERED="search-results-rendered",e.SHARE_PAGE_RENDERED="share-page-rendered",e.VIRTUAL_LIST_RENDER_BUFFER_FILLED="virtual-list-render-buffer-filled"}(r||(r={})),function(e){e.MESSAGE_FOCUSED="message-focused"}(s||(s={}))},161622:(e,t,n)=>{"use strict";var i;n.d(t,{vW:()=>i,o_:()=>a,Tf:()=>o}),function(e){e[e.Macro=0]="Macro",e[e.RenderBlocking=1]="RenderBlocking"}(i||(i={}));const a=-1;var o;!function(e){e[e.None=0]="None",e[e.Canceled=1]="Canceled",e[e.Received=2]="Received",e[e.Started=3]="Started",e[e.Complete=4]="Complete"}(o||(o={}))},341939:(e,t,n)=>{"use strict";var i;n.d(t,{s:()=>i}),function(e){e.ag08="ag08",e.ag09="ag09",e.dev="dev",e.dod="dod",e.gcc="gcc",e.gcchigh="gcchigh",e.life="life",e.prod="prod"}(i||(i={}))},887143:(e,t,n)=>{"use strict";var i;n.d(t,{d:()=>i}),function(e){e.Auth="Auth",e.DeveloperSwitchersService="DeveloperSwitchersService",e.ReloadAppTask="ReloadAppTask",e.WebClientUpdateService="WebClientUpdateService",e.RemoveAuthenticatedUserResolver="RemoveAuthenticatedUserResolver",e.Core="Core"}(i||(i={}))},423238:(e,t,n)=>{"use strict";n.d(t,{dS:()=>i,Pz:()=>a,s_:()=>o,Tu:()=>r,Hm:()=>s});const i="com.microsoft.teams.chat",a="com.microsoft.teams.calling",o="com.microsoft.teams.meetingOptions",r="com.microsoft.teams.files",s="com.microsoft.teams.teamsAndChannels"},581870:(e,t,n)=>{"use strict";var i,a;n.d(t,{_:()=>i,a:()=>a}),function(e){e.apps="apps",e.broadcasts="broadcasts",e.chats="chats",e.calls="calls",e.calendars="calendars",e.extensions="extensions",e.files="files",e.licenses="licenses",e.meetings="meetings",e.teamgallery="teamgallery"}(i||(i={})),function(e){e.list="list",e.create="create",e.join="join",e.error="error",e.view="view"}(a||(a={}))},883523:(e,t,n)=>{"use strict";var i,a;n.d(t,{P:()=>i,x:()=>a}),function(e){e.ComposeMessage="composeMessage",e.PostCompose="postCompose",e.MessageList="messageList",e.Powerbar="powerbar",e.VirtualTreeList="virtualTreeList",e.FeedsFilter="feedsFilter",e.PeoplePicker="peoplePicker",e.SearchBox="searchBox",e.Floodgate="floodgate",e.ChatListSearchFilter="chatListSearchFilter"}(i||(i={})),function(e){e.CallingScreen="callingScreen",e.Chat="chat",e.ChannelL1="channelL1",e.ChannelL2="channelL2",e.ChatList="chatList",e.DialPad="dialpad",e.FeedList="feedlist",e.FlyoutChatList="flyoutChatList",e.GroupChat="groupChat",e.MeetingChat="meetingChat",e.MessageEscalation="messageEscalation",e.NewChat="newChat",e.PeopleSearch="peopleSearch",e.Floodgate="floodgate"}(a||(a={}))},723128:(e,t,n)=>{"use strict";var i,a,o,r,s,l,c,d,u,m,p,g,h,v,f,y,S,k,b,_,C,w,T;n.d(t,{OV:()=>i,Ai:()=>o,wh:()=>r,Th:()=>s,rA:()=>l,uS:()=>c,$K:()=>d,Tk:()=>u,Yu:()=>m,PO:()=>h,Wz:()=>v,Zc:()=>f,XR:()=>y,g$:()=>S,Nb:()=>k,cb:()=>b,Lv:()=>_,oW:()=>C,$g:()=>w,pU:()=>T}),function(e){e.Work="",e[e.Freemium=2]="Freemium",e[e.Life=3]="Life"}(i||(i={})),function(e){e.Personal="personal",e.Channel="channel",e.Unknown="unknown"}(a||(a={})),function(e){e[e.banner=0]="banner",e[e.chiclet=1]="chiclet",e[e.compose=2]="compose",e[e.dialog=3]="dialog",e[e.flyout=4]="flyout",e[e.hover=5]="hover",e[e.left=6]="left",e[e.main=7]="main",e[e.modal=8]="modal",e[e.overlay=9]="overlay",e[e.popover=10]="popover",e[e.right=11]="right",e[e.toast=12]="toast",e[e.top=13]="top",e[e.virtual=14]="virtual"}(o||(o={})),function(e){e[e.ActiveCallJoinOptions=0]="ActiveCallJoinOptions",e[e.Activity=1]="Activity",e[e.AdaptiveCardTab=2]="AdaptiveCardTab",e[e.AddAltTextDialog=3]="AddAltTextDialog",e[e.AddAppDialogReact=4]="AddAppDialogReact",e[e.AddAppTutorialDialogReact=5]="AddAppTutorialDialogReact",e[e.allowAttendeesUnmuteModal=6]="allowAttendeesUnmuteModal",e[e.appAuthDialog=7]="appAuthDialog",e[e.AppBasedLink=8]="AppBasedLink",e[e.AppFlyout=9]="AppFlyout",e[e.AppFlyoutInChannelMeeting=10]="AppFlyoutInChannelMeeting",e[e.AppFRE=11]="AppFRE",e[e.AppProfileCardPopover=12]="AppProfileCardPopover",e[e.AppUninstall=13]="AppUninstall",e[e.AtMentions=14]="AtMentions",e[e.AttendanceReport=15]="AttendanceReport",e[e.AuthAccountEnumerationMenu=16]="AuthAccountEnumerationMenu",e[e.AuthOfficeHrd=17]="AuthOfficeHrd",e[e.AuthPrompt=18]="AuthPrompt",e[e.AuthSignOutDialogNoCall=19]="AuthSignOutDialogNoCall",e[e.AuthSignOutDialogWithCall=20]="AuthSignOutDialogWithCall",e[e.AuthWelcomeToTeams=21]="AuthWelcomeToTeams",e[e.BannerScenario=22]="BannerScenario",e[e.BiometricEnrollmentDialog=23]="BiometricEnrollmentDialog",e[e.BreakoutRooms=24]="BreakoutRooms",e[e.BreakoutRoomsActionMenu=25]="BreakoutRoomsActionMenu",e[e.BreakoutRoomsAnnouncementDialog=26]="BreakoutRoomsAnnouncementDialog",e[e.BreakoutRoomsAssignmentDialog=27]="BreakoutRoomsAssignmentDialog",e[e.BreakoutRoomsCallEndScreen=28]="BreakoutRoomsCallEndScreen",e[e.BreakoutRoomsCreateRoomsDialog=29]="BreakoutRoomsCreateRoomsDialog",e[e.BreakoutRoomsCreateRoomsDialogWaitingScreen=30]="BreakoutRoomsCreateRoomsDialogWaitingScreen",e[e.BreakoutRoomsDeleteRoomDialog=31]="BreakoutRoomsDeleteRoomDialog",e[e.BreakoutRoomsNotAllowedToJoin=32]="BreakoutRoomsNotAllowedToJoin",e[e.BreakoutRoomsParticipantActionMenu=33]="BreakoutRoomsParticipantActionMenu",e[e.BreakoutRoomsRecreateRoomsDialog=34]="BreakoutRoomsRecreateRoomsDialog",e[e.BreakoutRoomsRenameRoomDialog=35]="BreakoutRoomsRenameRoomDialog",e[e.BreakoutRoomsRightRail=36]="BreakoutRoomsRightRail",e[e.BreakoutRoomsRoomTitleActionMenu=37]="BreakoutRoomsRoomTitleActionMenu",e[e.BreakoutRoomsSelectAllActionMenu=38]="BreakoutRoomsSelectAllActionMenu",e[e.BreakoutRoomsSettings=39]="BreakoutRoomsSettings",e[e.BreakoutRoomsTimerExpireScreen=40]="BreakoutRoomsTimerExpireScreen",e[e.BroadcastPlaybackScreen=41]="BroadcastPlaybackScreen",e[e.BroadcastPresenterScreen=42]="BroadcastPresenterScreen",e[e.BroadcastProducerScreen=43]="BroadcastProducerScreen",e[e.BroadcastQna=44]="BroadcastQna",e[e.Calendar=45]="Calendar",e[e.CalendarEmptyState=46]="CalendarEmptyState",e[e.CalendarEventCardContextualMenu=47]="CalendarEventCardContextualMenu",e[e.CalendarSchedulingForm=48]="CalendarSchedulingForm",e[e.CalendarSchedulingFormCommandbar=49]="CalendarSchedulingFormCommandbar",e[e.CalendarSettings=50]="CalendarSettings",e[e.Call=51]="Call",e[e.CallAlertBanner=52]="CallAlertBanner",e[e.CallHasBeenTransferred=53]="CallHasBeenTransferred",e[e.CallHealthPanel=54]="CallHealthPanel",e[e.CallHistory=55]="CallHistory",e[e.CallingAudienceBackgroundsPanel=56]="CallingAudienceBackgroundsPanel",e[e.CallingCameraEffectsPanel=57]="CallingCameraEffectsPanel",e[e.CallingChatPanel=58]="CallingChatPanel",e[e.CallingCustomVideoBackgroundsPanel=59]="CallingCustomVideoBackgroundsPanel",e[e.CallingDevicesPanel=60]="CallingDevicesPanel",e[e.CallingMeetingDetailsPanel=61]="CallingMeetingDetailsPanel",e[e.CallingMeetingInfoPanel=62]="CallingMeetingInfoPanel",e[e.CallingPaywallCapacityRejectionEndScreen=63]="CallingPaywallCapacityRejectionEndScreen",e[e.CallingPaywallDurationCutEndScreen=64]="CallingPaywallDurationCutEndScreen",e[e.CallingPostEchoBotScreen=65]="CallingPostEchoBotScreen",e[e.CallingRosterContextMenu=66]="CallingRosterContextMenu",e[e.CallingRosterPanel=67]="CallingRosterPanel",e[e.CallingRosterParticipantsSearchPanel=68]="CallingRosterParticipantsSearchPanel",e[e.CallingRosterPlusMoreLabel=69]="CallingRosterPlusMoreLabel",e[e.callingScreen=70]="callingScreen",e[e.CallingVideoEffectsPanel=71]="CallingVideoEffectsPanel",e[e.CallMeBack=72]="CallMeBack",e[e.CallMergeDialog=73]="CallMergeDialog",e[e.CallSafeTransferToggle=74]="CallSafeTransferToggle",e[e.CallSettings=75]="CallSettings",e[e.CardCopy=76]="CardCopy",e[e.CardHeaderInstall=77]="CardHeaderInstall",e[e.Channel=78]="Channel",e[e.ChannelCalendar=79]="ChannelCalendar",e[e.Chat=80]="Chat",e[e.chatBubble=81]="chatBubble",e[e.ChatList=82]="ChatList",e[e.ChatRoster=83]="ChatRoster",e[e.CoachReport=84]="CoachReport",e[e.CodeSnippetDialog=85]="CodeSnippetDialog",e[e.ComposeBanner=86]="ComposeBanner",e[e.ComposeBox=87]="ComposeBox",e[e.ConfirmEndCallForEveryone=88]="ConfirmEndCallForEveryone",e[e.ConfirmStopRecordingAndTranscriptionDialog=89]="ConfirmStopRecordingAndTranscriptionDialog",e[e.ConfirmStopRecordingDialog=90]="ConfirmStopRecordingDialog",e[e.ConnectedCalendarDialog=91]="ConnectedCalendarDialog",e[e.ContactsSyncDialog=92]="ContactsSyncDialog",e[e.ContentBubble=93]="ContentBubble",e[e.ContentBubbleInChannelMeeting=94]="ContentBubbleInChannelMeeting",e[e.ContentCameraSetupDialog=95]="ContentCameraSetupDialog",e[e.ContentCameraSharing=96]="ContentCameraSharing",e[e.CopyLinkModalDialog=97]="CopyLinkModalDialog",e[e.CqfScreen=98]="CqfScreen",e[e.CreateChatDialog=99]="CreateChatDialog",e[e.detailsPanel=100]="detailsPanel",e[e.DeviceSettingPanel=101]="DeviceSettingPanel",e[e.DialInAutoReconnect=102]="DialInAutoReconnect",e[e.DialInMeetingInfoPanel=103]="DialInMeetingInfoPanel",e[e.DialInRetryScreen=104]="DialInRetryScreen",e[e.Dialpad=105]="Dialpad",e[e.disableAttendeesCamerasModal=106]="disableAttendeesCamerasModal",e[e.dontAllowAttendeesUnmuteModal=107]="dontAllowAttendeesUnmuteModal",e[e.EligibleEngagementSurface=108]="EligibleEngagementSurface",e[e.enableAttendeesCamerasModal=109]="enableAttendeesCamerasModal",e[e.EnterpriseAgendaView=110]="EnterpriseAgendaView",e[e.EntityExtensibleMedia=111]="EntityExtensibleMedia",e[e.ExpandImage=112]="ExpandImage",e[e.ExtensibleAppPanel=113]="ExtensibleAppPanel",e[e.External=114]="External",e[e.FeedbackDialog=115]="FeedbackDialog",e[e.FilesConflictDialog=116]="FilesConflictDialog",e[e.FlyoutHomepage=117]="FlyoutHomepage",e[e.FreemiumCalendar=118]="FreemiumCalendar",e[e.FreemiumInviteContactsAccountsDialog=119]="FreemiumInviteContactsAccountsDialog",e[e.HeaderBar=120]="HeaderBar",e[e.Internal=121]="Internal",e[e.InviteFree=122]="InviteFree",e[e.JITInstall=123]="JITInstall",e[e.LargeGalleryPagination=124]="LargeGalleryPagination",e[e.LivePersonaCard=125]="LivePersonaCard",e[e.LmsCommonHeader=126]="LmsCommonHeader",e[e.LmsCourseCalendar=127]="LmsCourseCalendar",e[e.LmsCourseCalendarErrorPane=128]="LmsCourseCalendarErrorPane",e[e.LmsCourseCalendarHeader=129]="LmsCourseCalendarHeader",e[e.LmsCourseCalendarLaunchError=130]="LmsCourseCalendarLaunchError",e[e.LmsCourseCalendarSchedulingFormOverrideAttendeesConfirmation=131]="LmsCourseCalendarSchedulingFormOverrideAttendeesConfirmation",e[e.LmsCourseTeamsErrorPane=132]="LmsCourseTeamsErrorPane",e[e.LmsCourseTeamsEmptyStateError=133]="LmsCourseTeamsEmptyStateError",e[e.LmsCourseTeamsGenericEmptyState=134]="LmsCourseTeamsGenericEmptyState",e[e.LmsGenericErrorPane=135]="LmsGenericErrorPane",e[e.LmsCourseTeamsHeader=136]="LmsCourseTeamsHeader",e[e.LmsCourseTeamsLaunchError=137]="LmsCourseTeamsLaunchError",e[e.LmsTeamsForCourseError=138]="LmsTeamsForCourseError",e[e.LmsTeamsGrid=139]="LmsTeamsGrid",e[e.LobbyToast=140]="LobbyToast",e[e.LobbyWaitingPage=141]="LobbyWaitingPage",e[e.lowerAllHandsModal=142]="lowerAllHandsModal",e[e.ManageBlockedUsersSettings=143]="ManageBlockedUsersSettings",e[e.ManageContactsSyncSettings=144]="ManageContactsSyncSettings",e[e.ManageSearchabilitySettings=145]="ManageSearchabilitySettings",e[e.MeetingAnalytics=146]="MeetingAnalytics",e[e.MeetingAnalyticsAttendanceReport=147]="MeetingAnalyticsAttendanceReport",e[e.MeetingAnonPreJoinV2Screen=148]="MeetingAnonPreJoinV2Screen",e[e.MeetingLockModal=149]="MeetingLockModal",e[e.MeetingLockRetryModal=150]="MeetingLockRetryModal",e[e.MeetingNotesEmptyPage=151]="MeetingNotesEmptyPage",e[e.MeetingOptions=152]="MeetingOptions",e[e.MeetingOptionsErrorCancelled=153]="MeetingOptionsErrorCancelled",e[e.MeetingOptionsErrorGeneric=154]="MeetingOptionsErrorGeneric",e[e.MeetingOptionsErrorNotOrganizer=155]="MeetingOptionsErrorNotOrganizer",e[e.MeetingOptionsErrorSafari=156]="MeetingOptionsErrorSafari",e[e.MeetingOptionsForm=157]="MeetingOptionsForm",e[e.MeetingPreJoinConnecting=158]="MeetingPreJoinConnecting",e[e.MeetingPreJoinRoomScreen=159]="MeetingPreJoinRoomScreen",e[e.MeetingPreJoinScreen=160]="MeetingPreJoinScreen",e[e.MeetingPreJoinScreenAutoMuteTooltip=161]="MeetingPreJoinScreenAutoMuteTooltip",e[e.MeetingPreJoinV2ConnectingScreen=162]="MeetingPreJoinV2ConnectingScreen",e[e.MeetingPreJoinV2LobbyScreen=163]="MeetingPreJoinV2LobbyScreen",e[e.MeetingPreJoinV2LobbyScreenPresenterConnected=164]="MeetingPreJoinV2LobbyScreenPresenterConnected",e[e.MeetingPreJoinV2OverflowScreen=165]="MeetingPreJoinV2OverflowScreen",e[e.MeetingPreJoinV2Screen=166]="MeetingPreJoinV2Screen",e[e.meetingStreamStartDialog=167]="meetingStreamStartDialog",e[e.MentionSession=168]="MentionSession",e[e.MessageActions=169]="MessageActions",e[e.MessageExtensionFlyout=170]="MessageExtensionFlyout",e[e.MsaEditAvatarDialog=171]="MsaEditAvatarDialog",e[e.MsaEditNameDialog=172]="MsaEditNameDialog",e[e.NestedExtensibleMedia=173]="NestedExtensibleMedia",e[e.NotificationSettings=174]="NotificationSettings",e[e.OptionsMenu=175]="OptionsMenu",e[e.ParentsList=176]="ParentsList",e[e.peopleCard=177]="peopleCard",e[e.Photos=178]="Photos",e[e.PlatformTabHeader=179]="PlatformTabHeader",e[e.PlatformTabHeaderInChannelMeeting=180]="PlatformTabHeaderInChannelMeeting",e[e.PptSharing=181]="PptSharing",e[e.PrivacySettings=182]="PrivacySettings",e[e.ProfileUpdate=183]="ProfileUpdate",e[e.PstnDialog=184]="PstnDialog",e[e.PtzRemoteCameraController=185]="PtzRemoteCameraController",e[e.RecordingDeleteConfirmationDialog=186]="RecordingDeleteConfirmationDialog",e[e.RecordingGetLinkDialog=187]="RecordingGetLinkDialog",e[e.RecordingMoreOptionsMenu=188]="RecordingMoreOptionsMenu",e[e.RecordingPlayerDialog=189]="RecordingPlayerDialog",e[e.RecordingReportProblemDialog=190]="RecordingReportProblemDialog",e[e.RecordingShareDialog=191]="RecordingShareDialog",e[e.RetryScreen=192]="RetryScreen",e[e.RosterParticipantsSearchContextMenu=193]="RosterParticipantsSearchContextMenu",e[e.Search=194]="Search",e[e.Settings=195]="Settings",e[e.SettingsList=196]="SettingsList",e[e.ShareContentTray=197]="ShareContentTray",e[e.shareContentTrayV2=198]="shareContentTrayV2",e[e.ShareFormDialog=199]="ShareFormDialog",e[e.ShareToTeams=200]="ShareToTeams",e[e.ShareToTeamsOutlook=201]="ShareToTeamsOutlook",e[e.ShareToTeamsOutlookAccountError=202]="ShareToTeamsOutlookAccountError",e[e.ShareToTeamsOutlookDesktopPromotion=203]="ShareToTeamsOutlookDesktopPromotion",e[e.Shortcuts=204]="Shortcuts",e[e.SingleTeamViewNavigation=205]="SingleTeamViewNavigation",e[e.smartReplyButton=206]="smartReplyButton",e[e.SplashScreenEmptyState=207]="SplashScreenEmptyState",e[e.StageContextMenu=208]="StageContextMenu",e[e.StagePagination=209]="StagePagination",e[e.StaleMeetingDialog=210]="StaleMeetingDialog",e[e.Store=211]="Store",e[e.StreamPolicyDialog=212]="StreamPolicyDialog",e[e.SurveyDialog=213]="SurveyDialog",e[e.SurveyDialogNps=214]="SurveyDialogNps",e[e.SurveyDialogBps=215]="SurveyDialogBps",e[e.SurveyInstantAnswers=216]="SurveyInstantAnswers",e[e.SurveyThankYou=217]="SurveyThankYou",e[e.SystemAudioDriverDialog=218]="SystemAudioDriverDialog",e[e.TabInstanceConfigurationDialog=219]="TabInstanceConfigurationDialog",e[e.TabInstanceConfigurationDialogInChannelMeeting=220]="TabInstanceConfigurationDialogInChannelMeeting",e[e.taskModule=221]="taskModule",e[e.TeamChannelList=222]="TeamChannelList",e[e.TeamsChatEscalationButton=223]="TeamsChatEscalationButton",e[e.TeamSettings=224]="TeamSettings",e[e.TouchBar=225]="TouchBar",e[e.Transcript=226]="Transcript",e[e.Ubar=227]="Ubar",e[e.UbarInChannelMeeting=228]="UbarInChannelMeeting",e[e.Ufd=229]="Ufd",e[e.UpsellScreen=230]="UpsellScreen",e[e.userLocationOnMapWithEntityCommanding=231]="userLocationOnMapWithEntityCommanding",e[e.userLocationOnMapWithNestedDialog=232]="userLocationOnMapWithNestedDialog",e[e.Video=233]="Video",e[e.VivaEmfScreen=234]="VivaEmfScreen",e[e.WebinarAttendanceReport=235]="WebinarAttendanceReport",e[e.WebinarD365Link=236]="WebinarD365Link",e[e.WebinarD365PromoOffer=237]="WebinarD365PromoOffer",e[e.WebinarRegistration=238]="WebinarRegistration",e[e.webinarOrganizerRegistrationPage=239]="webinarOrganizerRegistrationPage",e[e.webinarAttendeeRegistrationPage=240]="webinarAttendeeRegistrationPage",e[e.WebinarRegistrationReport=241]="WebinarRegistrationReport",e[e.Whiteboard=242]="Whiteboard",e[e.WindowTitleBar=243]="WindowTitleBar"}(r||(r={})),function(e){e.Botchat="Botchat",e.BroadcastMeeting="BroadcastMeeting",e.Calendar="Calendar",e.Channel="Channel",e.FederatedChat="FederatedChat",e.GroupChat="GroupChat",e.Meeting="Meeting",e.MeetingDetail="MeetingDetail",e.NativeFederatedChat="NativeFederatedChat",e.OneOnOneChat="OneOnOneChat",e.PersonalApp="PersonalApp",e.privateChannel="privateChannel",e.privateMeeting="privateMeeting",e.SfbInteropChat="SfbInteropChat",e.SfcInteropChat="SfcInteropChat",e.SMSOneOnOneChat="SMSOneOnOneChat"}(s||(s={})),function(e){e[e.aboutAppButtonClick=0]="aboutAppButtonClick",e[e.acceptConversation=1]="acceptConversation",e[e.adaptiveCard=2]="adaptiveCard",e[e.adaptiveCardTabAuth=3]="adaptiveCardTabAuth",e[e.addAppButton=4]="addAppButton",e[e.addAppInline=5]="addAppInline",e[e.addAppInlineCancel=6]="addAppInlineCancel",e[e.addAttachment=7]="addAttachment",e[e.addChatPeoplePickerAdd=8]="addChatPeoplePickerAdd",e[e.addEntireClassButton=9]="addEntireClassButton",e[e.addEntireClassInProgressCancelButton=10]="addEntireClassInProgressCancelButton",e[e.addEntireClassOverrideCancelButton=11]="addEntireClassOverrideCancelButton",e[e.addEntireClassOverrideConfirmButton=12]="addEntireClassOverrideConfirmButton",e[e.addEntireClassRetryButton=13]="addEntireClassRetryButton",e[e.additionalAuthButton=14]="additionalAuthButton",e[e.addMeetingAppButton=15]="addMeetingAppButton",e[e.addParticipantButton=16]="addParticipantButton",e[e.addParticipantFromSearchButton=17]="addParticipantFromSearchButton",e[e.addPeopleButton=18]="addPeopleButton",e[e.addRoomScreenBackButton=19]="addRoomScreenBackButton",e[e.addTabButton=20]="addTabButton",e[e.admitAll=21]="admitAll",e[e.admitAllDialog=22]="admitAllDialog",e[e.admitParticipant=23]="admitParticipant",e[e.admitParticipantFromSearch=24]="admitParticipantFromSearch",e[e.agendaViewEventCard=25]="agendaViewEventCard",e[e.allowAttendeesToUnmute=26]="allowAttendeesToUnmute",e[e.allowAttendeeToUnmute=27]="allowAttendeeToUnmute",e[e.allVideoBackgroundsButton=28]="allVideoBackgroundsButton",e[e.allVideoFiltersButton=29]="allVideoFiltersButton",e[e.altText=30]="altText",e[e.angry=31]="angry",e[e.applauseReactionButton=32]="applauseReactionButton",e[e.appLogout=33]="appLogout",e[e.applyBackgroundEffect=34]="applyBackgroundEffect",e[e.appPin=35]="appPin",e[e.appProfileCard=36]="appProfileCard",e[e.appProfileCardAudioCall=37]="appProfileCardAudioCall",e[e.appProfileCardQuickIM=38]="appProfileCardQuickIM",e[e.appProfileCardStartChat=39]="appProfileCardStartChat",e[e.appProfileCardVideoCall=40]="appProfileCardVideoCall",e[e.appUnpin=41]="appUnpin",e[e.atMentionItem=42]="atMentionItem",e[e.atMentionResultItem=43]="atMentionResultItem",e[e.attachedImageLightbox=44]="attachedImageLightbox",e[e.attachFile=45]="attachFile",e[e.attachFileFromComputer=46]="attachFileFromComputer",e[e.attachFileFromOneDrive=47]="attachFileFromOneDrive",e[e.attendanceReportDownloadButton=48]="attendanceReportDownloadButton",e[e.attendanceReportDropdownButton=49]="attendanceReportDropdownButton",e[e.audienceButton=50]="audienceButton",e[e.audioCardPlaybackButton=51]="audioCardPlaybackButton",e[e.audioCardRetryButton=52]="audioCardRetryButton",e[e.audioDeviceSettingDropdown=53]="audioDeviceSettingDropdown",e[e.autoDismissNotification=54]="autoDismissNotification",e[e.banner=55]="banner",e[e.bitrateChangedBroadcastPlayer=56]="bitrateChangedBroadcastPlayer",e[e.blockConversation=57]="blockConversation",e[e.blurBackgroundEffect=58]="blurBackgroundEffect",e[e.bookmarkButton=59]="bookmarkButton",e[e.botSsoUserConsent=60]="botSsoUserConsent",e[e.breakoutRoomButton=61]="breakoutRoomButton",e[e.breakoutRoomsAcceptDeleteRoomDialogButton=62]="breakoutRoomsAcceptDeleteRoomDialogButton",e[e.breakoutRoomsAcceptRecreateRoomsDialogButton=63]="breakoutRoomsAcceptRecreateRoomsDialogButton",e[e.breakoutRoomsAcceptRenameRoomDialogButton=64]="breakoutRoomsAcceptRenameRoomDialogButton",e[e.breakoutRoomsAcceptRoomCreationButton=65]="breakoutRoomsAcceptRoomCreationButton",e[e.breakoutRoomsAddRoomButton=66]="breakoutRoomsAddRoomButton",e[e.breakoutRoomsAddRoomMenuItem=67]="breakoutRoomsAddRoomMenuItem",e[e.breakoutRoomsAskToJoinButton=68]="breakoutRoomsAskToJoinButton",e[e.breakoutRoomsAssignmentDialog=69]="breakoutRoomsAssignmentDialog",e[e.breakoutRoomsAssignmentDialogError=70]="breakoutRoomsAssignmentDialogError",e[e.breakoutRoomsAssignmentTypeDialog=71]="breakoutRoomsAssignmentTypeDialog",e[e.breakoutRoomsCancelCreateRoomWaitingScreenButton=72]="breakoutRoomsCancelCreateRoomWaitingScreenButton",e[e.breakoutRoomsCancelRoomCreationButton=73]="breakoutRoomsCancelRoomCreationButton",e[e.breakoutRoomsCloseAllRoomsMenuItem=74]="breakoutRoomsCloseAllRoomsMenuItem",e[e.breakoutRoomsClosePanelButton=75]="breakoutRoomsClosePanelButton",e[e.breakoutRoomsCloseRoomMenuItem=76]="breakoutRoomsCloseRoomMenuItem",e[e.breakoutRoomsCreateRoomsDialog=77]="breakoutRoomsCreateRoomsDialog",e[e.breakoutRoomsDeleteRoomMenuItem=78]="breakoutRoomsDeleteRoomMenuItem",e[e.breakoutRoomsDismissDeleteRoomDialogButton=79]="breakoutRoomsDismissDeleteRoomDialogButton",e[e.breakoutRoomsDismissRecreateRoomsDialogButton=80]="breakoutRoomsDismissRecreateRoomsDialogButton",e[e.breakoutRoomsDismissRenameRoomDialogButton=81]="breakoutRoomsDismissRenameRoomDialogButton",e[e.breakoutRoomsJoinRoomMenuItem=82]="breakoutRoomsJoinRoomMenuItem",e[e.breakoutRoomsOpenAllRoomsMenuItem=83]="breakoutRoomsOpenAllRoomsMenuItem",e[e.breakoutRoomsOpenAssignmentDialog=84]="breakoutRoomsOpenAssignmentDialog",e[e.breakoutRoomsOpenCloseAllActionButton=85]="breakoutRoomsOpenCloseAllActionButton",e[e.breakoutRoomsOpenRoomMenuItem=86]="breakoutRoomsOpenRoomMenuItem",e[e.breakoutRoomsRecreateRoomsButton=87]="breakoutRoomsRecreateRoomsButton",e[e.breakoutRoomsRenameRoomMenuItem=88]="breakoutRoomsRenameRoomMenuItem",e[e.breakoutRoomsSettingsBackButton=89]="breakoutRoomsSettingsBackButton",e[e.breakoutRoomsSettingsButton=90]="breakoutRoomsSettingsButton",e[e.breakoutRoomsSettingsCheckbox=91]="breakoutRoomsSettingsCheckbox",e[e.breakoutRoomsTakeControlButton=92]="breakoutRoomsTakeControlButton",e[e.broadcastQnaButton=93]="broadcastQnaButton",e[e.browseMoreContent=94]="browseMoreContent",e[e.buttonApplyCustomVideoBackground=95]="buttonApplyCustomVideoBackground",e[e.buttonCameraEffects=96]="buttonCameraEffects",e[e.togetherModeChangeSceneButton=97]="togetherModeChangeSceneButton",e[e.buttonCustomVideoBackgrounds=98]="buttonCustomVideoBackgrounds",e[e.buttonPreviewCustomVideoBackground=99]="buttonPreviewCustomVideoBackground",e[e.buttonSelectCustomVideoBackground=100]="buttonSelectCustomVideoBackground",e[e.calendarPeoplePicker=101]="calendarPeoplePicker",e[e.calendarPeoplePickerAdd=102]="calendarPeoplePickerAdd",e[e.calendarTabsClick=103]="calendarTabsClick",e[e.calendarViewOptionsChange=104]="calendarViewOptionsChange",e[e.call=105]="call",e[e.callAudioButton=106]="callAudioButton",e[e.callForwardingDropdown=107]="callForwardingDropdown",e[e.callForwardingSettingButton=108]="callForwardingSettingButton",e[e.callGroupNotificationButton=109]="callGroupNotificationButton",e[e.callGroupSettingButton=110]="callGroupSettingButton",e[e.callHealthButton=111]="callHealthButton",e[e.callHealthViewMoreButton=112]="callHealthViewMoreButton",e[e.callHistoryFilter=113]="callHistoryFilter",e[e.callHistoryItem=114]="callHistoryItem",e[e.callingContactSubscription=115]="callingContactSubscription",e[e.callingParticipantStream=116]="callingParticipantStream",e[e.callingPeoplePicker=117]="callingPeoplePicker",e[e.callingPeoplePickerAdd=118]="callingPeoplePickerAdd",e[e.callingPostEchoBotScreen=119]="callingPostEchoBotScreen",e[e.callMeBackButton=120]="callMeBackButton",e[e.callMeetingInfoButton=121]="callMeetingInfoButton",e[e.callRecording=122]="callRecording",e[e.callSettings=123]="callSettings",e[e.callTranscript=124]="callTranscript",e[e.callTransferButton=125]="callTransferButton",e[e.callVideoButton=126]="callVideoButton",e[e.cancel=127]="cancel",e[e.cancelAllowAttendeesToUnmute=128]="cancelAllowAttendeesToUnmute",e[e.cancelAttachFileFromOneDrive=129]="cancelAttachFileFromOneDrive",e[e.cancelButton=130]="cancelButton",e[e.cancelDeleteRecording=131]="cancelDeleteRecording",e[e.cancelDialogButton=132]="cancelDialogButton",e[e.cancelDontAllowAttendeesToUnmute=133]="cancelDontAllowAttendeesToUnmute",e[e.cancelEndMeetingForAll=134]="cancelEndMeetingForAll",e[e.cancelJoinMeetingButton=135]="cancelJoinMeetingButton",e[e.cancelMeetingButton=136]="cancelMeetingButton",e[e.cancelNudgeParticipanButton=137]="cancelNudgeParticipanButton",e[e.cancelNudgeParticipantFromSearchButton=138]="cancelNudgeParticipantFromSearchButton",e[e.cancelRetryButton=139]="cancelRetryButton",e[e.cancelStopRecording=140]="cancelStopRecording",e[e.channelActionMenuItem=141]="channelActionMenuItem",e[e.channelListHeaderActionMenuItem=142]="channelListHeaderActionMenuItem",e[e.channelListItem=143]="channelListItem",e[e.chatBubblesButton=144]="chatBubblesButton",e[e.chatCopyShareLinkButton=145]="chatCopyShareLinkButton",e[e.chatFilesTab=146]="chatFilesTab",e[e.chatHeader=147]="chatHeader",e[e.chatList=148]="chatList",e[e.chatScreenShareButton=149]="chatScreenShareButton",e[e.closeButton=150]="closeButton",e[e.closeCallMeBackDialog=151]="closeCallMeBackDialog",e[e.closedCaptionsButton=152]="closedCaptionsButton",e[e.closeLobbyToast=153]="closeLobbyToast",e[e.closeMeetingLinkCreatedDialogButton=154]="closeMeetingLinkCreatedDialogButton",e[e.closeNotification=155]="closeNotification",e[e.closeRosterButton=156]="closeRosterButton",e[e.closeShareContentTray=157]="closeShareContentTray",e[e.closeShareContentTrayV2=158]="closeShareContentTrayV2",e[e.closeShortcut=159]="closeShortcut",e[e.codeSnippet=160]="codeSnippet",e[e.collaborativeAgendaButton=161]="collaborativeAgendaButton",e[e.collapseFileResult=162]="collapseFileResult",e[e.collapseMessageResult=163]="collapseMessageResult",e[e.collapseSearchResult=164]="collapseSearchResult",e[e.companionJoinButton=165]="companionJoinButton",e[e.companyVideoPolicy=166]="companyVideoPolicy",e[e.composeBox=167]="composeBox",e[e.composeFocus=168]="composeFocus",e[e.composeHighImportance=169]="composeHighImportance",e[e.composeNormalImportance=170]="composeNormalImportance",e[e.composeToggle=171]="composeToggle",e[e.composeUrgentImportance=172]="composeUrgentImportance",e[e.confirmAdmitAll=173]="confirmAdmitAll",e[e.confirmEndCall=174]="confirmEndCall",e[e.confirmMuteAll=175]="confirmMuteAll",e[e.confirmRemoveApp=176]="confirmRemoveApp",e[e.confirmStopRecording=177]="confirmStopRecording",e[e.connectedCalendarDialog=178]="connectedCalendarDialog",e[e.connectedCalendarSettingsItem=179]="connectedCalendarSettingsItem",e[e.contactsSyncControl=180]="contactsSyncControl",e[e.contentBubble=181]="contentBubble",e[e.contentOnlyJoin=182]="contentOnlyJoin",e[e.conversationOverflow=183]="conversationOverflow",e[e.copyButton=184]="copyButton",e[e.copyJoinInfoButton=185]="copyJoinInfoButton",e[e.copyLinkButton=186]="copyLinkButton",e[e.copyLinkMessage=187]="copyLinkMessage",e[e.copyMeetingLinkButton=188]="copyMeetingLinkButton",e[e.copyShareRecordingLink=189]="copyShareRecordingLink",e[e.cqf=190]="cqf",e[e.createMeetingLinkButton=191]="createMeetingLinkButton",e[e.deeplinkService=192]="deeplinkService",e[e.deleteMessage=193]="deleteMessage",e[e.deleteRecordingEntryPoint=194]="deleteRecordingEntryPoint",e[e.denyParticipant=195]="denyParticipant",e[e.denyParticipantFromSearch=196]="denyParticipantFromSearch",e[e.descheduleMessage=197]="descheduleMessage",e[e.dialpadPeoplePicker=198]="dialpadPeoplePicker",e[e.dialpadPeoplePickerAdd=199]="dialpadPeoplePickerAdd",e[e.disableAttendeeCamera=200]="disableAttendeeCamera",e[e.disableAttendeesCameras=201]="disableAttendeesCameras",e[e.disableHighFidelityAudio=202]="disableHighFidelityAudio",e[e.discardDraft=203]="discardDraft",e[e.discardEditMessage=204]="discardEditMessage",e[e.discardFluidDraft=205]="discardFluidDraft",e[e.discoverabilityCheckbox=206]="discoverabilityCheckbox",e[e.dismissButton=207]="dismissButton",e[e.dismissInstallSystemAudioDriver=208]="dismissInstallSystemAudioDriver",e[e.dismissMeeting=209]="dismissMeeting",e[e.dismissShareRecordingPopUp=210]="dismissShareRecordingPopUp",e[e.dismissUpdateSystemAudioDriver=211]="dismissUpdateSystemAudioDriver",e[e.dontAllowAttendeesToUnmute=212]="dontAllowAttendeesToUnmute",e[e.dontAllowAttendeeToUnmute=213]="dontAllowAttendeeToUnmute",e[e.dontIncludeComputerSound=214]="dontIncludeComputerSound",e[e.downloadBannerLink=215]="downloadBannerLink",e[e.downloadButtonPrimary=216]="downloadButtonPrimary",e[e.downloadPostShareLink=217]="downloadPostShareLink",e[e.downloadRecording=218]="downloadRecording",e[e.downloadSkipLink=219]="downloadSkipLink",e[e.editAvatarDialog=220]="editAvatarDialog",e[e.editAvatarSaveButton=221]="editAvatarSaveButton",e[e.editMeeting=222]="editMeeting",e[e.editMessage=223]="editMessage",e[e.editTranscriptButton=224]="editTranscriptButton",e[e.editVideoEffectButton=225]="editVideoEffectButton",e[e.enableAttendeeCamera=226]="enableAttendeeCamera",e[e.enableAttendeesCameras=227]="enableAttendeesCameras",e[e.enableHighFidelityAudio=228]="enableHighFidelityAudio",e[e.escalateButton=229]="escalateButton",e[e.eventCardRightClick=230]="eventCardRightClick",e[e.expandFileResult=231]="expandFileResult",e[e.expandMessageResult=232]="expandMessageResult",e[e.expandSearchResult=233]="expandSearchResult",e[e.extendedTabRightClick=234]="extendedTabRightClick",e[e.extensibility=235]="extensibility",e[e.extensionSubmit=236]="extensionSubmit",e[e.faceCaptureFooter=237]="faceCaptureFooter",e[e.feedbackCancelButton=238]="feedbackCancelButton",e[e.feedbackCloseButton=239]="feedbackCloseButton",e[e.feedbackInstantAnswerReactionNo=240]="feedbackInstantAnswerReactionNo",e[e.feedbackInstantAnswerReactionYes=241]="feedbackInstantAnswerReactionYes",e[e.feedbackSubmitButton=242]="feedbackSubmitButton",e[e.feedFilters=243]="feedFilters",e[e.feedList=244]="feedList",e[e.fileActionButton=245]="fileActionButton",e[e.fileChiclet=246]="fileChiclet",e[e.fileConflictedDialogCancelButton=247]="fileConflictedDialogCancelButton",e[e.fileConflictedDialogKeepBothButton=248]="fileConflictedDialogKeepBothButton",e[e.fileConflictedDialogReplaceButton=249]="fileConflictedDialogReplaceButton",e[e.fileConsentCard=250]="fileConsentCard",e[e.filePickerCancelButton=251]="filePickerCancelButton",e[e.filePickerReferenceButton=252]="filePickerReferenceButton",e[e.filePickerUploadButton=253]="filePickerUploadButton",e[e.fileRowEllipses=254]="fileRowEllipses",e[e.filterChatList=255]="filterChatList",e[e.fluidPicker=256]="fluidPicker",e[e.focusModeButton=257]="focusModeButton",e[e.formatBlockQuote=258]="formatBlockQuote",e[e.formatBold=259]="formatBold",e[e.formatBullet=260]="formatBullet",e[e.formatFontColor=261]="formatFontColor",e[e.formatFontSize=262]="formatFontSize",e[e.formatHighlighter=263]="formatHighlighter",e[e.formatHorizontalRule=264]="formatHorizontalRule",e[e.formatIndent=265]="formatIndent",e[e.formatItalic=266]="formatItalic",e[e.formatList=267]="formatList",e[e.formatOutdent=268]="formatOutdent",e[e.formatParagraph=269]="formatParagraph",e[e.formatRedo=270]="formatRedo",e[e.formatRemove=271]="formatRemove",e[e.formatStrikethrough=272]="formatStrikethrough",e[e.formatUnderline=273]="formatUnderline",e[e.formatUndo=274]="formatUndo",e[e.freemiumEventCard=275]="freemiumEventCard",e[e.freemiumGoogleCalButton=276]="freemiumGoogleCalButton",e[e.freemiumGoogleCalDialog=277]="freemiumGoogleCalDialog",e[e.freemiumGoogleCalErrorLayout=278]="freemiumGoogleCalErrorLayout",e[e.freemiumInviteContactsAccountsButton=279]="freemiumInviteContactsAccountsButton",e[e.freProfileScreen=280]="freProfileScreen",e[e.fullScreenBroadcastPlayer=281]="fullScreenBroadcastPlayer",e[e.fullscreenButton=282]="fullscreenButton",e[e.funCustomCancel=283]="funCustomCancel",e[e.funCustomDone=284]="funCustomDone",e[e.funItem=285]="funItem",e[e.funStuffPicker=286]="funStuffPicker",e[e.galleryOnTopButton=287]="galleryOnTopButton",e[e.genericEmptyStateButton=288]="genericEmptyStateButton",e[e.gestureBasedReactionButton=289]="gestureBasedReactionButton",e[e.getLink=290]="getLink",e[e.getLinkToChatButton=291]="getLinkToChatButton",e[e.getStarted=292]="getStarted",e[e.getTeamsForWorkOrSchool=293]="getTeamsForWorkOrSchool",e[e.getUserLocation=294]="getUserLocation",e[e.googleCalendarButton=295]="googleCalendarButton",e[e.goToTeams=296]="goToTeams",e[e.goToWebsiteButton=297]="goToWebsiteButton",e[e.gridButton=298]="gridButton",e[e.groupChatPeoplePicker=299]="groupChatPeoplePicker",e[e.groupChatPeoplePickerAdd=300]="groupChatPeoplePickerAdd",e[e.heart=301]="heart",e[e.heartReactionButton=302]="heartReactionButton",e[e.heroCard=303]="heroCard",e[e.hideBackgroundEffects=304]="hideBackgroundEffects",e[e.hideCallHealthPanel=305]="hideCallHealthPanel",e[e.hideMyself=306]="hideMyself",e[e.hideTranscriptPanelButton=307]="hideTranscriptPanelButton",e[e.highPriority=308]="highPriority",e[e.ignoreMirroringMyVideoToggle=309]="ignoreMirroringMyVideoToggle",e[e.image=310]="image",e[e.imageLightbox=311]="imageLightbox",e[e.immersiveReader=312]="immersiveReader",e[e.includeComputerSound=313]="includeComputerSound",e[e.incomingVideoButton=314]="incomingVideoButton",e[e.inContextAppStoreDialog=315]="inContextAppStoreDialog",e[e.chatInfoPaneButton=316]="chatInfoPaneButton",e[e.insertFluidComponent=317]="insertFluidComponent",e[e.insertHyperlink=318]="insertHyperlink",e[e.insertTable=319]="insertTable",e[e.installSystemAudioDriver=320]="installSystemAudioDriver",e[e.interopScreenshareButton=321]="interopScreenshareButton",e[e.inviteCoworkers=322]="inviteCoworkers",e[e.inviteModalDismissButton=323]="inviteModalDismissButton",e[e.invitePeopleButton=324]="invitePeopleButton",e[e.joinCallButton=325]="joinCallButton",e[e.joinContentOnlyButton=326]="joinContentOnlyButton",e[e.joinMainMeetingButton=327]="joinMainMeetingButton",e[e.joinMeetingButton=328]="joinMeetingButton",e[e.joinMeetingFromCodeClick=329]="joinMeetingFromCodeClick",e[e.joinPstnContentOnlyButton=330]="joinPstnContentOnlyButton",e[e.joinScheduledMeeting=331]="joinScheduledMeeting",e[e.keyboardShortcutsDebug=332]="keyboardShortcutsDebug",e[e.keyboardShortcutsGeneral=333]="keyboardShortcutsGeneral",e[e.keyboardShortcutsMeetingsCallsAndCalendar=334]="keyboardShortcutsMeetingsCallsAndCalendar",e[e.keyboardShortcutsMessaging=335]="keyboardShortcutsMessaging",e[e.keyboardShortcutsNavigation=336]="keyboardShortcutsNavigation",e[e.keyboardShortcutsUnknown=337]="keyboardShortcutsUnknown",e[e.largeGridButton=338]="largeGridButton",e[e.laugh=339]="laugh",e[e.laughReactionButton=340]="laughReactionButton",e[e.learnMoreLink=341]="learnMoreLink",e[e.leaveChat=342]="leaveChat",e[e.leaveGroupChat=343]="leaveGroupChat",e[e.leftRailFilter=344]="leftRailFilter",e[e.legalNoticeLink=345]="legalNoticeLink",e[e.like=346]="like",e[e.likeButton=347]="likeButton",e[e.likeReactionButton=348]="likeReactionButton",e[e.link=349]="link",e[e.linkUnfurl=350]="linkUnfurl",e[e.listCard=351]="listCard",e[e.lowerAllHands=352]="lowerAllHands",e[e.lowerHandButton=353]="lowerHandButton",e[e.lowerHandOnBehalfButton=354]="lowerHandOnBehalfButton",e[e.lowerHandOnBehalfFromSearchButton=355]="lowerHandOnBehalfFromSearchButton",e[e.lpcAudioCall=356]="lpcAudioCall",e[e.lpcBlockContact=357]="lpcBlockContact",e[e.lpcClose=358]="lpcClose",e[e.lpcOrgChart=359]="lpcOrgChart",e[e.lpcQuickIM=360]="lpcQuickIM",e[e.lpcStartChat=361]="lpcStartChat",e[e.lpcUnblockContact=362]="lpcUnblockContact",e[e.lpcVideoCall=363]="lpcVideoCall",e[e.manageAliasPrivacyConfirmationButton=364]="manageAliasPrivacyConfirmationButton",e[e.manageAliasPrivacyMsaLink=365]="manageAliasPrivacyMsaLink",e[e.manageAliasPrivacySettings=366]="manageAliasPrivacySettings",e[e.manageAppsStaging=367]="manageAppsStaging",e[e.manageAppsTask=368]="manageAppsTask",e[e.manageBlockedUsersSettings=369]="manageBlockedUsersSettings",e[e.manageContactsSyncSettings=370]="manageContactsSyncSettings",e[e.manageSearchabilitySettings=371]="manageSearchabilitySettings",e[e.manageTagSettings=372]="manageTagSettings",e[e.markdownEndQuote=373]="markdownEndQuote",e[e.mediaStreamsButton=374]="mediaStreamsButton",e[e.meetingActions=375]="meetingActions",e[e.meetingCoachButton=376]="meetingCoachButton",e[e.meetingDetailsPanel=377]="meetingDetailsPanel",e[e.meetingHelpButton=378]="meetingHelpButton",e[e.meetingInfoPanel=379]="meetingInfoPanel",e[e.meetingItem=380]="meetingItem",e[e.meetingLock=381]="meetingLock",e[e.meetingNotesButton=382]="meetingNotesButton",e[e.meetingOptionsLink=383]="meetingOptionsLink",e[e.meetingPreJoinScreenAutoMuteTooltip=384]="meetingPreJoinScreenAutoMuteTooltip",e[e.meetingRoomContentAndPeopleButton=385]="meetingRoomContentAndPeopleButton",e[e.meetingRoomContentOnlyButton=386]="meetingRoomContentOnlyButton",e[e.meetingRoomPeopleOnlyButton=387]="meetingRoomPeopleOnlyButton",e[e.meetingRoomSwapScreensButton=388]="meetingRoomSwapScreensButton",e[e.meetingSchedule=389]="meetingSchedule",e[e.meetingStreamStartDialog=390]="meetingStreamStartDialog",e[e.meetNowButton=391]="meetNowButton",e[e.meetNowClick=392]="meetNowClick",e[e.meetNowFromEventClick=393]="meetNowFromEventClick",e[e.meetNowGetMeetingLinkClick=394]="meetNowGetMeetingLinkClick",e[e.meetNowShareMeetingLinkClick=395]="meetNowShareMeetingLinkClick",e[e.messageCopyLink=396]="messageCopyLink",e[e.messageDelete=397]="messageDelete",e[e.messageEdit=398]="messageEdit",e[e.messageEscalationPeoplePicker=399]="messageEscalationPeoplePicker",e[e.messageEscalationPeoplePickerAdd=400]="messageEscalationPeoplePickerAdd",e[e.messageExtensionActionCommandMenu=401]="messageExtensionActionCommandMenu",e[e.messageExtensionFlyout=402]="messageExtensionFlyout",e[e.messageExtensionSend=403]="messageExtensionSend",e[e.messageExtensionsList=404]="messageExtensionsList",e[e.messageList=405]="messageList",e[e.messageQuotedReply=406]="messageQuotedReply",e[e.messageReaction=407]="messageReaction",e[e.messageReport=408]="messageReport",e[e.messageTranslate=409]="messageTranslate",e[e.messageUndoDelete=410]="messageUndoDelete",e[e.messageUnread=411]="messageUnread",e[e.messageAction=412]="messageAction",e[e.moreVideoEffectsButton=413]="moreVideoEffectsButton",e[e.msaEditNameDialogButton=414]="msaEditNameDialogButton",e[e.mute=415]="mute",e[e.muteAll=416]="muteAll",e[e.muteAllButton=417]="muteAllButton",e[e.muteAllDialog=418]="muteAllDialog",e[e.muteAudioButton=419]="muteAudioButton",e[e.muteNotificationsButton=420]="muteNotificationsButton",e[e.muteParticipant=421]="muteParticipant",e[e.muteParticipantFromSearch=422]="muteParticipantFromSearch",e[e.nameGroupChat=423]="nameGroupChat",e[e.nameGroupChatCancel=424]="nameGroupChatCancel",e[e.nameGroupChatSave=425]="nameGroupChatSave",e[e.navigateToChatFromDeepLink=426]="navigateToChatFromDeepLink",e[e.navigateToMeetingOptionsPageFromRoster=427]="navigateToMeetingOptionsPageFromRoster",e[e.navigateToPartialRosterFromDrillInButton=428]="navigateToPartialRosterFromDrillInButton",e[e.ndiBroadcastButton=429]="ndiBroadcastButton",e[e.newChatGroupNameToggleCollapse=430]="newChatGroupNameToggleCollapse",e[e.newChatGroupNameToggleExpand=431]="newChatGroupNameToggleExpand",e[e.newChatPeoplePicker=432]="newChatPeoplePicker",e[e.newChatPeoplePickerAdd=433]="newChatPeoplePickerAdd",e[e.newChatPeoplePillRemove=434]="newChatPeoplePillRemove",e[e.newUserInvite=435]="newUserInvite",e[e.notificationBanner=436]="notificationBanner",e[e.notificationSettingItem=437]="notificationSettingItem",e[e.notificationSettingsPage=438]="notificationSettingsPage",e[e.o365ConnectorCard=439]="o365ConnectorCard",e[e.o365ConnectorCardAlias=440]="o365ConnectorCardAlias",e[e.odspShareDialog=441]="odspShareDialog",e[e.openAplCustomBackgroundsList=442]="openAplCustomBackgroundsList",e[e.openContentCameraList=443]="openContentCameraList",e[e.openD365DialogButton=444]="openD365DialogButton",e[e.openD365PromoOfferPageButton=445]="openD365PromoOfferPageButton",e[e.openRosterFromStageButton=446]="openRosterFromStageButton",e[e.openDefaultD365OrgButton=447]="openDefaultD365OrgButton",e[e.openInGoogleCalendarButton=448]="openInGoogleCalendarButton",e[e.openInODB=449]="openInODB",e[e.openInOutlookButton=450]="openInOutlookButton",e[e.openInStream=451]="openInStream",e[e.openMeetNowFromCodeFlyout=452]="openMeetNowFromCodeFlyout",e[e.openMeetNowMenuPanel=453]="openMeetNowMenuPanel",e[e.openMeetNowShareFlyout=454]="openMeetNowShareFlyout",e[e.openParticipantList=455]="openParticipantList",e[e.openScreensList=456]="openScreensList",e[e.openSelectedD365OrgButton=457]="openSelectedD365OrgButton",e[e.openShareContentTray=458]="openShareContentTray",e[e.openShareContentTrayV2=459]="openShareContentTrayV2",e[e.openShareDialog=460]="openShareDialog",e[e.openWindowsList=461]="openWindowsList",e[e.optionsMenuItem=462]="optionsMenuItem",e[e.parentChatButton=463]="parentChatButton",e[e.parentLearnMoreWeblink=464]="parentLearnMoreWeblink",e[e.parentList=465]="parentList",e[e.parentListOverflowButton=466]="parentListOverflowButton",e[e.pasteFluidLink=467]="pasteFluidLink",e[e.pauseBroadcastPlayer=468]="pauseBroadcastPlayer",e[e.paywallUpgradeButton=469]="paywallUpgradeButton",e[e.paywallDismissButton=470]="paywallDismissButton",e[e.peek=471]="peek",e[e.personalFilesLeftNav=472]="personalFilesLeftNav",e[e.pinMessage=473]="pinMessage",e[e.pinMyself=474]="pinMyself",e[e.pinParticipant=475]="pinParticipant",e[e.pinParticipantFromSearch=476]="pinParticipantFromSearch",e[e.playBroadcastPlayer=477]="playBroadcastPlayer",e[e.playGIF=478]="playGIF",e[e.playRecording=479]="playRecording",e[e.plusMoreRosterButton=480]="plusMoreRosterButton",e[e.powerbarAutosuggest=481]="powerbarAutosuggest",e[e.powerPointTakeControl=482]="powerPointTakeControl",e[e.preJoinAttendeeButton=483]="preJoinAttendeeButton",e[e.preJoinBanner=484]="preJoinBanner",e[e.preJoinBannerDismissButton=485]="preJoinBannerDismissButton",e[e.preJoinBannerJoinButton=486]="preJoinBannerJoinButton",e[e.prejoinRoomScreenButton=487]="prejoinRoomScreenButton",e[e.preJoinV2=488]="preJoinV2",e[e.presenterChangeSlide=489]="presenterChangeSlide",e[e.presenterDisablePrivateViewing=490]="presenterDisablePrivateViewing",e[e.presenterEnablePrivateViewing=491]="presenterEnablePrivateViewing",e[e.previewButton=492]="previewButton",e[e.previewConversation=493]="previewConversation",e[e.privacyPolicyLink=494]="privacyPolicyLink",e[e.privatePreviewButton=495]="privatePreviewButton",e[e.privateViewingNextSlideButton=496]="privateViewingNextSlideButton",e[e.privateViewingToggleButton=497]="privateViewingToggleButton",e[e.profileCard=498]="profileCard",e[e.prominentShareInviteButton=499]="prominentShareInviteButton",e[e.pstnDialOut=500]="pstnDialOut",e[e.ptzRemoteCamera=501]="ptzRemoteCamera",e[e.raiseHandButton=502]="raiseHandButton",e[e.readReceiptButton=503]="readReceiptButton",e[e.recapPage=504]="recapPage",e[e.receiptCard=505]="receiptCard",e[e.recordingChiclet=506]="recordingChiclet",e[e.recordingChicletLearnMoreLink=507]="recordingChicletLearnMoreLink",e[e.recordingChicletChangeExpirationDateLink=508]="recordingChicletChangeExpirationDateLink",e[e.recordingsTranscriptsTab=509]="recordingsTranscriptsTab",e[e.rejectCallButton=510]="rejectCallButton",e[e.reloadTabButton=511]="reloadTabButton",e[e.removeAttachment=512]="removeAttachment",e[e.removeTabButton=513]="removeTabButton",e[e.renameChat=514]="renameChat",e[e.renameTabButton=515]="renameTabButton",e[e.renderMessage=516]="renderMessage",e[e.renewTeam=517]="renewTeam",e[e.reportRecordingIssuePopUp=518]="reportRecordingIssuePopUp",e[e.reportRecordingProblem=519]="reportRecordingProblem",e[e.requestControlButton=520]="requestControlButton",e[e.requestControlCancelButton=521]="requestControlCancelButton",e[e.requestControlConfirmButton=522]="requestControlConfirmButton",e[e.requireRegistrationButton=523]="requireRegistrationButton",e[e.restrictParticipantAudio=524]="restrictParticipantAudio",e[e.resumeBroadcastPlayer=525]="resumeBroadcastPlayer",e[e.retryCallButton=526]="retryCallButton",e[e.roomJoin=527]="roomJoin",e[e.roomListElement=528]="roomListElement",e[e.rosterParticipantsSearchInput=529]="rosterParticipantsSearchInput",e[e.sad=530]="sad",e[e.saveButton=531]="saveButton",e[e.saveMessage=532]="saveMessage",e[e.scdEditingButton=533]="scdEditingButton",e[e.scenePicker=534]="scenePicker",e[e.scheduleMeetingButton=535]="scheduleMeetingButton",e[e.scheduleMessage=536]="scheduleMessage",e[e.schoolAppBackButton=537]="schoolAppBackButton",e[e.scroll=538]="scroll",e[e.search=539]="search",e[e.searchPeoplePicker=540]="searchPeoplePicker",e[e.searchPeoplePickerAdd=541]="searchPeoplePickerAdd",e[e.seeFullLobbyList=542]="seeFullLobbyList",e[e.seekedBroadcastPlayer=543]="seekedBroadcastPlayer",e[e.seekingBroadcastPlayer=544]="seekingBroadcastPlayer",e[e.seeMoreRosterButton=545]="seeMoreRosterButton",e[e.selectAccountFromList=546]="selectAccountFromList",e[e.selectAplCustomBackground=547]="selectAplCustomBackground",e[e.selectAttachFileFromOneDrive=548]="selectAttachFileFromOneDrive",e[e.selectContentOnlySharingLayout=549]="selectContentOnlySharingLayout",e[e.selectDesktopScreen=550]="selectDesktopScreen",e[e.selectNewsAnchorSharingLayout=551]="selectNewsAnchorSharingLayout",e[e.selectPlatformAppTab=552]="selectPlatformAppTab",e[e.selectSideBySideSharingLayout=553]="selectSideBySideSharingLayout",e[e.selectStandoutSharingLayout=554]="selectStandoutSharingLayout",e[e.selectWeatherPersonSharingLayout=555]="selectWeatherPersonSharingLayout",e[e.selectCameoSharingLayout=556]="selectCameoSharingLayout",e[e.selectWhiteboardScreen=557]="selectWhiteboardScreen",e[e.sendBreakoutRoomAnnouncementDialog=558]="sendBreakoutRoomAnnouncementDialog",e[e.sendButton=559]="sendButton",e[e.sendToHardwareOutDeviceButton=560]="sendToHardwareOutDeviceButton",e[e.serpAllCarouselArrow=561]="serpAllCarouselArrow",e[e.serpAnswer=562]="serpAnswer",e[e.serpFeedback=563]="serpFeedback",e[e.serpFilterClearAll=564]="serpFilterClearAll",e[e.serpFilters=565]="serpFilters",e[e.serpHeader=566]="serpHeader",e[e.serpHeaderAll=567]="serpHeaderAll",e[e.serpHeaderApps=568]="serpHeaderApps",e[e.serpHeaderEmails=569]="serpHeaderEmails",e[e.serpHeaderFiles=570]="serpHeaderFiles",e[e.serpHeaderMessages=571]="serpHeaderMessages",e[e.serpHeaderPeople=572]="serpHeaderPeople",e[e.serpHoverActions=573]="serpHoverActions",e[e.serpItem=574]="serpItem",e[e.serpItemChannelMessages=575]="serpItemChannelMessages",e[e.serpItemChatMessages=576]="serpItemChatMessages",e[e.serpItemEmail=577]="serpItemEmail",e[e.serpItemFiles=578]="serpItemFiles",e[e.serpItemMessages=579]="serpItemMessages",e[e.serpItemPeople=580]="serpItemPeople",e[e.serpPagination=581]="serpPagination",e[e.serpRelevanceFilterAction=582]="serpRelevanceFilterAction",e[e.serpSeeMoreButton=583]="serpSeeMoreButton",e[e.serpSpeller=584]="serpSpeller",e[e.setDeliveryOptions=585]="setDeliveryOptions",e[e.setLayoutButton=586]="setLayoutButton",e[e.settingOption=587]="settingOption",e[e.settingsApp=588]="settingsApp",e[e.settingsTabButton=589]="settingsTabButton",e[e.shareBrowserTab=590]="shareBrowserTab",e[e.shareContentCamera=591]="shareContentCamera",e[e.shareDesktop=592]="shareDesktop",e[e.shareExtensibleApp=593]="shareExtensibleApp",e[e.shareInvisionWhiteboard=594]="shareInvisionWhiteboard",e[e.shareMSFTWhiteboard=595]="shareMSFTWhiteboard",e[e.sharePowerPointFileFromComputer=596]="sharePowerPointFileFromComputer",e[e.sharePowerPointFileFromOneDrive=597]="sharePowerPointFileFromOneDrive",e[e.sharePowerPointFileFromTray=598]="sharePowerPointFileFromTray",e[e.shareRecordingEntryPoint=599]="shareRecordingEntryPoint",e[e.shareRecordingMoreActions=600]="shareRecordingMoreActions",e[e.shareRecordingWithCompany=601]="shareRecordingWithCompany",e[e.shareRequestControlButton=602]="shareRequestControlButton",e[e.shareScreen=603]="shareScreen",e[e.shareStopControlButton=604]="shareStopControlButton",e[e.shareToOutlook=605]="shareToOutlook",e[e.shareToTeamsSubmissionButton=606]="shareToTeamsSubmissionButton",e[e.shareTrayPreviewButton=607]="shareTrayPreviewButton",e[e.shareTrayScanAgainButton=608]="shareTrayScanAgainButton",e[e.shareViaEmailButton=609]="shareViaEmailButton",e[e.shareViaGmailButton=610]="shareViaGmailButton",e[e.shareViaGoogleCalendarButton=611]="shareViaGoogleCalendarButton",e[e.shareViaOutlookButton=612]="shareViaOutlookButton",e[e.shareViaOutlookCalendarButton=613]="shareViaOutlookCalendarButton",e[e.shareWindow=614]="shareWindow",e[e.showAboutTabDialogButton=615]="showAboutTabDialogButton",e[e.showCollaborativeAgenda=616]="showCollaborativeAgenda",e[e.showConversationButton=617]="showConversationButton",e[e.showD365DialogButton=618]="showD365DialogButton",e[e.showHiddenChatHistoryButton=619]="showHiddenChatHistoryButton",e[e.showMeetingNotesButton=620]="showMeetingNotesButton",e[e.showMoreActionsButton=621]="showMoreActionsButton",e[e.showParticipantActions=622]="showParticipantActions",e[e.showParticipantActionsFromSearch=623]="showParticipantActionsFromSearch",e[e.showReactionButton=624]="showReactionButton",e[e.showTranscriptPanelButton=625]="showTranscriptPanelButton",e[e.showTypingIndicator=626]="showTypingIndicator",e[e.signInButton=627]="signInButton",e[e.signInCard=628]="signInCard",e[e.signOut=629]="signOut",e[e.singleLayout=630]="singleLayout",e[e.singleLayoutTemplate=631]="singleLayoutTemplate",e[e.smallShareInviteButton=632]="smallShareInviteButton",e[e.smartReplyButton=633]="smartReplyButton",e[e.sortFilesByName=634]="sortFilesByName",e[e.sortFilesBySender=635]="sortFilesBySender",e[e.sortFilesByShareDate=636]="sortFilesByShareDate",e[e.sortFilesByType=637]="sortFilesByType",e[e.speedyMeetingOptionsClick=638]="speedyMeetingOptionsClick",e[e.splashScreenEmptyStateMeetNowButton=639]="splashScreenEmptyStateMeetNowButton",e[e.splashScreenEmptyStateMobileLinkButton=640]="splashScreenEmptyStateMobileLinkButton",e[e.splashScreenEmptyStateNewChatButton=641]="splashScreenEmptyStateNewChatButton",e[e.splashScreenEmptyStateNewGroupChatButton=642]="splashScreenEmptyStateNewGroupChatButton",e[e.spotlightParticipant=643]="spotlightParticipant",e[e.spotlightParticipantFromSearch=644]="spotlightParticipantFromSearch",e[e.stageViews=645]="stageViews",e[e.starRating=646]="starRating",e[e.startBroadcastButton=647]="startBroadcastButton",e[e.startChatFromParticipants=648]="startChatFromParticipants",e[e.startRecording=649]="startRecording",e[e.startTranscribingButton=650]="startTranscribingButton",e[e.stopAllSpotlightsButton=651]="stopAllSpotlightsButton",e[e.stopBroadcastButton=652]="stopBroadcastButton",e[e.stopMeetingButton=653]="stopMeetingButton",e[e.stopPresentingMSFTWhiteboard=654]="stopPresentingMSFTWhiteboard",e[e.stopPresentingPowerPointFile=655]="stopPresentingPowerPointFile",e[e.stopRecording=656]="stopRecording",e[e.stopShareContent=657]="stopShareContent",e[e.stopShareRecordingWithCompany=658]="stopShareRecordingWithCompany",e[e.stopSharingContent=659]="stopSharingContent",e[e.stopSpotlightButton=660]="stopSpotlightButton",e[e.stopTranscribingButton=661]="stopTranscribingButton",e[e.stopVideoButton=662]="stopVideoButton",e[e.store=663]="store",e[e.storeBanner=664]="storeBanner",e[e.storeCollection=665]="storeCollection",e[e.storeFilter=666]="storeFilter",e[e.storeProvider=667]="storeProvider",e[e.storeSearch=668]="storeSearch",e[e.streamPolicyAccepted=669]="streamPolicyAccepted",e[e.streamPolicyCancel=670]="streamPolicyCancel",e[e.submitButton=671]="submitButton",e[e.submitDeleteRecording=672]="submitDeleteRecording",e[e.submitDialogButton=673]="submitDialogButton",e[e.supervisorMessageDelete=674]="supervisorMessageDelete",e[e.supervisorMessageUndoDelete=675]="supervisorMessageUndoDelete",e[e.surprised=676]="surprised",e[e.switchLanguageConfirmButton=677]="switchLanguageConfirmButton",e[e.switchLanguageDenyButton=678]="switchLanguageDenyButton",e[e.syncingEventCardClick=679]="syncingEventCardClick",e[e.systemAudioCheckbox=680]="systemAudioCheckbox",e[e.tab=681]="tab",e[e.tabBackButtonClick=682]="tabBackButtonClick",e[e.tabMenuSettings=683]="tabMenuSettings",e[e.tabRemoveCancelClick=684]="tabRemoveCancelClick",e[e.tabRemoveClick=685]="tabRemoveClick",e[e.tabSaveClick=686]="tabSaveClick",e[e.takeControlButton=687]="takeControlButton",e[e.teamActionMenuItem=688]="teamActionMenuItem",e[e.teamAvatarEditButton=689]="teamAvatarEditButton",e[e.teamCardButton=690]="teamCardButton",e[e.teamChannelListHeaderActionMenuItem=691]="teamChannelListHeaderActionMenuItem",e[e.teamCode=692]="teamCode",e[e.teamListMenuItem=693]="teamListMenuItem",e[e.teamPicture=694]="teamPicture",e[e.teamsHeaderGoToTeamsMenuItem=695]="teamsHeaderGoToTeamsMenuItem",e[e.teamsHeaderReportProblemMenuItem=696]="teamsHeaderReportProblemMenuItem",e[e.teamsHeaderThirdPartyNoticeMenuItem=697]="teamsHeaderThirdPartyNoticeMenuItem",e[e.tflSMSParticipantName=698]="tflSMSParticipantName",e[e.thirdPartyNoticeLink=699]="thirdPartyNoticeLink",e[e.thumbnailCard=700]="thumbnailCard",e[e.timeZoneIndicatorButton=701]="timeZoneIndicatorButton",e[e.togetherModeSetupButton=702]="togetherModeSetupButton",e[e.toggleAutoAdjustFilter=703]="toggleAutoAdjustFilter",e[e.toggleBackgroundBlur=704]="toggleBackgroundBlur",e[e.toggleCamera=705]="toggleCamera",e[e.toggleDevices=706]="toggleDevices",e[e.toggleMic=707]="toggleMic",e[e.toggleScd=708]="toggleScd",e[e.toggleTabConversation=709]="toggleTabConversation",e[e.touchUpSlider=710]="touchUpSlider",e[e.touchUpToggle=711]="touchUpToggle",e[e.transcriptGoToCurrentButton=712]="transcriptGoToCurrentButton",e[e.transcriptGoToVoiceEnrollmentButton=713]="transcriptGoToVoiceEnrollmentButton",e[e.transcriptMessage=714]="transcriptMessage",e[e.transferButton=715]="transferButton",e[e.translateMessage=716]="translateMessage",e[e.twoLargeLeftLayoutContent=717]="twoLargeLeftLayoutContent",e[e.twoLargeLeftLayoutTemplate=718]="twoLargeLeftLayoutTemplate",e[e.twoLargeLeftLayoutVideo=719]="twoLargeLeftLayoutVideo",e[e.typingMessage=720]="typingMessage",e[e.ufd=721]="ufd",e[e.ufdActionButton=722]="ufdActionButton",e[e.ufdDismissButton=723]="ufdDismissButton",e[e.unblockConversation=724]="unblockConversation",e[e.unifiedSearchSelection=725]="unifiedSearchSelection",e[e.unknownCard=726]="unknownCard",e[e.unMute=727]="unMute",e[e.unrestrictParticipantAudio=728]="unrestrictParticipantAudio",e[e.unSaveMessage=729]="unSaveMessage",e[e.updateSystemAudioDriver=730]="updateSystemAudioDriver",e[e.uploadFromPcButton=731]="uploadFromPcButton",e[e.upToEdit=732]="upToEdit",e[e.urlPreview=733]="urlPreview",e[e.useAnotherAccount=734]="useAnotherAccount",e[e.videoEffectsButton=735]="videoEffectsButton",e[e.videoFilterItem=736]="videoFilterItem",e[e.videoOff=737]="videoOff",e[e.videoOn=738]="videoOn",e[e.videoPagination=739]="videoPagination",e[e.videoPlayer=740]="videoPlayer",e[e.videoPlayerPreview=741]="videoPlayerPreview",e[e.videoPlayerPreviewOverflow=742]="videoPlayerPreviewOverflow",e[e.videoRecorder=743]="videoRecorder",e[e.viewBackgroundEffects=744]="viewBackgroundEffects",e[e.viewCalendar=745]="viewCalendar",e[e.viewCallHealthPanel=746]="viewCallHealthPanel",e[e.viewerChangeSlide=747]="viewerChangeSlide",e[e.viewerReturnToPresenter=748]="viewerReturnToPresenter",e[e.viewFreemiumCalendar=749]="viewFreemiumCalendar",e[e.viewLobby=750]="viewLobby",e[e.viewLocation=751]="viewLocation",e[e.viewMeeting=752]="viewMeeting",e[e.vivaEmf=753]="vivaEmf",e[e.voiceCaptureFooter=754]="voiceCaptureFooter",e[e.voicemailAudio=755]="voicemailAudio",e[e.whiteboardButton=756]="whiteboardButton"}(l||(l={})),function(e){e[e.asyncStateChange=0]="asyncStateChange",e[e.auto=1]="auto",e[e.click=2]="click",e[e.ctrlScroll=3]="ctrlScroll",e[e.dragAndDrop=4]="dragAndDrop",e[e.hover=5]="hover",e[e.kbshort=6]="kbshort",e[e.keypress=7]="keypress",e[e.longTap=8]="longTap",e[e.mouseleave=9]="mouseleave",e[e.open=10]="open",e[e.rightClick=11]="rightClick",e[e.rotate=12]="rotate",e[e.scroll=13]="scroll",e[e.select=14]="select",e[e.show=15]="show",e[e.swipe=16]="swipe",e[e.tap=17]="tap",e[e.toggle=18]="toggle",e[e.touchbarClick=19]="touchbarClick"}(c||(c={})),function(e){e[e.addWebsiteTab=0]="addWebsiteTab",e[e.applyVideoEffects=1]="applyVideoEffects",e[e.bannerClick=2]="bannerClick",e[e.blockContact=3]="blockContact",e[e.breakoutRoomAssignmentConfirm=4]="breakoutRoomAssignmentConfirm",e[e.breakoutRoomAssignmentDismiss=5]="breakoutRoomAssignmentDismiss",e[e.breakoutRoomsAddingRoom=6]="breakoutRoomsAddingRoom",e[e.breakoutRoomsAskingToJoin=7]="breakoutRoomsAskingToJoin",e[e.breakoutRoomsAssignmentSort=8]="breakoutRoomsAssignmentSort",e[e.breakoutRoomsClosingAll=9]="breakoutRoomsClosingAll",e[e.breakoutRoomsClosingRoom=10]="breakoutRoomsClosingRoom",e[e.breakoutRoomsCreatingRooms=11]="breakoutRoomsCreatingRooms",e[e.breakoutRoomsDeletingRoom=12]="breakoutRoomsDeletingRoom",e[e.breakoutRoomsJoiningRoom=13]="breakoutRoomsJoiningRoom",e[e.breakoutRoomsOpeningAll=14]="breakoutRoomsOpeningAll",e[e.breakoutRoomsOpeningRoom=15]="breakoutRoomsOpeningRoom",e[e.breakoutRoomsRecreatingRooms=16]="breakoutRoomsRecreatingRooms",e[e.breakoutRoomsRenamingRoom=17]="breakoutRoomsRenamingRoom",e[e.breakoutRoomsShowAssignmentDialog=18]="breakoutRoomsShowAssignmentDialog",e[e.breakoutRoomsTakingControl=19]="breakoutRoomsTakingControl",e[e.cancel=20]="cancel",e[e.cancelEndMeetingForAll=21]="cancelEndMeetingForAll",e[e.cancelFaceEnrollment=22]="cancelFaceEnrollment",e[e.cancelJoinMeeting=23]="cancelJoinMeeting",e[e.cancelRequestControl=24]="cancelRequestControl",e[e.cancelSelection=25]="cancelSelection",e[e.cancelStopRecording=26]="cancelStopRecording",e[e.cancelVoiceEnrollment=27]="cancelVoiceEnrollment",e[e.changeReaction=28]="changeReaction",e[e.chooseFileOsDialog=29]="chooseFileOsDialog",e[e.clear=30]="clear",e[e.closeChatListFilter=31]="closeChatListFilter",e[e.closeConversation=32]="closeConversation",e[e.closeDialog=33]="closeDialog",e[e.closePanel=34]="closePanel",e[e.closeVideoEffectsApp=35]="closeVideoEffectsApp",e[e.closeVideoEffectsQuickPicker=36]="closeVideoEffectsQuickPicker",e[e.collapseMoreVideoEffects=37]="collapseMoreVideoEffects",e[e.confirm=38]="confirm",e[e.copy=39]="copy",e[e.cqfHide=40]="cqfHide",e[e.cqfShow=41]="cqfShow",e[e.cqfTimeout=42]="cqfTimeout",e[e.delete=43]="delete",e[e.disable=44]="disable",e[e.disconnectFromCall=45]="disconnectFromCall",e[e.dismiss=46]="dismiss",e[e.dismissBanner=47]="dismissBanner",e[e.displayOverflowMenu=48]="displayOverflowMenu",e[e.download=49]="download",e[e.editInTeams=50]="editInTeams",e[e.editTranscriptInMeeting=51]="editTranscriptInMeeting",e[e.editTranscriptPostMeeting=52]="editTranscriptPostMeeting",e[e.enable=53]="enable",e[e.endCall=54]="endCall",e[e.errorMessage=55]="errorMessage",e[e.espButtonOutcome=56]="espButtonOutcome",e[e.expandMoreVideoEffects=57]="expandMoreVideoEffects",e[e.filterFeeds=58]="filterFeeds",e[e.filterChatList=59]="filterChatList",e[e.getAllVideoBackgrounds=60]="getAllVideoBackgrounds",e[e.getAllVideoFilters=61]="getAllVideoFilters",e[e.grant=62]="grant",e[e.hide=63]="hide",e[e.incomingVideoStarted=64]="incomingVideoStarted",e[e.incomingVideoStopped=65]="incomingVideoStopped",e[e.info=66]="info",e[e.inputFocused=67]="inputFocused",e[e.inspect=68]="inspect",e[e.invoke=69]="invoke",e[e.joinMeeting=70]="joinMeeting",e[e.joinMeetingWithComputerAudio=71]="joinMeetingWithComputerAudio",e[e.joinMeetingWithNoAudio=72]="joinMeetingWithNoAudio",e[e.joinMeetingWithPhoneAudio=73]="joinMeetingWithPhoneAudio",e[e.joinMeetingWithRoomAudio=74]="joinMeetingWithRoomAudio",e[e.launch=75]="launch",e[e.launchTeams=76]="launchTeams",e[e.learnMoreAboutD365=77]="learnMoreAboutD365",e[e.login=78]="login",e[e.msaNameEdited=79]="msaNameEdited",e[e.nav=80]="nav",e[e.navigateToPanel=81]="navigateToPanel",e[e.none=82]="none",e[e.notificationMutedInMeeting=83]="notificationMutedInMeeting",e[e.notificationUnmutedInMeeting=84]="notificationUnmutedInMeeting",e[e.open=85]="open",e[e.openCallHealthSecondaryScreen=86]="openCallHealthSecondaryScreen",e[e.openChatListFilter=87]="openChatListFilter",e[e.openConversation=88]="openConversation",e[e.openD365PromoOfferPage=89]="openD365PromoOfferPage",e[e.openDefaultD365Org=90]="openDefaultD365Org",e[e.openDialog=91]="openDialog",e[e.openInBrowser=92]="openInBrowser",e[e.openInDesktop=93]="openInDesktop",e[e.openInTeams=94]="openInTeams",e[e.openMeetNowFlyout=95]="openMeetNowFlyout",e[e.openMobileDownload=96]="openMobileDownload",e[e.openMoreActionsMenu=97]="openMoreActionsMenu",e[e.openMoreActionsMenuItem=98]="openMoreActionsMenuItem",e[e.openNewChat=99]="openNewChat",e[e.openNewGroupChat=100]="openNewGroupChat",e[e.openPanel=101]="openPanel",e[e.openPopup=102]="openPopup",e[e.openSelectedD365Org=103]="openSelectedD365Org",e[e.openVideoEffectsApp=104]="openVideoEffectsApp",e[e.openVideoEffectsQuickPicker=105]="openVideoEffectsQuickPicker",e[e.openVoiceEnrollmentLink=106]="openVoiceEnrollmentLink",e[e.openWebPage=107]="openWebPage",e[e.pause=108]="pause",e[e.pinMyself=109]="pinMyself",e[e.hideMyself=110]="hideMyself",e[e.pinParticipant=111]="pinParticipant",e[e.play=112]="play",e[e.primary=113]="primary",e[e.profilePictureRemoved=114]="profilePictureRemoved",e[e.profilePictureUploaded=115]="profilePictureUploaded",e[e.ptzRemoteCameraUserRequestControl=116]="ptzRemoteCameraUserRequestControl",e[e.ptzRemoteCameraUserSessionTerminatedNotification=117]="ptzRemoteCameraUserSessionTerminatedNotification",e[e.read=118]="read",e[e.reload=119]="reload",e[e.removeChiclet=120]="removeChiclet",e[e.retry=121]="retry",e[e.rosterParticipantsSearchQueryChanged=122]="rosterParticipantsSearchQueryChanged",e[e.rosterParticipantsSearchQueryCleared=123]="rosterParticipantsSearchQueryCleared",e[e.scroll=124]="scroll",e[e.search=125]="search",e[e.secondary=126]="secondary",e[e.select=127]="select",e[e.selectVideoFilter=128]="selectVideoFilter",e[e.send=129]="send",e[e.setScalingMode=130]="setScalingMode",e[e.setSliderValue=131]="setSliderValue",e[e.show=132]="show",e[e.showBanner=133]="showBanner",e[e.showDialog=134]="showDialog",e[e.showHiddenChatHistory=135]="showHiddenChatHistory",e[e.showPrompt=136]="showPrompt",e[e.showVivaMeetingHabits=137]="showVivaMeetingHabits",e[e.signOut=138]="signOut",e[e.spotlight=139]="spotlight",e[e.spotlightSelf=140]="spotlightSelf",e[e.startFaceEnrollment=141]="startFaceEnrollment",e[e.startFileUpload=142]="startFileUpload",e[e.startPlayback=143]="startPlayback",e[e.startPreviewVideo=144]="startPreviewVideo",e[e.startVoiceEnrollment=145]="startVoiceEnrollment",e[e.stopFaceEnrollment=146]="stopFaceEnrollment",e[e.stopPlayback=147]="stopPlayback",e[e.stopPreviewVideo=148]="stopPreviewVideo",e[e.stopRecording=149]="stopRecording",e[e.stopSpotlight=150]="stopSpotlight",e[e.stopSpotlightSelf=151]="stopSpotlightSelf",e[e.stopVoiceEnrollment=152]="stopVoiceEnrollment",e[e.submit=153]="submit",e[e.thanksScreen=154]="thanksScreen",e[e.togetherModeSeatAssignment=155]="togetherModeSeatAssignment",e[e.toggle=156]="toggle",e[e.togglePanoVideo=157]="togglePanoVideo",e[e.toggleSelection=158]="toggleSelection",e[e.turnOff=159]="turnOff",e[e.turnOn=160]="turnOn",e[e.ufdActionTaken=161]="ufdActionTaken",e[e.ufdDismissed=162]="ufdDismissed",e[e.ufdHide=163]="ufdHide",e[e.ufdShow=164]="ufdShow",e[e.unblockContact=165]="unblockContact",e[e.unhideMyself=166]="unhideMyself",e[e.unpinMyself=167]="unpinMyself",e[e.unpinParticipant=168]="unpinParticipant",e[e.unselect=169]="unselect",e[e.unselectReaction=170]="unselectReaction",e[e.unsupportedCardAction=171]="unsupportedCardAction",e[e.updateMeetingTitle=172]="updateMeetingTitle"}(d||(d={})),function(e){e[e.aboutApp=0]="aboutApp",e[e.actionExecuteCacheReadTime=1]="actionExecuteCacheReadTime",e[e.actionExecuteInvokeResponse=2]="actionExecuteInvokeResponse",e[e.activityListMarkRead=3]="activityListMarkRead",e[e.activityListMarkUnread=4]="activityListMarkUnread",e[e.addActiveCall=5]="addActiveCall",e[e.addAppDialog=6]="addAppDialog",e[e.addAppInline=7]="addAppInline",e[e.addAppInlineCancel=8]="addAppInlineCancel",e[e.addChannel=9]="addChannel",e[e.addChatConfirm=10]="addChatConfirm",e[e.addEntireClass=11]="addEntireClass",e[e.addEntireClassCancelOverrideAttendees=12]="addEntireClassCancelOverrideAttendees",e[e.addEntireClassConfirmOverrideAttendees=13]="addEntireClassConfirmOverrideAttendees",e[e.addEntireClassInProgressCancel=14]="addEntireClassInProgressCancel",e[e.addFirstAttendeeToMeeting=15]="addFirstAttendeeToMeeting",e[e.addMeetingAppFlyout=16]="addMeetingAppFlyout",e[e.addMember=17]="addMember",e[e.addPlatformAppTab=18]="addPlatformAppTab",e[e.addTabButton=19]="addTabButton",e[e.adminPreInstalledAppClick=20]="adminPreInstalledAppClick",e[e.admitAll=21]="admitAll",e[e.admitParticipant=22]="admitParticipant",e[e.admitParticipantFromSearch=23]="admitParticipantFromSearch",e[e.agendaViewJoinMeetingClick=24]="agendaViewJoinMeetingClick",e[e.agendaViewLoad=25]="agendaViewLoad",e[e.agendaViewMeetingOptionsLinkClick=26]="agendaViewMeetingOptionsLinkClick",e[e.agendaViewRSVPMeetingClick=27]="agendaViewRSVPMeetingClick",e[e.aliasDiscoverabilitySettingOpened=28]="aliasDiscoverabilitySettingOpened",e[e.allowAttendeesToUnmute=29]="allowAttendeesToUnmute",e[e.allowAttendeeToUnmute=30]="allowAttendeeToUnmute",e[e.allVideoBackgrounds=31]="allVideoBackgrounds",e[e.allVideoFilters=32]="allVideoFilters",e[e.appAuthDialog=33]="appAuthDialog",e[e.appLogout=34]="appLogout",e[e.applyCustomVideoBackground=35]="applyCustomVideoBackground",e[e.applyVideoEffectsTurnOnCamera=36]="applyVideoEffectsTurnOnCamera",e[e.appPin=37]="appPin",e[e.appProfileCardAppear=38]="appProfileCardAppear",e[e.appProfileCardCall=39]="appProfileCardCall",e[e.appProfileCardChat=40]="appProfileCardChat",e[e.appProfileCardQuickIM=41]="appProfileCardQuickIM",e[e.appToForeground=42]="appToForeground",e[e.appUnpin=43]="appUnpin",e[e.archiveTeam=44]="archiveTeam",e[e.attachFileReference=45]="attachFileReference",e[e.attachFromPC=46]="attachFromPC",e[e.attemptedClickOnPassiveElement=47]="attemptedClickOnPassiveElement",e[e.attendanceReport=48]="attendanceReport",e[e.attendanceReportV3=49]="attendanceReportV3",e[e.attendanceReportWebinar=50]="attendanceReportWebinar",e[e.audioCardPlaybackPaused=51]="audioCardPlaybackPaused",e[e.audioCardPlaybackStarted=52]="audioCardPlaybackStarted",e[e.audioCardRetry=53]="audioCardRetry",e[e.authLoginAccount=54]="authLoginAccount",e[e.authLogoutAccount=55]="authLogoutAccount",e[e.authPrompt=56]="authPrompt",e[e.authUseWorkAccountLink=57]="authUseWorkAccountLink",e[e.bannerAction=58]="bannerAction",e[e.bannerShow=59]="bannerShow",e[e.bannerDismiss=60]="bannerDismiss",e[e.backToTabGallery=61]="backToTabGallery",e[e.blockContact=62]="blockContact",e[e.botClickCardAction=63]="botClickCardAction",e[e.botDismissActionContentBubble=64]="botDismissActionContentBubble",e[e.breakoutRoomAnnouncement=65]="breakoutRoomAnnouncement",e[e.breakoutRoomAssignment=66]="breakoutRoomAssignment",e[e.breakoutRoomRecreate=67]="breakoutRoomRecreate",e[e.breakoutRoomsAddRoom=68]="breakoutRoomsAddRoom",e[e.breakoutRoomsAssignmentType=69]="breakoutRoomsAssignmentType",e[e.breakoutRoomsAskToJoin=70]="breakoutRoomsAskToJoin",e[e.breakoutRoomsCancelCreateRoomsWaitingScreen=71]="breakoutRoomsCancelCreateRoomsWaitingScreen",e[e.breakoutRoomsCancelDeleteRoom=72]="breakoutRoomsCancelDeleteRoom",e[e.breakoutRoomsCancelRecreateRooms=73]="breakoutRoomsCancelRecreateRooms",e[e.breakoutRoomsCancelRenameRoom=74]="breakoutRoomsCancelRenameRoom",e[e.breakoutRoomsCancelRoomsCreation=75]="breakoutRoomsCancelRoomsCreation",e[e.breakoutRoomsCloseAll=76]="breakoutRoomsCloseAll",e[e.breakoutRoomsClosePanel=77]="breakoutRoomsClosePanel",e[e.breakoutRoomsCloseRoom=78]="breakoutRoomsCloseRoom",e[e.breakoutRoomsCopyMeetingLink=79]="breakoutRoomsCopyMeetingLink",e[e.breakoutRoomsCreateRooms=80]="breakoutRoomsCreateRooms",e[e.breakoutRoomsDeleteRoom=81]="breakoutRoomsDeleteRoom",e[e.breakoutRoomSettings=82]="breakoutRoomSettings",e[e.breakoutRoomsJoinRoom=83]="breakoutRoomsJoinRoom",e[e.breakoutRoomsNavigateToMeetingOptionsPage=84]="breakoutRoomsNavigateToMeetingOptionsPage",e[e.breakoutRoomsOpenAll=85]="breakoutRoomsOpenAll",e[e.breakoutRoomsOpenDeleteRoomDialog=86]="breakoutRoomsOpenDeleteRoomDialog",e[e.breakoutRoomsOpenRenameRoomDialog=87]="breakoutRoomsOpenRenameRoomDialog",e[e.breakoutRoomsOpenRoom=88]="breakoutRoomsOpenRoom",e[e.breakoutRoomsRecreateRooms=89]="breakoutRoomsRecreateRooms",e[e.breakoutRoomsRenameRoom=90]="breakoutRoomsRenameRoom",e[e.breakoutRoomsTakeControl=91]="breakoutRoomsTakeControl",e[e.breakoutRoomsTooManyParticipants=92]="breakoutRoomsTooManyParticipants",e[e.calendarAddToCalendar=93]="calendarAddToCalendar",e[e.calendarAttachmentChicletOptionSelected=94]="calendarAttachmentChicletOptionSelected",e[e.calendarCancelEvent=95]="calendarCancelEvent",e[e.calendarCategorizeEvent=96]="calendarCategorizeEvent",e[e.calendarCloseSchedulingFormCreateMode=97]="calendarCloseSchedulingFormCreateMode",e[e.calendarCloseSchedulingFormEditMode=98]="calendarCloseSchedulingFormEditMode",e[e.calendarCloseSchedulingFormViewMode=99]="calendarCloseSchedulingFormViewMode",e[e.calendarCopyMeetingLinkClick=100]="calendarCopyMeetingLinkClick",e[e.calendarCreateEvent=101]="calendarCreateEvent",e[e.calendarCreateWebinarEvent=102]="calendarCreateWebinarEvent",e[e.calendarDeleteEvent=103]="calendarDeleteEvent",e[e.calendarEventCardClick=104]="calendarEventCardClick",e[e.calendarEventCardClickJoin=105]="calendarEventCardClickJoin",e[e.calendarEventCardPeekChatWithParticipants=106]="calendarEventCardPeekChatWithParticipants",e[e.calendarEventCardPeekClickJoin=107]="calendarEventCardPeekClickJoin",e[e.calendarEventCardPeekClickJoinUrl=108]="calendarEventCardPeekClickJoinUrl",e[e.calendarEventCardPeekCopyUrl=109]="calendarEventCardPeekCopyUrl",e[e.calendarEventCardPeekEditEvent=110]="calendarEventCardPeekEditEvent",e[e.calendarEventCardPeekExpand=111]="calendarEventCardPeekExpand",e[e.calendarEventCardPeekOpen=112]="calendarEventCardPeekOpen",e[e.calendarEventCardPeekRemoveEvent=113]="calendarEventCardPeekRemoveEvent",e[e.calendarEventCardPeekRSVPEvent=114]="calendarEventCardPeekRSVPEvent",e[e.calendarEventCardRightClickAction=115]="calendarEventCardRightClickAction",e[e.calendarEventCardRightClickJoin=116]="calendarEventCardRightClickJoin",e[e.calendarEventMangerSyncEventRemoval=117]="calendarEventMangerSyncEventRemoval",e[e.calendarExtendedTabRightClickAction=118]="calendarExtendedTabRightClickAction",e[e.calendarFileRecommendationClicked=119]="calendarFileRecommendationClicked",e[e.calendarFileRecommendationSeeMoreClicked=120]="calendarFileRecommendationSeeMoreClicked",e[e.calendarFileRecommendationShown=121]="calendarFileRecommendationShown",e[e.calendarForwardEvent=122]="calendarForwardEvent",e[e.calendarLoad=123]="calendarLoad",e[e.calendarMeetingObjectValidation=124]="calendarMeetingObjectValidation",e[e.calendarMeetingOptionsClick=125]="calendarMeetingOptionsClick",e[e.calendarNavigateToNext=126]="calendarNavigateToNext",e[e.calendarNavigateToPrev=127]="calendarNavigateToPrev",e[e.calendarNavigateToToday=128]="calendarNavigateToToday",e[e.calendarNavigateUsingDatePicker=129]="calendarNavigateUsingDatePicker",e[e.calendarOpenCreateMeetingDialog=130]="calendarOpenCreateMeetingDialog",e[e.calendarOpenInGoogleCalendarClick=131]="calendarOpenInGoogleCalendarClick",e[e.calendarOpenSchedulingFormCreateMode=132]="calendarOpenSchedulingFormCreateMode",e[e.calendarOpenSchedulingFormEditMode=133]="calendarOpenSchedulingFormEditMode",e[e.calendarOpenSchedulingFormViewMode=134]="calendarOpenSchedulingFormViewMode",e[e.calendarRemoveFromCalendar=135]="calendarRemoveFromCalendar",e[e.calendarRSVP=136]="calendarRSVP",e[e.calendarSchedulingFormCopyLink=137]="calendarSchedulingFormCopyLink",e[e.calendarSchedulingFormJoin=138]="calendarSchedulingFormJoin",e[e.calendarSettingsConnectGoogleCalendarClick=139]="calendarSettingsConnectGoogleCalendarClick",e[e.calendarSettingsConnectOutlookCalendarClick=140]="calendarSettingsConnectOutlookCalendarClick",e[e.calendarSettingsDisconnectGoogleCalendarClick=141]="calendarSettingsDisconnectGoogleCalendarClick",e[e.calendarShareLinkDialogClose=142]="calendarShareLinkDialogClose",e[e.calendarShareLinkDialogOpen=143]="calendarShareLinkDialogOpen",e[e.calendarShowAsEvent=144]="calendarShowAsEvent",e[e.calendarSpeedyMeetingOptionsSelected=145]="calendarSpeedyMeetingOptionsSelected",e[e.calendarSwitchView=146]="calendarSwitchView",e[e.calendarSyncingEventCardClick=147]="calendarSyncingEventCardClick",e[e.calendarTabsClickAction=148]="calendarTabsClickAction",e[e.calendarUpdateEvent=149]="calendarUpdateEvent",e[e.call=150]="call",e[e.callAddParticipant=151]="callAddParticipant",e[e.callAudio=152]="callAudio",e[e.callBlindTransfer=153]="callBlindTransfer",e[e.callConsultTransfer=154]="callConsultTransfer",e[e.callHealthViewMore=155]="callHealthViewMore",e[e.callHideMeetingDetailsPanel=156]="callHideMeetingDetailsPanel",e[e.callHideMeetingInfoPanel=157]="callHideMeetingInfoPanel",e[e.callMeBack=158]="callMeBack",e[e.callMuteAudio=159]="callMuteAudio",e[e.callOpenSettings=160]="callOpenSettings",e[e.callOrMeetupToggleCustomVideoBackgrounds=161]="callOrMeetupToggleCustomVideoBackgrounds",e[e.callPostEchoBotScreenDismissed=162]="callPostEchoBotScreenDismissed",e[e.callPostEchoBotScreenHideDeviceSetting=163]="callPostEchoBotScreenHideDeviceSetting",e[e.callPostEchoBotScreenShowDeviceSetting=164]="callPostEchoBotScreenShowDeviceSetting",e[e.callSafeTransfer=165]="callSafeTransfer",e[e.callScreenSharingControl=166]="callScreenSharingControl",e[e.callShowConversation=167]="callShowConversation",e[e.callShowMeetingDetailsPanel=168]="callShowMeetingDetailsPanel",e[e.callShowMeetingHelp=169]="callShowMeetingHelp",e[e.callShowMeetingInfo=170]="callShowMeetingInfo",e[e.callShowMeetingInfoPanel=171]="callShowMeetingInfoPanel",e[e.callShowMoreActions=172]="callShowMoreActions",e[e.callShowReactions=173]="callShowReactions",e[e.callStartClosedCaptions=174]="callStartClosedCaptions",e[e.callStartIncomingVideo=175]="callStartIncomingVideo",e[e.callStartMeetingCoach=176]="callStartMeetingCoach",e[e.callStartVideo=177]="callStartVideo",e[e.callStopClosedCaptions=178]="callStopClosedCaptions",e[e.callStopIncomingVideo=179]="callStopIncomingVideo",e[e.callStopMeeting=180]="callStopMeeting",e[e.callStopMeetingCoach=181]="callStopMeetingCoach",e[e.callStopVideo=182]="callStopVideo",e[e.callTransferToVoicemail=183]="callTransferToVoicemail",e[e.callUnmuteAudio=184]="callUnmuteAudio",e[e.callVideo=185]="callVideo",e[e.cancelAllowAttendeesToUnmute=186]="cancelAllowAttendeesToUnmute",e[e.cancelCallingRecordingDeeplink=187]="cancelCallingRecordingDeeplink",e[e.cancelDisableAttendeesCameras=188]="cancelDisableAttendeesCameras",e[e.cancelDontAllowAttendeesToUnmute=189]="cancelDontAllowAttendeesToUnmute",e[e.cancelEditTflSMSParticipantName=190]="cancelEditTflSMSParticipantName",e[e.canceledLowerAllHands=191]="canceledLowerAllHands",e[e.cancelEnableAttendeesCameras=192]="cancelEnableAttendeesCameras",e[e.cancelEndMeetingForAll=193]="cancelEndMeetingForAll",e[e.cancelFaceEnrollment=194]="cancelFaceEnrollment",e[e.cancelFileAttachment=195]="cancelFileAttachment",e[e.cancelNameTflSMSParticipant=196]="cancelNameTflSMSParticipant",e[e.cancelNudgeParticipant=197]="cancelNudgeParticipant",e[e.cancelNudgeParticipantFromSearch=198]="cancelNudgeParticipantFromSearch",e[e.cancelOnPreJoinScreen=199]="cancelOnPreJoinScreen",e[e.cancelRemoveTabForcefully=200]="cancelRemoveTabForcefully",e[e.cancelRetry=201]="cancelRetry",e[e.cancelVoiceEnrollment=202]="cancelVoiceEnrollment",e[e.card_allowFileUpload=203]="card_allowFileUpload",e[e.card_declineFileUpload=204]="card_declineFileUpload",e[e.card_execute=205]="card_execute",e[e.card_imBack=206]="card_imBack",e[e.card_invoke=207]="card_invoke",e[e.card_messageBack=208]="card_messageBack",e[e.card_o365Submit=209]="card_o365Submit",e[e.card_openUrl=210]="card_openUrl",e[e.card_pinTab=211]="card_pinTab",e[e.card_refresh=212]="card_refresh",e[e.card_showCard=213]="card_showCard",e[e.card_signIn=214]="card_signIn",e[e.card_toggleVisibility=215]="card_toggleVisibility",e[e.cardCopy=216]="cardCopy",e[e.cardHeaderInstall=217]="cardHeaderInstall",e[e.changeSetting=218]="changeSetting",e[e.changeTeamPicture=219]="changeTeamPicture",e[e.channelConnectorsDialog=220]="channelConnectorsDialog",e[e.channelNav=221]="channelNav",e[e.channelNavTab=222]="channelNavTab",e[e.chatAddChat=223]="chatAddChat",e[e.chatAddTab=224]="chatAddTab",e[e.chatAllowJoinViaLink=225]="chatAllowJoinViaLink",e[e.chatFilesList=226]="chatFilesList",e[e.chatListNavConversations=227]="chatListNavConversations",e[e.chatNavTab=228]="chatNavTab",e[e.chatShareLink=229]="chatShareLink",e[e.chatTabOverflow=230]="chatTabOverflow",e[e.clearLeftRailFilter=231]="clearLeftRailFilter",e[e.closeApp=232]="closeApp",e[e.closeChatListFilter=233]="closeChatListFilter",e[e.closeD365Dialog=234]="closeD365Dialog",e[e.closeDevicesPanel=235]="closeDevicesPanel",e[e.closeLeftRailFilter=236]="closeLeftRailFilter",e[e.closeLobbyToast=237]="closeLobbyToast",e[e.closePanel=238]="closePanel",e[e.closePrivatePreview=239]="closePrivatePreview",e[e.closeQuickPicker=240]="closeQuickPicker",e[e.closeRosterPanel=241]="closeRosterPanel",e[e.closeVideoEffectApp=242]="closeVideoEffectApp",e[e.closeWindow=243]="closeWindow",e[e.collaborativeAgendaClick=244]="collaborativeAgendaClick",e[e.collaborativeAgendaShown=245]="collaborativeAgendaShown",e[e.collapseMoreVideoEffects=246]="collapseMoreVideoEffects",e[e.collapseSearchResult=247]="collapseSearchResult",e[e.composeAddAttachment=248]="composeAddAttachment",e[e.composeDeliveryOptions=249]="composeDeliveryOptions",e[e.composeDescheduleMessage=250]="composeDescheduleMessage",e[e.composeDiscardAltText=251]="composeDiscardAltText",e[e.composeDiscardCodeSnippet=252]="composeDiscardCodeSnippet",e[e.composeDiscardDraft=253]="composeDiscardDraft",e[e.composeDiscardFluidDraft=254]="composeDiscardFluidDraft",e[e.composeEditCodeSnippet=255]="composeEditCodeSnippet",e[e.composeExpandComposer=256]="composeExpandComposer",e[e.composeFocusFluidMessage=257]="composeFocusFluidMessage",e[e.composeFormatBlockQuote=258]="composeFormatBlockQuote",e[e.composeFormatBold=259]="composeFormatBold",e[e.composeFormatBullet=260]="composeFormatBullet",e[e.composeFormatEndQuote=261]="composeFormatEndQuote",e[e.composeFormatFontColor=262]="composeFormatFontColor",e[e.composeFormatFontSize=263]="composeFormatFontSize",e[e.composeFormatHighlight=264]="composeFormatHighlight",e[e.composeFormatHorizontalRule=265]="composeFormatHorizontalRule",e[e.composeFormatIndent=266]="composeFormatIndent",e[e.composeFormatItalic=267]="composeFormatItalic",e[e.composeFormatList=268]="composeFormatList",e[e.composeFormatOutdent=269]="composeFormatOutdent",e[e.composeFormatParagraph=270]="composeFormatParagraph",e[e.composeFormatRedo=271]="composeFormatRedo",e[e.composeFormatRemove=272]="composeFormatRemove",e[e.composeFormatRichStyle=273]="composeFormatRichStyle",e[e.composeFormatStrikethrough=274]="composeFormatStrikethrough",e[e.composeFormatUnderline=275]="composeFormatUnderline",e[e.composeFormatUndo=276]="composeFormatUndo",e[e.composeHidePlaceholder=277]="composeHidePlaceholder",e[e.composeHighImportance=278]="composeHighImportance",e[e.composeHighPriMessage=279]="composeHighPriMessage",e[e.composeInsertAltText=280]="composeInsertAltText",e[e.composeInsertCodeSnippet=281]="composeInsertCodeSnippet",e[e.composeInsertFluidActionItems=282]="composeInsertFluidActionItems",e[e.composeInsertFluidAgenda=283]="composeInsertFluidAgenda",e[e.composeInsertFluidBulletedList=284]="composeInsertFluidBulletedList",e[e.composeInsertFluidChecklist=285]="composeInsertFluidChecklist",e[e.composeInsertFluidComponent=286]="composeInsertFluidComponent",e[e.composeInsertFluidNumberedList=287]="composeInsertFluidNumberedList",e[e.composeInsertFluidParagraph=288]="composeInsertFluidParagraph",e[e.composeInsertFluidTable=289]="composeInsertFluidTable",e[e.composeInsertTable=290]="composeInsertTable",e[e.composeNormalImportance=291]="composeNormalImportance",e[e.composeOpenCodeSnippet=292]="composeOpenCodeSnippet",e[e.composeOpenFluidPicker=293]="composeOpenFluidPicker",e[e.composeOpenFunPicker=294]="composeOpenFunPicker",e[e.composePasteFluidLink=295]="composePasteFluidLink",e[e.composeRenderEscalationLink=296]="composeRenderEscalationLink",e[e.composeScheduleMessage=297]="composeScheduleMessage",e[e.composeSendMessage=298]="composeSendMessage",e[e.composeUrgentImportance=299]="composeUrgentImportance",e[e.confirmDisableAttendeesCameras=300]="confirmDisableAttendeesCameras",e[e.confirmEditTflSMSParticipantName=301]="confirmEditTflSMSParticipantName",e[e.confirmedLowerAllHands=302]="confirmedLowerAllHands",e[e.confirmEnableAttendeesCameras=303]="confirmEnableAttendeesCameras",e[e.confirmNameTflSMSParticipant=304]="confirmNameTflSMSParticipant",e[e.connectedCalendarCancelClick=305]="connectedCalendarCancelClick",e[e.connectedCalendarConnectClick=306]="connectedCalendarConnectClick",e[e.connectedCalendarDisconnectClick=307]="connectedCalendarDisconnectClick",e[e.contactChange=308]="contactChange",e[e.contactsSync=309]="contactsSync",e[e.contextMenuClick=310]="contextMenuClick",e[e.copyJoinInfo=311]="copyJoinInfo",e[e.copyTabDeepLink=312]="copyTabDeepLink",e[e.copyTeamCode=313]="copyTeamCode",e[e.cqfHide=314]="cqfHide",e[e.cqfShow=315]="cqfShow",e[e.cqfTimeout=316]="cqfTimeout",e[e.createBroadcast=317]="createBroadcast",e[e.createComposeCancel=318]="createComposeCancel",e[e.createTab=319]="createTab",e[e.createTeam=320]="createTeam",e[e.deeplink=321]="deeplink",e[e.deleteChannel=322]="deleteChannel",e[e.deleteRecording=323]="deleteRecording",e[e.deleteTeam=324]="deleteTeam",e[e.denyParticipant=325]="denyParticipant",e[e.denyParticipantFromSearch=326]="denyParticipantFromSearch",e[e.direct=327]="direct",e[e.disableAttendeeCamera=328]="disableAttendeeCamera",e[e.disableAttendeesCameras=329]="disableAttendeesCameras",e[e.disableAutoAdjustFilter=330]="disableAutoAdjustFilter",e[e.disabledTagSettingsSource=331]="disabledTagSettingsSource",e[e.disableFocusMode=332]="disableFocusMode",e[e.disableHighFidelityAudio=333]="disableHighFidelityAudio",e[e.dismiss=334]="dismiss",e[e.dismissNotificationBanner=335]="dismissNotificationBanner",e[e.dismissSystemAudioDriverInstall=336]="dismissSystemAudioDriverInstall",e[e.dismissSystemAudioDriverUpdate=337]="dismissSystemAudioDriverUpdate",e[e.dontAllowAttendeesToUnmute=338]="dontAllowAttendeesToUnmute",e[e.dontAllowAttendeeToUnmute=339]="dontAllowAttendeeToUnmute",e[e.dragTouchUpSliderBar=340]="dragTouchUpSliderBar",e[e.editAvatarCloseDialog=341]="editAvatarCloseDialog",e[e.editAvatarSaveUpdate=342]="editAvatarSaveUpdate",e[e.editChannel=343]="editChannel",e[e.editTab=344]="editTab",e[e.editTeam=345]="editTeam",e[e.editTflSMSParticipantName=346]="editTflSMSParticipantName",e[e.effectivenessRating=347]="effectivenessRating",e[e.enableAttendeeCamera=348]="enableAttendeeCamera",e[e.enableAttendeesCameras=349]="enableAttendeesCameras",e[e.enableAutoAdjustFilter=350]="enableAutoAdjustFilter",e[e.enabledTagSettingsSource=351]="enabledTagSettingsSource",e[e.enableHighFidelityAudio=352]="enableHighFidelityAudio",e[e.enableTogetherMode=353]="enableTogetherMode",e[e.endCallConfirmation=354]="endCallConfirmation",e[e.escalateToTeamsChat=355]="escalateToTeamsChat",e[e.espButton=356]="espButton",e[e.espClose=357]="espClose",e[e.expandAppLink=358]="expandAppLink",e[e.expandMoreVideoEffects=359]="expandMoreVideoEffects",e[e.expandSearchResult=360]="expandSearchResult",e[e.feedbackCancel=361]="feedbackCancel",e[e.feedbackClose=362]="feedbackClose",e[e.feedbackInstantAnswerNo=363]="feedbackInstantAnswerNo",e[e.feedbackInstantAnswerYes=364]="feedbackInstantAnswerYes",e[e.feedbackSubmit=365]="feedbackSubmit",e[e.feedFilterClick=366]="feedFilterClick",e[e.feedItemClick=367]="feedItemClick",e[e.feedItemSelectedButNotOpened=368]="feedItemSelectedButNotOpened",e[e.fileChicletClick=369]="fileChicletClick",e[e.fileConflictedDialogCancel=370]="fileConflictedDialogCancel",e[e.fileConflictedDialogKeepBoth=371]="fileConflictedDialogKeepBoth",e[e.fileConflictedDialogReplace=372]="fileConflictedDialogReplace",e[e.fileUpload=373]="fileUpload",e[e.filterCallHistory=374]="filterCallHistory",e[e.filterChatList=375]="filterChatList",e[e.filterMenuClick=376]="filterMenuClick",e[e.filterMoreOptionsButtonClick=377]="filterMoreOptionsButtonClick",e[e.focusFluidMessage=378]="focusFluidMessage",e[e.focusMode=379]="focusMode",e[e.freemiumCalCopyMeetingLinkClick=380]="freemiumCalCopyMeetingLinkClick",e[e.freemiumCalCreateMeetingLinkClick=381]="freemiumCalCreateMeetingLinkClick",e[e.freemiumCalDeleteMeetingClick=382]="freemiumCalDeleteMeetingClick",e[e.freemiumCalEditMeetingClick=383]="freemiumCalEditMeetingClick",e[e.freemiumCalJoinMeetingClick=384]="freemiumCalJoinMeetingClick",e[e.freemiumCalLoad=385]="freemiumCalLoad",e[e.freemiumCalMeetingLinkCreatedDialogClose=386]="freemiumCalMeetingLinkCreatedDialogClose",e[e.freemiumCalMeetingOptionsLinkClick=387]="freemiumCalMeetingOptionsLinkClick",e[e.freemiumCalMeetNowClick=388]="freemiumCalMeetNowClick",e[e.freemiumCalOpenInGoogleCalendarClick=389]="freemiumCalOpenInGoogleCalendarClick",e[e.freemiumCalOpenInOutlookClick=390]="freemiumCalOpenInOutlookClick",e[e.freemiumCalQuickCreateDialogClose=391]="freemiumCalQuickCreateDialogClose",e[e.freemiumGoogleCalAddClick=392]="freemiumGoogleCalAddClick",e[e.freemiumGoogleCalAddOnDialogClick=393]="freemiumGoogleCalAddOnDialogClick",e[e.freemiumGoogleCalAddOnErrorLayoutClick=394]="freemiumGoogleCalAddOnErrorLayoutClick",e[e.freemiumGoogleCalCancelOnDialogClick=395]="freemiumGoogleCalCancelOnDialogClick",e[e.freemiumGoogleCalRemoveClick=396]="freemiumGoogleCalRemoveClick",e[e.freemiumGoogleCalRemoveFromAllAccountsClick=397]="freemiumGoogleCalRemoveFromAllAccountsClick",e[e.freemiumGoogleCalRemoveFromTeamsClick=398]="freemiumGoogleCalRemoveFromTeamsClick",e[e.freemiumGoogleCalRemoveOnErrorLayoutClick=399]="freemiumGoogleCalRemoveOnErrorLayoutClick",e[e.freemiumInviteContactsAccountsGoogleClick=400]="freemiumInviteContactsAccountsGoogleClick",e[e.freemiumInviteContactsAccountsMicrosoftClick=401]="freemiumInviteContactsAccountsMicrosoftClick",e[e.freProfileAnotherAccountPressed=402]="freProfileAnotherAccountPressed",e[e.freProfileConsentProvided=403]="freProfileConsentProvided",e[e.fullScreen=404]="fullScreen",e[e.fullScreenChangeBroadcast=405]="fullScreenChangeBroadcast",e[e.funAddItem=406]="funAddItem",e[e.funCancel=407]="funCancel",e[e.funCategory=408]="funCategory",e[e.funSelectItem=409]="funSelectItem",e[e.gallery=410]="gallery",e[e.galleryOnTop=411]="galleryOnTop",e[e.generateTeamCode=412]="generateTeamCode",e[e.getCallingRecordingDeeplink=413]="getCallingRecordingDeeplink",e[e.getChannelDeepLink=414]="getChannelDeepLink",e[e.getChannelEmail=415]="getChannelEmail",e[e.getLocation=416]="getLocation",e[e.getMedia=417]="getMedia",e[e.getTeamDeepLink=418]="getTeamDeepLink",e[e.goToWebsite=419]="goToWebsite",e[e.groupChat=420]="groupChat",e[e.hideBreakoutRoomPanel=421]="hideBreakoutRoomPanel",e[e.hideBroadcastQnaPanel=422]="hideBroadcastQnaPanel",e[e.hideMyself=423]="hideMyself",e[e.hideTabConversation=424]="hideTabConversation",e[e.ignoreMirroringMyVideo=425]="ignoreMirroringMyVideo",e[e.immersiveReader=426]="immersiveReader",e[e.includeSystemAudio=427]="includeSystemAudio",e[e.chatInfoPane=428]="chatInfoPane",e[e.insertHyperlink=429]="insertHyperlink",e[e.inviteCoworkers=430]="inviteCoworkers",e[e.invokeAppSharing=431]="invokeAppSharing",e[e.invokeKeyboardShortcuts=432]="invokeKeyboardShortcuts",e[e.joinCall=433]="joinCall",e[e.joinCallAndAddRoom=434]="joinCallAndAddRoom",e[e.joinGroupCallAudio=435]="joinGroupCallAudio",e[e.joinGroupCallVideo=436]="joinGroupCallVideo",e[e.joinMainMeeting=437]="joinMainMeeting",e[e.joinMeetingFromCodeClick=438]="joinMeetingFromCodeClick",e[e.joinOnPreJoinScreen=439]="joinOnPreJoinScreen",e[e.joinTeam=440]="joinTeam",e[e.joinTeamByCode=441]="joinTeamByCode",e[e.largeGallery=442]="largeGallery",e[e.lastSearchableAliasTurnedOff=443]="lastSearchableAliasTurnedOff",e[e.launchEduSupport=444]="launchEduSupport",e[e.launchTeams=445]="launchTeams",e[e.launchTeamsHelp=446]="launchTeamsHelp",e[e.launchTeamsWeb=447]="launchTeamsWeb",e[e.learnMoreAboutD365=448]="learnMoreAboutD365",e[e.leaveChannel=449]="leaveChannel",e[e.leaveTeam=450]="leaveTeam",e[e.like=451]="like",e[e.linkPreviewCancel=452]="linkPreviewCancel",e[e.linkPreviewPermission=453]="linkPreviewPermission",e[e.linkUnfurl=454]="linkUnfurl",e[e.loweredAllHands=455]="loweredAllHands",e[e.loweredHand=456]="loweredHand",e[e.lowerHandOnBehalf=457]="lowerHandOnBehalf",e[e.lowerHandOnBehalfFromSearchOf=458]="lowerHandOnBehalfFromSearchOf",e[e.manageAppsDeleteStagingApp=459]="manageAppsDeleteStagingApp",e[e.manageAppsSubmitApp=460]="manageAppsSubmitApp",e[e.manageAppsUploadCustomApp=461]="manageAppsUploadCustomApp",e[e.manageAppsUploadTenantApp=462]="manageAppsUploadTenantApp",e[e.manageChannel=463]="manageChannel",e[e.manageTagsForOwner=464]="manageTagsForOwner",e[e.manageTagsForOwnerAndMember=465]="manageTagsForOwnerAndMember",e[e.manageTeam=466]="manageTeam",e[e.manageTeamTags=467]="manageTeamTags",e[e.meetingAppsFlyout=468]="meetingAppsFlyout",e[e.meetingArtifactTileClick=469]="meetingArtifactTileClick",e[e.meetingArtifactTileShown=470]="meetingArtifactTileShown",e[e.meetingDetailsPanelLoadFluid=471]="meetingDetailsPanelLoadFluid",e[e.meetingInfoToggled=472]="meetingInfoToggled",e[e.meetingLock=473]="meetingLock",e[e.meetingRoomContentAndPeople=474]="meetingRoomContentAndPeople",e[e.meetingRoomContentOnly=475]="meetingRoomContentOnly",e[e.meetingRoomPeopleOnly=476]="meetingRoomPeopleOnly",e[e.meetingRoomSwapScreens=477]="meetingRoomSwapScreens",e[e.meetingShowPanel=478]="meetingShowPanel",e[e.meetingStreaming=479]="meetingStreaming",e[e.meetingUnlock=480]="meetingUnlock",e[e.meetNowClick=481]="meetNowClick",e[e.meetNowFromEventClick=482]="meetNowFromEventClick",e[e.meetNowGetMeetingLinkClick=483]="meetNowGetMeetingLinkClick",e[e.meetNowShareMeetingLinkClick=484]="meetNowShareMeetingLinkClick",e[e.messageActionMoreActionCreateNewAction=485]="messageActionMoreActionCreateNewAction",e[e.messageActionMoreActionMenuItem=486]="messageActionMoreActionMenuItem",e[e.messageBookmarkMessage=487]="messageBookmarkMessage",e[e.messageCopyLink=488]="messageCopyLink",e[e.messageCopyVideoLink=489]="messageCopyVideoLink",e[e.messageDelete=490]="messageDelete",e[e.messageDownloadVideo=491]="messageDownloadVideo",e[e.messageEdit=492]="messageEdit",e[e.messageExtensionActionCommand=493]="messageExtensionActionCommand",e[e.messageExtensionAuthAndConfig=494]="messageExtensionAuthAndConfig",e[e.messageExtensionFlyout=495]="messageExtensionFlyout",e[e.messageExtensionSearch=496]="messageExtensionSearch",e[e.messageExtensionSearchResult=497]="messageExtensionSearchResult",e[e.messageExtensionSelect=498]="messageExtensionSelect",e[e.messageExtentionSwitchCommand=499]="messageExtentionSwitchCommand",e[e.messageExtensionWorkflowsCreateNewAction=500]="messageExtensionWorkflowsCreateNewAction",e[e.messageLike=501]="messageLike",e[e.messageOpenImage=502]="messageOpenImage",e[e.messageOpenVideoInBrowser=503]="messageOpenVideoInBrowser",e[e.messagePlaybackVideo=504]="messagePlaybackVideo",e[e.messagePreviewEdit=505]="messagePreviewEdit",e[e.messagePreviewSend=506]="messagePreviewSend",e[e.messageQuotedReply=507]="messageQuotedReply",e[e.messageQuotedReplyDeeplink=508]="messageQuotedReplyDeeplink",e[e.messageQuotedReplyDeeplinkTooOld=509]="messageQuotedReplyDeeplinkTooOld",e[e.messageQuotedReplyDismissed=510]="messageQuotedReplyDismissed",e[e.messageReadReceiptInfo=511]="messageReadReceiptInfo",e[e.messageReport=512]="messageReport",e[e.messageShareToOutlook=513]="messageShareToOutlook",e[e.messageShowVideo=514]="messageShowVideo",e[e.messageShowVideoOptions=515]="messageShowVideoOptions",e[e.messageTranslate=516]="messageTranslate",e[e.messageUndoDelete=517]="messageUndoDelete",e[e.messageUnlike=518]="messageUnlike",e[e.messageUnread=519]="messageUnread",e[e.minimizeApp=520]="minimizeApp",e[e.mirroringMyVideo=521]="mirroringMyVideo",e[e.modalAddParticipantsButton=522]="modalAddParticipantsButton",e[e.modalCopyMeetingLink=523]="modalCopyMeetingLink",e[e.modalDismissInviteModal=524]="modalDismissInviteModal",e[e.modalInviteViaDefaultEmail=525]="modalInviteViaDefaultEmail",e[e.modalInviteViaGmailEmail=526]="modalInviteViaGmailEmail",e[e.modalInviteViaGoogleCalendar=527]="modalInviteViaGoogleCalendar",e[e.modalInviteViaOutlookCalendar=528]="modalInviteViaOutlookCalendar",e[e.modalInviteViaOutlookEmail=529]="modalInviteViaOutlookEmail",e[e.moreApps=530]="moreApps",e[e.msaAddDeleteAliasLinkClicked=531]="msaAddDeleteAliasLinkClicked",e[e.msaEditName=532]="msaEditName",e[e.muteAll=533]="muteAll",e[e.muteParticipant=534]="muteParticipant",e[e.muteParticipantFromSearch=535]="muteParticipantFromSearch",e[e.navCall=536]="navCall",e[e.navCallMeBack=537]="navCallMeBack",e[e.navChat=538]="navChat",e[e.navDialIn=539]="navDialIn",e[e.navigateToBlockedUsersSettings=540]="navigateToBlockedUsersSettings",e[e.navigateToContactsSyncSettings=541]="navigateToContactsSyncSettings",e[e.navigateToDrillInRoster=542]="navigateToDrillInRoster",e[e.navigateToMeetingOptionsPageFromRoster=543]="navigateToMeetingOptionsPageFromRoster",e[e.navigateToPartialRoster=544]="navigateToPartialRoster",e[e.navigateToSearchabilitySettings=545]="navigateToSearchabilitySettings",e[e.navOrgChart=546]="navOrgChart",e[e.navParentChat=547]="navParentChat",e[e.ndiBroadcastStart=548]="ndiBroadcastStart",e[e.ndiBroadcastStop=549]="ndiBroadcastStop",e[e.newChatAddPeople=550]="newChatAddPeople",e[e.newChatCreation=551]="newChatCreation",e[e.newChatRemovePeople=552]="newChatRemovePeople",e[e.newChatResolveToLie=553]="newChatResolveToLie",e[e.newGroupChatCreation=554]="newGroupChatCreation",e[e.newGroupChatToggle=555]="newGroupChatToggle",e[e.newMeetingCreation=556]="newMeetingCreation",e[e.newUserInvite=557]="newUserInvite",e[e.notificationSettingsPage=558]="notificationSettingsPage",e[e.notificationTypeChat=559]="notificationTypeChat",e[e.notificationTypeLikeInChat=560]="notificationTypeLikeInChat",e[e.notificationTypeMentionInChat=561]="notificationTypeMentionInChat",e[e.notificationTypeShowPreviewInToasts=562]="notificationTypeShowPreviewInToasts",e[e.nudgeParticipant=563]="nudgeParticipant",e[e.nudgeParticipantFromSearch=564]="nudgeParticipantFromSearch",e[e.odspShareDialog=565]="odspShareDialog",e[e.openAboutSettings=566]="openAboutSettings",e[e.openAppearanceAndAccessibilitySettings=567]="openAppearanceAndAccessibilitySettings",e[e.openCalendarSettings=568]="openCalendarSettings",e[e.openCallForwardingSettings=569]="openCallForwardingSettings",e[e.openCallGroupSettings=570]="openCallGroupSettings",e[e.openChatListFilter=571]="openChatListFilter",e[e.openConversationFromChatList=572]="openConversationFromChatList",e[e.openConversationOverflow=573]="openConversationOverflow",e[e.openD365Dialog=574]="openD365Dialog",e[e.openD365PromoOfferPage=575]="openD365PromoOfferPage",e[e.openDefaultD365Org=576]="openDefaultD365Org",e[e.openDeviceSettings=577]="openDeviceSettings",e[e.openDevicesPanel=578]="openDevicesPanel",e[e.openFile=579]="openFile",e[e.openFluidLink=580]="openFluidLink",e[e.openGeneralSettings=581]="openGeneralSettings",e[e.openInviteModal=582]="openInviteModal",e[e.openMeetNowFromCodeFlyout=583]="openMeetNowFromCodeFlyout",e[e.openMeetNowMenuPanel=584]="openMeetNowMenuPanel",e[e.openMeetNowShareFlyout=585]="openMeetNowShareFlyout",e[e.openMobileDownload=586]="openMobileDownload",e[e.openMoreActionsMenu=587]="openMoreActionsMenu",e[e.openMoreActionsMenuItem=588]="openMoreActionsMenuItem",e[e.openNotificationsSettings=589]="openNotificationsSettings",e[e.openPanel=590]="openPanel",e[e.openPeopleSettings=591]="openPeopleSettings",e[e.openPersonalFileView=592]="openPersonalFileView",e[e.openPrivacySettings=593]="openPrivacySettings",e[e.openPrivatePreview=594]="openPrivatePreview",e[e.openQuickPicker=595]="openQuickPicker",e[e.openSelectedD365Org=596]="openSelectedD365Org",e[e.openVideoEffectApp=597]="openVideoEffectApp",e[e.openWebPage=598]="openWebPage",e[e.optionsMenuBRB=599]="optionsMenuBRB",e[e.optionsMenuGetHelp=600]="optionsMenuGetHelp",e[e.optionsMenuKeyboard=601]="optionsMenuKeyboard",e[e.optionsMenuLegal=602]="optionsMenuLegal",e[e.optionsMenuPrivacyNotice=603]="optionsMenuPrivacyNotice",e[e.optionsMenuRingSwitcher=604]="optionsMenuRingSwitcher",e[e.optionsMenuSettings=605]="optionsMenuSettings",e[e.optionsMenuSuggestaFeature=606]="optionsMenuSuggestaFeature",e[e.optionsMenuThirdPartyNotice=607]="optionsMenuThirdPartyNotice",e[e.optionsMenuTraining=608]="optionsMenuTraining",e[e.optionsMenuWhatsNew=609]="optionsMenuWhatsNew",e[e.optionsMenuZoomIn=610]="optionsMenuZoomIn",e[e.optionsMenuZoomOut=611]="optionsMenuZoomOut",e[e.optionsMenuZoomReset=612]="optionsMenuZoomReset",e[e.participantListExpand=613]="participantListExpand",e[e.pauseBroadcast=614]="pauseBroadcast",e[e.paywallEndScreenDismiss=615]="paywallEndScreenDismiss",e[e.paywallUpgrade=616]="paywallUpgrade",e[e.peoplePickerInitiate=617]="peoplePickerInitiate",e[e.peoplePickerResultSelected=618]="peoplePickerResultSelected",e[e.pinMessage=619]="pinMessage",e[e.pinMyself=620]="pinMyself",e[e.pinnedMessageClicked=621]="pinnedMessageClicked",e[e.pinParticipant=622]="pinParticipant",e[e.pinParticipantFromSearch=623]="pinParticipantFromSearch",e[e.pinUrlAsWebsiteTab=624]="pinUrlAsWebsiteTab",e[e.playbackBitrateChangedBroadcast=625]="playbackBitrateChangedBroadcast",e[e.playBroadcast=626]="playBroadcast",e[e.playVideo=627]="playVideo",e[e.preConsentedAppClick=628]="preConsentedAppClick",e[e.preJoinAttendee=629]="preJoinAttendee",e[e.preJoinAutomuteTooltip=630]="preJoinAutomuteTooltip",e[e.preJoinCloseCameraEffects=631]="preJoinCloseCameraEffects",e[e.preJoinCloseCustomVideoBackgrounds=632]="preJoinCloseCustomVideoBackgrounds",e[e.preJoinContentOnly=633]="preJoinContentOnly",e[e.preJoinContentOnlyOnLoudSpeaker=634]="preJoinContentOnlyOnLoudSpeaker",e[e.preJoinDisableBackgroundBlur=635]="preJoinDisableBackgroundBlur",e[e.preJoinDisableVideo=636]="preJoinDisableVideo",e[e.preJoinEnableBackgroundBlur=637]="preJoinEnableBackgroundBlur",e[e.preJoinEnableVideo=638]="preJoinEnableVideo",e[e.preJoinMute=639]="preJoinMute",e[e.preJoinOpenCameraEffects=640]="preJoinOpenCameraEffects",e[e.preJoinOpenCustomVideoBackgrounds=641]="preJoinOpenCustomVideoBackgrounds",e[e.preJoinPSTN=642]="preJoinPSTN",e[e.preJoinRoomJoin=643]="preJoinRoomJoin",e[e.preJoinUnmute=644]="preJoinUnmute",e[e.preJoinV2joinWithComputerAudio=645]="preJoinV2joinWithComputerAudio",e[e.preJoinV2joinWithoutAudio=646]="preJoinV2joinWithoutAudio",e[e.preJoinV2joinWithPhoneAudio=647]="preJoinV2joinWithPhoneAudio",e[e.preJoinV2joinWithRoomAudio=648]="preJoinV2joinWithRoomAudio",e[e.preJoinV2noAudioOptionSelected=649]="preJoinV2noAudioOptionSelected",e[e.presentTeamCode=650]="presentTeamCode",e[e.previewCustomVideoBackground=651]="previewCustomVideoBackground",e[e.privacySettings=652]="privacySettings",e[e.pstnDialOut=653]="pstnDialOut",e[e.ptzRemoteCameraRequestedForControl=654]="ptzRemoteCameraRequestedForControl",e[e.ptzRemoteCameraSessionTerminated=655]="ptzRemoteCameraSessionTerminated",e[e.quickIM=656]="quickIM",e[e.raisedHand=657]="raisedHand",e[e.readFluidMessage=658]="readFluidMessage",e[e.readMsgs=659]="readMsgs",e[e.recording=660]="recording",e[e.recordingClick=661]="recordingClick",e[e.recordingClickInTranscripts=662]="recordingClickInTranscripts",e[e.recordingReportBug=663]="recordingReportBug",e[e.recordVideo=664]="recordVideo",e[e.redeemLink=665]="redeemLink",e[e.registrationReportWebinar=666]="registrationReportWebinar",e[e.rejectCall=667]="rejectCall",e[e.reloadTab=668]="reloadTab",e[e.removeAppDialog=669]="removeAppDialog",e[e.removeAttachment=670]="removeAttachment",e[e.removeFluidLimiter=671]="removeFluidLimiter",e[e.removeTab=672]="removeTab",e[e.removeTabForcefully=673]="removeTabForcefully",e[e.removeTeamCode=674]="removeTeamCode",e[e.renderShareTrayPanel=675]="renderShareTrayPanel",e[e.renewTeam=676]="renewTeam",e[e.resetTeamCode=677]="resetTeamCode",e[e.restoreTeam=678]="restoreTeam",e[e.restrictParticipantAudio=679]="restrictParticipantAudio",e[e.resumeBroadcast=680]="resumeBroadcast",e[e.retryAddEntireClass=681]="retryAddEntireClass",e[e.retryCall=682]="retryCall",e[e.retryComposeFluid=683]="retryComposeFluid",e[e.retryLoadFluid=684]="retryLoadFluid",e[e.returnToPreJoinMainScreen=685]="returnToPreJoinMainScreen",e[e.rosterSearchClear=686]="rosterSearchClear",e[e.rosterSearchInitiate=687]="rosterSearchInitiate",e[e.scenePickerApplyScene=688]="scenePickerApplyScene",e[e.scenePickerCloseDialog=689]="scenePickerCloseDialog",e[e.scenePickerOpenDialog=690]="scenePickerOpenDialog",e[e.scenePickerSelectScene=691]="scenePickerSelectScene",e[e.scheduledMeetingChicletAddToCalendar=692]="scheduledMeetingChicletAddToCalendar",e[e.scheduledMeetingChicletCopyLink=693]="scheduledMeetingChicletCopyLink",e[e.scheduledMeetingChicletJoinMeeting=694]="scheduledMeetingChicletJoinMeeting",e[e.schoolAppNavigateToAllTeams=695]="schoolAppNavigateToAllTeams",e[e.screenshareRequestControl=696]="screenshareRequestControl",e[e.scrollActivityFeedList=697]="scrollActivityFeedList",e[e.scrollChatList=698]="scrollChatList",e[e.scrollParentList=699]="scrollParentList",e[e.scrollToNewMessages=700]="scrollToNewMessages",e[e.searchExecuted=701]="searchExecuted",e[e.searchFilterCleared=702]="searchFilterCleared",e[e.searchFilterClicked=703]="searchFilterClicked",e[e.searchInitiated=704]="searchInitiated",e[e.seekedBroadcast=705]="seekedBroadcast",e[e.seekingBroadcast=706]="seekingBroadcast",e[e.selectAtMentionItem=707]="selectAtMentionItem",e[e.selectAudioDevice=708]="selectAudioDevice",e[e.selectCallForwarding=709]="selectCallForwarding",e[e.selectCustomVideoBackground=710]="selectCustomVideoBackground",e[e.selectDiscoverability=711]="selectDiscoverability",e[e.selectFileAction=712]="selectFileAction",e[e.selectLayoutTemplate=713]="selectLayoutTemplate",e[e.selectMediaImage=714]="selectMediaImage",e[e.selectPlatformAppTab=715]="selectPlatformAppTab",e[e.selectSingleLayout=716]="selectSingleLayout",e[e.selectTwoLargeLeftLayout=717]="selectTwoLargeLeftLayout",e[e.selectVideoEffect=718]="selectVideoEffect",e[e.sendApplauseReaction=719]="sendApplauseReaction",e[e.sendHeartReaction=720]="sendHeartReaction",e[e.sendLaughReaction=721]="sendLaughReaction",e[e.sendLikeReaction=722]="sendLikeReaction",e[e.sendVideoToHardwareOutDevice=723]="sendVideoToHardwareOutDevice",e[e.serpAllCarouselArrowClicked=724]="serpAllCarouselArrowClicked",e[e.serpAnswerClicked=725]="serpAnswerClicked",e[e.serpAnswerLoaded=726]="serpAnswerLoaded",e[e.serpFeedbackClicked=727]="serpFeedbackClicked",e[e.serpHoverActionClicked=728]="serpHoverActionClicked",e[e.serpNextPageButtonClicked=729]="serpNextPageButtonClicked",e[e.serpPreviousPageButtonClicked=730]="serpPreviousPageButtonClicked",e[e.serpRelevanceFilterClicked=731]="serpRelevanceFilterClicked",e[e.serpRelevanceFilterSelected=732]="serpRelevanceFilterSelected",e[e.serpResultItemOpen=733]="serpResultItemOpen",e[e.serpSeeMoreButtonClicked=734]="serpSeeMoreButtonClicked",e[e.serpSpellerClicked=735]="serpSpellerClicked",e[e.serpSpellerLoaded=736]="serpSpellerLoaded",e[e.serpTabOpen=737]="serpTabOpen",e[e.setLayout=738]="setLayout",e[e.shareCharmCompleted=739]="shareCharmCompleted",e[e.shareCharmOpened=740]="shareCharmOpened",e[e.shareInvisionWhiteboard=741]="shareInvisionWhiteboard",e[e.shareRecording=742]="shareRecording",e[e.shareToOutlookCompleted=743]="shareToOutlookCompleted",e[e.shareToOutlookDiscard=744]="shareToOutlookDiscard",e[e.shareToOutlookSend=745]="shareToOutlookSend",e[e.shareToTeamsSubmission=746]="shareToTeamsSubmission",e[e.sharingContent=747]="sharingContent",e[e.showAboutTabDialog=748]="showAboutTabDialog",e[e.showBreakoutRoomCreateDialog=749]="showBreakoutRoomCreateDialog",e[e.showBreakoutRoomPanel=750]="showBreakoutRoomPanel",e[e.showBroadcastQnaPanel=751]="showBroadcastQnaPanel",e[e.showD365DialogButton=752]="showD365DialogButton",e[e.showFullLobbyListView=753]="showFullLobbyListView",e[e.showHiddenChatHistory=754]="showHiddenChatHistory",e[e.showLocation=755]="showLocation",e[e.showMeetingNotes=756]="showMeetingNotes",e[e.showParentOverflowList=757]="showParentOverflowList",e[e.showTabConversation=758]="showTabConversation",e[e.signInJSONTab=759]="signInJSONTab",e[e.silentAppInstall=760]="silentAppInstall",e[e.sortFileView=761]="sortFileView",e[e.sourcePickerMuteAll=762]="sourcePickerMuteAll",e[e.spotlightParticipant=763]="spotlightParticipant",e[e.spotlightParticipantFromSearch=764]="spotlightParticipantFromSearch",e[e.startBroadcast=765]="startBroadcast",e[e.startChatFromParticipants=766]="startChatFromParticipants",e[e.startFaceEnrollment=767]="startFaceEnrollment",e[e.startScd=768]="startScd",e[e.startSharing=769]="startSharing",e[e.startVoiceEnrollment=770]="startVoiceEnrollment",e[e.stopBroadcast=771]="stopBroadcast",e[e.stopFaceEnrollment=772]="stopFaceEnrollment",e[e.stopSpotlight=773]="stopSpotlight",e[e.stopRecordingCancel=774]="stopRecordingCancel",e[e.stopRecordingConfirmation=775]="stopRecordingConfirmation",e[e.stopScd=776]="stopScd",e[e.stopVoiceEnrollment=777]="stopVoiceEnrollment",e[e.storeAppItemClick=778]="storeAppItemClick",e[e.storeCollectionClick=779]="storeCollectionClick",e[e.storeCollectionScroll=780]="storeCollectionScroll",e[e.storeCollectionSeeMore=781]="storeCollectionSeeMore",e[e.storeFilterClear=782]="storeFilterClear",e[e.storeFilterClick=783]="storeFilterClick",e[e.storeManageAppsClick=784]="storeManageAppsClick",e[e.storePowerAppItemClick=785]="storePowerAppItemClick",e[e.storeProviderEntry=786]="storeProviderEntry",e[e.storeSearchChange=787]="storeSearchChange",e[e.storeToggleFeature=788]="storeToggleFeature",e[e.storeWorkflowItemClick=789]="storeWorkflowItemClick",e[e.sttAccountErrorNavToTeams=790]="sttAccountErrorNavToTeams",e[e.sttDownloadBannerSelect=791]="sttDownloadBannerSelect",e[e.sttDownloadPostShareSelect=792]="sttDownloadPostShareSelect",e[e.sttDownLoadPrimarySelect=793]="sttDownLoadPrimarySelect",e[e.sttDownloadPrimarySkip=794]="sttDownloadPrimarySkip",e[e.suggestionClick=795]="suggestionClick",e[e.supervisorMessageDelete=796]="supervisorMessageDelete",e[e.supervisorMessageUndoDelete=797]="supervisorMessageUndoDelete",e[e.switchLanguageConfirm=798]="switchLanguageConfirm",e[e.switchLanguageDeny=799]="switchLanguageDeny";e[e.tab=800]="tab",e[e.tabActionMenu=801]="tabActionMenu",e[e.tabClickCardAction=802]="tabClickCardAction",e[e.tabOverflowButton=803]="tabOverflowButton",e[e.tabOverflowMenuItem=804]="tabOverflowMenuItem",e[e.tabRemove=805]="tabRemove",e[e.tabRename=806]="tabRename",e[e.tabSettings=807]="tabSettings",e[e.tabSubmenuButton=808]="tabSubmenuButton",e[e.tabSubmenuItem=809]="tabSubmenuItem",e[e.timeout=810]="timeout",e[e.togetherMode=811]="togetherMode",e[e.togetherModeSeatAssignment=812]="togetherModeSeatAssignment",e[e.toggleCallHealthButton=813]="toggleCallHealthButton",e[e.toggleChatBubbles=814]="toggleChatBubbles",e[e.toggleGestureBasedReaction=815]="toggleGestureBasedReaction",e[e.toggleMediaStreamsPanel=816]="toggleMediaStreamsPanel",e[e.toggleMuteNotificationsDuringMeeting=817]="toggleMuteNotificationsDuringMeeting",e[e.toggleOffScd=818]="toggleOffScd",e[e.toggleOnScd=819]="toggleOnScd",e[e.togglePanoVideo=820]="togglePanoVideo",e[e.toggleParticipantVideoCrop=821]="toggleParticipantVideoCrop",e[e.toggleTimeZoneIndicator=822]="toggleTimeZoneIndicator",e[e.transcript=823]="transcript",e[e.transcriptDeleteClick=824]="transcriptDeleteClick",e[e.transcriptDeleteConfirm=825]="transcriptDeleteConfirm",e[e.transcriptDownload=826]="transcriptDownload",e[e.transcriptEdit=827]="transcriptEdit",e[e.transcriptMessageOpen=828]="transcriptMessageOpen",e[e.transcriptSelect=829]="transcriptSelect",e[e.transcriptVoiceEnrollmentClick=830]="transcriptVoiceEnrollmentClick",e[e.transferActiveCall=831]="transferActiveCall",e[e.triggerSystemAudioDriverInstall=832]="triggerSystemAudioDriverInstall",e[e.triggerSystemAudioDriverUpdate=833]="triggerSystemAudioDriverUpdate",e[e.turnOffNotification=834]="turnOffNotification",e[e.turnOffTouchUp=835]="turnOffTouchUp",e[e.turnOnNotification=836]="turnOnNotification",e[e.turnOnTouchUp=837]="turnOnTouchUp",e[e.typeToFilterClick=838]="typeToFilterClick",e[e.typeToFilterOnInput=839]="typeToFilterOnInput",e[e.ufdDismiss=840]="ufdDismiss",e[e.ufdError=841]="ufdError",e[e.ufdInfo=842]="ufdInfo",e[e.ufdWarning=843]="ufdWarning",e[e.unblockContact=844]="unblockContact",e[e.unifiedSearchSelection=845]="unifiedSearchSelection",e[e.unpinMessage=846]="unpinMessage",e[e.unrestrictParticipantAudio=847]="unrestrictParticipantAudio",e[e.video=848]="video",e[e.videoPagination=849]="videoPagination",e[e.videoPlayedToEnd=850]="videoPlayedToEnd",e[e.viewFileActions=851]="viewFileActions",e[e.viewImages=852]="viewImages",e[e.viewLobbyFromToast=853]="viewLobbyFromToast",e[e.voicemail=854]="voicemail",e[e.webinarRegistrationAttendeeCancel=855]="webinarRegistrationAttendeeCancel",e[e.webinarRegistrationAttendeeRegistered=856]="webinarRegistrationAttendeeRegistered",e[e.webinarRegistrationAttendeeViewed=857]="webinarRegistrationAttendeeViewed",e[e.webinarRegistrationPreviewed=858]="webinarRegistrationPreviewed",e[e.webinarRegistrationSaved=859]="webinarRegistrationSaved"}(u||(u={})),function(e){e[e.actionExecuteCacheRead=0]="actionExecuteCacheRead",e[e.actionExecuteInvokeFailure=1]="actionExecuteInvokeFailure",e[e.actionExecuteInvokeSuccess=2]="actionExecuteInvokeSuccess",e[e.activeCallJoinOptionsPanel=3]="activeCallJoinOptionsPanel",e[e.activityFeed=4]="activityFeed",e[e.adaptiveCardTab=5]="adaptiveCardTab",e[e.addFirstAttendee=6]="addFirstAttendee",e[e.admin=7]="admin",e[e.allPageCarouselLink=8]="allPageCarouselLink",e[e.allPageLink=9]="allPageLink",e[e.appAuth=10]="appAuth",e[e.appMgmt=11]="appMgmt",e[e.appResume=12]="appResume",e[e.attendanceReport=13]="attendanceReport",e[e.attendeeHardMute=14]="attendeeHardMute",e[e.audioDevice=15]="audioDevice",e[e.autoDismissContentBubble=16]="autoDismissContentBubble",e[e.banner=17]="banner",e[e.biometricEnrollment=18]="biometricEnrollment",e[e.breakoutRoom=19]="breakoutRoom",e[e.broadcast=20]="broadcast",e[e.browseForMoreContent=21]="browseForMoreContent",e[e.call=22]="call",e[e.callForwarding=23]="callForwarding",e[e.callGroup=24]="callGroup",e[e.callHealth=25]="callHealth",e[e.callHealthViewMore=26]="callHealthViewMore",e[e.callHistory=27]="callHistory",e[e.callMeBack=28]="callMeBack",e[e.callMeetingContent=29]="callMeetingContent",e[e.callOBO=30]="callOBO",e[e.callOrMeetup=31]="callOrMeetup",e[e.callPostEchoBotScreenDeviceSetting=32]="callPostEchoBotScreenDeviceSetting",e[e.callPostEchoBotScreenDismissed=33]="callPostEchoBotScreenDismissed",e[e.callSetting=34]="callSetting",e[e.callTranscript=35]="callTranscript",e[e.Calndr_AgendaView_Load=36]="Calndr_AgendaView_Load",e[e.Calndr_AgendaView_MtgActions=37]="Calndr_AgendaView_MtgActions",e[e.Calndr_AgendaView_MtgLinkCreatedDialog=38]="Calndr_AgendaView_MtgLinkCreatedDialog",e[e.cameraEffectsPanel=39]="cameraEffectsPanel",e[e.cameraEffectsToggle=40]="cameraEffectsToggle",e[e.cancelMeetingStreamStart=41]="cancelMeetingStreamStart",e[e.cancelStopPresentingSpeedbump=42]="cancelStopPresentingSpeedbump",e[e.card=43]="card",e[e.changeTeamPicture=44]="changeTeamPicture",e[e.chat=45]="chat",e[e.chatCreation=46]="chatCreation",e[e.Cht_Conv_Card=47]="Cht_Conv_Card",e[e.Cht_Conv_msg=48]="Cht_Conv_msg",e[e.clickButton=49]="clickButton",e[e.closeChatListFilter=50]="closeChatListFilter",e[e.closeDialog=51]="closeDialog",e[e.closeShareContentPanel=52]="closeShareContentPanel",e[e.closeShareContentTray=53]="closeShareContentTray",e[e.closeShareContentTrayV2=54]="closeShareContentTrayV2",e[e.closeWindow=55]="closeWindow",e[e.collaborativeAgenda=56]="collaborativeAgenda",e[e.composeMsg=57]="composeMsg",e[e.config=58]="config",e[e.confirmMeetingStreamStart=59]="confirmMeetingStreamStart",e[e.confirmStopPresentingSpeedbump=60]="confirmStopPresentingSpeedbump",e[e.connectedCalendar=61]="connectedCalendar",e[e.contactChange=62]="contactChange",e[e.contactsSync=63]="contactsSync",e[e.contactsSyncLearnMore=64]="contactsSyncLearnMore",e[e.contactsSyncMobileDetails=65]="contactsSyncMobileDetails",e[e.contactsUnsync=66]="contactsUnsync",e[e.contentCameraCleanup=67]="contentCameraCleanup",e[e.contentCameraEdgeDetection=68]="contentCameraEdgeDetection",e[e.contentCameraRotation=69]="contentCameraRotation",e[e.contentCameraScanAgain=70]="contentCameraScanAgain",e[e.contentCameraSnapshot=71]="contentCameraSnapshot",e[e.contentCameraUpdateScanType=72]="contentCameraUpdateScanType",e[e.copyLink=73]="copyLink",e[e.customVideoBackgroundsPanel=74]="customVideoBackgroundsPanel",e[e.deeplink=75]="deeplink",e[e.devicesPanel=76]="devicesPanel",e[e.dismissAuthConsentDialog=77]="dismissAuthConsentDialog",e[e.dismissContentBubble=78]="dismissContentBubble",e[e.editAvatarClose=79]="editAvatarClose",e[e.editAvatarSave=80]="editAvatarSave",e[e.editMsg=81]="editMsg",e[e.engageDriving=82]="engageDriving",e[e.espAction=83]="espAction",e[e.expandImage=84]="expandImage",e[e.extensibleAppPanel=85]="extensibleAppPanel",e[e.externalLink=86]="externalLink",e[e.feedback=87]="feedback",e[e.fileDownload=88]="fileDownload",e[e.files=89]="files",e[e.filterChatList=90]="filterChatList",e[e.Free_Calndr_Load=91]="Free_Calndr_Load",e[e.Free_Calndr_MtgActions=92]="Free_Calndr_MtgActions",e[e.Free_Calndr_MtgLinkCreatedDialog=93]="Free_Calndr_MtgLinkCreatedDialog",e[e.freemiumGoogleCalendar=94]="freemiumGoogleCalendar",e[e.freemiumInviteContactsAccounts=95]="freemiumInviteContactsAccounts",e[e.freemiumMeetings=96]="freemiumMeetings",e[e.freProfileScreen=97]="freProfileScreen",e[e.groupChatCreation=98]="groupChatCreation",e[e.hardMuteVideo=99]="hardMuteVideo",e[e.hardwareOut=100]="hardwareOut",e[e.ignoreMirroringMyVideoToggle=101]="ignoreMirroringMyVideoToggle",e[e.immersiveReader=102]="immersiveReader",e[e.inTabUI=103]="inTabUI",e[e.interopScreenShare=104]="interopScreenShare",e[e.invisionWB=105]="invisionWB",e[e.invoke=106]="invoke",e[e.launchAadAuthWindow=107]="launchAadAuthWindow",e[e.launchContentCameraSetupDialog=108]="launchContentCameraSetupDialog",e[e.launchSignInAuthWindow=109]="launchSignInAuthWindow",e[e.launchTeams=110]="launchTeams",e[e.lmsCourseCalendar=111]="lmsCourseCalendar",e[e.lmsIntegration=112]="lmsIntegration",e[e.manageApps=113]="manageApps",e[e.manageChannel=114]="manageChannel",e[e.manageConversation=115]="manageConversation",e[e.manageTags=116]="manageTags",e[e.manageTeam=117]="manageTeam",e[e.manageTeamCode=118]="manageTeamCode",e[e.manageTeamDiscoverySetting=119]="manageTeamDiscoverySetting",e[e.manageTeamGeneralSetting=120]="manageTeamGeneralSetting",e[e.mediaStreams=121]="mediaStreams",e[e.meetingDetailsPanel=122]="meetingDetailsPanel",e[e.meetingLock=123]="meetingLock",e[e.meetingReactions=124]="meetingReactions",e[e.meetNowFlyout=125]="meetNowFlyout",e[e.meetup=126]="meetup",e[e.messageTranslate=127]="messageTranslate",e[e.messageTranslateSeeOriginal=128]="messageTranslateSeeOriginal",e[e.messageTranslationProvideFeedback=129]="messageTranslationProvideFeedback",e[e.mobileDownload=130]="mobileDownload",e[e.moreActionsMenu=131]="moreActionsMenu",e[e.msaEditNameCancel=132]="msaEditNameCancel",e[e.msaEditNameConfirm=133]="msaEditNameConfirm",e[e.Mtg_Calndr_Grid=134]="Mtg_Calndr_Grid",e[e.Mtg_Calndr_Join=135]="Mtg_Calndr_Join",e[e.Mtg_Calndr_Load=136]="Mtg_Calndr_Load",e[e.Mtg_Calndr_Mtg=137]="Mtg_Calndr_Mtg",e[e.Mtg_Calndr_Peek=138]="Mtg_Calndr_Peek",e[e.Mtg_Calndr_Share_Dialog=139]="Mtg_Calndr_Share_Dialog",e[e.Mtg_Calndr_SyncingEventCard=140]="Mtg_Calndr_SyncingEventCard",e[e.Mtg_Calndr_ViewOptions=141]="Mtg_Calndr_ViewOptions",e[e.Mtg_Create_Update=142]="Mtg_Create_Update",e[e.Mtg_Dtls_Attachments=143]="Mtg_Dtls_Attachments",e[e.Mtg_Dtls_Close=144]="Mtg_Dtls_Close",e[e.Mtg_Dtls_Recommdn=145]="Mtg_Dtls_Recommdn",e[e.nav=146]="nav",e[e.navChat=147]="navChat",e[e.notificationMgmt=148]="notificationMgmt",e[e.notificationSettings=149]="notificationSettings",e[e.notificationSettingsChange=150]="notificationSettingsChange",e[e.openAplCustomBackgroundsList=151]="openAplCustomBackgroundsList",e[e.openChatListFilter=152]="openChatListFilter",e[e.openContactsConversation=153]="openContactsConversation",e[e.openContentCameraList=154]="openContentCameraList",e[e.openConversation=155]="openConversation",e[e.openDialog=156]="openDialog",e[e.openScreensList=157]="openScreensList",e[e.openShareContentTray=158]="openShareContentTray",e[e.openShareContentTrayV2=159]="openShareContentTrayV2",e[e.openWindowsList=160]="openWindowsList",e[e.optionsMenu=161]="optionsMenu",e[e.optionsMenuChild=162]="optionsMenuChild",e[e.parentChat=163]="parentChat",e[e.parentLearnMore=164]="parentLearnMore",e[e.parentList=165]="parentList",e[e.parentTeacherMeeting=166]="parentTeacherMeeting",e[e.paywall=167]="paywall",e[e.people=168]="people",e[e.pinMessage=169]="pinMessage",e[e.pinUrl=170]="pinUrl",e[e.platformTabHeader=171]="platformTabHeader",e[e.platformTabUbar=172]="platformTabUbar",e[e.platformTabUbarOverflowMainMenu=173]="platformTabUbarOverflowMainMenu",e[e.platformTabUbarOverflowMenu=174]="platformTabUbarOverflowMenu",e[e.preJoin=175]="preJoin",e[e.preJoinToggle=176]="preJoinToggle",e[e.preJoinTooltip=177]="preJoinTooltip",e[e.presenterChangesPPTSlide=178]="presenterChangesPPTSlide",e[e.presenterDisablesPrivateViewing=179]="presenterDisablesPrivateViewing",e[e.presenterEnablesPrivateViewing=180]="presenterEnablesPrivateViewing",e[e.presenterMode=181]="presenterMode",e[e.ptzRemoteCameraControllerMgmt=182]="ptzRemoteCameraControllerMgmt",e[e.raiseHand=183]="raiseHand",e[e.raiseHandFromSearch=184]="raiseHandFromSearch",e[e.readMsgs=185]="readMsgs",e[e.readReceipts=186]="readReceipts",e[e.recapPage=187]="recapPage",e[e.recording=188]="recording",e[e.recordingsTranscriptsTab=189]="recordingsTranscriptsTab",e[e.redeemLink=190]="redeemLink",e[e.rosterParticipantsSearch=191]="rosterParticipantsSearch",e[e.scanAgain=192]="scanAgain",e[e.scd=193]="scd",e[e.scenePickerDialog=194]="scenePickerDialog",e[e.scheduledMeetingChicletEventCancelled=195]="scheduledMeetingChicletEventCancelled",e[e.scheduledMeetingChicletEventCreated=196]="scheduledMeetingChicletEventCreated",e[e.scheduledMeetingChicletEventUpdated=197]="scheduledMeetingChicletEventUpdated",e[e.schedulingForm=198]="schedulingForm",e[e.scroll=199]="scroll",e[e.sdkLocationApi=200]="sdkLocationApi",e[e.sdkMediaApi=201]="sdkMediaApi",e[e.search=202]="search",e[e.searchAllCarouselArrow=203]="searchAllCarouselArrow",e[e.searchFeedback=204]="searchFeedback",e[e.searchFilters=205]="searchFilters",e[e.searchHoverActions=206]="searchHoverActions",e[e.searchPagination=207]="searchPagination",e[e.searchRelevanceFilter=208]="searchRelevanceFilter",e[e.searchResultItem=209]="searchResultItem",e[e.searchSeeMoreButton=210]="searchSeeMoreButton",e[e.searchTab=211]="searchTab",e[e.selectAplCustomBackground=212]="selectAplCustomBackground",e[e.selectContentOnlySharingLayout=213]="selectContentOnlySharingLayout",e[e.selectNewsAnchorSharingLayout=214]="selectNewsAnchorSharingLayout",e[e.selectSideBySideSharingLayout=215]="selectSideBySideSharingLayout",e[e.selectStandoutSharingLayout=216]="selectStandoutSharingLayout",e[e.selectWeatherPersonSharingLayout=217]="selectWeatherPersonSharingLayout",e[e.selectCameoSharingLayout=218]="selectCameoSharingLayout",e[e.sendMsgs=219]="sendMsgs",e[e.settingsApp=220]="settingsApp",e[e.shareComputerPowerPointFile=221]="shareComputerPowerPointFile",e[e.shareContentFromCamera=222]="shareContentFromCamera",e[e.shareInviteLink=223]="shareInviteLink",e[e.shareMRUPowerPointFile=224]="shareMRUPowerPointFile",e[e.shareOneDrivePowerPointFile=225]="shareOneDrivePowerPointFile",e[e.shareToOutlook=226]="shareToOutlook",e[e.shareToTeamsAccountError=227]="shareToTeamsAccountError",e[e.shareToTeamsDesktopDownload=228]="shareToTeamsDesktopDownload",e[e.shareToTeamsSubmission=229]="shareToTeamsSubmission",e[e.shareTray=230]="shareTray",e[e.stage=231]="stage",e[e.startSharingBrowserTab=232]="startSharingBrowserTab",e[e.startSharingContentCamera=233]="startSharingContentCamera",e[e.startSharingDesktop=234]="startSharingDesktop",e[e.startSharingMSWhiteboard=235]="startSharingMSWhiteboard",e[e.startSharingWindow=236]="startSharingWindow",e[e.stopPresentingMSFTWhiteboard=237]="stopPresentingMSFTWhiteboard",e[e.stopPresentingPowerPointFile=238]="stopPresentingPowerPointFile",e[e.stopSharingContent=239]="stopSharingContent",e[e.store=240]="store",e[e.storeFeed=241]="storeFeed",e[e.storeSearch=242]="storeSearch",e[e.switchLanguagePrompt=243]="switchLanguagePrompt",e[e.tabMgmt=244]="tabMgmt",e[e.takeControlOfPowerPointSharing=245]="takeControlOfPowerPointSharing",e[e.teamRenewal=246]="teamRenewal",e[e.transcript=247]="transcript",e[e.turnComputerSoundOff=248]="turnComputerSoundOff",e[e.turnComputerSoundOn=249]="turnComputerSoundOn",e[e.ufd=250]="ufd",e[e.unreadMsg=251]="unreadMsg",e[e.upToEdit=252]="upToEdit",e[e.videoEffects=253]="videoEffects",e[e.viewerChangesSlideDuringPowerPointSharing=254]="viewerChangesSlideDuringPowerPointSharing",e[e.viewerReturnsToPresenter=255]="viewerReturnsToPresenter",e[e.voicemail=256]="voicemail",e[e.webinar=257]="webinar",e[e.webinarCreate=258]="webinarCreate",e[e.webinarD365Link=259]="webinarD365Link",e[e.webinarD365PromoOffer=260]="webinarD365PromoOffer"}(m||(m={})),function(e){e[e.anonymous=0]="anonymous",e[e.default=1]="default",e[e.guest=2]="guest",e[e.msaGuest=3]="msaGuest",e[e.msaMember=4]="msaMember",e[e.otpGuest=5]="otpGuest",e[e.otpMember=6]="otpMember"}(p||(p={})),function(e){e[e.Admin=0]="Admin",e[e.Anonymous=1]="Anonymous",e[e.Guest=2]="Guest",e[e.Regular=3]="Regular"}(g||(g={})),function(e){e[e.acceptButton=0]="acceptButton",e[e.aliasPrivacyOpenSettings=1]="aliasPrivacyOpenSettings",e[e.atMentionResultList=2]="atMentionResultList",e[e.audioCallButton=3]="audioCallButton",e[e.attachment=4]="attachment",e[e.banner=5]="banner",e[e.blockButton=6]="blockButton",e[e.bookmarkButton=7]="bookmarkButton",e[e.botCard=8]="botCard",e[e.button=9]="button",e[e.calendar=10]="calendar",e[e.channelAction=11]="channelAction",e[e.recordButton=12]="recordButton",e[e.cancelButton=13]="cancelButton",e[e.channelListHeaderAction=14]="channelListHeaderAction",e[e.chat=15]="chat",e[e.chatBubble=16]="chatBubble",e[e.checkbox=17]="checkbox",e[e.closeDialog=18]="closeDialog",e[e.compose=19]="compose",e[e.confirmationDialog=20]="confirmationDialog",e[e.confirmButton=21]="confirmButton",e[e.contentBubble=22]="contentBubble",e[e.deeplink=23]="deeplink",e[e.deleteButton=24]="deleteButton",e[e.dialog=25]="dialog",e[e.discardEditMessageButton=26]="discardEditMessageButton",e[e.download=27]="download",e[e.dropdown=28]="dropdown",e[e.editButton=29]="editButton",e[e.copyLinkMessage=30]="copyLinkMessage",e[e.editMessage=31]="editMessage",e[e.engageDriving=32]="engageDriving",e[e.extensibleAppPanel=33]="extensibleAppPanel",e[e.feeds=34]="feeds",e[e.fullScreen=35]="fullScreen",e[e.fun=36]="fun",e[e.inContextAppStoreDialog=37]="inContextAppStoreDialog",e[e.inspect=38]="inspect",e[e.installButton=39]="installButton",e[e.jit=40]="jit",e[e.link=41]="link",e[e.list=42]="list",e[e.manageApps=43]="manageApps",e[e.meCard=44]="meCard",e[e.meetingDetailsPanel=45]="meetingDetailsPanel",e[e.menu=46]="menu",e[e.menuItem=47]="menuItem",e[e.message=48]="message",e[e.messageMenuItem=49]="messageMenuItem",e[e.messageTranslationIcon=50]="messageTranslationIcon",e[e.messageReactions=51]="messageReactions",e[e.meetingReactions=52]="meetingReactions",e[e.msaLinkClick=53]="msaLinkClick",e[e.nav=54]="nav",e[e.notificationSettings=55]="notificationSettings",e[e.openDialog=56]="openDialog",e[e.organizationButton=57]="organizationButton",e[e.other=58]="other",e[e.overflowMenu=59]="overflowMenu",e[e.people=60]="people",e[e.peoplePicker=61]="peoplePicker",e[e.pin=62]="pin",e[e.previewButton=63]="previewButton",e[e.previewCard=64]="previewCard",e[e.lowerHandButton=65]="lowerHandButton",e[e.quickPickerPanel=66]="quickPickerPanel",e[e.saveButton=67]="saveButton",e[e.scrollBar=68]="scrollBar",e[e.search=69]="search",e[e.searchBar=70]="searchBar",e[e.searchAllLeftCarouselArrowAction=71]="searchAllLeftCarouselArrowAction",e[e.searchAllRightCarouselArrowAction=72]="searchAllRightCarouselArrowAction",e[e.searchSeeMoreButton=73]="searchSeeMoreButton",e[e.searchRelevanceFilterAction=74]="searchRelevanceFilterAction",e[e.searchLinkHoverAction=75]="searchLinkHoverAction",e[e.searchBookmarkHoverAction=76]="searchBookmarkHoverAction",e[e.searchReplyHoverAction=77]="searchReplyHoverAction",e[e.searchCallHoverAction=78]="searchCallHoverAction",e[e.searchVideoHoverAction=79]="searchVideoHoverAction",e[e.searchEmailHoverAction=80]="searchEmailHoverAction",e[e.searchPopoutHoverAction=81]="searchPopoutHoverAction",e[e.searchChatHoverAction=82]="searchChatHoverAction",e[e.searchDownloadHoverAction=83]="searchDownloadHoverAction",e[e.searchMoreHoverAction=84]="searchMoreHoverAction",e[e.defaultSearchHoverClick=85]="defaultSearchHoverClick",e[e.searchResultItemExpanded=86]="searchResultItemExpanded",e[e.searchResultItemCollapsed=87]="searchResultItemCollapsed",e[e.searchResultListItem=88]="searchResultListItem",e[e.searchResultChatItem=89]="searchResultChatItem",e[e.searchResultChannelItem=90]="searchResultChannelItem",e[e.searchFeedback=91]="searchFeedback",e[e.searchPagination=92]="searchPagination",e[e.searchMessageTypeFilter=93]="searchMessageTypeFilter",e[e.searchMentionFilter=94]="searchMentionFilter",e[e.searchTeamAndChannelFilter=95]="searchTeamAndChannelFilter",e[e.searchRelevanceFilter=96]="searchRelevanceFilter",e[e.searchClearAllFilters=97]="searchClearAllFilters",e[e.searchPeopleFilter=98]="searchPeopleFilter",e[e.searchAttachmentFilter=99]="searchAttachmentFilter",e[e.searchFileTypeFilter=100]="searchFileTypeFilter",e[e.searchDateFilter=101]="searchDateFilter",e[e.select=102]="select",e[e.send=103]="send",e[e.sendMessageButton=104]="sendMessageButton",e[e.shareMenuButton=105]="shareMenuButton",e[e.slider=106]="slider",e[e.smartReplyButton=107]="smartReplyButton",e[e.store=108]="store",e[e.tab=109]="tab",e[e.teamAction=110]="teamAction",e[e.taskBarMenuItem=111]="taskBarMenuItem",e[e.teamChannelListHeaderAction=112]="teamChannelListHeaderAction",e[e.toggle=113]="toggle",e[e.updateButton=114]="updateButton",e[e.videoButton=115]="videoButton",e[e.viewer=116]="viewer",e[e.muteButton=117]="muteButton",e[e.shareScreenButton=118]="shareScreenButton",e[e.shareScreenPanel=119]="shareScreenPanel",e[e.settingsTabButton=120]="settingsTabButton",e[e.unblockButton=121]="unblockButton",e[e.meetingNotesButton=122]="meetingNotesButton",e[e.viewBackgroundEffectsButton=123]="viewBackgroundEffectsButton",e[e.effectTypeSelection=124]="effectTypeSelection",e[e.applyBackgroundEffectsButton=125]="applyBackgroundEffectsButton",e[e.hideBackgroundEffectsButton=126]="hideBackgroundEffectsButton",e[e.callHealth=127]="callHealth"}(h||(h={})),function(e){e.x64="x64",e.ia32="ia32",e.x86="x86",e.unknown="unknown"}(v||(v={})),function(e){e.MACOSX="UNIX/MACINTOSH",e.UNIX="UNIX",e.UNKNOWN="Unknown",e.WINDOWS="Windows"}(f||(f={})),function(e){e.ONLINE="ONLINE",e.OFFLINE="OFFLINE"}(y||(y={})),function(e){e[e.auth=0]="auth",e[e.callMeetingContent=1]="callMeetingContent",e[e.callMeetingManagement=2]="callMeetingManagement",e[e.callMeetingStageContent=3]="callMeetingStageContent",e[e.callSetting=4]="callSetting",e[e.channelContent=5]="channelContent",e[e.chatContent=6]="chatContent",e[e.chatManagement=7]="chatManagement",e[e.commandSearch=8]="commandSearch",e[e.lowerHand=9]="lowerHand",e[e.messageManagement=10]="messageManagement",e[e.mute=11]="mute",e[e.peopleContent=12]="peopleContent",e[e.raiseHand=13]="raiseHand",e[e.teamChannelManagement=14]="teamChannelManagement",e[e.lmsIntegrationContent=15]="lmsIntegrationContent",e[e.umute=16]="umute"}(S||(S={})),function(e){e[e.addContact=0]="addContact",e[e.addSpeedDial=1]="addSpeedDial",e[e.audioDeviceSetting=2]="audioDeviceSetting",e[e.backgroundEffect=3]="backgroundEffect",e[e.blockContact=4]="blockContact",e[e.callForwardingSetting=5]="callForwardingSetting",e[e.callGroupSetting=6]="callGroupSetting",e[e.callHealth=7]="callHealth",e[e.callHistorySummary=8]="callHistorySummary",e[e.callHistoryRecording=9]="callHistoryRecording",e[e.callHistoryTranscript=10]="callHistoryTranscript",e[e.changeFileViewLayout=11]="changeFileViewLayout",e[e.chatListManagement=12]="chatListManagement",e[e.composeMsg=13]="composeMsg",e[e.deleteVoicemail=14]="deleteVoicemail",e[e.editConversationName=15]="editConversationName",e[e.copyLinkMsg=16]="copyLinkMsg",e[e.editMsg=17]="editMsg",e[e.executePowerbarSearch=18]="executePowerbarSearch",e[e.extensibilityApp=19]="extensibilityApp",e[e.initiateCall=20]="initiateCall",e[e.initiateChat=21]="initiateChat",e[e.initiatePowerbar=22]="initiatePowerbar",e[e.installSystemAudioDriver=23]="installSystemAudioDriver",e[e.markAsRead=24]="markAsRead",e[e.markAsUnread=25]="markAsUnread",e[e.meetingOptions=26]="meetingOptions",e[e.meetingReactions=27]="meetingReactions",e[e.meetingTabNavigation=28]="meetingTabNavigation",e[e.messageInteractions=29]="messageInteractions",e[e.messageReactions=30]="messageReactions",e[e.messagingInteractions=31]="messagingInteractions",e[e.mute=32]="mute",e[e.newChat=33]="newChat",e[e.peopleCardQuickActions=34]="peopleCardQuickActions",e[e.peoplePickerInitiate=35]="peoplePickerInitiate",e[e.peoplePickerResults=36]="peoplePickerResults",e[e.pinMessage=37]="pinMessage",e[e.profileManagement=38]="profileManagement",e[e.raiseHand=39]="raiseHand",e[e.readMsg=40]="readMsg",e[e.recordMeeting=41]="recordMeeting",e[e.removeSpeedDial=42]="removeSpeedDial",e[e.search=43]="search",e[e.searchAllCarouselArrowInteraction=44]="searchAllCarouselArrowInteraction",e[e.searchBoxInteraction=45]="searchBoxInteraction",e[e.searchFilterInteraction=46]="searchFilterInteraction",e[e.searchHoverActionInteraction=47]="searchHoverActionInteraction",e[e.searchPageInteraction=48]="searchPageInteraction",e[e.searchRelevanceFilterInteraction=49]="searchRelevanceFilterInteraction",e[e.searchResultInteraction=50]="searchResultInteraction",e[e.seeSeeMoreButtonInteraction=51]="seeSeeMoreButtonInteraction",e[e.shareContent=52]="shareContent",e[e.shareFile=53]="shareFile",e[e.shareScreen=54]="shareScreen",e[e.signout=55]="signout",e[e.sisu=56]="sisu",e[e.tabNavigation=57]="tabNavigation",e[e.tagManagement=58]="tagManagement",e[e.teamManagement=59]="teamManagement",e[e.teamRenewal=60]="teamRenewal",e[e.unblockContact=61]="unblockContact",e[e.unMute=62]="unMute",e[e.updateSystemAudioDriver=63]="updateSystemAudioDriver",e[e.video=64]="video",e[e.videoEffects=65]="videoEffects",e[e.mediaStreams=66]="mediaStreams",e[e.videoEffectsApp=67]="videoEffectsApp"}(k||(k={})),function(e){e.background="background",e.foreground="foreground"}(b||(b={})),function(e){e.maximized="maximized",e.minimized="minimized",e.systray="systray"}(_||(_={})),function(e){e.copy="Copy"}(C||(C={})),function(e){e.nav="nav",e.notification="notification"}(w||(w={})),function(e){e.Cold="cold",e.Warm="warm"}(T||(T={}))},989087:(e,t,n)=>{"use strict";var i,a,o,r,s;n.d(t,{Mv:()=>i,Ky:()=>a,sG:()=>o,Mb:()=>r,$E:()=>s}),function(e){e[e.general=0]="general",e[e.team=1]="team",e[e.personal=2]="personal",e[e.group=4]="group"}(i||(i={})),function(e){e[e.na=0]="na",e[e.bots=1]="bots",e[e.tabs=2]="tabs",e[e.messaging=3]="messaging",e[e.connectors=4]="connectors"}(a||(a={})),function(e){e[e.na=0]="na",e[e.card=1]="card",e[e.deepLink=2]="deepLink",e[e.messageExtension=3]="messageExtension",e[e.platformExtensionTab=4]="platformExtensionTab",e[e.contentBubble=5]="contentBubble",e[e.shareToOutlook=6]="shareToOutlook",e[e.adaptiveCardTab=7]="adaptiveCardTab"}(o||(o={})),function(e){e.bot="bot",e.inputextension="inputextension",e.connectors="connectors"}(r||(r={})),function(e){e.carousel="carousel",e.list="list"}(s||(s={}))},971113:(e,t,n)=>{"use strict";var i;n.d(t,{x:()=>i}),function(e){e[e.Perf=0]="Perf",e[e.Scenario=1]="Scenario",e[e.Logging=2]="Logging",e[e.Heartbeat=3]="Heartbeat",e[e.Http=4]="Http",e[e.UserBI=5]="UserBI",e[e.Endpoint=6]="Endpoint",e[e.ClickStream=7]="ClickStream"}(i||(i={}))},773176:(e,t,n)=>{"use strict";var i;n.d(t,{R:()=>i}),function(e){e.flyout="flyout",e.iFrame="iFrame",e.primary="primary",e.secondary="secondary"}(i||(i={}))},505263:(e,t,n)=>{"use strict";var i,a;n.d(t,{Q:()=>i,N:()=>a}),function(e){e.Unknown="unknown",e.Prod="prod"}(i||(i={})),function(e){e.MW="MW",e.Anglr="Anglr",e.ShareToTeams="ShareToTeams",e.Files="Files",e.Calendar="Calendar",e.MtgOpt="MtgOpt",e.EmbedClient="EmbedClient",e.LmsIntegration="LmsIntegration",e.CallingEmbed="CallingEmbed",e.ReactWebClient="ReactWebClient"}(a||(a={}))},911023:(e,t,n)=>{"use strict";var i;n.d(t,{W:()=>i}),function(e){e.WindowReady="windowReady",e.WindowUnloaded="windowUnloaded",e.WindowAppStart="windowAppStart",e.CoreInitialized="coreInitialized",e.CommandEvent="commandEvent",e.ExperienceStarted="experienceStarted",e.CoreInitializationFailed="coreInitializationFailed",e.ExtendedEntityContainerState="extendedEntityContainerState",e.MainWindowBlockedState="mainWindowBlockedState"}(i||(i={}))},786744:(e,t,n)=>{"use strict";var i,a,o,r,s,l;n.d(t,{NR:()=>i,Bh:()=>a,RY:()=>o,GJ:()=>r,AR:()=>s,us:()=>l}),function(e){e.Windows="windows",e.Mac="mac",e.Linux="linux",e.ChromeOS="chromeos",e.Android="android",e.IOS="ios",e.WindowsPhone="windowsphone",e.Unknown="unknown"}(i||(i={})),function(e){e.Web="web",e.Desktop="desktop",e.CDLWorker="cdlworker",e.Embed="embed",e.Maglev="maglev"}(a||(a={})),function(e){e.Embed="embed"}(o||(o={})),function(e){e.Outlook="outlook",e.Unknown="unknown"}(r||(r={})),function(e){e.Edge="edge",e.IE="ie",e.Safari="safari",e.Chrome="chrome",e.Firefox="firefox",e.Electron="electron",e.Unknown="unknown"}(s||(s={})),function(e){e[e.Web=1415]="Web",e[e.Desktop=27]="Desktop",e[e.Mac=28]="Mac",e[e.Linux=41]="Linux",e[e.Rigel=34]="Rigel",e[e.SurfaceHub=35]="SurfaceHub",e[e.SurfaceHub2=38]="SurfaceHub2",e[e.Maglev=48]="Maglev",e[e.MetaOsOffice=5500]="MetaOsOffice",e[e.MetaOsOutlook=5501]="MetaOsOutlook"}(l||(l={}))},448541:(e,t,n)=>{"use strict";var i,a;n.d(t,{B:()=>i,_:()=>a}),function(e){e.OpenOnMainRenderer="main"}(i||(i={})),function(e){e.DeepLink="deepLink",e.ImmersiveReader="immersiveReader",e.MeetingNotes="meetingNotes",e.Transcript="Transcript",e.JoinBroadcastAsAttendee="joinBroadcastAsAttendee"}(a||(a={}))},486410:(e,t,n)=>{"use strict";var i,a,o,r;n.d(t,{QP:()=>i,d:()=>a,zF:()=>r}),function(e){e.standAlone="main",e.iframe="iFrame",e.secondary="MW",e.embedded="EDOM",e.worker="Worker"}(i||(i={})),function(e){e.flyout="flyout",e.main="main"}(a||(a={})),function(e){e.owa="OWA",e.outlook="Outlook",e.officeOnline="OfficeOnline",e.wordWeb="WordWeb",e.word="Word",e.excelWeb="ExcelWeb",e.excel="Excel",e.powerPointWeb="PowerPointWeb",e.powerPoint="PowerPoint",e.lmsCanvas="Canvas",e.lmsBlackBoard="BlackBoard",e.unknown="unknown",e.thirdParty="ThirdParty"}(o||(o={})),function(e){e.userInitiated="userInitiated"}(r||(r={}))},999108:(e,t,n)=>{"use strict";var i,a,o,r,s;n.d(t,{rY:()=>i,cr:()=>a,Gx:()=>o,H:()=>s}),function(e){e.WindowInitialized="windowInitialized",e.WindowErrored="windowErrored",e.GetAadToken="aadGetToken",e.GetDriveItemResponse="getDriveItemResponse",e.GetAadCurrentUser="aadCurrentUser",e.AadClearCacheForResource="aadClearCache",e.GetStateData="getStateData",e.GetLogs="getLogs",e.GetSettings="getSettings",e.TriggerAutoBrb="triggerAutoBrb",e.ShouldShowChatNotification="shouldShowChatNotification",e.GetLeaks="getLeaks",e.GetMemory="getMemory",e.UpdateWindowState="updateWindowState",e.AppStateSyncMessage="appStateSyncMessage",e.CentralDataLayerRequest="centralDataLayer:request",e.CentralDataLayerResponse="centralDataLayer:response",e.ScreenSharingControlMessage="screenSharing:controlMessage",e.HideFileViewerLoader="hideFileViewerLoader",e.StopDocStageScenario="stopDocStageScenario",e.AddScenarioMarker="addScenarioMarker",e.FilesExperienceSendData="filesExperience:sendData",e.FilesExperienceRequestData="filesExperience:requestData",e.ActivityEvent="activityEvent",e.GetAggregatedSettings="getAggregatedSettings",e.SetAggregatedSettings="setAggregatedSettings",e.GetWindowLaunchSubSteps="getWindowLaunchSubSteps",e.CreateWebview="createWebview",e.UnhandledMouseEvent="unhandledMouseEvent",e.GetHeartbeat="getHeartbeat",e.GetApolloCacheStats="getApolloCacheStats",e.GetWindowEntityTypeStats="getWindowEntityTypeStats",e.SetTouchBar="set-touch-bar",e.ClearTouchBar="clear-touch-bar",e.LayoutChangeMessage="layoutChangeMessage",e.UnhandledShortcut="unhandledShortcut",e.NavigateToOpenerLandmark="NavigateToOpenerLandmark",e.NavigateToLandmark="NavigateToLandmark",e.HybridRouteNavigation="hybridRouteNavigation",e.FocusManagementEvent="focusManagementEvent",e.CdlRegistration="cdlRegistration",e.NotificationBannerUpdate="NotificationBannerUpdate",e.EntityCommandTimedOutAtHost="entityCommandTimedOutAtHost",e.ActivateOutlook="activateOutlook"}(i||(i={})),function(e){e.GlobalWindowError="error",e.UnhandledRejection="unhandledrejection"}(a||(a={})),function(e){e.Create="createIframe",e.Destroy="destroyIframe",e.ChildReady="iframeReady",e.Acquired="iframeAcquired",e.ToggleMinimized="toggleChatMinimize"}(o||(o={})),function(e){e.ConversationOpened="conversationOpened",e.CreateNewConversation="createNewConversation",e.EmbedClientInitialized="embedClientInitialized",e.EmbedClientInitializationFailed="embedClientInitializationFailed",e.NewConversationResolved="newConversationResolved",e.SetFocusOnChatList="setFocusOnChatList",e.UpdateSettings="UpdateSettings"}(r||(r={})),function(e){e.LogoutSuccess="logoutSuccessful",e.LogoutFailed="logoutFailed",e.Logout="logout"}(s||(s={}))},557553:(e,t,n)=>{"use strict";n.d(t,{I:()=>o});var i=n(352367);const a="IntentPersistenceService";class o{constructor(e){this._localStorage=e}getAllStoredDeeplinks(){const e=this._localStorage.get(a,i.fO.Experience);return this.jsonParseSafe(e)||{}}storeDeeplink(e,t){const n=this.getAllStoredDeeplinks();n[e]=t.toString(),this.persist(n)}deleteDeeplink(e){const t=this.getAllStoredDeeplinks();delete t[e],this.persist(t)}clear(){this._localStorage.remove(a,i.fO.Experience)}persist(e){this._localStorage.set(a,JSON.stringify(e),i.fO.Experience)}jsonParseSafe(e){if(e)try{return JSON.parse(e)}catch(e){return}}}},144680:(e,t,n)=>{"use strict";n.d(t,{xm:()=>a,qf:()=>o,vu:()=>r,b3:()=>s,j:()=>d});var i=n(9654);const a="[Authentication][DiscoverV2]";var o,r,s,l,c;!function(e){e.userLocale="X-Client-UI-Language",e.skypeTokenAuthzTypeHeader="ms-teams-authz-type",e.claimsChallengeCapable="claimsChallengeCapable",e.consistencyValue="ConsistencyLevel"}(o||(o={})),function(e){e.skypeTokenRefresh="TokenRefresh",e.skypeTokenExplicitLogin="ExplicitLogin",e.strongConsistencyMsInternalUserSignup="MS-Internal-UserSignup",e.strongConsistencyDefaultValue="Organization;ScenarioId={id}"}(r||(r={})),function(e){e[e.DEFAULT_SKYPE_TOKEN_COOL_OFF_PERIOD=i.gT.Two*i.gT.SECONDS_PER_MINUTE*i.gT.MILLI_PER_SECOND]="DEFAULT_SKYPE_TOKEN_COOL_OFF_PERIOD"}(s||(s={})),function(e){e.skypeAuthAnonReloadJoinLocation="skypeAuthAnonReloadJoinLocation",e.skypeAuthForceAnonReload="skypeAuthForceAnonReload"}(l||(l={})),function(e){e[e.ONE=1]="ONE",e[e.TWO=2]="TWO",e[e.FIVE=5]="FIVE",e[e.FIFTEEN=15]="FIFTEEN",e[e.SIXTEEN=16]="SIXTEEN",e[e.THIRTY=30]="THIRTY"}(c||(c={}));const d={SKYPE_SEND_REQUEST:"skype_send_request",SKYPE_RECEIVED_RESPONSE:"skype_received_response",SKYPE_SEND_REQUEST_DESKTOP:"skype_send_request_desktop",SKYPE_SEND_REQUEST_WORKER:"skype_send_request_worker",SKYPE_TOKEN_RECEIVED_WORKER:"skype_token_received_worker",RECEIVE_CLAIM:"receive_claim"}},524130:(e,t,n)=>{"use strict";n.d(t,{bO:()=>w,r2:()=>T,db:()=>I,LO:()=>A,uc:()=>M,S9:()=>F,Z2:()=>R,Mu:()=>P,Qe:()=>D,br:()=>j,ZC:()=>x,nD:()=>O,TB:()=>L,wC:()=>U,WA:()=>B,H:()=>W,nd:()=>H,lm:()=>$,UE:()=>z,l2:()=>G,JY:()=>q,wF:()=>J,_1:()=>K});var i=n(231191),a=n(352367),o=n(775214),r=n(356452),s=n(558210),l=n(682796),c=n(459012),d=n(723128),u=n(737188),m=n(916501),p=n(980633),g=n(920909),h=n(132887),v=n(238091),f=n(547514),y=n(9654),S=n(498765),k=n(399019),b=n(144680),_=n(635649);const C=[a.jK.NetworkOffline,a.jK.Forbidden],w={context:b.xm,subContext:"_getDiscoverResponse",errorCode:a.jK.NetworkOffline,message:"Network is offline, not making any call",isExpected:!0},T=(e,t,n)=>{var i,r;let s;if(!n){const{response:t}=e;s=null==t?void 0:t.isExpected}let l=e;l.context||(l=(0,o.Jn)(e,a.w5.Discover,a.jK.InvalidResponse,"",{error:e.stack},e.message||("string"==typeof e?e:(0,S.u4)(e))));const{serverResponse:{status:c,body:d,headers:u={}}={},context:m}=l;let{reason:p,message:g,code:h=a.jK.InvalidResponse,subContext:v=""}=l;return p=u?Object.assign(Object.assign({},p),{responseCorrelationId:u["correlation-id"],innerError:l}):p,g=(null===(i=d)||void 0===i?void 0:i.message)||g,v=(null===(r=d)||void 0===r?void 0:r.errorCode)||m,h=t?E(c):a.jK.NetworkOffline,(0,o.Tr)(a.w5.Discover,h,v,Object.assign(Object.assign({},p),{innerError:e}),g,l.serverResponse,s)},E=e=>{if(void 0===e)return a.jK.InvalidResponse;switch(e){case r.qb.FORBIDDEN:return a.jK.Forbidden;case r.qb.NOT_AUTHORIZED:return a.jK.Unauthorized;default:return a.jK.FailedToFetch}},I=(e,t,n)=>{var i;if(!e)throw t;const a=Object.assign(Object.assign({},t),{errorCode:t.code,reason:(0,S.u4)(t.reason)});return V(t)||!n&&(null===(i=t)||void 0===i?void 0:i.isExpected)?e.cancel(a):e.fail(a),t.reason&&(t.reason.isExpectedError=V(t)),t},N=(0,u.type)({skypeid:u.string}),A=((0,u.type)({skypeTokenData:(0,u.type)({regionGtms:s.UH,token:(0,u.type)({skypeToken:u.string,expiration:u.number,userDetails:(0,u.partial)({region:u.string})})})},"token"),(e,t)=>{if(!e)return t.error("Can not get userId due to skypeToken is undefined"),"";const{skypeid:n}=(0,m.as)(N,(0,k.J)(e));return`8:${n}`}),M=e=>{let t=e.findScenario(p.RG.GetSkypeToken);return t||(t=e.newScenario(p.RG.GetSkypeToken),t.mark("Non authz error scenario")),t},F=e=>({user:e,typeName:"Discover",key:h.op}),R=e=>({user:e,typeName:"Discover",key:h.rz}),P=e=>({user:e,typeName:"Discover",key:h.ru}),D=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,a;const o=Date.now(),{regionGtms:r,licenseDetails:s,skypeToken:l,tokens:c,region:d,regionSettings:u,skypeGuestUserToken:m,consumerLicenseDetails:p}=yield e.body.json();null===(i=t.eventData)||void 0===i||i.push("parsejson:1");const g=l||c||m,h=null!==(a=null==g?void 0:g.skypeToken)&&void 0!==a?a:null==g?void 0:g.skypetoken;let v;return n.log(`[_acquireSkypeTokenWeb][${null==t?void 0:t.correlationId}] Response parsed succeed.`),p&&(v={timeStamp:new Date(o),consumerLicenseDetails:p}),{userId:A(h,n),regionGtms:r,licenseDetails:s,skypeToken:h,expires:new Date(o+(null==g?void 0:g.expiresIn)*y.gT.MILLI_PER_SECOND),region:d,regionSettings:u,consumerLicenseDetails:v}})),j=(e,t,n)=>{if(e.push("fn:_getUserDetailFromHost"),!t)return void e.push("_bootstrapData:0");const{userId:i,region:a,licenseDetails:o}=t;return i&&a&&o?{id:i,licenseDetails:o,region:a}:(n.log(`[_getUserDetailFromHost] userId:${!!i}|region:${!!a}|licenseDetails:${!!o}`),void e.push(`userId:${!!i}|region:${!!a}|licenseDetails:${!!o}`))},x=(e,t)=>{var n;const i=A(e.skypeToken,t);return t.log(`[convertResponseToISkypeToken] Skypeid received from discovery. Region: ${null==e?void 0:e.region}`),{skypeToken:null==e?void 0:e.skypeToken,expiration:null===(n=null==e?void 0:e.expires)||void 0===n?void 0:n.getTime(),regionGtms:null==e?void 0:e.regionGtms,userDetails:{id:i,licenseDetails:Object.assign(Object.assign({},null==e?void 0:e.licenseDetails),{consumerLicenseDetails:null==e?void 0:e.consumerLicenseDetails}),region:null==e?void 0:e.region,regionSettings:null==e?void 0:e.regionSettings}}},O=(e,t,n)=>{var i;if(!(0,v.FG)(e.userIdentifier,(0,v.Xx)(t)))throw null===(i=e.eventData)||void 0===i||i.push("userMismatch"),n.warn("[_acquireSkypeTokenWeb] user obtained does not match provided userIdentifier, throw error."),(0,f.Tr)({context:b.xm,subContext:"_acquireSkypeTokenWeb",errorCode:h.SM.UserNotFoundError,message:"User obtained does not match provided userIdentifier.",correlationId:e.correlationId,isExpected:!0})},L=(e,t,n,i,a)=>{const{authOverrides:o}=n.get(l.J.Host),{authzEndpointUrl:r,authzUrl:s,regionGtmsEnv:d}=n.get(l.J.Auth),u=((e,t,n,i)=>{const{environment:a}=(null==i?void 0:i.get(l.J.Metadata))||{};let o={method:"POST",url:n?`${e}?region_gtms_env=${n}`:`${e}`,serviceName:c.EJ.Auth,apiName:"acquireSkypeTokenWeb"};return t.role===_.AuthenticationUserRole.Anonymous&&(o=Object.assign(Object.assign({},o),{url:`${e}/visitor`,body:`{"tenantId": "${t.profile.tid}"}`})),a!==g.s_.life||t.role!==_.AuthenticationUserRole.Guest&&t.role!==_.AuthenticationUserRole.Anonymous||(o=Object.assign(Object.assign({},o),{url:`${e}/guest?region_gtms_env=${n}`})),o})((null==o?void 0:o.authzEndpointUrl)||r||s||h.ej.AUTHZ_DEFAULT_BASE_URL,e,d,n);return i.log(`[_getFormatRequest][${t}] Request formatted. `),u.headers=((e,t,n)=>{const i={},a=null==t?void 0:t.config.localeCode,{disableClaimsChallenge:o,disablePhoneAccrualSkip:r}=n.get(l.J.Auth);return a&&(i[b.qf.userLocale]=a),o||(i[b.qf.claimsChallengeCapable]="true"),i[b.qf.skypeTokenAuthzTypeHeader]=b.vu.skypeTokenRefresh,i.clientRequestId=e,!r&&(i["x-ms-skip-phone"]="true"),i})(t,a,n),u},U=e=>{var t,n,i,a,o,r,s;return{id:e.id,region:e.region,tenant:{type:(null===(t=e.licenseDetails)||void 0===t?void 0:t.isFreemium)?d.OV.Freemium:d.OV.Work},isAdvComms:(null===(n=e.licenseDetails)||void 0===n?void 0:n.isAdvComms)||!1,isTranscriptEnabled:(null===(i=e.licenseDetails)||void 0===i?void 0:i.isTranscriptEnabled)||!1,isFreemium:(null===(a=e.licenseDetails)||void 0===a?void 0:a.isFreemium)||!1,isTrial:(null===(o=e.licenseDetails)||void 0===o?void 0:o.isTrial)||!1,isWebinarEnabled:null===(s=null===(r=e.licenseDetails)||void 0===r?void 0:r.isWebinarEnabled)||void 0===s||s}},B=(e,t,n)=>{"object"==typeof e&&(e.context=e.context||b.xm,e.subContext=e.subContext||t,e.correlationId=e.correlationId||n)},W=(e,t,n,i,a)=>{const o=`${null==e?void 0:e.subContext}: Failed to get skype token; correlationId:${e.correlationId}, status:${a}, message:${t}, eventData: ${null==n?void 0:n.join(";")}`;return e.isExpected?i.warn(o):i.error(o),e},H=(e,t,n)=>{const i=null==e?void 0:e.join(";"),a=(null==n?void 0:n.get(l.J.Metadata))||{},o=n.get(l.J.Auth);return{message:`${i}::isOnline-${t}::environment:${null==a?void 0:a.environment}`,endpointUrl:null==o?void 0:o.authzUrl,resource:null==o?void 0:o.authzResource}},$=(e,t,n,i,o,s,c)=>{var d,u,m;const{serverResponse:{status:p,body:g}={}}=e;let{message:h,errorCode:v}=e;const{reason:f,code:y}=e,k=n&&!(e.context===a.w5.RejectHttpError&&y===a.jK.RemoteOperationFailed),_=null==t?void 0:t.join(";");p&&(v=p===r.qb.FORBIDDEN?a.jK.Forbidden:e.errorCode,h=g.message);const C={reason:f,message:h,eventData:_},w=(0,S.u4)(C),T=e.correlationId,E=(null==s?void 0:s.get(l.J.Metadata))||{},I=s.get(l.J.Auth),N={context:null!==(d=null==e?void 0:e.context)&&void 0!==d?d:b.xm,subContext:null==e?void 0:e.subContext,message:`${h}::isOnline-${k}::env:${null==E?void 0:E.environment}`,errorCode:k?null!=v?v:y:a.jK.NetworkOffline,statusCode:p,correlationId:T,reason:w,endpointUrl:null==I?void 0:I.authzUrl,hostName:null===(u=null==c?void 0:c.config)||void 0===u?void 0:u.currentUrl,resource:null==I?void 0:I.authzResource,isExpected:!k||e.isExpected};if(void 0===e.isExpected&&(e.isExpected=!k),!((null===(m=(0,S.u4)(e.reason))||void 0===m?void 0:m.indexOf("LoggedAlready"))>-1)&&i){switch(((e,t,n)=>{const{errorCode:i,code:o}=t;if(!e||t.isExpected||n===r.qb.FORBIDDEN||i===a.jK.NetworkOffline||o===a.jK.NetworkOffline)return"cancel";if(i===a.jK.TimedOut||o===a.jK.TimedOut)return"incomplete";switch(n){case r.qb.NOT_AUTHORIZED:case-1:case r.qb.THROTTLED:return"incomplete";default:return"fail"}})(k,e,p)){case"stop":i.stop(N);break;case"incomplete":i.incomplete(N);break;case"cancel":i.cancel(N);break;case"fail":default:i.fail(N)}}return W(e,h,t,o,p)};function V(e){return C.indexOf(e.code)>-1||"Authentication::getUser"===e.subContext&&e.message.indexOf("User information is not available")>-1||e.message.indexOf("getUser: MSAL account not found")>-1||e.message.indexOf("Get skype token promise timed out, keep retrying. Is expected:true")>-1}function z(e,t,n,i){return t.getUser().then((()=>{const a=q(i),{requireSkypetokenForMT:o}=i.get(l.J.Auth),r=t.authorize(e,a);return o?n.authorize(r,"x-skypetoken"):r}))}function G(e,t,n){return t.getUser().then((()=>{const{cmdMeetingArtifactsServiceResource:i}=n.get(l.J.CMDMeetingArtifactsService);return t.authorize(e,null!=i?i:"")}))}function q(e){const{isRunningGlassjar:t,mtAuthResourceOverride:n}=e.get(l.J.Test);if(t&&n)return n;const{authOverrides:i}=e.get(l.J.Host),{mtResource:a}=e.get(l.J.Auth);return(null==i?void 0:i.mtResource)||a||g.O_.MT}function J(e,t,n,i){const{enableSetTimerToCancelSkypeTimedOutScenario:a}=n.get(l.J.Auth),o=t.silent;if(!a||o)return;const r=y.gT.Two*y.gT.MILLI_PER_MINUTE;return i.setTimeout((()=>{const{eventData:n=[]}=t;n.push("canceling_before_timeout_at_58m");const i=n.join(";");e.cancel({reason:i})}),y.gT.MILLISECONDS_PER_HOUR-r)}function K(e,t){e&&t.clearTimeout(e)}},226658:(e,t,n)=>{"use strict";n.d(t,{Jq:()=>$});var i=n(231191),a=n(558210),o=n(682796),r=n(723128),s=n(999108),l=n(459012),c=n(926353),d=n(356452),u=n(341939),m=n(980633),p=n(772635),g=n(399019),h=n(498765),v=n(708362),f=n(745534),y=n(843149),S=n(860467),k=n(9654),b=n(524130),_=n(312833);const C=(e,t)=>e.decode(t).getOrElseL((e=>{throw new TypeError((0,_.Rn)(e).join("\n"))}));var w=n(737188),T=n(916501),E=n(775214),I=n(352367),N=n(906693);const A=(0,w.partial)({isNotificationEnabled:w.boolean,isUnifiedPresenceEnabled:w.boolean,isOutOfOfficeIntegrationEnabled:w.boolean,isContactMigrationEnabled:w.boolean,isAppsDiscoveryEnabled:w.boolean,isFederationEnabled:w.boolean}),M=(0,w.partial)({licenseDetails:a.Jk}),F=(0,w.partial)({regionSettings:A}),R=(0,w.intersection)([(0,w.type)({region:w.string,regionGtms:a.UH,tokens:(0,w.type)({skypeToken:w.string,expiresIn:w.number})}),F,M]),P=(0,w.type)({skuId:w.string,skuName:w.string,maxMeetingDurationMinutes:w.number,maxMeetingParticipants:w.number}),D=(0,w.intersection)([(0,w.type)({hasTeamsLicense:w.boolean}),(0,w.partial)({teamsFree:(0,w.type)({maxMeetingDurationMinutes:w.number,maxMeetingParticipants:w.number}),licensedProducts:(0,w.array)(P)})]),j=(0,w.partial)({consumerLicenseDetails:D}),x=(0,w.intersection)([(0,w.type)({regionGtms:a.UH,skypeToken:(0,w.type)({skypetoken:w.string,expiresIn:w.number})}),j,M]),O=(0,w.type)({skypeTokenData:(0,w.type)({regionGtms:a.UH,token:(0,w.type)({skypeToken:w.string,expiration:w.number,userDetails:(0,w.partial)({region:w.string})})})},"token"),L=(0,w.type)({skypeid:w.string}),U=1e3,B="Discover",W="https://api.spaces.skype.com";function H(e){return f.getParser(e.navigator.userAgent).isBrowser("ie",!0)}class ${constructor(e,t,n,u,m,g,h,f,S,b,_,w=(0,v.J)()){var T,E;this.aad=e,this.coreSettings=u,this.scenarioFactory=m,this.isOnline=g,this.shouldNotDecodeTokenForIE=h,this.onDiscoverSuccess=f,this.onDiscoverFail=S,this.isCDLWorker=b,this.cdlAuthClient=_,this.globalScope=w,this._localStorageKeys=[],this.licenseTypeToTenantType=e=>e?r.OV.Freemium:r.OV.Work,this._canGetSkypeTokenFromHost=()=>!!this.bootstrapData,this._acquireSkypeTokenWorker=(e=!1)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this.cdlAuthClient)return Promise.reject("CDL worker auth client unavailable");const t=yield this.cdlAuthClient.getSkypeToken(e);return Object.assign(Object.assign({},t.userDetails),{skypeToken:t.skypeToken,regionGtms:C(a.UH,t.regionGtms),expires:new Date(t.expiration)})})),this._acquireUserDetailsWorker=()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var e,t,n,i,a,o,r;if(!this.cdlAuthClient)return Promise.reject("CDL worker auth client unavailable");const s=yield this.cdlAuthClient.getUserDetails();return{id:s.id,region:s.userDetails.region,tenant:{type:this.licenseTypeToTenantType(null===(e=s.userDetails.licenseDetails)||void 0===e?void 0:e.isFreemium)},isAdvComms:(null===(t=s.userDetails.licenseDetails)||void 0===t?void 0:t.isAdvComms)||!1,isTranscriptEnabled:(null===(n=s.userDetails.licenseDetails)||void 0===n?void 0:n.isTranscriptEnabled)||!1,isFreemium:(null===(i=s.userDetails.licenseDetails)||void 0===i?void 0:i.isFreemium)||!1,isTrial:(null===(a=s.userDetails.licenseDetails)||void 0===a?void 0:a.isTrial)||!1,isWebinarEnabled:null===(r=null===(o=s.userDetails.licenseDetails)||void 0===o?void 0:o.isWebinarEnabled)||void 0===r||r}})),this._acquireSkypeTokenDesktop=()=>this.globalScope.opener.requestMessage(s.rY.GetStateData,{requestType:"skypeToken",timeout:k.lP.ACQUIRE_TOKEN_TIMEOUT}).then((e=>C(O,e))).then((({skypeTokenData:{regionGtms:e,token:{skypeToken:t,expiration:n,userDetails:i}}})=>Object.assign(Object.assign({},i),{skypeToken:t,regionGtms:e,expires:new Date(n)}))),this._acquireSkypeTokenWeb=()=>{const e=Date.now(),{authOverrides:t}=this.coreSettings.get(o.J.Host),{authzEndpointUrl:n,authzUrl:i,regionGtmsEnv:a}=this.coreSettings.get(o.J.Auth),r=(null==t?void 0:t.authzEndpointUrl)||n||i||"https://authsvc.teams.microsoft.com/v1.0/authz";return this.aad.getUser().then((t=>{const n=this.getResponseFromLocalStorage(t.profile.oid,t.profile.tid);if(n)return n;let i={method:"POST",url:a?`${r}?region_gtms_env=${a}`:`${r}`,serviceName:l.EJ.Auth,apiName:"acquireSkypeTokenWeb"};if(t.role===c.w.Anonymous&&(i=Object.assign(Object.assign({},i),{url:`${r}/visitor`,body:`{"tenantId": "${t.profile.tid}"}`})),H(this.globalScope)&&this.shouldNotDecodeTokenForIE)return this.send().then((t=>t(i).then((({body:e})=>e.json())).then((t=>Object.assign(Object.assign({},t),{tokens:Object.assign(Object.assign({},t.tokens),{expires:new Date(e+t.tokens.expiresIn*U)})})))));{const n=this.send().then((e=>e(i).then((({body:e})=>e.json())))),a=t.type===c.C.MsaLife;return this.parseAuthzResponse(n,a,e)}}))},this.logger=t.newLogger("Discover"),this.send=()=>function(e,t,n){return t.getUser().then((()=>{const{authzResource:i}=n.get(o.J.Auth);return t.authorize(e,i||W)}))}(n,e,this.coreSettings).then((e=>(0,p.B)(e,d.qb.OK))),this._skypeToken=new y.X(null),this.bootstrapData=this.coreSettings.get(o.J.Host).authBootstrapData,this.telemetryProvider=(0,N.Yf)(),null===(E=null===(T=e.observeMiddleTierToken)||void 0===T?void 0:T.call(e))||void 0===E||E.subscribe((e=>{void 0===e&&(this._discoveryResponse=void 0)}))}observeSkypeToken(){return this._skypeToken.pipe((0,S.h)((e=>null!==e)))}regionGtm(e){return H(this.globalScope)&&this.shouldNotDecodeTokenForIE?this.getDiscovery().then((t=>{let n=t.regionGtms[e];if(n)return n.endsWith("/")||(n+="/"),n;throw(0,E.Tr)(B,I.jK.InvalidResponse,"regionGtm")})):this.getDiscovery().catch((e=>{var t;if(this._canGetSkypeTokenFromHost()){return{regionGtms:C(a.UH,null===(t=this.bootstrapData)||void 0===t?void 0:t.regionGtms)}}throw e})).then((({regionGtms:{[e]:t}})=>{if(void 0===t)throw new TypeError;return t.href})).catch((e=>{throw e instanceof TypeError?(0,E.Jn)(e,B,I.jK.InvalidResponse,"regionGtm",{}):e}))}skypeid(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.getUser();return new Promise((t=>t(e.id)))}))}getRegion(){return this.getDiscovery().then((({region:e})=>e)).catch((e=>{var t;if(this._canGetSkypeTokenFromHost()){const e=null===(t=this.bootstrapData)||void 0===t?void 0:t.region;if(!e)throw(0,E.Tr)(B,I.jK.InvalidResponse,"getRegion");return e}throw e}))}getUser(){var e,t,n,i;let a;if(this._canGetSkypeTokenFromHost()){const a=null===(e=this.bootstrapData)||void 0===e?void 0:e.userId,o=null===(t=this.bootstrapData)||void 0===t?void 0:t.region,r=null===(n=this.bootstrapData)||void 0===n?void 0:n.licenseDetails;if(a)return this.logger.log(`skypeid and region received from host: ${a} ${o}`),Promise.resolve({id:a,region:o||void 0,tenant:{type:this.licenseTypeToTenantType(null==r?void 0:r.isFreemium)},isAdvComms:(null==r?void 0:r.isAdvComms)||!1,isTranscriptEnabled:(null==r?void 0:r.isTranscriptEnabled)||!1,isFreemium:(null==r?void 0:r.isFreemium)||!1,isTrial:(null==r?void 0:r.isTrial)||!1,isWebinarEnabled:null===(i=null==r?void 0:r.isWebinarEnabled)||void 0===i||i});this.logger.warn("skypeid or region was not received from host when expected")}return this.isCDLWorker?this._acquireUserDetailsWorker():this.getSkypeTokenInfoFromDiscoveryResponse().then((e=>{var t,n,i,o,r,s,l;return a={id:e.userDetails.id,region:e.userDetails.region,tenant:{type:this.licenseTypeToTenantType(null===(t=e.userDetails.licenseDetails)||void 0===t?void 0:t.isFreemium)},isAdvComms:null===(n=e.userDetails.licenseDetails)||void 0===n?void 0:n.isAdvComms,isTranscriptEnabled:null===(i=e.userDetails.licenseDetails)||void 0===i?void 0:i.isTranscriptEnabled,isFreemium:(null===(o=e.userDetails.licenseDetails)||void 0===o?void 0:o.isFreemium)||!1,isTrial:(null===(r=e.userDetails.licenseDetails)||void 0===r?void 0:r.isTrial)||!1,isWebinarEnabled:null===(l=null===(s=e.userDetails.licenseDetails)||void 0===s?void 0:s.isWebinarEnabled)||void 0===l||l},a}))}validateSkypeToken(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return(yield this.validateSkypeTokenV2(e)).skypeToken}))}validateSkypeTokenV2(e){const t=this.getDiscovery(),n=null==e?void 0:e.forceRenew,i=null==e?void 0:e.invalidSkypeToken;return t.then((({expires:e,skypeToken:t})=>!n&&t!==i&&e.getTime()>Date.now()?{skypeToken:t,fromCache:!0}:(this.resetDiscoveryResponse(),this.getDiscovery(n).then((({skypeToken:e})=>({skypeToken:e,fromCache:!1}))))))}getSkypeTokenInfoFromDiscoveryResponse(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return this.getDiscovery().then((e=>{const{skypeid:t}=(0,T.as)(L,(0,g.J)(e.skypeToken)),n=`8:${t}`;this.logger.log(`skypeid received from discovery: ${n}. Region: ${e.region}`);const i={id:n,region:e.region,licenseDetails:Object.assign(Object.assign({},e.licenseDetails),{consumerLicenseDetails:null==e?void 0:e.consumerLicenseDetails}),regionSettings:e.regionSettings};return{regionGtms:e.regionGtms,skypeToken:e.skypeToken,expiration:e.expires.getTime(),userDetails:i}})).catch((e=>{throw this.logger.error(`failed to get skypeid from discovery: ${(0,h.u4)(e)}​​`),e}))}))}getConsumerLicenseDetails(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return this.getSkypeTokenInfoFromDiscoveryResponse().then((e=>{var t,n;return null===(n=null===(t=null==e?void 0:e.userDetails)||void 0===t?void 0:t.licenseDetails)||void 0===n?void 0:n.consumerLicenseDetails}))}))}parseAuthzResponse(e,t,n){return t?e.then((e=>C(x,e))).then((({regionGtms:e,licenseDetails:t,skypeToken:{skypetoken:i,expiresIn:a},consumerLicenseDetails:o})=>({regionGtms:e,skypeToken:i,expires:new Date(n+a*U),licenseDetails:t,consumerLicenseDetails:o?{consumerLicenseDetails:o,timeStamp:new Date}:void 0}))):e.then((e=>C(R,e))).then((({region:e,licenseDetails:t,regionGtms:i,tokens:{skypeToken:a,expiresIn:o},regionSettings:r})=>({region:e,regionGtms:i,skypeToken:a,expires:new Date(n+o*U),licenseDetails:t,regionSettings:r})))}getDiscovery(e=!1){if(!this._discoveryResponse){const t=this.scenarioFactory.newScenario(m.RG.GetSkypeToken),n=this._canGetSkypeTokenFromHost()?this._acquireSkypeTokenDesktop:this.isCDLWorker?this._acquireSkypeTokenWorker:this._acquireSkypeTokenWeb,i=this.getDiscoveryResponse(n,t,0,e);return this.setDiscoveryResponse(i)}return this._discoveryResponse}getDiscoveryResponse(e,t,n=0,a=!1){var r,s;return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const n=yield e(a);return t.stop(),this.onDiscoverSuccess&&this.onDiscoverSuccess(),this.setTelemetry(n),n}catch(i){let a=i;(null===(r=a.serverResponse)||void 0===r?void 0:r.body)&&(null===(s=a.serverResponse)||void 0===s?void 0:s.body.json)&&(a.serverResponse.body=yield a.serverResponse.body.json().catch((e=>{i.message+=`::${e.message}`})));const{disableResponseParsing:l}=this.coreSettings.get(o.J.Auth);if(a=(0,b.r2)(i,this.isOnline(),!!l),this.canRetry(n,a))return null==t||t.mark("retry_skype_token_step",{message:a.message,reason:(0,h.u4)(a)}),this.getDiscoveryResponse(e,t,++n);throw this.onDiscoverFail&&this.onDiscoverFail(this._canGetSkypeTokenFromHost()),this.resetDiscoveryResponse(),(0,b.db)(t,a,!!l)}}))}resetDiscoveryResponse(){this._discoveryResponse=void 0,this.clearFromLocalStorage()}canRetry(e,t){return e<1&&t.code!==I.jK.NetworkOffline&&t.code!==I.jK.Forbidden}setDiscoveryResponse(e){return e=e.then((e=>(this._skypeToken.next(e.skypeToken),e))),this._discoveryResponse=e}getResponseFromLocalStorage(e,t){let n=this.getFromLocalStorage(e,t,"auth.gtm.table");const i=this.getFromLocalStorage(e,t,"auth.skype.token");return n&&i?(H(this.globalScope)&&this.shouldNotDecodeTokenForIE||(n=C(a.UH,n)),Object.assign(Object.assign({},i.userDetails),{skypeToken:i.skypeToken,expires:new Date(i.expiration),regionGtms:n})):null}getFromLocalStorage(e,t,n){var i;if(!(null===(i=this.globalScope)||void 0===i?void 0:i.localStorage))return;let a=`ts.${t}-${e}.${n}`,o=this.globalScope.localStorage.getItem(a);if(o||(a=`ts.${e}.${n}`,o=this.globalScope.localStorage.getItem(a)),o){this._localStorageKeys.push(a);try{return JSON.parse(o)}catch(e){this.logger.error(e)}}}clearFromLocalStorage(){var e;(null===(e=this.globalScope)||void 0===e?void 0:e.localStorage)&&(this._localStorageKeys.forEach((e=>{this.globalScope.localStorage.removeItem(e)})),this._localStorageKeys=[])}setTelemetry(e){const{environment:t}=this.coreSettings.get(o.J.Metadata);let n,i,a;this.telemetryProvider&&e?(e.region&&(n=e.region),e.licenseDetails&&(i=e.licenseDetails.isFreemium),t===u.s.life?(a=r.OV.Life,i&&this.logger.warn("The Environment indicates TFL, but Freemium is true - defaulting telemetry to TFL Tenant.Model")):a=this.licenseTypeToTenantType(i)):this.logger.log("Failed to obtain telemetry details from discovery."),this.telemetryProvider.setContext("UserInfo.Region",n),this.telemetryProvider.setContext("Tenant.Model",a)}}},813489:(e,t,n)=>{"use strict";n.d(t,{a:()=>d});var i=n(231191),a=n(377692),o=n(356452),r=n(243741);var s=n(412050),l=n(524130),c=n(682796);class d{constructor(e,t,n,i){this.aad=e,this.discover=t,this.coreSettings=n,this.loggerFactory=i,this.cmdMTAuthResource=e=>this._cmdMtAuthorize(e),this.mtAuthResource=e=>{const{requireSkypetokenForMT:t}=this.coreSettings.get(c.J.Auth);return this._mtAuthorize(e,t||!1)},this.skypeAuthResource=e=>this.skype.authorizeRequest(e),this.skypeAuthorizeAuthResource=e=>this.skype.authorizeRequest(e,"Authorization"),this.skypeXTokenAuthResource=e=>this.skype.authorizeRequest(e,"x-skypetoken"),this.mtAuthWithSkypeXTokenResource=e=>this._mtAuthorize(e,!0),this._cmdMtAuthorize=e=>this.aad.getUser().then((()=>{const{cmdMeetingArtifactsServiceResource:t}=this.coreSettings.get(c.J.CMDMeetingArtifactsService);return(e=>this.aad.authorizeRequest(e,null!=t?t:""))(e)})),this._mtAuthorize=(e,t)=>this.aad.getUser().then((()=>{const n=(0,l.JY)(this.coreSettings),i=e=>this.aad.authorizeRequest(e,n);return(t?this.composeAuthResources(i,this.skypeXTokenAuthResource):i)(e)})),this.skype=new a.q(this.discover)}bind(e,t){switch(t){case"chatService":return this.chatServiceBind(e);case"cmdArtifactsService":return this.cmdArtifactsServiceBind(e);case"middleTier":case"userProfileService":case"userEntitlementService":return n=>(0,i.__awaiter)(this,void 0,void 0,(function*(){return(0,r.G)(yield(0,l.UE)(e,this.aad,this.skype,this.coreSettings),yield this.discover.regionGtm(t))(n)}));case"unifiedPresence":return this.unifiedPresence||(this.unifiedPresence=this.unifiedPresenceBind(t)),this.unifiedPresence(e);case"urlp":case"urlpV2":case"ams":case"amsV2":return n=>(0,i.__awaiter)(this,void 0,void 0,(function*(){return(0,r.G)(this.skype.authorize(e,"Authorization"),yield this.discover.regionGtm(t))(n)}));case"mtImageService":return n=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const{mtImageServiceOverrideUrl:i}=this.coreSettings.get(c.J.Test),a=i||(yield this.discover.regionGtm(t));return(0,r.G)(e,a)(n)}));default:return this.defaultBind(e,t)}}defaultBind(e,t){return n=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.discover.regionGtm(t);return(0,r.G)(this.aad.authorize(e,i),i)(n)}))}unifiedPresenceBind(e){const{requireConsumerTypeHeader:t,requireSkypetoken:n}=this.coreSettings.get(c.J.Presence);return function(e,t){let n;return a=>s=>(0,i.__awaiter)(this,void 0,void 0,(function*(){for(let i=0;;++i){n||(n=yield t());const l=yield(0,r.G)(e(a,n),n)(Object.assign(Object.assign({},s),{headers:Object.assign(Object.assign({},s.headers),{BehaviorOverride:"redirectAs404"})})),{status:c,headers:{location:d}}=l;if(c!==o.qb.NOT_FOUND||!d||i>2)return l;n=new URL("/",d).href}}))}(((e,a)=>{const o=n?this.skype.authorize(e,"x-skypetoken"):this.aad.authorize(e,a);return t?e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){return e=Object.assign(Object.assign({},e),{headers:Object.assign(Object.assign({},e.headers),{"x-ms-client-consumer-type":"teams4life"})}),o(e)})):o}),(()=>this.discover.regionGtm(e)))}chatServiceBind(e){return this.chatService||(this.chatService=(0,s.Db)((e=>this.skype.authorize(e)),(e=>this.discover.regionGtm(e)),this.coreSettings,this.loggerFactory)),this.chatService(e)}cmdArtifactsServiceBind(e){const{cmdMeetingArtifactsServiceEndpoint:t}=this.coreSettings.get(c.J.CMDMeetingArtifactsService);return n=>(0,i.__awaiter)(this,void 0,void 0,(function*(){return(0,r.G)(yield(0,l.l2)(e,this.aad,this.coreSettings),null!=t?t:"")(n)}))}composeAuthResources(e,t){return n=>(0,i.__awaiter)(this,void 0,void 0,(function*(){return e(n).then((e=>t(e.request).then((t=>({request:t.request,resolver:(n,i)=>t.resolver(n,i).then((t=>t||e.resolver(n,i)))})))))}))}}},489321:(e,t,n)=>{"use strict";n.d(t,{Mf:()=>a,f$:()=>o,U3:()=>r});var i=n(439146);function a(e,t){return{entity:{type:i.p.chats,action:i.u.create,id:o(e)},command:t}}function o(e){return JSON.stringify(e&&e.length>0?e.sort():[])}function r(e,t,n,i){let a={};if(e.type===t&&e.action===n){const t=e.options;if(t&&"string"==typeof t)try{a=JSON.parse(t)}catch(e){i.warn(`Entity options are in unexpected format. Expected a valid stringified JSON object but instead received: ${t}.`)}}else i.warn(`Entity options are (incorrectly) being asked for type and action that do not pertain to the entity. ${e.type} != ${t} or ${e.action} != ${n}`);return a}},42723:(e,t,n)=>{"use strict";n.d(t,{E:()=>s,z:()=>l});var i=n(231191),a=n(775214),o=n(352367);let r;const s=e=>t=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(!r)return e(t);return e(t).then((e=>(null==r||r.processResponse(e),e))).catch((e=>{throw null==r||r.processError(e),e}))}));function l(e,t){if(r){throw(0,a.Tr)(o.w5.Tasks,o.jK.AlreadyInitialized,"subscribeToSendNetworkTracking",void 0,"subscription exists")}r={processResponse:e,processError:t};return()=>{r=void 0}}},227216:(e,t,n)=>{"use strict";n.d(t,{MJ:()=>u,XP:()=>m,Or:()=>g,Ds:()=>h,Df:()=>y,mR:()=>S});var i=n(231191),a=n(581870),o=n(972124),r=n(892891);const s=new Map,l=/^\/|\/$/g;function c(e,t){const n=t?":":"",i=e.id?`/${n}${e.id}`:"",a=e.action?`/${e.action}`:"";return`${e.resource}${i}${a}`}function d(e){const{descriptor:t,asPath:n,stem:a=""}=e,o=(0,i.__rest)(e,["descriptor","asPath","stem"]);let r=a;const s=t?t.resources:void 0;if(s&&s.length>0)for(const e of s)r=`${r}/${c(e,n)}`;return Object.assign(Object.assign({},o),{descriptor:t,asPath:n,stem:r})}function u(...e){return e.reduce(((e,t)=>(e.resources=e.resources.concat(t.resources),e.search=Object.assign(Object.assign({},e.search),t.search),e)),{resources:[],search:{}})}function m(e){return(0,r.flow)([d,v,f])(e).stem}function p(e){if(!e||0===e.length)return[];const t=s.get(e);if(t)return t;let n=[];const i=e.replace(l,"");if(0===i.length)return n;const o=i.split("/");try{const t=function(e){const t=[];let n=-1;for(const i of e){const e=i;a._[e]&&(n++,t[n]=[]),n>=0&&t[n].push(e)}return t}(o);return t&&(n=t.map((e=>{let t;const n=2,i=3;switch(e.length){case i:t={resource:e[0],id:e[1],action:e[n]};break;case n:{const n=e[1];t=a.a[n]?{resource:e[0],action:e[1]}:{resource:e[0],id:e[1]};break}default:throw new Error("Invalid resource fragment format found, id or action is required.")}return t}))),s.size<1e3&&s.set(e,n),n}catch(e){throw new Error(`Unable to parse path into proper resources. ${e.message}`)}}function g(e){return(0,o.Qc)(e||"")}function h(e){return(0,o.Pz)(e||{})}function v(e){const{context:t,asPath:n,stem:i=""}=e;let a=i;if(t){const e=t.router;if(!e)throw new Error("Cannot generate a relative path without a context. Verify a context was added provided");{const t=n?e.route.match.path:e.route.match.url;a="/"!==t?`${t}${a}`:a}}return Object.assign(Object.assign({},e),{stem:a})}function f(e){const{descriptor:t,asPath:n,stem:i=""}=e;let a=i;if(t){const e=h(t.search);e&&(a=`${a}${n?`/:${e}`:`?${e}`}`)}return Object.assign(Object.assign({},e),{stem:a})}function y(e){const{search:t}=e,n=(0,i.__rest)(e,["search"]),a=h(t);return{pathname:m({descriptor:n}),search:a}}function S(e){const{pathname:t,search:n}=e;return{resources:p(t),search:g(n)}}},432490:(e,t,n)=>{"use strict";n.d(t,{I:()=>k,s:()=>b});var i=n(227216);class a{constructor(e,t){this.history=t,this._logger=e.newLogger("Routing Service")}navigate(e){const t=(0,i.Df)(e);this.execute(t)}execute(e){this.history?this.history.push(e):this._logger.error("Unable to route using history. History initialized with undefined")}}class o{constructor(e,t,n){this._location=t,this._history=n,this._logger=e.newLogger("State Routing Service")}getSearchState(){const e=this.getLocation();if(!e)return{};const t=e.search;return t!==this._previousSearch&&(this._previousSearch=t,this._currentState=(0,i.Or)(t)),this._currentState||{}}getOrigin(){const e=this.getLocation();return e&&e.origin}getHost(){const e=this.getLocation();return e&&e.host}getPathname(){const e=this.getLocation();return e&&e.pathname}getLocation(){if(this._location||this._logger.error("Unable to execute on location. Location initialized with undefined"),this._location&&this._history&&this._history.location){const{search:e,pathname:t}=this._history.location;return Object.assign(Object.assign({},this._location),{search:e,pathname:t})}return this._location}}var r,s=n(581870);!function(e){e.OrgChart="organization"}(r||(r={}));class l{constructor(e,t){this.routingService=e,this.rootRoutingService=t}toCreateChatWithUsers(e){this.routingService.navigate(this.createChatWithUsersDescriptor(e))}toChatById(e){this.routingService.navigate(this.chatByIdDescriptor(e))}toOrgChart(e){this.routingService.navigate(this.orgChartDescriptor(e))}toChatList(){this.routingService.navigate(this.chatListDescriptor())}chatByIdDescriptor(e){return this.concatToAppDescriptor({resources:[{resource:s._.chats,id:e}]})}createChatWithUsersDescriptor(e){const t=JSON.stringify(e&&e.length>0?e.sort():[]);return this.concatToAppDescriptor({resources:[{resource:s._.chats,action:s.a.create,id:t}]})}chatListDescriptor(){return this.concatToAppDescriptor({resources:[{resource:s._.chats,action:s.a.list}]})}orgChartDescriptor(e){const t=this.createChatWithUsersDescriptor([e]);return(0,i.MJ)(t,{resources:[{resource:s._.extensions,id:r.OrgChart}]})}concatToAppDescriptor(e){const t=this.rootRoutingService.chatAppDescriptor();return(0,i.MJ)(t,e)}}class c{constructor(e,t){this.routingService=e,this.rootRoutingService=t}toCallById(e){this.routingService.navigate(this.callByIdDescriptor(e))}toCallList(){this.routingService.navigate(this.callsListDescriptor())}callByIdDescriptor(e){return this.concatToAppDescriptor({resources:[{resource:s._.calls,id:e}]})}callsListDescriptor(){return this.concatToAppDescriptor({resources:[{resource:s._.calls,action:s.a.list}]})}concatToAppDescriptor(e){const t=this.rootRoutingService.callingAppDescriptor();return(0,i.MJ)(t,e)}}var d,u=n(423238);class m{constructor(e){this._routingService=e}toAppById(e){this._routingService.navigate(this.appDescriptor(e))}chatAppDescriptor(){return this.appDescriptor(u.dS)}callingAppDescriptor(){return this.appDescriptor(u.Pz)}meetingOptionsAppDescriptor(){return this.appDescriptor(u.s_)}fileAppDescriptor(){return this.appDescriptor(u.Tu)}appDescriptor(e,t){return{resources:[{resource:s._.apps,id:e,action:t}]}}}!function(e){e[e.Allow=0]="Allow",e[e.Block=1]="Block"}(d||(d={}));class p{constructor(){this._taps=[]}tap(e){return this._taps.push(e),()=>{this._taps=this._taps.filter((t=>t!==e))}}call(e){let t;for(const n of this._taps){const i=n({data:e,previousResult:t});void 0!==i&&(t=i)}return t}}class g{constructor(e){this._history=e,this.onNavigationBlocked=new p,this.onNavigationStart=new p,this.onNavigationSucceeded=new p,this._handleNavigationStart=e=>{if(!this._history||!this._history.location)return;const t=this._history.location,n=(0,i.mR)(t),a=(0,i.mR)(e);return this.onNavigationStart.call({from:n,to:a})===d.Block?(this.onNavigationBlocked.call({to:a}),!1):void 0},this._handleNavigationSuccess=e=>{const t=(0,i.mR)(e);this.onNavigationSucceeded.call({to:t})},this._history&&this._history.block&&this._history.block(this._handleNavigationStart),this._history&&this._history.listen&&this._history.listen(this._handleNavigationSuccess)}}var h=n(775214),v=n(352367);class f{meetingOptionsPageDescriptor(e){const{tenantId:t,organizerId:n,threadId:i,messageId:a,additionalMessageId:o,search:r}=e;return{resources:[{resource:s._.meetings,id:JSON.stringify({tenantId:t,organizerId:n,threadId:i,messageId:a,additionalMessageId:o})}],search:r}}meetingOptionsLicenseDescriptor(e){return{resources:[{resource:s._.licenses,action:s.a.list}],search:e?e.search:void 0}}}class y{constructor(e,t){this._history=t,this._logger=e.newLogger("External Routing Service")}serializeToPath(e){const{descriptor:t,exact:n}=e;let a="";return t&&(a=(0,i.XP)({descriptor:t})),this._history?n||(a=this._history.createHref({pathname:a}).toString()):n&&this._logger.error("Unable to execute on history to generate absolute path. History initialized with undefined"),a}}let S;const k=(e,t,n)=>{const i=new a(e,t),r=new m(i),s={state:new o(e,n,t),root:r,call:new c(i,r),chat:new l(i,r),meeting:new f,external:new y(e,t),hooks:new g(t)};return S=s,S},b=()=>{if(!S)throw(0,h.Tr)("RoutingServices",v.jK.NotInitialized,"getInstance");return S}},604174:(e,t,n)=>{"use strict";n.d(t,{YK:()=>y,Lk:()=>S});var i,a=n(971113),o=n(356452),r=n(723128);!function(e){e.HEALTHY="healthy",e.UNHEALTHY="unhealthy",e.UNKNOWN="unknown"}(i||(i={}));var s=n(700608),l=n(498765),c=n(906693),d=n(324819);const u={headers:{sharePoint:{SPRequestGuid:"SPRequestGuid",SPClientServiceRequestDuration:"SPClientServiceRequestDuration",SPRequestDuration:"SPRequestDuration"}}},m="cache",p="cache-control",g="x-cache",h="electron";var v;function f(e){return e.map((e=>{if(e.request){const{status:t,responseHeaders:n,requestHeaders:i}=e.request;e.request.responseHeaders=function(e,t){if(!t)return{};return{contentLength:t["content-length"]||"-1",serverRequestId:t.contextid||t["x-serverrequestid"]||t["request-id"]||b(t),[m]:_(e,t),requestId:t["x-ms-request-id"],invalidToken:t["x-invalid-token"],afdCorrelationId:t["x-msedge-ref"]}}(t,n),e.request.requestHeaders=function(e,t){const n={};return t&&e.forEach((e=>{t[e]&&(n[e]=t[e])})),n}(["clientRequestId"],i)}return e}))}!function(e){e.CDN="CDN",e.Shared="Shared",e.Browser="Browser",e.None="None"}(v||(v={}));const y=e=>t=>{var n,o;const{serviceName:r,apiName:u,apiNameDecoration:m,createdTime:p,duration:g,parameters:h,result:v}=t;t.operationLogs=f(t.operationLogs);const y=t.correlationId||(0,d.v4)();t.operationLogs.forEach((t=>{if(t.request){const{method:n}=t.request;k(e,C(r,u,n,m),t,y)}}));const S={userAgent:e.navigator.userAgent,createdTime:p,errorReason:v,correlationId:y,totalDuration:g,ECT:null===(o=null===(n=e.navigator)||void 0===n?void 0:n.connection)||void 0===o?void 0:o.effectiveType,parameters:h,operationLogs:(0,l.u4)(t.operationLogs)},b=w(r,u,m);(0,s.P3)(a.x.Http,b,S),function(e,t,n){var o,r;const{serviceName:d,apiName:u,apiNameDecoration:m,createdTime:p,duration:g,parameters:h,result:v,operationLogs:f}=e,y=function(e,t){const n=(0,c.Yf)().getEndpointHealth(e,t);return void 0===n?i.UNKNOWN:n?i.HEALTHY:i.UNHEALTHY}(d,u);null==f||f.forEach((e=>{if(e.request){const{method:t}=e.request;!function(e,t,n,i,o,r){if(t.request){const{duration:c,result:d}=t,{method:u,hostname:m,performance:p,responseHeaders:g,requestHeaders:h,dateTime:v,authPerformanceLogs:f}=t.request,y={apiName:i,serviceName:o,duration:c,result:d,correlationId:n,method:u,hostname:m,responseHeaders:(0,l.u4)(g),requestHeaders:(0,l.u4)(h),healthState:r,timestamp:v.toISOString()};p&&(p.duration&&(y.perf_duration=p.duration.toString()),y.perf_details=(0,l.u4)(Object.assign(Object.assign(Object.assign({},p),f),{name:void 0}))),(0,s.P3)(a.x.Endpoint,e,y)}}(C(d,u,t,m),e,n,u,d,y)}}));const S={apiName:u,serviceName:d,duration:g,result:v,correlationId:n,userAgent:t.navigator.userAgent,timestamp:p,operationLogs:(0,l.u4)(f),parameters:(0,l.u4)(h),ECT:null===(r=null===(o=t.navigator)||void 0===o?void 0:o.connection)||void 0===r?void 0:r.effectiveType,healthState:y},k=w(d,u,m);(0,s.P3)(a.x.Endpoint,k,S)}(t,e,y)};const S=(e,t,n,i,a,r,s)=>{const l=s||o.qb[null==i?void 0:i.status]||"",c=function(e){const t={};if(e)for(const n of Object.keys(e.headers)){t[n.toLowerCase()]=e.headers[n]}return t}(i),{serviceName:d,apiNameDecoration:u,apiName:m,method:p,authPerformanceLogs:g}=n;k(r,C(d,m,p,u),{type:o.nz.Initial,duration:e,result:l,request:{dateTime:t,method:n.method,hostname:i&&new URL(i.url).hostname,status:null==i?void 0:i.status,requestHeaders:n.headers||{},responseHeaders:c,performance:a,authPerformanceLogs:g}},n.correlationId)};const k=({navigator:e},t,n,i)=>{var c;if(n.request){const{dateTime:d,method:u,hostname:m,status:p,requestHeaders:g,responseHeaders:v,performance:f,authPerformanceLogs:y}=n.request,S={ECT:null===(c=null==e?void 0:e.connection)||void 0===c?void 0:c.effectiveType,hostname:m,requestCreatedTime:d.toISOString(),networkState:e.onLine?r.XR.ONLINE:r.XR.OFFLINE,method:u,resultCode:p,requestResult:n.result,contentLength:v["content-length"]||-1,serverRequestId:v.contextid||v["x-serverrequestid"]||v["request-id"]||b(v),correlationId:i,duration:n.duration,authPerformanceLogs:(0,l.u4)(y)};!function(e,t,n,i){i["x-ms-request-id"]&&(e.requestId=i["x-ms-request-id"]);n&&(e.clientRequestId=n);i["x-invalid-token"]&&(e.invalidToken=i["x-invalid-token"]);t!==o.qb.OK&&(e.afdCorrelationId=i["x-msedge-ref"])}(S,p,g&&g.clientRequestId,v),S.cache=_(p,v),function(e,t,n){if(n){const i=n.domainLookupEnd-n.domainLookupStart,a=n.connectEnd-n.connectStart,o=n.redirectEnd-n.redirectStart;if(i>0&&(e.dns=i),a>0&&(e.tcp=a),o>0&&(e.redirect=o),e.size=n.transferSize,e.payload=n.encodedBodySize,e.start=n.startTime,e.reqStart=n.requestStart,e.respStart=n.responseStart,n.duration){const i=n.duration;(-1===t.userAgent.toLowerCase().indexOf(h)||e.duration&&i>e.duration)&&(e.duration=i)}}}(S,e,f),(0,s.P3)(a.x.Http,t,S)}};function b(e){let t=e[u.headers.sharePoint.SPRequestGuid.toLowerCase()]||"";return"[object String]"===Object.prototype.toString.call(t)&&t.length>0&&(t=[`${u.headers.sharePoint.SPRequestGuid}=${t}`,`${u.headers.sharePoint.SPClientServiceRequestDuration}=${e[u.headers.sharePoint.SPClientServiceRequestDuration.toLowerCase()]||""}`,`${u.headers.sharePoint.SPRequestDuration}=${e[u.headers.sharePoint.SPRequestDuration.toLowerCase()]||""}`].join(";")),t}function _(e,t){let n=v.None;if(t.hasOwnProperty(p)){const i=t[p];e===o.qb.NOT_MODIFIED?n=v.Browser:i.includes("no-store")||i.includes("no-cache")||(n=v.Browser,i.includes("public")&&(n+=", ".concat(v.Shared)))}else t.hasOwnProperty("expires")&&(n=v.Browser);if(t.hasOwnProperty(g)){t[g].toLowerCase().includes("hit")&&(n===v.None?n=v.CDN:n+=", ".concat(v.CDN))}return n}function C(e,t,n,i){return i?`${e}_${t}_${i}_${n}`:`${e}_${t}_${n}`}function w(e,t,n){return n?`${t}_${n}_${e}`:`${t}_${e}`}},597134:(e,t,n)=>{"use strict";n.d(t,{k:()=>o,H:()=>r});var i=n(682796),a=n(404657);const o=-1;class r{constructor(){this.FractionalBuckets=1e3,this.ConvertToWholeDeviser=10,this.WholeNumberBuckets=100,this.DefaultCohort=0,this.DefaultSampleRate=100,this.rulesLookup={},this.cohortBoundary=this.DefaultCohort,this.telemetrySettings={},this.deviceId=null,this.userId=null,this.updateSamplingSettings=e=>{if(e){this.telemetrySettings=e;let t={};e.samplingRules&&(t=e.samplingRules,this.rulesLookup=t),this.setCohortBoundry()}}}initialize(e){e.getObservable(i.J.Telemetry).subscribe(this.updateSamplingSettings),this.telemetrySettings=e.get(i.J.Telemetry),this.updateSamplingSettings(this.telemetrySettings)}static getInstance(){return this.eventSuppressionService||(this.eventSuppressionService=new r),this.eventSuppressionService}setSamplingByUser(e){this.userId=e,this.setCohortBoundry()}setSamplingByDevice(e){this.deviceId=e,this.setCohortBoundry()}getCurrentCohort(){return this.cohortBoundary}shouldSuppressEvent(e,t="*"){return this.getSampleRate(e,t,"*")===o}getSampleRate(e,t="*",n="*"){if(this.cohortBoundary!==this.DefaultCohort){const i=this.rulesLookup[e];if(void 0!==i){const e=void 0!==i[`${t}|${n}`]?i[`${t}|${n}`]:void 0!==i[t]?i[t]:void 0!==i[`*|${n}`]?i[`*|${n}`]:void 0!==i["*"]?i["*"]:this.DefaultSampleRate;return this.cohortBoundary>e?o:e}}return this.DefaultSampleRate}setCohortBoundry(){let e=null;const t=this.telemetrySettings.enableDeviceIdSampling,n=this.telemetrySettings.enableUserIdSamplingV2;if(!0===t){const t=this.telemetrySettings.deviceIdSampleCohort;if(t&&t>o&&t<=this.DefaultSampleRate)return void(this.cohortBoundary=t);e=this.deviceId}else if(!0===n){const t=this.telemetrySettings.userIdSampleCohort;if(t&&t>o&&t<=this.DefaultSampleRate)return void(this.cohortBoundary=t);e=this.userId}n||t?e&&(this.cohortBoundary=((0,a.E)(e)%this.FractionalBuckets+1)/this.ConvertToWholeDeviser):this.userId&&(this.cohortBoundary=(0,a.E)(this.userId)%this.WholeNumberBuckets+1)}}},906693:(e,t,n)=>{"use strict";n.d(t,{hy:()=>x,Yf:()=>H});var i,a,o=n(231191),r=n(565810),s=n(313176),l=n(556085),c=n(727455),d=null;class u{constructor(){this.key=null,this.value=null,this.pii=null}static _isPii(e){if(e==s.A4.NotSet)return!1;var t=!1;for(var n in s.A4)isNaN(n)||n==e&&(t=!0);return t}}class m{constructor(){this.name=null,this.timestamp=null,this.properties=[],this.eventType=null}setProperty(e,t,n){if(!e||!this.properties[e]&&!m._propertyNameRegex.test(e))throw new p(i.INVALID_PROPERTY_NAME);this.properties[e]={key:e,value:t,pii:n!=s.A4.NotSet?n:null}}unsetProperty(e){if(!e)throw new p(i.INVALID_PROPERTY_NAME);void 0!==this.properties[e]&&(this.properties[e]=void 0,delete this.properties[e])}}m._propertyNameRegex=/^[a-zA-Z0-9](([a-zA-Z0-9|_|.]){0,98}[a-zA-Z0-9])?$/,function(e){e[e.INVALID_TENANT_TOKEN=1]="INVALID_TENANT_TOKEN",e[e.MISSING_EVENT_PROPERTIES_NAME=2]="MISSING_EVENT_PROPERTIES_NAME",e[e.INVALID_PROPERTY_NAME=3]="INVALID_PROPERTY_NAME",e[e.INVALID_COLLECTOR_URL=4]="INVALID_COLLECTOR_URL",e[e.MISSING_FAILURE_SIGNATURE=5]="MISSING_FAILURE_SIGNATURE",e[e.MISSING_FAILURE_DETAIL=6]="MISSING_FAILURE_DETAIL",e[e.MISSING_PAGEVIEW_ID=7]="MISSING_PAGEVIEW_ID",e[e.MISSING_PAGEVIEW_NAME=8]="MISSING_PAGEVIEW_NAME",e[e.INVALID_SESSION_STATE=9]="INVALID_SESSION_STATE"}(i||(i={}));class p{constructor(e){this.errorCode=null,this.errorCode=e}ErrorCode(){return this.errorCode}toString(){switch(this.errorCode){case i.INVALID_TENANT_TOKEN:return"Invalid tenant token";case i.MISSING_EVENT_PROPERTIES_NAME:return"Eventproperties.name can not be null or empty";case i.INVALID_PROPERTY_NAME:return"Invalid Key. Key does not conform to regular expression ^[a-zA-Z0-9](([a-zA-Z0-9|_]){0,98}[a-zA-Z0-9])?$";case i.INVALID_COLLECTOR_URL:return"Collector url can't be null or empty.";case i.MISSING_FAILURE_SIGNATURE:return"Failure signature can't be null or empty.";case i.MISSING_FAILURE_DETAIL:return"Failure detail can't be null or empty.";case i.MISSING_PAGEVIEW_ID:return"Pageview id can't be null or empty.";case i.MISSING_PAGEVIEW_NAME:return"Pageview name can't be null or empty.";case i.INVALID_SESSION_STATE:return"Session state has to be a value from the SessionState enum.";default:return"Unknown error"}}}class g{constructor(e){this.contextMap=new l.D,this.piiKind=s.A4.NotSet,this._allowDeviceInfoFields=!1,this._allowDeviceInfoFields=e}setAppId(e){e&&this.contextMap.Add("AppInfo.Id",e)}setAppVersion(e){e&&this.contextMap.Add("AppInfo.Version",e)}setAppClientType(e){e&&this.contextMap.Add("AppInfo.ClientType",e)}setAppLanguage(e){e&&this.contextMap.Add("AppInfo.Language",e)}setDeviceId(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.Id",e)}setDeviceOsName(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.OsName",e)}setDeviceOsVersion(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.OsVersion",e)}setDeviceBrowserName(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.BrowserName",e)}setDeviceBrowserVersion(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.BrowserVersion",e)}setUserId(e,t){e&&this.contextMap.Add("UserInfo.Id",e),u._isPii(t)&&(this.piiKind=t)}setUserMsaId(e){e&&this.contextMap.Add("UserInfo.MsaId",e)}setUserANID(e){e&&this.contextMap.Add("UserInfo.ANID",e)}setUserAdvertisingId(e){e&&this.contextMap.Add("UserInfo.AdvertisingId",e)}setUserTimeZone(e){e&&this.contextMap.Add("UserInfo.TimeZone",e)}setUserLanguage(e){e&&this.contextMap.Add("UserInfo.Language",e)}setUserRing(e){e&&this.contextMap.Add("UserInfo.Ring",e)}setUserTenantId(e){e&&this.contextMap.Add("UserInfo.TenantId",e)}}class h{static initialize(e){h.documentInfo=e;var t=e.appLanguage;t&&h.semanticContext.setAppLanguage(t);var n=e.userLanguage;n&&h.semanticContext.setUserLanguage(n);var i=(new Date).getTimezoneOffset(),a=i%60,o=(i-a)/60,r="+";o>0&&(r="-"),a=Math.abs(a);var s=r+((o=Math.abs(o))<10?"0"+o:o.toString())+":"+(a<10?"0"+a:a.toString());h.semanticContext.setUserTimeZone(s),h.semanticContext.setDeviceBrowserName(h._getBrowserName()),h.semanticContext.setDeviceBrowserVersion(h._getBrowserVersion()),h.semanticContext.setDeviceOsName(h._getOsName()),h.semanticContext.setDeviceOsVersion(h._getOsVersion()),h.semanticContext.setDeviceId(e.deviceId),h.firstLaunchTime=e.firstLaunchTime,h.semanticContext.setAppVersion(e.appVersion)}static _getUserAgent(){return h.documentInfo.userAgent}static _userAgentContainsString(e){return h._getUserAgent().indexOf(e)>-1}static _isIe(){return h._userAgentContainsString("Trident")}static _isEdge(){return h._userAgentContainsString(h.BROWSERS.EDGE)}static _isEdgeAnaheim(){return h._userAgentContainsString("Edg/")}static _isOpera(){return h._userAgentContainsString("OPR/")}static _getBrowserName(){return h._isOpera()?h.BROWSERS.UNKNOWN:h._userAgentContainsString(h.BROWSERS.PHANTOMJS)?h.BROWSERS.PHANTOMJS:h._isEdge()?h.BROWSERS.EDGE:h._isEdgeAnaheim()?h.BROWSERS.EDGEANAHEIM:h._userAgentContainsString(h.BROWSERS.ELECTRON)?h.BROWSERS.ELECTRON:h._userAgentContainsString(h.BROWSERS.CHROME)?h.BROWSERS.CHROME:h._userAgentContainsString(h.BROWSERS.FIREFOX)?h.BROWSERS.FIREFOX:h._userAgentContainsString(h.BROWSERS.SAFARI)?h.BROWSERS.SAFARI:h._userAgentContainsString(h.BROWSERS.SKYPE_SHELL)?h.BROWSERS.SKYPE_SHELL:h._isIe()?h.BROWSERS.MSIE:h.BROWSERS.UNKNOWN}static _getBrowserVersion(){return h._isIe()?function(){var e,t=h._getUserAgent(),n=t.match(new RegExp(h.BROWSERS.MSIE+" "+h.REGEX_VERSION));if(n)return n[1];if(e=t.match(new RegExp("rv:"+h.REGEX_VERSION)))return e[1]}():function(e){var t;e===h.BROWSERS.SAFARI?e="Version":e===h.BROWSERS.EDGEANAHEIM&&(e="Edg");if(t=h._getUserAgent().match(new RegExp(e+"/"+h.REGEX_VERSION)))return t[1];return h.UNKNOWN_VERSION}(h._getBrowserName())}static _getOsName(){return h._getUserAgent().match(/windows\sphone\s\d+\.\d+/i)?h.OPERATING_SYSTEMS.WINDOWS_PHONE:h._getUserAgent().match(/ arm;/i)?h.OPERATING_SYSTEMS.WINDOWS_RT:h._getUserAgent().match(/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i)?h.OPERATING_SYSTEMS.IOS:h._getUserAgent().match(/android/i)?h.OPERATING_SYSTEMS.ANDROID:h._getUserAgent().match(/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i)?h.OPERATING_SYSTEMS.LINUX:h._getUserAgent().match(/(macintosh|mac os x)/i)?h.OPERATING_SYSTEMS.MACOSX:h._getUserAgent().match(/(windows|win32)/i)?h.OPERATING_SYSTEMS.WINDOWS:h.OPERATING_SYSTEMS.UNKNOWN}static _getOsVersion(){return h._getOsName()===h.OPERATING_SYSTEMS.WINDOWS?function(){var e=h._getUserAgent().match(new RegExp("Windows NT "+h.REGEX_VERSION));if(e&&h.VERSION_MAPPINGS[e[1]])return h.VERSION_MAPPINGS[e[1]];return h.UNKNOWN_VERSION}():h._getOsName()===h.OPERATING_SYSTEMS.MACOSX?function(){var e=h._getUserAgent().match(new RegExp(h.OPERATING_SYSTEMS.MACOSX+" "+h.REGEX_VERSION_MAC));if(e){var t=e[1].replace(/_/g,".");if(t){var n=function(e){if(e.indexOf(".")>-1)return".";if(e.indexOf("_")>-1)return"_";return null}(t);return n?t.split(n)[0]:t}}return h.UNKNOWN_VERSION}():h.UNKNOWN_VERSION}}h.semanticContext=new g(!0),h.firstLaunchTime=-1,h.BROWSERS={MSIE:"MSIE",CHROME:"Chrome",FIREFOX:"Firefox",SAFARI:"Safari",EDGE:"Edge",EDGEANAHEIM:"EdgeAnaheim",ELECTRON:"Electron",SKYPE_SHELL:"SkypeShell",PHANTOMJS:"PhantomJS",UNKNOWN:"Unknown"},h.OPERATING_SYSTEMS={WINDOWS:"Windows",MACOSX:"Mac OS X",WINDOWS_PHONE:"Windows Phone",WINDOWS_RT:"Windows RT",IOS:"iOS",ANDROID:"Android",LINUX:"Linux",UNKNOWN:"Unknown"},h.VERSION_MAPPINGS={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},h.REGEX_VERSION="([\\d,.]+)",h.REGEX_VERSION_MAC="([\\d,_,.]+)",h.UNKNOWN_VERSION="Unknown",h.DEVICE_ID_COOKIE="MicrosoftApplicationsTelemetryDeviceId",h.FIRST_LAUNCH_TIME_COOKIE="MicrosoftApplicationsTelemetryFirstLaunchTime",function(e){e[e.STARTED=0]="STARTED",e[e.ENDED=1]="ENDED"}(a||(a={}));class v{static initialize(e,t){if(!v._initialized){if(!t)throw new p(i.INVALID_TENANT_TOKEN);v._defaultToken=t,v._config.collectorUrl||(v._config.collectorUrl="https://browser.pipe.aria.microsoft.com/Collector/3.0/"),d||(d=r.sE.CreateTelemetryManager()).Initialize(v._config),d.Start(),h.initialize(e),v._initialized=!0}}static initializeWithConfiguration(e,t,n){if(!n.collectorUrl)throw new p(i.INVALID_COLLECTOR_URL);v._config.collectorUrl=n.collectorUrl,v.initialize(e,t)}static flush(e){d.Flush(e)}static addCallbackListener(e){v._initialized&&d.AddListener(e)}static setContext(e,t,n){""!==t&&"null"!==t&&"undefined"!==t?v._contextProperties.setProperty(e,t,n):v._contextProperties.unsetProperty(e)}static isInitialized(){return v._initialized}static getDefaultToken(){return v._defaultToken}static getSemanticContext(){return v._semanticContext}static __addTestHookListener(e){v._initialized&&d.__AddTestHookListener(e)}static __clearTestHookListener(){v._initialized&&d.__ClearTestHookListener()}static __backToUninitialized(){v._config=new r.Mk,v._semanticContext=new g(!0),v._contextProperties=new m,d=r.sE.CreateTelemetryManager(),v._initialized=!1}}v._initialized=!1,v._defaultToken=null,v._config=new r.Mk,v._contextProperties=new m,v._semanticContext=new g(!0);class f{constructor(e){this._initId=s.P6.GetGuid(),this._sequence=0,this._tenantToken=null,this._contextProperties=new m,this._semanticContext=new g(!1),this._sessionStartTime=0,this._sessionId=null,this._tenantToken=e||v.getDefaultToken()}logEvent(e){if(!e.name)throw new p(i.MISSING_EVENT_PROPERTIES_NAME);var t=this._createEventRecord(e.name,e.eventType);this._addCustomPropertiesToEvent(t,e),this._sendRecord(t)}logFailure(e,t,n,a,o){if(!e)throw new p(i.MISSING_FAILURE_SIGNATURE);if(!t)throw new p(i.MISSING_FAILURE_DETAIL);var r=this._createEventRecord("failure","failure");r.Extension.Add("Failure.Signature",e),r.Extension.Add("Failure.Detail",t),n&&r.Extension.Add("Failure.Category",n),a&&r.Extension.Add("Failure.Id",a),this._addCustomPropertiesToEvent(r,o),this._sendRecord(r)}logPageView(e,t,n,a,o,r){if(!e)throw new p(i.MISSING_PAGEVIEW_ID);if(!t)throw new p(i.MISSING_PAGEVIEW_NAME);var s=this._createEventRecord("pageview","pageview");s.Extension.Add("PageView.Id",e),s.Extension.Add("PageView.Name",t),n&&s.Extension.Add("PageView.Category",n),a&&s.Extension.Add("PageView.Uri",a),o&&s.Extension.Add("PageView.ReferrerUri",o),this._addCustomPropertiesToEvent(s,r),this._sendRecord(s)}logSession(e,t,n,o){if(e!==a.STARTED&&e!==a.ENDED)throw new p(i.INVALID_SESSION_STATE);var r=this._createEventRecord("session","session");if(e===a.STARTED){if(this._sessionStartTime>0)return;this._sessionStartTime=o||(new Date).getTime(),this._sessionId=n||s.P6.GetGuid(),r.Extension.Add("Session.Id",this._sessionId),r.Extension.Add("Session.State","Started")}else if(e===a.ENDED){if(0==this._sessionStartTime)return;var l=Math.floor(((new Date).getTime()-this._sessionStartTime)/1e3);r.Extension.Add("Session.Duration",l.toString()),r.Extension.Add("Session.DurationBucket",this._getSessionDurationFromTime(l)),r.Extension.Add("Session.Id",this._sessionId),r.Extension.Add("Session.State","Ended"),this._sessionId=null,this._sessionStartTime=0}r.Extension.Add("Session.FirstLaunchTime",new Date(h.firstLaunchTime).toISOString()),this._addCustomPropertiesToEvent(r,t),this._sendRecord(r)}getSessionId(){return this._sessionId}setContext(e,t,n){this._contextProperties.setProperty(e,t,n)}getSemanticContext(){return this._semanticContext}_getSessionDurationFromTime(e){return e<0?"Undefined":e<=3?"UpTo3Sec":e<=10?"UpTo10Sec":e<=30?"UpTo30Sec":e<=60?"UpTo60Sec":e<=180?"UpTo3Min":e<=600?"UpTo10Min":e<=1800?"UpTo30Min":"Above30Min"}_createEventRecord(e,t){var n=new s.WV;t||(t="custom"),n.EventType=e.toLowerCase(),n.Type=t.toLowerCase(),n.Extension.Add("EventInfo.Source","JS_default_source"),n.Extension.Add("EventInfo.InitId",this._initId),this._sequence++,n.Extension.Add("EventInfo.Sequence",this._sequence.toString()),n.Extension.Add("EventInfo.Name",e.toLowerCase());var i=new Date;return n.Timestamp=s.P6.GetTimeStampWithValue(i.getTime()),n.Extension.Add("EventInfo.Time",i.toISOString()),n.Extension.Add("EventInfo.SdkVersion","ACT-Web-JS-"+c.w.version),n}_addCustomPropertiesToEvent(e,t){this._addSemanticContext(e,h.semanticContext),this._addSemanticContext(e,v._semanticContext),this._addSemanticContext(e,this._semanticContext),this._sessionId&&e.Extension.Add("Session.Id",this._sessionId),this._addEventPropertiesToEvent(e,v._contextProperties),this._addEventPropertiesToEvent(e,this._contextProperties),this._addEventPropertiesToEvent(e,t)}_addSemanticContext(e,t){if(t&&t.contextMap.Count()>0)for(var n=t.contextMap.GetBuffer(),i=0;i<n.length;i++)"UserInfo.Id"==n[i].Key&&t.piiKind!=s.A4.NotSet?e.AddOrReplacePII(n[i].Key,n[i].Value,t.piiKind):e.Extension.AddOrReplace(n[i].Key,n[i].Value)}_addEventPropertiesToEvent(e,t){if(t){t.timestamp&&t.timestamp>=new Date("1/1/2000").getTime()&&(e.Timestamp=s.P6.GetTimeStampWithValue(t.timestamp),e.Extension.AddOrReplace("EventInfo.Time",new Date(t.timestamp).toISOString())),t.name&&(e.EventType=t.name.toLowerCase(),e.Extension.AddOrReplace("EventInfo.Name",t.name.toLowerCase()));var n=t.properties;if(n)for(var i in n)n[i].key&&"string"==typeof n[i].key&&(n[i].value||0==n[i].value||0==n[i].value||""==n[i].value)&&(u._isPii(n[i].pii)?(e.AddOrReplacePII(n[i].key,n[i].value.toString(),n[i].pii),e.Extension.Remove(n[i].key)):(e.Extension.AddOrReplace(n[i].key,n[i].value.toString()),e.PIIExtensions.Remove(n[i].key)))}}_sendRecord(e){v.isInitialized()&&d.SendAsync(this._tenantToken,[e])}}class y{constructor(){this.messageHandlers={}}registerMessageHandler(e,t){if(this.messageHandlers[e])throw new Error(`message handler already registered for - ${e}`);this.messageHandlers[e]=t}unregisterMessageHandler(e){delete this.messageHandlers[e]}}class S{constructor(){var e;this.telemetry=r.sE.CreateTelemetryManager(),this.ariaLoggers={},e=this.telemetry,d=e}initialize(e){this.telemetry.Initialize(e.config),v.initialize(e.documentInfo,e.appTokens.default)}start(){this.telemetry.Start()}stop(){this.telemetry.Stop()}flush(e){let t=8;const n=()=>{const i=this.telemetry._eventsCache.IsEmpty(),a=0==--t;i||a?e.postMessage("flushed"):this.telemetry.Flush(n)};n()}createNewLogger(e,t){this.ariaLoggers[e]=new f(t)}logEvent(e,t){if(!e)return;const n=this.ariaLoggers[e];n&&n.logEvent(t)}logSession(e,t){const n=this.ariaLoggers[t.name];if(!n)return;const i=t.state;n.logSession(i,t.properties,t.sessionId,t.sessionStartTime),e.postMessage("sessionId",{key:t.name,value:n.getSessionId()})}createNewSecondPartyLogger(e,t,n){}logSecondPartyEvent(e,t){}setContext(e){v.setContext(e.key,e.value,e.pii)}setUserId(e){v.getSemanticContext().setUserId(e)}setUserTenantId(e){v.getSemanticContext().setUserTenantId(e)}setUserRing(e){v.getSemanticContext().setUserRing(e)}setAppClientType(e){v.getSemanticContext().setAppClientType(e)}setDeviceAuthToken(e){}setPrivacyGuardSensitiveInformation(e){}updateSDKWithPrivacyGuard(e){}}var k=n(84674),b=n(876289),_=n(992744);const C=["admin","Admin","ADMIN","administrator","Administrator","ADMINISTRATOR","automation","Automation","AUTOMATION","client","Client","CLIENT","limited","Limited","LIMITED","office","Office","OFFICE","services","Services","SERVICES","user","User","USER"],w={"appinfo.id":"ext.app.id","appinfo.env":"ext.app.env","appinfo.version":"ext.app.ver","appinfo.versionnew":"ext.app.ver","appinfo.language":"ext.app.locale","userinfo.language":"ext.user.locale","userinfo.timezone":"ext.location.tz","userinfo.id":"ext.user.id","deviceinfo.id":"ext.device.localid","deviceinfo.make":"ext.device.make","deviceinfo.model":"ext.device.model","deviceinfo.networktype":"ext.net.type","deviceinfo.browsername":"ext.web.browser","deviceinfo.browserversion":"ext.web.browserversion"};class T{constructor(){this.secondPartyLoggers={},this.oneDsManager=new k.Z,this.sharedConfig={},this.privacyGuardContext={},this.mainContextMap={},this.commonSchemaContextMap={}}initialize(e){var t;this.initParams=e,this.sharedConfig={instrumentationKey:e.appTokens.default,endpointUrl:e.oneDsCollectorUrl,extensions:[],extensionConfig:[],propertyConfiguration:{populateBrowserInfo:!0,populateOperatingSystemInfo:!0,sessionAsGuid:!0},channelConfiguration:{payloadPreprocessor:e.enableCompression?(e,t)=>{this.gzipPayload(e,t)}:void 0,eventsLimitInMem:e.eventsLimitInMem,autoFlushEventsLimit:e.eventsLimitInMem*e.autoFlushPercent,ignoreMc1Ms0CookieProcessing:!0,enableCompoundKey:!0}},this.privacyGuard=new b.q,this.sharedConfig.extensionConfig||(this.sharedConfig.extensionConfig=[]),this.privacyGuardContext.IgnoredNameParts=C,this.sharedConfig.extensionConfig[null===(t=this.privacyGuard)||void 0===t?void 0:t.identifier]={context:this.privacyGuardContext,iKey:this.initParams.privacyGuardIngestionToken,useEventFieldPrefix:!0,useAbsoluteFieldName:!0},this.oneDsManager.create(this.sharedConfig,[this.privacyGuard]),this.initParams.enablePrivacyGuard&&this._initializePrivacyGuard()}updateSDKWithPrivacyGuard(e){e?this._initializePrivacyGuard():this._stopPrivacyGuard()}setPrivacyGuardSensitiveInformation(e){if(this.privacyGuard){const t=e.userNames,n=e.upns;t&&(this.privacyGuardContext.UserNames=t),n&&(this.privacyGuardContext.UserAliases=[],n.forEach((e=>{var t;const n=e.split("@")[0];n&&(null===(t=this.privacyGuardContext.UserAliases)||void 0===t||t.push(n))}))),this.privacyGuard.updateCommonContext(this.privacyGuardContext)}}start(){this.resume()}stop(){this.pause()}pause(){this.oneDsManager.getPostChannel().pause()}resume(){this.oneDsManager.getPostChannel().resume()}setDeviceAuthToken(e){var t;(null===(t=this.initParams)||void 0===t?void 0:t.enableLoggingGlobalDeviceId)&&this.oneDsManager.getPostChannel().setMsaAuthTicket(e)}flush(e,t){this.oneDsManager.getPostChannel().flush(!!t,(()=>{e.postMessage("flushed")}))}createNewLogger(e,t){if(this.initParams){this.defaultLogger=this.oneDsManager.newInst(t);const e="MSTeamsFix15SecondsProfile";this.oneDsManager.getPostChannel()._loadTransmitProfiles({[e]:[this.initParams.normalPrioritySendTimeInSecs,this.initParams.highPrioritySendTimeInSecs]}),this.oneDsManager.getPostChannel()._setTransmitProfile(e)}}logEvent(e,t){var n;if(!e||!t)return;const i=t.properties,a={};for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e)){const t=i[e],n={value:t.value,kind:t.pii};a[e]=n}const o=new Date(t.timestamp).toISOString(),r={name:t.name,baseType:t.eventType,time:o,data:Object.assign(Object.assign({},a),this.mainContextMap)};null===(n=this.defaultLogger)||void 0===n||n.track(r)}createNewSecondPartyLogger(e,t,n=!1){const i=this.oneDsManager.newInst(t);this.secondPartyLoggers[e]={logger:i,useTeamsContext:n}}logSecondPartyEvent(e,t){if(!e||!t)return;const n=this.secondPartyLoggers[e];n&&(n.useTeamsContext&&(t.data=Object.assign(Object.assign({},t.data),this.commonSchemaContextMap)),n.logger.track(t))}setContext(e){const t={value:e.value};this.mainContextMap[e.key]=t,this._setToCommonSchemaPropMap(e.key,t)}setUserId(e){const t="UserInfo.Id",n={value:e,kind:void 0};this.mainContextMap[t]=n,this._setToCommonSchemaPropMap(t,n)}logSession(e,t){t.sessionId&&this.oneDsManager.getPropertyManager().getPropertiesContext().session.setId(t.sessionId)}setUserTenantId(e){}setUserRing(e){}setAppClientType(e){}gzipPayload(e,t){e.data=(0,_.gzip)(e.data),e.urlString+="&content-encoding=gzip",t(e)}_setToCommonSchemaPropMap(e,t){const n=w[e.toLowerCase()];n&&(this.commonSchemaContextMap[n]=t)}_initializePrivacyGuard(){var e;null===(e=this.privacyGuard)||void 0===e||e.setEnabled(!0),this.intervalId||(this.intervalId=setInterval((()=>{var e;null===(e=this.privacyGuard)||void 0===e||e.sendSummaryEvent(!0)}),6e5))}_stopPrivacyGuard(){var e;this.intervalId&&clearInterval(this.intervalId),null===(e=this.privacyGuard)||void 0===e||e.setEnabled(!1)}}class E{constructor(){this.enableOneDsSdk=!1}initialize(e){if(!e)throw new Error("WebWorkerRouter did not exist.");this.router=e,this._registerMessageHandlers(e)}Verbose(e){this.router&&this.router.postMessage("verbose",e)}Error(e){this.router&&this.router.postMessage("error",e)}Info(e){this.router&&this.router.postMessage("info",e)}_registerMessageHandlers(e){e.registerMessageHandler("initialize",(e=>{this.initTelemetryTransport(e)})),e.registerMessageHandler("start",(()=>{var e;null===(e=this.telemetryTransport)||void 0===e||e.start()})),e.registerMessageHandler("stop",(()=>{var e;null===(e=this.telemetryTransport)||void 0===e||e.stop()})),e.registerMessageHandler("flush",(()=>{var t;null===(t=this.telemetryTransport)||void 0===t||t.flush(e)})),e.registerMessageHandler("newLogger",(e=>{var t;null===(t=this.telemetryTransport)||void 0===t||t.createNewLogger(e.key,e.value)})),e.registerMessageHandler("logEvent",(e=>{var t;null===(t=this.telemetryTransport)||void 0===t||t.logEvent(e.key,e.value)})),e.registerMessageHandler("newSecondPartyOneDsLogger",(e=>{var t;null===(t=this.telemetryTransport)||void 0===t||t.createNewSecondPartyLogger(e.key,e.value.ingestionToken,e.value.useTeamsContext)})),e.registerMessageHandler("logSecondPartyEvent",(e=>{var t;null===(t=this.telemetryTransport)||void 0===t||t.logSecondPartyEvent(e.key,e.value)})),e.registerMessageHandler("logSession",(t=>{var n;null===(n=this.telemetryTransport)||void 0===n||n.logSession(e,t)})),e.registerMessageHandler("setUserId",(e=>{var t;null===(t=this.telemetryTransport)||void 0===t||t.setUserId(e)})),e.registerMessageHandler("setUserTenantId",(e=>{var t;null===(t=this.telemetryTransport)||void 0===t||t.setUserTenantId(e)})),e.registerMessageHandler("setUserRing",(e=>{var t;null===(t=this.telemetryTransport)||void 0===t||t.setUserRing(e)})),e.registerMessageHandler("setDeviceAuthToken",(e=>{var t;null===(t=this.telemetryTransport)||void 0===t||t.setDeviceAuthToken(e)})),e.registerMessageHandler("setAppClientType",(e=>{var t;null===(t=this.telemetryTransport)||void 0===t||t.setAppClientType(e)})),e.registerMessageHandler("setContext",(e=>{var t;null===(t=this.telemetryTransport)||void 0===t||t.setContext(e)})),e.registerMessageHandler("setPrivacyGuardUserInfo",(e=>{var t;this.enableOneDsSdk&&(null===(t=this.telemetryTransport)||void 0===t||t.setPrivacyGuardSensitiveInformation(e))})),e.registerMessageHandler("updateSDKWithPrivacyGuard",(e=>{var t;this.enableOneDsSdk&&(null===(t=this.telemetryTransport)||void 0===t||t.updateSDKWithPrivacyGuard(e))}))}initTelemetryTransport(e){e.enableDebugTrace?e.config.log=this:e.config.log=void 0,e.enableOneDsSdkNs?(this.enableOneDsSdk=!0,this.telemetryTransport=new T):this.telemetryTransport=new S,this.telemetryTransport.initialize(e)}}class I extends y{constructor(){super(),this.telemetryWorker=new E,this.telemetryWorker.initialize(this)}postMessage(e,t){const n=this.messageHandlers[e];n&&n(t)}registerMessageHandler(e,t){super.registerMessageHandler(e,t)}unregisterMessageHandler(e){super.unregisterMessageHandler(e)}}class N extends y{constructor(e){super(),this.worker=this.hookUpWebWorker(e)}postMessage(e,t){this.worker.postMessage({name:e,params:t})}registerMessageHandler(e,t){super.registerMessageHandler(e,t)}unregisterMessageHandler(e){super.unregisterMessageHandler(e)}hookUpWebWorker(e){return e.onmessage=e=>{const t=e;if(!t||!t.data)return;const n=this.messageHandlers[t.data.name];n&&n(t.data.params)},e}}class A extends y{constructor(e,t){super(),this.sharedWorkerUrl=t,this.worker=this.createSharedWorker(e,this.sharedWorkerUrl)}initialize(){}postMessage(e,t){try{this.worker.port.postMessage({name:e,params:t})}catch(e){throw new Error(e)}}registerMessageHandler(e,t){super.registerMessageHandler(e,t)}unregisterMessageHandler(e){super.unregisterMessageHandler(e)}createSharedWorker(e,t){const n=t?new SharedWorker(t):e;return n.port.onmessage=e=>{const t=e;if(!t||!t.data||!t.data.name)return;const n=this.messageHandlers[t.data.name];n&&n(t.data.params)},n}}function M(){return new Worker("/statics/teams-modular-packages/hashed-assets/precompiled-telemetry-web-worker-7c67afd2d5a363c9.js")}function F(){return new SharedWorker("/statics/teams-modular-packages/hashed-assets/precompiled-telemetry-shared-worker-c5ba539d5d97451f.js")}function R(e,t){return"desktop"===e?function(e){return{url:e}.url?Promise.resolve(new A(void 0,e)):Promise.resolve(new A(new F))}(t):Promise.resolve(new N(new M))}var P,D=n(980633);!function(e){e.Desktop="Desktop",e.Messaging="Messaging",e.Files="Files",e.Apps="Apps",e.Activity="Activity",e.Feeds="Feeds",e.Teams="Teams",e.CMD="CMD",e.Notifications="Notifications",e.Foundation="Foundation"}(P||(P={}));const j=new Map;j.set(D.RG.WindowLaunchTime,{featureArea:P.Foundation,customDimensions:["App"]});var x,O=n(682796),L=n(498765),U=n(351626),B=n(597134);!function(e){e.default="default"}(x||(x={}));class W{constructor(){this._multiContextColumns=new Set,this._sessionId="",this._workerInited=!1,this._silent=!1,this._clientType="",this._cachedOperation=[],this.workerUrl="",this.defaultLoggerName=x.default,this._onSessionId=e=>{},(0,U.Y)((()=>{this._cachedOperation=[],this.workerUrl=""}))}get sessionId(){return this._sessionId}setMultiContextCallback(e){this._multiContextCallback=e}setEndpointHealth(e){this._getEndpointHealth=e}getEndpointHealth(e,t){var n;return this._getEndpointHealth?null===(n=this._getEndpointHealth(e,t))||void 0===n?void 0:n.isHealthy:void 0}initialize(e,t,n,i){var o;this._initializeParams=e,this._silent=e.isSilent,this._clientType=e.clientType;const{default:r}=e.appTokens;if(this.workerUrl=e.sharedWorkerUrl,this._delayLoadingWorker=e.delayLoadingWorker,t&&(this._consoleLogger=t,e.config.log=void 0,e.enableDebugTrace=!0),this.columnSuppressionService=n,this._enableSharedWorker=e.enableSharedWorker,this._enableSharedWorker&&"cdlworker"!==this._clientType?this._initializeProxyWorker(e,r,this.workerUrl):this._initializeDirectWorker(e,r),this._cachedOperation.push({name:"logSession",params:{name:this.defaultLoggerName,state:a.STARTED,sessionId:e.sessionId,sessionStartTime:e.sessionStartTime}}),i){const e=i.get(O.J.Telemetry);this._multiContextColumns=new Set(null!==(o=e.multiContextColumns)&&void 0!==o?o:[])}e.documentInfo.deviceId&&B.H.getInstance().setSamplingByDevice(e.documentInfo.deviceId);const s=null==i?void 0:i.getObservable(O.J.Telemetry);null==s||s.subscribe((e=>this._updateSDKwithPrivacyGuard(e))),null==s||s.subscribe((e=>this._updateSecondPartyTelemetryFlag(e)))}createEvent(e,t,n,i,a,o){var r;const s=new m;return s.name=e,s.eventType=t,s.timestamp=Date.now(),s.setProperty("EventInfo.BaseType",t),n&&(this._copyEventProperties(s,n,i),null===(r=this.columnSuppressionService)||void 0===r||r.applyColumnBlockingRules(e,null!=o?o:t,s,a),a&&s.setProperty(a.columnName,(0,L.XC)(a.packedData))),o&&s.setProperty("EventInfo.Identifier",o),s}flush(){return(0,o.__awaiter)(this,void 0,void 0,(function*(){return this._silent?new Promise(((e,t)=>{t()})):new Promise(((e,t)=>{this._router?(this._router.registerMessageHandler("flushed",(()=>{this._router&&this._router.unregisterMessageHandler("flushed"),e()})),this._router.postMessage("flush")):t()}))}))}logEvent(e,t){this._silent||this._sendOrCacheOperation("logEvent",{key:e,value:t})}initializeSecondPartyLogger(e,t,n=!1){this.enableSecondPartyTelemetry&&this._sendOrCacheOperation("newSecondPartyOneDsLogger",{key:e,value:{ingestionToken:t,useTeamsContext:n}})}logSecondPartyEvent(e,t){this.enableSecondPartyTelemetry&&!this._silent&&this._sendOrCacheOperation("logSecondPartyEvent",{key:e,value:t})}logSession(e,t,n){n&&(this._onSessionId=n);const i=this._cachedOperation.findIndex((e=>"logSession"===e.name));i>=0&&i<this._cachedOperation.length||this._sendOrCacheOperation("logSession",{name:this.defaultLoggerName,state:e,properties:t})}initializeLogger(e,t){this._sendOrCacheOperation("newLogger",{key:e,value:t})}setContext(e,t,n){var i;if("UserInfo.Id"===e&&B.H.getInstance().setSamplingByUser(t),!(null===(i=this.columnSuppressionService)||void 0===i?void 0:i.isContextColumnOk(e)))return;const a=null!=t?t:"";this._multiContextCallback&&this._multiContextColumns.has(e)&&this._multiContextCallback(e,t),this._sendOrCacheOperation("setContext",{key:e,value:(0,L.XC)(a),pii:n})}setPrivacyGuardUserInfo(e,t){this._sendOrCacheOperation("setPrivacyGuardUserInfo",{userNames:e,upns:t})}setDeviceAuthToken(e){this._sendOrCacheOperation("setDeviceAuthToken",e)}start(){this._silent||(!this._workerInited&&this._delayLoadingWorker&&this._enableSharedWorker&&this._setupWorkerManager(this._clientType,this.workerUrl),this._sendOrCacheOperation("start"))}stop(){this._silent||this._sendOrCacheOperation("stop")}Verbose(e){this._consoleLogger&&this._consoleLogger.debug(e)}Error(e){this._consoleLogger&&this._consoleLogger.error(e)}Info(e){this._consoleLogger&&this._consoleLogger.debug(e)}_initializeProxyWorker(e,t,n){!0!==e.delayLoadingWorker&&this._setupWorkerManager(this._clientType,this.workerUrl),n||this._cachedOperation.push({name:"initialize",params:e}),this._cachedOperation.push({name:"newLogger",params:{key:this.defaultLoggerName,value:t}}),this._cachedOperation.push({name:"logSession",params:{name:this.defaultLoggerName,state:a.STARTED,sessionId:e.sessionId,sessionStartTime:e.sessionStartTime}})}_initializeDirectWorker(e,t){this._router=new I,this._setupSessionIdHandler(this._router),this._setupTraceHandler(this._router),this._workerInited=!0,this._router.postMessage("initialize",e),this._router.postMessage("newLogger",{key:this.defaultLoggerName,value:t}),this._router.postMessage("logSession",{name:this.defaultLoggerName,state:a.STARTED,sessionId:e.sessionId,sessionStartTime:e.sessionStartTime}),this._router.postMessage("sessionId",{key:"sessionId",value:e.sessionId})}static getInstance(){return this.telemetryProviderInstance||(this.telemetryProviderInstance=new W),this.telemetryProviderInstance}_setupWorkerManager(e,t){((e,t)=>(0,o.__awaiter)(void 0,void 0,void 0,(function*(){return yield R(e,t)})))(e,t).then((e=>{this._router=e,this._router&&(this._router.registerMessageHandler("sessionId",(e=>{this._sessionId=e.value,this._onSessionId&&this._onSessionId(this._sessionId)})),this._router.registerMessageHandler("batchDone",(()=>{this._workerInited=!0})),this._router.registerMessageHandler("workerInitialized",(()=>{this._cachedOperation.length>0&&this._router&&(this._router.postMessage("batch",this._cachedOperation),this._cachedOperation=[])})),this._router.registerMessageHandler("error",(e=>{this.Error(e)})),this._router.registerMessageHandler("info",(e=>{console.log(`INFO from shared-worker, ${e}`),this.Info(e)})),this._router.registerMessageHandler("verbose",(e=>{this.Verbose(e)})))})).catch((e=>this.Verbose(`Error when initializing Telemetry Provider: ${e}`)))}_setupSessionIdHandler(e){e.registerMessageHandler("sessionId",(e=>{this._sessionId=e.value,this._onSessionId&&this._onSessionId(this._sessionId)}))}_setupTraceHandler(e){e.registerMessageHandler("error",(e=>{this.Error(e)})),e.registerMessageHandler("info",(e=>{this.Info(e)})),e.registerMessageHandler("verbose",(e=>{this.Verbose(e)}))}_sendOrCacheOperation(e,t){this._workerInited&&this._router?(this._cachedOperation.length>0&&(this._router.postMessage("batch",this._cachedOperation),this._cachedOperation=[]),this._router.postMessage(e,t)):this._cachedOperation.push({name:e,params:t})}_copyEventProperties(e,t,n){let i=null;for(const n in t)t.hasOwnProperty(n)&&(i=t[n],null!=i&&""!==i&&("object"==typeof i&&i.hasOwnProperty("piiKind")&&i.hasOwnProperty("value")&&i.piiKind in s.A4?e.setProperty(n,(0,L.XC)(i.value),i.piiKind):e.setProperty(n,(0,L.XC)(i))));if(n){const t=j.get(e.eventType);t&&this._copyMonitoringData(e,t,n)}}_copyMonitoringData(e,t,n){const i=[void 0,void 0,void 0],a=t.customDimensions.length;e.setProperty("Scenario.Priority",n.scenarioPriority),n.scenarioErrorCode&&e.setProperty("Scenario.ErrorCode",n.scenarioErrorCode),n.data.forEach((n=>{n.value&&e.setProperty(this._createMonitoringKey(t.featureArea,n.key),n.value);const a=t.customDimensions.findIndex((e=>e===n.key));a>0&&a<3&&(i[a]=n.value)}));let o="";for(let e=0;e<a;e++){const t=void 0===i[e]?"":i[e];o=e===a-1?`${o}${t}`:`${o}${t},`}e.setProperty("CombinedMonitoringDimensions",o)}_createMonitoringKey(e,t){return`QoS.${e}_${t}`}_updateSecondPartyTelemetryFlag(e){this.enableSecondPartyTelemetry=Boolean(e.enableSecondPartyTelemetry)}_updateSDKwithPrivacyGuard(e){var t,n;if(e&&(null===(t=this._initializeParams)||void 0===t?void 0:t.enableOneDsSdkNs)){const t=!!e.enablePrivacyGuard;t!==(null===(n=this._initializeParams)||void 0===n?void 0:n.enablePrivacyGuard)&&(this._initializeParams.enablePrivacyGuard=t,this._sendOrCacheOperation("updateSDKWithPrivacyGuard",t))}}}const H=()=>W.getInstance()},700608:(e,t,n)=>{"use strict";n.d(t,{ip:()=>m,aA:()=>v,MI:()=>g,Yx:()=>p,P3:()=>h});var i=n(906693),a=n(351626),o=n(971113),r=n(597134),s=n(892891),l=n(682796),c=n(498765);class d{constructor(e){this.telemetrySettings=null,this.disableColumnBlocker=!1,this.fixedColumnRules={},this.blockedColumnRules={},this.columnBlockingRules={},this.wildCardMergedTables={},this.wildCardTableEmpty=!0,this.updateColumnBlockingSettings=e=>{if(e){if(this.telemetrySettings=e,this.disableColumnBlocker=e.disableColumnBlocker||!1,this.disableColumnBlocker)return this.columnBlockingRules={},this.wildCardMergedTables={},void(this.wildCardTableEmpty=!0);let t={};e.blockedColumnRules&&(t=e.blockedColumnRules),this.blockedColumnRules=t;let n={};e.fixedColumnRules&&(n=e.fixedColumnRules),this.fixedColumnRules=n,this.generateRuleSet()}};e.getObservable(l.J.Telemetry).subscribe(this.updateColumnBlockingSettings),this.telemetrySettings=e.get(l.J.Telemetry),this.updateColumnBlockingSettings(this.telemetrySettings)}isContextColumnOk(e){return(0,s.isEmpty)(this.columnBlockingRules)||(0,s.isEmpty)(this.columnBlockingRules["*"])||(0,s.isEmpty)(this.columnBlockingRules["*"]["*"])||!this.columnBlockingRules["*"]["*"][e]}applyColumnBlockingRules(e,t,n,i){try{if(this.wildCardTableEmpty||this.wildCardMergedTables[e]||(this.columnBlockingRules[e]=(0,s.merge)(this.columnBlockingRules[e],this.columnBlockingRules["*"]),this.wildCardMergedTables[e]=!0),(0,s.isEmpty)(this.columnBlockingRules[e]))return;(0,s.isEmpty)(this.columnBlockingRules[e][t])?(0,s.isEmpty)(this.columnBlockingRules[e]["*"])||this.blockEventPropertyColumn(this.columnBlockingRules[e]["*"],n,i):this.blockEventPropertyColumn(this.columnBlockingRules[e][t],n,i)}catch(e){return void n.setProperty("diagBlockedColumns",(0,c.XC)({parseFailed:!0}))}}blockEventPropertyColumn(e,t,n){const i=t.properties,a={},o=null==n?void 0:n.packedData;(0,s.forEach)(e,((e,t)=>{(0,s.isEmpty)(i[t])||(i[t].value="",a[t]=e),o&&o.forEach((n=>{n[t]&&(n[t]=void 0,a[t]=e)}))})),(0,s.isEmpty)(a)||t.setProperty("diagBlockedColumns",(0,c.XC)(a))}generateRuleSet(){try{this.columnBlockingRules={},this.wildCardMergedTables={};const e=this.blockedColumnRules["*"],t=this.fixedColumnRules["*"];(0,s.forEach)(this.blockedColumnRules,((n,i)=>{if((0,s.isEmpty)(n))return;(0,s.isEmpty)(e)||"*"===i||(n=(0,s.merge)(n,e));!(0,s.isEmpty)(this.fixedColumnRules)&&!(0,s.isEmpty)(this.fixedColumnRules[i])&&!(0,s.isEmpty)(t)&&"*"!==i&&(this.fixedColumnRules[i]=(0,s.merge)(this.fixedColumnRules[i],t)),this.columnBlockingRules[i]={};const a={};(0,s.isEmpty)(n["*"])||this.mergeBlockedColumnsRulesForAllEventType(n,i,a),(0,s.isEmpty)(a)||(this.columnBlockingRules[i]["*"]=a),this.mergeBlockedColumnsRulesForEveryEventType(n,i,a),(0,s.isEmpty)(this.columnBlockingRules[i])?delete this.columnBlockingRules[i]:this.wildCardMergedTables[i]=!0})),this.wildCardTableEmpty=(0,s.isEmpty)(this.columnBlockingRules["*"])}catch(e){return}}mergeBlockedColumnsRulesForAllEventType(e,t,n){(0,s.forEach)(e["*"],((e,i)=>{e>(this.fixedColumnRules[t]&&this.fixedColumnRules[t]["*"]&&this.fixedColumnRules[t]["*"][i]||0)&&(n[i]=e)}))}mergeBlockedColumnsRulesForEveryEventType(e,t,n){(0,s.forEach)(e,((e,i)=>{"*"!==i&&((0,s.isEmpty)(this.fixedColumnRules[t])||(0,s.isEmpty)(this.fixedColumnRules[t][i])?this.columnBlockingRules[t][i]=(0,s.merge)(e,n):(this.columnBlockingRules[t][i]={},(0,s.forEach)(e,((e,n)=>{e>(this.fixedColumnRules[t][i][n]||0)&&(this.columnBlockingRules[t][i][n]=e)})),this.columnBlockingRules[t][i]=(0,s.merge)(this.columnBlockingRules[t][i],n),(0,s.isEmpty)(this.columnBlockingRules[t][i])&&delete this.columnBlockingRules[t][i]))}))}}const u="heartbeat";class m{constructor(){this.initialized=!1,this.eventDecoratorCallbacks=[],this.flush=()=>this.telemetryProvider.flush(),this.telemetryProvider=(0,i.Yf)(),(0,a.Y)((()=>{this.initialized=!1,this.eventDecoratorCallbacks=[]}))}get sessionId(){return this.telemetryProvider.sessionId}initialize(e,t,n){this.initialized||(this.consoleLogger=t,this.consoleLogger.debug("TelemetrySender initialized."),r.H.getInstance().initialize(n),this.columnSuppressionService=new d(n),this.telemetryProvider.initialize(e,this.consoleLogger,this.columnSuppressionService,n),this._tablePostfix=e.documentInfo.tablePostfix||"",this.initialized=!0)}static getInstance(){return this.telemetrySender||(this.telemetrySender=new m),this.telemetrySender}registerEventDecorator(e){this.eventDecoratorCallbacks.push(e)}sendTelemetry(e,t,n={},a,s,l){if(!this.initialized)return;t=t.replace(/\-/g,"_").toLowerCase();const c=`${o.x[e]}${this._tablePostfix}`.toLowerCase(),d=e===o.x.Scenario?n["Scenario.Status"]:e===o.x.Http?n.resultCode:e===o.x.Endpoint?n.result:void 0,u=r.H.getInstance().getSampleRate(c,null!=l?l:t,d);if(u===r.k)return;this.decorateEvent(t,n);const m=this.telemetryProvider.createEvent(c,t,n,a,s,l);m.setProperty("sampleRate",u),this.telemetryProvider.logEvent(i.hy.default,m)}sendScenarioEvent(e,t,n,a,s){if(!this.initialized)return;const l=e.replace(/\-/g,"_").toLowerCase(),c=`${o.x[o.x.Scenario]}${this._tablePostfix}`.toLowerCase(),d=r.H.getInstance().getSampleRate(c,l,n["Scenario.Status"]);if(d===r.k)return;this.decorateEvent(l,t);const u=Object.assign(Object.assign({},n),t),m=this.telemetryProvider.createEvent(c,e,u,a,s);m.setProperty("sampleRate",d),this.telemetryProvider.logEvent(i.hy.default,m)}sendHeartbeatEvent(e){if(!this.initialized)return;const t=`${o.x[o.x.Heartbeat]}${this._tablePostfix}`.toLowerCase();this.decorateEvent(u,e);const n=this.telemetryProvider.createEvent(t,u,e);this.telemetryProvider.logEvent(i.hy.default,n)}sendLoggingEvent(e,t,n,a,s){if(!this.initialized)return;e=e.replace(/\-/g,"_").toLowerCase();const l=`${o.x[o.x.Logging]}${this._tablePostfix}`.toLowerCase(),c=r.H.getInstance().getSampleRate(l,n,t.logLevel);if(c===r.k)return;this.decorateEvent(e,t);const d=this.telemetryProvider.createEvent(l,e,t,a,s,n);d.setProperty("sampleRate",c),this.telemetryProvider.logEvent(i.hy.default,d)}decorateEvent(e,t){this.eventDecoratorCallbacks.forEach((n=>n(e,t)))}}function p(e,t,n,i,a){m.getInstance().sendScenarioEvent(e,t,n,i,a)}function g(e,t,n,i,a){m.getInstance().sendLoggingEvent(e,t,n,i,a)}function h(e,t,n,i,a,o){m.getInstance().sendTelemetry(e,t,n,i,a,o)}function v(e){m.getInstance().sendHeartbeatEvent(e)}},980633:(e,t,n)=>{"use strict";var i,a,o;n.d(t,{RG:()=>i,ck:()=>a,t7:()=>o}),function(e){e.PrivateStreamIdWrite="private_stream_id_write",e.FeedsCalculateFirstBellCount="feeds_calculate_first_bell_count",e.AuthStart="auth_web_initialization",e.AuthWebLogout="auth_web_logout",e.BroadcastAttendeeJoinBroadcast="broadcast_attendee_join_broadcast",e.BroadcastAttendeeLoadAmpScript="broadcast_attendee_load_amp_script",e.BroadcastAttendeeLoadStreamPlayerScript="broadcast_attendee_load_stream_player_script",e.BroadcastByoeLoadStreamEmbed="broadcast_byoe_load_stream_embed",e.BroadcastJoinModality="broadcast_join_modality",e.BroadcastLazyLoad="broadcast_lazy_load",e.BroadcastResolveRole="broadcast_resolve_role",e.BroadcastWaitingForSetlayout="broadcast_waiting_for_setlayout",e.CallAcceptBroadcast="call_accept_broadcast",e.JoinOrCreateMeetupFromLinkBroadcast="join_or_create_meetup_from_link_broadcast",e.JoinScheduledMeetupBroadcast="join_scheduled_meetup_broadcast",e.StreamEmbedVideoStart="stream_embed_video_start",e.AddParticipantBroadcast="add_participant_broadcast",e.BcastQnaExtensionEventMessageReceived="bcast_qna_extension_event_message_received",e.BroadcastAttendeePerformance="broadcast_attendee_performance",e.BroadcastAvailabilityBmc="broadcast_availability_bmc",e.BroadcastAvailabilityComposer="broadcast_availability_composer",e.BroadcastConnectBmc="broadcast_connect_bmc",e.BroadcastGetOnetimeurl="broadcast_get_onetimeurl",e.BroadcastQnaFrameLoad="broadcast_qna_frame_load",e.BroadcastSchedulingCreateLiveEventchat="broadcast_scheduling_create_live_eventchat",e.BroadcastLiveStreamPlayback="broadcast_live_stream_playback",e.BroadcastSchedulingGetLiveEvent="broadcast_scheduling_get_live_event",e.BroadcastSchedulingUpdateLiveEventchat="broadcast_scheduling_update_live_eventchat",e.BroadcastSetlayout="broadcast_setlayout",e.BroadcastStart="broadcast_start",e.BroadcastStop="broadcast_stop",e.BroadcastYammerAadTokenLoginStatus="broadcast_yammer_aad_token_login_status",e.BroadcastYammerExtensionFeed="broadcast_yammer_extension_feed",e.CallingJoinMeetupBroadcast="calling_join_meetup_broadcast",e.GetScheduledBroadcastMeetingUsingIds="get_scheduled_broadcast_meeting_using_ids",e.QnaFeedLoaded="qna_feed_loaded",e.StreamProducerEndEvent="stream_producer_end_event",e.StreamProducerStartEvent="stream_producer_start_event",e.StreamProducerStartSetup="stream_producer_start_setup",e.BcastQnaExtensionUpdateAuthToken="bcast_qna_extension_update_auth_token",e.BroadcastYammerEmbedGetToken="broadcast_yammer_embed_get_token",e.QnaFeedRefreshed="qna_feed_refreshed",e.QnaRetryConnection="qna_retry_connection",e.StreamEmbedVideoPlayback="stream_embed_video_playback",e.StreamProducerDisconnect="stream_producer_disconnect",e.StartClosedCaptions="start_closed_captions",e.StopClosedCaptions="stop_closed_captions",e.StartRtmpInView="start_rtmp_in_view",e.ConnectedCalendarSettingsGet="connected_calendar_settings_get",e.ConnectedCalendarSettingPublish="connected_calendar_setting_publish",e.ConnectedCalendarSettingDelete="connected_calendar_settings_delete",e.ConnectedCalendarSettingsSync="connected_calendar_settings_sync",e.GetConnectedCalendarSettings="get_connected_calendar_settings",e.AddConnectedCalendarSetting="add_connected_calendar_setting",e.UpdateConnectedCalendarSetting="update_connected_calendar_setting",e.DeleteConnectedCalendarSetting="delete_connected_calendar_setting",e.StartRecording="start_recording",e.StopRecording="stop_recording",e.StreamVideoPlayback="stream_video_playback",e.StreamVideoStart="stream_video_start",e.CallAccept="call_accept",e.CreateGroupCall="create_group_call",e.CreateOneToOneCall="create_one_to_one_call",e.CreateOneToOnePstnCall="create_one_to_one_pstn_call",e.IncomingPstnCall="incoming_pstn_call",e.JoinGroupCall="join_group_call",e.CallTabLoadLog="call_tab_load_log",e.CallTabUpdateLog="call_tab_update_log",e.CallVoicemailTabLoadList="call_voicemail_tab_load_list",e.CreateOneToOneInteropCall="create_one_to_one_interop_call",e.DetectCallEscalationOnReceiver="detect_call_escalation_on_receiver",e.EscalateOneToOneCall="escalate_one_to_one_call",e.IncomingCall="incoming_call",e.IncomingInteropCall="incoming_interop_call",e.CallEndMultiCallList="call_end_multi_call_list",e.CallResumeMultiCallList="call_resume_multi_call_list",e.CallRoutingInformationalDialog="call_routing_informational_dialog",e.CallTabActionChatWith="call_tab_action_chat_with",e.CallingAddorupdateForwardingSettings="calling_addorupdate_forwarding_settings",e.CallingGetForwardingSettings="calling_get_forwarding_settings",e.HoldCall="hold_call",e.IncomingTransferRequest="incoming_transfer_request",e.ResumeCall="resume_call",e.SfbLoadFavorites="sfb_load_favorites",e.TransferCall="transfer_call",e.CallingStackInit="calling_stack_init",e.AnnotationsFetchWorkflow="annotations_fetch_workflow",e.ChannelSwitchL1="channel_switch_l1",e.ChannelSwitchL2="channel_switch_l2",e.ChannelSwitchL2Popout="channel_switch_l2_popout",e.ReadCollabObject="read_from_collab_object",e.ReserveResourceToCollabObject="reserve_resource_to_collab_object",e.AddResourcesToCollabObject="add_resources_to_collab_object",e.CommitResourceToCollabObject="commit_resource_to_collab_object",e.UpdateResourcesOnCollabObject="update_resources_on_collab_object",e.ContactsSyncSettingsDelete="contacts_sync_settings_delete",e.HostCommsLoadModule="host_comms_load_module",e.OpenParentsApp="open_parents_app",e.ParentsAppChatEntry="parents_app_chat_entry",e.GetTeamsMeetingConfiguration="get_teams_meeting_configuration",e.GuardiansLaunchParentTeacherMeetingSchedulingForm="guardians_launch_parent_teacher_meeting_scheduling_form",e.EmbedAuthStrap="embed_auth_strap",e.EspAppReady="esp_app_ready",e.EspDisplaySurface="esp_display_surface",e.WikiRead="wiki_read",e.ExtListWorkflowTemplates="ext_list_workflow_templates",e.ExtListCatalogExtensions="ext_list_catalog_extensions",e.ExtGetFlyoutFilteredME="ext_get_flyout_filtered_me",e.ExtComposeBoxMessageExtensionUninstallApp="ext_composebox_me_uninstall_app",e.ExtGetWorkflowsTaskModuleInput="ext_get_workflows_task_module_input",e.InstallSideLoadApp="ext_install_side_load_app",e.InstallTrustedSideLoadApp="ext_install_trusted_side_load_app",e.FloodgateSurvey="floodgate_survey",e.BootStrapFloodgate="bootstrap_floodgate",e.ScheduledJobComplete="scheduled_job_complete",e.ExperienceChange="experience_change",e.CriticalRenderStable="critical_render_stable",e.RenderChatList="render_chat_list",e.ChatListActionSetChatReadStatus="chat_list_action_set_chat_read_status",e.ChatListActionSetChatPinned="chat_list_action_set_chat_pinned",e.ChatListActionPopoutConversation="chat_list_action_popout_conversation",e.ChatListActionCall="chat_list_action_call",e.PhotosFetchData="photos_fetch_data",e.MessageMeetingChicletJoinMeeting="msg_meeting_chiclet_join_meeting",e.MessageMeetingChicletAddToMyCalendar="msg_meeting_chiclet_add_to_my_calendar",e.MessageMeetingChicletImportCalendarEvent="msg_meeting_chiclet_import_calendar_event",e.MessageMeetingChicletDeleteFromCalendar="msg_meeting_chiclet_delete_from_calendar",e.MfuContactsStats="mfu_contacts_stats",e.GetConnectedAccounts="get_connected_accounts",e.HardDeleteConnectedAccount="hard_delete_connected_account",e.AddExternalAccount="add_external_account",e.RemoveExternalAccount="remove_external_account",e.CancelMeetingOperation="cancel_meeting_operation",e.JoinMeetingOperation="join_meeting_operation",e.NewMeeting="new_meeting",e.OpenMeeting="open_meeting",e.SaveMeeting="save_meeting",e.SendMeeting="send_meeting",e.CallNewAlertService="call_new_alert_service",e.HidDeviceMuteMicOnDevice="hid_device_mute_mic_on_device",e.HidDeviceMuteOnDevice="hid_device_mute_on_device",e.HidServiceInitialize="hid_service_initialize",e.NoopScenario="noop",e.unclaimed_scenario_steps="unclaimed_scenario_steps",e.DroppedMessageNotifications="dropped_message_notifications",e.HostSettingsSync="host_settings_sync",e.ApplicationLaunchTime="application_launch_time",e.CrossClientTestScenario="cross_client_test_scenario",e.AppStart="app_start",e.CoreInitialize="core_initialize",e.DomLoadingStart="dom_loading_start",e.DownloadAndParse="download_and_parse",e.DynamicImport="dynamic_import",e.ExperienceReady="experience_ready",e.PhasedRender="phased_render",e.ResolveMainImports="resolve_main_imports",e.RestorePersistedWindows="restore_persisted_windows",e.WindowLaunchTime="window_launch_time",e.CommandEvent="commandEvent",e.EntityCommand="entity_command",e.AcquireToken="acquire_token",e.AcquireTokenInBackground="acquire_token_in_background",e.AppLogout="authenticationService_appLogout",e.AppCtxProviderWait="app_ctx_provider_wait",e.CentralDataLayerSubscription="cdl_subscription_agg",e.CentralDataLayeRequest="cdl_request",e.CentralDataLayerWorkerStartup="cdl_worker_startup",e.CentralDataLayerWorkerManagerStartup="cdl_worker_manager_startup",e.CentralDataLayerDataStoreCreate="cdl_data_store_create",e.CentralDataLayerDataStoreRemoveAllData="cdl_data_store_remove_all_data",e.CentralDataLayerDataStoreRemoveUserData="cdl_data_store_remove_user_data",e.ComposeDisabled="compose_disabled",e.ChatSendMessage="chat_send_message",e.CreateChat="create_chat",e.GetAuthUser="get_auth_user",e.GetSkypeToken="get_skype_token",e.IndexedDBDelete="indexed_db_delete",e.IndexedDBFetch="indexed_db_fetch",e.IndexedDBWrite="indexed_db_write",e.LongPollRecovery="long_poll_recovery",e.LongPollError="long_poll_error",e.QueryExecution="query_exec",e.FatalError="fatal_error",e.GlobalWindowError="global_window_error",e.UnhandledRejection="unhandled_rejection_error",e.GarbageCollection="garbage_collection",e.AuthHandlerRequest="auth_handler_request",e.SendSmartReplyMessage="chat_send_sr_message",e.CacheEviction="cache_eviction",e.NotificationSettingsChanged="notification_settings_changed",e.NotificationSettingsPageLoad="notification_settings_page_load",e.ContactsSyncSettingsMutation="contacts_sync_settings_mutation",e.ReadReceiptsEnabledToggled="toggle_read_receipts_enbaled",e.ContactsSyncPopoutOpened="contacts_sync_popout",e.RenderCallableChannelTab="render_callable_channel_tab",e.RenderCallingDefault="render_calling_default",e.RenderCallsTab="render_calls_tab",e.RenderCallingJoin="render_calling_join",e.RenderCallingScreenManager="render_calling_screen_manager",e.RenderCallingPreJoin="render_calling_prejoin",e.RenderCallingScreen="render_calling_screen",e.RenderMeetingRoomConsoleScreen="render_meeting_room_console_screen",e.RenderSmartReplies="render_smart_replies",e.I18nMissingInterpolationHandler="i18n_missing_interpolation_handler",e.I18nMissingKeyHandler="i18n_missing_key_handler",e.I18nNamespaceLoad="i18n_namespace_load",e.I18nGetLocaleInfo="i18n_get_locale_info",e.I18nFallbackToIntl="i18n_fallback_to_intl",e.I18nLangFallback="i18n_lang_fallback",e.AllSearch="search_all",e.MessageSearch="search_message",e.FilesSearch="search_files",e.PeopleSearch="search_people",e.EmailSearch="search_email",e.CustomSearch="search_custom",e.CustomSearchPreFetch="custom_search_pre-fetch",e.SearchStart="search_start",e.MessageSearch3S="search_message_3s",e.EmailSearch3S="search_email_3s",e.GetPost="csa_get_post",e.GetRepliesInChain="csa_get_replies_in_chain",e.GetPostAuthorMris="csa_get_post_authors",e.RenderFileViewer="render_file_viewer",e.RenderFileEmailViewer="render_file_email_viewer",e.RefreshSiteUrl="documents_refresh_site_url_ns",e.MainImportToDomContentLoaded="main_import_to_dom_content_loaded",e.FilePreviewLayoutToJsApiScriptLoad="file_preview_layout_to_jsapi_script_load",e.JsApiScriptLoad="jsapi_script_load",e.JsApiFirstStep="jsapi_first_step",e.JsApiSecondStep="jsapi_second_step",e.FileRedeem="documents_file_redeem",e.FileRedeemByFileId="documents_file_redeem_file_id",e.AddFileToMessage="documents_share_file_message",e.ChooseFileShareMedium="documents_choose_file_share_medium",e.ChooseFileFromOsDialog="documents_choose_file_from_os",e.ChooseFileFromOnedrive="documents_choose_file_from_onedrive",e.FetchNativeEntrypointAvailability="documents_filespolicy_nativeFileEntryPoints",e.QueryItemDetailsService="documents_query_item_details_service",e.QueryLegacyVroomService="documents_query_legacy_vroom_service",e.FilesCreateShareLink="documents_create_share_link",e.ChatListFiltering="chat_list_filtering",e.SendFeedback="send_feedback",e.SendSmartRepliesFeedback="send_sr_feedback",e.FetchPersonalSiteInfo="documents_fetch_personal_site_info",e.FetchChannelSiteInfo="fetch-channel-site-info",e.FetchThreadSharepointIds="fetch-thread-sharepoint-ids",e.FetchOneDriveDetails="documents_fetch_onedrive_details",e.FetchOneDriveDetailsFromCDL="documents_fetch_onedrive_details_from_cdl_v2",e.CreateFileChiclet="documents_create_file_chiclet_on_link_paste",e.AsyncLinkToChiclet="documents_async_link_to_chiclet",e.FilesPersonalPickerAuthTokenPrefetch="files_personal_picker_auth_token_prefetch",e.RenderFilesPersonalPicker="render_files_personal_picker",e.FilesPersonalPicker="files_personal_picker",e.FilesPersonalPickerAuthTokenFetch="files_personal_picker_auth_token_fetch",e.FileUploadChat="documents_upload_file_chat",e.FileUploadChannel="documents_upload_file_channel",e.FileRemoveChat="documents_remove_file_chat",e.FileRemoveChannel="documents_remove_file_channel",e.FileAttachChat="documents_attach_file_chat",e.FileAttachChannel="documents_attach_file_channel",e.FilesAMSImageUpload="documents_ams_image_upload",e.FileChicletDefaultPermission="documents_share_link_chiclet_default_permission",e.FileChicletExistingPermission="documents_share_link_chiclet_existing_permission",e.FileShareDialogAudience="documents_share_dialog_audience",e.FileShareLinkCopyToClipboard="documents_share_link_copy_to_clipboard",e.FileSharingCopyLinkDialog="documents_share_link_copy_dialog",e.FileSharingPermissionDialog="documents_share_link_permission_dialog",e.FileOpenInDesktopApp="documents_action_open_office_file_app",e.FileDownload="documents_action_download_file",e.FileOpenOnline="documents_action_open_file_online",e.FileEditInTeams="documents_action_edit_file_in_teams",e.FileOpenSuggestionQuery="documents_file_open_suggestion_query",e.FileChangeDefaultAppQuery="documents_change_default_app_query",e.FetchFileSettings="fetch_file_settings",e.FetchDeviceSpecificFileOpenPreference="fetch_device_specific_file_open_preference",e.ExtensibilityAppsCore="extensibility_apps_core",e.RoomRemoteStart="room_remote_start",e.RoomRemoteMeetingRoomName="room_remote_meeting_room_name",e.RoomRemoteMeetingRoomStates="room_remote_meeting_room_states",e.RoomRemoteMeetingRoomCapabilities="room_remote_meeting_room_capabilities",e.RoomRemoteMeetingRoomSendCommandVolumeUp="room_remote_meeting_room_send_command_volume_up",e.RoomRemoteMeetingRoomSendCommandVolumeDown="room_remote_meeting_room_send_command_volume_down",e.RoomRemoteMeetingRoomSendCommandVideo="room_remote_meeting_room_send_command_video",e.RoomRemoteMeetingRoomSendCommandMic="room_remote_meeting_room_send_command_mic",e.RoomRemoteMeetingRoomSendCommandCaptions="room_remote_meeting_room_send_command_captions",e.RoomRemoteMeetingRoomSendCommandLayout="room_remote_meeting_room_send_command_layout",e.RoomRemoteMeetingRoomSendCommandLeaveMeeting="room_remote_meeting_room_send_command_leaveMeeting",e.GetMeetingTemplateDescriptions="get_meeting_template_descriptions",e.WebinarCore="webinar_core",e.WebinarGetReport="webinar_get_report",e.GuardiansGetMembersAndRelatedContacts="guardians_get_members_and_related_contacts",e.GuardiansGetRelatedContacts="guardians_get_related_contacts",e.GuardiansGetMemberProfiles="guardians_get_member_profiles",e.GuardiansGetRelatedContactsProfiles="guardians_get_related_contacts_profiles",e.GuardiansInactiveRelatedContactsBanner="guardians_inactive_related_contacts_banner",e.AmsImageApiLoad="ams_image_api_load",e.AmsImageBrowserLoad="ams_image_browser_load",e.AmsImageDownloadFetchLatency="ams_image_download_fetch_latency",e.AmsImageOfflineDownloadFetchLatency="ams_image_offline_download_fetch_latency",e.AmsImageUpload="ams_image_upload",e.ImageDownloadUsingProxy="image_download_using_proxy",e.OfflineCacheStorageImageUpload="ocm_image_upload",e.OnDemandTranslation="on_demand_translate_message",e.AutomaticTranslationBatch="automatic_translate_messages",e.DetectMessageLanguages="detect_message_languages",e.DetectLanguagePrompt="show_switch_language_prompt",e.AudioFileDownload="audio_file_download",e.ATPGetPolicy="atp_get_policy",e.ATPGetPolicyTask="atp_get_policy_task",e.ATPGetUrlReputation="atp_get_url_reputation",e.ATPFastSharepointSafelinksClick="atp_fast_sharepoint_safelinks_click",e.MessageReactionRemove="messaging_remove_message_reaction",e.MessageReactionAdd="messaging_add_message_reaction",e.MessageReactionUpdate="messaging_update_message_reaction",e.GetAtMentions="get_at_mentions",e.ConversationSyncMessageDisplay="conversation_sync_message_display",e.CodeSnippetUpload="code_snippet_upload",e.CodeSnippetDownload="code_snippet_download",e.DeleteChat="messaging_delete_chat",e.DeleteMessage="messaging_delete_message",e.AdminDeleteMessage="messaging_admin_delete_message",e.DeleteMessageSaveId="messaging_delete_message_save_current_session",e.UndeleteMessage="messaging_undo_delete",e.AckUrgentMessage="messaging_ack_urgent_message",e.MessageSendChat="message_send_chat",e.MessageEditChat="message_edit_chat",e.NewChat="new_chat",e.DlpSenderAction="dlp_sender_action",e.DlpFetchGeneric="dlp_fetch_generic",e.TranslationCoachmark="translation_coachmark",e.AcceptBlockSfCChat="accept-block-sfc-chat",e.AcceptBlockMSAUser="block-unblock-msa-user",e.ChatSwitch="chat_switch",e.MeetingChatSwitch="meeting_chat_switch",e.AddMembersToThread="add_members_to_thread",e.PeoplePickerRemote="people_picker_load_results",e.PeoplePickerInstantScd="people_picker_load_results_scd",e.PeoplePickerCache="people_picker_load_results_clientonly",e.PeoplePickerResolveUserRemote="people_picker_resolve_user_remote",e.PeoplePickerPstnAssignmentRemote="people_picker_pstn_resolve_user_remote",e.PeoplePicker3S="people_picker_3s",e.PeoplePickerAAD="people_picker_aad",e.PeoplePickerIDB="people_picker_indexeddb",e.PeoplePickerResolveUserOnSelection="people_picker_resolve_user_on_selection",e.PeoplePickerOffNetwork="people_picker_load_results_off_network",e.PeoplePickerTFLSms="people_picker_load_results_sms",e.PeoplePickerXTap="people_picker_load_results_xTap",e.PeoplePickerMfuContactsCacheSearch="people_picker_search_mfu_contacts_cache",e.PeoplePickerGroupChatSearch="people_picker_search_group_chats",e.PeoplePickerPeopleCacheSearch="people_picker_search_people_cache",e.PeoplePickerSubstrateWarmup="people_picker_substrate_warmup",e.PeoplePickerRawContactsCacheSearch="people_picker_search_raw_contacts_cache",e.ProfileFetchSingle="single_profile_fetch",e.ProfileFetchMultiple="multiple_profile_fetch",e.ProfileFetchMultipleConversation="multiple_profile_fetch_conversation",e.ProfileFetchME="me_profile_fetch",e.MSASearchability="msa_searchability",e.EditAvatar="edit_avtar",e.ContactsSyncSettings="contacts_sync_settings",e.ContactsSyncSettingsUpdate="contacts_sync_settings_update",e.ContactsSyncSyncWorkflow="contacts_sync_sync_workflow",e.ContactsSyncUnsyncWorkflow="contacts_sync_unsync_workflow",e.ContactsSyncSuggestedContacts="contacts_sync_suggested_contacts",e.ContactsSyncSUggestedContactsSubscription="contacts_sync_suggested_contacts_subscription",e.CoachReportGetArtifact="coach_report_get_artifact",e.CoachReportGetArtifactsForThread="coach_report_get_artifacts_for_thread",e.CoachReportCritiqueFeedback="coach_report_critique_feedback",e.CalHasCoachReport="cal_has_coach_report",e.BuddyListAddMemberToGroup="buddylist_add_member_to_group",e.BuddyListGetBlockedContacts="people_get_blocked_contacts",e.BuddyListUpdateBlockedContacts="people_update_blocked_contacts",e.PresenceCreateEndpointScenario="unified_presence_t2_create_endpoint",e.PresenceDeleteEndpointScenario="unified_presence_t2_delete_endpoint",e.PresenceGetUsersBatchPresenceScenario="unified_presence_t2_get_user_batch_presence",e.SetUserInitiatedPresenceScenario="unified_presence_t2_set_user_initiated_presence",e.SetStatusNoteScenario="unified_presence_t2_set_status_note",e.CreateWiki="wikiv2_create_wiki",e.LoadWiki="wikiv2_load_wiki",e.DeleteWiki="wikiv2_delete_wiki",e.SavePageTitleWiki="wikiv2_save_page_title",e.LockSectionWiki="wikiv2_lock_section",e.SaveSectionWiki="wikiv2_save_section",e.AddPageWiki="wikiv2_add_page",e.DeletePageWiki="wikiv2_delete_page",e.MovePageWiki="wikiv2_move_page",e.MoveSectionWiki="wikiv2_move_section",e.DeleteSectionWiki="wikiv2_delete_section",e.ForceUnlockWiki="wikiv2_force_unlock",e.AddSectionWiki="wikiv2_add_section",e.DiscardSectionWiki="wikiv2_discard_section",e.LoadPageWiki="wikiv2_load_page",e.FocusSectionWiki="wikiv2_focus_section",e.LoadPagesForSidebarWiki="wikiv2_load_pages_for_sidebar",e.LoadPageWithoutSectionWiki="wikiv2_load_page_without_section",e.LoadSectionWiki="wikiv2_load_section",e.SyncJobScheduler="sync_job_scheduler",e.SyncUserPreferencesFromServer="sync_user_preferences_from_server",e.NoOpSyncJob="noop_sync_job",e.ConversationValidation="conversation_validation",e.SyncStateValidation="sync_state_validation",e.MessageSyncJob="message_sync_job",e.RelatedMessageSyncJob="related_message_sync_job",e.StartupSyncJob="startup_sync_job",e.ChatsStartupSyncJob="chats_startup_sync_job",e.ThreadDetailsSyncJob="thread_details_sync_job",e.BatchedThreadDetailsSyncJob="batched_thread_details_sync_job",e.ReplyChainSyncJob="replychain_sync_job",e.AnnotationsFetchJob="annotations_fetch_job",e.SimpleJob="simple_job",e.PoliciesSyncJob="policies_sync_job",e.BuddyListSyncJob="buddylist_sync_job",e.ContactsSyncJob="contacts_sync_job",e.MessageSendJob="message_send_job",e.MessageEditJob="message_edit_job",e.UserPreferencesSyncJob="user_preferences_sync_job",e.PinnedChannelsSyncJob="pinned_channels_sync_job",e.UserInstalledAppsSyncJob="user_installed_apps_sync_job",e.AppDefinitionsSyncJob="app_definitions_sync_job",e.ChatInstalledAppsSyncJob="chat_installed_apps_sync_job",e.ChatInstallAppJob="chat_install_app_job",e.UserInstallAppJob="user_install_app_job",e.PersistencePruningJob="persistence_pruning_job",e.RetentionPruningJob="retention_pruning_job",e.ClearHistoryPruningJob="clearhistory_pruning_job",e.ActivityFeedPruningJob="activity_feed_pruning_job",e.InMemoryCleanupJob="inmemory_cleanup_job",e.DeadConversationPruningJob="dead_conversation_pruning_job",e.CalendarPruningJob="calendar_pruning_job",e.ProfileFetchJob="profile_fetch_job",e.AddMembersToThreadJob="AddMembersToThreadJob",e.InstantScdSearchJob="instant_scd_search_job",e.SMSThreadSearchJob="sms_thread_search_job",e.P2PFilesListFetchJob="documents_p2p_files_list_fetch_job",e.PresenceCreateEndpointJob="unified_presence_t2_create_endpoint_job",e.ConversationFetchJob="conversation_fetch_job",e.ConversationFetchWorkflow="conversation_fetch_workflow",e.ConversationManagerGetConversationsByKeys="conversation_manager_get_conversations_by_keys",e.MessageSyncWorkflow="message_sync_workflow",e.DeltaSyncWorkflow="delta_sync_workflow",e.ConversationSyncWorkflow="conversation_sync_workflow",e.ThreadDetailsWorkflow="thread_details_workflow",e.ReplyChainWorkflow="reply_chain_workflow",e.ExtendHistoryWorkflow="extend_history_workflow",e.RelatedMessageSyncWorkflow="related_message_sync_workflow",e.SimpleWorkflow="simple_workflow",e.FetchNextChatsPageWorkflow="fetch_next_chats_page_workflow",e.PoliciesSyncWorkflow="policies_sync_workflow",e.BuddyListSyncWorkflow="buddylist_sync_workflow",e.PresenceCreateEndpointWorkflow="unified_presence_t2_create_endpoint_workflow",e.ContactsSyncWorkflow="contacts_sync_workflow",e.MessageSendWorkflow="message_send_workflow",e.MessageEditWorkflow="message_edit_workflow",e.UserPreferencesSyncWorkflow="user_preferences_sync_workflow",e.PinnedChannelsSyncWorkflow="pinned_channels_sync_workflow",e.UserInstalledAppsSyncWorkflow="user_installed_apps_sync_workflow",e.BuddyListAddWorkflow="buddylist_add_workflow",e.AppDefinitionsSyncWorkflow="app_definitions_sync_workflow",e.ChatInstalledAppsSyncWorkflow="chat_installed_apps_sync_workflow",e.ChatInstallAppWorkflow="chat_install_app_workflow",e.UserInstallAppWorkflow="user_install_app_workflow",e.PeoplePickerSearchWorkflow="people_picker_search_workflow",e.MaintenanceWorkflow="maintenance_workflow",e.ProfileFetchWorkflow="profile_fetch_workflow",e.CalendarMaintenanceWorkflow="calendar_maintenance_workflow",e.P2PFilesListFetchWorkflow="documents_p2p_files_list_fetch_workflow",e.OnStartupOrIntervalStrategy="on_startup_or_interval_strategy",e.OnLoadMoreStrategy="on_load_more_strategy",e.OnAppStateActiveStrategy="on_app_state_active_strategy",e.OnAppStateInactiveStrategy="on_app_state_inactive_strategy",e.OnForceRunMaintenanceWorkflow="on_force_run_maintenance_workflow",e.OnPrefetchReplyChainsFromDb="on_prefetch_reply_chains_from_db",e.OnPrefetchActivitiesFromDbAndReplyChains="on_prefetch_activities_from_db_and_reply_chains",e.UnsyncedChatMessage="unsynced_chat_message",e.UnsyncedPersonalAtMentionNotification="unsynced_personal_at_mention_notification",e.IndexedDBConnectionClosure="indexed_db_connection_closure",e.CreateTrouterEndpoint="create_trouter_endpoint",e.TrouterClientEvents="trouter_client_events",e.AppDisconnected="app_disconnected",e.ShowMissingMessagesBanner="show_missing_messages_banner",e.NetworkOnline="network_online",e.NetworkOffline="network_offline",e.NetworkPing="network_ping",e.ReplyChainManagerGetReplyChains="reply_chain_manager_get_reply_chains",e.ReplyChainManagerGetReplyChain="reply_chain_manager_get_single_reply_chain",e.ReplyChainManagerGetReplyChainsByKeys="reply_chain_manager_get_reply_chains_by_keys",e.ReplyChainManagerFetchLatestMessages="reply_chain_manager_fetch_latest_messages",e.ReplyChainManagerGetPreviousAndNextMessagesForChat="reply_chain_manager_get_previous_next_messages_for_chat",e.PoliciesManagerSyncPolicies="policies_manager_sync_policies",e.GetTeamsChannelsFromIndexedDB="get_teams_channels_from_indexeddb",e.PutLegacyMessagesResolver="put_legacy_messages_resolver",e.ResolveEditClientLieResolver="resolve_edit_client_lie_resolver",e.OutOfOrderMessages="gap_detection_out_of_order_messages",e.MissingMessages="gap_detection_missing_messages",e.ArrivedAfterOutOfOrderWaitTime="gap_detection_messages_arrived_after_outoforderwaittime",e.MessagesGapAboveThreshold="gap_detection_messages_gap_above_threshold",e.OnAsyncIterableObserverOverflow="on_async_iterable_observer_overflow",e.WorkerHostRegistrarOnConnection="worker_host_registrar_on_connection",e.EcsFetch="ecs_provider_fetch",e.IPCPolicyFetch="policy_service_fetch_ipc",e.NetworkPolicyFetch="policy_service_fetch_network",e.UpToEditBegin="messaging_up_to_edit_message",e.SmsDeliveryReportFailure="sms_delivery_report_failure",e.ReplyChainSummaries="reply_chain_summaries",e.ReplyChainMessages="reply_chain_messages",e.ExtTaskModuleSubmitAction="ext_task_module_submit_action",e.ExtTaskModuleBotPreviewAction="ext_task_module_bot_preview_action",e.ExtTaskModuleAuth="ext_task_module_auth",e.ExtTaskModuleFetch="ext_task_module_fetch",e.ExtTaskModuleUpdateResult="ext_task_module_update_result",e.ExtTaskModuleLaunch="ext_task_module_launch",e.StoTaskModuleDeleteDraft="sto_delete_email",e.FrePublishSyncContactsSettings="fre_publish_sync_contacts_settings",e.FreFetchEphemeralMsaProfile="fre_fetch_ephemeral_profile",e.FreStampProfile="fre_enable_profile_searchability",e.ExtMessageExtensionQueryCommand="ext_me_queryCommand",e.ExtMessageExtensionAuthAndConfig="ext_me_authAndConfig",e.ExtSilentInstallPreConsentedApps="ext_silent_install_preconsented_apps",e.ExtMessageExtensionInstallApp="ext_me_install_app",e.ExtMessageExtensionUninstallApp="ext_me_uninstall_app",e.ExtLoadPinnedMessageExtensions="ext_load_pinned_message_extensions",e.ExtPinOrUnpinMessageExtension="ext_pin_or_unpin_message_extensions",e.ExtGetSettingUrl="ext_get_setting_url",e.ExtMessageExtensionPostInstallGetFlyoutApp="ext_me_post_install_get_flyout_app",e.ExtAdaptiveCardPersonaLoadUser="ext_adaptive_card_persona_load_user",e.ExtAdaptiveCardPersonaSetLoadUsers="ext_adaptive_card_persona_set_load_users",e.ExtAdaptiveCardChoiceSetDynamicQuery="ext_adaptive_card_coice_set_dynamic_query",e.ExtAdaptiveCardDirectorySearchConversation="ext_adaptive_card_directory_search_conversation",e.ExtAdaptiveCardDirectorySearchOrganization="ext_adaptive_card_directory_search_organization",e.ExtBotsInvoke="ext_bots_invoke",e.ExtBotsSignIn="ext_bots_sign_in",e.ExtBotsMessageBack="ext_bots_messageback",e.ExtBotsCardActionChatSendMessage="ext_bots_card_action_chat_send_message",e.ExtBotsCardFetchTaskModule="ext_bots_card_fetch_task_module",e.ExtBotsCardTaskSubmit="ext_bots_card_task_submit",e.ExtBotsTokenExchange="ext_bots_token_exchange",e.ExtBotsCardO365HttpPOST="ext_bots_actionable_card_http_post",e.ExtBotsCardExecute="ext_bots_execute",e.ExtBotsFileUpload="ext_bots_file_upload",e.ExtBotsPinAsTab="ext_bots_pinAsTab",e.ExtBotsCardMessageUpdate="ext_bots_update_mediacard",e.ExtBotsCardCopy="ext_bots_card_copy",e.ExtBotsJITInstall="ext_bots_jit_install",e.ExtBotsCardHeaderInstall="ext_bots_card_header_install",e.ExtBotsAdaptiveCardImageExpand="ext_bots_ac_image_expand",e.ExtTflAdaptiveCardAction="ext_tfl_ac_action",e.ExtAdaptiveCardRender="ext_ac_render",e.ExtAdaptiveCardHtmlTransformationOnUpdate="ext_ac_html_transformation_on_update",e.ExtBotsSsoAadAuthTokenRequest="ext_bots_sso_aad_auth_token_request",e.ExtBotsSsoAadAuthTokenInvoke="ext_bots_sso_aad_auth_token_invoke",e.ExtBotsSsoSignInAuthTokenRequest="ext_bots_sso_sign_in_auth_token_request",e.ExtBotsSsoSignInAuthTokenInvoke="ext_bots_sso_sign_in_auth_token_invoke",e.ExtBotsSsoMessageExtensionTokenRequest="ext_bots_sso_message_extension_token_request",e.ExtInvokeTabFetch="ext_invoke_tab_fetch",e.ExtInvokeTabSubmit="ext_invoke_tab_submit",e.ExtAdaptiveCardTabAuth="ext_act_authAndConfig",e.PlatformTabLoading="platform_tab_loading",e.PlatformTabFrameLoading="platform_tab_frame_loading",e.PlatformTabWebviewCreation="platform_tab_webview_creation",e.WebsiteTabWebviewCreation="website_tab_webview_creation",e.PlatformTabCreation="platform_tab_creation",e.PlatformTabUpdate="platform_tab_update",e.PlatformTabRename="platform_tab_rename",e.PlatformTabRemove="platform_tab_remove",e.PlatformTabForceDelete="platform_tab_force_delete",e.PlatformTabCreationLoading="platform_tab_creation_loading",e.PlatformTabUpdateLoading="platform_tab_update_loading",e.PlatformTabRenameLoading="platform_tab_rename_loading",e.PlatformTabRemoveLoading="platform_tab_remove_loading",e.PlatformPersonalAllTabLoading="platform_personal_all_tab_loading",e.PlatformPersonalAboutTabLoading="platform_personal_about_tab_loading",e.PlatformPersonalRecentTabLoading="platform_personal_recent_tab_loading",e.PlatformTabStartEntityConversation="platform_tab_start_entity_conversation",e.PlatformTabStartSubEntityConversation="platform_tab_start_sub_entity_conversation",e.PlatformTabLoadingInMeeting="platform_tab_loading_in_meeting",e.PlatformTabSdkAuthenticationAuthenticate="platform_tab_sdk_authentication_authenticate",e.PlatformTabSdkGetAuthenticationTokenForAnonymousUser="platform_tab_sdk_get_authentication_token_for_guest_user",e.PlatformTabSdkGetAuthToken="platform_tab_sdk_get_auth_token",e.PlatformTabSdkGetContext="platform_tab_sdk_get_context",e.PlatformTabSdkGetIncomingAudio="platform_tab_sdk_get_incoming_audio",e.PlatformTabSdkGetLiveStreamState="platform_tab_sdk_get_live_stream_state",e.PlatformTabSdkGetMeetingDetails="platform_tab_sdk_get_meeting_details",e.PlatformTabSdkGetUser="platform_tab_sdk_get_user",e.PlatformTabSdkPreFetchAuthToken="platform_tab_sdk_pre_fetch_auth_token",e.PlatformTabSdkRemoteCameraCapableParticipantsChanged="platform_tab_sdk_remote_camera_capable_participants_changed",e.PlatformTabSdkRemoteCameraDeviceStateChanged="platform_tab_sdk_remote_camera_device_state_changed",e.PlatformTabSdkRemoteCameraGetCapableParticipants="platform_tab_sdk_remote_camera_get_capable_participants",e.PlatformTabSdkRemoteCameraHandlerError="platform_tab_sdk_remote_camera_handler_error",e.PlatformTabSdkRemoteCameraRequestControl="platform_tab_sdk_remote_camera_request_control",e.PlatformTabSdkRemoteCameraSendControlCommand="platform_tab_sdk_remote_camera_send_control_command",e.PlatformTabSdkRemoteCameraSessionStatusChanged="platform_tab_sdk_remote_camera_session_status_changed",e.PlatformTabSdkRemoteCameraTerminateSession="platform_tab_sdk_remote_camera_terminate_session",e.PlatformTabSdkRequestStartLiveStreaming="platform_tab_sdk_request_start_live_streaming",e.PlatformTabSdkRequestStopLiveStreaming="platform_tab_sdk_request_stop_live_streaming",e.PlatformTabSdkToggleIncomingAudio="platform_tab_sdk_toggle_incoming_audio",e.ExtAppDefinitionForMECard="ext_app_definition_for_me_card",e.ExtAppDefinitionsForBotCard="ext_app_definitions_for_bot_card",e.ExtBotsCardCacheOperationOnActionExecute="ext_bots_card_cache_operation_on_action_execute",e.ExtBotsCardCacheOperationV2OnActionExecute="ext_bots_card_cache_operation_v2_on_action_execute",e.ExtInstalledApp="ext_installed_app",e.ExtInstalledApps="ext_installed_apps",e.ExtInstalledAppsV2="ext_installed_apps_V2",e.ExtInstalledAppsUpdateEventSuccess="ext_installed_apps_update_event_success",e.ExtInstalledAppsUpdateEventFailure="ext_installed_apps_update_event_failure",e.ExtInstalledAppsUpdateEventV2Success="ext_installed_apps_update_event_V2_success",e.ExtInstalledAppsUpdateEventV2Failure="ext_installed_apps_update_event_V2_failure",e.ExtDynamicCommandsUpdateEventSuccess="ext_dynamic_commands_update_event_success",e.ExtDynamicCommandsUpdateEventFailure="ext_dynamic_commands_update_event_failure",e.ExtAppsUsageUpdateEventSuccess="ext_apps_usage_update_event_success",e.ExtAppsUsageUpdateEventFailure="ext_apps_usage_update_event_failure",e.ExtRecordAppActionUsage="ext_record_app_action_usage",e.ExtRecordAppUsage="ext_record_app_usage",e.ExtAppsUsageGetAppsUsage="ext_get_apps_usage",e.ExtContentBubble="ext_content_bubble",e.ExtGetSimpleAppModel="ext_get_simple_app_model",e.ExtAppsInstalledByCurrentUserEvent="ext_apps_installed_by_current_user_event",e.RenderOutlookPreview="render_outlook_preview",e.RenderShareForm="render_share_form",e.ShareFormErrorBoundary="share_form_error_boundary",e.ShareFormFatalError="share_form_fatal_error",e.STTOutlookAddInNavigation="stt_outlook_add_in_navigation",e.STTOutlookAddInStartup="stt_outlook_add_in_startup",e.STTOutlookAuthStrap="stt_outlook_auth_strap",e.STTOutlookPopulateUsage="stt_outlook_populate_usage",e.STTRecentChannels="stt_recent_channels",e.STTRecentChats="stt_recent_chats",e.STTRecentRecipients="stt_recent_recipients",e.STTOutlookZeroStateSuggestions="stt_outlook_zero_state_suggestions",e.SubmitShareForm="submit_share_form",e.GetOngoingScenario="get_ongoing_scenario",e.AdjacentRoomBanner="adjacent_room_banner",e.ChatPaneFromCallRender="chat_pane_from_call_render",e.UbarLoad="ubar_load",e.RosterPanelFullRender2="roster_panel_full_render2",e.RosterUpdateCount="roster_update_count",e.RosterSubPanelFullRender="roster_subpanel_full_render",e.RosterSubPanelFullRender2="roster_subpanel_full_render2",e.RosterParticipantsSearchAction="roster_participants_search",e.CreateMeetingNotes="create_meeting_notes",e.RemoteMuteRender="server_mute_latency",e.UnmutedWithPushToTalk="push_to_talk_scenario",e.ChangeRoleRender="change_role_latency",e.RemoveParticipantRender="remove_participant_latency",e.ReportMisrecognizedParticipantRender="report_misrecognized_participant_latency",e.NudgeParticipantRender="nudge_participant_latency",e.ParticipantVbssLatency="participant_vbss_latency",e.LowerOtherParticipantsHandLatency="lower_other_participants_hand_latency",e.CallMerge="call_merge",e.OpenShareInviteDialog="openShareInviteDialog",e.VideoStreamStopped="video_stream_stopped",e.VideoPreview="video_preview",e.CallTitle="call_title",e.CallingRetryScreen="calling_retry_screen",e.ReactionsOverlayScreen="meeting_reactions_overlay",e.SendMeetingReaction="meeting_reactions_send_reaction",e.CallHealthCategoriesQuery="call_health_categories_query",e.TenantBackgroundImage="tenant_background_image",e.MeetingChatButton="meeting_chat_button",e.UserLicense="user_license",e.GetUpgradePolicyFromUserProfileOrDefault="load_loggedin_user_policy_from_userprofile_or_default",e.CallingCalendarServiceAdapter="calling_calendar_service_adapter",e.FetchVoicemails="fetch_voicemails",e.GetSuggestedAddresses="get_suggested_addresses",e.CallHistoryFilterSelected="call_history_filter_selected",e.CallHistoryFetch="call_history_fetch",e.FetchContactList="fetch_contact_list",e.FetchSpeedDialContactInfo="fetch_speed_dial_contact_info",e.StandupCallingAppJob="standup_calling_app_job",e.StartCall="start_call",e.CallableChannelHistoryFilterSelected="callable_channel_history_filter_selected",e.CallableChannelHistoryFetch="callable_channel_history_fetch",e.CallableChannelStartCall="callable_channel_start_call",e.CallableChannelToggleAgentOptinStatus="callable_channel_toggle_agent_optin_status",e.TranscriptContentFetch="transcript_content_fetch",e.ExtBotProfilePictureUrl="ext_bot_profile_picture_url",e.ExtBotChatFileClipAppQuery="ext_bot_chat_file_clip_app_query",e.ExtBotFileGetDownloadUrl="ext_bot_file_get_download_url",e.ExtLaunchAppStore="ext_launch_app_store",e.ExtCardMentionsInvoke="ext_card_mentions_invoke",e.ExtCardMentionsTaskModuleCardInsert="ext_card_mentions_task_module_card_insert",e.MsaUserProfilePictureUrl="msa_user_profile_picture_url",e.AvatarStatus="avatar_status",e.MsaGroupProfilePictureUrl="msa_group_profile_picture_url",e.EntUserGroupProfilePictureUrl="ent_user_group_profile_picture_url",e.VirtualListInitialStableView="vl_initial_stable_view",e.VirtualListLoadMore="vl_load_more",e.VirtualListNewRenderBounds="vl_new_render_bounds",e.VirtualListScrollToStart="vl_scroll_to_start",e.InstallApp="ext_install_app",e.InstallAppMessageExtensionJit="ext_install_app_message_ext_jit",e.InstallAppResultCacheUpdate="ext_install_app_result_cache_update",e.AppProfileCardGetAppDefinition="ext_app_profile_card_get_app_definition",e.AppProfileCardSendQuickMessage="ext_app_profile_card_send_quick_message",e.AppProfileCardStartAudioCall="ext_app_profile_card_get_start_audio_call",e.AppProfileCardStartChat="ext_app_profile_card_get_start_chat",e.AppProfileCardStartVideoCall="ext_app_profile_card_get_start_video_call",e.UseDisabledByUserChecker="ext_app_profile_card_use_disabled_by_user_checker",e.UseOneOnOneAndDisabledByTenantChecker="ext_app_profile_card_one_on_one_and_disabled_by_tenant_checker",e.LaunchLmsCourseTeam="lms_launch_course_team",e.LaunchLmsCourseCalendar="lms_launch_course_calendar",e.GetTeamsForCourse="lms_get_teams_for_course",e.LmsIntegrationErrorBoundary="lms_integration_error_boundary",e.LmsLaunchSchedulingFormCreate="lms_integration_launch_scheduling_form_create",e.AddEntireClass="lms_integration_course_calendar_add_entire_class",e.AppBasedLinkInstall="app_based_link_install",e.AppBasedLinkAuthOrConfig="ext_do_auth_or_config_appbasedlink",e.AppBasedLinkAadAuth="ext_do_aad_auth_appbasedlink",e.GetAppPreviewResult="ext_get_app_preview_result_appbasedlink",e.GetDefaultUrlPreview="ext_get_default_url_preview_appbasedlink",e.RemoveUrlPreview="ext_remove_url_preview",e.FetchDynamicCommands="ext_fetch_dynamic_commands",e.FluidLoadCompose="fluid_load_compose",e.FluidLoadMessage="fluid_load_message",e.FluidLoadPaste="fluid_load_paste",e.OnBehalfOfUserAttribution="on_behalf_of_user_attribution",e.Unified3SSearch="unified_3s_search",e.UnifiedChannelSearch="channel_search",e.UnifiedChatsByTitleSearch="chats_by_title_search",e.UnifiedChatsByMembersSearch="chats_by_members_search",e.UnifiedPeopleSearch="people_search",e.BroadcastAttendeeLoadSdnPluginScript="broadcast_attendee_load_sdn_plugin_script",e.BroadcastPlaybackWatchdog="broadcast_playback_watchdog",e.BroadcastSubscription="broadcast_subscription",e.BroadcastCaptionsDiagnostic="broadcast_captions_diagnostic",e.QnaLatency="qna_latency",e.QnaFrameLoad="qna_frame_load",e.BreakoutRoomMenuButton="breakout_room_menu_button",e.BreakoutRoomsOpenAssignmentPanel="breakout_rooms_open_assignment_panel",e.BreakoutRoomsCloseAction="breakout_rooms_close_room_action",e.BreakoutRoomsMoveFromClosedToOpenedRoom="breakout_rooms_move_participant_from_closed_to_opened_room",e.BreakoutRoomsMoveFromClosedToClosedRoom="breakout_rooms_move_participant_from_closed_to_closed_room",e.BreakoutRoomsMoveFromOpenToOpenRoom="breakout_rooms_move_participant_from_open_to_open_room",e.BreakoutRoomsMoveFromOpenToMainMeetingRoom="breakout_rooms_move_participant_from_open_to_main_meeting_room",e.BreakoutRoomTakeControlAction="breakout_rooms_take_control",e.BreakoutRoomsBulkList="breakout_rooms_bulk_list",e.TogglePinParticipant="toggle_pin_participant",e.AddAudienceDataChannel="add_audience_data_channel",e.AudienceScenesDialogRender="audience_scenes_dialog_render",e.ExtensionOpen="extension_open",e.ExtensionClose="extension_close",e.TeamSettingsTabLoad="teamdashboard_settingstab_load",e.RenewTeam="renew_team",e.ResetTeamJoinCode="reset_team_join_code",e.BiometricVoiceEnrollment="voice_enrollment",e.GetSurveyDefinition="get_survey_definition",e.SubmitSurvey="submit_survey",e.GetInstantAnswers="get_instant_answers",e.SendInstantAnswersTelemetry="send_instant_answers_telemetry",e.GetOfficeStoreAppDetails="app_details_get_office_store_app_details",e.CalendarLoad="calendar_load",e.TeamsCalV2="teams_cal_v2",e.TeamsChannelCalV2="teams_channel_cal_v2",e.CalSchedulingFormLoad="cal_scheduling_form_load",e.CalSchedulingFormCreateMode="cal_scheduling_form_create_mode",e.CalSchedulingFormViewOrEditMode="cal_scheduling_form_view_or_edit_mode",e.CalEventsPrefetch="cal_events_prefetch",e.CalEventCardClick="cal_event_card_click",e.CalEventCardPeek="cal_event_card_peek",e.CalEventCardPeekExpand="cal_event_card_peek_expand",e.CalNewEventFromTopBar="cal_new_event_from_top_bar",e.CalNewEventUsingTemplate="cal_new_event_from_top_bar",e.CalNewEvent="cal_new_event",e.CalNavNext="cal_nav_next",e.CalNavPrev="cal_nav_prev",e.CalSwitchView="cal_switch_view",e.CalNavToday="cal_nav_today",e.CalNavDatepicker="cal_nav_datepicker",e.CalClickGridNewEvent="cal_click_grid_new_event",e.CalMouseDragGridNewEvent="cal_mouse_drag_grid_new_event",e.CalKeyboardEnterGridNewEvent="cal_keyboard_enter_grid_new_event",e.StartScenarioStepSuffix="_start",e.CalMeetingRsvp="cal_meeting_rsvp",e.CalMeetingCopyLink="cal_meeting_copy_link",e.CalChatWithParticipants="cal_chat_with_participants",e.CalJoinOnlineMeeting="cal_join_online_meeting",e.CalUpdateMeeting="cal_update_meeting",e.CalViewMeetingDetails="cal_view_meeting_details",e.CalGetCalendarEvents="cal_get_calendar_events",e.CalGetCalendarEventByUid="cal_get_calendar_event_by_uid",e.CalGetInstalledAppsForContainerAppId="cal_get_installed_apps_for_container_app_id",e.CalEventDelete="cal_event_delete",e.CalEventCancel="cal_event_cancel",e.CalEventForward="cal_event_forward",e.CalTeamEventCancel="cal_team_event_cancel",e.CalTeamEventForward="cal_team_event_forward",e.CalActiveCallUpdate="cal_active_call_update",e.CalAgendaViewLoad="cal_agenda_view_load",e.CalAddToMyCalendar="cal_add_to_my_calendar",e.TeamsCalV2TryAgain="teams_cal_v2_try_again",e.CalFetchUserMailboxSettings="cal_fetch_user_mailbox_settings",e.CalUninstallHostedApp="cal_uninstall_hosted_app",e.CalGetMasterCategories="cal_get_master_categories",e.CalGridGetMasterCategories="cal_grid_get_master_categories",e.ChannelCalV2="channel_cal_v2",e.ChannelCalV2TryAgain="channel_cal_v2_try_again",e.ChannelCalGetCalendarEvents="channel_cal_get_calendar_events",e.PersistDataInIndexdb="persist_data_in_indexed_db",e.CalCreateApolloClient="cal_create_apollo_client",e.CalCreateUpdateTeamEvent="cal_create_update_team_event",e.CalCreateUpdateUserEvent="cal_create_update_user_event",e.CalCreateUserEvent="cal_create_user_event";e.CalUpdateUserEvent="cal_update_user_event",e.CalPatchUserEvent="cal_patch_user_event",e.CalCreateTeamEvent="cal_create_team_event",e.CalUpdateTeamEvent="cal_update_team_event",e.CalGetChannelEvent="cal_get_channel_event",e.CalGetPrivateEvent="cal_get_private_event",e.CalGetChannelEventFromPersonalMailbox="cal_get_channel_event_from_personal_mailbox",e.CalApolloCacheReset="cal_apollo_cache_reset",e.CalBroadcastCreateLiveEvent="cal_broadcast_create_live_event",e.CalBroadcastUpdateLiveEvent="cal_broadcast_update_live_event",e.CalBroadcastCancelLiveEvent="cal_broadcast_cancel_live_event",e.CalBroadcastGetLiveEvent="cal_broadcast_get_live_event",e.CalSchedulingFormTryAgainCreateMode="cal_scheduling_form_try_again_create_mode",e.CalSchedulingFormTryAgainViewOrEditMode="cal_scheduling_form_try_again_view_or_edit_mode",e.CalSchedulingFormReactComponentError="cal_scheduling_form_react_component_error",e.CalGetSuggestedTime="cal_get_suggested_time",e.CalCreateSchedulingServiceEvent="cal_create_scheduling_service_event",e.CalUpdateSchedulingServiceEvent="cal_update_scheduling_service_event",e.CalDeleteSchedulingServiceEvent="cal_delete_scheduling_service_event",e.CalDownloadClassicalAttachment="cal_download_classical_attachment",e.CalDownloadCloudAttachment="cal_download_cloud_attachment",e.CalOpenOnlineCloudAttachment="cal_open_online_cloud_attachment",e.CalGetUserTimeZone="cal_get_user_time_zone",e.CalGetRoomlist="cal_get_roomlist",e.CalGetRooms="cal_get_rooms",e.CalV2FirstLoadFailure="cal_v2_first_load_failure",e.CalLiveEventDetails="cal_live_event_details",e.CalLiveEventDetailsSubscriptionStart="cal_live_event_details_subscription_start",e.CalUserMailboxSettingsUndefined="cal_user_mailbox_settings_undefined",e.CalUpdateAttendeeEvent="cal_update_attendee_event",e.CalValidateMeetingObject="cal_validate_meeting_object",e.CalShareLink="cal_share_link",e.CalShareDialogOpenGoogleCalendar="cal_share_dialog_open_google_calendar",e.FreemiumCalV2="freemium_cal_v2",e.FreemiumCalSyncCalendarEvents="freemium_cal_sync_calendar_events",e.FreemiumCalGetCalendarEvents="freemium_cal_get_calendar_events",e.FreemiumCalGetChatThreads="freemium_cal_get_chat_threads",e.FreemiumCalCreateSchedulingServiceEvent="freemium_cal_create_scheduling_service_event",e.FreemiumCalUpdateSchedulingServiceEvent="freemium_cal_update_scheduling_service_event",e.FreemiumCalDeleteSchedulingServiceEvent="freemium_cal_delete_scheduling_service_event",e.QueryMessageDraftsIndex="query_message_drafts_index",e.QueryMessageDraft="query_message_draft",e.SaveMessageDraft="save_message_draft",e.DeleteMessageDraft="delete_message_draft",e.AddDraftImageToCache="add_draft_image_to_cache",e.RemoveDraftImageFromCache="remove_draft_image_from_cache",e.GetCachedImageBlobUrl="get_cached_image_blob_url",e.SerializeCachedImage="serialize_cached_image",e.CalGetCallRecordings="cal_get_call_recordings",e.CalGetLatestRecording="cal_get_latest_recording",e.CalIsMeetingNotesLinkAvailable="cal_is_meeting_notes_link_available",e.CalHasAttendanceReport="cal_has_attendance_report",e.CalDownloadAttendanceReport="cal_download_attendance_report",e.CalCreateCollaborativeFluid="cal_create_collaborative_fluid",e.CalLoadCollaborativeFluid="cal_load_collaborative_fluid",e.AttendanceReportDownload="attendance_report_download",e.AtMentions="people_at_mentions",e.EmptyAtMentions="people_empty_at_mentions",e.STTOutlookAtMention="stt_outlook_at_mention",e.STTOutlookMWAtMention="stt_outlook_mw_at_mention",e.STTAtMention="stt_at_mention",e.AddConnectedAccount="add_connected_account",e.RemoveConnectedAccount="remove_connected_account",e.AddThirdPartyCalendar="add_third_party_calendar",e.RemoveThirdPartyCalendar="remove_third_party_calendar",e.CallsAltScenario="calls_app_launch_time",e.LiveStateServiceOpen="live_state_service_open",e.LiveStateServiceEndpoint="live_state_service_endpoint",e.LiveStateServiceClose="live_state_service_close",e.RemoveMemberFailure="remove_member_failure_due_to_chat_permissions",e.LeaveChatFailure="leave_chat_failure_due_to_chat_permissions",e.ToggleAutoAdjustFilter="toggle_auto_adjust_filter",e.LinkedInRender="linkedin_render",e.LpcGetPersonaInfo="lpc_persona_data_callback",e.LpcGetPersonaInfoSC="lpc_persona_data_callback_sc",e.LpcGetHeaderInfo="lpc_header_info_data_callback",e.LpcGetHeaderInfoSC="lpc_header_info_data_callback_sc",e.LpcGetHeaderActionsPolicy="lpc_header_actions_data_callback",e.LpcGetRichPresence="lpc_rich_presence_data_callback",e.LpcGetImageUri="lpc_image_data_callback",e.LpcGetImageUriSC="lpc_image_data_callback_sc",e.ExtScenePickerFetchApps="ext_scene_picker_fetch_apps",e.ExtMeetingAppsFlyoutFetchGridApps="ext_meeting_apps_flyout_fetch_grid_apps",e.ExtMeetingAppsFlyoutFetchAllApps="ext_meeting_apps_flyout_fetch_all_apps",e.ExtMeetingFlyoutPreConsentedApps="ext_meeting_flyout_silent_install_preconsented_apps",e.ExtVideoEffectsClear="ext_video_effects_clear",e.FreemiumGetTenantAdmins="freemium_get_tenant_admins",e.FreemiumGetJoinTenantUrl="freemium_get_join_tenant_url",e.IsTenantAadDomain="is_tenant_aad_domain",e.LoadRoomAccountName="load_room_account_name",e.AgendaPageJoin="agenda_page_join",e.AgendaPageMeetNow="agenda_page_meet_now",e.AgendaPageCalendarLoad="agenda_page_calendar_load",e.AgendaPageCalendarRefresh="agenda_page_calendar_refresh",e.SwStateChange="sw_state_change",e.SwCleanupSwCache="sw_cleanup_cache",e.SwFetchEvent="sw_fetch_event",e.SwOfflineAssetFetchEvent="sw_offline_asset_fetch_event",e.SwStateInfo="sw_state_info",e.FloatingShareTrayRender="floating_sharetray_render",e.ShareTrayFetchPpt="share_tray_fetch_ppt",e.ShareTrayPreviewsLatency="share_tray_previews_latency",e.ShareTrayRender="share_tray_render",e.ShareTrayInvisionLatency="share_tray_invision_latency",e.ShareTrayWhiteboardLatency="share_tray_whiteboard_latency",e.ShareTraySystemAudioCheck="share_tray_system_audio_check",e.FeedsGetFeedsFromReplyChain="feeds_get_feeds_from_reply_chain",e.FeedListRendered="feeds_focused_load",e.FeedsNewActivityFromLongPollCdl="feeds_new_activity_from_long_poll_cdl",e.FeedListLoadNext="feeds_focused_load_more",e.FeedsStoreStartup="feeds_store_startup",e.FeedsPrivateStreamIdLoad="feeds_private_stream_id_load",e.ActivitySwitch="activity_switch",e.FeedsNewActivityFromLongPoll="feeds_new_activity_from_long_poll",e.AppInstallationDialogGetAppDefinition="app_installation_dialog_getappdefinition",e.AppIntallationDialogInstallApp="app_installation_dialog_installapp",e.VideoEffectsCustomizationPanel="vide_effects_customization_panel",e.ChatRosterRendered="chat_roster_rendered_mw",e.FreemiumInvitationBatchInvite="freemium_invitation_batch_invite",e.PlatformFlyoutGetInstalledApps="platform_flyout_get_installed_apps",e.PlatformAppsFlyoutFetchGridApps="platform_apps_flyout_grid_apps",e.PlatformAppFlyoutJITInstallApp="platform_app_flyout_jit_install_app",e.UnblockContact="unblock_contact",e.PresencePublishPresenceScenario="unified_presence_t2_publish_presence",e.PresencePostHeartbeatScenario="unified_presence_t2_post_heartbeat",e.PresencePostHeartbeatJob="unified_presence_t2_post_heartbeat_job",e.PresencePostHeartbeatWorkflow="unified_presence_t2_post_heartbeat_workflow",e.CalendarEventsSyncWorflow="calendar_events_sync_workflow",e.CalendarCreateUpdateEventWorkflow="calendar_create_update_event_workflow",e.CalendarEventCancelWorkflow="calendar_event_cancel_workflow",e.TeamCalendarEventCreateUpdateWorkflow="team_calendar_event_create_update_workflow",e.CalendarTeamEventCancelWorkflow="calendar_team_cancel_workflow",e.CalendarEventRsvpWorkflow="calendar_event_rsvp_workflow",e.CalendarEventDeleteWorkflow="calendar_event_delete_workflow",e.CalendarCreateUpdateEventJob="calendar_create_update_event_job",e.CalendarUpdateAttendeeEventJob="calendar_update_attendee_event_job",e.CalendarUpdateAttendeeEventWorkflow="calendar_update_attendee_event_workflow",e.CalendarEventCancelJob="calendar_event_cancel_job",e.TeamCalendarEventCreateUpdateJob="team_calendar_event_create_update_job",e.CalendarTeamEventCancelJob="calendar_team_cancel_job",e.CalendarSyncJob="calendar_sync_job",e.CalendarEventRsvpJob="calendar_event_rsvp_job",e.CalendarEventDeleteJob="calendar_event_delete_job",e.FileGetP2PFilesList="documents_get_p2p_files_list",e.UserInstalledAppsManagerInstallApp="user_installed_apps_manager_install_app",e.ChatInstalledAppsManagerInstallApp="chat_installed_apps_manager_install_app",e.AppsPlatformWorkerResolverInstallApp="apps_platform_worker_resolver_install_app",e.CalGetChannelEventByUid="cal_get_channel_event_by_uid",e.PresenceSyncPresenceScenario="unified_presence_t2_sync_presence",e.GetMsaContactsAuthToken="get_msa_contacts_auth_token",e.GetMsaContacts="get_msa_contacts",e.ExtVideoEffectsUseSelectedVideoEffects="ext_video_effects_use_selected_video_effects",e.ExtContentBubbleInChannelMeeting="ext_content_bubble_in_channel_meeting",e.ShareContentCamera="share_content_camera",e.RealTimeMessagingNotifications="real_time_messaging_notifications",e.RealTimeMessageLatency="real_time_message_latency",e.AdaptiveCardsV2ManagerGetCards="adaptive_cards_v2_manager_get_cards",e.AdaptiveCardsV2ManagerGetMultipleCards="adaptive_cards_v2_manager_get_multiple_cards",e.AdaptiveCardsV2ManagerPutCard="adaptive_cards_v2_manager_put_card",e.AdaptiveCardsV2ManagerPopulateUserSpecificContent="adaptive_cards_v2_manager_populate_userSpecific_content",e.AdaptiveCardsV2ManagerDeleteCard="adaptive_cards_v2_manager_delete_card",e.LpcInitialization="lpc_initialization",e.FilesAppSwitch="documents_files_app_switch",e.ClientStart="client_start",e.RefreshSiteUrlPersonal="documents_refresh_site_url_personal_ns",e.CallingCustomVideoBackgroundPanelApplyEffects="calling_custom_video_background_panel_apply_effects",e.CallingVideoEffectsPreviewOnToggleVideo="calling_video_effects_preview_on_toggle_video",e.AppDefinitionsManagerGetAppDefinitions="app_definitions_manager_get_app_definitions",e.AppDefinitionsManagerSyncAppDefinitions="app_definitions_manager_sync_app_definitions",e.ResolveConversation="resolve_conversation",e.UserInstalledAppsManagerGetInstalledApps="user_installed_apps_manager_get_installed_apps",e.UserInstalledAppsManagerSyncInstalledApps="user_installed_apps_manager_sync_installed_apps",e.UserInstalledAppsManagerGetPinnedApps="user_installed_apps_manager_get_pinned_apps",e.ChatInstalledAppsManagerGetInstalledApps="chat_installed_apps_manager_get_installed_apps",e.ChatInstalledAppsManagerSyncInstalledApps="chat_installed_apps_manager_sync_installed_apps",e.InsecureFileChiclet="documents_insecure_file_chiclet",e.BuildRingDiscrepancy="build_ring_discrepancy",e.AppsPlatformWorkerResolverAppDefinitions="apps_platform_worker_resolver_app_definitions",e.AppsPlatformWorkerResolverAppDefinition="apps_platform_worker_resolver_app_definition",e.AppsPlatformWorkerResolverInstalledApps="apps_platform_worker_resolver_installed_apps",e.AppsPlatformWorkerResolverInstalledAppsV2="apps_platform_worker_resolver_installed_apps_v2",e.AppsPlatformWorkerResolverInstalledApp="apps_platform_worker_resolver_installed_app",e.AppsPlatformWorkerResolverInstalledChatAppsWithPreCheck="apps_platform_worker_resolver_installed_chat_apps_with_pre_check",e.ExtContentBubbleGetUserAttribution="ext_content_bubble_get_user_attribution",e.GetUserInfo="use_user_container_get_user_info",e.BreakoutRoomsLiveUpdate="breakout_rooms_live_update",e.BreakoutRoomPreMeetingAssignmentTypeDialog="breakout_rooms_assignment_type_dialog",e.BreakoutRoomsTabInCalendar="breakout_rooms_tab_in_calendar",e.BreakoutRoomsAppInitialization="breakout_rooms_app_initialization",e.BreakoutRoomsMeetingOptions="breakout_rooms_meeting_options",e.CustomAppPolicySyncJob="custom_app_policy_sync_job",e.CustomAppPolicySyncWorkflow="custom_app_policy_sync_workflow",e.AppPolicyManagerCustomAppPolicy="app_policy_manager_custom_app_policy",e.AppsPlatformWorkerResolverCustomAppPolicy="apps_platform_worker_resolver_custom_app_policy",e.GetPinnedChannels="get_pinned_channels",e.PinChannel="pin_channel",e.UnPinChannel="unpin_channel",e.ReorderPinnedChannels="reorder_pinned_channels",e.RemoveInactivePinnedChannels="remove_inactive_pinned_channels",e.MsaEditNameMutation="msa_edit_name_mutation",e.ExtRecordAppSceneUsage="ext_record_app_scene_usage",e.ExtRecordAppImpression="ext_record_app_impression",e.ExtInstallSceneApp="ext_install_scene_app",e.FRELogOutError="fre_auth_signout_failure",e.FREFetchProfileError="fetch_ephemeral_profile_failure",e.GetCallingConversation="get_calling_conversation",e.AuthLaunch="auth_launch",e.TFLConsentLaunch="consent_launch",e.RedeemInviteLink="redeem-invite-link",e.ClaimInviteLink="claim-invite-link",e.CreateOneOnOne2WaySms="create-one-on-one-2-way-sms",e.FlyoutLaunch="flyout_launch",e.SearchPhone2waySms="search_phone_2way_sms",e.DefaultCommand="default_command",e.ChatGetInviteLink="chat_get_invite_link",e.ChatCreateInviteLink="chat_create_invite_link",e.GroupInviteOffNetwork="group_invite_OffNetwork",e.VideoAppSdkNotifyError="video_app_sdk_notify_error",e.SCISFilesRecommendations="scis_files_recommendations",e.UrlPreviewPinUrlAsTab="url_preview_pin_url_as_tab",e.NavigationCommand="navigation_command",e.ChatPopOut="chat_pop_out",e.OamApi="oam_api",e.GetLokiConfiguration="get_loki_configuration",e.MeetingDetailsFluidLoad="meeting_details_fluid_load",e.MeetingDetailsFluidCreate="meeting_details_fluid_create",e.MeetingDetailsFluidReEnable="meeting_details_fluid_re_enable",e.MeetingFluidNotePanelClose="meeting_fluid_note_panel_close",e.CallingCalendarProvider="calling_calendar_provider",e.MeetAppScheduleMeetingCreateSSEvent="meet_app_schedule_meeting_create_ss_event",e.MeetAppScheduleMeetingCreateCalendarEvent="meet_app_schedule_meeting_create_calendar_event",e.ChangeParticipantMeetingRole="change_participant_meeting_role",e.GetExchangeMeetingInfo="get_exchange_meeting_info",e.GetMeetingInfo="get_meeting_info",e.ModernStageLatency="modern_stage_latency",e.ModernStageSubstagesLatency="modern_stage_substages_latency",e.JoinMeetingFromToast="join_meeting_from_toast",e.MeetingOptionsStart="meeting_options_start",e.MeetingOptionsGet="meeting_options_get",e.MeetingOptionsCore="meeting_options_core",e.MeetingOptionsChanged="meeting_options_changed",e.MeetingOptionsCreateGet="meeting_options_create_get",e.MeetingOptionsSet="meeting_options_set",e.AddParticipant="add_participant",e.CallingCallDisconnected="calling_call_disconnected",e.CreateMeetup="create_meetup",e.JoinOrCreateMeetupFromLink="join_or_create_meetup_from_link",e.JoinScheduledMeetup="join_scheduled_meetup",e.MediaConnected="media_connected",e.CallingLobbyAdmit="calling_lobby_admit",e.CallingLobbyDeny="calling_lobby_deny",e.CallingServiceInit="calling_service_init",e.BreakoutRoomsManagerRole="breakout_rooms_manager_role",e.BreakoutRoomButton="breakout_room_button",e.BreakoutRoomsOpenAllAction="breakout_rooms_open_all_action",e.BreakoutRoomsOpenRightRail="breakout_rooms_open_right_rail",e.BreakoutRoomsOpenRoomAction="breakout_rooms_open_room_action",e.BreakoutRoomsGoBackToMainMeeting="breakout_rooms_go_back_to_main_meeting",e.BreakoutRoomsGoToAssignedBreakoutRoomAction="breakout_rooms_go_to_assigned_breakout_room_action",e.BreakoutRoomsOrganizerMoveAction="breakout_rooms_organizer_move_action",e.BreakoutRoomsParticipantMergeOperation="breakout_rooms_participant_merge_operation",e.BreakoutRoomCreateDialog="breakout_room_create_dialog",e.BreakoutRoomsCloseAllAction="breakout_rooms_close_all_action",e.BreakoutRoomsCloseRoomAction="breakout_rooms_close_room_action",e.BreakoutRoomsSettings="breakout_rooms_settings",e.BreakoutRoomsSettingsAction="breakout_rooms_settings_action",e.BreakoutRoomsLoadSettings="breakout_rooms_load_settings",e.BreakoutRoomsSaveSettings="breakout_rooms_save_settings",e.BreakoutRoomsAddRoomAction="breakout_rooms_add_room_action",e.BreakoutRoomsDeleteRoomAction="breakout_rooms_delete_room_action",e.BreakoutRoomsRenameRoomAction="breakout_rooms_rename_room_action",e.BreakoutRoomsJoinRoomAction="breakout_rooms_join_room_action",e.BreakoutRoomParticipantsMove="breakout_room_participants_move",e.BreakoutRoomAnnouncement="breakout_room_announcement",e.BreakoutRoomAnnouncementNotification="breakout_room_announcement_notification",e.BreakoutRoomAnnouncementCoordinates="breakout_room_announcement_coordinates",e.BreakoutRoomsAskToJoin="breakout_rooms_ask_to_join",e.BreakoutRoomsBulkMoveAction="breakout_rooms_bulk_move_action",e.BreakoutRoomsSubscribeOnParticipants="breakout_rooms_subscribe_on_participants",e.BreakoutRoomsRetentionSync="breakout_rooms_retention_sync",e.BreakoutRoomsRetentionShuffle="breakout_rooms_retention_shuffle",e.BreakoutRoomsRetentionMigration="breakout_rooms_retention_migration",e.BreakoutRoomsDeleteAllOperation="breakout_rooms_delete_all_operation",e.BreakoutRoomsRecreateDialog="breakout_rooms_recreate_dialog",e.BreakoutRoomsSetTimerUfdTimeout="breakout_rooms_set_timer_ufd_timeout",e.BreakoutRoomsSetTimerExpireDialogTimeout="breakout_rooms_set_timer_expire_dialog_timeout",e.BreakoutRoomsShowTimerExpireUfd="breakout_rooms_show_timer_expire_ufd",e.BreakoutRoomsShowTimerExpireDialog="breakout_rooms_show_timer_expire_dialog",e.BreakoutRoomsFetchParticipants="breakout_rooms_fetch_participants",e.CallTimer="call_timer",e.BreakoutRoomsFetchGroupMembers="breakout_rooms_fetch_group_members",e.BreakoutRoomsRetainedParticipantsCleanup="breakout_rooms_retained_participants_cleanup",e.AddPstnParticipant="add_pstn_participant",e.CallMeBack="call_me_back",e.CallMeBackEndCall="call_me_back_end_call",e.AllowAttendeesToUnmute="allow_attendees_to_unmute",e.DisallowAttendeesToUnmute="disallow_attendees_to_unmute",e.AudienceScenesCreateDialogApplyScene="audience_scenes_create_dialog_apply_scene",e.DataChannelAudienceSend="data_channel_audience_send",e.StartTmView="start_tm_view",e.SwitchTmLatency="switch_tm_latency",e.CallingMuteAll="calling_mute_all",e.CallingMuteParticipant="calling_mute_participant",e.RemoveUserFromMeetup="remove_user_from_meetup",e.RosterParticipantsSearch="roster_participants_search",e.ContentSharingPresenterJoin="content_sharing_presenter_join",e.ContentSharingRejoin="content_sharing_rejoin",e.ContentSharingStart="content_sharing_start",e.ContentSharingViewerJoin="content_sharing_viewer_join",e.PptHandleFileAttachment="ppt_handle_file_attachment",e.PptSharingPresenterChangedEnablePrivateView="ppt_sharing_presenter_changed_enable_private_view",e.PptSharingViewerChangedEnablePrivateView="ppt_sharing_viewer_changed_enable_private_view",e.PptSharingWrsInit="ppt_sharing_wrs_init",e.GetMeetingAttachmentList="get_meeting_attachment_list",e.RetryConversationSync="retry_conversation_sync",e.MuteSelf="mute_self",e.ServerUnmuteSelf="server_unmute_self",e.ToggleMuteLatency="toggle_mute_latency",e.UnmuteSelf="unmute_self",e.SpotlightStateStart="spotlight_state_start",e.SpotlightStateStop="spotlight_state_stop",e.StartLgView="start_lg_view",e.SwitchLgLatency="switch_lg_latency",e.StartVideo="start_video",e.StopVideo="stop_video",e.VideoStreamRendering="video_stream_rendering",e.LeaveScreenshare="leave_screenshare",e.IncomingScreenshareCall="incoming_screenshare_call",e.ScreenshareAccept="screenshare_accept",e.CreateGroupScreenshareCall="create_group_screenshare_call",e.CreateOneToOneScreenshareCall="create_one_to_one_screenshare_call",e.JoinScreenshareCall="join_screenshare_call",e.ScreenshareCallEscalate="screenshare_call_escalate",e.ScreenSharingSender="screen_sharing_sender",e.ScreenSharingSenderEnd="screen_sharing_sender_end",e.ConversationSyncFailure="conversation_sync_failure",e.PlatformTabSdkGetAppContentStageSharingCapabilities="platform_tab_sdk_get_app_content_stage_sharing_capabilities",e.PlatformTabSdkShareAppContentToStage="platform_tab_sdk_share_app_content_to_stage",e.PlatformTabSdkGetAppContentStageSharingState="platform_tab_get_app_content_stage_sharing_state",e.PlatformTabSdkStopSharingAppContentToStage="platform_tab_sdk_stop_sharing_app_content_to_stage",e.ComposeTimeToInteractive="compose_time_to_interactive",e.ChatQuery="chat_query",e.ToastActivation="toast_activation",e.ToastView="toast_view",e.P2PFilesListSwitch="documents_p2p_files_list_switch",e.PeoplePickerAadDomain="people_picker_aad_domain_lookup",e.PeoplePickerFederationWarning="people_picker_federation_warning",e.PeoplePickerFederationWarningClick="people_picker_federation_warning_click",e.InviteConversationQuarantined="invite_conversation_quarantined",e.InviteConversationUnquarantined="invite_conversation_unquarantined",e.SwRegistration="sw_registration",e.SwInstall="sw_install",e.StoreServiceGetCollections="ext_store_service_get_collections",e.StoreServiceGetItems="ext_store_service_get_items",e.StoreServiceGetHeroItems="ext_store_service_get_hero_items",e.StoreServiceQueryItems="ext_store_service_query_items",e.StoreServiceContentRequest="ext_store_service_content_request",e.StoreEntry="ext_store_entry",e.StoreSwitchFeed="ext_store_switch_feed",e.StoreSwitchCollection="ext_store_switch_collection",e.StoreSwitchSearch="ext_store_switch_search",e.StoreSwitchManageApps="ext_store_switch_manage_apps",e.StoreCollectionLoadMore="ext_store_collection_load_more",e.ManageAppsUninstall="ext_manage_apps_uninstall",e.LoadFastPowerbar="load_fast_powerbar",e.PowerbarSession="powerbar_session",e.JoinMeetingStart="join_meeting_start",e.DesktopRigelSso="desktop_rigel_sso",e.HdmiIngest="hdmi_ingest",e.LeaveMeetup="leave_meetup",e.RigelAutoScreenSharing="rigel_auto_screen_sharing",e.RigelCurrentTeamsState="rigel_current_teams_state",e.RigelLayoutSelection="rigel_layout_selection",e.SearchChatTitle="search_chat_title",e.RenderVideoAppSidePanel="render_video_app_side_panel",e.VideoEffectsMoreViewPanel="video_effects_more_view_panel",e.VideoEffectsQuickPicker="video_effects_quick_picker",e.VideoMessageRecording="video_message_recording",e.AmsVideoUpload="ams_video_upload",e.AddVideoMessageBlobsCache="add_video_message_blobs_cache",e.VideoMessagePreview="video_message_preview",e.VideoMessagePlayback="video_message_playback",e.BrbCreateItem="brb_create_item",e.PoliciesServiceGetPolicies="policies_service_get_policies",e.PoliciesFetchDataResolvers="policies_fetch_data_resolvers",e.UserPreferencesManagerGet="user_preferences_manager_get",e.UserPreferencesManagerSet="user_preferences_manager_set",e.UserPreferencesManagerHandleDeltaUpdate="user_preferences_manager_handle_delta_update",e.UserPreferencesWorkerResolverQuery="user_preferences_worker_resolvers_query",e.UserPreferencesWorkerResolverMutation="user_preferences_worker_resolvers_mutation",e.JoinScheduledWebinarFromLink="join_scheduled_webinar_from_link",e.RetrieveRegistrationReport="retrieveRegistrationReport",e.CalCreateWebinarEvent="cal_create_webinar_event",e.CalDeleteWebinarEvent="cal_delete_webinar_event",e.WebinarGetMeeting="webinar_get_meeting",e.WebinarSavePage="webinar_save_page",e.WebinarSubmitAttendeeRegistration="webinar_submit_attendee_registration",e.WebinarGetImage="webinar_get_image",e.WebinarUpdateImage="webinar_update_image",e.WebinarHostPrivacyStatementUrl="webinar_host_privacy_statement_url",e.WebinarCancelAttendeeRegistration="webinar_cancel_attendee_registration",e.WebinarSendUpdateEmail="webinar_send_update_email",e.MaGetArtifacts="ma_get_artifacts",e.MaGetAttendanceReportV3="ma_get_attendance_report_v3",e.MaGetAttendanceReportWebinar="ma_get_attendance_report_webinar",e.MaGetRegistrationReportWebinar="ma_get_registration_report_webinar",e.MaDownloadAttendanceReportV3="ma_download_attendance_report_v3",e.MaDownloadAttendanceReportWebinar="ma_download_attendance_report_webinar",e.MaDownloadRegistrationReportWebinar="ma_download_registration_report_webinar",e.MaReportRender="ma_report_render",e.CalWebinarEventCancel="cal_webinar_event_cancel",e.WebinarDeleteImage="webinar_delete_image"}(i||(i={})),function(e){e.AuthServiceBaseLogoutFail="auth_service_base_logout_fail",e.AuthServiceBaseLogoutStart="auth_service_base_logout_start",e.AuthServiceBaseLogoutStop="auth_service_base_logout_stop",e.AuthServiceBaseLogoutUserMismatch="user-misMatch",e.AuthServiceBaseProviderFail="provider_fail",e.AuthServiceBaseProviderStart="provider_start",e.AuthServiceBaseProviderStop="provider_end",e.AuthServiceLogoutStart="auth_service_logout_start",e.ResolverRemoveAuthenticatedUserStart="resolver_remove_authenticated_user_start",e.CallingApiInitialized="calling_api_initialized",e.SlimCoreWebView2Loaded="slim_core_web_view_2_loaded",e.SlimCoreLoaded="slim_core_loaded",e.CallingLoaded="calling_loaded",e.CallingCdlLoaded="calling_cdl_loaded",e.CallingServiceAdaptersRetrieved="calling_service_adapters_retrieved",e.ParentsAppLoading="parents_app_loading",e.wiki_wrote_scenario="wiki_wrote_scenario",e.WikiReadWritingDefinition="wiki_read_writing_definition",e.MakeFloodgateBare="make_floodgate_bare",e.BootstrapFloodgate="bootstrap_floodgate",e.DelayedInitialization="delayed_initialization",e.StartupTriggers="startup_triggers",e.ScheduledJobStateChange="scheduled_job_state_change",e.ApplicationLifeCycleStateChange="application_life_cycle_change",e.ChatListQueryInit="chat_list_query_init",e.ChatListQueryLoaded="chat_list_query_loaded",e.ChatListRenderFirstItem="chat_list_render_first_item",e.ChatListRenderComplete="chat_list_render_complete",e.Pause="pause",e.Resume="resume",e.Start="start",e.Stop="stop",e.ExtAppsQueryInstalledAppsWithPreCheck="ext_apps_fetch_installed_apps_with_pre_check",e.ExtAdaptiveCardOrgSearchComplete="ext_adaptive_card_org_search_complete",e.ExtAdaptiveCardOrgSearchResultsRankingComplete="ext_adaptive_card_org_search_results_ranking_complete",e.PlatformFlyoutGetInstalledApps="platform_flyout_get_installed_apps",e.AppCacheMainJS="appcache_main",e.AppCacheVendorJS="appcache_vendor",e.ClickTimeAction="click-time-action",e.DownloadScripts="download_scripts",e.DownloadMainJs="main",e.DownloadVendorJs="vendor",e.EncodedBodySizeMainJS="encoded_body_size_main",e.EncodedBodySizeVendorJS="encoded_body_size_vendor",e.IndexServiceWorkerStartup="index_service_worker_startup",e.IndexFetchIPC="index_fetch_ipc",e.IndexFetchIPCWait="index_fetch_ipc_wait",e.IndexFetchProcessing="index_fetch_processing",e.MainBundleDownloadParse="main_bundle_download_parse",e.PreCoreInitializationTasks="pre_core_initialization_tasks",e.PostCoreInitializationTasks="post_core_initialization_tasks",e.PostCoreOnUserAuthenticatedTasks="post_core_on_user_authenticated_tasks",e.CoreEssentialsChunkLoad="core_essentials_chunk_load",e.RenderRoot="render_root",e.RenderRootProvider="render_root_provider",e.RenderCriticalContent="render_critical_content",e.FetchData="fetch_data",e.FetchQuerySend="fetch_query_send",e.FetchWait="fetch_wait",e.FetchWaitIpc="fetch_wait_ipc",e.FetchWaitWorker="fetch_wait_worker",e.FetchProcessResponse="fetch_process_response",e.GetAuthUser="get_auth_user",e.InitCoreServices="init_core_services",e.InitCoreServicesComplete="init_core_services_complete",e.RenderShareForm="render_share_form",e.QueryResult="query_result",e.CdlWorkerBootstrapped="cdl_worker_bootstrapped",e.CdlWorkerManagerLoaded="cdl_worker_manager_loaded",e.CdlWorkerManagerHealthChecked="cdl_worker_manager_health_checked",e.PlatformTabInitInvoke="platform_tab_initialize_invoked",e.PlatformTabAppLoadedInvoke="platform_tab_appLoaded_invoked",e.PlatformTabNotifySuccessInvoke="platform_tab_success_invoked",e.PlatformTabNotifyFailureInvoke="platform_tab_failure_invoked",e.PlatformTabNotifyExpectedFailureInvoke="platform_tab_expected_failure_invoked",e.PlatformTabSdkSaveInvoked="platform_tab_sdk_save_invoked",e.PlatformTabSaveMutationInvoked="platform_tab_save_mutation_invoked",e.fetchData="fetch_data",e.loadingHostedContent="loading_hosted_content",e.PlatformTabRemoteCameraHandlerError="platform_tab_remote_camera_handler_error",e.PlatformTabRemoteCameraSessionStatusChanged="platform_tab_remote_camera_session_status_changed",e.PlatformTabRemoteCameraDeviceStateChanged="platform_tab_remote_camera_device_state_changed",e.PlatformTabRemoteCameraCapableParticipantsChanged="platform_tab_remote_camera_capable_participants_changed",e.Critical="critical",e.PostCritical="post_critical",e.Complete="complete",e.BeginWindowCreation="begin_window_creation",e.CallingContext="calling_context",e.EndWindowCreation="end_window_creation",e.PlatformFetchAppDefinition="platform_fetch_app_definition",e.PlatformFetchTabInfo="platform_fetch_tab_information",e.RenderBaseApp="render_base_app",e.RenderApp="render_app",e.RenderCallingScreen="render_calling_screen",e.RenderChatList="render_chat_list",e.RenderChatPane="render_chat_pane",e.RenderMessages="render_messages",e.RenderComposeChat="render_compose_chat",e.RenderPlatformApp="render_platform_app",e.RenderPrejoin="render_prejoin",e.RenderPrejoinOverflow="render_prejoin_overflow",e.RenderPrejoinConnecting="render_prejoin_connecting",e.RenderLobby="render_lobby",e.CallingWindowingContainer="calling_windowing_container",e.RenderCallEndScreen="render_call_end_screen",e.RenderProviders="render_providers",e.Unknown="unknown",e.WindowContextProvider="window_context_provider",e.WindowCreated="window_created",e.STTDialogTriggered="stt_dialog_triggered",e.STTOutlookAuthStrapOpen="stt_outlook_auth_strap_open",e.STTOutlookAuthStrapRedirect="stt_outlook_auth_strap_redirect",e.STTOutlookCallbackTokenComplete="stt_outlook_callback_token_complete",e.STTOutlookMTCachedTokenComplete="stt_outlook_mt_cached_token_complete",e.STTOutlookOpen="stt_outlook_open",e.STTOutlookSSOComplete="stt_outlook_sso_complete",e.Get3SCallMetaData="get_3s_call_metadata",e.ReactSerpLoaded="react_serp_loaded",e.RequestSent3S="request_sent_3s",e.ResponseSuccess3S="response_success_3s",e.RequestSentOsearch="request_sent_osearch",e.ResponseSuccessOsearch="response_success_osearch",e.RequestSentMT="request_sent_mt",e.ResponseSuccessMT="response_success_mt",e.UIResultsProcessed="render_begin",e.FetchedFromServiceCache="fetched_from_cache",e.RequestHeaderStart="request_header_start",e.HeaderRendered="header_rendered",e.FiltersRendered="filters_rendered",e.ForcedTimedOut3S="forced_timeout_3s",e.Failure3S="failure_3s",e.RenderedPartial="rendered_partial",e.Retry3S="retry_3s",e.SearchFailureResolver="search_failure_resolver",e.InvalidConvId="invalid_convId",e.NoHitInMainChatMessage="no_hit_main_chat",e.MainChatMessageFound="main_chat_found",e.NoPreviousAndNextMessage="no_previous_next_message",e.DataStoreCorrupted="data_store_corrupted",e.OnBehalfOfUserResolveNameFromMessage="onbehalfof_user_resolve_name_from_message",e.OnBehalfOfUserResolveNameFromUserQuery="onbehalfof_user_resolve_name_from_user_query",e.RoomCoordinatesQuery="room_coordinates_query",e.CreateBreakoutRoomsMutation="create_breakout_rooms_mutation",e.ShuffleParticipantsMutation="shuffle_participants_mutation",e.PreserveParticipantsMutation="preserve_participants_mutation",e.ObtainCreateBreakoutRoomsMutationFn="obtain_create_breakout_rooms_mutation_fn",e.BreakoutRoomCreateDialogOpen="breakout_room_create_dialog_open",e.ListBreakoutRoomsQuery="list_breakout_rooms_query",e.SendMessageMutation="send_message_mutation",e.SendMessageResultProcessing="send_message_result_processing",e.BreakoutRoomMoveToOpenedRoomMutation="breakout_room_move_participant_to_opened_room_mutation",e.BreakoutRoomMoveToAnotherRoomMutation="breakout_room_move_participant_to_another_room_mutation",e.BreakoutRoomMoveToMainMeetingMutation="breakout_room_move_participant_to_main_meeting_mutation",e.BreakoutRoomMoveAssignmentsUpdate="breakout_room_move_assignments_update",e.GoToMainMeetingMutation="go_to_main_meeting_mutation",e.GoToBreakoutRoomMutation="go_to_breakout_room_mutation",e.DeleteAllBreakoutRooms="delete_all_breakout_rooms",e.HideBreakoutRoomPanel="hide_breakout_room_panel",e.ShowBreakoutRoomCreateDialog="show_breakout_room_create_dialog",e.ClearBreakoutRoomParticipantCache="clear_breakout_room_participant_cache",e.BreakoutRoomsAppInitialized="breakout_rooms_app_initialized",e.MessageIdFetched="messageId_retrieved",e.MeetingRoleLoaded="meeting_role_loaded",e.PostVoiceDataToSubstrate="post_voice_data_to_substrate",e.RetrieveCognitionToken="retrieve_cognition_token",e.StartVoiceRecognition="start_voice_recognition",e.StopVoiceRecognition="stop_voice_recognition",e.ExtAppsProcessed="ext_apps_processed",e.ExtAppsFetched="ext_apps_fetched",e.ExtAppsFetchedPersonalScope="ext_apps_fetched_personal_scope",e.ExtAppsFetchedGroupScope="ext_apps_fetched_group_scope",e.ExtAppsFetchedTeamScope="ext_apps_fetched_team_scope",e.ExtAppsQueryInstalledAppsV2="ext_apps_fetch_installed_apps_v2",e.ExtSearchInvoke="ext_search_invoke",e.ExtAppForBotCardChatQuery="ext_app_definitions_for_bot_card_chat_query",e.ExtAppForBotCardAppQuery="ext_app_definitions_for_bot_card_app_query",e.ExtAdaptiveCardSDKParse="ext_ac_sdk_parse",e.ExtAdaptiveCardSDKRender="ext_ac_sdk_render",e.ExtAdaptiveCardHtmlTransformation="ext_ac_html_transformation",e.ExtBotsSignInOnLaunchWebflow="ext_bots_signin_webflow_started",e.ExtBotsSignInOnSdkNotifySuccess="ext_bots_signin_sdk_notify_success",e.ExtBotsSignInOnSdkNotifyFailure="ext_bots_signin_sdk_notify_failure",e.ExtBotsSignInOnInvokStateVerificationDone="ext_bots_signin_invoke_state_done",e.ExtBotsSignInOnInvokStateVerificationFailed="ext_bots_signin_invoke_state_failed",e.ExtCardCopyPreProcessing="ext_bots_card_copy_preprocess",e.ExtCardCopyUISlotReady="ext_bots_card_copy_ui_slot_ready",e.ExtCardCopyGenerateMetaInfoHtml="ext_bots_card_copy_gen_html_meta_info",e.ExtCardCopyGenerateSharingHtml="ext_bots_card_copy_gen_html_sharing",e.ExtCardCopyGenerateTextPreview="ext_bots_card_copy_gen_text_preview",e.ExtCardCopyToClipboard="ext_bots_card_copy_to_clipboard",e.ExtCardCopyDone="ext_bots_card_copy_done",e.ExtAppDefinitionFetched="ext_app_defintion_fetched",e.ExtBotFileIconStateModified="ext_bot_file_icon_state_modified",e.ExtMentionProcessingComplete="ext_mention_processing_complete",e.ExtMentionPropertyMissing="ext_mention_property_missing",e.ExtScenePickerGetInstalledApps="ext_scene_picker_get_installed_apps",e.ExtScenePickerGetAvailableApps="ext_scene_picker_get_available_apps",e.ExtScenePickerGetAppsScenesUsage="ext_scene_picker_get_apps_scenes_usage",e.ExtMeetingAppsFlyoutGetInstalledApps="ext_meeting_apps_flyout_get_installed_apps",e.ExtMeetingAppsFlyoutGetAvailableApps="ext_meeting_apps_flyout_get_available_apps",e.buffering_message="buffering_message",e.setting_state="setting_state",e.requesting_translation="requesting_translation",e.applying_result="applying_result",e.MicPropsChanged="mic_prop_changed",e.RosterSidePanelRendering="roster_side_panel_rendering",e.RosterPickerRendering="roster_picker_rendering",e.RosterContainerRendering="roster_container_rendering",e.RosterPanelManagerRendering="roster_panel_manager_rendering",e.RosterParticipantsSearchInput="roster_participants_search_input",e.RosterParticipantsSearchContainerRendering="roster_participants_search_container_rendering",e.RosterParticipantsSearchRendering="roster_participants_search_rendering",e.RosterParticipantsSearchParticipantNudged="roster_participants_search_participant_nudged",e.RosterParticipantsAADSearch="roster_participants_aad_search",e.RosterParticipantsAADLocalSearch="roster_participants_aad_local_search",e.RosterParticipantsAADRemoteSearch="roster_participants_aad_remote_search",e.RosterParticipantsNGCSearch="roster_participants_ngc_search",e.RosterParticipantsSearchNoMatchRendering="roster_participants_search_no_match_rendering",e.RosterParticipantsSearchListViewRendering="roster_participants_search_list_view_rendering",e.CallHealthPanelCategoriesDataReceived="call_health_panel_categories_data_received",e.FetchMeetingTemplateDescriptions="fetch_meeting_template_descriptions",e.RetrieveMeetingTemplateDescriptions="retrieve_meeting_template_descriptions",e.ParseMeetingTemplateDescriptions="parse_meeting_template_descriptions",e.FluidDetailsPanelAutoOpen="fluid_details_panel_auto_open",e.FluidDetailsPanelManualOpen="fluid_details_panel_manual_open",e.ShareLinkRedeem="share_link_redeem",e.FluidLoadMessageAppPhaseAtComplete="fluid_load_message_app_phase_at_complete",e.FluidLoadMessageLazyLoaded="fluid_load_message_lazy_loaded",e.FluidPreloadMessageAppPhaseAtPostCritical="fluid_preload_message_app_phase_at_post_critical",e.ApplyAudienceSceneStart="apply_audience_scene_start",e.ApplyAudienceSceneSuccess="apply_audience_scene_success",e.ApplyAudienceSceneFailure="apply_audience_scene_failure",e.SerializeCachedImageGotData="serialize_cached_image_got_data",e.SerializeCachedImageUploadedData="serialize_cached_image_uploaded_data",e.SerializeCachedImageDeletedEntry="serialize_cached_image_deleted_entry",e.SerializeCachedImageRevokedBlobUrl="serialize_cached_image_revoked_blob_url",e.ChatSendMessageGotChat="chat_send_message_got_chat",e.ChatSendMessageServicesLazyLoadComplete="chat_send_message_services_lazy_load_complete",e.ChatSendMessageOptimisticResponsePosted="chat_send_message_optimistic_response_posted",e.ChatSendMessageSerializationComplete="chat_send_message_serialization_complete",e.UpdateCallsApp="update_calls_app",e.UpdateSpeedDial="update_speed_dial",e.UpdateDialpad="update_dialpad",e.UpdateCallHistoryTable="update_call_history_table",e.UpdateSharedLinesTable="update_shared_lines_table",e.FetchSpeedDialData="fetch_speed_dial_data",e.FetchOtherContactsData="fetch_other_contacts_data",e.FetchSharedLines="fetch_shared_lines",e.FetchSlaCalls="fetch_sla_calls",e.FetchParkedCalls="fetch_parked_calls",e.FetchCallHistory="fetch_call_history",e.FetchVoicemail="fetch_voicemail",e.FetchCallBlockList="fetch_call_block_list",e.NotificationSettingsPageDataRequested="notification_settings_page_data_requested",e.NotificationSettingsPageDataReceived="notification_settings_page_data_received",e.NotificationSettingsDataRequested="notification_settings_data_requested",e.NotificationSettingsDataReceived="notification_settings_data_received",e.NotificationSettingsResolverRequested="notification_settings_resolver_requested",e.Channel3SResolved="3s_channel_resolved",e.Chat3SResolved="3s_chat_resolved",e.People3SResolved="3s_people_resolved",e.SwInstalled="sw_installed",e.SwInstalling="sw_installing",e.SwActivating="sw_activating",e.SwInstallFailure="sw_install_failure",e.SwWaitingAbandon="sw_waiting_abandon",e.SwActivatingFailure="sw_activating_failure",e.ShareTrayFetchInvision="share_tray_fetch_invision",e.ShareTrayFetchWhiteboard="share_tray_fetch_whiteboard",e.ShareTrayRenderInvision="share_tray_render_invision",e.ShareTrayRenderWhiteboard="share_tray_render_whiteboard",e.shareTrayFetchPreviews="share_tray_fetch_previews",e.shareTrayRenderScreens="share_tray_render_screens",e.shareTrayRenderApps="share_tray_render_apps",e.ConversationFetched="conversation_fetched",e.SetOriginalArrivalTime="set_original_arrival_time",e.PostNewClientLie="post_new_client_lie",e.PostMessageToConversation="post_message_to_conversation",e.ResolveClientLie="resolve_client_lie",e.PostEditClientLie="post_edit_client_lie",e.EditMessageInConv="edit_message_in_conversation",e.ResolveEditClientLie="resolve_edit_client_lie",e.RevertEditClientLie="revert_edit_client_lie",e.IndexedDBUpgrade="indexed_db_upgrade",e.LinkedInCheckVersionOverride="linkedin_checkversionoverride",e.LinkedInLoadMain="linkedin_loadmain",e.ActivityFeedItemGenerated="activity_feed_item_generated",e.ActivityFeedMetaDataInsertedIntoStore="activity_feed_metadata_inserted_into_store",e.ActivityFeedChatTitlePopulated="activity_feed_chat_title_populated",e.ActivityFeedHydrationCompleted="activity_feed_hydration_completed",e.ActivityFeedPeopleProfilePopulated="activity_feed_people_profile_populated",e.ActivityFeedPostPeopleProfileProcessingCompleted="activity_feed_post_people_profile_processing_completed",e.ActivityFeedProfileIdFetchFailed="activity_feed_profile_id_fetch_failed",e.ActivityFeedAddedKnownFeedProps="activity_feed_added_known_feed_props",e.ActivityFeedUnknownUserProfilePopulated="activity_feed_unknown_user_profile_populated",e.ActivityFeedMessageValidated="activity_feed_message_validated",e.ActivityFeedLongPollMessageReceived="activity_feed_long_poll_message_received",e.ActivityFeedMounted="activity_feed_mounted",e.FeedCriticalPhaseCallback="feed_critical_phase_callback",e.FeedListDataReceived="feed_list_data_received",e.FeedItemSelected="feed_item_selected",e.FeedItemNavigation="feed_item_navigation",e.FeedListPrefetchTriggered="feed_list_prefetch_triggered",e.ChatRosterRenderedMembersLoaded="members_loaded",e.ChatRosterRenderedMembersRenderedInVList="members_rendered_in_vlist",e.ActivityManagerStartupInitiated="activity_manager_startup_initiated",e.ActivityManagerUnprocessedMessagesFetchedFromReplyChain="activity_manager_unprocessed_messages_fetched_from_reply_chain",e.ActivityManagerUpdatedWithNewActivities="activity_manager_updated_with_new_activities",e.ActivityManagerRemovedStoredDataFromDb="activity_manager_removed_stored_data_from_db",e.ActivityManagerEmptyReplyChainRequestKeys="activity_manager_empty_reply_chain_request_keys",e.ActivityManagerEmptyActivityPrivateStreamId="activity_manager_empty_activity_private_stream_id",e.ActivityManagerGetMessagesFromReplyChainsFailed="activity_manager_get_messages_from_reply_chains_failed",e.ActivityManagerFeedItemsGenerated="activity_manager_feed_items_generated",e.ActivityManagerFeedItemsUpdated="activity_manager_feed_items_updated",e.ActivityManagerNoMetadata="activity_manager_no_metadata",e.SwitchViewLatencyInvitingBotToCall="invite_bot_to_call",e.SwitchViewLatencyBotJoinedCall="bot_joined_call",e.SwitchViewLatencyStartStreamInitiated="start_stream_initiated",e.SwitchViewLatencyRendererCreated="renderer_created",e.CalEmptyState="cal_empty_state",e.CalEventsLoadedFromCache="cal_events_loaded_from_cache",e.PlatformTabSidePanelLoadStart="platform_tab_sidepanel_load_start",e.PlatformFetchDataStart="platform_fetch_data_start",e.PlatformFetchAppDefinitionStart="platform_fetch_app_definition_start",e.PlatformFetchAppDefinitionEnd="platform_fetch_app_definition_end",e.PlatformFetchChatInfoStart="platform_fetch_chat_info_start",e.PlatformFetchChatInfoEnd="platform_fetch_chat_info_end",e.OnAppPreWarm="on_app_pre_warm",e.OnAppPreInit="on_app_pre_init",e.JobAdded="job_added",e.ExecuteJob="execute_job",e.AdaptiveCardsV2ManagerPreProcessMessages="adaptive_cards_v2_manager_pre_process_messages",e.AdaptiveCardsV2ManagerGetMultipleCards="adaptive_cards_v2_manager_get_multiple_cards",e.AdaptiveCardsV2ManagerUpdateMessages="adaptive_cards_v2_manager_update_messages",e.ExpLoaderIndexStart="execute-index-html-script",e.ExpLoaderLoadBundlesStart="exp_loader_load_bundles_start",e.ExpLoaderLoadBundlesStop="exp_loader_load_bundles_stop",e.ExpLoaderIndexStop="exp_loader_index_stop",e.CoreInitStart="core_init_start",e.CoreInitStop="core_init_stop",e.CoreUserContextStart="core_user_context_start",e.CoreUserContextStop="core_user_context_stop",e.CoreRenderingContextReady="core_rendering_context_ready",e.CoreDeeplinkProcessingStart="core_deeplink_processing_start",e.CoreDeeplinkProcessingStop="core_deeplink_processing_stop",e.OpenActionsMenuClick="open_actions_menu_click",e.PinUrlAsTabClick="pin_url_as_tab_click",e.UrlAddedAsTab="url_added_as_tab",e.CallingCalendarQuery_ChatLoaded="calling_calendar_query_chat_loaded",e.CallingCalendarQuery_TeamChannelLoaded="calling_calendar_query_team_channel_loaded",e.ModernStageRender_Join="modern_stage_render_join",e.ModernStageRender_Swap="modern_stage_render_swap",e.ModernStageRender_Pinning="modern_stage_render_pinning",e.ModernStageRender_Spotlighting="modern_stage_render_spotlighting",e.ModernStageRender_VBSS="modern_stage_render_vbss",e.ModernStageRender_BotView="modern_stage_render_botview",e.ModernStageRender_PPT="modern_stage_render_ppt",e.ModernStageRender_Holographic="modern_stage_render_holographic",e.ModernStageRender_Whiteboard="modern_stage_render_whiteboard",e.ConversationFocusChecked="conversation_focus_checked",e.AvatarFetched="avatar_fetched",e.P2PFilesListRendererError="p2p_files_list_renderer_error",e.P2PFilesListRendererEmptyList="p2p_files_list_renderer_empty_list",e.P2PFilesListRendererFilesList="p2p_files_list_renderer_files_list",e.QueryStart="query_start",e.QueryEnd="query_end",e.WorkerStart="worker_start",e.WorkerEnd="worker_end",e.IdbPeopleAndChatStart="indexeddb_people_chat_start",e.IdbPeopleAndChatEnd="indexeddb_people_chat_end",e.InstantScdStart="instant_scd_start",e.InstantScdEnd="instant_scd_end",e.InviteFlowStart="invite_flow_start",e.InviteFlowEnd="invite_flow_end",e.HistorySearchStart="history_search_start",e.FetchHistoryProfiles="history_profile_fetch",e.FetchHistoryChats="history_chats_fetch",e.HistorySearchEnd="history_search_end",e.GetSelectedFilter="get_selected_filter",e.GetAppDefinition="get_app_definition",e.FetchBackgrounds="fetch_backgrounds",e.FetchVideoFilters="fetch_video_filters",e.FetchQuickPickerBackgrounds="fetch_quick_picker_backgrounds",e.FetchQuickPickerVideoFilters="fetch_quick_picker_video_filters",e.SFVRecordingStart="sfv_recording_start",e.SFVRecordingEnd="sfv_recording_end",e.SFVEditStart="sfv_edit_start",e.SFVEditEnd="sfv_edit_end",e.PreviewMetadataLoaded="preview_metadata_loaded",e.PlayerLoadInitiated="player_load_initiated"}(a||(a={})),function(e){e[e.Expanded=1]="Expanded",e[e.ExpandedAndPacked=2]="ExpandedAndPacked",e[e.Packed=3]="Packed"}(o||(o={}))},933922:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var i=n(250921),a=n(313176),o=n(60261);const r="(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",s="[0-9a-fA-F]{1,4}",l=`(\\s|^|\\[)(${`(?:${s}:){1,7}:|(?:${s}:){7}${s}|(?:${s}:){6}(?::${s}|${r})|(?:${s}:){5}(?:(?::${s}){1,2}|:${r})|(?:${s}:){4}(?:(?::${s}){1,3}|(?::${s}){0,1}:${r})|(?:${s}:){3}(?:(?::${s}){1,4}|(?::${s}){0,2}:${r})|(?:${s}:){2}(?:(?::${s}){1,5}|(?::${s}){0,3}:${r})|(?:${s}:){1}(?:(?::${s}){1,6}|(?::${s}){0,4}:${r})|(?::(?:(?::${s}){1,7}|(?::${s}){0,5}:${r}|:))|(?:fe80|FE80):(?::[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}`})(\\s|$|\\])`,c={[a.A4.SmtpAddress]:new RegExp("\\S+@\\S+\\.\\S+","g"),[a.A4.IPV4Address]:new RegExp(r,"g"),[a.A4.PhoneNumber]:new RegExp("(?:[^-\\d]|^)(?:\\+?1[-.]?)?\\(?([0-9]{3})\\)?[-.]?([0-9]{3})[-.]?([0-9]{4})(?!\\d)","g"),[a.A4.Uri]:new RegExp('((http[s]?:\\/\\/[^(\\/|\\?)]+\\S)|(data:text\\/)|(data:image)|(data:application)|(file:)|([s]?ftp:\\/\\/[\\S]+\\/)|(mailto:))(([^(.|")]+[^\\s]+))'),[a.A4.FilePath]:new RegExp(`((\\s(\\w+))(\\/).+?(?=((\\.${(0,o.D)().join(")|(\\.")})|($))))`,"g")};function d(e,t){switch(e){case a.A4.SmtpAddress:case a.A4.IPV4Address:case a.A4.PhoneNumber:case a.A4.FilePath:return t.replace(c[e],(e=>(0,i.sha256)(e)));case a.A4.IPv6Address:return function(e){const t=new RegExp(l,"g");let n,a="";do{if(n=t.exec(e),n&&4===n.length){const o=n.index+n[1].length;a=`${a}${e.substring(0,o)}${(0,i.sha256)(n[2])}`;const r=o+n[2].length;e=e.substring(r),t.lastIndex=0}}while(n);return`${a}${e}`}(t);case a.A4.Uri:{let n,a="";do{if(n=c[e].exec(t),n){const e=t.substring(0,n.index),o=t.substring(n.index).replace(n[n.length-1],(e=>(0,i.sha256)(e))),r=5;t=o.substring(r),a=`${a}${e}${o.substring(0,r)}`}}while(n);return a=`${a}${t}`,a}default:return}}function u(e,t=[]){if(e){0===t.length&&t.push(a.A4.Uri,a.A4.SmtpAddress,a.A4.IPV4Address,a.A4.IPv6Address,a.A4.PhoneNumber);for(const n of t)e=d(n,e)}return e}},924921:(e,t,n)=>{"use strict";n.d(t,{F:()=>a});var i=n(250921);class a{constructor(e,t){this.value=e,this.piiKind=t}static isPIIValue(e){return!!e&&"string"!=typeof e&&void 0!==e.scrub}scrub(){return(0,i.sha256)(JSON.stringify(this.value))}}},412050:(e,t,n)=>{"use strict";n.d(t,{Db:()=>u,tC:()=>m,j$:()=>p});var i=n(231191),a=n(356452),o=n(682796),r=n(946101),s=n(352367),l=n(243741);const c="",d=/\/api\/chatsvc\/.*?\//;function u(e,t,n,o){let r=c;const s=o.newLogger("chat-service-redirect");return o=>d=>(0,i.__awaiter)(this,void 0,void 0,(function*(){let i=0;for(;;){g(r)&&(r=yield p(t,n,s));const u=yield(0,l.G)(e(o),r)(Object.assign(Object.assign({},d),{headers:Object.assign(Object.assign({},d.headers),{BehaviorOverride:"redirectAs404"})})),{status:h,headers:{location:v}}=u;if(!v||h!==a.qb.NOT_FOUND)return h===a.qb.SERVICE_UNAVAILABLE||h===a.qb.BAD_GATEWAY?(r=c,u):u;if(i>=10)return u;if(r=m(v,s),r===c)return u;i+=1}}))}function m(e,t){let n;try{n=new URL(e)}catch(n){return t.error(`Location header ${e} is invalid: error message ${n.message}`),c}if("teams.microsoft.com"===n.hostname){const i=n.pathname.match(d);return i&&i[0]?`${n.origin}${i[0]}`:(t.error(`No match of chatServiceAfd 404 location with regex, url is ${e}`),c)}return t.log("Url is a ATM Url, use previous parsing strategy."),new URL("/",e).href}function p(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{chatServiceHostOverrideUrl:i}=t.get(o.J.Test);if(i)return(a=i).endsWith("/")?a:`${a}/`;var a;if(function(e){var t,n;return null!==(n=null!==(t=e.get(o.J.Host).enableUseChatServiceAfd)&&void 0!==t?t:e.get(o.J.ChatService).useChatServiceAfd)&&void 0!==n?n:void 0}(t))try{return yield e(r.Pn.chatServiceAfd)}catch(t){if(function(e){if(!e||"object"!=typeof e)return!1;const t=e;return t.code===s.jK.InvalidResponse&&"Discover"===t.context&&"regionGtm"===t.subContext}(t))return n.warn("Flag useChatServiceAfd is set but chatServiceAfd was not found in the GTM table. Falling back to chatService."),e(r.Pn.chatService);throw t}return e(r.Pn.chatService)}))}function g(e){return e===c}},944183:(e,t,n)=>{"use strict";n.d(t,{EH:()=>i,dX:()=>a,fI:()=>o});const i=3e4,a="Request Timed Out",o=3e3},55882:(e,t,n)=>{"use strict";n.d(t,{S:()=>s});var i=n(231191),a=n(356452),o=n(775214),r=n(352367);function s(e){return t=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield e(t);if(n.status>=a.qb.BAD_REQUEST)throw(0,o.Tr)(r.w5.RejectHttpError,r.jK.RemoteOperationFailed,"rejectHttpError",void 0,void 0,n);return n}))}},243741:(e,t,n)=>{"use strict";n.d(t,{G:()=>a});var i=n(231191);function a(e,t){return n=>{var{url:a}=n,o=(0,i.__rest)(n,["url"]);return e(Object.assign(Object.assign({},o),{url:new URL(a,t).href}))}}},67419:(e,t,n)=>{"use strict";n.d(t,{cZ:()=>f,Gg:()=>y,UZ:()=>v});var i=n(352367),a=n(215080),o=n(136295),r=n(226568),s=n(15710),l=n(179032),c=n(618682),d=n(697950),u=n(895725),m=n(157459),p=n(916638),g=n(157505);const h=([e,t])=>(t&&e.do((()=>{}),(e=>{throw e})),e);function v(e,t){return(...n)=>(0,a.P)((()=>e(...n))).pipe(((e,t)=>{const n=e.pipe((0,r.R)(((e,n)=>e||!t(n)),!1)),i=e.pipe((0,s.P)(t),(0,l.V)(5e3));return(0,o.z)((0,c.i)(),(0,d.M)(n),(0,u.U)(h),(0,m.a)((e=>e.pipe((0,p.w)(i)))),(0,g.D)())})(t,S)).toPromise()}const f=e=>(e=>{switch(e){case i.eT.Disabled:case i.eT.Offline:return!1;default:return!0}})(e),y=e=>()=>f(e.getState()),S=e=>e},379922:(e,t,n)=>{"use strict";n.d(t,{s:()=>o,r:()=>r});var i=n(319493),a=n(550635);function o(e,t){return n=>l((()=>e(n)),t)}function r(e,t){return n=>c(l((()=>e(n)),t),t)}const s=(e,t)=>{if(!e.serverResponse)throw e;const{serverResponse:{status:n}}=e;if(n&&t.retryCount++<t.policy.maxRetryCount&&t.policy.shouldRetry(n))return t.retriesTable[n]=(t.retriesTable[n]||0)+1,t.policy.errorHandler(e,t);throw e},l=(e,t)=>(0,i.X)(e,s)({policy:t,delay:t.createDelay(),retryCount:0,retriesTable:{}}),c=(e,t)=>(0,a.E)(e,t.retryMaxTimeMs)},759157:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(861937),a=n(550635),o=n(944183);const r=({url:e,method:t,body:n,headers:r,credentials:s,timeout:l=o.EH,skipHeaders:c=!1})=>{const d=new AbortController;return(0,a.E)(i(e,{method:t,headers:c?{}:r&&new Headers(r),body:n,credentials:s,signal:d.signal}),l,o.dX,d).then((e=>{const t={};return e.headers.forEach(((e,n)=>t[n]=e)),{status:e.status,headers:t,body:e,url:e.url}}))}},988576:(e,t,n)=>{"use strict";n.d(t,{l:()=>d});var i=n(42723),a=n(231191),o=n(604174);var r=n(759157),s=n(356452),l=n(775214),c=n(352367);const d=(0,i.E)(function(e){return t=>(0,a.__awaiter)(this,void 0,void 0,(function*(){let i,a;const r=performance.now(),s=new Date;try{return a=yield e(t),a}catch(e){throw i=e.code||e.message,a=e.serverResponse,e}finally{const e=performance.now();!function(e,t,i,a,r){const s=n.g;(0,o.Lk)(a,t,i,e,e&&function(e){const t=performance.getEntriesByName(e);if(t.length>0&&"resource"===t[t.length-1].entryType)return t[t.length-1];return}(e.url),s,r)}(a,s,t,e-r,i)}}))}(function(e){return t=>(0,a.__awaiter)(this,void 0,void 0,(function*(){var n;try{return yield e(t)}catch(e){if(e instanceof TypeError&&"failed to fetch"===(null===(n=e.message)||void 0===n?void 0:n.toLowerCase())){const n=t.headers&&t.headers.cache;if(n&&-1!==n.indexOf("only-if-cached"))return{status:s.qb.GATEWAY_TIMEOUT};e=(0,l.Tr)(c.w5.RejectHttpError,c.jK.RemoteOperationFailed,"rejectHttpError",void 0,e.message)}throw e}}))}(r.A)))},347434:(e,t,n)=>{"use strict";n.d(t,{mf:()=>i,Zz:()=>a,hh:()=>o,YM:()=>r});const i={Safari:11.1},a=11,o=11.1,r={chrome:">=60",chromium:">=60",edge:">=12",electron:">=2",firefox:">=52"}},763498:(e,t,n)=>{"use strict";n.d(t,{H$:()=>r,MB:()=>s,Qh:()=>l,L5:()=>c});var i=n(745534),a=n(347434),o=n(708362);function r(e=a.YM){return!!e&&!!d().satisfies(e)}function s(){return!u("ie")}function l(){return!!d().satisfies({safari:`>=${a.mf.Safari}`})}function c(){return u("safari")&&void 0===d().getBrowserVersion()}function d(){return i.getParser((0,o.J)().navigator.userAgent)}function u(e){return d().isBrowser(e,!0)}},303632:(e,t,n)=>{"use strict";n.d(t,{qJ:()=>p,GE:()=>m,X$:()=>h,sE:()=>d,lx:()=>u,iu:()=>g});var i=n(624438),a=n.n(i),o=n(635649);const r={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]},s={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"messageFieldsForDeletedMessages"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"users"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"count"}}]}},{kind:"Field",name:{kind:"Name",value:"escalations"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"users"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mri"}},{kind:"Field",name:{kind:"Name",value:"time"}},{kind:"Field",name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"mentionType"}}]}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"userHasSaved"}},{kind:"Field",name:{kind:"Name",value:"diagnosticInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"diagnosticErrorCode"}},{kind:"Field",name:{kind:"Name",value:"diagnosticMessage"}}]}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"baseUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"previewUrl"}},{kind:"Field",name:{kind:"Name",value:"previewHeight"}},{kind:"Field",name:{kind:"Name",value:"previewWidth"}}]}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"FragmentSpread",name:{kind:"Name",value:"deletionInfo"}}]}},...r.definitions]},l={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"deletedMessages"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deletedMessages"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"message"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"messageFieldsForDeletedMessages"}}]}}]}}]}},...s.definitions]};var c=n(927346);function d(e,t){const{message:n}=f(e,t.id,t.clientMessageId,void 0,!(null==t?void 0:t.deleteTime)),i=n&&n.message&&n.message.importance===o.MessageImportance.Urgent;return{__typename:"DeletionInfo",showMessageAsDeleted:!!n,canBeUndeleted:!!n&&!i,deleteFailed:!1}}function u(e,t,n,i){try{const{message:a}=f(e,t,n,i);if(a){const{message:n}=a,i=Object.assign(Object.assign({},n),{id:t}),o=`Message:${t}`;return e.writeFragment({id:o,fragment:s,data:i}),i}}catch(e){}}function m(e,t,n){const i=`Message:${t}`;try{e.readFragment({id:i,fragment:r,fragmentName:"deletionInfo"})&&e.writeFragment({id:i,fragment:r,data:{deletionInfo:{__typename:"DeletionInfo",showMessageAsDeleted:!1,canBeUndeleted:!1,deleteFailed:!0},version:(0,c.M)()[0].toString(),__typename:"Message"}})}catch(e){n&&n.error(`Failed to cache delete failure on ${t}: ${e}`)}}function p(e,t,n){let i=[];try{i=v(e,n)}catch(e){}if(!i.find((e=>e.id===t)))try{const n=`Message:${t}`,a=e.readFragment({id:n,fragment:s,fragmentName:"messageFieldsForDeletedMessages"}),o=Object.assign(Object.assign({},a),{id:`${a.id}_deleted`}),r={id:t,message:o,__typename:"DeletedMessage"};return i=[r,...i],e.writeQuery({query:l,data:{deletedMessages:i}}),r}catch(e){n&&n.error(`Failed to addDeletedMessageToCache: ${e}`)}}function g(e,t,n,i){try{const a=v(e,i),{message:o,isDeletedLieMessage:r}=f(e,t,n,i,!1,a);if(o){const i=a.filter((e=>{var i;return r?(null===(i=e.message)||void 0===i?void 0:i.clientMessageId)!==n:e.id!==t})),d=Object.assign(Object.assign({},o.message),{id:t,deletionInfo:{__typename:"DeletionInfo",showMessageAsDeleted:!1,canBeUndeleted:!1,deleteFailed:!1},version:(0,c.M)()[0].toString(),__typename:"Message"});e.writeQuery({query:l,data:{deletedMessages:i}});const u=`Message:${t}`;return e.writeFragment({id:u,fragment:s,data:d}),d}}catch(e){}}function h(e,t,n){const i=a()`
    fragment messageFieldsNeeded on Message {
      deleteTime
      importance
      deletionInfo {
        showMessageAsDeleted
        canBeUndeleted
        deleteFailed
      }
      version
    }
  `,r=`Message:${t}`;try{const t=e.readFragment({id:r,fragment:i});if(t){const a=t.importance===o.MessageImportance.Urgent;e.writeFragment({id:r,fragment:i,data:{deleteTime:n,importance:t.importance,deletionInfo:{__typename:"DeletionInfo",showMessageAsDeleted:!!n,canBeUndeleted:!!n&&!a,deleteFailed:!1},version:(0,c.M)()[0].toString(),__typename:"Message"}})}}catch(e){}}const v=(e,t)=>{let n;try{n=e.readQuery({query:l})}catch(e){t&&t.error("Unable to fetch deleted messages",e)}return n&&n.deletedMessages||[]},f=(e,t,n,i,a,o)=>{const r={message:null,isDeletedLieMessage:!1};if(!(o=o||v(e,i))||0===o.length)return r;if(!a){const e=o.find((e=>e.id===t));if(e)return{message:e,isDeletedLieMessage:!1}}const s=o.find((e=>e.message&&e.message.clientMessageId===n));return s?{message:s,isDeletedLieMessage:!0}:r}},391566:(e,t,n)=>{"use strict";n.d(t,{C:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"dlpDialogData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dlpDialogData"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isReport"}},{kind:"Field",name:{kind:"Name",value:"isOverride"}},{kind:"Field",name:{kind:"Name",value:"justification"}}]}}]}}]}},884333:(e,t,n)=>{"use strict";n.d(t,{D:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"insertedHyperlink"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"insertedHyperlink"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"displayText"}},{kind:"Field",name:{kind:"Name",value:"address"}}]}}]}}]}},348154:(e,t,n)=>{"use strict";n.d(t,{ev:()=>s,fX:()=>l});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"entityFieldsForEntityCommand"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Entity"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"action"}},{kind:"Field",name:{kind:"Name",value:"options"}},{kind:"Field",name:{kind:"Name",value:"windowOptions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"windowOptionsFields"}}]}},{kind:"Field",name:{kind:"Name",value:"linkedEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"linkedEntityFields"}}]}},{kind:"Field",name:{kind:"Name",value:"entityState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"flushableByLinkedEntity"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"windowOptionsFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WindowOptions"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"left"}},{kind:"Field",name:{kind:"Name",value:"top"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"linkedEntityFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"LinkedEntity"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"action"}}]}}]},a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"windowFieldsForEntityCommand"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Window"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"correlation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"startTimestamp"}},{kind:"Field",name:{kind:"Name",value:"source"}},{kind:"Field",name:{kind:"Name",value:"clientLaunchId"}}]}},{kind:"Field",name:{kind:"Name",value:"extendedEntityContainerState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"containerState"}},{kind:"Field",name:{kind:"Name",value:"isExternal"}}]}},{kind:"Field",name:{kind:"Name",value:"blockingEntityExtension"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"entity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForEntityCommand"}}]}},{kind:"Field",name:{kind:"Name",value:"blockedEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForEntityCommand"}}]}},{kind:"Field",name:{kind:"Name",value:"blockedCommand"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"visibilityState"}},{kind:"Field",name:{kind:"Name",value:"stateTransition"}},{kind:"Field",name:{kind:"Name",value:"correlation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"startTimestamp"}},{kind:"Field",name:{kind:"Name",value:"source"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"blockedEntityOptions"}}]}},{kind:"Field",name:{kind:"Name",value:"layoutMode"}},{kind:"Field",name:{kind:"Name",value:"isMainWindow"}}]}},...i.definitions]},o={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"activeEntitiesFieldsForEntityCommand"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ActiveEntities"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"subNavEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForEntityCommand"}}]}},{kind:"Field",name:{kind:"Name",value:"headerEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForEntityCommand"}}]}},{kind:"Field",name:{kind:"Name",value:"startEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForEntityCommand"}}]}},{kind:"Field",name:{kind:"Name",value:"mainEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForEntityCommand"}}]}},{kind:"Field",name:{kind:"Name",value:"endEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForEntityCommand"}}]}},{kind:"Field",name:{kind:"Name",value:"entityExtension"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForEntityCommand"}}]}}]}},...i.definitions]},r={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"windowHistoryItemFieldsForEntityCommand"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WindowHistoryItem"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeEntities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"activeEntitiesFieldsForEntityCommand"}}]}}]}},...o.definitions]},s={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"windowHistoryNavigationState"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Window"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"windowHistoryNavigationState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"canNavigateBack"}},{kind:"Field",name:{kind:"Name",value:"canNavigateForward"}},{kind:"Field",name:{kind:"Name",value:"backHistory"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"windowHistoryNavigationItem"}}]}},{kind:"Field",name:{kind:"Name",value:"forwardHistory"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"windowHistoryNavigationItem"}}]}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"windowHistoryNavigationItem"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WindowHistoryNavigationItem"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"windowHistoryIndex"}},{kind:"Field",name:{kind:"Name",value:"entity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForEntityCommand"}}]}}]}},...i.definitions]}.definitions]},l={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"activeWindows"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindows"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"activeWindowFieldsForEntityCommand"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"activeWindowFieldsForEntityCommand"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Window"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"windowFieldsForEntityCommand"}},{kind:"Field",name:{kind:"Name",value:"activeEntities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"activeEntitiesFieldsForEntityCommand"}}]}},{kind:"Field",name:{kind:"Name",value:"windowHistory"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"windowHistoryItemFieldsForEntityCommand"}}]}},{kind:"Field",name:{kind:"Name",value:"currentWindowHistoryIndex"}},{kind:"FragmentSpread",name:{kind:"Name",value:"windowHistoryNavigationState"}}]}},...a.definitions,...o.definitions,...r.definitions,...s.definitions]}.definitions]}},401371:(e,t,n)=>{"use strict";n.d(t,{Ow:()=>a,wA:()=>o,gv:()=>i});const i={parseFileLabelQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"parseFileLabelFromUrl"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ParseFileLabelFromUrlInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"parseFileLabelFromUrl"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileLabel"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"threadId"}},{kind:"Field",name:{kind:"Name",value:"linktype"}}]}}]}}]}}]},fileDetailsForChicletQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fileDetailsForChiclet"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"FileDetailsForChicletInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileDetailsForChiclet"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"fileId"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"baseUrl"}},{kind:"Field",name:{kind:"Name",value:"shareUrl"}},{kind:"Field",name:{kind:"Name",value:"shareId"}},{kind:"Field",name:{kind:"Name",value:"fileSourceDetail"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileSource"}}]}}]}}]}}]}}]},fetchShareInfoQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fetchShareInfo"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"redeemFileInput"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"RedeemFileInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"redeemFile"},arguments:[{kind:"Argument",name:{kind:"Name",value:"redeemFileInput"},value:{kind:"Variable",name:{kind:"Name",value:"redeemFileInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"fileType"}},{kind:"Field",name:{kind:"Name",value:"downloadUrl"}},{kind:"Field",name:{kind:"Name",value:"webDavUrl"}}]}}]}}]},currentFilesQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getFiles"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fileContainerId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"currentFiles"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fileContainerId"},value:{kind:"Variable",name:{kind:"Name",value:"fileContainerId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"progress"}},{kind:"Field",name:{kind:"Name",value:"baseUrl"}},{kind:"Field",name:{kind:"Name",value:"isReferencedFile"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"baseUrl"}},{kind:"Field",name:{kind:"Name",value:"fileId"}},{kind:"Field",name:{kind:"Name",value:"previewUrl"}},{kind:"Field",name:{kind:"Name",value:"previewHeight"}},{kind:"Field",name:{kind:"Name",value:"previewWidth"}},{kind:"Field",name:{kind:"Name",value:"shareUrl"}},{kind:"Field",name:{kind:"Name",value:"shareId"}},{kind:"Field",name:{kind:"Name",value:"state"}},{kind:"Field",name:{kind:"Name",value:"progressComplete"}},{kind:"Field",name:{kind:"Name",value:"permissionScope"}},{kind:"Field",name:{kind:"Name",value:"hasUploadFailed"}},{kind:"Field",name:{kind:"Name",value:"serviceName"}},{kind:"Field",name:{kind:"Name",value:"chicletBreadcrumbs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sourceTeamName"}},{kind:"Field",name:{kind:"Name",value:"sourceChannelName"}}]}}]}}]}}]},userPreferencesQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userPersonalSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filesSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileOpenPreference"}},{kind:"Field",name:{kind:"Name",value:"nonFileOpenPreferenceSelectedCount"}}]}}]}}]}}]}}]},fileShareDialogAudience:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"shareDialogAudience"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shareDialogAudienceInput"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ShareDialogAudienceInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shareDialogAudience"},arguments:[{kind:"Argument",name:{kind:"Name",value:"shareDialogAudienceInput"},value:{kind:"Variable",name:{kind:"Name",value:"shareDialogAudienceInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"recipients"}},{kind:"Field",name:{kind:"Name",value:"audienceConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"entityName"}},{kind:"Field",name:{kind:"Name",value:"audienceType"}}]}}]}}]}}]},fileDetailsByIdQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fileDetailsById"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"redeemFileByIdInput"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"RedeemFileByIdInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"redeemFileById"},arguments:[{kind:"Argument",name:{kind:"Name",value:"redeemFileByIdInput"},value:{kind:"Variable",name:{kind:"Name",value:"redeemFileByIdInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"fileType"}},{kind:"Field",name:{kind:"Name",value:"downloadUrl"}},{kind:"Field",name:{kind:"Name",value:"webDavUrl"}}]}}]}}]},fileDetailsWithSharepointIdQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fileDetailsWithSharepointId"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fileDetailsWithSharepointIdInput"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"FileDetailsWithSharepointIdInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileDetailsWithSharepointId"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fileDetailsWithSharepointIdInput"},value:{kind:"Variable",name:{kind:"Name",value:"fileDetailsWithSharepointIdInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileType"}},{kind:"Field",name:{kind:"Name",value:"webDavUrl"}},{kind:"Field",name:{kind:"Name",value:"sharepointIds"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"listItemUniqueId"}}]}}]}}]}}]},openInDesktopAsDeviceSpecificFileOpenPreferenceQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"openInDesktopAsDeviceSpecificFileOpenPreference"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"openInDesktopAsDeviceSpecificFileOpenPreference"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isDesktopSetAsDefaultFileOpenPreference"}}]}}]}}]}},a={fileDownloadDetailsUsingItemDetailsServiceQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fileDownloadDetailsUsingItemDetailsService"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ItemDetailsServiceInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileDownloadDetailsUsingItemDetailsService"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"fileType"}},{kind:"Field",name:{kind:"Name",value:"downloadUrl"}},{kind:"Field",name:{kind:"Name",value:"webDavUrl"}}]}}]}}]},fileDownloadDetailsUsingLegacyVroomServiceQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fileDownloadDetailsUsingLegacyVroomService"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"LegacyVroomServiceInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileDownloadDetailsUsingLegacyVroomService"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileType"}},{kind:"Field",name:{kind:"Name",value:"downloadUrl"}}]}}]}}]}},o={downloadFileMutation:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"downloadFile"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"downloadUrl"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"downloadFile"},arguments:[{kind:"Argument",name:{kind:"Name",value:"downloadUrl"},value:{kind:"Variable",name:{kind:"Name",value:"downloadUrl"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"downloadUrl"}}]}}]}}]}}},910952:(e,t,n)=>{"use strict";n.d(t,{zz:()=>c,nG:()=>l,Fj:()=>d});var i=n(775214),a=n(352367),o=n(892891),r=n(401371);const s=(e,t)=>{let n=null;try{n=e.readQuery({query:r.gv.currentFilesQuery,variables:{fileContainerId:t}})}catch(e){}if(!n)throw new Error("Expected initial files to be populated before a command is executed");return n.currentFiles},l=(e,t,n)=>s(n,t).find((t=>t.id===e)),c=(e,t,n)=>{const i={currentFiles:[...s(t,n).map((t=>{const n=e.findIndex((e=>e.id===t.id));if(-1===n)return t;const i=e[n];e.splice(n,1);return(0,o.merge)({},t,i)})),...e]};t.writeQuery({query:r.gv.currentFilesQuery,variables:{fileContainerId:n},data:i})},d=(e,t,n)=>{const o=s(n,t),l=o.find((t=>t.id===e));if(!l)throw(0,i.Tr)("FileUploadResolver",a.jK.NotPresent,"removecachefile",{logErrorMessage:`File with id: ${e} not found  in the cache`});const c=o.filter((t=>t.id!==e));return n.writeQuery({query:r.gv.currentFilesQuery,variables:{fileContainerId:t},data:{currentFiles:c}}),l}},380382:(e,t,n)=>{"use strict";n.d(t,{i:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"appDetailsResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appDetailsResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appInstallId"}},{kind:"Field",name:{kind:"Name",value:"isAppInstalled"}},{kind:"Field",name:{kind:"Name",value:"errorCode"}}]}}]}}]}},805373:(e,t,n)=>{"use strict";n.d(t,{k:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"customAppUploadResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"customAppUploadResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"customAppType"}}]}}]}}]}},259567:(e,t,n)=>{"use strict";n.d(t,{i:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mapCoordinateResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mapCoordinateResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"latitude"}},{kind:"Field",name:{kind:"Name",value:"longitude"}}]}}]}}]}},834954:(e,t,n)=>{"use strict";n.d(t,{F:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"messageExtensionsAppsState"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"messageExtensionsAppsState"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toggleRefetch"}}]}}]}}]}},946552:(e,t,n)=>{"use strict";n.d(t,{n:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"messageToChildResult"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"messageToChildResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"message"}}]}}]}}]}},374737:(e,t,n)=>{"use strict";n.d(t,{y:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"messageToParentResult"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"messageToParentResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"message"}}]}}]}}]}},66957:(e,t,n)=>{"use strict";n.d(t,{a:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"selectMediaResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"selectMediaResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"selectMediaError"}},{kind:"Field",name:{kind:"Name",value:"mediaUrls"}}]}}]}}]}},229183:(e,t,n)=>{"use strict";n.d(t,{s:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"tabConfigurationResult"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"threadId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"tabConfigurationResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"threadId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"tabId"}}]}}]}}]}},607823:(e,t,n)=>{"use strict";n.d(t,{s:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"taskModuleResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"taskModuleResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"card"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appIcon"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appName"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"contentType"}},{kind:"Field",name:{kind:"Name",value:"locale"}}]}},{kind:"Field",name:{kind:"Name",value:"adaptiveCardTabResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appIcon"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appName"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"contentType"}},{kind:"Field",name:{kind:"Name",value:"locale"}}]}},{kind:"Field",name:{kind:"Name",value:"text"}},{kind:"Field",name:{kind:"Name",value:"taskModuleId"}},{kind:"Field",name:{kind:"Name",value:"draftId"}},{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"reason"}},{kind:"Field",name:{kind:"Name",value:"entryPoint"}}]}}]}}]}},392696:(e,t,n)=>{"use strict";n.d(t,{R:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"viewImagesResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"viewImagesResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"viewImagesError"}},{kind:"Field",name:{kind:"Name",value:"errorCode"}}]}}]}}]}},396065:(e,t,n)=>{"use strict";n.r(t),n.d(t,{clientResolvers:()=>i.w,resolvers:()=>o,typeDefs:()=>s,useActiveWindow:()=>r.M,writeWindowsDefaults:()=>a.k});var i=n(566464),a=n(192320);const o={Subscription:{windowStateEvent:{subscribe:(e,{windowId:t},{pubsub:n})=>n.asyncIterator(`windowStateEvent-${t}`)}}};var r=n(580997),s=n(388258)},580997:(e,t,n)=>{"use strict";n.d(t,{M:()=>o});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"activeWindow"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindow"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isMainWindow"}}]}}]}}]};var a=n(575379);const o=e=>{const{data:t,error:n,loading:o}=(0,a.useQuery)(i,{variables:{windowId:e}});if(t&&!n&&!o)return t.activeWindow}},56514:(e,t,n)=>{"use strict";n.d(t,{fX:()=>r});var i=n(348154);const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"activeEntitiesFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ActiveEntities"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"subNavEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveEntities"}}]}},{kind:"Field",name:{kind:"Name",value:"headerEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveEntities"}}]}},{kind:"Field",name:{kind:"Name",value:"startEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveEntities"}}]}},{kind:"Field",name:{kind:"Name",value:"mainEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveEntities"}}]}},{kind:"Field",name:{kind:"Name",value:"endEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveEntities"}}]}},{kind:"Field",name:{kind:"Name",value:"entityExtension"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveEntities"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"entityFieldsForActiveEntities"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Entity"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"action"}},{kind:"Field",name:{kind:"Name",value:"options"}},{kind:"Field",name:{kind:"Name",value:"linkedEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"linkedEntityFields"}}]}},{kind:"Field",name:{kind:"Name",value:"entityState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"flushableByLinkedEntity"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"linkedEntityFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"LinkedEntity"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"action"}}]}}]}.definitions]},o={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"windowHistoryItemFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WindowHistoryItem"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeEntities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"activeEntitiesFields"}}]}}]}},...a.definitions]},r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"activeWindows"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindows"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"windowFields"}},{kind:"Field",name:{kind:"Name",value:"activeEntities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"activeEntitiesFields"}}]}},{kind:"Field",name:{kind:"Name",value:"windowHistory"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"windowHistoryItemFields"}}]}},{kind:"Field",name:{kind:"Name",value:"currentWindowHistoryIndex"}},{kind:"FragmentSpread",name:{kind:"Name",value:"windowHistoryNavigationState"}},{kind:"Field",name:{kind:"Name",value:"extendedEntityContainerState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"containerState"}},{kind:"Field",name:{kind:"Name",value:"isExternal"}}]}},{kind:"Field",name:{kind:"Name",value:"layoutMode"}},{kind:"Field",name:{kind:"Name",value:"isMainWindow"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"windowFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Window"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"correlation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"startTimestamp"}},{kind:"Field",name:{kind:"Name",value:"source"}}]}}]}},...a.definitions,...o.definitions,...i.ev.definitions]}},566464:(e,t,n)=>{"use strict";n.d(t,{w:()=>m});var i=n(56514),a=n(682796),o=n(492661),r=n(81749);const s={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"clientDataQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindows"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"correlation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"startTimestamp"}},{kind:"Field",name:{kind:"Name",value:"source"}}]}},{kind:"Field",name:{kind:"Name",value:"activeEntities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"activeEntitiesFieldsForClientData"}}]}},{kind:"Field",name:{kind:"Name",value:"windowHistory"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeEntities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"activeEntitiesFieldsForClientData"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"extendedEntityContainerState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"containerState"}},{kind:"Field",name:{kind:"Name",value:"isExternal"}}]}},{kind:"Field",name:{kind:"Name",value:"layoutMode"}}]}},{kind:"Field",name:{kind:"Name",value:"callingDebugTool"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"visible"}},{kind:"Field",name:{kind:"Name",value:"passiveBarHiddenParticipantsCount"}}]}},{kind:"Field",name:{kind:"Name",value:"streamPermissionsDebug"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"acknowledgementRequired"}},{kind:"Field",name:{kind:"Name",value:"acknowledged"}},{kind:"Field",name:{kind:"Name",value:"url"}}]}},{kind:"Field",name:{kind:"Name",value:"DebugConversation"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isOneOnOne"}},{kind:"Field",name:{kind:"Name",value:"chatSubType"}}]}},{kind:"Field",name:{kind:"Name",value:"activeCalls"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callId"}},{kind:"Field",name:{kind:"Name",value:"teamsCallId"}},{kind:"Field",name:{kind:"Name",value:"callUrl"}},{kind:"Field",name:{kind:"Name",value:"expiration"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"callInitiator"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"replyChainMessageId"}},{kind:"Field",name:{kind:"Name",value:"conversationId"}}]}},{kind:"Field",name:{kind:"Name",value:"activeMeetings"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"isTeamsMeeting"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"eventId"}},{kind:"Field",name:{kind:"Name",value:"useCalUid"}},{kind:"Field",name:{kind:"Name",value:"modifiedStamp"}},{kind:"Field",name:{kind:"Name",value:"scheduleType"}}]}},{kind:"Field",name:{kind:"Name",value:"recentMeetings"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"isTeamsMeeting"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"eventId"}},{kind:"Field",name:{kind:"Name",value:"useCalUid"}},{kind:"Field",name:{kind:"Name",value:"modifiedStamp"}},{kind:"Field",name:{kind:"Name",value:"scheduleType"}}]}},{kind:"Field",name:{kind:"Name",value:"pinnedMeetings"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"isTeamsMeeting"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"eventId"}},{kind:"Field",name:{kind:"Name",value:"useCalUid"}},{kind:"Field",name:{kind:"Name",value:"modifiedStamp"}},{kind:"Field",name:{kind:"Name",value:"scheduleType"}}]}},{kind:"Field",name:{kind:"Name",value:"pptSharingSession"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"sessionSlide"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"slideIndex"}},{kind:"Field",name:{kind:"Name",value:"timelineMappings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"step"}},{kind:"Field",name:{kind:"Name",value:"timelineId"}},{kind:"Field",name:{kind:"Name",value:"lastClickTime"}},{kind:"Field",name:{kind:"Name",value:"startTimeOffset"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"localSlide"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"slideIndex"}},{kind:"Field",name:{kind:"Name",value:"timelineMappings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"step"}},{kind:"Field",name:{kind:"Name",value:"timelineId"}},{kind:"Field",name:{kind:"Name",value:"lastClickTime"}},{kind:"Field",name:{kind:"Name",value:"startTimeOffset"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"slidesCount"}},{kind:"Field",name:{kind:"Name",value:"mode"}},{kind:"Field",name:{kind:"Name",value:"privateViewingEnabled"}}]}},{kind:"Field",name:{kind:"Name",value:"whiteboardSharingSession"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"content"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"shareUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"mode"}}]}},{kind:"Field",name:{kind:"Name",value:"deletedMessages"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"message"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"fromLanguage"}}]}},{kind:"Field",name:{kind:"Name",value:"diagnosticInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"diagnosticErrorCode"}},{kind:"Field",name:{kind:"Name",value:"diagnosticMessage"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"lpcState"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isLivePersonaCardInitialized"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"activeEntitiesFieldsForClientData"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ActiveEntities"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mainEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForClientData"}}]}},{kind:"Field",name:{kind:"Name",value:"endEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForClientData"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"entityFieldsForClientData"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Entity"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"action"}},{kind:"Field",name:{kind:"Name",value:"options"}},{kind:"Field",name:{kind:"Name",value:"linkedEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]}.definitions]};var l=n(980633),c=n(892891);function d(e,t){var n;let a=[];try{const t=e.readQuery({query:i.fX});a=null!==(n=null==t?void 0:t.activeWindows)&&void 0!==n?n:a}catch(e){t.warn(`cache.readQuery failed for activeWindowsQuery with ${e}`)}return(0,c.cloneDeep)(a)}function u(e,t,n,i){if(0===d(t,i).length){const i=n.newScenario(l.RG.GarbageCollection);return function(e,t){const n=t.watch({query:s,optimistic:!1,callback(){}}),i=(0,r.a)(Object.assign({leakDetector:e},t.config)),a=Array.from(t.watches);for(const e of a){const n=t.diff(Object.assign(Object.assign({},e),{returnPartialData:!0}));if(n.complete){const t=n.result;i.writeQuery(Object.assign(Object.assign({},e),{data:t}))}}const o=i.extract();t.restore(o),n()}(e,t),i.stop(),!0}return!1}const m=()=>({Query:{activeWindows:(e,t,{cache:n,loggerFactory:i})=>d(n,i.newLogger("activeWindows-query"))},Mutation:{removeWindow(e,{windowId:t},{cache:n,loggerFactory:a,commandReportingService:r}){const s=a.newLogger("removeWindow-mutation"),l=d(n,s),c=l.findIndex((e=>e.id===t));if(c>=0){const e=function(e,t,n){const a=e.splice(t,1);return n.writeQuery({query:i.fX,data:{activeWindows:e}}),a[0]}(l,c,n);return r.reportCommandEvent(e.correlation.id,o.M.Close),e}return s.warn(`Removing window that does not exist ${t}`),null},runGarbageCollection(e,t,{cache:n,coreSettings:i,leakDetectorService:o,loggerFactory:r,scenarioFactory:s}){if(function(e){const{enableGarbageCollection:t}=e.get(a.J.Core);return t}(i)){const e=r.newLogger("runGarbageCollection-mutation");return u(null==o?void 0:o.create(),n,s,e)}return!1}}})},192320:(e,t,n)=>{"use strict";n.d(t,{k:()=>a});var i=n(56514);function a(e){e.writeQuery({query:i.fX,data:{activeWindows:[]}})}},635649:(e,t,n)=>{"use strict";var i,a,o,r,s,l,c,d,u,m,p,g,h,v,f,y,S,k,b,_,C,w,T,E,I,N,A,M,F,R,P,D,j,x,O,L,U,B,W,H,$,V,z,G,q,J,K,Q,Y,X,Z,ee,te,ne,ie,ae,oe,re,se,le,ce,de,ue,me,pe,ge,he,ve,fe,ye,Se,ke,be,_e,Ce,we,Te,Ee,Ie,Ne,Ae,Me,Fe,Re,Pe,De,je,xe,Oe,Le,Ue,Be,We,He,$e,Ve,ze,Ge,qe,Je,Ke,Qe,Ye,Xe,Ze,et,tt,nt,it,at,ot,rt,st,lt,ct,dt,ut,mt,pt,gt,ht,vt,ft,yt,St,kt,bt,_t,Ct,wt,Tt,Et,It,Nt,At,Mt,Ft,Rt,Pt,Dt,jt,xt,Ot,Lt,Ut,Bt,Wt,Ht,$t,Vt,zt,Gt,qt,Jt,Kt,Qt,Yt,Xt,Zt,en,tn,nn,an,on,rn,sn,ln,cn,dn,un,mn,pn,gn,hn,vn,fn,yn,Sn,kn,bn,_n,Cn,wn,Tn,En,In,Nn,An,Mn,Fn,Rn,Pn,Dn,jn,xn,On,Ln,Un,Bn,Wn,Hn,$n,Vn,zn,Gn,qn,Jn,Kn,Qn,Yn,Xn,Zn,ei,ti,ni,ii,ai,oi,ri,si,li,ci,di,ui,mi,pi,gi,hi,vi,fi,yi,Si,ki,bi,_i,Ci,wi,Ti,Ei,Ii,Ni,Ai,Mi,Fi,Ri,Pi,Di,ji,xi,Oi,Li,Ui,Bi,Wi,Hi,$i,Vi,zi,Gi,qi,Ji,Ki,Qi,Yi,Xi,Zi,ea,ta,na,ia,aa,oa,ra,sa,la,ca,da,ua,ma,pa,ga,ha,va,fa,ya,Sa,ka,ba,_a,Ca,wa,Ta,Ea,Ia,Na,Aa,Ma,Fa,Ra,Pa,Da,ja,xa,Oa,La,Ua,Ba,Wa,Ha,$a,Va,za,Ga,qa,Ja,Ka,Qa,Ya,Xa,Za,eo,to,no,io,ao,oo,ro,so,lo,co,uo,mo,po,go,ho,vo,fo,yo,So,ko;n.r(t),n.d(t,{ParticipantChangeType:()=>i,CallPptSharingChangeSlideAction:()=>a,AllowVoicemail:()=>o,AnnotationEventType:()=>r,CallRecordingState:()=>s,CallVoiceCollectionState:()=>l,CallTranscriptState:()=>c,CallTranscriptErrorCode:()=>d,CallingScreenGalleryType:()=>u,CortanaState:()=>m,ToggleHoldCallContext:()=>p,ScreenShareControlState:()=>g,CallingAppEventSourceName:()=>h,CallingContentActionVisibility:()=>v,WindowingCoordsType:()=>f,WindowingMode:()=>y,WindowingLinkedContentType:()=>S,DialogContentType:()=>k,DialogAction:()=>b,DialogName:()=>_,NotificationType:()=>C,CallingAppEventResolutionSourceName:()=>w,CallingServiceState:()=>T,CallGroupNotification:()=>E,AltScenarioAction:()=>I,CallForwardingType:()=>N,CallForwardingTargetType:()=>A,AttendeeRestrictableModality:()=>M,MuteAllScope:()=>F,SettingsPaneCategory:()=>R,InteractionCommand:()=>P,MessageLanguageStatus:()=>D,PhoneNumberFormat:()=>j,ConsultMode:()=>x,BuddyGroupType:()=>O,ContactDataSource:()=>L,UserClassification:()=>U,ScdStatus:()=>B,VideoBackgroundImageState:()=>W,BackgroundImageContext:()=>H,ScalingMode:()=>$,CreateCompositorContext:()=>V,MediaEventType:()=>z,CallClosedCaptionsStatus:()=>G,ParkContext:()=>q,ContentCameraType:()=>J,PhoneNumberType:()=>K,MeetingRoomAppState:()=>Q,SharePreviewType:()=>Y,OverflowRoomCallState:()=>X,SystemAudioDriverState:()=>Z,ClosedCaptionsTextTrackSource:()=>ee,HolographicInteractionComponent:()=>te,EnvironmentSupport:()=>ne,StreamingAppState:()=>ie,AppDevicePermissionType:()=>ae,MeetingRoomRemoteControlLayoutType:()=>oe,ContactsSyncSource:()=>re,ContactsSyncWorkflowStatus:()=>se,GestureBasedReactionServiceState:()=>le,CustomAppType:()=>ce,DebugBroadcastStateStatus:()=>de,DebugBroadcastParticipantRole:()=>ue,PptSharingMode:()=>me,TranslationStatus:()=>pe,ChatDisabledContextReason:()=>ge,DeviceTypeInput:()=>he,DisallowedToPostReason:()=>ve,CalendarMeetingScheduleType:()=>fe,ClientChannelType:()=>ye,TeamMemberRole:()=>Se,ChannelPostPermissions:()=>ke,GeneralChannelPosting:()=>be,LocationType:()=>_e,CalendarAppointmentType:()=>Ce,AvailabilityFreeBusyType:()=>we,LayoutType:()=>Te,StatusBarMessageType:()=>Ee,EntityType:()=>Ie,EntityAction:()=>Ne,EntityVisibilityState:()=>Ae,EntityStateTransition:()=>Me,SupportedViewEntities:()=>Fe,LayoutModes:()=>Re,NavigationDirection:()=>Pe,CorrelationSourceHint:()=>De,ExtendedContainerState:()=>je,CustomLayoutSelection:()=>xe,MeetingRoomLayoutSelection:()=>Oe,StaticTabId:()=>Le,VideoScanType:()=>Ue,BroadcastStreamType:()=>Be,BroadcastLayoutType:()=>We,CaptionFontSizeType:()=>He,BroadcastSectionType:()=>$e,FluidSourceType:()=>Ve,AppInstallScope:()=>ze,PlatformAppsFetchSource:()=>Ge,DebugBroadcastType:()=>qe,BreakoutRoomActionState:()=>Je,FileViewServiceName:()=>Ke,TaskModuleEntryPoints:()=>Qe,TaskModuleClosedReason:()=>Ye,VideoEffect:()=>Xe,VideoEffectStateType:()=>Ze,WebinarAccessPolicy:()=>et,WebinarQuestionnaireType:()=>tt,RegistrationOperationType:()=>nt,CallParticipantKind:()=>it,SchedulingServiceMeetingPromiseState:()=>at,AttachmentType:()=>ot,AttendeeType:()=>rt,UserRole:()=>st,AttendeeGroupType:()=>lt,MeetingAgendaType:()=>ct,MeetingAgendaState:()=>dt,PinnedConversationItemType:()=>ut,VideoAppPostMessageEvent:()=>mt,DisplayWaterMark:()=>pt,PtzControlCommand:()=>gt,TranscriptEditType:()=>ht,TranscriptDownloadFormat:()=>vt,VideoRotationDegree:()=>ft,SystemAudioSupport:()=>yt,EmergencyLocationType:()=>St,PtzErrorReason:()=>kt,PtzSessionTerminatedReason:()=>bt,CallCoachStatus:()=>_t,CallClosedCaptionStatus:()=>Ct,ArtifactType:()=>wt,ActionItemsModelInsightType:()=>Tt,ActionItemConfidence:()=>Et,ActionItemOwnershipType:()=>It,TranslationStatusV2:()=>Nt,CardCacheOperationType:()=>At,ScreenSharingControlStateAsViewer:()=>Mt,SharingSourceType:()=>Ft,BroadcastStatus:()=>Rt,CallAbortReason:()=>Pt,NoiseSuppressionSupport:()=>Dt,NoiseSuppressionMode:()=>jt,CallingIntentType:()=>xt,MeetingJoinType:()=>Ot,FeedbackType:()=>Lt,QuestionnaireItemType:()=>Ut,FeedbackCallType:()=>Bt,AudioUsageMode:()=>Wt,MeetingArtifactType:()=>Ht,ClientDeviceType:()=>$t,BotSourceType:()=>Vt,StreamType:()=>zt,StreamLabel:()=>Gt,RoomBookingType:()=>qt,Availability:()=>Jt,Activity:()=>Kt,UserFlwPresence:()=>Qt,ChatType:()=>Yt,InteropConversationStatus:()=>Xt,MeetingChatPolicy:()=>Zt,DisableReasonCode:()=>en,ClaimedConversationImportState:()=>tn,MeetingType:()=>nn,EscalationModality:()=>an,MessageStatus:()=>on,MessageImportance:()=>rn,SmsDeliveryReportKey:()=>sn,CallLogSessionType:()=>ln,CallLogCallType:()=>cn,CallLogCallState:()=>dn,CallDirection:()=>un,AppointmentType:()=>mn,BroadcastMeetingAccessLevel:()=>pn,FreeBusyType:()=>gn,MeetingResponseType:()=>hn,MeetingStatus:()=>vn,PhoneType:()=>fn,TeamType:()=>yn,TeamAccessType:()=>Sn,ChannelType:()=>kn,GiphyRatingType:()=>bn,AllowedSenderType:()=>_n,FileChicletState:()=>Cn,DeepLinkChicletState:()=>wn,DeviceType:()=>Tn,AlertSeverity:()=>En,AlertActionType:()=>In,AlertType:()=>Nn,PptSharingSource:()=>An,ShareableContentType:()=>Mn,SharingLayoutMode:()=>Fn,PptSharingContentMode:()=>Rn,WhiteboardSharingContentMode:()=>Pn,CallTranscriptEntryType:()=>Dn,BroadcastParticipantRole:()=>jn,PresenceSource:()=>xn,StatusNoteExpiry:()=>On,MeetingSurface:()=>Ln,ConfigurableTabContext:()=>Un,StaticTabContext:()=>Bn,AppPermissionNodeType:()=>Wn,AppDefaultInstallScope:()=>Hn,AppGroupCapability:()=>$n,MessageExtensionCommandType:()=>Vn,MessageExtensionCommandContextType:()=>zn,MessageExtensionInputType:()=>Gn,MeetingReactionType:()=>qn,GestureReactionType:()=>Jn,GestureReactionStatus:()=>Kn,UserRoleInEmergencyCall:()=>Qn,UserRoleInConsultCall:()=>Yn,HolographicDeviceType:()=>Xn,MeetingPanelLocation:()=>Zn,CallHealthState:()=>ei,VirtualDesktopInfrastructureConnectedState:()=>ti,MessageImportanceInGraphFormat:()=>ni,UserIdentityType:()=>ii,ApplicationIdentityType:()=>ai,ConversationIdentityType:()=>oi,ContentType:()=>ri,ReactionType:()=>si,OptionValueType:()=>li,OptionExternalFeedType:()=>ci,OptionPersonType:()=>di,AmsItemType:()=>ui,AuthenticationAccountType:()=>mi,AuthenticationUserRole:()=>pi,AuthenticationState:()=>gi,BroadcastType:()=>hi,CalendarAvailabilityType:()=>vi,SuggestionTimeQuality:()=>fi,SchedulingServiceEventType:()=>yi,SharingEntityType:()=>Si,SharingType:()=>ki,MeetingRecommendationEntityType:()=>bi,ProvenanceType:()=>_i,CalendarFormSlotType:()=>Ci,CalendarFormErrorType:()=>wi,CallBlockingAction:()=>Ti,TranslationRequestState:()=>Ei,BlobType:()=>Ii,LinkType:()=>Ni,FileUploadStatus:()=>Ai,OneDriveItemType:()=>Mi,AudienceType:()=>Fi,MembersAndRelatedContactsError:()=>Ri,RelatedContactStatus:()=>Pi,RelatedContactError:()=>Di,LiveStreamPlaybackState:()=>ji,LiveStreamPlaybackError:()=>xi,TeamsForCourseStatus:()=>Oi,CourseMembersAndOwnersStatus:()=>Li,MeetingOptionsError:()=>Ui,MeetingOptionsPredicateOperator:()=>Bi,MessageSize:()=>Wi,TranslationFeedbackType:()=>Hi,VirtualEventType:()=>$i,VirtualEventState:()=>Vi,WebinarStatus:()=>zi,WebinarParticipantRole:()=>Gi,WebinarField:()=>qi,SettingsComponentType:()=>Ji,WidgetType:()=>Ki,ActionType:()=>Qi,SettingsCategory:()=>Yi,AppCapability:()=>Xi,AppInstallationStates:()=>Zi,InstalledAppsUpdateEventType:()=>ea,TaskModuleUpdateType:()=>ta,InstalledAppSortType:()=>na,BannerNotificationCause:()=>ia,BannerNotificationIntentLevel:()=>aa,BannerNotificationActionType:()=>oa,BiometricVoiceEnrollmentStatus:()=>ra,MessageExtensionInvokeCacheFetchPolicy:()=>sa,Theme:()=>la,BotMessagePreviewAction:()=>ca,AttachmentLayout:()=>da,ResultTypes:()=>ua,CommandContext:()=>ma,BotAuthResultType:()=>pa,AppBasedLinkAppResultType:()=>ga,AppBasedLinkCachePolicyType:()=>ha,AppBasedLinkPreviewType:()=>va,ChannelMessageEventType:()=>fa,PostType:()=>ya,LoadDirection:()=>Sa,ChatTypeFilter:()=>ka,EmotionKey:()=>ba,EmotionAction:()=>_a,ChatListEventType:()=>Ca,SendMessageAction:()=>wa,ReportConcernReason:()=>Ta,ReportConcernContext:()=>Ea,ComposeLanguagePromptEvent:()=>Ia,ConnectedCalendarSource:()=>Na,SyncBannerUserActionType:()=>Aa,DlResultError:()=>Ma,ExternalAccountProvider:()=>Fa,ConnectedAccountRequestSource:()=>Ra,SortColumn:()=>Pa,SortDirection:()=>Da,RedeemIssueType:()=>ja,InviteLinkType:()=>xa,UserTheme:()=>Oa,UserExperiencePreferencesCategory:()=>La,ClientPreferencesCategory:()=>Ua,PerformanceMode:()=>Ba,ReportType:()=>Wa,PeoplePickerFor:()=>Ha,PlatformTabEventType:()=>$a,DocumentViewerFileType:()=>Va,PlatformTabSettingsTypes:()=>za,PlatformTabsQueryType:()=>Ga,SearchSuggestionEntityType:()=>qa,SearchSuggestionGroupType:()=>Ja,SearchSuggestionActionType:()=>Ka,SearchSuggestionEntitySource:()=>Qa,SearchHistoryAction:()=>Ya,SearchSuggestionScenario:()=>Xa,SortOrderSources:()=>Za,HostTheme:()=>eo,StoreItemKind:()=>to,StoreItemAttribute:()=>no,StoreItemOrder:()=>io,StoreItemFeature:()=>ao,SubstrateEntityType:()=>oo,SystemSettingId:()=>ro,TeamJoinState:()=>so,TeamSettingsProperty:()=>lo,TenantInvitationUserType:()=>co,TenantInvitationScenario:()=>uo,UpdateClientStateSource:()=>mo,UserPreferencesCategory:()=>po,TranslationPreference:()=>go,OneDriveForBusinessAvailability:()=>ho,EmailNotificationOptions:()=>vo,EmailDigestOptions:()=>fo,MeetingChatNotificationValue:()=>yo,FileOpenPreference:()=>So,NotificationSettingsOptions:()=>ko}),function(e){e.Add="Add",e.Remove="Remove",e.Update="Update"}(i||(i={})),function(e){e.Next="Next",e.Prev="Prev",e.GoTo="GoTo"}(a||(a={})),function(e){e.AlwaysEnabled="AlwaysEnabled",e.AlwaysDisabled="AlwaysDisabled",e.UserOverride="UserOverride"}(o||(o={})),function(e){e.Added="Added",e.Removed="Removed",e.AnnotationSharerWindow="AnnotationSharerWindow"}(r||(r={})),function(e){e.None="None",e.Pending="Pending",e.Recording="Recording",e.Paused="Paused",e.Stopping="Stopping",e.Failed="Failed",e.Disabled="Disabled"}(s||(s={})),function(e){e.None="None",e.Started="Started",e.Failed="Failed"}(l||(l={})),function(e){e.None="None",e.Disabled="Disabled",e.Pending="Pending",e.Waiting="Waiting",e.Started="Started",e.Stopped="Stopped",e.Failed="Failed"}(c||(c={})),function(e){e.None="None",e.EmptySignatureList="EmptySignatureList",e.LessthanExpectedSignature="LessthanExpectedSignature",e.FailedinFetchingVoiceSignture="FailedinFetchingVoiceSignture",e.FailedinFetchingFaceSignture="FailedinFetchingFaceSignture",e.SignatureStorageError="SignatureStorageError",e.InRoomOnlyDistinguish="InRoomOnlyDistinguish",e.UnsupportedScenario="UnsupportedScenario",e.ICalUidNotFound="ICalUidNotFound",e.CrossTenantOrDSFailure="CrossTenantOrDSFailure",e.AttributionNotSupported="AttributionNotSupported",e.RegionNotSupported="RegionNotSupported"}(d||(d={})),function(e){e.Audience="Audience",e.Grid="Grid",e.LargeGrid="LargeGrid"}(u||(u={})),function(e){e.Ready="Ready",e.Listening="Listening",e.Thinking="Thinking",e.Speaking="Speaking"}(m||(m={})),function(e){e.Hold="Hold",e.Resume="Resume",e.Transfer="Transfer",e.ConsultativeTransfer="ConsultativeTransfer"}(p||(p={})),function(e){e.Request="Request",e.Release="Release"}(g||(g={})),function(e){e.CallingAppEventsServiceSubscribe="CallingAppEventsServiceSubscribe",e.CreateNotificationWithActions="CreateNotificationWithActions",e.DialogOpen="DialogOpen",e.MultiWindowNavigation="MultiWindowNavigation",e.NavigateToConversationPromiseChat="NavigateToConversationPromiseChat",e.NavigateToConversationPromiseChatList="NavigateToConversationPromiseChatList",e.NavigateToDefaultState="NavigateToDefaultState",e.NavigateToDefaultWithFallbacks="NavigateToDefaultWithFallbacks",e.NavigateToLastChatState="NavigateToLastChatState",e.NavigateToLastTeamState="NavigateToLastTeamState",e.NavigateToMainWindow="NavigateToMainWindow"}(h||(h={})),function(e){e.Show="Show",e.Hide="Hide"}(v||(v={})),function(e){e.Calling="Calling",e.RigelGallery="RigelGallery",e.RigelContent="RigelContent",e.RigelGalleryAndContent="RigelGalleryAndContent"}(f||(f={})),function(e){e.SingleWindow="SingleWindow",e.MultiWindow="MultiWindow"}(y||(y={})),function(e){e.Chat="Chat"}(S||(S={})),function(e){e.DialogTitle="DialogTitle",e.DialogText="DialogText",e.PrimaryButton="PrimaryButton",e.ConfirmMessageTitle="ConfirmMessageTitle",e.ConfirmMessageHtmlBody="ConfirmMessageHtmlBody",e.OkButtonText="OkButtonText"}(k||(k={})),function(e){e.PostConfirm="PostConfirm",e.PreClose="PreClose",e.PostClose="PostClose",e.PreActiveElementIds="PreActiveElementIds",e.CloseByDocument="CloseByDocument"}(b||(b={})),function(e){e.Alert="Alert",e.CallingConfirm="CallingConfirm",e.CallingUnparkCall="CallingUnparkCall",e.MeetingJoinCrossCloud="MeetingJoinCrossCloud",e.OptionsSettings="OptionsSettings",e.PrejoinOverlay="PrejoinOverlay",e.UserMedia="UserMedia",e.CallingRestartRecomendedError="CallingRestartRecomendedError",e.WindowingError="WindowingError"}(_||(_={})),function(e){e.OneToOne="OneToOne",e.GroupCall="GroupCall",e.Meeting="Meeting",e.Chat="Chat",e.Reply="Reply",e.ReplyToReply="ReplyToReply",e.Like="Like",e.Mention="Mention",e.Download="Download",e.AppUpdated="AppUpdated",e.NeedMoreDiskSpace="NeedMoreDiskSpace",e.TeamMembershipChange="TeamMembershipChange",e.Follow="Follow",e.OneToOnePstn="OneToOnePstn",e.Thirdparty="Thirdparty",e.MessageSendFailed="MessageSendFailed",e.CallTransferFailed="CallTransferFailed",e.ShareFromChat="ShareFromChat",e.Inferred="Inferred",e.Trending="Trending",e.MeetingWentLive="MeetingWentLive",e.PresenceStatus="PresenceStatus",e.Reaction="Reaction",e.Priority="Priority",e.TeamsTasks="TeamsTasks",e.Dlp="Dlp",e.TeamsEngagementActivity="TeamsEngagementActivity",e.MsGraph="MsGraph",e.StaffHub="StaffHub",e.CallAnsweredElsewhere="CallAnsweredElsewhere",e.CallSafeTransferRingback="CallSafeTransferRingback",e.SkypeConsumerCall="SkypeConsumerCall",e.SpamCall="SpamCall",e.Default="Default"}(C||(C={})),function(e){e.WindowingCommandingError="WindowingCommandingError",e.WindowingCommandingSuccess="WindowingCommandingSuccess"}(w||(w={})),function(e){e.Failed="Failed",e.NotReady="NotReady",e.Ready="Ready"}(T||(T={})),function(e){e.Ring="Ring",e.Mute="Mute",e.Banner="Banner"}(E||(E={})),function(e){e.Abandon="Abandon",e.Fail="Fail",e.StartMarker="StartMarker",e.Stop="Stop",e.StopMarker="StopMarker"}(I||(I={})),function(e){e.Immediate="Immediate",e.Simultaneous="Simultaneous",e.Unanswered="Unanswered"}(N||(N={})),function(e){e.Voicemail="Voicemail",e.SingleTarget="SingleTarget",e.MyDelegates="MyDelegates",e.DoNothing="DoNothing",e.Group="Group"}(A||(A={})),function(e){e.Audio="Audio",e.Video="Video"}(M||(M={})),function(e){e.All="All",e.Presenters="Presenters",e.Attendees="Attendees"}(F||(F={})),function(e){e.CallGroup="CallGroup",e.Calls="Calls",e.Devices="Devices",e.PremiumBenefits="PremiumBenefits"}(R||(R={})),function(e){e.Pause="Pause",e.Resume="Resume",e.Goto="Goto",e.Cards="Cards"}(P||(P={})),function(e){e.Success="Success",e.DetectFailed="DetectFailed",e.Timeout="Timeout",e.TextTooShort="TextTooShort",e.Unsupported="Unsupported",e.UnknownError="UnknownError",e.LowConfidence="LowConfidence",e.NoContent="NoContent"}(D||(D={})),function(e){e.E164="E164",e.INTERNATIONAL="INTERNATIONAL",e.NATIONAL="NATIONAL",e.RFC3966="RFC3966"}(j||(j={})),function(e){e.Chat="Chat",e.TeamsCall="TeamsCall"}(x||(x={})),function(e){e.Custom="Custom",e.Favorites="Favorites",e.SfBFavorites="SfBFavorites",e.Tagged="Tagged",e.OtherContacts="OtherContacts",e.TflContacts="TflContacts",e.TflBlocked="TflBlocked"}(O||(O={})),function(e){e.Exchange="Exchange",e.BuddyList="BuddyList",e.MiddleTier="MiddleTier"}(L||(L={})),function(e){e.Principal="Principal",e.Manager="Manager",e.Peer="Peer",e.InOrg="InOrg"}(U||(U={})),function(e){e.Error="Error",e.Started="Started",e.Captured="Captured",e.Processed="Processed",e.Stopped="Stopped",e.Updated="Updated"}(B||(B={})),function(e){e.IN_PROGRESS="IN_PROGRESS",e.NONE="NONE",e.SUCCESS="SUCCESS",e.FAIL="FAIL"}(W||(W={})),function(e){e.BackgroundEffect="BackgroundEffect",e.BackgroundAPL="BackgroundAPL"}(H||(H={})),function(e){e.Stretch="Stretch",e.Crop="Crop",e.Fit="Fit"}($||($={})),function(e){e.Unspecified="Unspecified",e.AttendeeView="AttendeeView",e.PptSharing="PptSharing",e.IncomingScreenShare="IncomingScreenShare",e.IncomingVideo="IncomingVideo",e.LocalPreview="LocalPreview"}(V||(V={})),function(e){e.MediaPaused="MediaPaused",e.MediaPlayed="MediaPlayed",e.MediaStopped="MediaStopped",e.MediaSeeked="MediaSeeked",e.MediaVolumeChanged="MediaVolumeChanged"}(z||(z={})),function(e){e.Failed="Failed",e.None="None",e.Pending="Pending",e.Started="Started",e.Stopped="Stopped"}(G||(G={})),function(e){e.Team="Team",e.SharedLine="SharedLine",e.ServerHold="ServerHold"}(q||(q={})),function(e){e.HdmiIngest="HdmiIngest",e.WhiteboardCamera="WhiteboardCamera"}(J||(J={})),function(e){e.None="None",e.Home="Home",e.Mobile="Mobile",e.Work="Work"}(K||(K={})),function(e){e.Idle="Idle",e.AdHoc="AdHoc",e.Incoming="Incoming",e.InACall="InACall",e.CQF="CQF",e.Cortana="Cortana"}(Q||(Q={})),function(e){e.Screen="Screen",e.App="App"}(Y||(Y={})),function(e){e.hold="hold",e.active="active"}(X||(X={})),function(e){e.NotInstalled="NotInstalled",e.InProgress="InProgress",e.Installed="Installed",e.Unavailable="Unavailable",e.UpdateAvailable="UpdateAvailable",e.MustUpdate="MustUpdate"}(Z||(Z={})),function(e){e.Ai="Ai",e.Cart="Cart",e.Cea708="Cea708"}(ee||(ee={})),function(e){e.DataChannel="DataChannel",e.AnnotationReady="AnnotationReady",e.ClientInForeground="ClientInForeground",e.AnnotationLimit="AnnotationLimit",e.Tracking="Tracking"}(te||(te={})),function(e){e.NotSupported="NotSupported",e.FullySupported="FullySupported",e.LightweightOnly="LightweightOnly"}(ne||(ne={})),function(e){e.Created="Created",e.Ready="Ready",e.Started="Started",e.Stopping="Stopping",e.Stopped="Stopped"}(ie||(ie={})),function(e){e.media="media",e.geolocation="geolocation",e.notifications="notifications",e.midi="midi",e.openExternal="openExternal"}(ae||(ae={})),function(e){e.Grid="Grid",e.Audience="Audience",e.LargeGrid="LargeGrid",e.Content="Content",e.PeopleAndContent="PeopleAndContent"}(oe||(oe={})),function(e){e.Outlook="Outlook",e.Skype="Skype",e.Google="Google",e.Device="Device"}(re||(re={})),function(e){e.SyncStarted="SyncStarted",e.SyncFailed="SyncFailed",e.SyncCompleted="SyncCompleted",e.UnsyncStarted="UnsyncStarted",e.UnsyncFailed="UnsyncFailed",e.UnsyncCompleted="UnsyncCompleted"}(se||(se={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled",e.Unsupported="Unsupported"}(le||(le={})),function(e){e.sideload="sideload",e.tenant="tenant",e.staging="staging"}(ce||(ce={})),function(e){e.NotStarted="NotStarted",e.Started="Started",e.Starting="Starting",e.Stopped="Stopped",e.Stopping="Stopping"}(de||(de={})),function(e){e.Producer="Producer",e.Contributor="Contributor",e.Attendee="Attendee",e.None="None"}(ue||(ue={})),function(e){e.Unestablished="Unestablished",e.Viewing="Viewing",e.BrowsingPrivately="BrowsingPrivately",e.Presenting="Presenting"}(me||(me={})),function(e){e.Done="Done",e.InProcess="InProcess",e.UnknownError="UnknownError",e.ScoreTooLow="ScoreTooLow",e.TooManyCharacters="TooManyCharacters",e.NotStarted="NotStarted"}(pe||(pe={})),function(e){e.ChatDisabledDueToIB="ChatDisabledDueToIB",e.SmsChatDisabledDueToLicense="SmsChatDisabledDueToLicense",e.SmsChatDisabledDueToRNLError="SmsChatDisabledDueToRNLError",e.ChatDisabledDueToBotStatus="ChatDisabledDueToBotStatus",e.ChatDisabledDueToRecipientTeamsUpgradePolicy="ChatDisabledDueToRecipientTeamsUpgradePolicy",e.UnknownReason="UnknownReason"}(ge||(ge={})),function(e){e.Camera="Camera",e.Microphone="Microphone",e.Speaker="Speaker"}(he||(he={})),function(e){e.None="None",e.MutedTeamMember="MutedTeamMember",e.OnlyOwnersCanPost="OnlyOwnersCanPost"}(ve||(ve={})),function(e){e.private="private",e.online="online",e.event="event",e.inPerson="inPerson",e.channel="channel",e.broadcast="broadcast"}(fe||(fe={})),function(e){e.Standard="Standard",e.Private="Private",e.Shared="Shared"}(ye||(ye={})),function(e){e.Admin="Admin",e.Guest="Guest",e.Undefined="Undefined",e.User="User"}(Se||(Se={})),function(e){e.Everyone="Everyone",e.EveryoneButGuests="EveryoneButGuests",e.Moderators="Moderators"}(ke||(ke={})),function(e){e.AnyonePost="AnyonePost",e.AnyoneWithWarning="AnyoneWithWarning",e.OwnersPost="OwnersPost"}(be||(be={})),function(e){e.Room="Room",e.Building="Building"}(_e||(_e={})),function(e){e.Single="Single",e.Occurrence="Occurrence",e.Exception="Exception",e.RecurringMaster="RecurringMaster"}(Ce||(Ce={})),function(e){e.Free="Free",e.Tentative="Tentative",e.Busy="Busy",e.Oof="Oof",e.WorkingElsewhere="WorkingElsewhere",e.Unknown="Unknown"}(we||(we={})),function(e){e.Content="Content",e.ContentWithGallery="ContentWithGallery",e.Gallery="Gallery",e.None="None"}(Te||(Te={})),function(e){e.Info="Info",e.Error="Error"}(Ee||(Ee={})),function(e){e.accounts="accounts",e.activity="activity",e.addchannel="addchannel",e.addmember="addmember",e.addmembernewteam="addmembernewteam",e.agendapage="agendapage",e.alertdialog="alertdialog",e.alttext="alttext",e.annotation="annotation",e.attendeeview="attendeeview",e.bannerNotification="bannerNotification",e.blank="blank",e.open3sfeedback="open3sfeedback",e.schoolteams="schoolteams",e.tabapps="tabapps",e.brbfeedbackdialog="brbfeedbackdialog",e.breakoutrooms="breakoutrooms",e.broadcastfeedback="broadcastfeedback",e.broadcastliveevent="broadcastliveevent",e.broadcastqna="broadcastqna",e.broadcasts="broadcasts",e.calendar="calendar",e.callablechannels="callablechannels",e.callingdeeplink="callingdeeplink",e.calls="calls",e.callscontent="callscontent",e.callsgallery="callsgallery",e.callsgalleryandcontent="callsgalleryandcontent",e.callsmonitor="callsmonitor",e.callskeypad="callskeypad",e.callsmain="callsmain",e.callstransfer="callstransfer",e.cameraeffects="cameraeffects",e.cast="cast",e.channelconnectors="channelconnectors",e.channeldeeplink="channeldeeplink",e.channeldelete="channeldelete",e.channeledit="channeledit",e.channelemail="channelemail",e.channelmanage="channelmanage",e.channels="channels",e.chats="chats",e.coachreport="coachreport",e.codesnippet="codesnippet",e.connectedcalendardialog="connectedcalendardialog",e.callingconfirmdialog="callingconfirmdialog",e.contactssync="contactssync",e.contentcamerasetup="contentcamerasetup",e.coursecalendar="coursecalendar",e.courseteams="courseteams",e.customapp="customapp",e.default="default",e.deletechat="deletechat",e.devicesettings="devicesettings",e.dlp="dlp",e.error="error",e.esp="esp",e.extensions="extensions",e.faceenrollment="faceenrollment",e.file="file",e.fileopensettings="fileopensettings",e.fluid="fluid",e.flyout="flyout",e.gallery="gallery",e.galleryImages="galleryImages",e.guardians="guardians",e.giphyconsent="giphyconsent",e.hybridplaceholder="hybridplaceholder",e.hyperlink="hyperlink",e.identity="identity",e.invisionwhiteboard="invisionwhiteboard",e.leavechat="leavechat",e.lobnotifications="lobnotifications",e.locationapi="locationapi",e.selectpeoplepicker="selectpeoplepicker",e.licenses="licenses",e.linkedin="linkedin",e.manageapps="manageapps",e.mediastreams="mediastreams",e.meet="meet",e.meetinganalytics="meetinganalytics",e.meetingdetails="meetingdetails",e.meetingjoincrossclouddialog="meetingjoincrossclouddialog",e.meetingoptionscreatedialog="meetingoptionscreatedialog",e.meetings="meetings",e.meetingsettings="meetingsettings",e.meetingstream="meetingstream",e.messagedraft="messagedraft",e.messages="messages",e.notes="notes",e.noux="noux",e.email="email",e.meetingroomconsolecall="meetingroomconsolecall",e.optionssettingsdialog="optionssettingsdialog",e.pinnedchatsmaxreached="pinnedchatsmaxreached",e.pinnedconversationitems="pinnedconversationitems",e.platformapp="platformapp",e.platformappdetails="platformappdetails",e.platformapps="platformapps",e.platformsubscriptionplans="platformsubscriptionplans",e.stagedapps="stagedapps",e.platformtab="platformtab",e.platformauthconsentdialog="platformauthconsentdialog",e.platformStage="platformStage",e.prejoinoverlaydialog="prejoinoverlaydialog",e.ptzextension="ptzextension",e.registration="registration",e.removechatuser="removechatuser",e.reportConcern="reportConcern",e.roomremote="roomremote",e.roster="roster",e.schedulingform="schedulingform",e.shareformdialog="shareformdialog",e.search="search",e.selectMediaApi="selectMediaApi",e.settingsstore="settingsstore",e.survey="survey",e.floodgate="floodgate",e.sharechatlink="sharechatlink",e.shareMeetingInfo="shareMeetingInfo",e.signoutdialog="signoutdialog",e.stagecontent="stagecontent",e.store="store",e.streamcamera="streamcamera",e.taskmodule="taskmodule",e.teamcreate="teamcreate",e.teamdeeplink="teamdeeplink",e.teamdiscover="teamdiscover",e.teamedit="teamedit",e.teamgallery="teamgallery",e.teamjoin="teamjoin",e.teamleave="teamleave",e.teamjoincode="teamjoincode",e.teammanage="teammanage",e.teammanagetags="teammanagetags",e.teampicture="teampicture",e.teamrenewal="teamrenewal",e.teams="teams",e.teamsettings="teamsettings",e.toasts="toasts",e.tpndialog="tpndialog",e.transcript="transcript",e.transcriptcontent="transcriptcontent",e.transcripttab="transcripttab",e.translationfeedback="translationfeedback",e.unparkcalldialog="unparkcalldialog",e.updategroupchatavatar="updategroupchatavatar",e.updatemsaprofileavatardialog="updatemsaprofileavatardialog",e.updatemsaprofilenamedialog="updatemsaprofilenamedialog",e.usermediadialog="usermediadialog",e.twowaysmsfriendlyname="twowaysmsfriendlyname",e.videobackgrounds="videobackgrounds",e.videoeffectscustomization="videoeffectscustomization",e.videoeffectsmoreview="videoeffectsmoreview",e.viewImagesApi="viewImagesApi",e.virtualevents="virtualevents",e.voiceenrollment="voiceenrollment",e.workflows="workflows",e.tflfre="tflfre",e.windowingerrordialog="windowingerrordialog",e.restartrecomendeddialog="restartrecomendeddialog",e.stagingroomstartmeetingconfirmationdialog="stagingroomstartmeetingconfirmationdialog"}(Ie||(Ie={})),function(e){e.config="config",e.create="create",e.default="default",e.delete="delete",e.error="error",e.health="health",e.info="info",e.join="join",e.list="list",e.manage="manage",e.mutate="mutate",e.signin="signin",e.update="update",e.view="view"}(Ne||(Ne={})),function(e){e.show="show",e.showWithoutFocusing="showWithoutFocusing",e.hide="hide",e.toggle="toggle"}(Ae||(Ae={})),function(e){e.none="none",e.flush="flush",e.forceFlush="forceFlush",e.flow="flow",e.forceFlow="forceFlow",e.new="new",e.extend="extend"}(Me||(Me={})),function(e){e.subNavEntity="subNavEntity",e.headerEntity="headerEntity",e.startEntity="startEntity",e.mainEntity="mainEntity",e.endEntity="endEntity"}(Fe||(Fe={})),function(e){e.minimal="minimal",e.focus="focus",e.standard="standard"}(Re||(Re={})),function(e){e.back="back",e.forward="forward"}(Pe||(Pe={})),function(e){e.Activity="Activity",e.NonHybridLeftRail="NonHybridLeftRail"}(De||(De={})),function(e){e.Closed="Closed",e.Open="Open",e.Confirmed="Confirmed",e.Error="Error"}(je||(je={})),function(e){e.Grid="Grid",e.Audience="Audience",e.LargeGrid="LargeGrid",e.NativeLargeGrid="NativeLargeGrid"}(xe||(xe={})),function(e){e.ContentAndPeople="ContentAndPeople",e.ContentOnly="ContentOnly",e.PeopleOnly="PeopleOnly"}(Oe||(Oe={})),function(e){e.organization="organization"}(Le||(Le={})),function(e){e.whiteboard="whiteboard",e.document="document",e.video="video",e.none="none"}(Ue||(Ue={})),function(e){e.Video="Video",e.ScreenSharing="ScreenSharing"}(Be||(Be={})),function(e){e.Single="Single",e.TwoLargeLeft="TwoLargeLeft"}(We||(We={})),function(e){e.Small="Small",e.Medium="Medium",e.Large="Large"}(He||(He={})),function(e){e.Single="Single",e.Left="Left",e.Right="Right"}($e||($e={})),function(e){e.Compose="Compose",e.Paste="Paste"}(Ve||(Ve={})),function(e){e.GroupChat="GroupChat",e.Personal="Personal",e.Team="Team"}(ze||(ze={})),function(e){e.Cache="Cache",e.Network="Network"}(Ge||(Ge={})),function(e){e.QuickStart="QuickStart",e.BYOE="BYOE",e.QuickStartPushToStream="QuickStartPushToStream",e.Overflow="Overflow"}(qe||(qe={})),function(e){e.Opening="Opening",e.OpeningFailed="OpeningFailed",e.Closing="Closing",e.ClosingFailed="ClosingFailed",e.Deleting="Deleting",e.DeletingFailed="DeletingFailed"}(Je||(Je={})),function(e){e.aggregatefiles="aggregatefiles",e.customspo="customspo",e.downloads="downloads",e.p2p="p2p",e.personal="personal",e.recent="recent",e.teams="teams"}(Ke||(Ke={})),function(e){e.AdaptiveCardTab="AdaptiveCardTab",e.Card="Card",e.ContentBubble="ContentBubble",e.DeepLink="DeepLink",e.MessageExtension="MessageExtension",e.PlatformExtensionTab="PlatformExtensionTab",e.ShareToOutlook="ShareToOutlook"}(Qe||(Qe={})),function(e){e.CancelledByUser="CancelledByUser",e.Done="Done"}(Ye||(Ye={})),function(e){e.AutoAdjust="AutoAdjust",e.BackgroundBlur="BackgroundBlur",e.EyeContact="EyeContact",e.Off="Off",e.TouchUp="TouchUp",e.WhiteboardCleanup="WhiteboardCleanup",e.WhiteboardZoom="WhiteboardZoom",e.WhiteboardZoomAndCleanup="WhiteboardZoomAndCleanup"}(Xe||(Xe={})),function(e){e.Error="Error",e.Loading="Loading",e.Off="Off",e.On="On",e.Unavailable="Unavailable"}(Ze||(Ze={})),function(e){e.Everyone="Everyone",e.EveryoneInCompany="EveryoneInCompany",e.None="None"}(et||(et={})),function(e){e.MultiChoice="MultiChoice",e.MultiLineText="MultiLineText",e.SingleChoice="SingleChoice",e.SingleLineText="SingleLineText"}(tt||(tt={})),function(e){e.CreateEventEnableRegistration="CreateEventEnableRegistration",e.GetRegistrationInformation="GetRegistrationInformation",e.RemoveRegistration="RemoveRegistration",e.UpdateEventDisableRegistration="UpdateEventDisableRegistration",e.UpdateEventEnableRegistration="UpdateEventEnableRegistration"}(nt||(nt={})),function(e){e.Standard="Standard",e.PlazaRoom="PlazaRoom"}(it||(it={})),function(e){e.Uninitialised="Uninitialised",e.InProgress="InProgress",e.Resolved="Resolved",e.Rejected="Rejected"}(at||(at={})),function(e){e.FileAttachment="FileAttachment",e.ItemAttachment="ItemAttachment",e.ReferenceAttachment="ReferenceAttachment"}(ot||(ot={})),function(e){e.Optional="Optional",e.Organizer="Organizer",e.Required="Required",e.Resource="Resource",e.Room="Room"}(rt||(rt={})),function(e){e.User="User",e.Admin="Admin",e.Guest="Guest",e.None="None"}(st||(st={})),function(e){e.SecurityGroup="SecurityGroup",e.StreamGroup="StreamGroup"}(lt||(lt={})),function(e){e.collaborativeSpace="collaborativeSpace"}(ct||(ct={})),function(e){e.Disabled="Disabled",e.Enabled="Enabled"}(dt||(dt={})),function(e){e.Message="Message"}(ut||(ut={})),function(e){e.ApplyClicked="ApplyClicked",e.EffectChanged="EffectChanged",e.VideoAppLoaded="VideoAppLoaded",e.SetStateToPreview="SetStateToPreview",e.SetStateToVideoOn="SetStateToVideoOn",e.Other="Other"}(mt||(mt={})),function(e){e.On="On",e.Off="Off",e.Fade="Fade"}(pt||(pt={})),function(e){e.Reset="Reset",e.ZoomIn="ZoomIn",e.ZoomOut="ZoomOut",e.PanLeft="PanLeft",e.PanRight="PanRight",e.TiltUp="TiltUp",e.TiltDown="TiltDown"}(gt||(gt={})),function(e){e.Speaker="Speaker"}(ht||(ht={})),function(e){e.Vtt="Vtt",e.Docx="Docx",e.Pdf="Pdf"}(vt||(vt={})),function(e){e.rotate_0="rotate_0",e.rotate_90="rotate_90",e.rotate_180="rotate_180",e.rotate_270="rotate_270"}(ft||(ft={})),function(e){e.NotSupported="NotSupported",e.Unavailable="Unavailable",e.Available="Available"}(yt||(yt={})),function(e){e.LIS="LIS",e.CLS="CLS",e.Assist="Assist",e.Manual="Manual",e.Registered="Registered",e.None="None"}(St||(St={})),function(e){e.CommandResetError="CommandResetError",e.CommandZoomInError="CommandZoomInError",e.CommandZoomOutError="CommandZoomOutError",e.CommandPanLeftError="CommandPanLeftError",e.CommandPanRightError="CommandPanRightError",e.CommandTiltUpError="CommandTiltUpError",e.CommandTiltDownError="CommandTiltDownError",e.SendDataError="SendDataError"}(kt||(kt={})),function(e){e.None="None",e.ControlDenied="ControlDenied",e.ControlNoResponse="ControlNoResponse",e.ControlBusy="ControlBusy",e.AckTimeout="AckTimeout",e.ControlTerminated="ControlTerminated",e.ControllerTerminated="ControllerTerminated",e.DataChannelError="DataChannelError",e.ControllerCancelled="ControllerCancelled",e.ControlDisabled="ControlDisabled",e.ControlTerminatedToAllowOtherController="ControlTerminatedToAllowOtherController"}(bt||(bt={})),function(e){e.None="None",e.Disabled="Disabled",e.Pending="Pending",e.Waiting="Waiting",e.Started="Started",e.Stopped="Stopped",e.Failed="Failed"}(_t||(_t={})),function(e){e.None="None",e.Started="Started",e.Stopped="Stopped",e.Pending="Pending",e.Failed="Failed"}(Ct||(Ct={})),function(e){e.ImplicitActionItems="ImplicitActionItems",e.ManualActionItems="ManualActionItems"}(wt||(wt={})),function(e){e.ImplicitActionItem="ImplicitActionItem",e.ExplicitActionItem="ExplicitActionItem"}(Tt||(Tt={})),function(e){e.Low="Low",e.High="High"}(Et||(Et={})),function(e){e.Unassigned="Unassigned",e.Commitment="Commitment",e.Request="Request",e.Delegation="Delegation"}(It||(It={})),function(e){e.Done="Done",e.InProcess="InProcess",e.NotStarted="NotStarted",e.ScoreTooLow="ScoreTooLow",e.TooManyCharacters="TooManyCharacters",e.UnknownError="UnknownError",e.TranslationNotNeeded="TranslationNotNeeded",e.ShowOriginalMessage="ShowOriginalMessage",e.MessageNotFound="MessageNotFound",e.VersionNotFound="VersionNotFound",e.LanguageDetectionFailed="LanguageDetectionFailed",e.ClientMutationThrottled="ClientMutationThrottled"}(Nt||(Nt={})),function(e){e.GetByKey="GetByKey",e.Put="Put",e.Delete="Delete"}(At||(At={})),function(e){e.NotControlCapable="NotControlCapable",e.Disabled="Disabled",e.NotInControl="NotInControl",e.RequestSent="RequestSent",e.InControl="InControl"}(Mt||(Mt={})),function(e){e.Monitor="Monitor",e.Window="Window",e.Camera="Camera"}(Ft||(Ft={})),function(e){e.NotStarted="NotStarted",e.Starting="Starting",e.Started="Started",e.Stopping="Stopping",e.Stopped="Stopped"}(Rt||(Rt={})),function(e){e.Offline="Offline",e.InitFailed="InitFailed",e.JoinFailed="JoinFailed",e.AcceptFailed="AcceptFailed"}(Pt||(Pt={})),function(e){e.None="None",e.Normal="Normal",e.Deep="Deep"}(Dt||(Dt={})),function(e){e.Auto="Auto",e.High="High",e.Low="Low",e.None="None"}(jt||(jt={})),function(e){e.OngoingCall="OngoingCall",e.Meeting="Meeting",e.OneToOneCall="OneToOneCall",e.GroupCall="GroupCall"}(xt||(xt={})),function(e){e.Legacy="Legacy",e.MeetingData="MeetingData"}(Ot||(Ot={})),function(e){e.Quality="Quality",e.ShortDurationHangup="ShortDurationHangup",e.EffectiveMeeting="EffectiveMeeting",e.EffectiveMeetingV2="EffectiveMeetingV2",e.EffectiveMeetingViva="EffectiveMeetingViva"}(Lt||(Lt={})),function(e){e.Audio="Audio",e.AttendeeAudio="AttendeeAudio",e.Video="Video",e.ScreenSharing="ScreenSharing",e.Broadcast="Broadcast",e.ScreenshareFromChat="ScreenshareFromChat",e.AttendeeGeneral="AttendeeGeneral",e.AttendeeCaptions="AttendeeCaptions",e.CallClosedCaptions="CallClosedCaptions",e.EffectiveMeeting="EffectiveMeeting",e.Other="Other"}(Ut||(Ut={})),function(e){e.P2P="P2P",e.GroupCall="GroupCall",e.Meeting="Meeting",e.ScreenshareFromChat="ScreenshareFromChat",e.PSTN="PSTN",e.SfB="SfB"}(Bt||(Bt={})),function(e){e.Default="Default",e.LongrangeSpeaker="LongrangeSpeaker",e.Auditorium="Auditorium"}(Wt||(Wt={})),function(e){e.MeetingCoach="MeetingCoach",e.MeetingInfo="MeetingInfo",e.MeetingInfoV3="MeetingInfoV3",e.AttendanceReport="AttendanceReport",e.AttendanceReportV3="AttendanceReportV3",e.ExternalParticipants="ExternalParticipants",e.ExplicitActionItems="ExplicitActionItems",e.ImplicitActionItems="ImplicitActionItems",e.Decisions="Decisions",e.Notes="Notes",e.Playground="Playground",e.ManualActionItems="ManualActionItems",e.NgcParticipantsActivity="NgcParticipantsActivity",e.Transcript="Transcript",e.TranscriptEntities="TranscriptEntities",e.TranscriptEvents="TranscriptEvents"}(Ht||(Ht={})),function(e){e.Default="Default",e.Room="Room"}($t||($t={})),function(e){e.RTMPInput="RTMPInput"}(Vt||(Vt={})),function(e){e.Video="Video",e.ScreenSharing="ScreenSharing"}(zt||(zt={})),function(e){e.Audio="Audio",e.Video="Video",e.PanoramicVideo="PanoramicVideo",e.ScreenShare="ScreenShare",e.Data="Data",e.ParticipantVideo_0="ParticipantVideo_0",e.ParticipantVideo_1="ParticipantVideo_1",e.ParticipantVideo_2="ParticipantVideo_2",e.ParticipantVideo_3="ParticipantVideo_3"}(Gt||(Gt={})),function(e){e.Unknown="Unknown",e.Standard="Standard",e.Reserved="Reserved"}(qt||(qt={})),function(e){e.PresenceUnknown="PresenceUnknown",e.Available="Available",e.AvailableIdle="AvailableIdle",e.Away="Away",e.Busy="Busy",e.BusyIdle="BusyIdle",e.DoNotDisturb="DoNotDisturb",e.BeRightBack="BeRightBack",e.Offline="Offline"}(Jt||(Jt={})),function(e){e.InACall="InACall",e.InAConferenceCall="InAConferenceCall",e.InAMeeting="InAMeeting",e.Presenting="Presenting",e.OffWork="OffWork",e.Available="Available",e.Inactive="Inactive",e.Busy="Busy",e.DoNotDisturb="DoNotDisturb",e.BeRightBack="BeRightBack",e.Away="Away",e.Offline="Offline",e.UrgentInterruptionsOnly="UrgentInterruptionsOnly",e.PresenceUnknown="PresenceUnknown",e.OutOfOffice="OutOfOffice"}(Kt||(Kt={})),function(e){e.None="None",e.OnShift="OnShift",e.OffShift="OffShift"}(Qt||(Qt={})),function(e){e.Chat="Chat",e.PhoneChat="PhoneChat",e.Meeting="Meeting",e.SfBInteropChat="SfBInteropChat"}(Yt||(Yt={})),function(e){e.AcceptPending="AcceptPending",e.Accepted="Accepted",e.Blocked="Blocked",e.Quarantined="Quarantined"}(Xt||(Xt={})),function(e){e.ChatEnabled="ChatEnabled",e.ChatDisabled="ChatDisabled",e.InMeeting="InMeeting"}(Zt||(Zt={})),function(e){e.OptedOut="OptedOut",e.Deprovisioned="Deprovisioned",e.Claimed="Claimed"}(en||(en={})),function(e){e.Importing="Importing",e.Completed="Completed"}(tn||(tn={})),function(e){e.Unknown="Unknown",e.Adhoc="Adhoc",e.Scheduled="Scheduled",e.Recurring="Recurring",e.Broadcast="Broadcast",e.MeetNow="MeetNow"}(nn||(nn={})),function(e){e.Email="Email",e.Call="Call",e.PSTN="PSTN",e.SMS="SMS",e.TeamsCall="TeamsCall",e.ETNP="ETNP"}(an||(an={})),function(e){e.Delivered="Delivered",e.Sending="Sending",e.Error="Error",e.Undeliverable="Undeliverable"}(on||(on={})),function(e){e.Standard="Standard",e.Important="Important",e.Urgent="Urgent"}(rn||(rn={})),function(e){e.Sent="Sent",e.sent="sent",e.Failed="Failed",e.failed="failed"}(sn||(sn={})),function(e){e.Default="Default",e.ScreenSharing="ScreenSharing",e.EmergencyGroupCall="EmergencyGroupCall",e.Unknown="Unknown"}(ln||(ln={})),function(e){e.MultiParty="MultiParty",e.TwoParty="TwoParty",e.Unknown="Unknown"}(cn||(cn={})),function(e){e.Accepted="Accepted",e.AcceptedElsewhere="AcceptedElsewhere",e.Declined="Declined",e.Missed="Missed",e.Unknown="Unknown"}(dn||(dn={})),function(e){e.Outgoing="Outgoing",e.Incoming="Incoming",e.Unknown="Unknown"}(un||(un={})),function(e){e.Single="Single",e.Occurrence="Occurrence",e.Exception="Exception",e.RecurringMaster="RecurringMaster"}(mn||(mn={})),function(e){e.Anonymous="Anonymous",e.AllCompany="AllCompany",e.InvitationOnly="InvitationOnly"}(pn||(pn={})),function(e){e.Free="Free",e.Tentative="Tentative",e.Busy="Busy",e.Oof="Oof",e.WorkingElsewhere="WorkingElsewhere",e.Unknown="Unknown"}(gn||(gn={})),function(e){e.None="None",e.Organizer="Organizer",e.Tentative="Tentative",e.Accepted="Accepted",e.Declined="Declined",e.NotResponded="NotResponded"}(hn||(hn={})),function(e){e.Created="Created",e.Activated="Activated",e.Abandoned="Abandoned",e.Suspended="Suspended",e.Live="Live",e.Stopped="Stopped",e.Deleted="Deleted",e.Recreated="Recreated",e.Hidden="Hidden"}(vn||(vn={})),function(e){e.Mobile="Mobile",e.Business="Business"}(fn||(fn={})),function(e){e.Team="Team",e.Edu="Edu",e.Class="Class",e.Plc="Plc",e.Staff="Staff",e.HealthcareCareCoordination="HealthcareCareCoordination"}(yn||(yn={})),function(e){e.None="None",e.Private="Private",e.Secret="Secret",e.Public="Public",e.HiddenMembership="HiddenMembership",e.Unknown="Unknown",e.All="All"}(Sn||(Sn={})),function(e){e.Standard="Standard",e.Private="Private",e.Shared="Shared"}(kn||(kn={})),function(e){e.Strict="Strict",e.Moderate="Moderate",e.NoRestriction="NoRestriction"}(bn||(bn={})),function(e){e.Domains="Domains",e.Members="Members",e.Anyone="Anyone"}(_n||(_n={})),function(e){e.active="active",e.deleted="deleted",e.reference="reference",e.hidden="hidden"}(Cn||(Cn={})),function(e){e.active="active",e.deleted="deleted",e.reference="reference",e.hidden="hidden"}(wn||(wn={})),function(e){e.Camera="Camera",e.Microphone="Microphone",e.Speaker="Speaker"}(Tn||(Tn={})),function(e){e.Info="Info",e.Warning="Warning",e.Error="Error",e.Standalone="Standalone"}(En||(En={})),function(e){e.AcceptBreakoutRoomInvite="AcceptBreakoutRoomInvite",e.betterTogetherTransferCall="betterTogetherTransferCall",e.BroadcastLearnMore="BroadcastLearnMore",e.BroadcastModalityReconnect="BroadcastModalityReconnect",e.CloseVideoApp="CloseVideoApp",e.DeclineBreakoutRoomInvite="DeclineBreakoutRoomInvite",e.DownloadApp="DownloadApp",e.MuteSpeakerAndMicAudio="MuteSpeakerAndMicAudio",e.NdiPrivacyPolicyCapturer="NdiPrivacyPolicyCapturer",e.PrivacyPolicyParticipant="PrivacyPolicyParticipant",e.OpenAudioEscalationDialog="OpenAudioEscalationDialog",e.SwitchDevice="SwitchDevice",e.OpenDeviceSettings="OpenDeviceSettings",e.OpenLearnMoreLink="OpenLearnMoreLink",e.OpenMeetingInfo="OpenMeetingInfo",e.OpenPrivacyPolicyLink="OpenPrivacyPolicyLink",e.OptOutFromVoiceCollection="OptOutFromVoiceCollection",e.PaywallUpgrade="PaywallUpgrade",e.PstnDialInManually="PstnDialInManually",e.PstnDialOutManually="PstnDialOutManually",e.RejoinAsGuest="RejoinAsGuest",e.ReportScdFailure="ReportScdFailure",e.ShowPstnDialog="ShowPstnDialog",e.StartChromeExtensionInstallation="StartChromeExtensionInstallation",e.StartContentSharing="StartContentSharing",e.StartScreenSharingOnCall="StartScreenSharingOnCall",e.SwitchMicrophone="SwitchMicrophone",e.SwitchShareContent="SwitchShareContent",e.TakePptSharingControl="TakePptSharingControl",e.TurnCameraOn="TurnCameraOn",e.ToggleHighFidelityMusicMode="ToggleHighFidelityMusicMode",e.UnmuteMicAudio="UnmuteMicAudio",e.UnmuteSpeakers="UnmuteSpeakers",e.StartMeeting="StartMeeting",e.EnableScreenshareRecording="EnableScreenshareRecording",e.DisableIncomingAndOutgoingVideo="DisableIncomingAndOutgoingVideo",e.Cancel="Cancel"}(In||(In={})),function(e){e.AddMemberToChatFailed="AddMemberToChatFailed",e.AudioCaptureMusicDetectedWithHighNS="AudioCaptureMusicDetectedWithHighNS",e.AudioCaptureMusicDetectedWithLowNS="AudioCaptureMusicDetectedWithLowNS",e.AudioCaptureUltrasoundDetected="AudioCaptureUltrasoundDetected",e.AudienceViewFailed="AudienceViewFailed",e.AudienceViewSceneAck="AudienceViewSceneAck",e.AudienceViewSceneChanged="AudienceViewSceneChanged",e.AudienceViewSceneChangeFailed="AudienceViewSceneChangeFailed",e.BetterTogetherOutOfProximityWarning="BetterTogetherOutOfProximityWarning",e.Bmc_setLayout_command_failure="Bmc_setLayout_command_failure",e.Bmc_start_command_failure="Bmc_start_command_failure",e.Bmc_stop_command_failure="Bmc_stop_command_failure",e.Bmc_restart_command_failure="Bmc_restart_command_failure",e.BreakoutRoomAnnouncement="BreakoutRoomAnnouncement",e.BreakoutRoomsBulkMoveFailure="BreakoutRoomsBulkMoveFailure",e.BreakoutRoomsControlLost="BreakoutRoomsControlLost",e.BreakoutRoomsPanelClosedOnRoomsDeleted="BreakoutRoomsPanelClosedOnRoomsDeleted",e.BreakoutRoomCannotMoveDisconnectedParticipants="BreakoutRoomCannotMoveDisconnectedParticipants",e.BreakoutRoomCloseCreateBrDialog="BreakoutRoomCloseCreateBrDialog",e.BreakoutRoomCreationFailed="BreakoutRoomCreationFailed",e.BreakoutRoomEnding="BreakoutRoomEnding",e.BreakoutRoomInvite="BreakoutRoomInvite",e.BreakoutRoomLockXlMeeting="BreakoutRoomLockXlMeeting",e.Broadcast_captions_disabled_by_ETM="Broadcast_captions_disabled_by_ETM",e.Broadcast_concurrent_videos_limit="Broadcast_concurrent_videos_limit",e.Broadcast_end_warning="Broadcast_end_warning",e.Broadcast_ipvideo_permission="Broadcast_ipvideo_permission",e.Broadcast_ipvideo_vbss_permission="Broadcast_ipvideo_vbss_permission",e.Broadcast_noCamera="Broadcast_noCamera",e.Broadcast_preview_overflow_warning="Broadcast_preview_overflow_warning",e.Broadcast_reset_done="Broadcast_reset_done",e.Broadcast_vbss_permission="Broadcast_vbss_permission",e.BroadcastModalityDisconnected="BroadcastModalityDisconnected",e.BroadcastModalityNotReceived="BroadcastModalityNotReceived",e.BroadcastMutedProducerWarning="BroadcastMutedProducerWarning",e.BroadcastStopped="BroadcastStopped",e.CameraUnmuteTakesLongerTime="CameraUnmuteTakesLongerTime",e.ClosedCaptionsStartFailed="ClosedCaptionsStartFailed",e.CoachNotification="CoachNotification",e.CoachStarted="CoachStarted",e.CoachStartFailed="CoachStartFailed",e.CoachStopped="CoachStopped",e.CoachStopFailed="CoachStopFailed",e.ComplianceRecordingStarted="ComplianceRecordingStarted",e.ComplianceRecordingStopped="ComplianceRecordingStopped",e.ContentOnlyAlert="ContentOnlyAlert",e.ContentOnlyFromNudgeAlert="ContentOnlyFromNudgeAlert",e.ContentSharingFailed="ContentSharingFailed",e.CpuInsufficient="CpuInsufficient",e.CurrentMeetingIsXL="CurrentMeetingIsXL",e.DeviceAtCallStart="DeviceAtCallStart",e.DeviceCaptureMute="DeviceCaptureMute",e.DeviceCaptureNotFunctioning="DeviceCaptureNotFunctioning",e.DeviceCaptureNotFunctioningAudioSrvNotRunning="DeviceCaptureNotFunctioningAudioSrvNotRunning",e.DeviceCaptureNotMuteButSilent="DeviceCaptureNotMuteButSilent",e.DeviceClipping="DeviceClipping",e.DeviceHowling="DeviceHowling",e.DeviceLowSNR="DeviceLowSNR",e.DeviceMultipleEndpoints="DeviceMultipleEndpoints",e.DeviceNearEndToEchoRatio="DeviceNearEndToEchoRatio",e.DeviceRenderHowling="DeviceRenderHowling",e.DeviceRenderMute="DeviceRenderMute",e.DeviceRenderNotFunctioning="DeviceRenderNotFunctioning",e.DeviceRenderNotFunctioningAudioSrvNotRunning="DeviceRenderNotFunctioningAudioSrvNotRunning",e.DeviceRenderZeroVolume="DeviceRenderZeroVolume",e.DeviceSpeakWhileMuted="DeviceSpeakWhileMuted",e.DisableIncomingMeetingAudio="DisableIncomingMeetingAudio",e.EnableIncomingMeetingAudio="EnableIncomingMeetingAudio",e.EndOfMeetingAlert="EndOfMeetingAlert",e.LargeGalleryViewFailed="LargeGalleryViewFailed",e.HardwareOutMeetingSendToDevice="HardwareOutMeetingSendToDevice",e.HardwareOutMeetingStopDevice="HardwareOutMeetingStopDevice",e.HolographicAnnotationsError="HolographicAnnotationsError",e.HostViewModeActivated="HostViewModeActivated",e.HostViewModeDeactivated="HostViewModeDeactivated",e.ImageRenderingQualityAlert="ImageRenderingQualityAlert",e.InitiatorStartedRecording="InitiatorStartedRecording",e.InsufficientMeetingRole="InsufficientMeetingRole",e.InteropCallAlert="InteropCallAlert",e.InteropScreenshare="InteropScreenshare",e.JoinersOngoingRecording="JoinersOngoingRecording",e.LocalDeviceEcho="LocalDeviceEcho",e.Meeting_attendee_restrictions_operation_failure="Meeting_attendee_restrictions_operation_failure",e.Meeting_attendees_audio_failed="Meeting_attendees_audio_failed",e.Meeting_attendees_audio_restricted="Meeting_attendees_audio_restricted",e.Meeting_attendees_audio_unrestricted="Meeting_attendees_audio_unrestricted",e.Meeting_attendees_video_failed="Meeting_attendees_video_failed",e.Meeting_attendees_video_restricted="Meeting_attendees_video_restricted",e.Meeting_attendees_video_unrestricted="Meeting_attendees_video_unrestricted",e.Meeting_self_attendee_audio_restricted="Meeting_self_attendee_audio_restricted",e.Meeting_self_attendee_audio_unrestricted="Meeting_self_attendee_audio_unrestricted",e.Meeting_self_attendee_video_restricted="Meeting_self_attendee_video_restricted",e.Meeting_self_attendee_video_unrestricted="Meeting_self_attendee_video_unrestricted",e.MeetingLocked="MeetingLocked",e.MeetingLockedError="MeetingLockedError",e.MeetingUnlocked="MeetingUnlocked",e.MeetingRoleChanged="MeetingRoleChanged",e.MergeFailedAlert="MergeFailedAlert",e.MicMutedRemotely="MicMutedRemotely",e.MicUnmuteTakesLongerTime="MicUnmuteTakesLongerTime",e.HighFidelityAudioToggled="HighFidelityAudioToggled",e.HighFidelityAudioToggleFailure="HighFidelityAudioToggleFailure",e.NdiMeetingBroadcastCapturer="NdiMeetingBroadcastCapturer",e.NdiMeetingBroadcastStoppedCapturer="NdiMeetingBroadcastStoppedCapturer",e.NdiMeetingBroadcastParticipant="NdiMeetingBroadcastParticipant",e.NdiMeetingBroadcastStoppedParticipant="NdiMeetingBroadcastStoppedParticipant",e.NetworkQuality="NetworkQuality",e.NetworkReconnect="NetworkReconnect",e.NetworkRecvCatastrophicPoorTurnOffVideo="NetworkRecvCatastrophicPoorTurnOffVideo",e.NetworkRecvCatastrophicPstnAvailable="NetworkRecvCatastrophicPstnAvailable",e.NetworkRecvCatastrophicPstnNotAvailable="NetworkRecvCatastrophicPstnNotAvailable",e.NetworkSendCatastrophicPoorTurnOffVideo="NetworkSendCatastrophicPoorTurnOffVideo",e.NetworkSendCatastrophicPstnAvailable="NetworkSendCatastrophicPstnAvailable",e.NetworkSendCatastrophicPstnNotAvailable="NetworkSendCatastrophicPstnNotAvailable",e.NoAvailableMicrophone="NoAvailableMicrophone",e.NoAvailableSpeakers="NoAvailableSpeakers",e.OverflowRoomCreated="OverflowRoomCreated",e.ParticipantsRecordingStarted="ParticipantsRecordingStarted",e.PaywallTimerStart="PaywallTimerStart",e.PaywallRemainingDuration="PaywallRemainingDuration",e.PaywallRemainingParticipantCapacity="PaywallRemainingParticipantCapacity",e.PptContentSharingConsent="PptContentSharingConsent",e.PptContentSharingUnsupportedMeeting="PptContentSharingUnsupportedMeeting",e.PptPresentOnMeetingStart="PptPresentOnMeetingStart",e.PptPrivateViewingFailed="PptPrivateViewingFailed",e.PptSharingStolen="PptSharingStolen",e.PptUnsupportedUpload="PptUnsupportedUpload",e.PptWeatherpersonFailed="PptWeatherpersonFailed",e.PSTNCallLBRFailure="PSTNCallLBRFailure",e.RaiseHandsOperationFailure="RaiseHandsOperationFailure",e.RecordingAndTranscriptFailed="RecordingAndTranscriptFailed",e.RecordingAndTranscriptPending="RecordingAndTranscriptPending",e.RecordingAndTranscriptStarted="RecordingAndTranscriptStarted",e.RecordingAndTranscriptStartedByOthers="RecordingAndTranscriptStartedByOthers",e.RecordingAndTranscriptStopFailed="RecordingAndTranscriptStopFailed",e.RecordingAndTranscriptStopped="RecordingAndTranscriptStopped",e.RecordingDisabled="RecordingDisabled",e.RecordingFailed="RecordingFailed",e.RecordingFailedTranscriptPending="RecordingFailedTranscriptPending",e.RecordingFailedTranscriptStarted="RecordingFailedTranscriptStarted",e.RecordingPPT="RecordingPPT",e.RecordingStartedTranscriptPending="RecordingStartedTranscriptPending",e.RecordingSpotlight="RecordingSpotlight",e.RecordingStopped="RecordingStopped",e.RecordingWhiteboard="RecordingWhiteboard",e.RemoteDeviceEcho="RemoteDeviceEcho",e.RigelAutoExitMeetingAlert="RigelAutoExitMeetingAlert",e.RigelDisplayDisconnected="RigelDisplayDisconnected",e.RigelParticipantsInLobby="RigelParticipantsInLobby",e.RigelRoomPeopleCountChanged="RigelRoomPeopleCountChanged",e.ScreenShareContentNotSupportedForOverflow="ScreenShareContentNotSupportedForOverflow",e.ScreenshareRecordingDisabled="ScreenshareRecordingDisabled",e.ScreensharingCallEscalatedToAudio="ScreensharingCallEscalatedToAudio",e.ScreensharingCallEscalatedToAudioFailed="ScreensharingCallEscalatedToAudioFailed",e.ScreenSharingNotSupported="ScreenSharingNotSupported",e.ScreenSharingRenderingError="ScreenSharingRenderingError",e.ScreenSharingWindowMinimizedPopUpAlert="ScreenSharingWindowMinimizedPopUpAlert",e.SharedWindowMinimized="SharedWindowMinimized",e.SharingControlRequestDenied="SharingControlRequestDenied",e.SharingControlRequestRevoked="SharingControlRequestRevoked",e.SharingDropped="SharingDropped",e.SharingStolen="SharingStolen",e.NewAudioDevicePluggedInAlert="NewAudioDevicePluggedInAlert",e.NewVideoDevicePluggedInAlert="NewVideoDevicePluggedInAlert",e.AudioDeviceSelectionChangedAlert="AudioDeviceSelectionChangedAlert",e.ActiveAudioDevicePluggedOutAlert="ActiveAudioDevicePluggedOutAlert",e.ActiveVideoDevicePluggedOutAlert="ActiveVideoDevicePluggedOutAlert",e.ScdFailed="ScdFailed",e.ScdStopped="ScdStopped",e.ScdSucceeded="ScdSucceeded",e.SpeakerAndMicUnmuted="SpeakerAndMicUnmuted",e.SpotlightError="SpotlightError",e.SpotlightStatusChanged="SpotlightStatusChanged",e.SpotlightStatusOn="SpotlightStatusOn",e.SpotlightStatusOff="SpotlightStatusOff",e.StreamingMeetingStarted="StreamingMeetingStarted",e.StreamingMeetingStopped="StreamingMeetingStopped",e.SystemAudioDevicesMismatchInCallingScreen="SystemAudioDevicesMismatchInCallingScreen",e.SystemAudioNoDeviceInCallingScreen="SystemAudioNoDeviceInCallingScreen",e.SystemAudioDevicesNotMatch="SystemAudioDevicesNotMatch",e.SystemAudioDevicesStoppedWithError="SystemAudioDevicesStoppedWithError",e.SystemAudioDriverInstallationFailed="SystemAudioDriverInstallationFailed",e.SystemAudioDriverInstallationSucceeded="SystemAudioDriverInstallationSucceeded",e.SystemAudioNoDevice="SystemAudioNoDevice",e.SystemAudioStarted="SystemAudioStarted",e.SystemAudioUnsupportedSharing="SystemAudioUnsupportedSharing",e.TemporarilyUnmuted="TemporarilyUnmuted",e.TranscriptionLanguageChanged="TranscriptionLanguageChanged",e.TranscriptFailedRecordingPending="TranscriptFailedRecordingPending",e.TranscriptFailedRecordingStarted="TranscriptFailedRecordingStarted",e.TranscriptStarted="TranscriptStarted",e.TranscriptStartedByOthers="TranscriptStartedByOthers",e.TranscriptStartedRecordingPending="TranscriptStartedRecordingPending",e.TranscriptStartFailed="TranscriptStartFailed",e.TranscriptStopFailed="TranscriptStopFailed",e.TranscriptStopped="TranscriptStopped",e.UserHandLoweredByPresenter="UserHandLoweredByPresenter",e.VideoCaptureDeviceFreeze="VideoCaptureDeviceFreeze",e.VideoCaptureFreezeRecovered="VideoCaptureFreezeRecovered",e.VideoCapturePermissionDenied="VideoCapturePermissionDenied",e.VideoCapturerDeviceStartFailed="VideoCapturerDeviceStartFailed",e.VideoCapturerDeviceStartFailureLackSystemRes="VideoCapturerDeviceStartFailureLackSystemRes",e.VideoCapturerDeviceStartFailureMFResConflict="VideoCapturerDeviceStartFailureMFResConflict",e.VideoCapturerDeviceStartTimedOut="VideoCapturerDeviceStartTimedOut",e.VideoExtensibilityFreeze="VideoExtensibilityFreeze",e.VideoExtensibilitySlow="VideoExtensibilitySlow",e.VideoEffectsQualityDegraded="VideoEffectsQualityDegraded",e.VoiceCollectionFailed="VoiceCollectionFailed",e.VoiceCollectionStarted="VoiceCollectionStarted",e.VoiceCollectionStopped="VoiceCollectionStopped",e.WeatherpersonContentNotSupported="WeatherpersonContentNotSupported",e.WeatherpersonVideoStopped="WeatherpersonVideoStopped"}(Nn||(Nn={})),function(e){e.upload="upload",e.recent="recent",e.channel="channel",e.attachment="attachment",e.cortana="cortana",e.deepLink="deepLink",e.onedrive="onedrive"}(An||(An={})),function(e){e.ppt="ppt",e.invision_whiteboard="invision_whiteboard",e.whiteboard="whiteboard",e.extensible_app="extensible_app",e.annotation="annotation"}(Mn||(Mn={})),function(e){e.Cameo="Cameo",e.ContentOnly="ContentOnly",e.Weatherperson="Weatherperson",e.SideBySide="SideBySide",e.NewsAnchor="NewsAnchor"}(Fn||(Fn={})),function(e){e.Unestablished="Unestablished",e.Viewing="Viewing",e.BrowsingPrivately="BrowsingPrivately",e.Presenting="Presenting",e.Starting="Starting",e.Joining="Joining"}(Rn||(Rn={})),function(e){e.Unestablished="Unestablished",e.Viewing="Viewing",e.Presenting="Presenting"}(Pn||(Pn={})),function(e){e.None="None",e.Text="Text",e.StartEvent="StartEvent",e.StopEvent="StopEvent",e.ParticipantJoined="ParticipantJoined",e.ParticipantLeft="ParticipantLeft",e.RoomAttributionStarted="RoomAttributionStarted",e.RoomAttributionStopped="RoomAttributionStopped"}(Dn||(Dn={})),function(e){e.Producer="Producer",e.Contributor="Contributor",e.Attendee="Attendee",e.None="None"}(jn||(jn={})),function(e){e.ups="ups",e.sfb="sfb"}(xn||(xn={})),function(e){e.Never="Never",e.OneHour="OneHour",e.FourHours="FourHours",e.Today="Today",e.ThisWeek="ThisWeek"}(On||(On={})),function(e){e.Unknown="Unknown",e.SidePanel="SidePanel",e.Stage="Stage"}(Ln||(Ln={})),function(e){e.Unknown="Unknown",e.PersonalTab="PersonalTab",e.ChannelTab="ChannelTab",e.PrivateChatTab="PrivateChatTab",e.MeetingChatTab="MeetingChatTab",e.MeetingDetailsTab="MeetingDetailsTab",e.MeetingSidePanel="MeetingSidePanel",e.MeetingStage="MeetingStage",e.CallingSidePanel="CallingSidePanel"}(Un||(Un={})),function(e){e.Unknown="Unknown",e.PersonalTab="PersonalTab",e.ChannelTab="ChannelTab",e.TeamLevelApp="TeamLevelApp"}(Bn||(Bn={})),function(e){e.Application="Application",e.Delegated="Delegated"}(Wn||(Wn={})),function(e){e.Personal="Personal",e.Team="Team",e.GroupChat="GroupChat",e.Meetings="Meetings"}(Hn||(Hn={})),function(e){e.Tab="Tab",e.Bot="Bot",e.Connector="Connector"}($n||($n={})),function(e){e.Query="Query",e.Action="Action"}(Vn||(Vn={})),function(e){e.Compose="Compose",e.Commandbox="Commandbox",e.Message="Message"}(zn||(zn={})),function(e){e.Text="Text",e.Textarea="Textarea",e.Number="Number",e.Date="Date",e.Time="Time",e.Toggle="Toggle",e.Choiceset="Choiceset"}(Gn||(Gn={})),function(e){e.like="like",e.heart="heart",e.laugh="laugh",e.surprised="surprised",e.applause="applause"}(qn||(qn={})),function(e){e.like="like",e.heart="heart",e.applause="applause",e.raisehand="raisehand"}(Jn||(Jn={})),function(e){e.Init="Init",e.Cancel="Cancel",e.Complete="Complete"}(Kn||(Kn={})),function(e){e.Caller="Caller",e.SecurityDesk="SecurityDesk"}(Qn||(Qn={})),function(e){e.admin="admin",e.boss="boss",e.endUser="endUser"}(Yn||(Yn={})),function(e){e.None="None",e.HoloLens="HoloLens",e.Android="Android",e.iOS="iOS",e.Other="Other"}(Xn||(Xn={})),function(e){e.ProducerScreen="ProducerScreen",e.ContributorScreen="ContributorScreen",e.CallHealthScreen="CallHealthScreen"}(Zn||(Zn={})),function(e){e.NotAvailable="NotAvailable",e.Green="Green",e.Amber="Amber",e.Red="Red"}(ei||(ei={})),function(e){e.None="None",e.Connected="Connected",e.Disconnected="Disconnected",e.Local="Local",e.Unknown="Unknown"}(ti||(ti={})),function(e){e.normal="normal",e.high="high",e.urgent="urgent"}(ni||(ni={})),function(e){e.aadUser="aadUser",e.onPremiseAadUser="onPremiseAadUser",e.anonymousGuest="anonymousGuest",e.federatedUser="federatedUser"}(ii||(ii={})),function(e){e.aadApplication="aadApplication",e.bot="bot",e.tenantBot="tenantBot",e.office365Connector="office365Connector",e.webhook="webhook"}(ai||(ai={})),function(e){e.team="team",e.channel="channel"}(oi||(oi={})),function(e){e.html="html",e.text="text"}(ri||(ri={})),function(e){e.like="like",e.heart="heart",e.laugh="laugh",e.surprised="surprised",e.sad="sad",e.angry="angry"}(si||(si={})),function(e){e.List="List",e.BitMask="BitMask",e.Boolean="Boolean",e.SensitivityLabelList="SensitivityLabelList"}(li||(li={})),function(e){e.ExternalFeed="ExternalFeed"}(ci||(ci={})),function(e){e.PeopleSelection="PeopleSelection",e.PresenterSelection="PresenterSelection"}(di||(di={})),function(e){e.IMAGE="IMAGE",e.DOCUMENT="DOCUMENT"}(ui||(ui={})),function(e){e.Anonymous="Anonymous",e.Aad="Aad",e.Msa="Msa",e.MsaLife="MsaLife",e.GFed="GFed",e.Otp="Otp"}(mi||(mi={})),function(e){e.Member="Member",e.Anonymous="Anonymous",e.Guest="Guest"}(pi||(pi={})),function(e){e.Up="Up",e.InteractionRequired="InteractionRequired",e.AADReconnecting="AADReconnecting",e.SkypeReconnecting="SkypeReconnecting"}(gi||(gi={})),function(e){e.QuickStart="QuickStart",e.BYOE="BYOE",e.QuickStartPushToStream="QuickStartPushToStream",e.Slowlane="Slowlane",e.Overflow="Overflow"}(hi||(hi={})),function(e){e.AttendeeAvailabilityOnly="AttendeeAvailabilityOnly",e.SuggestedTimesOnly="SuggestedTimesOnly",e.Both="Both"}(vi||(vi={})),function(e){e.Excellent="Excellent",e.Good="Good",e.Fair="Fair",e.Poor="Poor",e.Unknown="Unknown"}(fi||(fi={})),function(e){e.Scheduled="Scheduled",e.Broadcast="Broadcast"}(yi||(yi={})),function(e){e.Email="Email",e.MeetingInvite="MeetingInvite"}(Si||(Si={})),function(e){e.Link="Link",e.Attachment="Attachment"}(ki||(ki={})),function(e){e.Document="Document",e.Message="Message"}(bi||(bi={})),function(e){e.SharePoint="SharePoint",e.OneDriveBusiness="OneDriveBusiness",e.Exchange="Exchange"}(_i||(_i={})),function(e){e.HEADER="HEADER",e.MAIN="MAIN"}(Ci||(Ci={})),function(e){e.Blocking="Blocking",e.Global="Global",e.Component="Component"}(wi||(wi={})),function(e){e.Block="Block",e.Unblock="Unblock"}(Ti||(Ti={})),function(e){e.Done="Done",e.Error="Error",e.ErrorTooManyCharacters="ErrorTooManyCharacters",e.InProcess="InProcess"}(Ei||(Ei={})),function(e){e.Url="Url",e.Text="Text"}(Ii||(Ii={})),function(e){e.TEAMS="TEAMS",e.SHAREPOINT="SHAREPOINT"}(Ni||(Ni={})),function(e){e.PROGRESS="PROGRESS",e.CANCELLED="CANCELLED",e.FAILED="FAILED",e.CONFLICT="CONFLICT",e.COMPLETE="COMPLETE"}(Ai||(Ai={})),function(e){e.File="File",e.Folder="Folder"}(Mi||(Mi={})),function(e){e.chat="chat",e.team="team",e.channel="channel",e.recipient="recipient"}(Fi||(Fi={})),function(e){e.BadRequest="BadRequest",e.MembersNotFound="MembersNotFound",e.MembersAndRelatedContactsPartialSuccess="MembersAndRelatedContactsPartialSuccess",e.InvalidBackendResponse="InvalidBackendResponse",e.CallerIsNotGroupOwner="CallerIsNotGroupOwner",e.Unknown="Unknown"}(Ri||(Ri={})),function(e){e.Active="Active",e.Inactive="Inactive"}(Pi||(Pi={})),function(e){e.FailedToFetchRelatedContacts="FailedToFetchRelatedContacts",e.RelatedContactsNotFound="RelatedContactsNotFound",e.BadRequest="BadRequest",e.InvalidBackendResponse="InvalidBackendResponse",e.InvalidCallerOrGroup="InvalidCallerOrGroup",e.InvalidUserOrGroup="InvalidUserOrGroup",e.Unknown="Unknown"}(Di||(Di={})),function(e){e.LoadedMetadata="LoadedMetadata",e.LoadStart="LoadStart",e.LoadedData="LoadedData",e.Start="Start",e.Ready="Ready",e.Play="Play",e.Playing="Playing",e.Paused="Paused",e.Buffering="Buffering",e.Seeking="Seeking",e.Seeked="Seeked",e.Ended="Ended",e.Error="Error",e.Destroyed="Destroyed",e.Initialized="Initialized",e.Resume="Resume"}(ji||(ji={})),function(e){e.UnsupportedPlatform="UnsupportedPlatform",e.NetworkError="NetworkError",e.PlaybackRetried="PlaybackRetried",e.PlaybackError="PlaybackError",e.Unknown="Unknown"}(xi||(xi={})),function(e){e.TeamSummariesAvailable="TeamSummariesAvailable",e.NoTeamsAvailable="NoTeamsAvailable",e.DefaultError="DefaultError"}(Oi||(Oi={})),function(e){e.MembersAndOwnersAvailable="MembersAndOwnersAvailable",e.NoMembersAndOwnersAvailable="NoMembersAndOwnersAvailable",e.NoGroupsAvailable="NoGroupsAvailable",e.MembersAndOwnersLimitExceeded="MembersAndOwnersLimitExceeded",e.ApiDisabled="ApiDisabled",e.DefaultError="DefaultError"}(Li||(Li={})),function(e){e.EmptyState="EmptyState",e.InvalidQsp="InvalidQsp",e.NotOrganizer="NotOrganizer",e.MissingQsp="MissingQsp",e.PartialChange="PartialChange",e.CacheNotInitialized="CacheNotInitialized",e.Unknown="Unknown",e.NotFound="NotFound"}(Ui||(Ui={})),function(e){e.eq="eq"}(Bi||(Bi={})),function(e){e.Small="Small",e.Medium="Medium",e.Large="Large"}(Wi||(Wi={})),function(e){e.Idea="Idea",e.Survey="Survey",e.Frown="Frown",e.Smile="Smile"}(Hi||(Hi={})),function(e){e.Webinar="Webinar",e.Conference="Conference",e.Townhall="Townhall"}($i||($i={})),function(e){e.Draft="Draft",e.Published="Published",e.Ended="Ended",e.Cancelled="Cancelled"}(Vi||(Vi={})),function(e){e.Draft="Draft",e.Active="Active",e.ProcessingCancellation="ProcessingCancellation",e.Canceled="Canceled"}(zi||(zi={})),function(e){e.Organizer="Organizer",e.Presenter="Presenter",e.Attendee="Attendee"}(Gi||(Gi={})),function(e){e.DateTime="DateTime",e.Location="Location",e.Description="Description",e.Speaker="Speaker",e.Questionnaire="Questionnaire"}(qi||(qi={})),function(e){e.slot="slot",e.page="page"}(Ji||(Ji={})),function(e){e.alert_inline="alert_inline",e.button="button",e.dropdown="dropdown",e.openWindowsNotificationSettings="openWindowsNotificationSettings",e.subPage="subPage",e.text="text",e.toggle="toggle"}(Ki||(Ki={})),function(e){e.mutation="mutation",e.navigation="navigation",e.external_navigation="external_navigation"}(Qi||(Qi={})),function(e){e.ToastSettings="ToastSettings",e.ActivityGenerationSettings="ActivityGenerationSettings",e.SoundsSettings="SoundsSettings"}(Yi||(Yi={})),function(e){e.Tab="Tab",e.Bot="Bot",e.Messaging="Messaging",e.Connector="Connector"}(Xi||(Xi={})),function(e){e.NotInstalled="NotInstalled",e.Installed="Installed",e.InstalledAndFavorited="InstalledAndFavorited",e.InstalledAndHidden="InstalledAndHidden",e.InstalledAndPermanent="InstalledAndPermanent",e.InstalledAndDeprecated="InstalledAndDeprecated",e.Featured="Featured",e.PreConsented="PreConsented",e.AdminPreInstalled="AdminPreInstalled"}(Zi||(Zi={})),function(e){e.Added="Added",e.Removed="Removed",e.Updated="Updated",e.Synced="Synced"}(ea||(ea={})),function(e){e.Open="Open",e.Close="Close",e.Result="Result",e.Cancel="Cancel"}(ta||(ta={})),function(e){e.MRU="MRU",e.AlphabeticalAsc="AlphabeticalAsc",e.AlphabeticalDesc="AlphabeticalDesc"}(na||(na={})),function(e){e.AuthError="AuthError",e.Offline="Offline"}(ia||(ia={})),function(e){e.MostSevere="MostSevere",e.Severe="Severe",e.Positive="Positive",e.Neutral="Neutral"}(aa||(aa={})),function(e){e.SignIn="SignIn"}(oa||(oa={})),function(e){e.PROGRESS="PROGRESS",e.CANCELLED="CANCELLED",e.FAILED="FAILED",e.COMPLETE="COMPLETE"}(ra||(ra={})),function(e){e.Network_Only="Network_Only",e.Cache_First="Cache_First",e.Cache_Only="Cache_Only",e.Network_Debounce="Network_Debounce"}(sa||(sa={})),function(e){e.default="default",e.dark="dark",e.highContrast="highContrast"}(la||(la={})),function(e){e.edit="edit",e.send="send"}(ca||(ca={})),function(e){e.list="list",e.grid="grid"}(da||(da={})),function(e){e.result="result",e.auth="auth",e.config="config",e.message="message",e.botMessagePreview="botMessagePreview",e.silentAuth="silentAuth"}(ua||(ua={})),function(e){e.message="message",e.compose="compose",e.commandBox="commandBox"}(ma||(ma={})),function(e){e.StringAuthResult="StringAuthResult",e.JsonAuthResult="JsonAuthResult"}(pa||(pa={})),function(e){e.NoMatch="NoMatch",e.MatchButNotInstalled="MatchButNotInstalled",e.MatchButNeedAuthOrConfig="MatchButNeedAuthOrConfig",e.MatchAndPendingFetch="MatchAndPendingFetch",e.HasResult="HasResult",e.Failed="Failed"}(ga||(ga={})),function(e){e.NoCache="NoCache"}(ha||(ha={})),function(e){e.Thumbnail="Thumbnail",e.Card="Card",e.Permission="Permission"}(va||(va={})),function(e){e.New="New",e.Update="Update"}(fa||(fa={})),function(e){e.Standard="Standard",e.Announcement="Announcement",e.Email="Email",e.Meeting="Meeting"}(ya||(ya={})),function(e){e.Forward="Forward",e.Backward="Backward"}(Sa||(Sa={})),function(e){e.unread="unread",e.meeting="meeting",e.muted="muted"}(ka||(ka={})),function(e){e.like="like",e.star="star",e.heart="heart",e.laugh="laugh",e.surprised="surprised",e.sad="sad",e.angry="angry",e.acks="acks"}(ba||(ba={})),function(e){e.add="add",e.remove="remove"}(_a||(_a={})),function(e){e.add="add",e.remove="remove"}(Ca||(Ca={})),function(e){e.Create="Create",e.Update="Update"}(wa||(wa={})),function(e){e.OffensiveContent="OffensiveContent",e.Terrorism="Terrorism",e.ChildEndangermentExploitation="ChildEndangermentExploitation",e.ImminentHarmToPersonsOrProperty="ImminentHarmToPersonsOrProperty",e.VirusSpywareMalware="VirusSpywareMalware",e.Fraud="Fraud",e.ContentInfringement="ContentInfringement",e.Other="Other"}(Ta||(Ta={})),function(e){e.contact_request="contact_request",e.delete_contact="delete_contact",e.block_contact="block_contact",e.profile="profile",e.message="message",e.highlight="highlight",e.search="search",e.profile_image="profile_image"}(Ea||(Ea={})),function(e){e.confirm="confirm",e.revert="revert",e.dismiss="dismiss"}(Ia||(Ia={})),function(e){e.Google="Google"}(Na||(Na={})),function(e){e.Close="Close",e.Sync="Sync"}(Aa||(Aa={})),function(e){e.TooManyMembers="TooManyMembers",e.ErrorFetchingData="ErrorFetchingData"}(Ma||(Ma={})),function(e){e.Google="Google"}(Fa||(Fa={})),function(e){e.TeamsFreemium="TeamsFreemium",e.TflCloudCache="TflCloudCache"}(Ra||(Ra={})),function(e){e.TYPE="TYPE",e.TITLE="TITLE",e.MODIFIED="MODIFIED",e.SENTBY="SENTBY"}(Pa||(Pa={})),function(e){e.ASCENDING="ASCENDING",e.DESCENDING="DESCENDING"}(Da||(Da={})),function(e){e.GENERIC="GENERIC",e.LINK_EXPIRED="LINK_EXPIRED",e.LINK_NOT_FOUND="LINK_NOT_FOUND",e.LINK_INVALID_FORMAT="LINK_INVALID_FORMAT",e.MSA_PHONE_MISMATCH="MSA_PHONE_MISMATCH",e.MSA_PHONES_MISSING_INVALID="MSA_PHONES_MISSING_INVALID"}(ja||(ja={})),function(e){e.Thread="Thread",e.User="User"}(xa||(xa={})),function(e){e.light="light",e.dark="dark",e.contrast="contrast"}(Oa||(Oa={})),function(e){e.tflGroupTemplatesHidden="tflGroupTemplatesHidden"}(La||(La={})),function(e){e.performance="performance",e.theme="theme",e.animation="animation",e.videoEffect="videoEffect"}(Ua||(Ua={})),function(e){e.normal="normal",e.low="low"}(Ba||(Ba={})),function(e){e.AttendanceReportNodata="AttendanceReportNodata",e.AttendanceReportV3="AttendanceReportV3",e.AttendanceReportWebinar="AttendanceReportWebinar",e.RegistrationReportWebinar="RegistrationReportWebinar",e.AttendanceReportV3Overflow="AttendanceReportV3Overflow",e.AttendanceReportWebinarOverflow="AttendanceReportWebinarOverflow",e.AttendanceReportV3Breakoutroom="AttendanceReportV3Breakoutroom",e.AttendanceReportWebinarBreakoutroom="AttendanceReportWebinarBreakoutroom"}(Wa||(Wa={})),function(e){e.SearchSuggestions="SearchSuggestions",e.SearchResults="SearchResults",e.AddToChat="AddToChat",e.AddToTeam="AddToTeam",e.NewChat="NewChat",e.Transfer="Transfer",e.AddToCall="AddToCall",e.CallRouting="CallRouting",e.CallForwardGroupSelection="CallForwardGroupSelection",e.DelegationSelection="DelegationSelection",e.PresenceSettings="PresenceSettings",e.AddToMeeting="AddToMeeting",e.MeetingSchedule="MeetingSchedule",e.AddToSpeedDialOrContacts="AddToSpeedDialOrContacts",e.AtMention="AtMention",e.OrgChart="OrgChart",e.PriorityContactsSelection="PriorityContactsSelection",e.TaggedContactsSelection="TaggedContactsSelection",e.StatusNote="StatusNote",e.VoicemailTransferTarget="VoicemailTransferTarget",e.SearchExpoDisplays="SearchExpoDisplays",e.AllFalse="AllFalse",e.AllTrue="AllTrue"}(Ha||(Ha={})),function(e){e.Removed="Removed",e.Updated="Updated"}($a||($a={})),function(e){e.pdf="pdf",e.xlsx="xlsx",e.docx="docx",e.pptx="pptx",e.vsdx="vsdx",e.one="one"}(Va||(Va={})),function(e){e.WhoBotTab="WhoBotTab",e.ExtensionTab="ExtensionTab",e.WebsiteTab="WebsiteTab"}(za||(za={})),function(e){e.QueryByThread="QueryByThread",e.QueryByApp="QueryByApp",e.QueryByMessage="QueryByMessage"}(Ga||(Ga={})),function(e){e.SEARCH="SEARCH",e.PERSON="PERSON",e.GROUPCHAT="GROUPCHAT"}(qa||(qa={})),function(e){e.PEOPLE="PEOPLE",e.GROUPCHATS="GROUPCHATS",e.SEARCHES="SEARCHES",e.HISTORY="HISTORY"}(Ja||(Ja={})),function(e){e.PERSONCHAT="PERSONCHAT",e.GROUPCHAT="GROUPCHAT",e.QUERYSEARCH="QUERYSEARCH",e.POPOUT="POPOUT",e.REMOVESUGGESTION="REMOVESUGGESTION"}(Ka||(Ka={})),function(e){e.GENERATED="GENERATED",e.INDEXEDDB="INDEXEDDB",e.INVITEFLOW="INVITEFLOW",e.SCD="SCD",e.HISTORY="HISTORY",e.MT="MT"}(Qa||(Qa={})),function(e){e.ADD="ADD",e.DELETE="DELETE",e.REMOVEALL="REMOVEALL"}(Ya||(Ya={})),function(e){e.POWERBAR="POWERBAR",e.PEOPLEPICKER="PEOPLEPICKER"}(Xa||(Xa={})),function(e){e.Relevance="Relevance",e.DateTime="DateTime"}(Za||(Za={})),function(e){e.Light="Light",e.Dark="Dark",e.Contrast="Contrast",e.OSTheme="OSTheme"}(eo||(eo={})),function(e){e.None="None",e.PowerApp="PowerApp"}(to||(to={})),function(e){e.None="None",e.Promotion="Promotion"}(no||(no={})),function(e){e.Alphabetical="Alphabetical",e.Popularity="Popularity"}(io||(io={})),function(e){e.None="None",e.Bot="Bot",e.Certified="Certified",e.Connector="Connector",e.GroupChat="GroupChat",e.Meeting="Meeting",e.MessageExtension="MessageExtension",e.Personal="Personal",e.Tab="Tab"}(ao||(ao={})),function(e){e.Channel="Channel",e.Chat="Chat",e.Document="Document",e.File="File",e.Message="Message",e.People="People",e.Team="Team",e.Text="Text"}(oo||(oo={})),function(e){e.AutoStart="AutoStart"}(ro||(ro={})),function(e){e.NotJoined="NotJoined",e.Joining="Joining",e.Joined="Joined",e.Pending="Pending"}(so||(so={})),function(e){e.CreateAndDeleteTab="CreateAndDeleteTab",e.CreateAndUpdateChannel="CreateAndUpdateChannel",e.EditMessagesEnabled="EditMessagesEnabled",e.DeleteMessagesEnabled="DeleteMessagesEnabled",e.AdminDeleteEnabled="AdminDeleteEnabled",e.InstallAndUninstallApps="InstallAndUninstallApps",e.UploadCustomApp="UploadCustomApp",e.DeleteChannel="DeleteChannel",e.CreatePrivateChannel="CreatePrivateChannel",e.UpdateConnectors="UpdateConnectors",e.GeneralChannelPosting="GeneralChannelPosting",e.TeamMention="TeamMention",e.ChannelMention="ChannelMention",e.GiphyEnabled="GiphyEnabled",e.GiphyRating="GiphyRating",e.StickersEnabled="StickersEnabled",e.CustomMemesEnabled="CustomMemesEnabled",e.AddAndRemoveDisplayContent="AddAndRemoveDisplayContent"}(lo||(lo={})),function(e){e.member="member",e.guest="guest"}(co||(co={})),function(e){e.ImportContactsMsa="ImportContactsMsa",e.ImportContactsGoogle="ImportContactsGoogle",e.JoinByCode="JoinByCode"}(uo||(uo={})),function(e){e.Calling="Calling"}(mo||(mo={})),function(e){e.personalFileSite="personalFileSite",e.userPersonalSettings="userPersonalSettings",e.firstLoginInformation="firstLoginInformation",e.readReceiptsEnabled="readReceiptsEnabled",e.controllerConnectedServicesEnabled="controllerConnectedServicesEnabled",e.translationSettings="translationSettings",e.favorites="favorites",e.teamsOrder="teamsOrder",e.showInMeetingReport="showInMeetingReport",e.mobileContactsSync="mobileContactsSync"}(po||(po={})),function(e){e.Translate="Translate",e.NeverTranslate="NeverTranslate",e.Unknown="Unknown"}(go||(go={})),function(e){e.Unknown="Unknown",e.Available="Available",e.NotAvailable="NotAvailable"}(ho||(ho={})),function(e){e.Immediately="Immediately",e.Every10Mins="Every10Mins",e.Hourly="Hourly",e.EveryEightHours="EveryEightHours",e.Daily="Daily",e.Never="Never"}(vo||(vo={})),function(e){e.Daily="Daily",e.Never="Never"}(fo||(fo={})),function(e){e.MeetingsUserParticipatesIn="MeetingsUserParticipatesIn",e.MeetingsUserIsInvitedTo="MeetingsUserIsInvitedTo",e.MeetingsManuallyUnmuted="MeetingsManuallyUnmuted"}(yo||(yo={})),function(e){e.Teams="Teams",e.Desktop="Desktop",e.Web="Web",e.Unknown="Unknown"}(So||(So={})),function(e){e.On="On",e.Off="Off",e.BannerAndFeed="BannerAndFeed",e.OnlyFeed="OnlyFeed",e.OnlyBanner="OnlyBanner",e.All="All",e.CallMentionChats="CallMentionChats"}(ko||(ko={}))},669673:(e,t,n)=>{"use strict";n.d(t,{g_h:()=>i});const i={possibleTypes:{MeetingCoordinates:["LegacyMeetingCoordinates","MeetingDataCoordinates"],CallingServiceEvent:["CallAdded","CallRemoved","CallUpdated","CallAlertsUpdated","CallDeviceListUpdated"],CallTransfer:["CallTransferred","CallTransferredFailed","CallTransferredSucceeded"],ParticipantsChangedEvent:["ParticipantsChanged","ParticipantCountsChanged"],CallAudienceBotDataChannel:["CallAudienceSceneChanged","CallAudienceSelectSceneAck"],CortanaEvent:["CortanaInvocationStateChanged","CortanaStateChanged"],SharingEvent:["ScreenShareControlEvent"],CallingAppEventType:["CallingContentEvent","CallingAppSetupEvent"],CallingContent:["CallingWindowingContent","CallingDialogContent","CallingNotificationContent","CallingToChatContent","CallingToChatListContent","CallingToCallListContent"],ParkedCall:["RegularParkedCall","SLAParkedCall"],HolographicAnnotationEvent:["HolographicAnnotationCreatedEvent","HolographicAnnotationModifiedEvent","HolographicAnnotationRemovedEvent","HolographicInteractionEnabledEvent","HolographicInteractionInitializedEvent","HolographicInteractionComponentChangedEvent","HolographicSnapshotEnabledEvent","HolographicResetEvent","HolographicFreezeFrameEvent"],VideoEffectConfigChanged:["TouchUpToggleChanged","TouchUpStrengthChanged","AutoAdjustToggleChanged","EyeContactToggleChanged"],ContentSharingSession:["PptSharingSession","WhiteboardSharingSession"],ActionStatusEvent:["SendMessageActionData","ReactionsActionData","ErrorActionData"],CallCoordinates:["LegacyMeetingCoordinates","MeetingDataCoordinates","ExistingCallCoordinates","OneToOneCoordinates","GroupCallCoordinates"],CallJoinOptions:["JoinOptions","MeetingJoinOptions","OneToOneJoinOptions","GroupCallJoinOptions"],IConnection:["ContactsSuggestionsConnection","ActivitiesConnection","ReplyChainSummaryConnection","ReplyChainMessageConnection","ChatsConnection","SearchTeamConnection"],IEdge:["ContactsSuggestionsEdge","ActivityEdge","ReplyChainSummaryEdge","ReplyChainMessagesEdge","ChatsEdge","SearchTeamsEdge"],IEdgeNode:["ContactsSuggestionsItem","Conversation","FeedActivity","ReplyChainSummary","ReplyChainMessageNode","DiscoverTeamDetails"],IMessage:["Message","LastMessage","ReplyChainMessage","StandardPostMessage","AnnouncementPostMessage","EmailPostMessage","MeetingPostMessage"],Dimension:["DimensionInFloat","DimensionInString"],TeamsAndChannelsUpdateEvent:["TeamUpdate","ChannelUpdate"],PinnedConversationItemInfo:["Message"],CalendarMultiSlotEventPayload:["CalendarFormCacheSyncEvent","CalendarFormSpinnerEvent","CalendarFormShareDialogEvent","CalendarFormErrorEvent"],Mentionable:["TagCard","User","ChannelMentionSearchResult","AppDefinition","CommandDefinition"],TileBarIcon:["FluentUIIcon","RemoteImage"],TileBarBadge:["TileBarNumericBadge"],AppBarIcon:["InternalIcon","RemoteImage"],LaunchTileBadge:["LaunchTileNumericBadge"],InvokeAdaptiveCardTabResult:["AdaptiveCardTabContinue","AdaptiveCardTabDone","AdaptiveCardTabAuth"],InvokeTaskModuleResult:["TaskModuleTaskContinue","TaskModuleTaskMessage","TaskModuleTaskDone"],MessageExtensionTaskResult:["TaskModuleTaskContinue","TaskModuleTaskMessage","TaskModuleTaskDone","MessageExtensionResult"],AdaptiveCardTabTaskResult:["TaskModuleTaskContinue","TaskModuleTaskMessage","TaskModuleTaskDone","AdaptiveCardTabContinue"],IPostMessage:["StandardPostMessage","AnnouncementPostMessage","EmailPostMessage","MeetingPostMessage"],ChannelPostMessage:["StandardPostMessage","AnnouncementPostMessage","EmailPostMessage","MeetingPostMessage"],ChannelMessage:["ReplyChainMessage","StandardPostMessage","AnnouncementPostMessage","EmailPostMessage","MeetingPostMessage"],ConversationPinnedResult:["ConversationPinnedUpdate","SetChatPinnedMaxLimitReachedError"],ChatServiceEvent:["NewMessage","MessageUpdate","ThreadUpdate","ConversationUpdate","ConsumptionHorizonUpdate","ResolveConversationLie","DiscardConversation","NotificationUpdate"],ClientPreferenceCategoryTypes:["PerformancePreferences","ThemePreferences","AnimationPreferences","VideoEffectPreferences"],PlatformTab:["BasicTab","ExtensionTab","WikiTab","FileViewTab","PowerBiTab","WebsiteTab","DocumentLibraryTab","OneNoteTab","StaticExtensionTab"],PresenceError:["PresenceErrorGeneric","PresenceErrorNetworkOffline"],PresenceResult:["PresenceSuccess","PresenceErrorNetworkOffline","PresenceErrorGeneric"],BaseSearchSuggestionEntity:["PeopleSearchSuggestionEntity","GroupChatSearchSuggestionEntity","QuerySearchSuggestionEntity"],SearchSuggestionNavigationObject:["PeopleSuggestionNavigation","ConversationSuggestionNavigation","QuerySuggestionNavigation"],SearchSuggestionEntity:["PeopleSearchSuggestionEntity","GroupChatSearchSuggestionEntity","QuerySearchSuggestionEntity"],AllSearchResults:["SearchFileResult","PeopleSearchResult"],UserPreferencesResponse:["UserPreferences","UserPreferencesError"]}}.possibleTypes},698135:(e,t,n)=>{"use strict";n.d(t,{E:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"appDefinition"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AppDefinition"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"developerName"}},{kind:"Field",name:{kind:"Name",value:"developerUrl"}},{kind:"Field",name:{kind:"Name",value:"privacyUrl"}},{kind:"Field",name:{kind:"Name",value:"termsOfUseUrl"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"shortDescription"}},{kind:"Field",name:{kind:"Name",value:"longDescription"}},{kind:"Field",name:{kind:"Name",value:"smallImageUrl"}},{kind:"Field",name:{kind:"Name",value:"largeImageUrl"}},{kind:"Field",name:{kind:"Name",value:"accentColor"}},{kind:"Field",name:{kind:"Name",value:"categories"}},{kind:"Field",name:{kind:"Name",value:"validDomains"}},{kind:"Field",name:{kind:"Name",value:"externalId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"isFullScreenApp"}},{kind:"Field",name:{kind:"Name",value:"isFullTrustApp"}},{kind:"Field",name:{kind:"Name",value:"showTabLoadingIndicator"}},{kind:"Field",name:{kind:"Name",value:"bots"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"botDefinition"}}]}},{kind:"Field",name:{kind:"Name",value:"connectors"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"connectorId"}},{kind:"Field",name:{kind:"Name",value:"scopes"}}]}},{kind:"Field",name:{kind:"Name",value:"galleryTabs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"configurationUrl"}},{kind:"Field",name:{kind:"Name",value:"canUpdateConfiguration"}},{kind:"Field",name:{kind:"Name",value:"canHaveTabConversation"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"meetingSurfaces"}},{kind:"Field",name:{kind:"Name",value:"context"}}]}},{kind:"Field",name:{kind:"Name",value:"staticTabs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"entityId"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"order"}},{kind:"Field",name:{kind:"Name",value:"contentUrl"}},{kind:"Field",name:{kind:"Name",value:"contentBotId"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"context"}},{kind:"Field",name:{kind:"Name",value:"containerAppIds"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingExtensionDefinition"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isAnonymousAccessAllowed"}},{kind:"Field",name:{kind:"Name",value:"supportsStreaming"}},{kind:"Field",name:{kind:"Name",value:"scenes"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"file"}},{kind:"Field",name:{kind:"Name",value:"preview"}},{kind:"Field",name:{kind:"Name",value:"maxAudience"}},{kind:"Field",name:{kind:"Name",value:"seatsReservedForOrganizersOrPresenters"}}]}},{kind:"Field",name:{kind:"Name",value:"filters"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"thumbnail"}}]}},{kind:"Field",name:{kind:"Name",value:"videoAppContentUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"authorization"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"permissions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"orgWide"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}},{kind:"Field",name:{kind:"Name",value:"resourceSpecific"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"messageExtensions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"botId"}},{kind:"Field",name:{kind:"Name",value:"canUpdateConfiguration"}},{kind:"Field",name:{kind:"Name",value:"fetchCommands"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"commands"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"context"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"initialRun"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"parameters"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"inputType"}},{kind:"Field",name:{kind:"Name",value:"value"}},{kind:"Field",name:{kind:"Name",value:"choices"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"appKey"}},{kind:"Field",name:{kind:"Name",value:"fetchTask"}},{kind:"Field",name:{kind:"Name",value:"taskInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"height"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"width"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"messageHandlers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"value"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"domains"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"webApplicationInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"resource"}},{kind:"Field",name:{kind:"Name",value:"applicationPermissions"}}]}},{kind:"Field",name:{kind:"Name",value:"screenshotUrls"}},{kind:"Field",name:{kind:"Name",value:"officeAssetId"}},{kind:"Field",name:{kind:"Name",value:"videoUrl"}},{kind:"Field",name:{kind:"Name",value:"devicePermissions"}},{kind:"Field",name:{kind:"Name",value:"securityComplianceInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mcasId"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"csaId"}},{kind:"Field",name:{kind:"Name",value:"csaName"}}]}},{kind:"Field",name:{kind:"Name",value:"defaultInstallScope"}},{kind:"Field",name:{kind:"Name",value:"defaultGroupCapability"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"team"}},{kind:"Field",name:{kind:"Name",value:"groupchat"}},{kind:"Field",name:{kind:"Name",value:"meetings"}}]}},{kind:"Field",name:{kind:"Name",value:"subscriptionOffer"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"offerId"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"botDefinition"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BotDefinition"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"capabilities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isNotificationOnly"}},{kind:"Field",name:{kind:"Name",value:"supportsFiles"}},{kind:"Field",name:{kind:"Name",value:"supportsCalling"}},{kind:"Field",name:{kind:"Name",value:"supportsVideo"}}]}},{kind:"Field",name:{kind:"Name",value:"commandLists"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"commands"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}}]}},{kind:"Field",name:{kind:"Name",value:"scopes"}}]}}]}}]}},364521:(e,t,n)=>{"use strict";n.d(t,{K:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"broadcastFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Broadcast"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"userRole"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"correlationId"}},{kind:"Field",name:{kind:"Name",value:"streamingDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"streamingDetailsFields"}}]}},{kind:"Field",name:{kind:"Name",value:"qna"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isEnabled"}},{kind:"Field",name:{kind:"Name",value:"attendeeUrl"}},{kind:"Field",name:{kind:"Name",value:"moderatorUrl"}},{kind:"Field",name:{kind:"Name",value:"iosAutodiscoverUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"yammer"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isEnabled"}},{kind:"Field",name:{kind:"Name",value:"broadcastId"}},{kind:"Field",name:{kind:"Name",value:"groupId"}},{kind:"Field",name:{kind:"Name",value:"eventUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingStatus"}},{kind:"Field",name:{kind:"Name",value:"sdn"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"sdnFields"}}]}},{kind:"Field",name:{kind:"Name",value:"transcription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isEnabled"}},{kind:"Field",name:{kind:"Name",value:"isSuppressed"}},{kind:"Field",name:{kind:"Name",value:"transcriptionLanguage"}},{kind:"Field",name:{kind:"Name",value:"translationLanguages"}},{kind:"Field",name:{kind:"Name",value:"captionsCacheUrl"}},{kind:"Field",name:{kind:"Name",value:"captionsOriginUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"aesKey"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"iv"}},{kind:"Field",name:{kind:"Name",value:"expiry"}},{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"aesKeyRefresh"}},{kind:"Field",name:{kind:"Name",value:"error"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"errorFields"}}]}},{kind:"Field",name:{kind:"Name",value:"utcStart"}},{kind:"Field",name:{kind:"Name",value:"utcEnd"}},{kind:"Field",name:{kind:"Name",value:"location"}},{kind:"Field",name:{kind:"Name",value:"supportUrl"}},{kind:"Field",name:{kind:"Name",value:"streamResource"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"attendeeEmbed"}}]}},{kind:"Field",name:{kind:"Name",value:"signalR"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"attendeeHubName"}},{kind:"Field",name:{kind:"Name",value:"eventTeamHubName"}},{kind:"Field",name:{kind:"Name",value:"setCookieUrl"}},{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"querystrings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"joinid"}},{kind:"Field",name:{kind:"Name",value:"msgid"}},{kind:"Field",name:{kind:"Name",value:"organizerid"}},{kind:"Field",name:{kind:"Name",value:"tenantid"}},{kind:"Field",name:{kind:"Name",value:"threadid"}},{kind:"Field",name:{kind:"Name",value:"uid"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"broadcastRestartVersion"}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"streamingDetailsFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BroadcastStreamingDetails"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"stream"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"streamFields"}}]}},{kind:"Field",name:{kind:"Name",value:"altStream"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"streamFields"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"streamFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BroadcastStreamingInfo"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"wamsStreamingUrl"}},{kind:"Field",name:{kind:"Name",value:"decryptionToken"}}]}}]}.definitions,{kind:"FragmentDefinition",name:{kind:"Name",value:"sdnFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"SDNDetails"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"playbackInfo"}},{kind:"Field",name:{kind:"Name",value:"pluginUrl"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"errorFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BroadcastErrorDetails"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"errorMessage"}},{kind:"Field",name:{kind:"Name",value:"errorCode"}},{kind:"Field",name:{kind:"Name",value:"code"}},{kind:"Field",name:{kind:"Name",value:"errorSubCode"}}]}}]}},362142:(e,t,n)=>{"use strict";n.d(t,{h:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingAlert"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingAlert"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"teamsCallId"}},{kind:"Field",name:{kind:"Name",value:"timestamp"}},{kind:"Field",name:{kind:"Name",value:"alertType"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"text"}},{kind:"Field",name:{kind:"Name",value:"ariaText"}},{kind:"Field",name:{kind:"Name",value:"severity"}},{kind:"Field",name:{kind:"Name",value:"actions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"action"}}]}},{kind:"Field",name:{kind:"Name",value:"dismissable"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"action"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AlertAction"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"text"}},{kind:"Field",name:{kind:"Name",value:"isSecondary"}},{kind:"Field",name:{kind:"Name",value:"actionId"}}]}}]}},23285:(e,t,n)=>{"use strict";n.d(t,{v:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"consumptionHorizonBookmarkFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ConsumptionHorizonBookmark"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"timeStamp"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}}]}}]}},837824:(e,t,n)=>{"use strict";n.d(t,{T:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"consumptionHorizonFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ConsumptionHorizon"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"timeStamp"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}}]}}]}},580786:(e,t,n)=>{"use strict";n.d(t,{W:()=>o});var i=n(756319),a=n(698135);const o={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"installedAppFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"InstalledApp"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedScope"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"installationState"}},{kind:"Field",name:{kind:"Name",value:"installedAppProps"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isUninstallable"}},{kind:"Field",name:{kind:"Name",value:"isAdminPreInstalled"}}]}},{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"installedVersion"}},{kind:"Field",name:{kind:"Name",value:"messageExtensionStates"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"messageExtensionState"}}]}},{kind:"Field",name:{kind:"Name",value:"definition"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"appDefinition"}}]}},{kind:"Field",name:{kind:"Name",value:"permissions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"appPermissions"}}]}}]}},...i.l.definitions,...a.E.definitions,{kind:"FragmentDefinition",name:{kind:"Name",value:"appPermissions"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AppPermissions"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"orgWide"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}},{kind:"Field",name:{kind:"Name",value:"resourceSpecific"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]}},977528:(e,t,n)=>{"use strict";n.d(t,{T:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"lastMessageFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"LastMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"mentionType"}}]}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appIcon"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appName"}},{kind:"Field",name:{kind:"Name",value:"cardClientId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"contentType"}},{kind:"Field",name:{kind:"Name",value:"locale"}}]}}]}}]}},876850:(e,t,n)=>{"use strict";n.d(t,{q:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"meetingInformationFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingInformation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"iCalUid"}},{kind:"Field",name:{kind:"Name",value:"scenario"}},{kind:"Field",name:{kind:"Name",value:"meetingType"}},{kind:"Field",name:{kind:"Name",value:"meetingData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"meetingCode"}},{kind:"Field",name:{kind:"Name",value:"meetingUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"isCancelled"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"eventType"}},{kind:"Field",name:{kind:"Name",value:"isRecurring"}}]}}]}},756319:(e,t,n)=>{"use strict";n.d(t,{l:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"messageExtensionState"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MessageExtensionState"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"botId"}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"pinOrder"}}]}}]}},740946:(e,t,n)=>{"use strict";n.d(t,{U:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"messageFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"callId"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"interopDeliveryState"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"smsDeliveryReports"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"users"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mri"}},{kind:"Field",name:{kind:"Name",value:"time"}},{kind:"Field",name:{kind:"Name",value:"errorCode"}},{kind:"Field",name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"users"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"count"}}]}},{kind:"Field",name:{kind:"Name",value:"escalations"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"users"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mri"}},{kind:"Field",name:{kind:"Name",value:"time"}},{kind:"Field",name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"mentionType"}}]}},{kind:"Field",name:{kind:"Name",value:"meeting"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"organizerId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"meetingTitle"}},{kind:"Field",name:{kind:"Name",value:"meetingJoinUrl"}},{kind:"Field",name:{kind:"Name",value:"location"}},{kind:"Field",name:{kind:"Name",value:"meetingJoinUrl"}},{kind:"Field",name:{kind:"Name",value:"location"}},{kind:"Field",name:{kind:"Name",value:"rsvpTo"}},{kind:"Field",name:{kind:"Name",value:"body"}},{kind:"Field",name:{kind:"Name",value:"scheduledMeetingInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"exchangeId"}},{kind:"Field",name:{kind:"Name",value:"iCalUID"}},{kind:"Field",name:{kind:"Name",value:"isCancelled"}},{kind:"Field",name:{kind:"Name",value:"eventType"}},{kind:"Field",name:{kind:"Name",value:"eventRecurrenceRange"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startDate"}},{kind:"Field",name:{kind:"Name",value:"endDate"}}]}},{kind:"Field",name:{kind:"Name",value:"eventRecurrencePattern"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"patternType"}},{kind:"Field",name:{kind:"Name",value:"daily"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"weekly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"daysOfTheWeek"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"monthly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dayOfMonth"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"relativeMonthly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dayOfTheWeekIndex"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeek"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"yearly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"month"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheMonth"}}]}},{kind:"Field",name:{kind:"Name",value:"relativeYearly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"month"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeekIndex"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeek"}}]}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"mentionType"}}]}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appIcon"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appName"}},{kind:"Field",name:{kind:"Name",value:"cardClientId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"contentType"}},{kind:"Field",name:{kind:"Name",value:"locale"}}]}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"diagnosticInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"diagnosticErrorCode"}},{kind:"Field",name:{kind:"Name",value:"diagnosticMessage"}}]}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"chicletBreadcrumbs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sourceTeamName"}},{kind:"Field",name:{kind:"Name",value:"sourceChannelName"}}]}},{kind:"Field",name:{kind:"Name",value:"baseUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"shareId"}},{kind:"Field",name:{kind:"Name",value:"shareUrl"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"previewUrl"}},{kind:"Field",name:{kind:"Name",value:"previewHeight"}},{kind:"Field",name:{kind:"Name",value:"previewWidth"}},{kind:"Field",name:{kind:"Name",value:"progressComplete"}},{kind:"Field",name:{kind:"Name",value:"hasUploadFailed"}},{kind:"Field",name:{kind:"Name",value:"serviceName"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"urlPreview"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"previewEnabled"}},{kind:"Field",name:{kind:"Name",value:"thumbnail"}},{kind:"Field",name:{kind:"Name",value:"thumbnailMeta"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"embeddedLinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"fileShareUrlMeta"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"shareUrl"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"policyViolation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"verdictDetails"}},{kind:"Field",name:{kind:"Name",value:"dlpAction"}},{kind:"Field",name:{kind:"Name",value:"genericStreamItemId"}},{kind:"Field",name:{kind:"Name",value:"state"}},{kind:"Field",name:{kind:"Name",value:"justificationText"}},{kind:"Field",name:{kind:"Name",value:"userAction"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"policyTip"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"generalText"}},{kind:"Field",name:{kind:"Name",value:"complianceUrl"}},{kind:"Field",name:{kind:"Name",value:"matchedConditionDescriptions"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"userHasSaved"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"fromLanguage"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"URL"}},{kind:"Field",name:{kind:"Name",value:"Xsdata"}},{kind:"Field",name:{kind:"Name",value:"Sdata"}}]}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}}]}}]}},236681:(e,t,n)=>{"use strict";n.d(t,{u_:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"participantFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Participant"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isServerMuted"}},{kind:"Field",name:{kind:"Name",value:"isHandRaised"}},{kind:"Field",name:{kind:"Name",value:"raiseHandsRank"}},{kind:"Field",name:{kind:"Name",value:"isSpotlighted"}},{kind:"Field",name:{kind:"Name",value:"spotlightRank"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"state"}},{kind:"Field",name:{kind:"Name",value:"isReconciled"}},{kind:"Field",name:{kind:"Name",value:"streams"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"participantStreamFields"}}]}},{kind:"Field",name:{kind:"Name",value:"audio"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"participantStreamFields"}}]}},{kind:"Field",name:{kind:"Name",value:"isFake"}},{kind:"Field",name:{kind:"Name",value:"isVideoLive"}},{kind:"Field",name:{kind:"Name",value:"isScreenShareLive"}},{kind:"Field",name:{kind:"Name",value:"meetingRole"}},{kind:"Field",name:{kind:"Name",value:"stateReason"}},{kind:"Field",name:{kind:"Name",value:"contentSharingRole"}},{kind:"Field",name:{kind:"Name",value:"participantId"}},{kind:"Field",name:{kind:"Name",value:"visible"}},{kind:"Field",name:{kind:"Name",value:"holographicDevice"}},{kind:"Field",name:{kind:"Name",value:"timeZoneOffset"}},{kind:"Field",name:{kind:"Name",value:"endpoints"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"endpointDetailsFields"}}]}},{kind:"Field",name:{kind:"Name",value:"weathermanModeDetail"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"weathermanModeDetailFields"}}]}},{kind:"Field",name:{kind:"Name",value:"mappedTo"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"participantStreamFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ParticipantStream"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isAvailable"}},{kind:"Field",name:{kind:"Name",value:"isStreaming"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"rank"}},{kind:"Field",name:{kind:"Name",value:"negotiationTag"}},{kind:"Field",name:{kind:"Name",value:"participantLegId"}},{kind:"Field",name:{kind:"Name",value:"label"}},{kind:"Field",name:{kind:"Name",value:"endpointId"}},{kind:"Field",name:{kind:"Name",value:"sourceId"}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"endpointDetailsFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EndpointDetails"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"originalId"}},{kind:"Field",name:{kind:"Name",value:"clientEndpointCapabilities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"clientEndpointCapabilitiesFields"}}]}},{kind:"Field",name:{kind:"Name",value:"endpointId"}},{kind:"Field",name:{kind:"Name",value:"endpointMetadata"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"audienceview"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"page"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}},{kind:"Field",name:{kind:"Name",value:"botData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"hiddenParticipant"}},{kind:"Field",name:{kind:"Name",value:"hiddenStream"}},{kind:"Field",name:{kind:"Name",value:"canBeMutedAndUnMuted"}},{kind:"Field",name:{kind:"Name",value:"page"}},{kind:"Field",name:{kind:"Name",value:"role"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"clientEndpointCapabilitiesFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ClientEndpointCapabilities"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"CanSupportBreakOutRoom"}}]}}]}.definitions,{kind:"FragmentDefinition",name:{kind:"Name",value:"weathermanModeDetailFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WeathermanModeDetail"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isWeatherpersonPresenter"}},{kind:"Field",name:{kind:"Name",value:"overlayCoords"}}]}}]}},723508:(e,t,n)=>{"use strict";n.d(t,{E:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"pinnedMessageItemFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}},738632:(e,t,n)=>{"use strict";n.d(t,{l:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"typingUserFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"TypingUser"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"arrivalTime"}}]}}]}},359261:(e,t,n)=>{"use strict";n.d(t,{o:()=>i,f:()=>a});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"featureSettingsFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"UserFeatureSettingsInfo"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"coExistenceMode"}},{kind:"Field",name:{kind:"Name",value:"isPrivateChatEnabled"}}]}}]},a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"userFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"User"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"givenName"}},{kind:"Field",name:{kind:"Name",value:"surname"}},{kind:"Field",name:{kind:"Name",value:"email"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"isFederated"}},{kind:"Field",name:{kind:"Name",value:"jobTitle"}},{kind:"Field",name:{kind:"Name",value:"department"}},{kind:"Field",name:{kind:"Name",value:"featureSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"featureSettingsFields"}}]}},{kind:"Field",name:{kind:"Name",value:"type"}}]}},...i.definitions]}},800189:(e,t,n)=>{"use strict";n.d(t,{I:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"userProperties"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ConversationUserProperties"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isMutedInChannel"}}]}}]}},110451:(e,t,n)=>{"use strict";n.r(t),n.d(t,{resolvers:()=>u,typeDefs:()=>g});var i=n(231191),a=n(695185),o=n(324819),r=n(682796),s=n(143076),l=n(497999),c=n(332304),d=n(132887);const u={Query:{authenticationUsers(e,{filter:t},{authenticationService:n}){var a,o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){return m(null!==(o=yield null===(a=null==n?void 0:n.getCachedUsers)||void 0===a?void 0:a.call(n,t))&&void 0!==o?o:[])}))},authenticatedUser(e,{allowAnon:t,correlationId:n,tenantId:a,loginHint:o},{authenticationService:r}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=yield r.getUser({allowAnon:t,correlationId:n,tenantId:null!=a?a:void 0,loginHint:null!=o?o:void 0});return e?p(e):null}))},authenticationToken(e,{resource:t,acquireTokenOptions:n},{authenticationService:a,windowId:o}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return{token:yield a.acquireToken(t,{claim:(null==n?void 0:n.claim)||void 0,windowId:o||void 0,silent:n&&null!=n.silent?n.silent:void 0})}}))},hostMachineUsers(e,t,{authenticationService:n,loggerFactory:a}){var r;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=null==a?void 0:a.newLogger("AuthenticationService");return(yield null===(r=n.getHostMachineUsers)||void 0===r?void 0:r.call(n,(0,o.v4)()).catch((t=>e&&e.warn(`[resolvers][hostMachineUsers] ${t.code||t.errorCode} - ${t.message}`))))||[]}))}},Mutation:{authenticateUser(e,{correlationId:t,loginHint:n},{authenticationService:a,windowId:s,coreSettings:l,loggerFactory:c}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=null==c?void 0:c.newLogger("AuthenticationService"),u={correlation:{id:null!=t?t:(0,o.v4)(),source:"login-mutation",scenarioName:"auth_web_login",scenarioPhase:"InteractiveSignIn"},loginHint:null!=n?n:"",windowId:s||void 0,silent:!1,prompt:"login"};return a.login(u).then((()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){return p((yield a.getCachedUsers({isAuthenticated:!0}))[0])})))).catch((t=>{var n;if(null==e||e.warn(`[resolvers][authenticateUser] Failed with error: ${t.code||t.errorCode} - isExpected: ${t.isExpected}. ${t.message}.`),t.code=null!==(n=t.code)&&void 0!==n?n:t.errorCode,!t.isExpected||t.errorCode===d.SM.SignInRestrictions||!l.get(r.J.Auth).disableOfflineErrors&&function(e){switch(e){case d.wK.NoNetwork:case d.SM.RemoteOperationFailed:return!0;default:return!1}}(t.errorCode))throw null==e||e.error("[resolvers][authenticateUser] Warning above is fatal. Failing mutation."),t;return null==e||e.log("[resolvers][authenticateUser] Warning above is expected. Ignoring failure."),null}))}))},authenticationLogout(e,t,{authenticationService:n}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return n.logout?n.logout(t).then((()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){return{succeed:!0}})))).catch((()=>({succeed:!1}))):{succeed:!1}}))},reauthenticateUser(e,t,{authenticationService:n,coreSettings:a,windowId:o}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{mtResource:e,criticalResources:t}=(null==a?void 0:a.get(r.J.Auth))||{},i=e||s.K$,l=(null==t?void 0:t[0])||i,c={prompt:"login",forceRenew:!0,loginRedirect:!1,windowId:o||void 0};return n.acquireToken(l,c).then((()=>({success:!0}))).catch((()=>({success:!1})))}))}},Subscription:{authenticationUsersEvent:{subscribe(e,{filter:t},{authenticationService:n}){return(0,i.__asyncGenerator)(this,arguments,(function*(){var e,a;try{for(var o,r=(0,i.__asyncValues)(n.getUsersIterator(t));!(o=yield(0,i.__await)(r.next())).done;){const e=o.value;yield yield(0,i.__await)({authenticationUsersEvent:{authenticationUsers:m(e)}})}}catch(t){e={error:t}}finally{try{o&&!o.done&&(a=r.return)&&(yield(0,i.__await)(a.call(r)))}finally{if(e)throw e.error}}}))}},authenticationStateChanged:{subscribe(e,t,{authStateProvider:n}){return(0,i.__asyncGenerator)(this,arguments,(function*(){var e,t;const o=new a((e=>{const t=null==n?void 0:n.observe();t?null==t||t.subscribe((t=>{e.next(t)})):e.next(s.jq.Up)}));try{for(var r,c=(0,i.__asyncValues)((0,l.Z)(o));!(r=yield(0,i.__await)(c.next())).done;){const e=r.value;yield yield(0,i.__await)({authenticationStateChanged:{authenticationState:e}})}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=c.return)&&(yield(0,i.__await)(t.call(c)))}finally{if(e)throw e.error}}}))}}}};function m(e){return e.map(p)}function p(e){const t=(0,c.K)(e),n=t.profile,{upn:i}=e.profile;return Object.assign(Object.assign({},t),{__typename:"AuthenticationUser",id:n.objectId,profile:Object.assign(Object.assign({},n),{__typename:"AuthenticationUserProfile",upn:i}),isAuthenticated:!!t.isAuthenticated})}var g=n(854621)},803878:(e,t,n)=>{"use strict";n.d(t,{w:()=>R,s:()=>F});var i=n(231191),a=n(635649);const o=e=>e&&!!e.wamsStreamingUrl&&!!e.decryptionToken,r=(e,t,n)=>{var i,r,s;return{__typename:"Broadcast",id:e,type:t?a.BroadcastType.Overflow:a.BroadcastType.QuickStart,userRole:n.userRole||a.BroadcastParticipantRole.Attendee,correlationId:n.correlationId,title:n.subject,utcStart:n.utcStart||null,utcEnd:n.utcEnd||null,location:n.location||null,streamingDetails:c(e,n),qna:Object.assign(Object.assign({},n.qna),{isEnabled:(null===(i=n.qna)||void 0===i?void 0:i.isEnabled)||!1,attendeeUrl:(null===(r=n.qna)||void 0===r?void 0:r.attendeeUrl)||"",moderatorUrl:(null===(s=n.qna)||void 0===s?void 0:s.moderatorUrl)||"",__typename:"BroadcastQnaMetadata"}),yammer:n.yammer&&{__typename:"BroadcastYammerMetadata",broadcastId:n.yammer.broadcastId,groupId:n.yammer.groupId,isEnabled:n.yammer.isEnabled,eventUrl:n.yammer.event}||null,meetingStatus:n.meetingStatus||(o(n.stream)||o(n.altStream)?a.MeetingStatus.Live:a.MeetingStatus.Created),supportUrl:n.supportUrl,sdn:u(n)||null,transcription:p(e,n),aesKey:Object.assign({__typename:"AESKey"},g(n)),aesKeyRefresh:n.aesKeyRefresh,error:n.error||null,signalR:Object.assign({__typename:"SignalRDetails"},h(n)),streamResource:v(n),broadcastRestartVersion:n.broadcastRestartVersion||0}},s=e=>({__typename:"BroadcastAttendeeStream",wamsStreamingUrl:null==e?void 0:e.wamsStreamingUrl,decryptionToken:null==e?void 0:e.decryptionToken}),l=e=>({__typename:"BroadcastStreamingInfo",wamsStreamingUrl:(null==e?void 0:e.wamsStreamingUrl)||null,decryptionToken:(null==e?void 0:e.decryptionToken)||null}),c=(e,t)=>({__typename:"BroadcastStreamingDetails",id:e,stream:l(t.stream),altStream:l(t.altStream)}),d=e=>e.sdnName&&e.sdnPluginUrl&&{__typename:"SDNDetails",name:e.sdnName,playbackInfo:e.sdnPlaybackInfo||"",pluginUrl:e.sdnPluginUrl}||void 0,u=e=>e.stream&&d(e.stream)||e.altStream&&d(e.altStream),m=e=>e/1e3,p=(e,t)=>{var n,i,a,o,r,s;return{__typename:"BroadcastTranscription",id:e,isEnabled:null===(n=t.transcription)||void 0===n?void 0:n.isEnabled,isSuppressed:null===(i=t.transcription)||void 0===i?void 0:i.isSuppressed,translationLanguages:null===(a=t.transcription)||void 0===a?void 0:a.translationLanguages,transcriptionLanguage:null===(o=t.transcription)||void 0===o?void 0:o.transcriptionLanguage,captionsOriginUrl:null===(r=t.transcription)||void 0===r?void 0:r.captionsOriginUrl,captionsCacheUrl:null===(s=t.transcription)||void 0===s?void 0:s.captionsCacheUrl}},g=e=>{var t,n,i,a;return{id:(null===(t=e.aesKey)||void 0===t?void 0:t.id)||"",iv:(null===(n=e.aesKey)||void 0===n?void 0:n.iv)||"",expiry:(null===(i=e.aesKey)||void 0===i?void 0:i.expiry)||"",key:(null===(a=e.aesKey)||void 0===a?void 0:a.key)||""}},h=e=>{var t,n,i,a,o;return{attendeeHubName:(null===(t=null==e?void 0:e.signalR)||void 0===t?void 0:t.attendeeHubName)||null,eventTeamHubName:(null===(n=null==e?void 0:e.signalR)||void 0===n?void 0:n.eventTeamHubName)||null,url:(null===(i=null==e?void 0:e.signalR)||void 0===i?void 0:i.url)||null,querystrings:(null===(a=null==e?void 0:e.signalR)||void 0===a?void 0:a.querystrings)||null,setCookieUrl:(null===(o=null==e?void 0:e.signalR)||void 0===o?void 0:o.setCookieUrl)||null}},v=e=>{var t;return{__typename:"StreamResource",attendeeEmbed:(null===(t=e.streamResource)||void 0===t?void 0:t.attendeeEmbed)||""}};const f={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"broadcast"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"roleHint"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"broadcast"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"roleHint"},value:{kind:"Variable",name:{kind:"Name",value:"roleHint"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"broadcastFragment"}}]}}]}},...n(364521).K.definitions]};var y=n(549717);const S=e=>{const[t,n,i,a,o]=e.split("__");return{tenantId:t,organizerId:n,threadId:i,messageId:a,sessionId:o}},k=(e,t,n,a,o,s)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){try{const i=e.readQuery({query:f,variables:{id:t}});if(i)return i.broadcast;{const i=yield n.getAttendeeMeeting(a),l=r(t,o,i);return b(e,s,t,l),l}}catch(e){throw s.error(e),e}})),b=(e,t,n,i)=>{const a={broadcast:i};try{e.writeQuery({query:f,variables:{id:n},data:a})}catch(e){t.error(e)}},_=(e,t,n,a,o,r,s,l,c)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(C(e))return!1;const i=w(s,a,o,c,l),d=N(a,n),u=A(a,r,n,i,l,s,o);try{return e.signalR&&e.signalR.url&&!e.error?(yield t.subscribeToBroadcast(a,e.signalR,i,d,u),!0):!e.error&&(n.startPollingAttendeeMeeting(a,r,i),!0)}catch(e){return l.error(e),n.startPollingAttendeeMeeting(a,r,i),!0}})),C=e=>{var t;return e.meetingStatus===a.MeetingStatus.Stopped&&(null===(t=e.streamingDetails)||void 0===t?void 0:t.stream.wamsStreamingUrl)},w=(e,t,n,i,a)=>(o,s)=>{try{const l=i.readQuery({query:f,variables:{id:t}}),d=null==l?void 0:l.broadcast;let u;if(d)if(u=Object.assign({},d),s===y.N.transcriptionStateUpdate)u.transcription=p(t,o);else if(s===y.N.streamUpdateHubEvent){const e=c(t,o);if(T(e,d.streamingDetails))return;u.streamingDetails=E(d,e),u.broadcastRestartVersion=o.broadcastRestartVersion,u.meetingStatus=I(d.broadcastRestartVersion,o.broadcastRestartVersion)}else u=Object.assign({},r(t,n,o));else u=Object.assign({},r(t,n,o));e.publish(`${y.V}-${t}`,{broadcastUpdatedEvent:u}),a.log("broadcast-subscription new broadcast info published."),b(i,a,t,u)}catch(e){a.error(e)}},T=(e,t)=>(null==e?void 0:e.stream.wamsStreamingUrl)===(null==t?void 0:t.stream.wamsStreamingUrl)&&(null==e?void 0:e.altStream.wamsStreamingUrl)===(null==t?void 0:t.altStream.wamsStreamingUrl),E=(e,t)=>{var n,i,a;return{__typename:"BroadcastStreamingDetails",stream:(null==t?void 0:t.stream)||(null===(n=e.streamingDetails)||void 0===n?void 0:n.stream),altStream:(null==t?void 0:t.altStream)||(null===(i=e.streamingDetails)||void 0===i?void 0:i.altStream),id:(null==t?void 0:t.id)||(null===(a=e.streamingDetails)||void 0===a?void 0:a.id)}},I=(e,t)=>(t=t||0)>(e=e||0)?a.MeetingStatus.Suspended:a.MeetingStatus.Created,N=(e,t)=>()=>{t.stopPollingAttendeeMeeting(e)},A=(e,t,n,i,a,o,r)=>s=>{if(!s){a.log("broadcast-subscripotion disconnect callback called not intentionally. Subscribing to attendee service polling.");try{n.startPollingAttendeeMeeting(e,t,i)}catch(t){M(a,o,t.message,e,r)}}},M=(e,t,n,i,a)=>{e.error("Error while starting broadcast updates subscription");const o=r(i,a,{error:{errorMessage:n}});t.publish(`${y.V}-${i}`,{broadcastUpdatedEvent:o})},F={Query:{broadcastAttendeeMeeting(e,{broadcastAttendeeMeetingParams:t},{getBroadcastAttendeeService:n}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return t?{__typename:"BroadcastAttendeeMeeting",id:(e=yield(yield n()).getAttendeeMeeting(t)).correlationId,title:e.subject,stream:s(e.stream),altStream:s(e.altStream),qna:e.qna,yammer:e.yammer&&{__typename:"YammerMetadata",broadcastId:e.yammer.broadcastId,groupId:e.yammer.groupId,isEnabled:e.yammer.isEnabled,eventUrl:e.yammer.event},supportUrl:e.supportUrl}:null;var e}))},broadcastCaptions(e,{broadcastId:t,culture:n,currentPlayerTime:a},{cache:o,getBroadcastCaptionsService:r,loggerFactory:s}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=s.newLogger("broadcastCaptionsQuery");if(!t||!n)return e.error("Invalid params sent to broadcastCaptions Query"),Promise.reject("Invalid params sent to broadcastCaptions Query");e.log(`Fetching the captions for: ID: ${t}, Culture: ${n}, Time: ${a}`);try{const e=o.readQuery({query:f,variables:{id:t}});if(e&&e.broadcast.aesKey&&e.broadcast.transcription){const i=yield r();i.setCurrentCaptionLanguage(t,n);return(e=>{const t=[];for(const n of e){if(""===n.Text)continue;const e={__typename:"Captions",start:m(n.TimestampMs),text:n.Text,end:m(n.EndTimestampMs)};t.push(e)}return t})(yield i.getCaptions(a,e.broadcast,n))}}catch(t){e.error("Failed to fetch captions"),e.error(t)}return Promise.resolve([])}))},broadcast(e,{id:t,roleHint:n},{getBroadcastAttendeeService:o,loggerFactory:s}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const[e,i,l,c,d]=t.split("__");if(!(e&&i&&l&&c)){const e=`Invalid Id: ${t}`;throw s.newLogger("broadcast").error(e),new Error(e)}const u=!!d,m=u?a.BroadcastType.Overflow:a.BroadcastType.QuickStart,p=yield(yield o()).getAttendeeMeeting({tenantId:e,organizerId:i,threadId:l,messageId:c,sessionId:d,roleHint:n,broadcastType:m});return r(t,u,p)}))}},Mutation:{startLiveStreamCaptions(e,{id:t,liveStreamId:n,culture:a},{cache:o,getBroadcastCaptionsService:r,getLiveStreamRenderingService:s,loggerFactory:l}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=l.newLogger("liveStreamCaptionsMutation");try{const i=o.readQuery({query:f,variables:{id:t}});if(!i)throw new Error("Could not find broadcast data");const l=yield s(),c=yield r(),d=()=>l.getDiagnosticData(n).then((t=>(e.log(`The times are: ${t.currentAbsoluteTime}, ${t.currentMediaTime}, ${t.currentPlayPosition}`),t.currentAbsoluteTime))),u=e=>{l.addCues(n,e)};c.startCaptionsForStream(n,i.broadcast,a,d,u)}catch(t){e.error("Failed to fetch captions"),e.error(t)}return null}))},stopLiveStreamCaptions(e,{liveStreamId:t},{getBroadcastCaptionsService:n,getLiveStreamRenderingService:a,loggerFactory:o}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=o.newLogger("liveStreamCaptionsMutation");e.log(`Stopping captions for stream ${t}`);try{const e=yield a(),i=yield n();return e.showCaptions(t,!1),i.stopCaptionsForStream(t),!0}catch(n){return e.error(`Error while stopping captions for stream ${t}`),e.error(n),!1}}))},subscribeToBroadcastUpdates(e,{id:t},{loggerFactory:n,getBroadcastAttendeeService:a,getBroadcastSignalRService:o,pubsub:r,cache:s}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=yield a(),l=yield o(),c=n.newLogger("broadcastSubscribe");return yield((e,t,n,a,o,r)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const i=S(e),s=!!i.sessionId;try{const l=yield k(o,e,t,i,s,r);return l?(a.publish(`${y.V}-${e}`,{broadcastUpdatedEvent:l}),yield _(l,n,t,e,s,i,a,r,o)):(M(r,a,"Error subscribing to broadcast updates",e,s),!1)}catch(t){return r.error(t),M(r,a,t.message,e,s),!1}})))(t,e,l,r,s,c)}))},unsubscribeFromBroadcastUpdates(e,{id:t},{getBroadcastAttendeeService:n,getBroadcastSignalRService:a,loggerFactory:o}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=o.newLogger("broadcastUnsubscribe");e.log(`Stopping subscription for broadcast ${t}`);try{(yield n()).stopPollingAttendeeMeeting(t);return(yield a()).unsubscribeFromBroadcast(t),!0}catch(n){return e.error(`Error while unsubscribing from broadcast ${t}`),e.error(n),!1}}))}},Subscription:{broadcastQnaFeedStatusEvent:{subscribe:(e,{id:t},{pubsub:n})=>n.asyncIterator(t)},broadcastUpdatedEvent:{subscribe:(e,{broadcastId:t},{pubsub:n})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return n.asyncIterator(`${y.V}-${t}`)}))}}},R=()=>({Mutation:{updateBroadcastQnaFeedStatus:(e,{id:t,isQnaFeedLoaded:n,hasNewMessages:i},{pubsub:a})=>(null==i&&null==n||a.publish(t,{broadcastQnaFeedStatusEvent:{isQnaFeedLoaded:!!n,hasNewMessages:!!i}}),{__typename:"BroadcastQnaFeedStatus",isQnaFeedLoaded:!!n,hasNewMessages:!!i})}})},34432:(e,t,n)=>{"use strict";n.d(t,{w:()=>s});var i=n(892891),a=n(188682);const o="calendarv2",r=e=>{const t=e.get(o);return t?(0,a.D)(t):{}},s={Query:{calendarSettingsFromLocalStorage:(e,t,{localStorage:n})=>(({shouldGetDateRangeType:e,shouldGetWorkHours:t,shouldGetWorkWeekDays:n},i)=>{const a=r(i);return{__typename:"ICalendarSettings",dateRangeType:e&&a.dateRangeType||null,workHours:t&&a.workHours?Object.assign({__typename:"IWorkHours"},a.workHours):null,workWeekDays:n&&a.workWeekDays||null}})(t,n)},Mutation:{saveCalendarSettingsInLocalStorage:(e,t,{localStorage:n})=>((e,t)=>{const n=r(t);return(0,i.forOwn)(e,((e,t)=>{null!=e&&(n[t]=e)})),t.setSafe(o,JSON.stringify(n)),!0})(t,n)}}},868546:(e,t,n)=>{"use strict";n.d(t,{wz:()=>u,C9:()=>m,RF:()=>S,g:()=>F,_w:()=>b,Li:()=>k,Oh:()=>E,vV:()=>v,yw:()=>h,nh:()=>f,M3:()=>y,gv:()=>T,e7:()=>A,mB:()=>M,nP:()=>I,bW:()=>_,s6:()=>w,tx:()=>N,tW:()=>p,bC:()=>g});var i=n(635649),a=n(236681),o=n(931e3),r=n(961388),s=n(697160),l=n(31559);const c={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"breakoutRoomParticipants"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BreakoutRoom"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"coordinates"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"threadId"}}]}},{kind:"Field",name:{kind:"Name",value:"participants"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"upn"}},{kind:"Field",name:{kind:"Name",value:"mri"}},{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"role"}}]}}]}}]};var d=n(427803);const u="acceptStreamPermissionsDebug",m={__typename:"PrejoinState",incomingAudio:!0,isPSTN:!1,withAudio:!0,withVideo:!1,volume:10,wasMuteToggledByUser:!1,roomDetails:{__typename:"RoomDetails",room:null,wasRoomBluetoothProximityTriggered:!1,wasRoomLoudSpeakerInTheMeetingTriggered:!1},wasAutomuteTriggered:!1,isAuditoriumModeEnabled:!1};function p(e){e.writeQuery({query:l.vB,data:{prejoinState:m}})}function g(e){e.writeQuery({query:d._,data:{shouldShowVideoApp:!1}})}const h=()=>({__typename:"CallingScreenStatus",isDtmfKeypadVisible:!1,isPstnDialogVisible:!1,isBroadcastRestartWaitingOverlayVisible:!1,isChatBubblesSuppressed:!1,isShareTrayVisible:!1,hasShareMeetingInviteOnLandingBeenShown:!1,isCreateBreakoutRoomDialogVisible:!1,isAudienceBackgroundDialogVisible:!1,isTogetherModeSeatSelectionDialogVisible:!1,isAssignBreakoutRoomDialogVisible:!1,isAnnouncementDialogVisible:!1,isUnlockMeetingDialogVisible:!1}),v=()=>({__typename:"CallingScreenLayout",currentLayout:i.CustomLayoutSelection.Grid,meetingRoomLayoutSelection:i.MeetingRoomLayoutSelection.ContentAndPeople,isFocusModeEnabled:!1,isNarrowModeActive:!1,isNarrowModeActiveByResize:!1,isHostViewModeNoContentActive:!1,isHostViewModeWithContentActive:!1,isLayoutFlipped:!1,isPresenterHostMode:!1,isContentPoppedOut:!1,isPresenterHostModeWithContent:!1}),f=e=>({__typename:"PinnedParticipantIds",participantIds:[],id:e}),y=e=>({__typename:"VideoScanTypeResponse",videoScanType:i.VideoScanType.none,id:e}),S={__typename:"VideoEffectsInfo",appId:null,appName:null,isAppInstalled:null,filterId:null,imageId:"microsoft_none",imagePath:""},k=(e,t)=>{var n;return(null===(n=t.readQuery({query:r.Q,variables:{id:e}}))||void 0===n?void 0:n.callParticipants)||[]},b=(e,t)=>t.readFragment({id:C(e),fragment:a.u_,fragmentName:"participantFields"})||null,_=(e,t,n)=>{const i=b(e,n);i&&n.writeFragment({id:C(e),fragment:a.u_,data:Object.assign(Object.assign({},i),t),fragmentName:"participantFields"})},C=e=>`Participant:{"participantId":"${e}"}`,w=(e,t)=>{e.writeQuery({query:s.j,data:{callingAlerts:t}})},T=e=>`No call found with id ${e}`,E=(e,t)=>{var n;const a=e.coordinates;return{conversationId:(0,o.N6)(a)&&a.conversationId||null,isOneOnOne:e.type===i.CallingIntentType.OneToOneCall,isMeetup:e.type===i.CallingIntentType.Meeting,isBroadcast:(0,o.N6)(a)&&"LegacyMeetingCoordinates"===a.__typename&&!!a.broadcast,broadcastRole:(0,o.N6)(a)&&"LegacyMeetingCoordinates"===a.__typename?(0,o.N6)(a)&&(null===(n=a.broadcast)||void 0===n?void 0:n.role):null,withVideo:t&&t.outgoingVideo,withAudio:t&&t.outgoingAudio}},I=(e,t)=>{if(e)try{return t.readFragment({id:`BreakoutRoom:${e}`,fragment:c})}catch(t){throw new Error(`room ${e} doesn't exist`)}return null},N=({roomFragment:e,cache:t,updateParticipants:n})=>{const i=Object.assign(Object.assign({},e),{participants:n(e.participants||[])});try{t.writeFragment({id:`BreakoutRoom:${e.coordinates.threadId}`,fragment:c,data:i})}catch(e){throw new Error("Error updating room participants in cache")}return i},A=e=>({__typename:"BreakoutRoomParticipant",mri:e,role:null,objectId:null,upn:null}),M=e=>({tenantId:"tenantId",organizerId:null!=e?e:"6763e6ac-1bfd-48ec-8352-a3e3a066c81c",threadId:"threadId",messageId:"messageId",additionalMessageId:"additionalMessage"}),F=()=>{const e=M();return{__typename:"BreakoutRoom",coordinates:Object.assign(Object.assign({__typename:"RoomCoordinates"},e),{additionalMessageId:"additionalMessage"}),roomName:"Room 1",sourceMeetingCoordinates:Object.assign(Object.assign({__typename:"RoomCoordinates"},e),{additionalMessageId:"additionalMessage"}),participants:[A("6763e6ac-1bfd-48ec-8352-a3e3a066c81c")],restrictChatAccess:!0,isOpened:!1,meetingJoinUrl:"https://teams.microsoft.com",detailsAvailable:!0,clientActionState:null,isSyncInProgress:!1}}},961388:(e,t,n)=>{"use strict";n.d(t,{Q:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"callParticipants"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callParticipants"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"participantFields"}}]}}]}},...n(236681).u_.definitions]}},697160:(e,t,n)=>{"use strict";n.d(t,{j:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"callingAlerts"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callingAlerts"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingAlert"}}]}}]}},...n(362142).h.definitions]}},31559:(e,t,n)=>{"use strict";n.d(t,{vB:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"prejoinState"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callingIntentId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"prejoinState"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callingIntentId"},value:{kind:"Variable",name:{kind:"Name",value:"callingIntentId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"incomingAudio"}},{kind:"Field",name:{kind:"Name",value:"isPSTN"}},{kind:"Field",name:{kind:"Name",value:"withAudio"}},{kind:"Field",name:{kind:"Name",value:"withVideo"}},{kind:"Field",name:{kind:"Name",value:"volume"}},{kind:"Field",name:{kind:"Name",value:"wasAutomuteTriggered"}},{kind:"Field",name:{kind:"Name",value:"wasMuteToggledByUser"}},{kind:"Field",name:{kind:"Name",value:"roomDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"roomDetails"}}]}},{kind:"Field",name:{kind:"Name",value:"isAuditoriumModeEnabled"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"roomDetails"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"RoomDetails"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"room"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"roomData"}}]}},{kind:"Field",name:{kind:"Name",value:"wasRoomBluetoothProximityTriggered"}},{kind:"Field",name:{kind:"Name",value:"wasRoomLoudSpeakerInTheMeetingTriggered"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"roomData"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ClientRoom"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"proximityValidationCode"}}]}}]}.definitions]}},427803:(e,t,n)=>{"use strict";n.d(t,{_:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"shouldShowVideoApp"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shouldShowVideoApp"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},570650:(e,t,n)=>{"use strict";n.d(t,{s:()=>R});var i=n(231191),a=n(682796),o=n(562273),r=n(971646),s=n(41227),l=n(352367),c=n(980633),d=n(775214),u=n(22287);const m=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const i=n.filter((e=>!e.shareUrl)).map((e=>e.id));if(0===i.length)return n;const a=yield e.shareDriveItems(i),o=new Map;a.forEach(((e,t)=>o.set(i[t],e)));const r=[];for(const e of n){const n=o.get(e.id);if(n){if(!n.link){const n=`ShareUrl (link.webUrl) is not present in createLink response for fileId: ${e.id}`,i={[u.z.internalErrorCode]:"ShareUrlIsMissingFromResponse",[u.z.logErrorMessage]:n};throw t.newLogger("ChatResolversUtilsFiles").error(`${n}. ${JSON.stringify(i)}`),(0,d.Tr)(l.w5.AddShareUrlOnSendMessage,l.jK.Undefined,"",i,n)}r.push(Object.assign(Object.assign({},e),{shareUrl:n.link.webUrl,shareId:n.shareId}))}else r.push(e)}return r})),p=e=>{var t;return!!(null===(t=null==e?void 0:e.files)||void 0===t?void 0:t.length)},g=(e,t,n)=>{const i=e.newLogger("ChatResolversUtilsFiles"),{reason:a}=n;if(a){const e={errorCode:a[u.z.internalErrorCode]||n.code||"ErrorCodeMissing",correlationId:a[u.z.correlationId],statusCode:a[u.z.httpCode],message:a[u.z.logErrorMessage]||"Log message is not present in reason bag",errors:a[u.z.logErrorMessage]};throw t.fail(e),i.error(`Failed to generate ShareUrl for files. ${JSON.stringify(e)}`),n}const o={errorCode:n.code||l.jK.Unknown,message:"thrown error is not an instance of IError. So not much data available",errors:`${n.context}_${n.subContext}`};throw t.fail(o),i.error(`Failed to generate ShareUrl for files and as well error is not instance of IError ${JSON.stringify(o)}`),n},h=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){try{return yield e()}catch(e){const i="Failed to lazy load drive item share service",a={[u.z.internalErrorCode]:e.code||"FailedToLazyLoadDriveItemShareService",[u.z.logErrorMessage]:i,innerError:e},o={errorCode:a[u.z.internalErrorCode],message:a[u.z.logErrorMessage]};n.fail(o);throw t.newLogger("ChatResolversUtilsFiles").error(`Failed to get DriveItemShareService. error: ${JSON.stringify(o)}`),(0,d.Tr)(l.w5.AddShareUrlOnSendMessage,l.jK.FailedToLazyLoadService,"",a,i)}}));var v=n(892891),f=n(989087),y=n(723128),S=n(539646),k=n(635649),b=n(143028),_=n(272009),C=n(533439),w=n(47578);const T={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"optionalTelemetry"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"optionalTelemetry"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fluidDataLossOccurred"}},{kind:"Field",name:{kind:"Name",value:"fluidDataLossPrevented"}}]}}]}}]},E=e=>{switch(e){case"Standard":return"NORMAL";case"Important":return"HIGH";case"Urgent":return"URGENT"}return null},I=e=>{var t;const n=null===(t=e.computed)||void 0===t?void 0:t.cards;if(!n)return!1;return!!(0,v.find)(n,(e=>"application/vnd.microsoft.card.fluid"===e.contentType))},N=e=>{const t=new RegExp(C.T.reply,"g");return(e.match(t)||[]).length},A=(e,t,n,i)=>{var a,o,r,s,l,c,d,u;return{"DataBag.messagelength":e.content.length,"DataBag.size":e.content.length,"DataBag.importantflag":E(e.importance),"DataBag.messageType":"Update"===t?"chatEdit":"newP2PMessage","DataBag.postType":"normal","DataBag.richText":(u=e.messageType,"RichText/Html"===u),"DataBag.fluidCard":I(e),"DataBag.sfbInteropMessage":(null==n?void 0:n.chatType)===k.ChatType.SfBInteropChat,"DataBag.mricollection":(null===(a=null==n?void 0:n.memberIds)||void 0===a?void 0:a.join(" "))||"","DataBag.rostersize":(null===(o=null==n?void 0:n.memberIds)||void 0===o?void 0:o.length)||0,"DataBag.attachments":(null===(r=e.files)||void 0===r?void 0:r.length)||0,"DataBag.attachmentIds":(null===(l=null===(s=e.files)||void 0===s?void 0:s.map((e=>e.id)))||void 0===l?void 0:l.join(" "))||"","DataBag.fileTypeList":(null===(d=null===(c=e.files)||void 0===c?void 0:c.map((e=>e.type)))||void 0===d?void 0:d.filter((e=>!(0,v.isNil)(e))))||[],"DataBag.leftRailDirective":"chat-list","DataBag.messageID":e.id,"DataBag.newChatIntentId":i,"DataBag.tflOffNetworkEmailCount":(null==n?void 0:n.memberIds)?n.memberIds.filter((e=>e.startsWith(b.b6))).length:0,"DataBag.tflOffNetworkOneWayPhoneCount":(null==n?void 0:n.memberIds)?n.memberIds.filter((e=>e.startsWith(b.EI))).length:0,"DataBag.tflSMSMembersCount":(null==n?void 0:n.memberIds)?n.memberIds.filter(_.yj).length:0,"DataBag.hasAADFederatedMembers":(null==n?void 0:n.hasFederatedUser)||!1,"DataBag.hasMSAFederatedMembers":(null==n?void 0:n.hasTflConsumerUser)||!1,"DataBag.quotedReplyCount":N(e.content)}},M=(e,t,n,i,a,o,r,s,l)=>{var c;const d=(e=>{var t,n;if(!e)return;const i=(null===(t=e.id)||void 0===t?void 0:t.includes(":nativefed:preview"))||!e.isFederated&&e.isOneOnOne&&e.hasFederatedUser&&!(null===(n=e.memberIds)||void 0===n?void 0:n.some((e=>(0,_.Nl)(e))));return(0,S.NL)(e.id,e.chatType,e.isMeeting,e.isOneOnOne,e.isOneOnOneBotChat,i,e.isFederated)})(r);let u={};d===y.Th.Botchat&&(u=((e,t)=>{var n,i,a;const o=null===(n=null==e?void 0:e.memberIds)||void 0===n?void 0:n.find(_.bl);if(o){const e=o.substring(b.at.BotPrefix.length);try{const n=t.readQuery({query:w.C,variables:{installedContext:{scope:k.AppInstallScope.Personal}}});if(n){const t=null===(i=n.installedAppsV2)||void 0===i?void 0:i.filter((t=>{var n,i,a;return(null===(a=null===(i=null===(n=null==t?void 0:t.definition)||void 0===n?void 0:n.bots)||void 0===i?void 0:i[0])||void 0===a?void 0:a.id)===e}));if(t&&t.length>0)return{id:null===(a=t[0])||void 0===a?void 0:a.id,capabilityId:e,scenarioCapability:f.Ky.bots}}}catch(e){}}return{}})(r,l)),a.recordPanelAction({actionGesture:y.uS.click,actionOutcome:y.$K.submit,actionOutcomeNew:y.$K.submit,actionScenarioType:y.Yu.composeMsg,actionScenario:y.Tk.composeSendMessage,moduleName:y.rA.sendButton,moduleNameNew:y.rA.sendButton,moduleType:y.PO.sendMessageButton,moduleTypeNew:y.PO.sendMessageButton,panelRegion:y.Ai.main,panelType:y.wh.Chat,panelRegionNew:y.Ai.main,panelTypeNew:y.wh.Chat,threadId:e,threadMembers:null===(c=null==r?void 0:r.memberIds)||void 0===c?void 0:c.length,threadType:d,actionWorkload:y.g$.chatContent,actionSubworkload:y.Nb.composeMsg,tabId:"",tabType:"conversations",tabIdNew:"",tabTypeNew:"conversations",tabOrdinal:1,appName:"chat",dataBag:{id:"",data:Object.assign(Object.assign(Object.assign({},i),A(t,n,r,s)),F(l)),dispose:()=>{}},extensibilityData:u},o)};function F(e){var t,n;const i={};let a=null;try{a=e.readQuery({query:T})}catch(e){}const o=null==a?void 0:a.optionalTelemetry;return void 0!==(null==o?void 0:o.fluidDataLossOccurred)&&null!==(null==o?void 0:o.fluidDataLossOccurred)&&(i["DataBag.fluidDataLossOccurred"]=null===(t=null==a?void 0:a.optionalTelemetry)||void 0===t?void 0:t.fluidDataLossOccurred),void 0!==(null==o?void 0:o.fluidDataLossPrevented)&&null!==(null==o?void 0:o.fluidDataLossPrevented)&&(i["DataBag.fluidDataLossPrevented"]=null===(n=null==a?void 0:a.optionalTelemetry)||void 0===n?void 0:n.fluidDataLossPrevented),i}const R={Mutation:{sendMessage(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{convId:n,action:o,originalConvId:r,withChatNetworkFallback:l}=e;let d=e.message;const{cache:u,coreSettings:v,loggerFactory:f,offlineCacheManager:y,getDriveItemShareService:S,scenarioFactory:k}=t,{enableInstalledAppsV2:b,enableBotsFileSharing:_,enableAppsQueryOptimization:C}=v.get(a.J.Extensibility),{enableFilesShareLinksInvite:w,enableSharingByCreateLinkAPI:T}=v.get(a.J.Files),E={},I=f.newLogger("chatMutationForwardResolvers"),N=k.findScenario(c.RG.ChatSendMessage),A=yield(0,s.mb)(n,u,t,I,f,l,null,null);null==N||N.mark(c.ck.ChatSendMessageGotChat);const F=D(r,u,I),R=yield P(t);null==N||N.mark(c.ck.ChatSendMessageServicesLazyLoadComplete);const x=(0,s.Fb)(u,n,b,C),O=j(t,I);w&&A&&(0,s.iX)(A)&&(d=yield(0,s.Ju)(d,A,t));let L=yield(0,s.JB)(t,d,o,n,O,Object.assign(Object.assign({},R),{offlineCacheManager:y,telemetryDatabag:E,convId:n,getInstalledMessageExtensionApps:x}),N);return T&&d&&(L=yield((e,t,n,a)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(p(a)){const i=t.newScenario(c.RG.FilesCreateShareLink),o=yield h(e,n,i);try{const e=yield m(o,n,a.files);return i.stop(),Object.assign(Object.assign({},a),{files:e})}catch(e){g(n,i,e)}}return Object.assign({},a)})))(S,k,f,L)),L=yield(0,s.R_)(R.botsPlatformService,L,_,f,A),L=(0,s.wX)(L,A),((e,t,n,i,{loggerFactory:a,userBiService:o,cache:r},s,l)=>{const c=a.newLogger("sendMessageTelemetry");o?M(e,t,n,i,o,c,s,l,r):c.warn("userBiService is null")})(n,L,o,E,t,A,F),Object.assign(Object.assign({},e),{message:L})}))}}},P=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{getAppBasedLinkService:t,getAsyncMediaService:n,getUrlPreviewService:i,getImageProxyService:a,getFilesReferenceService:o,getBotsPlatformService:r}=e,[s,l,c,d,u,m]=yield Promise.all([n(),a(),i(),o(),t(),r()]);return{asyncMediaService:s,imageProxyService:l,urlPreviewService:c,fileReferenceService:d,appBasedLinkService:u,botsPlatformService:m}})),D=(e,t,n)=>{var i;let a=null;if((0,S.UL)(e))try{const n=t.readQuery({query:o.i,variables:{convId:e}});a=null!==(i=null==n?void 0:n.newChatIntentId)&&void 0!==i?i:null}catch(e){n.error("Failed to find newChatIntentId in cache")}return a},j=(e,t)=>{var n;let i=!0;const{cache:o,coreSettings:s}=e,{enableConnectedExperiences:l}=s.get(a.J.Messaging);if(!l)return i;try{const e=o.readQuery({query:r.K});i="false"!==(null===(n=null==e?void 0:e.userPreferences)||void 0===n?void 0:n.controllerConnectedServicesEnabled)}catch(e){t.error("Failed to find userPreferences in cache")}return i}},41227:(e,t,n)=>{"use strict";n.d(t,{R_:()=>w,mb:()=>M,Fb:()=>E,Ju:()=>A,iX:()=>F,PJ:()=>C,JB:()=>_,wX:()=>R});var i=n(231191),a=n(580786);const o={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedApps"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedScopes"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppsFilterOptionsInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedApps"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedScopes"},value:{kind:"Variable",name:{kind:"Name",value:"installedScopes"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...a.W.definitions]};var r=n(47578);const s={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedChatAppsWithPreCheck"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"InstalledAppsOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedChatAppsWithPreCheck"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...a.W.definitions]};var l=n(811675),c=n(892891);let d=class{transform(e,t){var n,i,a,o,r;if(e.parent&&1===e.parent.children.length&&"div"===(null===(n=e.parent.name)||void 0===n?void 0:n.toLowerCase())&&!e.parent.parent){if((!e.children||0===e.children.length)&&"text"===e.type)return t.isPureText=!0,void(t.textContent=(0,c.unescape)(e.data));if("tag"===e.type&&"p"===(null===(i=e.name)||void 0===i?void 0:i.toLowerCase())&&1===(null===(a=e.children)||void 0===a?void 0:a.length)&&"text"===e.children[0].type)return t.isPureText=!0,void(t.textContent=(0,c.unescape)(null===(o=e.children)||void 0===o?void 0:o[0].data));if("tag"===e.type&&"p"===(null===(r=e.name)||void 0===r?void 0:r.toLowerCase()))return e.name="div",e}}};d=(0,i.__decorate)([(0,l.wx)({name:"BotMessageContentSerializer",filter:"*"})],d);var u=n(569069),m=n(771373),p=n(539646),g=n(635649),h=n(674257),v=n(143028),f=n(425403),y=n(682796);var S=n(550635),k=n(739869),b=n(980633);const _=(e,t,n,a,o,r,s)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{content:c,computed:d,files:m,clientMessageId:p,deeplinks:g}=t,h=(0,i.__rest)(t,["content","computed","files","clientMessageId","deeplinks"]),v=Object.assign({conversationId:a,connectedExperienceEnabled:o,existingLinks:(null==d?void 0:d.embeddedLinks)||[],messageProperties:d?Object.assign(Object.assign({},d),{embeddedLinks:[]}):{},files:m,coreSettings:e.coreSettings,loggerFactory:e.loggerFactory},r),{coreSettings:S,loggerFactory:_}=e,C=_.newLogger("chat-resolver-utils"),w=yield((e,t,n,a,o,r,s)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{cache:i,coreSettings:c,loggerFactory:d,scenarioFactory:m}=e,p=d.newLogger("chat-resolver-utils"),g=(0,l.te)(u.bl,t,Object.assign(Object.assign({},n),{coreSettings:c,loggerFactory:d,scenarioFactory:m}));try{yield(0,k.y)(i,e,a,o,r,g,n.messageProperties),null==s||s.mark(b.ck.ChatSendMessageOptimisticResponsePosted)}catch(e){p.error(`client lie generation failed for conversation: ${a} clientMessageId: ${o.clientMessageId} error: ${e}`)}return(0,l.zL)(u.Vf,g,Object.assign(Object.assign({},n),{coreSettings:c,loggerFactory:d,scenarioFactory:m}))})))(e,c,v,a,t,n,s),T=((e,t)=>{const{enableEntityConversationInMWTab:n}=e.get(y.J.Extensibility);if(!n)return[];const i=f.h.getInstance(),a=i.getSubEntityDeepLinkInfo();return a&&t&&i.getClientMessageId()===t?(i.setSubEntityDeepLinkInfo(void 0),i.setClientMessageId(void 0),[a]):[]})(S,p||void 0);return C.log(`serialized message ${p}`),null==s||s.mark(b.ck.ChatSendMessageSerializationComplete),Object.assign({content:w,computed:v.messageProperties,files:v.files,deeplinks:T.length>0?T:g,clientMessageId:p},h)})),C=(e,t)=>{const{loggerFactory:n,offlineCacheManager:i}=e,a={logger:n.newLogger("serializeDraftMessage"),offlineCacheManager:i},o=(0,l.te)(u.D,t.content,a);return Object.assign(Object.assign({},t),{content:o})},w=(e,t,n,a,o)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(!o||!n||!t.files||0===t.files.length)return t;if(!(null==o?void 0:o.isOneOnOneBotChat))return t;const i=a.newLogger("chat-resolver-utils"),r=yield Promise.all(t.files.map((t=>T(t,e,i))));return Object.assign(Object.assign({},t),{files:r})})),T=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const i=e.objectUrl;if(i){let a;try{a=yield(0,S.E)(t.getBotFileDownloadUrl(i,n),2e3,"get bot downlaod url timed out")}catch(e){a=null,n.error("getBotDownloadUrlForFiles: failed to get file info")}if(a)return Object.assign(Object.assign({},e),{downloadUrl:a})}return e})),E=(e,t,n,i)=>()=>{var a;try{if(n){const n=I(e,t,i);return(0,c.compact)(null==n?void 0:n.filter((e=>{var t;return null===(t=null==e?void 0:e.definition)||void 0===t?void 0:t.messageExtensions})).map((e=>e&&N(e)?e.definition:null)))}{const n=e.readQuery({query:o,variables:{conversationId:t,installedScopes:[g.AppInstallScope.Personal,g.AppInstallScope.GroupChat],options:{capabilityFilter:[g.AppCapability.Messaging]}}});return(0,c.compact)(null===(a=null==n?void 0:n.installedApps)||void 0===a?void 0:a.map((e=>e&&N(e)?e.definition:null)))}}catch(e){return}},I=(e,t,n)=>{var i;let a=null;try{a=e.readQuery({query:r.C,variables:{installedContext:{scope:g.AppInstallScope.Personal}}})}catch(e){a=null}let o=null;try{if(n){const n=e.readQuery({query:s,variables:{conversationId:t}});o=null==n?void 0:n.installedChatAppsWithPreCheck}else{const n=e.readQuery({query:r.C,variables:{installedContext:{conversationId:t,scope:g.AppInstallScope.GroupChat}}});o=null==n?void 0:n.installedAppsV2}}catch(e){o=null}const l=null!=o?o:[];return(null!==(i=null==a?void 0:a.installedAppsV2)&&void 0!==i?i:[]).concat(l)},N=e=>(0,c.includes)([g.AppInstallationStates.Installed,g.AppInstallationStates.InstalledAndFavorited,g.AppInstallationStates.InstalledAndPermanent],e.installationState),A=(e,t,{getSharepointShareService:n,getPeopleService:a,discover:o})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(null==e?void 0:e.files){const i=yield n(),r=yield a(),s=yield o.skypeid(),l=(yield(0,m.M)(t.memberIds||[],r)).filter((e=>e.mri!==s)),c=yield i.shareFiles(e.files,l);return Object.assign(Object.assign({},e),{files:c})}return e})),M=(e,t,n,a,o,r,s,l,c)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i;let d;try{d=null===(i=t.readQuery({query:h.J,variables:{convId:e}}))||void 0===i?void 0:i.chat}catch(e){a.error("Failed to find chat in cache")}if(r&&!d){const t=yield n.getCSAService(),i=yield t.getChat(e);i&&(d=(0,p._$)(i,o,s,{id:l},c))}return d})),F=({chatType:e})=>e===g.ChatType.Chat||e===g.ChatType.Meeting,R=(e,t)=>{var n,i;const a=!(0,c.isEmpty)(null==t?void 0:t.botMembers),o=!!(null===(i=null===(n=e.computed)||void 0===n?void 0:n.mentions)||void 0===i?void 0:i.find((e=>"bot"===e.mentionType)));if(!((null==t?void 0:t.isOneOnOneBotChat)||a&&o))return e;const r={},s=(0,l.te)([d],e.content,r);return r.isPureText&&!(0,c.isNil)(r.textContent)?Object.assign(Object.assign({},e),{content:r.textContent,messageType:"BotMessageBack"===e.messageType?"BotMessageBack":v.Cs.Text}):Object.assign(Object.assign({},e),{content:s})}},739869:(e,t,n)=>{"use strict";n.d(t,{y:()=>c,l:()=>u});var i=n(231191),a=n(927346),o=n(892891),r=n(635649),s=n(505341),l=n(708362);const c=(e,t,n,a,o,s,{mentions:l,cards:c})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:i,discover:u,loggerFactory:p}=t,g=p.newLogger("Client Lie Helper"),[{profile:{name:h}},v]=yield Promise.all([i.getUser(),u.skypeid()]);let f=m(s,a,{mentions:l,cards:c});const{replyChainId:y}=a;if(f=Object.assign(Object.assign({},f),{from:v,imDisplayName:h}),o===r.SendMessageAction.Update){const{clientMessageId:e,id:t,originalArrivalTime:n,messageType:i}=a;t&&n&&i?f=Object.assign(Object.assign({},f),{id:t,originalArrivalTime:n,editTime:new Date(Date.now()).toISOString(),messageType:i}):g.error(`can't find id, originalArrivalTime, messageType for ${e}`)}yield d(e,v,f,n,g,y)})),d=(e,t,n,i,a,o)=>new Promise((r=>(0,l.J)().requestIdleCallback((()=>{(0,s.zf)(e,i,o||null,[n],t,!0,a),r()})))),u=e=>m(e.content,e,e.computed||{}),m=(e,{clientMessageId:t,files:n,deeplinks:i,importance:o,messageType:s},{mentions:l,cards:c})=>({__typename:"Message",id:t||null,clientMessageId:t||null,originalArrivalTime:new Date(Date.now()).toISOString(),version:(0,a.M)()[0].toString(),importance:o||null,content:e,messageType:s||"RichText/Html",interopDeliveryState:null,smsDeliveryReports:null,emotionsSummary:null,emotions:null,escalations:null,mentions:p(l),onBehalfOf:null,cards:g(c),from:null,imDisplayName:null,files:h(n),deeplinks:v(i),urlPreview:null,embeddedLinks:null,dlpContext:null,deleteTime:null,editTime:null,status:r.MessageStatus.Sending,diagnosticInfo:null,deletionInfo:{__typename:"DeletionInfo",showMessageAsDeleted:!1,canBeUndeleted:!1,deleteFailed:!1},userHasSaved:!1,callId:null,replyPermission:null,translation:{__typename:"Translation",status:r.TranslationStatus.NotStarted,content:null,fromLanguage:null},atpSharepointData:null,isDeletedByAdmin:null,meeting:null}),p=e=>(0,o.map)(e,(e=>{var{itemId:t}=e,n=(0,i.__rest)(e,["itemId"]);return Object.assign({__typename:"Mention",id:t,itemId:t},n)})),g=e=>(0,o.map)(e,(e=>({__typename:"Card",appIcon:e.appIcon||null,appId:e.appId,appName:e.appName||null,cardClientId:e.cardClientId,content:e.content,contentType:e.contentType,locale:e.locale||null}))),h=e=>(0,o.map)(e,(e=>{var{chicletBreadcrumbs:t,title:n,type:a}=e,o=(0,i.__rest)(e,["chicletBreadcrumbs","title","type"]);return{__typename:"File",id:o.id,itemId:o.itemId||null,chicletBreadcrumbs:t?{__typename:"ChicletBreadcrumbs",sourceChannelName:t.sourceChannelName||null,sourceTeamName:t.sourceTeamName||null}:null,baseUrl:null,objectUrl:null,shareId:null,shareUrl:null,type:a||null,title:n||null,previewUrl:null,previewHeight:null,previewWidth:null,progressComplete:null,hasUploadFailed:!1,serviceName:null,state:null}})),v=e=>(0,o.map)(e,(e=>({__typename:"DeepLink",id:(0,i.__rest)(e,[]).id,channelId:null,title:null,siteUrl:null,objectUrl:null,serverRelativeUrl:null,state:null})))},47578:(e,t,n)=>{"use strict";n.d(t,{C:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedAppsV2"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedContext"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallContext"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"InstalledAppsOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedAppsV2"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedContext"},value:{kind:"Variable",name:{kind:"Name",value:"installedContext"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...n(580786).W.definitions]}},159153:(e,t,n)=>{"use strict";n.d(t,{X:()=>a});var i=n(805216);function a(e){var t;switch(e.__typename){case"BreakoutRoom":return`${e.__typename}:${null===(t=e.coordinates)||void 0===t?void 0:t.threadId}`;case"Participant":return`${e.__typename}:${e.participantId}`;case"TeamTagCards":return`${e.__typename}:${e.teamId}`;case"TagCard":return`${e.__typename}:${e.tagId}`;case"Entity":return`${(0,i.uG)(e)}:${e.type}`;case"InstalledApp":const n=`${(0,i.uG)(e)}:${e.installedScope}`;return e.conversationId?`${n}:${e.conversationId}`:n;case"AppDefinition":return`${(0,i.uG)(e)}:${e.version}`;case"MessageExtensionCommand":return`${(0,i.uG)(e)}:${e.appKey}`;case"BotDynamicCommands":return`${e.__typename}:${e.botMri}:${e.commandContext}`;case"DeviceList":if(!e.id)throw new Error("dataIdFromObject(), no id on DeviceList object.");return(0,i.uG)(e);case"TransportCompanionDeviceInfo":case"UserPreferences":case"AppsUsage":return e.__typename;case"StagedApp":return`${(0,i.uG)(e)}:${e.reviewStatus}`;default:return(0,i.uG)(e)}}},886449:(e,t,n)=>{"use strict";n.d(t,{D:()=>o});var i=n(624438),a=n.n(i);const o={Mutation:{updateFilePermission(e,{updateFilePermissionInput:t},{cache:n}){if(!t)return!1;const{fileId:i,shareUrl:o,shareId:r,scope:s}=t,l=a()`
  fragment filePermissionUpdate on FileUpload {
    id
    shareUrl
    shareId
    permissionScope
  }
`;let c;const d=`FileUpload:${i}`;try{c=n.readFragment({fragment:l,id:d})}catch(e){throw e}if(!c)throw new Error("Expected initial files to be populated before a command is executed");const u=Object.assign(Object.assign({},c),{shareUrl:o,shareId:r,permissionScope:s});return n.writeFragment({fragment:l,id:d,data:u}),!0},updatePermissionScopeInFileUpload(e,{updatePermissionScopeInput:t},{cache:n}){if(!t)return!1;const{fileId:i,scope:o}=t;if(!i)return!1;const r={permissionScope:o,__typename:"FileUpload"};try{n.writeFragment({fragment:a()`
  fragment updatePermissionScope on FileUpload {
    permissionScope
  }
`,id:`FileUpload:${i}`,data:r})}catch(e){return!1}return!0}}}},402604:(e,t,n)=>{"use strict";n.d(t,{w:()=>h});var i=n(231191),a=n(935113),o=n(635649),r=n(892891);function s(e,t){return t.isGeneral&&e.memberRole!==o.TeamMemberRole.Admin&&function(e){return e.teamSettings&&e.teamSettings.generalChannelPosting===o.GeneralChannelPosting.OwnersPost}(e)}function l(e,t){return e.isUserMuted?o.DisallowedToPostReason.MutedTeamMember:s(e,t)?o.DisallowedToPostReason.OnlyOwnersCanPost:o.DisallowedToPostReason.None}var c=n(534780);function d(e,t){var n,i;return{id:t.id,channelType:m(t.channelType),isGeneral:t.isGeneral||!1,displayName:t.displayName,disallowedToPostReason:l(e,t),consumptionHorizon:t.consumptionHorizon?Object.assign(Object.assign({},t.consumptionHorizon),{__typename:"ClientConsumptionHorizon"}):null,filesRelativePath:(null===(n=t.defaultFileSettings)||void 0===n?void 0:n.filesRelativePath)||null,memberRole:p(t.memberRole),isModerator:t.isModerator||!1,channelSettings:{__typename:"ChannelSettings",channelPostPermissions:g(null===(i=t.channelSettings)||void 0===i?void 0:i.channelPostPermissions)},sharepointSiteUrl:t.sharepointSiteUrl||null,team:{id:e.id,displayName:e.displayName,groupId:e.teamSiteInformation.groupId,sharepointSiteUrl:e.teamSiteInformation.sharepointSiteUrl||null,pictureETag:e.pictureETag||null,smtpAddress:e.smtpAddress,teamSettings:e.teamSettings,__typename:"ClientTeam"},__typename:"ChannelWithTeam"}}function u(e){return(0,r.flatMap)(e,(e=>e.filteredChannels.map(d.bind(void 0,e))))}function m(e){switch(e){case o.ChannelType.Standard:return o.ClientChannelType.Standard;case o.ChannelType.Private:return o.ClientChannelType.Private;case o.ChannelType.Shared:return o.ClientChannelType.Shared;default:return null}}const p=e=>{switch(e){case o.TeamMemberRole.Admin:return o.TeamMemberRole.Admin;case o.TeamMemberRole.Guest:return o.TeamMemberRole.Guest;case o.TeamMemberRole.User:return o.TeamMemberRole.User;case o.TeamMemberRole.Undefined:default:return o.TeamMemberRole.Undefined}},g=e=>{switch(e){case o.ChannelPostPermissions.Moderators:return o.ChannelPostPermissions.Moderators;case o.ChannelPostPermissions.EveryoneButGuests:return o.ChannelPostPermissions.EveryoneButGuests;case o.ChannelPostPermissions.Everyone:default:return o.ChannelPostPermissions.Everyone}},h={Query:{channelSearch:(e,{searchQuery:t},n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){let e=yield v(n);if(0===e.length)return{__typename:"ChannelSearchResults",resultsByChannelName:[],resultsByTeamName:[]};e=e.filter((e=>!e.isDeleted)).map((e=>Object.assign(Object.assign({},e),{channels:e.channels.filter((e=>!e.isDeleted))})));const i=new RegExp((0,r.escapeRegExp)(t.toLowerCase())),a=(0,r.cloneDeep)(e).filter((e=>i.test(e.displayName.toLowerCase()))).map((e=>(e.filteredChannels=e.channels,e)));return{__typename:"ChannelSearchResults",resultsByChannelName:u(e.map((e=>(e.filteredChannels=e.channels.filter((e=>i.test(e.displayName.toLowerCase()))),e)))),resultsByTeamName:u(a)}})),channel:(e,{channelId:t},n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const e=yield v(n);let i;return(0,r.forEach)(e,(e=>{const n=(0,r.find)(e.channels,{id:t});return!n||(i=d(e,n),!1)})),i}))}};function v(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,cache:n,coreSettings:i,localStorage:o,loggerFactory:r,scenarioFactory:s}=e;let l;try{({teams:l}=n.readQuery({query:a.T}))}catch(e){r.newLogger("ClientResolvers").warn("Cache error, returning empty data instead");const d=t&&(yield(0,c.Qp)(t,i,o,s));if(d){const e=d.map(c.uX);n.writeQuery({query:a.T,data:{teams:e}})}l=d||[]}return l}))}},935113:(e,t,n)=>{"use strict";n.d(t,{T:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"teamsList"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"teams"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"isDeleted"}},{kind:"Field",name:{kind:"Name",value:"isUserMuted"}},{kind:"Field",name:{kind:"Name",value:"memberRole"}},{kind:"Field",name:{kind:"Name",value:"smtpAddress"}},{kind:"Field",name:{kind:"Name",value:"pictureETag"}},{kind:"Field",name:{kind:"Name",value:"teamSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"generalChannelPosting"}}]}},{kind:"Field",name:{kind:"Name",value:"teamSiteInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"groupId"}},{kind:"Field",name:{kind:"Name",value:"sharepointSiteUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"teamType"}},{kind:"Field",name:{kind:"Name",value:"channels"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"channelType"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"isDeleted"}},{kind:"Field",name:{kind:"Name",value:"isGeneral"}},{kind:"Field",name:{kind:"Name",value:"consumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"timeStamp"}}]}},{kind:"Field",name:{kind:"Name",value:"defaultFileSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filesRelativePath"}}]}},{kind:"Field",name:{kind:"Name",value:"sharepointSiteUrl"}},{kind:"Field",name:{kind:"Name",value:"memberRole"}},{kind:"Field",name:{kind:"Name",value:"channelSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"channelPostPermissions"}}]}},{kind:"Field",name:{kind:"Name",value:"isModerator"}}]}}]}}]}}]}},534780:(e,t,n)=>{"use strict";n.d(t,{uX:()=>v,Qp:()=>_,gT:()=>I,GC:()=>A});var i=n(231191),a=n(635649),o=n(892891),r=n(682796),s=n(980633),l=n(87912),c=n(67829),d=n(143028),u=n(683103),m=n(539646),p=n(708362);const g="teams-list";function h(e){var t,n,i,a;return Object.assign(Object.assign(Object.assign({__typename:"Channel"},(0,o.defaults)((0,o.pick)(e,["id","channelType","displayName","isDeleted","isGeneral","memberRole","channelSettings","isModerator"]),{id:null,channelType:null,displayName:null,isDeleted:null,isGeneral:null,memberRole:null,channelSettings:{channelPostPermissions:null},isModerator:null})),{defaultFileSettings:{__typename:"DefaultFileSettings",filesRelativePath:(null===(t=e.defaultFileSettings)||void 0===t?void 0:t.filesRelativePath)||null},sharepointSiteUrl:e.sharepointSiteUrl||null}),(null===(n=e.consumptionHorizon)||void 0===n?void 0:n.id)?{consumptionHorizon:{__typename:"ConsumptionHorizon",id:null===(i=e.consumptionHorizon)||void 0===i?void 0:i.id,timeStamp:(null===(a=e.consumptionHorizon)||void 0===a?void 0:a.timeStamp)||null}}:{consumptionHorizon:null})}function v(e){return Object.assign(Object.assign({__typename:"Team"},(0,o.defaults)((0,o.pick)(e,["id","displayName","isDeleted","isUserMuted","memberRole","smtpAddress","pictureETag","teamType"]),{id:null,displayName:null,isDeleted:null,isUserMuted:null,memberRole:null,smtpAddress:null,pictureETag:null,teamType:null})),{teamSettings:{__typename:"TeamSettings",generalChannelPosting:e.teamSettings.generalChannelPosting||null},teamSiteInformation:Object.assign({__typename:"TeamSiteInformation"},(0,o.defaults)((0,o.pick)(e.teamSiteInformation,["groupId","sharepointSiteUrl"]),{groupId:null,sharepointSiteUrl:null})),channels:(e.channels||[]).map(h)})}function f(e){try{return JSON.parse(e)}catch(e){return}}function y(e){if(!e||0===e.length)return;const t=new Map,n=new Map;e.filter((e=>e&&(0,c.HU)(e))).map((e=>t.set(e.id,function(e){var t;const n=e.threadProperties;return Object.assign({id:e.id,displayName:n[d.Q5.SpaceThreadTopic]||"",isDeleted:(0,c.uY)(e),memberRole:b((null===(t=e.memberProperties)||void 0===t?void 0:t.role)||d.nL.None),teamSiteInformation:{groupId:n[d.Q5.GroupId]||"",sharepointSiteUrl:n[d.Q5.SiteUrl]},smtpAddress:n[d.Q5.TeamSmtpAddress],pictureETag:n[d.Q5.PictureETag],isFavorite:(0,c.Dq)(e),channels:[]},function(e){const t=f(e.threadProperties[d.Q5.TeamAdminSettings]);return t?{teamSettings:t.userSettings,teamGuestSettings:t.guestSettings}:{teamSettings:{}}}(e))}(e)))),e.filter((e=>e&&(0,c.J6)(e)&&e.threadProperties)).map((e=>n.set(e.id,{teamId:e.threadProperties[d.Q5.SpaceId],channel:S(e)}))),n.forEach((e=>{const{teamId:n,channel:i}=e,a=n&&t.get(n);a&&(i.team=a,a.channels.push(i))}));const i=Array.from(t.values());return i.length>0?i:void 0}function S(e){const t=e.threadProperties,n=t[d.Q5.SpaceTypes]===u.tG.Private;return{id:e.id,displayName:(n?t[d.Q5.SpaceThreadTopic]:(0,c.T7)(e))||"",description:t[d.Q5.TopicDescription]||"",isDeleted:(0,c.uY)(e),isGeneral:(0,c.HU)(e),channelType:k(t[d.Q5.SpaceTypes]),tabs:[],isShown:(0,c.Dq)(e),isShownByDefault:"true"===t[d.Q5.FavDefault],sharepointSiteUrl:n?t[d.Q5.SiteUrl]:void 0,defaultFileSettings:{filesRelativePath:t[d.Q5.FolderRelativeUrl]},consumptionHorizon:(0,m._l)(e.id,e.properties[d.Ff.ConsumptionHorizon])}}function k(e){switch(e){case u.tG.Private:return a.ChannelType.Private;case u.tG.Shared:return a.ChannelType.Shared;case u.tG.None:default:return a.ChannelType.Standard}}function b(e){switch(e){case d.nL.Admin:return a.TeamMemberRole.Admin;case d.nL.Guest:return a.TeamMemberRole.Guest;case d.nL.User:return a.TeamMemberRole.User;case d.nL.None:default:return a.TeamMemberRole.Undefined}}function _(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{enableChannelLocalCache:o,channelLocalCacheMaxDays:l,enableChannelIndexedDBCache:c,disableChannelIndexedDBNextCache:d}=t.get(r.J.Search);let u,m=!1;if(c&&(u=yield function(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return C||(C=function(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const o=n.newScenario(s.RG.GetTeamsChannelsFromIndexedDB),r=a=>(0,i.__awaiter)(this,void 0,void 0,(function*(){try{return yield I(e,t,a,n)}catch(e){return void o.appendEventData({errors:JSON.stringify(e)})}}));let l;if(a||(l=yield r(!0)),l||(l=yield r(!1)),l)try{const e=y(l);return o.stop({message:e?"Successfully fetched.":"Conversations store does not contain any teams or channels."}),e}catch(e){return void o.fail({errors:"Fails to convert conversations to teams."})}else o.fail({errors:"unable to read conversations from indexedbd"})}))}(e,t,n,a),T=E.setTimeout((()=>{C=void 0,E.clearTimeout(T),T=void 0}),w),C)}))}(e.profile.objectId,e.profile.tenantId,a,!!d),m=void 0!==u),o&&(function(e,t){const n=N(e),i=new Date(Date.now()),a=new Date((null==n?void 0:n.timestamp)||0);a.setDate(a.getDate()+t),a<i&&e.remove(g)}(n,m?0:l||7),!u)){const e=N(n);u=null==e?void 0:e.teams}return u}))}let C;const w=3e5;let T;const E=(0,p.J)();function I(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=function(e,t,n){return n?`Teams:conversation-manager:${t}:${e}`:`skypexspaces-${e}`}(e,t,n),o=function(e){return e?2:7}(n);return(0,l.q8)(i,o,"conversations","",a,!0)}))}function N(e){const t=e.get(g);if(t)return f(t)}function A(e,t){e.setSafe(g,JSON.stringify({timestamp:Date.now(),teams:t}))}},319515:(e,t,n)=>{"use strict";n.d(t,{k:()=>i});const i="webinar-service"},966896:(e,t,n)=>{"use strict";n.d(t,{C:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"webinarImageQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"webinarId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"webinarImage"},arguments:[{kind:"Argument",name:{kind:"Name",value:"webinarId"},value:{kind:"Variable",name:{kind:"Name",value:"webinarId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"image"}}]}}]}}]}},576333:(e,t,n)=>{"use strict";n.d(t,{H:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"webinar"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"webinarId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"webinar"},arguments:[{kind:"Argument",name:{kind:"Name",value:"webinarId"},value:{kind:"Variable",name:{kind:"Name",value:"webinarId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"allWebinarFiels"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"allWebinarFiels"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Webinar"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"eventDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"accessPolicy"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"isFull"}},{kind:"Field",name:{kind:"Name",value:"privacyProfileStatementLink"}}]}},{kind:"Field",name:{kind:"Name",value:"speakerBios"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"speakerId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"description"}}]}},{kind:"Field",name:{kind:"Name",value:"questionnaire"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"questionId"}},{kind:"Field",name:{kind:"Name",value:"order"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"options"}},{kind:"Field",name:{kind:"Name",value:"isRequired"}},{kind:"Field",name:{kind:"Name",value:"isPredefined"}}]}},{kind:"Field",name:{kind:"Name",value:"isUserAlreadyRegistered"}},{kind:"Field",name:{kind:"Name",value:"joinLink"}},{kind:"Field",name:{kind:"Name",value:"participantRole"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"registrationId"}}]}}]}},149782:(e,t,n)=>{"use strict";n.d(t,{O:()=>a,a:()=>o});var i=n(576333);const a=(e,t)=>{try{const n=e.readQuery({query:i.H,variables:{webinarId:t}});if(!n||!n.webinar)throw new Error("Invalid cached webinar data");return n.webinar}catch(e){throw e}},o=(e,t,n,o)=>{try{const o=a(n,e),r=Object.assign(Object.assign({},o),{questionnaire:t.map((e=>{var t,n,i;return Object.assign(Object.assign({},e),{name:null!==(t=e.name)&&void 0!==t?t:null,displayName:null!==(n=e.displayName)&&void 0!==n?n:null,options:null!==(i=e.options)&&void 0!==i?i:null,__typename:"WebinarQuestion"})}))});n.writeQuery({variables:{webinarId:e},query:i.H,data:{webinar:r}})}catch(e){throw o.error("Webinar resolver fails to update webinar questions in cache."),e}}},403223:(e,t,n)=>{"use strict";n.d(t,{s:()=>c});var i=n(319515),a=n(576333),o=n(966896),r=n(149782);let s;const l=e=>s||(s=e.newLogger(i.k)),c={Mutation:{updateWebinarDetails:(e,{webinarId:t,detailsInput:n},{cache:i,loggerFactory:o})=>{l(o);try{const e=(0,r.O)(i,t),o=Object.assign(Object.assign({},e),{eventDetails:Object.assign(Object.assign(Object.assign({},e.eventDetails),n),{__typename:"WebinarDetails"})});return i.writeQuery({variables:{webinarId:t},query:a.H,data:{webinar:o}}),{_:!0,__typename:"Webinar"}}catch(e){throw s.error("Webinar resolver fails to update webinar details in cache."),e}},updateWebinarQuestions:(e,{webinarId:t,questionsInput:n},{cache:i,loggerFactory:a})=>(l(a),(0,r.a)(t,n,i,s),{_:!0,__typename:"Webinar"}),updateWebinarSpeakers:(e,{webinarId:t,speakersInput:n},{cache:i,loggerFactory:o})=>{l(o);try{const e=(0,r.O)(i,t),o=Object.assign(Object.assign({},e),{speakerBios:n.map((e=>Object.assign(Object.assign({},e),{__typename:"WebinarSpeakerBio"})))});return i.writeQuery({variables:{webinarId:t},query:a.H,data:{webinar:o}}),{_:!0,__typename:"Webinar"}}catch(e){throw s.error("Webinar resolver fails to update webinar speakers in cache."),e}},updateWebinarImage:(e,{webinarId:t,webinarImageInput:n},{cache:i,loggerFactory:a})=>{l(a);try{return i.writeQuery({variables:{webinarId:t},query:o.C,data:{webinarImage:{image:n.image,__typename:"WebinarImage"}}}),{_:!0,__typename:"Webinar"}}catch(e){throw s.error("Webinar resolver fails to update webinar image in cache."),e}}}}},539646:(e,t,n)=>{"use strict";n.d(t,{xA:()=>z,FX:()=>G,X7:()=>q,NL:()=>Vt,AY:()=>tt,pR:()=>Ve,Gt:()=>we,DP:()=>Ce,qJ:()=>xt,C:()=>qe,MB:()=>bt,uA:()=>Ie,Km:()=>Gt,s2:()=>Qt,PI:()=>Jt,O4:()=>Kt,dx:()=>ye,Qq:()=>Qe,vI:()=>Ke,eY:()=>Et,nI:()=>Bt,rP:()=>Pt,eX:()=>jt,UL:()=>Ot,Eu:()=>$t,wm:()=>Ut,C6:()=>Dt,im:()=>ft,AK:()=>Lt,fM:()=>Wt,GE:()=>Ht,Ey:()=>fe,bv:()=>Ne,lg:()=>ct,yU:()=>Te,x6:()=>st,_$:()=>rt,Bq:()=>Ft,Hl:()=>lt,_l:()=>Re,sf:()=>Oe,TK:()=>be,b_:()=>ze,FH:()=>$e,Th:()=>ke,Lr:()=>ot,it:()=>pe,ob:()=>xe,fN:()=>X,is:()=>se,ts:()=>re,_S:()=>dt,zK:()=>Se,ac:()=>Ee,_V:()=>It,Pi:()=>kt});var i=n(231191),a=n(723128),o=n(635649),r=n(261062),s=n(636554),l=n(889454),c=n(272009),d=n(143028),u=n(683103),m=n(67829),p=n(944028),g=n(638307),h=n(909260),v=n(188682),f=n(775214),y=n(352367),S=n(892891);const k="default",b="CallableChannelOboCall",_=e=>"incoming"===e?o.CallDirection.Incoming:"outgoing"===e?o.CallDirection.Outgoing:o.CallDirection.Unknown,C=e=>{switch(e){case"missed":return o.CallLogCallState.Missed;case"accepted":return o.CallLogCallState.Accepted;case"declined":return o.CallLogCallState.Declined;case"acceptedElsewhere":return o.CallLogCallState.AcceptedElsewhere;default:return o.CallLogCallState.Unknown}},w=e=>"twoParty"===e?o.CallLogCallType.TwoParty:"multiParty"===e?o.CallLogCallType.MultiParty:o.CallLogCallType.Unknown,T=e=>{switch(e){case"default":return o.CallLogSessionType.Default;case"screenSharing":case"ScreenSharing":return o.CallLogSessionType.ScreenSharing;case"emergencyGroupCall":return o.CallLogSessionType.EmergencyGroupCall;default:return o.CallLogSessionType.Unknown}},E=e=>e?Object.assign({type:k},e):void 0,I=e=>({type:e.type,configId:e.configId,onBehalfOf:e.onBehalfOf&&Object.assign({type:k},e.onBehalfOf),details:e.details&&Object.assign({type:k},e.details)}),N={__typename:"CallLogParticipant",displayName:"Uknown",id:"28:unknown",type:k},A=(e,t)=>{var n;if(!e)return"";const i='value="',a=null===(n=e.find((e=>e.indexOf(t)>=0)))||void 0===n?void 0:n.match(/value="(.*?)"/g);return a?a[0].substr(i.length,a[0].length-i.length-1):""},M=(e,t,n,i,a)=>{let o,r,s,l,c=(new Date).toISOString();if(a===d.Cs.CallTranscript){const t=((e,t)=>{if(t)try{const e=JSON.parse(unescape(t.replace(/\u200b|\\/g,"")));return{callId:e.callId,userParticipantId:e.originatorParticipantId,transcriptMsg:{scopeId:e.scopeId}}}catch(t){return void e.error("failed to parse transcription content.",t)}})(e,n);if(!t)return;o=t.callId,r=t.userParticipantId,s=t.transcriptMsg}else if(a===d.Cs.CallLogTranscript){const t=((e,t)=>{if(t)try{const e=JSON.parse(unescape(t.replace(/\u200b|\\/g,""))),{CallId:n,UserParticipantId:i,ThreadId:a,MessageId:o}=e;return{callId:n,userParticipantId:i,transcriptMsg:{linkedMessage:{conversationId:a,messageId:o}}}}catch(t){return void e.error("failed to parse transcription content.",t)}})(e,n);if(!t)return;o=t.callId,r=t.userParticipantId,s=t.transcriptMsg}else if(a===d.Cs.CallLogRecording){const t=((e,t)=>{if(t)try{const e=JSON.parse(unescape(t.replace(/\u200b|\\/g,""))),{CallId:n,UserParticipantId:i,ThreadId:a,MessageId:o}=e;return{callId:n,userParticipantId:i,recordingMsg:{linkedMessage:{conversationId:a,messageId:o}}}}catch(t){return void e.error("failed to parse recording message content.",t)}})(e,n);if(!t)return;o=t.callId,r=t.userParticipantId,l=t.recordingMsg}else if(a===d.Cs.CallRecording){const e=((e,t)=>{if(!e)return;const n=e.match(/<.*?>/g),i=A(n,'<Id type="callId"'),a=A(n,'<Id type="OriginatorParticipantId"'),o=A(n,"<RecordingInitiatorId ");return{callId:i,userParticipantId:a,recordingMsg:{conversationId:d.wS,messageId:t||"",initiatorId:o,content:e}}})(n,i);if(!e)return;o=e.callId,r=e.userParticipantId,l=e.recordingMsg}else o=t.callId,r=null==t?void 0:t.userParticipantId,c=t.startTime;return{callId:o,userParticipantId:r,transcript:s,recordings:l&&[l],startTime:c}},F=(e,t,n,i,a,o)=>{var r,s,l;if(void 0===n?!t:n!==d.wS)return;const c=o.newLogger("CallHistoryHelper");try{const n=t?JSON.parse(t):{},{applicationContent:o,callDirection:d,callState:u,callType:m,connectTime:p,endTime:g,messageId:h,originatorParticipant:v,participantList:f,sessionType:y,sharedCorrelationId:S,targetParticipant:k,threadId:A,spamProperties:F,onBehalfOfContext:R,callAttributes:P}=n;let D;D=R&&!o?{type:b,configId:R.id,onBehalfOf:{type:(null===(r=null==P?void 0:P.onBehalfOf)||void 0===r?void 0:r.type)||b,id:null===(s=null==P?void 0:P.onBehalfOf)||void 0===s?void 0:s.id,displayName:null===(l=null==P?void 0:P.onBehalfOf)||void 0===l?void 0:l.displayName}}:o;const j=M(c,n,a,e,i);if(!j)return;let x=E(v);x||(x=N,c.warn(`Could not parse valid participant from ${t}`));return Object.assign({applicationContent:D&&I(D),callDirection:_(d),callState:C(u),callType:w(m),connectTime:p,endTime:g,messageId:h,originatorParticipant:x,participantList:f?f.map(E):[],targetParticipant:k&&E(k),threadId:A,sessionType:T(y),sharedCorrelationId:null!=S?S:"",spamRiskLevel:F?F.riskLevel:null},j)}catch(e){c.warn(`UnhandledException in message transformation: ${e}`)}};var R=n(141044),P=n(942601),D=n(367941),j=n(771373),x=n(338870);const O=e=>{const t="meeting.scheduledMeetingInfo";let n=B(e,["startTime","endTime","eventType"],t);if(e){const{eventRecurrenceRange:i,eventRecurrencePattern:a}=e;n=[...n,...L(i,t),...U(a,t)]}return n},L=(e,t)=>B(e,["startDate"],`${t}.eventRecurrenceRange`),U=(e,t)=>{let n=[];if(e){const{daily:i,weekly:a,monthly:o,yearly:r,relativeMonthly:s,relativeYearly:l}=e;n=[...B(e,["patternType"],`${t}.eventRecurrencePattern`),...B(i,["interval"],`${t}.eventRecurrencePattern.daily`),...B(a,["interval","daysOfTheWeek"],`${t}.eventRecurrencePattern.weekly`),...B(o,["interval","dayOfMonth"],`${t}.eventRecurrencePattern.monthly`),...B(r,["month","dayOfTheMonth"],`${t}.eventRecurrencePattern.yearly`),...B(s,["interval","dayOfTheWeekIndex","dayOfTheWeek"],`${t}.eventRecurrencePattern.relativeMonthly`),...B(l,["month","dayOfTheWeekIndex","dayOfTheWeek"],`${t}.eventRecurrencePattern.relativeYearly`)],a&&a.daysOfTheWeek&&a.daysOfTheWeek.some((e=>(0,S.isNil)(e)))&&n.push(`${t}.eventRecurrencePattern.weekly.daysOfTheWeek`)}return n},B=(e,t,n)=>{const i=[];return(0,S.isNil)(e)||t.forEach((t=>{(0,S.isNil)(e[t])&&i.push(`${n}.${t}`)})),i},W="http://schema.skype.com/StarredMessage",H=g.F,$=new Map([["sms",o.EscalationModality.SMS],["email",o.EscalationModality.Email],["call",o.EscalationModality.Call],["teamscall",o.EscalationModality.TeamsCall],["etnp",o.EscalationModality.ETNP]]),V=new Set(["RichText/Media_CallRecording","RichText/Media_CallTranscript","Event/Call"]),z="preview-",G="newchat",q="new-chat-selected-users",J="deeplink",K=(e,t)=>(null==e?void 0:e.emotions)?t?e.emotions.map((({key:e,users:t})=>({key:e,users:t.map((({mri:e,time:t,value:n})=>({id:H(e),time:t,value:n}))).sort(((e,t)=>(null==t?void 0:t.time)-(null==e?void 0:e.time)))}))).sort(((e,t)=>{var n,i,a,o;return(null===(n=null==t?void 0:t.users)||void 0===n?void 0:n.length)-(null===(i=null==e?void 0:e.users)||void 0===i?void 0:i.length)==0?(null===(a=null==t?void 0:t.users[0])||void 0===a?void 0:a.time)-(null===(o=null==e?void 0:e.users[0])||void 0===o?void 0:o.time):(null==t?void 0:t.users.length)-(null==e?void 0:e.users.length)})):e.emotions.map((({key:e,users:t})=>({key:e,users:t.map((({mri:e,time:t,value:n})=>({id:H(e),time:t,value:n})))}))):null,Q=e=>{if(!e||!e.emotions)return null;const t=e.emotions;return Object.keys(t).map((e=>({key:e,count:t[e]})))},Y=e=>{if(!e||!e.escalations)return null;return JSON.parse(e.escalations).map((({key:e,users:t})=>({key:$.get(e),users:t.map((({mri:e,time:t,value:n})=>({mri:H(e),time:t,value:n})))})))},X=(e,t)=>e&&e.mentions?te(e.mentions,t):null,Z=(e,t)=>e&&e.onbehalfof?te(e.onbehalfof,t):null,ee=(e,t)=>{if(!t||!t.atp)return null;const n=t.atp;try{return"string"==typeof n?JSON.parse(n):n}catch(t){return e.newLogger("Chat Helper").log(`UnhandledException in toAtpSharepointData: ${t}`),null}},te=(e,t)=>{const n="string"==typeof e?JSON.parse(e):e;return n?n.map((({itemid:e,mri:n,displayName:i,mentionType:a})=>({id:`${t}_${e}_${n}`,userId:n,itemId:e,displayName:i,mentionType:a}))):null},ne=e=>{if(!e||!e.files)return null;try{let t=JSON.parse(null==e?void 0:e.files);return t=t.filter((e=>e.type===J)),t.map((({id:e,title:t,fileInfo:n,channelId:i,state:a})=>({id:e,title:t,state:a,serverRelativeUrl:n.serverRelativeUrl,channelId:i,siteUrl:n.siteUrl,objectUrl:n.fileUrl})))}catch(e){return null}},ie=e=>{if(!e||!e.files)return null;try{let t=JSON.parse(e.files);t=t.filter((e=>e.type!==J));return(0,S.map)(t,(e=>ae(e)))}catch(e){return null}},ae=e=>{{const t=2,n=["http","https"],{filePreview:i,chicletBreadcrumbs:a,fileInfo:r,anchorFileId:s,progressComplete:l,isUploadError:c,fileChicletState:d}=e,{shareUrl:u,shareId:m,itemId:p}=r,g=i||{},v=null==d?void 0:d.serviceName,{id:f,baseUrl:y,objectUrl:S,type:k,title:b,state:_}=oe(e,t),C="active"!==_&&"hidden"!==_;return Object.assign({id:f,itemId:p,chicletBreadcrumbs:a,baseUrl:(0,h.Nm)(y,n),objectUrl:(0,h.Nm)(S,n),shareId:m,shareUrl:u,type:k,title:b,fileId:f,isReferencedFile:C,anchorFileId:s,progressComplete:l&&parseInt(l,10)||null,serviceName:v&&o.FileViewServiceName[v],state:_&&o.FileChicletState[_],hasUploadFailed:c},g)}},oe=(e,t)=>{var n;const{version:i}=e;let{id:a,baseUrl:o,objectUrl:r,type:s,title:l,state:c}=e;if(i!==t&&(({itemid:a,fileName:l,fileType:s,fileInfo:{fileUrl:r,siteUrl:o}}=e),c=null===(n=e.fileChicletState)||void 0===n?void 0:n.state),"string"!=typeof a)throw(0,f.Tr)("ChatHelpers",y.jK.Undefined,"toFiles",{id:a,version:i,type:s},"File id is missing");return{id:a,baseUrl:o,objectUrl:r,type:s,title:l,state:c}},re=e=>JSON.stringify((0,S.map)(e,(({id:e,itemId:t,baseUrl:n,type:i,title:a,objectUrl:o,previewUrl:r,shareUrl:s,shareId:l,state:c,chicletBreadcrumbs:d,serviceName:u,previewHeight:m,previewWidth:p,progressComplete:g,hasUploadFailed:h})=>({itemid:e,fileName:a,fileType:i,fileInfo:{itemId:t,fileUrl:o,siteUrl:n,serverRelativeUrl:"",shareUrl:s,shareId:l},fileChicletState:{serviceName:u,state:c},"@type":"http://schema.skype.com/File",version:2,id:e,baseUrl:n,objectUrl:o,type:i,title:a,state:c,chicletBreadcrumbs:d,providerData:{code:null,type:0},botFileProperties:{},isUploadError:h,progressComplete:g,filePreview:{previewUrl:r,previewHeight:m,previewWidth:p}})))),se=e=>e&&JSON.stringify((0,S.map)(e,(e=>{var{content:t}=e,n=(0,i.__rest)(e,["content"]);return Object.assign(Object.assign({},n),{content:JSON.parse(t)})}))),le=(e,t)=>{if(!e||!e.links)return{urlPreview:null,embeddedLinks:null};try{const t=["http","https"],n=JSON.parse(e.links),i=[],a=[];return n.forEach((e=>{ce(e,i,t),de(e,a,t)})),{urlPreview:a.length>0?a[0]:null,embeddedLinks:i}}catch(e){return t.newLogger("Chat Helper").log(`UnhandledException in message transformation: ${e}`),{urlPreview:null,embeddedLinks:null}}},ce=(e,t,n)=>{const{url:i,fileShareUrlMeta:a,title:o,description:r}=e,s=(0,h.Nm)(i,n);a&&t.push({objectUrl:s,title:o,description:r,fileShareUrlMeta:a})},de=(e,t,n)=>{const{url:i,preview:a,previewenabled:o}=e,{previewurl:r,previewmeta:s,title:l,description:c}=a||{},d=(0,h.Nm)(i,n);t.push({url:d,thumbnail:(0,h.Nm)(r,n),title:l,description:c,previewEnabled:o,thumbnailMeta:s?{width:s.width,height:s.height}:null})},ue=(e,t,n)=>{if(!t||!t.cards)return null;try{let e=t.cards;n&&(e=n);return JSON.parse(e).map((({appIcon:e,appId:t,appName:n,cardClientId:i,content:a,contentType:o,locale:r,userSpecificContent:s})=>Object.assign({appIcon:e,appId:t,appName:n,cardClientId:i,content:JSON.stringify(a),contentType:o,locale:r},!!s&&{userSpecificContent:s})))}catch(t){return e.newLogger("Chat Helper").log(`UnhandledException in toCards: ${t}`),null}},me=(e,t,n,i)=>{let a=i&&i.policyViolation;const o=i&&i.genericStreamMetadata;if(!a&&!o)return null;const r={};if("string"==typeof a)try{a=JSON.parse(a)}catch(n){e.newLogger("Chat Helper").log(`Exception in parsing PolicyViolation in message: ${t}. Error: ${n}`)}a&&(r.policyViolation=a);let s=o&&o.policyTip;if("string"==typeof o)try{s=JSON.parse(o).policyTip}catch(n){e.newLogger("Chat Helper").log(`Exception in parsing policy tip in message: ${t}. Error: ${n}`)}return s&&(r.dlpData={id:t,content:n,policyTip:s}),r},pe=(e,t)=>{if(!t||!t.meeting)return null;try{const e=JSON.parse(t.meeting),{organizerId:n,tenantId:i,meetingJoinUrl:a,location:o,itemid:r,meetingtitle:s,scheduledmeetinginfo:l,rsvpTo:c,body:d}=e;return(e=>{const{scheduledMeetingInfo:t}=e,n=O(t);if(n.length)throw(0,f.Tr)(y.w5.DataLayerClient,y.jK.MissingParameter,`validate Meeting schema failed. Missing required prop(s): ${n.join(", ")}`);return e})({organizerId:n,tenantId:i,meetingJoinUrl:a,location:o,itemId:r,meetingTitle:s,rsvpTo:c,body:d,scheduledMeetingInfo:l})}catch(t){return e.newLogger("Chat Helper").log(`UnhandledException in toMeeting: ${t}`),null}},ge=(e,t,n,i)=>{const a=t||n;if(a)return a;if(i&&V.has(e)){const e=i.match(/<id type="callId"[^>]*?\svalue="([^"]+?)"/i);return e&&e[1]||null}return null},he=(e,t)=>"-1"===e?t:e,ve=(0,l.Z)((e=>new Intl.Collator(e,{numeric:!1,sensitivity:"accent"}))),fe=(e,t)=>{if(e.length<=1)return e;const n=ve(t),i=[...e];return i.sort(((e,t)=>n.compare(e.displayName||"",t.displayName||""))),i},ye=(e,t,n)=>{const i=fe(e,n),a=[],o=[];return(0,S.forEach)(i,(e=>{const{id:n,displayName:i}=e;if(n!==t&&!(0,c.bl)(n)&&!x.e.isTFLOffNetworkUser(n)&&i){if(o.push(i),20===o.length)return!1;a.length<3&&a.push(e)}return!0})),{membersLimited:a,memberDisplayNamesLimited:o}},Se=(e,t,n,i,a,o)=>{var s;if(!(null==e?void 0:e.id))return;const l=ke(e,t,i,a,n,o),{id:c,clientmessageid:d,messagetype:u,properties:m,callId:p,skypeguid:g,composetime:h,content:v,conversationid:f}=e;return Object.assign(Object.assign({},l),{__typename:"Message",interopDeliveryState:m&&m.deliveryState&&m.deliveryState.state,smsDeliveryReports:m&&m.smsDeliveryReports?m.smsDeliveryReports:null,announcement:Ne(m),escalations:Y(m),notification:zt(t,m),meeting:pe(t,m),onBehalfOf:Z(m,c),callId:ge(u,p,g||m&&m.skypeguid,v),callLog:m&&F(he(c,d),m["call-log"],f,u,v,t),skypeguid:g,composeTime:h,isCallStartedMessage:(0,r.LY)(v,u),replyPermission:null!==(s=null==m?void 0:m.replyPermission)&&void 0!==s?s:null,atpSharepointData:ee(t,m),isDeletedByAdmin:(null==m?void 0:m.adminDelete)||!1,suggestedActions:(null==m?void 0:m.suggestedActions)||null})},ke=({id:e,content:t,originalarrivaltime:n,from:i,messagetype:a,annotationsSummary:r,userHasStarred:s,properties:l,clientmessageid:c,version:d,imdisplayname:u},m,p,g,h,v=!1)=>{let f=t;p&&(f=p);const y=ue(m,l,g);return Object.assign(Object.assign({id:he(e,c),content:f,originalArrivalTime:n,from:H(i),messageType:Me(m,a,l),isImportant:(0,R.wU)(l&&l.importance),importance:(0,R.gy)(l&&l.importance),emotionsSummary:Q(r),emotions:K(l,v),mentions:X(l,e),cards:y,files:ie(l),deeplinks:ne(l)},le(l,m)),{deleteTime:l&&l.deletetime,editTime:l&&l.edittime,version:d,userHasSaved:s,imDisplayName:u,clientMessageId:c,dlpContext:me(m,e,t,l),status:h||o.MessageStatus.Delivered})},be=({content:e,id:t,messageType:n,originalArrivalTime:i,type:a,version:o})=>({__typename:"Message",content:e,id:t,messageType:n,originalArrivalTime:new Date(i).toISOString(),type:a,version:o}),_e=(e,t)=>{const n=Se(e,t,It(e.state));if(!n)throw(0,f.Tr)("ChatHelpers",y.jK.Undefined,"toNewMessageSchema",{resource:e},"Bad shaped NewMessage");let i=null;if(e&&e.conversationLink){const t=(0,c.P5)(e);i=t===n.id?null:t}return{convId:e.conversationid||(0,c.o_)(e),replyChainId:i,threadType:e.threadtype,threadTopic:e.threadtopic,message:n}};function Ce(e,t){return{__typename:"Message",content:"",messageType:"Text",id:e,originalArrivalTime:t,imDisplayName:null,from:null,deleteTime:null,files:null,cards:null,embeddedLinks:null,callId:null,replyPermission:null,onBehalfOf:null,atpSharepointData:null,deeplinks:null,version:null,importance:null,interopDeliveryState:null,smsDeliveryReports:null,suggestedActions:null,emotions:null,emotionsSummary:null,escalations:null,mentions:null,status:null,diagnosticInfo:null,clientMessageId:e,urlPreview:null,dlpContext:null,editTime:null,deletionInfo:null,translation:null,userHasSaved:null}}function we(e,t){return{__typename:"ConsumptionHorizon",id:e,originalArrivalTime:t,timeStamp:t,clientMessageId:(0,D.K)()}}function Te(e){const t=new Date,n=t.toISOString(),i=t.getTime().toString();return Object.assign(Object.assign({},{members:[],membersLimited:[],activeCallsCount:null,canBeDiscarded:null,canBeFavorited:null,canBeHidden:null,botMembers:null,canBeLeft:null,canBeMuted:null,canBePinned:null,canBotBeBlocked:null,canManageApps:null,canPopOut:null,canTagContact:null,chatSubType:null,isDisabled:!1,isOneOnOne:!1,isOneOnOneBotChat:!1,isRead:!0,datatid:null,displayName:null,hasActions:null,hasActiveCalls:null,hasFailedMessages:null,isBotBlocked:null,isBotUser:null,isContactTagged:null,isFederated:!1,isHidden:null,isHighImportance:null,isLastMessageFromMe:null,isLastMessageText:null,isMeeting:!1,isMuted:null,isNewChat:!0,isSfB:!1,isUrgentImportance:null,lastMessageSender:null,isUserMember:!0,creator:null,meetingInformation:null,userConsumptionHorizon:null,consumptionHorizonBookmark:null,lastMessageTime:null,longTitle:null,messagePreview:null,messagePreviewAria:null,otherMemberMris:null,pictureGroup:null,pictureUpn:null,pinnedIndex:null,plGroupKey:null,presenceSource:null,showAtMention:null,showMarkers:null,tooltipTitle:null,substrateGroupId:null}),{__typename:"Conversation",id:e,memberIds:[],memberDisplayNamesLimited:[],nonTeamsFederatedUserLimitedNames:[],hasFederatedUser:!1,chatHistoryHiddenTime:null,hasTflConsumerUser:!1,hasEnterpriseUser:!1,hasUnknownConsumerUser:!1,hasUnknownEnterpriseUser:!1,hasTflSmsUnverifiedUser:!1,hasTflSmsVerifiedUser:!1,tflOffNetworkUser:null,cfet:!1,consumerGroupId:null,tenantId:null,title:"",hasBotMember:!1,hasUnresolvedFederatedUser:!1,isChatDisabledForRecipients:!1,typingUsers:[],isPrivateChatPolicyDefinedScenario:null,meetingChatPolicy:null,me:null,tflOffNetworkUserLength:null,nonTeamsFederatedUsers:[],nonTeamsFederatedUsersLength:0,chatType:o.ChatType.Chat,type:o.ChatType.Chat,lastMessage:Ce(i,n),consumptionHorizon:we(e,n)})}const Ee=(e,t,n,a=!1)=>{var{annotationsSummary:r,id:s,from:l,messageType:c,properties:d,version:u}=e,m=(0,i.__rest)(e,["annotationsSummary","id","from","messageType","properties","version"]);if(!s)return null;try{return Object.assign(Object.assign(Object.assign({__typename:"Message",id:s,from:l,messageType:Me(n,c,d),version:(0,S.isNumber)(u)?u.toString():void 0,isImportant:(0,R.wU)(d&&d.importance),importance:(0,R.gy)(d&&d.importance),interopDeliveryState:d&&d.deliveryState&&d.deliveryState.state,smsDeliveryReports:(null==d?void 0:d.smsDeliveryReports)||null,emotions:K(d,a),emotionsSummary:Q(r),announcement:Ne(d),escalations:Y(d),mentions:X(d,s),onBehalfOf:Z(d,s),cards:ue(n,d),files:ie(d),deeplinks:ne(d)},le(d,n)),{deleteTime:d&&d.deletetime,editTime:d&&d.edittime,isDeletedByAdmin:d&&d.adminDelete,suggestedActions:(null==d?void 0:d.suggestedActions)||null,status:o.MessageStatus.Delivered,dlpContext:me(n,s,m.content,d),meeting:pe(n,d),callId:d&&d.skypeguid,callLog:d&&F(s,d["call-log"],t,c,m.content,n)}),m)}catch(e){return n.newLogger("Chat Helper").log(`UnhandledException in message transformation: ${e}`),Object.assign({id:s,from:l,messageType:Me(n,c,d),isImportant:null,emotions:null,mentions:null,files:null,announcement:null,urlPreview:null,deleteTime:null,status:null},m)}},Ie=({originalArrivalTime:e,timeStamp:t,clientMessageId:n})=>({originalArrivalTime:new Date(e).toISOString(),timeStamp:new Date(t).toISOString(),clientMessageId:n}),Ne=e=>{const t={title:"",originalImageUrl:null,croppedImageUrl:null,colorTheme:null};if(!e)return t;const n="string"==typeof e.cards?JSON.parse(e.cards):e.cards;if(!n||0===n.length)return t;const i=n.find((e=>"application/vnd.microsoft.teams.messaging-announcementBanner"===e.contentType));if(!i)return t;const a=Ae(i);return{title:e.title?e.title:"",originalImageUrl:a.originalImageUrl,croppedImageUrl:a.croppedImageUrl,colorTheme:a.colorTheme,croppedImageHeight:a.croppedImageHeight,croppedImageWidth:a.croppedImageWidth}},Ae=e=>{let t=(0,S.get)(e,"content.imageData.origImage.src",null),n=(0,S.get)(e,"content.imageData.croppedImage.src",null);const i=(0,S.get)(e,"content.imageData.croppedImage.imageHeight",null),a=(0,S.get)(e,"content.imageData.croppedImage.imageWidth",null);let o=(0,S.get)(e,"content.imageData.colorTheme",null)||(0,S.get)(e,"content.colorTheme",null);return t=void 0===t?null:t,n=void 0===n?null:n,o=void 0===o?null:o,{originalImageUrl:t,croppedImageUrl:n,croppedImageHeight:i,croppedImageWidth:a,colorTheme:o}},Me=(e,t,n)=>t===d.Cs.HTML&&Fe(e,n)?d.Cs.Collaborate:t,Fe=(e,t)=>{const n=ue(e,t);if(!n)return!1;const i=(0,S.find)(n,(e=>"application/vnd.microsoft.card.fluid"===e.contentType));if(!i)return!1;return!!JSON.parse(i.content).componentUrl},Re=(e,t)=>{if(!t||(0,S.isEmpty)(t))return null;const[n,i,a]=t.split(";");return Object.assign({id:e},Ie({originalArrivalTime:parseInt(n,10),timeStamp:parseInt(i,10),clientMessageId:a}))},Pe=(e,t,n)=>{try{const n=De(t),i=null==n?void 0:n.map((t=>({activityReplyToId:t.replyToId,activityTimestamp:t.timestamp,convId:e,suggestedReplies:t.suggestedActions.actions.filter((e=>{var t,n;return(null===(t=null==e?void 0:e.channelData)||void 0===t?void 0:t.id)&&(null===(n=null==e?void 0:e.channelData)||void 0===n?void 0:n.utcTime)})).map((e=>{var n,i;const a={targetMessageId:(null===(n=null==e?void 0:e.channelData)||void 0===n?void 0:n.targetMessageId)||t.replyToId,type:(null===(i=null==e?void 0:e.channelData)||void 0===i?void 0:i.type)||"reply"};return{suggestionChannelData:Object.assign(Object.assign({},null==e?void 0:e.channelData),a),value:e.value,whisperId:t.id}}))})));return i&&0!==i.length?{suggestedRepliesCollections:i}:null}catch(e){return n.newLogger("Chat Helper").error(`formatQuickReplyAugmentationFromObject: Exception in parsing quick reply augmentation. Error: ${e}`),null}},De=e=>{const t=e&&e.suggestedActivities&&e.suggestedActivities.filter((e=>{var t,n,i;return(null==e?void 0:e.type)===d.uV&&(null===(t=null==e?void 0:e.from)||void 0===t?void 0:t.id)===d.ZI&&(null==e?void 0:e.timestamp)&&(null===(i=null===(n=null==e?void 0:e.suggestedActions)||void 0===n?void 0:n.actions)||void 0===i?void 0:i.some((e=>e.type===d.qC||e.type===d.DC)))}));return t&&0!==t.length?t:null},je=(e,t,n)=>{const i=t&&t[d.Ff.SmartReplies];return i&&"string"==typeof i?((e,t,n)=>{try{const i=JSON.parse(t);return Pe(e,i,n)}catch(e){return n.newLogger("Chat Helper").error(`formatQuickReplyAugmentationFromString: Exception in parsing quick reply augmentation. Error: ${e}`),null}})(e,i,n):null},xe=e=>{switch(e){case u.wJ.None:return o.MeetingType.Unknown;case u.wJ.Adhoc:return o.MeetingType.Adhoc;case u.wJ.Scheduled:return o.MeetingType.Scheduled;case u.wJ.Recurring:return o.MeetingType.Recurring;case u.wJ.Broadcast:return o.MeetingType.Broadcast;case u.wJ.MeetNow:return o.MeetingType.MeetNow}},Oe=e=>e&&e.map((e=>({id:e.id,originalArrivalTime:e.consumptionhorizon,messageVisibilityTime:e.messageVisibilityTime})))||null;function Le(e,t,n,i,a){const o=qe(e,n),r=e.find((({id:e})=>e===t))||null,s=Tt(e);return Object.assign(Object.assign(Object.assign(Object.assign({memberIds:e.map((({id:e})=>e))},ye(e,t,i)),Ve(o)),tt(t,e)),{me:r,isUserMember:!!r,lastMessageSender:a?e.find((({id:e})=>e===a)):null,tflOffNetworkUser:(0,S.first)(s),tflOffNetworkUserLength:s.length,hasBotMember:e.some((({id:e})=>(0,c.bl)(e))),hasFederatedUser:!!o.length,hasTflConsumerUser:Qe(e),hasEnterpriseUser:et(e),hasUnknownEnterpriseUser:Ze(e),hasUnknownConsumerUser:Xe(e),hasUnresolvedFederatedUser:o.some(x.e.isUnknownUser),hasTflSmsUnverifiedUser:Ke(e),hasTflSmsVerifiedUser:Ye(e)})}const Ue=e=>{switch(typeof e){case"string":return"true"===e.toLowerCase()}return e};function Be(e){var t;const n=Object.keys(null!==(t=e.threadProperties)&&void 0!==t?t:{}).filter((e=>e.includes(d.Q5.Liveness))).map((t=>({key:t,value:e.threadProperties[t]})));return(0,S.isEmpty)(n)?null:n}function We(e,t,n,i,a,o,r){const{id:s,lastMessage:l}=e;let c;l&&(c=ot(Se(l,i)));const u=!!(0,m.YP)(e),p=Le(t,(null==o?void 0:o.id)||"",a,r,null==c?void 0:c.from);return Object.assign(Object.assign(Object.assign(Object.assign({},e),p),function(e,t){const{id:n,properties:i,threadProperties:a}=e,o=Re(n,i[d.Ff.ConsumptionHorizonBookmark]);return{chatSubType:ut(a.threadType),chatType:pt(a.threadType),consumptionHorizon:Re(n,i[d.Ff.ConsumptionHorizon]),consumptionHorizonBookmark:o,quickReplyAugmentation:je(n,i,t),creator:a[d.Q5.Creator],importState:at(a[d.Q5.ImportState]),isDisabled:St(a.isDisabled),disabledReason:it(a.disabledReason),isLastMessageFromMe:a.isLastMessageFromMe,isRead:a.isRead,meetingInformation:_t(n,a[d.Q5.Meeting]),tenantId:a[d.Q5.TenantId],title:a.topic,userConsumptionHorizon:o,interopConversationStatus:ht(i[d.Ff.InteropConversationStatus]),gapDetectionEnabled:Ue(a.gapDetectionEnabled),cfet:Ge(a.cfet),consumerGroupId:a[d.Q5.ConsumerGroupId],guardianChatInfo:a[d.Q5.GuardianChatInfo],groupTemplate:a[d.Q5.GroupTemplate],picture:a[d.Q5.Picture]}}(e,i)),{id:s,isMuted:(0,m.tl)(e),isOneOnOne:u,isOneOnOneBotChat:u&&p.hasBotMember,lastMessage:c,awarenessLiveState:Be(e),members:[],clearHistoryTime:(0,m.dO)(e,n).toString(),chatHistoryHiddenTime:e.properties.historyHiddenTime,type:null})}const He=(e,t)=>(0,S.map)(t,(t=>e[t.id]||function(e){return(0,P.ne)(Object.assign(Object.assign({},e),{mri:e.id,objectId:"",type:"",userPrincipalName:"",isMuted:e.isReader,displayName:e.friendlyName}))}(t))),$e=(e,t,n,i,a,o,r)=>{try{return We(e,He(t,e.members),n,i,a,o,r)}catch(t){return i.newLogger("Chat Helper").log(`UnhandledException in toConversationSchemaFromSkypeConversationLocal transformation: ${t}`),Object.assign(Object.assign({},e),{id:e.id,isUserMember:!1,members:[],membersLimited:[],memberDisplayNamesLimited:[],type:null})}},Ve=e=>{const t=e.filter((e=>{var t;return!x.e.isUnknownUser(e)&&(null===(t=e.featureSettings)||void 0===t?void 0:t.coExistenceMode)!==s.hN.TeamsOnly&&!!e.displayName}));return{nonTeamsFederatedUserLimitedNames:t.slice(0,2).map((({displayName:e})=>e||"")),nonTeamsFederatedUsersLength:t.length}},ze=(e,t,n)=>{try{const n=He(t,e.members);return{id:e.id,members:n}}catch(t){return n.newLogger("Chat Helper").log(`UnhandledException in toConversationMembersSchemaFromSkypeConversationLocal transformation: ${t}`),{id:e.id,members:[]}}},Ge=e=>{switch(typeof e){case"string":return"true"===(null==e?void 0:e.toLowerCase())}return!!e},qe=(e,t)=>e.filter((({tenantId:e,isFederated:n})=>n||t&&e&&e!==t)),Je=e=>e&&e.startsWith(d.VJ)||!1,Ke=e=>e.some((({id:e})=>Je(e))),Qe=e=>e.some((e=>x.e.isTFLConsumerUser(e))),Ye=e=>e.some((e=>x.e.isTFLSmsVerifiedMri(null==e?void 0:e.id))),Xe=e=>e.some((e=>(0,c.Nl)(e.id)&&x.e.isUnknownUser(e))),Ze=e=>e.some((e=>x.e.isEnterpriseUserMri(e.id)&&x.e.isUnknownUser(e))),et=e=>e.some((e=>x.e.isEnterpriseUserMri(e.id))),tt=(e,t)=>{let n=!0;const i=t&&t.some((t=>{if(!t.isFederated&&t.id!==e&&t.featureSettings){const e=t.featureSettings.isPrivateChatEnabled;return null==e?(n=!1,!0):!e}return!1}));return{isPrivateChatPolicyDefinedScenario:n,isChatDisabledForRecipients:i}},nt={opted_out:o.DisableReasonCode.OptedOut,claimed:o.DisableReasonCode.Claimed,deprovisioned:o.DisableReasonCode.Deprovisioned},it=e=>{if(!e)return;const t=(0,v.D)(e);return{newlyCreatedUserId:t.userId,code:nt[t.code]}},at=e=>{if(e)return o.ClaimedConversationImportState[e]},ot=e=>Object.assign(Object.assign({},e),{__typename:"LastMessage"}),rt=(e,t,n,a,r)=>{var{id:s,members:l,consumptionHorizon:c,userConsumptionHorizon:u,lastMessage:m,creator:p,meetingInformation:g,isDisabled:h,disabledReason:v,importState:f,isMuted:y,isLastMessageFromMe:k,isRead:b,isOneOnOne:_,isOneOnOneBotChat:C,isSticky:w,isExternal:T,consumerGroupId:E,templateType:I,chatType:N,historyHiddenTime:A,createdAt:M,interopConversationStatus:F,quickReplyAugmentation:R}=e,D=(0,i.__rest)(e,["id","members","consumptionHorizon","userConsumptionHorizon","lastMessage","creator","meetingInformation","isDisabled","disabledReason","importState","isMuted","isLastMessageFromMe","isRead","isOneOnOne","isOneOnOneBotChat","isSticky","isExternal","consumerGroupId","templateType","chatType","historyHiddenTime","createdAt","interopConversationStatus","quickReplyAugmentation"]);try{const e=(0,S.map)(l,(e=>(0,P.ne)(e))),i=m&&ot(Ee(m,s,t)),A=g&&{id:s,subject:g.subject,startTime:g.startTime,scenario:g.scenario,endTime:g.endTime,iCalUid:g.iCalUid,location:g.location,exchangeId:g.exchangeId,meetingType:g.meetingType?xe(g.meetingType):o.MeetingType.Unknown},M=!(!_&&!w&&I!==d.Q5.ImmutableRoster);return Object.assign(Object.assign(Object.assign({__typename:"Conversation"},Le(e,(null==a?void 0:a.id)||"",n,r,null==i?void 0:i.from)),D),{id:s,consumptionHorizon:c&&Object.assign({__typename:"ConsumptionHorizon",id:s},Ie(c)),consumptionHorizonBookmark:u&&Object.assign({__typename:"ConsumptionHorizonBookmark",id:s},Ie(u)),userConsumptionHorizon:u&&Object.assign({__typename:"ConsumptionHorizonBookmark",id:s},Ie(u)),lastMessage:i,members:[],creator:p,meetingInformation:A,isDisabled:!!h,disabledReason:it(v),importState:at(f),isMuted:y,isLastMessageFromMe:!!k,isRead:b,isOneOnOne:M,cfet:T,consumerGroupId:E,isOneOnOneBotChat:!!C,chatType:pt(N),interopConversationStatus:ht(F),quickReplyAugmentation:R&&Pe(s,R,t)})}catch(e){t.newLogger("Chat Helper").log(`UnhandledException in conversation object transformation: ${e}`);return Object.assign(Object.assign({},D),{id:s,isUserMember:!1,consumptionHorizon:null,consumptionHorizonBookmark:null,userConsumptionHorizon:null,lastMessage:null,memberIds:[],members:[],membersLimited:[],chatHistoryHiddenTime:A,memberDisplayNamesLimited:[],creator:null,meetingInformation:null,chatType:null})}},st=({id:e,members:t},n)=>{try{const n=(0,S.map)(t,(e=>(0,P.ne)(e)));return{__typename:"ConversationMembers",id:e,members:n}}catch(t){n.newLogger("Chat Helper").log(`UnhandledException in conversation object transformation: ${t}`);return{id:e,members:[]}}},lt=(e,t,n,i,a)=>({node:rt(e,t,n,i,a),cursor:e.createdAt||e.id}),ct=e=>({activities:e.activities,callLogs:e.callLogs,chats:e.chats,total:e.total});function dt(e){return JSON.stringify((0,S.map)(e,(e=>{const t=e.mentionType,n=e.displayName;return{"@type":"http://schema.skype.com/Mention",itemid:e.itemId,mri:e.userId,mentionType:t,displayName:n}})))}const ut=e=>{if(e)return"space"===e||"topic"===e?u.k2.Channel:"meeting"===e?u.k2.Meeting:u.k2.None},mt=new Map([["chat",o.ChatType.Chat],["phonechat",o.ChatType.PhoneChat],["meeting",o.ChatType.Meeting],["sfbinteropchat",o.ChatType.SfBInteropChat]]),pt=e=>{let t=null;return null==e||(t=mt.get(e),void 0===t&&(t=null)),t},gt=new Map([["AcceptPending",o.InteropConversationStatus.AcceptPending],["Accepted",o.InteropConversationStatus.Accepted],["Blocked",o.InteropConversationStatus.Blocked],["Quarantined",o.InteropConversationStatus.Quarantined]]),ht=e=>e&&gt.get(e)||null,vt=new Map([["ChatEnabled",o.MeetingChatPolicy.ChatEnabled],["ChatDisabled",o.MeetingChatPolicy.ChatDisabled],["InMeeting",o.MeetingChatPolicy.InMeeting]]),ft=e=>!!e&&e===o.ChatType.PhoneChat,yt=e=>{if(!e)return!1;switch(typeof e){case"string":e="true"===e.toLowerCase();case"boolean":return e;default:return!1}},St=e=>(0,S.isString)(e)?"true"===e.toLowerCase():e||!1,kt=({id:e,conversationid:t,imdisplayname:n,from:i,composetime:a})=>e&&{"@type":W,mri:H(i),imdisplayname:n,messageId:e,parentMessageId:e,threadId:t,isUnresolvedEmailUser:!1,originalComposeTime:a},bt=(e,t,n)=>{const i=n.find((n=>{try{const i=JSON.parse((n.properties||{}).starred),a=i&&i["@type"]===W&&i.threadId===t?i.messageId:void 0;return e===a}catch(e){return!1}}));return i&&i.id},_t=(e,t)=>{if(!t)return;const n=JSON.parse(t);return Object.keys(t).length?Object.assign(Object.assign({id:e},n),{meetingType:n.meetingType?xe(u.wJ[n.meetingType]):o.MeetingType.Unknown}):void 0},Ct=e=>{if(e)try{const t=JSON.parse(e);return t.reduce(((e,t)=>(t.itemType===o.PinnedConversationItemType.Message&&e.push({__typename:"Message",id:t.itemId}),e)),[])}catch(e){return}},wt=e=>!(!e||!yt(e.uniquerosterthread)&&!yt(e.isStickyThread)),Tt=e=>e.filter((({id:e})=>x.e.isTFLOffNetworkUser(e))),Et=(e,t,n)=>{const i=K(n.properties);return!!i&&i.some((n=>n.key===e&&!!n.users&&n.users.some((e=>e.id===t))))},It=e=>{let t;switch(e){case p.iv.Error:t=o.MessageStatus.Error;break;case p.iv.Sending:t=o.MessageStatus.Sending;break;default:t=o.MessageStatus.Delivered}return t},Nt=e=>e&&e.historyHiddenTime||null,At=e=>{var t;return!!e&&!!e[d.Ff.Alerts]&&"true"!==(null===(t=e[d.Ff.Alerts])||void 0===t?void 0:t.trim().toLowerCase())},Mt=e=>e&&(e.isDisabled||e.messagingdisabled),Ft=({resourceType:e,resource:t},n,a,o,r,s)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){let l;try{switch(e){case"NewMessage":case"MessageUpdate":l=((e,t,n)=>{var i;if(e&&e.messagetype===d.pj.MemberConsumptionHorizonUpdate){const t=e.conversationid||(0,g.F)(e.conversationLink),n=JSON.parse(e.content);return{__typename:"ConsumptionHorizonUpdate",convId:t,memberConsumptionHorizon:{id:n.user,originalArrivalTime:n.consumptionhorizon,messageVisibilityTime:n.messageVisibilityTime}}}return e&&e.properties&&e.properties.activity?{__typename:"NotificationUpdate",convId:e.properties.activity.sourceThreadId||"",messageId:e.properties.activity.sourceMessageId||""}:"MessageUpdate"===n?Object.assign(Object.assign({__typename:n},_e(e,t)),{threadType:null===(i=e.properties)||void 0===i?void 0:i.threadType}):Object.assign({__typename:n},_e(e,t))})(t,a,e);break;case"ThreadUpdate":l=yield(({id:e="",properties:t,members:n},a,o,r,s)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const i=r||"",{members:l}=(0,c.iK)(n,t,[]),d=_t(e,null==t?void 0:t.meeting),u=l?yield a(l,e):[],m=u.find((({id:e})=>e===i))||null,p=qe(u,o),g=Tt(u);return{__typename:"ThreadUpdate",conversation:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({id:e,title:null==t?void 0:t.topic,isOneOnOne:wt(t),isUserMember:!!m,isDisabled:St(null==t?void 0:t.isDisabled),disabledReason:it(null==t?void 0:t.disabledReason),me:m,members:[],memberIds:l?l.map((({id:e})=>e)):[]},ye(u,i,s)),{hasFederatedUser:!!p.length,hasTflConsumerUser:Qe(u),hasTflSmsVerifiedUser:Ye(u),hasUnresolvedFederatedUser:p.some(x.e.isUnknownUser),tflOffNetworkUserLength:g.length,tflOffNetworkUser:(0,S.first)(g),hasBotMember:u.some((({id:e})=>(0,c.bl)(e)))}),Ve(p)),tt(i,u)),d?{meetingInformation:d}:{}),{chatType:t&&pt(t.threadType),pinnedConversationItems:Ct(null==t?void 0:t.pinnedItems),picture:null==t?void 0:t.picture}),members:{id:e,members:u}}})))(t,n,o,r,s);break;case"ConversationUpdate":l=((e,t)=>{const{properties:n,threadProperties:i,lastMessage:a}=e,o=(null==n?void 0:n.consumptionhorizon)||null,r=(null==n?void 0:n.userConsumptionHorizon)||(null==n?void 0:n.consumptionHorizonBookmark)||null,s=e.id||"",l=Re(s,r);return{__typename:"ConversationUpdate",conversation:{id:s,isUserMember:!1,isDisabled:St(Mt(i)),disabledReason:it(null==i?void 0:i.disabledReason),meetingChatPolicy:(c=null==i?void 0:i.meetingChatPolicy,c&&vt.get(c)||null),title:i&&i.topic,consumptionHorizon:Re(s,o),consumptionHorizonBookmark:l,userConsumptionHorizon:l,quickReplyAugmentation:je(s,n,t),chatType:i&&pt(i.threadType),chatSubType:i&&ut(i.threadType),lastMessage:ot(Se(a,t)),members:[],membersLimited:[],memberDisplayNamesLimited:[],interopConversationStatus:n&&ht(n.interopconversationstatus)||null,isRetentionHorizonSet:e.isRetentionHorizonSet,isMuted:At(n),chatHistoryHiddenTime:Nt(n),pinnedConversationItems:Ct(null==n?void 0:n.pinnedItems),picture:null==i?void 0:i.picture}};var c})(t,a);break;case"ResolveConversationLie":{const n=t;l={__typename:e,lieConvId:n.id,realConvId:n.realConvId};break}case"DiscardConversation":l={__typename:e,convId:t.id};break}}catch(e){a.newLogger("ChatHelpers").warn(`Error processing chat service event: ${e}`)}return l}));var Rt;!function(e){e.SfBGatewayChat="@sfb.unq.gbl.spaces",e.OnPremFederatedGatewayChat="@sfbonprem.unq.gbl.spaces",e.FederatedGatewayChat="@fed.unq.gbl.spaces"}(Rt||(Rt={}));const Pt=e=>Dt(e)||jt(e)||(0,m.Bl)(e),Dt=e=>!!e&&e.endsWith(Rt.SfBGatewayChat),jt=e=>!!e&&(e.includes(":fed:preview")||e.endsWith(Rt.FederatedGatewayChat)||e.endsWith(Rt.OnPremFederatedGatewayChat)),xt=(e,t)=>(0,S.filter)(e,(0,S.omit)(t,"__typename")),Ot=e=>!!e&&-1!==e.indexOf(z),Lt=e=>!!(null==e?void 0:e.startsWith("tfl:preview-")),Ut=e=>e===G,Bt=e=>Ut(e)||Ot(e),Wt=e=>!!(null==e?void 0:e.includes("TFL_Group")),Ht=e=>!!e&&-1!==e.indexOf(":tflfed:preview-"),$t=e=>!!e&&e.includes("meeting"),Vt=(e,t,n,i,o,r,s)=>{if(e)return n?a.Th.Meeting:i?o?a.Th.Botchat:ft(t)?a.Th.SMSOneOnOneChat:(0,m.Bl)(e)?a.Th.SfcInteropChat:Dt(e)?a.Th.SfbInteropChat:r?a.Th.NativeFederatedChat:s?a.Th.FederatedChat:a.Th.OneOnOneChat:a.Th.GroupChat},zt=(e,t)=>{if(!t||!t.notification)return null;try{const e=t.notification;return{alertInMeeting:e.alertInMeeting,externalResourceUrl:e.externalResourceUrl}}catch(t){return e.newLogger("Chat Helper").log(`UnhandledException in chat message notification transformation: ${t}`),null}},Gt=(e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const n=(0,S.flatMap)(e,(e=>(0,S.map)(e.members,(e=>e.id))));return qt(n,t)})),qt=(e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const n=yield(0,j.k)(e,t,"getHydratedMembersByMRI");return(0,S.keyBy)(n,"id")})),Jt=(e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var n;return Kt(e.id,(null===(n=e.members)||void 0===n?void 0:n.map((e=>e.id)))||[],t)})),Kt=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const i=yield n.getProfilesForConversation(t,e,void 0,"getHydratedUsersForConversationById"),a=Array.from(i.values(),(e=>(0,P.ne)(e))),o={};return a.forEach((e=>{o[e.id]=e})),o}));function Qt(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=[],i={};e.forEach((e=>{var t;null===(t=e.members)||void 0===t||t.forEach((t=>{const a=t.id;(0,c.yj)(a)||Je(a)?(i[e.id]||(i[e.id]=[]),i[e.id].push(a)):n.push(a)}))}));const a=yield qt(n,t),o={},r=[];for(const e of Object.keys(i))r.push(Kt(e,i[e],t).then((t=>o[e]=t)));return yield Promise.all(r),{smsIdToUserByChat:o,nonSmsIdToUser:a}}))}},367941:(e,t,n)=>{"use strict";n.d(t,{w:()=>o,K:()=>r});var i=n(927346);const a=e=>e.slice(e.includes("_")?41:8),o=(e,t)=>{const n=[a(e),a(t)].sort();return`19:${n[0]}_${n[1]}@unq.gbl.spaces`};function r(){const[e,t]=(0,i.M)(2);return`${e}${t}`.substr(0,19)}},771373:(e,t,n)=>{"use strict";n.d(t,{M:()=>r,k:()=>s});var i=n(231191),a=n(892891),o=n(942601);function r(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return l(e,t)}))}function s(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return l(e,t,n)}))}function l(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=(0,a.uniqBy)(e,(e=>e)),r=(0,a.chunk)(i.map((e=>e)),t.MAX_PEOPLE_MRI_LIMIT),s=yield Promise.all(r.map((e=>t.getPeopleProfilesByMris(e,n))));let l=[];return s.forEach((e=>{l=l.concat(Array.from(e.values(),(e=>(0,o.ne)(e))))})),l}))}},730397:(e,t,n)=>{"use strict";n.d(t,{B:()=>S});var i=n(416138),a=n(949318),o=n(231191),r=n(892891),s=n(939632);class l extends s.U{constructor(e,t){super({code:"UNKNOWN",message:e.message,prevError:e}),this.context=t}getExtensions(){return Object.assign(Object.assign({},super.getExtensions()),this.context)}}function c(e){const t={};for(const[i,a]of(0,r.entries)(e))if(n=a,(0,r.entries)(n).some((([e,t])=>d(t)&&!e.startsWith("__"))))for(const[e,n]of(0,r.entries)(a))t[i]||(t[i]={}),t[i][e]=d(n)?u(n,[i,e]):n;else t[i]=a;var n;return t}function d(e){return"function"==typeof e}function u(e,t){return(...n)=>(0,o.__awaiter)(this,void 0,void 0,(function*(){try{return yield e(...n)}catch(e){throw e instanceof s.U?e:new l(e,{resolverPath:t,resolverArgs:m(n)})}}))}function m(e){const[t,n]=e;return{rootValue:t,args:n}}var p=n(109458),g=n(406215),h=n(317540),v=n(101014),f=n(432327);function y(e){let t;const n=()=>t&&t.return&&t.return();return new a.y$((i=>{try{e().then((e=>{if(e.next instanceof Function){if(t=e,i.closed)return void n();!function(e,t){var n,i;(0,o.__awaiter)(this,void 0,void 0,(function*(){const a={[Symbol.asyncIterator]:()=>e};try{try{for(var r,s=(0,o.__asyncValues)(a);!(r=yield s.next()).done;){const e=r.value;t.next(e)}}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=s.return)&&(yield i.call(s))}finally{if(n)throw n.error}}t.complete()}catch(e){t.error(e)}}))}(e,i)}else i.next(e),i.complete()}),i.error.bind(i))}catch(e){i.error(e)}return n}))}function S(e,t){if(!e)return k();const n=(0,r.castArray)(e),i=(0,f.yM)(n.map((e=>e.resolvers)));return k({schema:(0,v.sJ)({resolvers:"function"!=typeof i&&(null==t?void 0:t.enableClassBasedErrors)?c(i):i,typeDefs:(0,f.c5)(n.map((e=>e.typeDefs))),directiveResolvers:(0,f.yM)(n.map((e=>e.directiveResolvers))),noExtensionExtraction:!0,updateResolversInPlace:!0,resolverValidationOptions:{requireResolversForResolveType:"ignore"}}),contextValue:n.reduceRight(((e,t)=>Object.assign(Object.assign({},e),t.contextValue)),{})})}function k(e){return new i.i0((t=>{const{query:n,variables:i}=t,{operation:o}=(0,p.S)(n,null),r=t.getContext(),{schema:s,contextValue:l}=null!=e?e:r.incremental,c=Object.assign(Object.assign({},l),r);return"subscription"===o?y((()=>(0,g.L)({schema:s,document:n,contextValue:c,variableValues:i}))):new a.y$((e=>{try{Promise.resolve((0,h.ht)({schema:s,document:n,variableValues:i,contextValue:c})).then((t=>{e.closed||(e.next(t),e.complete())}),(t=>{e.closed||e.error(t)}))}catch(t){e.closed||e.error(t)}}))}))}},141044:(e,t,n)=>{"use strict";n.d(t,{wU:()=>r,U1:()=>s,jY:()=>l,gy:()=>c});var i,a,o=n(635649);!function(e){e[e.Standard=0]="Standard",e[e.Important=2]="Important",e[e.Urgent=3]="Urgent"}(i||(i={})),function(e){e.Standard="",e.Important="high",e.Urgent="urgent"}(a||(a={}));const r=e=>c(e)===o.MessageImportance.Important,s=e=>i[e]||i.Standard,l=e=>a[e]||a.Standard,c=e=>{switch(e){case a.Important:case i.Important:return o.MessageImportance.Important;case a.Urgent:case i.Urgent:return o.MessageImportance.Urgent;case a.Standard:case i.Standard:default:return o.MessageImportance.Standard}}},942601:(e,t,n)=>{"use strict";n.d(t,{ne:()=>l,cx:()=>c,zP:()=>v});var i=n(189901),a=n(338870),o=n(823845),r=n(272009),s=n(892891);const l=(e,t)=>{const n=a.e.getRequestCount(e),{mri:i,objectId:o,displayName:r,givenName:s,surname:l,type:c,jobTitle:g,userPrincipalName:v,email:f,tenantId:y,sipProxyAddress:S,mobile:k,telephoneNumber:b,tenantName:_}=e,C={__typename:"User",id:i||o,objectId:o,mri:i,displayName:r,givenName:s,surname:l,type:c,jobTitle:g,userPrincipalName:v,email:f,tenantId:y||null,sipProxyAddress:S,mobile:k,telephoneNumber:b,requestCount:n,preferredUserName:t,tenantName:_};return function(e,t){const n=e.department;n&&(t.department=n)}(e,C),p(e,C),m(e,C),d(e,C),u(e,C),h(C),C},c=e=>{const{id:t,displayName:n,description:i,email:a,phone:o,mri:r,requestCount:s}=e;return{__typename:"User",id:t,mri:r,objectId:r,displayName:n,userPrincipalName:r,givenName:n,surname:n,description:i,email:a,mobile:o,telephoneNumber:o,requestCount:s}},d=(e,t)=>{if(function(e){const t=e;return void 0!==t.isFederated||void 0!==t.isAnonymousB2bUser}(e)){const{isFederated:n,fetchErrorCode:i,isAnonymousB2bUser:a}=e;t.isFederated=n,t.fetchErrorCode=i,t.isAnonymousB2bUser=a}else t.isFederated=null,t.fetchErrorCode=null,t.isAnonymousB2bUser=null},u=(e,t)=>{e.featureSettings&&(t.featureSettings=e.featureSettings),e.isBlocked&&(t.isBlocked=e.isBlocked),e.cid&&(t.cid=e.cid),e.isIbBarred&&(t.isInfoBarrierSet=e.isIbBarred),e.isAnonymousUser&&(t.isAnonymousUser=e.isAnonymousUser),e.phonesInfo&&(t.phonesInfo=(0,s.cloneDeep)(e.phonesInfo)),e.emailsInfo&&(t.emailsInfo=(0,s.cloneDeep)(e.emailsInfo)),e.xtapUser&&(t.xtapUser=e.xtapUser),e.companyName&&(t.companyName=e.companyName),e.tenantName&&(t.tenantName=e.tenantName),e.imageUri&&(t.imageUri=e.imageUri),e.selfAvatarLastupdatedTime&&(t.selfAvatarLastupdatedTime=e.selfAvatarLastupdatedTime),t.isShortProfile=e.isShortProfile},m=(e,t)=>{(function(e){return void 0!==e.userType}(e)||function(e){const t=e;return t.type?t.type===i.t.botType:(0,r.bl)(e.mri)}(e))&&(t.userType=e.userType,t.description=e.description,t.isUnified=e.isUnified,t.securityEnabled=e.securityEnabled,t.featureSettings=e.featureSettings,t.imageUri=e.imageUri,t.userLocation=e.userLocation)},p=(e,t)=>{const n=e.phones;n&&(t.phones=n.map((e=>g(e))))},g=e=>({number:e.number,type:e.type}),h=e=>{const{mri:t}=e;if((0,o.EG)(t)&&!e.displayName){const n=(0,o.Ol)(t);e.displayName=n,e.givenName=n}else if(t&&(0,r.MR)(t)&&!e.displayName){const n=(0,r.vq)(t);e.displayName=n,e.givenName=n}else e.displayName||(e.displayName="Unknown User");return e},v=e=>!!e&&!("string"!=typeof e||!a.e.isTFLSmsVerifiedMri(e))},548426:(e,t,n)=>{"use strict";n.r(t),n.d(t,{resolvers:()=>m,typeDefs:()=>y});var i=n(231191),a=n(695185),o=n(892753),r=n(497999),s=n(352367),l=n(635649),c=n(892891),d=n(498765);const u="user-experience-preferences-key",m={Query:{allClientPreferences:(e,t,{clientPreferences:n})=>h(n.getAllPreferences()),clientPreferences:(e,{category:t},{clientPreferences:n})=>g(n.getPreferences(t),t),userExperiencePreferences(e,t,{localStorage:n}){const i=n.get(u,s.fO.UserAndExperience);return i?v(JSON.parse(i)):{}}},Mutation:{updateClientPreferences:(e,{value:t},{clientPreferences:n})=>(n.updatePreferences(t),h(n.getAllPreferences())),updateUserExperiencePreferences(e,{value:t},{localStorage:n}){var i,a;const o=p(n),r=(0,c.merge)({},o,Object.assign(Object.assign({},t),{tflGroupTemplatesHidden:Object.assign(Object.assign({},t.tflGroupTemplatesHidden),{items:(0,c.unionBy)(null===(i=o.tflGroupTemplatesHidden)||void 0===i?void 0:i.items,null===(a=t.tflGroupTemplatesHidden)||void 0===a?void 0:a.items,"groupTemplate")})})),l=n.setSafe(u,(0,d.u4)(r),s.fO.UserAndExperience);return v(l?r:o)},clearUserExperiencePreferences:(e,t,{localStorage:n})=>n.remove(u,s.fO.UserAndExperience)},Subscription:{clientPreferencesChangedEvent:{subscribe(e,{category:t},{clientPreferences:n}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let e;const i=new a((i=>{const a=n.getPreferenceObservable(t);return e=a.subscribe(i),()=>null==e?void 0:e.unsubscribe()}));return(0,o.TL)((0,r.Z)(i),(e=>({clientPreferencesChangedEvent:g(e,t)})))}))}}},PerformanceMode:{normal:"normal",low:"low"},UserTheme:{light:"light",dark:"dark",contrast:"contrast"},ClientPreferenceCategoryTypes:{__resolveType:e=>e.hasOwnProperty("mode")?"PerformancePreferences":e.hasOwnProperty("disableAnimations")?"AnimationPreferences":e.hasOwnProperty("userTheme")||e.hasOwnProperty("followOsTheme")?"ThemePreferences":e.hasOwnProperty("lastUsedBackgroundImage")||e.hasOwnProperty("lastUsedVideoFilter")?"VideoEffectPreferences":null}},p=e=>{const t=e.get(u,s.fO.UserAndExperience);return t?JSON.parse(t):{}},g=(e,t)=>{let n;switch(t){case l.ClientPreferencesCategory.theme:n="theme-preferences-id";break;case l.ClientPreferencesCategory.animation:n="animation-preferences-id";break;case l.ClientPreferencesCategory.performance:n="perf-preferences-id";break;case l.ClientPreferencesCategory.videoEffect:n="videoeffect-preferences-id"}return Object.assign({id:n},e)},h=e=>({id:"client-preferences-id",theme:Object.assign({},g(e.theme,l.ClientPreferencesCategory.theme)),animation:Object.assign({},g(e.animation,l.ClientPreferencesCategory.animation)),performance:Object.assign({},g(e.performance,l.ClientPreferencesCategory.performance)),videoEffect:Object.assign({},g(e.videoEffect,l.ClientPreferencesCategory.videoEffect))}),v=e=>({id:"user-experience-preferences-id",tflGroupTemplatesHidden:f(e.tflGroupTemplatesHidden,l.UserExperiencePreferencesCategory.tflGroupTemplatesHidden)}),f=(e,t)=>{let n;switch(t){case l.UserExperiencePreferencesCategory.tflGroupTemplatesHidden:n="tfl-group-templates-hidden-id"}return Object.assign({id:n},e)};var y=n(56023)},442485:(e,t,n)=>{"use strict";n.d(t,{y:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"localizationSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"localizationSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"currentLocale"}}]}}]}}]}},514002:(e,t,n)=>{"use strict";n.d(t,{s:()=>a});var i=n(442485);const a={Query:{localizationSettings:(e,t,n)=>({currentLocale:n.platformService.config.localeCode})},Mutation:{updateCurrentLocale(e,{newLocale:t},{cache:n,platformService:a}){try{const e={localizationSettings:{__typename:"LocalizationSettings",currentLocale:t}};return a.config.localeCode=t,localStorage.setItem("localeCode",t),n.writeQuery({query:i.y,data:e}),t}catch(e){return null}}}}},164995:(e,t,n)=>{"use strict";var i,a,o,r,s,l=n(231191),c=n(843149),d=n(597816),u=n(727504),m=n(782801),p=n(15710),g=n(860467),h=n(954249),v=n(276053),f=n(21168),y=n(895725),S=n(352367),k=n(342790),b=n(682796);!function(e){e.ExpLoader="ExpLoader",e.CoreInit="CoreInit",e.CoreRender="CoreRender"}(i||(i={})),function(e){e.Cold="Cold",e.Warm="Warm",e.Rollback="Rollback",e.Update="Update",e.Local="Local",e.Container="Container",e.Unknown="Unknown"}(a||(a={})),function(e){e.SessionID="tmp.sessionId",e.DeviceID="tmp.deviceId"}(o||(o={})),function(e){e.IndexPageStart="execute-index-html-script",e.MainChunksLoadingStart="exp_loader_load_bundles_start",e.MainChunksLoadingStop="exp_loader_load_bundles_stop",e.IndexPageStop="exp_loader_index_stop"}(r||(r={})),function(e){e.ExpLoaderFailure="ExpLoaderFailure",e.LoadBundlesFailure="LoadBundlesFailure",e.ParseIndexPageFailure="ParseIndexPageFailure",e.CoreStartTimeout="CoreStartTimeout"}(s||(s={}));var _=n(911023);const C="core_life_cycle_start_",w="core_task_end_",T="core_init_complete";var E,I;!function(e){e.activity="activity",e.alarm="alarm",e.alert="alert",e.attention="attention",e.error="error"}(E||(E={})),function(e){e.DIAGNOSTICSSERVICE="DiagnosticsService"}(I||(I={}));var N=n(486410),A=n(980633);class M{constructor(e){this.maxQueueLength=e,this.diagnosticEvents=[],this.queueCapacity=this.maxQueueLength?this.maxQueueLength:M.QUEUE_CAPACITY}setQueueCapacity(e){e<1||this.queueCapacity===e||(this.queueCapacity=e,this.diagnosticEvents.length>e&&(this.diagnosticEvents=this.diagnosticEvents.slice(this.diagnosticEvents.length-e)))}getEvents(){return this.diagnosticEvents}enqueueEvent(e){this.diagnosticEvents.length<this.queueCapacity||this.dequeueEvent(),this.diagnosticEvents.push(e)}enqueueEvents(e){e&&e.length>0&&e.forEach((e=>{this.enqueueEvent(e)}))}flush(){this.diagnosticEvents=[]}dequeueEvent(){return this.diagnosticEvents.shift()}}M.QUEUE_CAPACITY=1e3;var F=n(708362),R=n(999108),P=n(498765);class D{constructor(e,t,n,i){this.opener=e,this.setTimeout=t,this.clearTimeout=n,this.diagnosticsEventsBuffer=[],this.flush=()=>{if(this.diagnosticsEventsBuffer.length>0)try{this.opener.postMessage(R.rY.ActivityEvent,{action:"er:rendererDiagnosticsEvents",data:[...this.diagnosticsEventsBuffer]})}catch(e){console.error("DiagnosticsBackupService failed to send a message")}this.reset()},this.backupTimeoutMs=i&&i>0?i:D.DefaultBackupTimeoutMs,this.reset()}pushDiagnosticsEvent(e){e&&(this.diagnosticsEventsBuffer.push(this.stringifyEvent(e)),this.diagnosticsEventsBuffer.length===D.BufferCapacity&&this.flush(),!this.backupTimer&&this.diagnosticsEventsBuffer.length>0&&this.startTimer())}dispose(){this.flush()}reset(){this.diagnosticsEventsBuffer.length=0,this.stopTimer()}stopTimer(){this.backupTimer&&(this.clearTimeout(this.backupTimer),this.backupTimer=void 0)}startTimer(){this.backupTimer=this.setTimeout(this.flush,this.backupTimeoutMs)}stringifyEvent(e){return(0,P.Uw)("{0} {1}\t{2}\r\n",[e.timeStamp,e.levelName.slice(0,3),e.message])}}D.BufferCapacity=50,D.DefaultBackupTimeoutMs=100;var j=n(892891);const x=e=>{if(!e||0===e.length)return"";let t="";return e.forEach((e=>{var n;if(!e)return;const i="function"==typeof(null===(n=e.timeStamp)||void 0===n?void 0:n.toISOString)?e.timeStamp.toISOString():e.timeStamp,a="string"==typeof e.levelName?e.levelName.substring(0,3):"unknownLevelName";t+=`${i} ${a}\t${e.message}\r\n`})),(0,P.LQ)(t)},O=(e,t,n)=>{if(!e)return;const i=x(t);e.setItem(n,i)},L=(e,t,n,i)=>{if(!t)return;const a=t.getItem(n);if(a){const t=JSON.parse(a);Array.isArray(t)&&t.length>0&&e.enqueueEvents(t)}i&&t.removeItem(n)},U=(e,t,n)=>{e&&e.setItem(t,(0,P.u4)(n))},B=(e,t)=>null==e?void 0:e.getItem(t);class W{constructor(e){this.diagnosticsInstances=new Map,this.diagnosticsBackupEnabled=!1,this.logsProviderName=I.DIAGNOSTICSSERVICE,this.isPrimaryLoggingService=!0,this.telemetryEvents=new Map,this.diagnosticsEvents=new M,this.isErrorDiagnosticsEnabled=!0,this.errorDiagnosticsEvents=new M,this.scriptStepWhiteList=new Set([A.ck.DownloadScripts,A.ck.DownloadMainJs]),this.eventWhiteList=new Set([A.RG.AppStart,A.RG.ChatSendMessage,A.RG.RenderChatList,A.RG.RenderShareForm,A.RG.SubmitShareForm]),this.environmentDependencies=e,this.storageKey="persistedDiagnostics",this.errorStorageKey="persistedErrorDiagnostics",this.previousSessionLogsStorageKey="tmp.previousSessionLogs",this.errorPreviousSessionLogsStorageKey="tmp.previousSessionErrorLogs",this.loadPersistedDiagnostics(!0),this.diagnosticsBackupService=void 0,e.addEventListener&&e.addEventListener("unload",(()=>{this.persistDiagnosticsAsPreviousSessionLogs()}))}subscribeToCoreSettings(e){if(!e)return void this.pushDiagnosticsEvent(S.in.Error,"[DiagnosticsService] Failed to subscribe to core settings");e.getObservable(b.J.Diagnostics).subscribe((e=>{const{enableDiagnosticsBackup:t,diagnosticsBackupSyncCycleMs:n,diagnosticsEventQueueMaxSize:i,errorDiagnosticsEventQueueMaxSize:a}=e;this.setDiagnosticsBackupEnabled(!!t,n||void 0),(0,j.isNumber)(i)&&this.diagnosticsEvents.setQueueCapacity(i),this.isErrorDiagnosticsEnabled=!!a,this.isErrorDiagnosticsEnabled?(0,j.isNumber)(a)&&this.errorDiagnosticsEvents.setQueueCapacity(a):this.errorDiagnosticsEvents=new M}))}pushTelemetryEvent(e,t){if(!this.eventWhiteList.has(t.name))return;const n=t&&t.step||"",i=t&&t.elapsed||0;if(this.scriptStepWhiteList.has(n)){const a=W.extractTimeValue(t.stepDelta);this.telemetryEvents.set(n,{delta:a,name:n,telemetryType:e,step:n,elapsed:i})}else{const a=W.extractTimeValue(t&&t.delta);this.telemetryEvents.set(t.name,{delta:a,name:t.name,step:n,telemetryType:e,elapsed:i})}}getTelemetryEvents(){return Array.from(this.telemetryEvents.values())}pushDiagnosticsEvent(e,t){const n=((e,t,n)=>{n.length>512&&(n=n.substring(0,512)+"...");const i={message:n=(0,P.LQ)(n),level:t,levelName:S.in[t],timeStamp:new Date};return e.enqueueEvent(i),i})(this.diagnosticsEvents,e,t);this.isErrorDiagnosticsEnabled&&e===S.in.Error&&this.errorDiagnosticsEvents.enqueueEvent(n),this.diagnosticsBackupEnabled&&this.diagnosticsBackupService&&this.diagnosticsBackupService.pushDiagnosticsEvent(n)}getDiagnosticsEvents(e){const t=e&&Math.floor(e/(1+this.diagnosticsInstances.size));let n=[];try{n=this.getDiagnosticsInstancesEvents(t)||[]}catch(e){this.pushDiagnosticsEvent(S.in.Error,`Failed to fetch logs from diagnostic instances: ${e}`)}let i=[];try{if(i=this.diagnosticsEvents.getEvents()||[],e){const t=e-n.length;t>0&&t<i.length&&(i=i.slice(i.length-t))}}catch(e){this.pushDiagnosticsEvent(S.in.Error,`Failed to fetch diagnostic logs: ${e}`)}i=i.reverse();return this.mergeSortedLogs(i,n)}flush(){this.diagnosticsEvents.flush(),this.errorDiagnosticsEvents.flush(),this.diagnosticsBackupEnabled&&this.diagnosticsBackupService&&this.diagnosticsBackupService.flush()}persistDiagnostics(e){this.pushDiagnosticsEvent(S.in.Warn,`Persisting diagnostic events for next load. Key: ${this.storageKey}`),this.diagnosticsBackupEnabled&&this.diagnosticsBackupService&&this.diagnosticsBackupService.flush(),U(this.environmentDependencies.localStorage,this.storageKey,this.getDiagnosticsEvents(e)),U(this.environmentDependencies.localStorage,this.errorStorageKey,this.errorDiagnosticsEvents.getEvents())}loadPersistedDiagnostics(e=!0){const{localStorage:t}=this.environmentDependencies;try{L(this.diagnosticsEvents,t,this.storageKey,e),L(this.errorDiagnosticsEvents,t,this.errorStorageKey,e)}catch(e){this.pushDiagnosticsEvent(S.in.Error,`Failed to load persisted logs from store with error: ${e}`),t.removeItem(this.storageKey)}}registerDiagnosticsInstance(e,t){this.diagnosticsInstances.set(e,t)}unregisterDiagnosticsInstance(e){this.diagnosticsInstances.delete(e)}getLogsFiles(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const e="No logs found",t="Logging of this type is not enabled";let n="",i="";if(this.isErrorDiagnosticsEnabled){i=B(this.environmentDependencies.localStorage,this.errorPreviousSessionLogsStorageKey)||e;const t=this.errorDiagnosticsEvents.getEvents()||[];t.reverse(),n=x(t)}else i=t,n=t;return Promise.resolve([{isPiiSafe:!1,fileName:"diagnostics-error-logs-previous-session.txt",content:i||e},{isPiiSafe:!1,fileName:"diagnostics-logs-previous-session.txt",content:B(this.environmentDependencies.localStorage,this.previousSessionLogsStorageKey)||e},{isPiiSafe:!1,fileName:"diagnostics-error-logs.txt",content:n||e},{isPiiSafe:!1,fileName:"diagnostics-logs.txt",content:this.getDiagnosticsLogs()||e}])}))}getSystemInfo(){return Promise.resolve(new Map)}formatEvents(e){return x(e)}setDiagnosticsBackupEnabled(e=!1,t){this.diagnosticsBackupEnabled=e,e?!this.diagnosticsBackupService&&this.environmentDependencies.opener&&this.environmentDependencies.setTimeout&&this.environmentDependencies.clearTimeout&&(this.diagnosticsBackupService=new D(this.environmentDependencies.opener,this.environmentDependencies.setTimeout,this.environmentDependencies.clearTimeout,t)):this.diagnosticsBackupService&&(this.diagnosticsBackupService.dispose(),this.diagnosticsBackupService=void 0)}getDiagnosticsInstancesEvents(e){const t=Array.from(this.diagnosticsInstances.keys());if(!t||t.length<1)return[];let n;return t.reduce(((t,i)=>{if(n=this.diagnosticsInstances.get(i),!n)return t;try{let i=n.getDiagnosticsEvents()||[];return i=(0,j.orderBy)(i,["timeStamp"],["desc"]),e&&e<i.length&&(i=i.slice(0,e)),this.mergeSortedLogs(t,i)}catch(e){return this.pushDiagnosticsEvent(S.in.Error,`Error in collecting diagnostics events from ${i}: ${e}`),t}}),[])}static extractTimeValue(e){return Math.round(parseFloat(e||"0"))}mergeSortedLogs(e,t){if(!(null==e?void 0:e.length))return(null==t?void 0:t.length)?t:[];if(!(null==t?void 0:t.length))return e;return[...e,...t].sort(((e,t)=>e.timeStamp>t.timeStamp?-1:e.timeStamp<t.timeStamp?1:0))}persistDiagnosticsAsPreviousSessionLogs(){const e=this.getDiagnosticsEvents();O(this.environmentDependencies.localStorage,e,this.previousSessionLogsStorageKey);const t=this.errorDiagnosticsEvents.getEvents();O(this.environmentDependencies.localStorage,t,this.errorPreviousSessionLogsStorageKey)}getDiagnosticsLogs(){const e=this.getDiagnosticsEvents();return x(e)}}const H=()=>{let e;try{e=(0,F.J)()}catch(t){e=function(){const e=new Map;return{getHostedWindowContext:()=>({panelContext:N.QP.worker,startReason:N.zF.userInitiated}),localStorage:{getItem:t=>{const n=e.get(t);return void 0===n?null:n},clear:()=>e.clear(),key:t=>Array.from(e.keys())[t],length:e.size,removeItem:t=>e.delete(t),setItem:(t,n)=>e.set(t,n)}}}()}return e};var $=n(971113),V=n(700608),z=n(672488),G=n(933922);class q{initialize(e){this.logger=e,this.logger.debug("Telemetry Utility-Service initialized")}static getInstance(){return this.instance}processUnhandledException(e,t){try{const n=[e.name||"",e.message||"",t||""],i=(0,P.Uw)("Unhandled exception. {0}: {1}, cause: {2}",n);(0,V.P3)($.x.Logging,`log_${S.in[S.in.Error]}`,this.captureStackTrace({message:i}))}catch(e){return!1}return!0}captureStackTrace(e){const t={stack:(new Error).stack,innerError:(e=e||{}).errors};return e.errors=`[{${JSON.stringify(t)}}]`,e}executeWithScenarioMarker(e,t){try{e(),t.stop()}catch(e){t.fail({reason:e})}}}function J(){return q.getInstance()}q.instance=new q;class K{constructor(e,t,n="",i=S.in.Warn){this.diagnosticsService=e,this.label=t,this.contextId=n,this.consoleLogLevel=i,this.enableDebugLogging=!1,this.cidLabel="";try{const e=(0,F.J)();this.enableDebugLogging="true"===e.localStorage.getItem("localDebug");const i=e.localStorage.getItem("logLevel");i&&(this.consoleLogLevel=(0,z.j)(parseInt(i,10),S.in.None,S.in.Max)),this.cidLabel=n?n.concat(" ",t):t}catch(e){}}log(e,...t){this.invoke(console.log,e,S.in.Info,...t)}warn(e,...t){this.invoke(console.warn,e,S.in.Warn,...t)}error(e,...t){this.invoke(console.error,e,S.in.Error,...t)}debug(e,...t){(this.enableDebugLogging||this.consoleLogLevel>=S.in.Debug)&&this.invoke(console.debug,e,S.in.Debug,...t)}errorToTelemetry(e,t,n,i){this.toTelemetry(console.error,e,t,S.in.Error,n,i)}warnToTelemetry(e,t,n,i){this.toTelemetry(console.warn,e,t,S.in.Warn,n,i)}debugToTelemetry(e,t,n,i){this.toTelemetry(console.debug,e,t,S.in.Debug,n,i)}infoToTelemetry(e,t,n,i){this.toTelemetry(console.log,e,t,S.in.Info,n,i)}toTelemetry(e,t,n,i,a,o){t=(0,P.LQ)(`${t}`),(null==a?void 0:a.message)&&(t=(0,P.LQ)(`${t} ${a.message}`)),e.call(console,t),o&&this.diagnosticsService.pushDiagnosticsEvent(i,t),t=(0,G.A)(t),(a=a||{}).message=t,a.logLevel=S.in[i],i===S.in.Error&&(a=J().captureStackTrace(Object.assign({contextId:this.contextId},a))),(0,V.MI)(this.label,a,n.toString(),void 0,void 0)}invoke(e,t,n,...i){if(t=(0,P.LQ)(`${this.cidLabel}: ${t}`),(n<=this.consoleLogLevel||this.enableDebugLogging)&&e.call(console,t,...i),n<S.in.Debug||n<=this.consoleLogLevel){if((null==i?void 0:i.length)>0){const e=i.map((e=>(0,P.XC)(e))).join(", ");t=(0,P.LQ)(`${t} ${e}`)}this.diagnosticsService.pushDiagnosticsEvent(n,t)}if(n===S.in.Error){const e=J().captureStackTrace({contextId:this.contextId,message:(0,G.A)(t)});(0,V.P3)($.x.Logging,this.label,e)}}}class Q{constructor(e,t,n=S.in.Warn){this.diagnosticsService=e,this.consoleLogLevel=n,this.newLogger=e=>new K(this.diagnosticsService,(0,P.LQ)(`${e}`),(0,P.LQ)(`${this._contextId}`),this.consoleLogLevel),this._contextId=t&&"00000000-0000-0000-0000-000000000000"!==t?(0,P.LQ)(`CID[${t}]`):""}}function Y(e,t,n,i,a){var o,r;let s;if(function(e,t,n){return!e.some((e=>{var i,a;const o=t.getEntriesByName(e);return null===(i=n.infoToTelemetry)||void 0===i||i.call(n,`Marker performance information ${e}!`,"telemetry_instrumentation_capture_perf_measurement",void 0,!1),o.length<=0&&(null===(a=n.errorToTelemetry)||void 0===a||a.call(n,`Measure ${e} was never created!`,"telemetry_instrumentation_capture_perf_measurement",void 0,!0),!0)}))}([t,n],i,a))try{i.measure(e,t,n);const a=i.getEntriesByName(e)[0];s=null==a?void 0:a.duration,s&&(s=Math.round(s)),i.clearMeasures(e)}catch(e){null===(o=a.errorToTelemetry)||void 0===o||o.call(a,`Failed to capture measurement between ${t} and ${n}: ${e}`,"telemetry_instrumentation_capture_perf_measurement",void 0,!0)}else null===(r=a.errorToTelemetry)||void 0===r||r.call(a,`Can not capture measurement between ${t} and ${n}, at least one of them not exist`,"telemetry_instrumentation_capture_perf_measurement",void 0,!0);return s}function X(e,t){const n=t.getEntriesByName(e);if(n&&n.length>0)return n[0]}var Z=n(775214),ee=n(670250),te=n(355304),ne=n(439146);const ie={[ne.p.breakoutrooms]:["com.microsoft.teams.calling","com.microsoft.teams.breakout-rooms"],[ne.p.meetings]:["com.microsoft.teams.calling","com.microsoft.teams.meeting-options"]};class ae{constructor(e,t){this._loadedTasksMap=new Map,this._logger=e.newLogger("AppsRegistryService"),this._loadedApps=[],this._entityTypeToAppMap=new Map,this.initialize(t)}get registeredApps(){return this._loadedApps}get registeredAppManifests(){return this._loadedApps.map((e=>e.manifest))}get registeredTasks(){return Array.from(this._loadedTasksMap.values())}get entityTypeToAppMap(){return this._entityTypeToAppMap}getApp({entityType:e,renderMode:t}){if(e||t)return this.registeredApps.find((n=>(!e||function({supportedEntities:e},t){return!(!e||-1===e.indexOf(t))}(n.manifest,e))&&(!t||function({supportedRenderModes:e},t){return!(!e||-1===e.indexOf(t))}(n.manifest,t))))}getDefaultCommand(){for(const e of this.registeredAppManifests)if(e.defaultCommand)return this._logger.debug(`Found a default command in ${e.name}`),e.defaultCommand}registerTask(e){this._loadedTasksMap.set(e.id,e)}initialize(e){const t=new Map;e&&e.length>0?e.forEach((e=>{var n;t.has(e.manifest.id)?this._logger.warn(`initialize::${S.jK.DuplicateFound} - appId=${e.manifest.id}!`):(t.set(e.manifest.id,e),null===(n=e.manifest.supportedEntities)||void 0===n||n.forEach((t=>{const n=ie[t];if(!n||!n.includes(e.manifest.id)){if(this._entityTypeToAppMap.has(t))throw new Error(`Multiple apps found for entity ${t}`);this._entityTypeToAppMap.set(t,e)}})),e.onRegister&&e.onRegister({registerTask:this.registerTask.bind(this)}))})):this._logger.warn(`initialize::${S.jK.Empty}`),this._loadedApps=Array.from(t.values())}}var oe=n(461430);class re extends oe.G{constructor({reason:e,taskName:t,prevError:n,dependencies:i}){super({code:"CORE_TASK",prevError:n}),this.taskName=t,this.reason=e,this.missingDependencies=i}static fromExecutionError(e,t){return new re({reason:"EXECUTION_FAILURE",taskName:e,prevError:t})}static fromMissingDependencies(e,t){return new re({reason:"MISSING_DEPENDENCIES",taskName:e,dependencies:t})}toLogEntry(){const e=Object.assign(Object.assign({},super.toLogEntry()),{reason:this.reason,taskName:this.taskName});switch(this.reason){case"MISSING_DEPENDENCIES":e.missingDependencies=this.missingDependencies;break;case"EXECUTION_FAILURE":e.prevError=this.prevError instanceof oe.G?this.prevError.toLogEntry():this.prevError}return e}}class se{constructor(e,t,n){this.id=e,this.name=t,this.dependencies=n}executeSafe(e,t){var n;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const i=null!==(n=this.dependencies)&&void 0!==n?n:[],a=[];for(const t of i)null==e[t]&&a.push(t);if(a.length>0)throw re.fromMissingDependencies(this.name,a);try{return yield this.execute(e,t)}catch(e){throw re.fromExecutionError(this.name,e)}}))}}var le=n(550635);class ce{constructor(e,t,n,i,a,o,r,s,l,c,d){this._loggerFactory=e,this._appsRegistryService=t,this._config=n,this._configLoader=i,this._coreTasks=o,this._diagnosticsService=r,this._logsCollectorService=s,this._waitForRenderingContextReady=l,this._isEntityInView=c,this._criticalDynamicImports=d,this._logger=e.newLogger("TaskManagerService"),this._appsRegistryService=t,this._taskContext=this.createNewContext(a)}notifyLifeCycleEvent(e,t={}){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const n=this.extractApplicableTasks(this._appsRegistryService.registeredTasks,e);this._logger.log(`notify::starting - lifeCycleEvent=${e}, taskCount=${n.length}`);const i=Object.assign(Object.assign({},this._taskContext),t);this.markCoreLifeCycleEventStart(i,e);const a={},o=new Map;for(const t of n){const n=e=>{this._logger.error(`notify:: Task Execute Error - taskId ${S.Yg[t.id]}, errorMsg=${(0,Z.B9)(e)}\n          .`),o.set(t.id,e)},r=()=>t instanceof se?t.executeSafe(i,a):t.execute(i,a),s=e=>e?(0,le.E)(r(),e,`${S.Yg[t.id]} timed out.`):r();yield s(this._config.coreTasksTimeoutMs).catch(n),this.markCoreLifeCycleTaskCompleted(i,e,t)}return this.handleErrors(e,o),this._logger.log(`notify::tasks complete - lifeCycleEvent=${e}, taskCount=${n.length}`),Object.assign(Object.assign(Object.assign({},a),i),{coreTaskErrors:Array.from(o.values())})}))}markCoreLifeCycleEventStart(e,t){var n,i;const a=null===(n=e.altScenarioService)||void 0===n?void 0:n.altScenario,o=`${C}${t}`;a?a.mark(o):null===(i=null===performance||void 0===performance?void 0:performance.mark)||void 0===i||i.call(performance,o)}markCoreLifeCycleTaskCompleted(e,t,n){var i,a;const o=null===(i=e.altScenarioService)||void 0===i?void 0:i.altScenario;o?o.mark(`core_task_${t}_${S.Yg[n.id]}`):null===(a=null===performance||void 0===performance?void 0:performance.mark)||void 0===a||a.call(performance,`${w}${t}_${S.Yg[n.id]}`)}createNewContext(e){return{correlation:e,diagnosticsService:this._diagnosticsService,logsCollectorService:this._logsCollectorService,loggerFactory:this._loggerFactory,appsRegistryService:this._appsRegistryService,config:this._config,configLoader:this._configLoader,waitForRenderingContextReady:this._waitForRenderingContextReady,isEntityInView:this._isEntityInView,criticalDynamicImports:this._criticalDynamicImports}}extractApplicableTasks(e,t){const n=[];if(e){const i=e.filter((e=>!e.lifeCycleSubscriptions&&t===S.sM.Initialization||e.lifeCycleSubscriptions&&-1!==e.lifeCycleSubscriptions.indexOf(t)));n.push(...i)}return this._coreTasks[t].concat(n)}handleErrors(e,t){if(t.size>0){const n=(0,Z.Tr)("TaskManagerService",S.jK.NotInitialized,`lifeCycleEvent=${e}`,{failedTaskErrors:t});this._logger.error(`Failed ${t.size} core tasks: ${Array.from(t.keys()).map((e=>S.Yg[e])).join()}, lifeCycleEvent=${e}: `,n)}}}const de={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"activeWindows"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindows"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"activeEntities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"subNavEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindows"}}]}},{kind:"Field",name:{kind:"Name",value:"headerEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindows"}}]}},{kind:"Field",name:{kind:"Name",value:"startEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindows"}}]}},{kind:"Field",name:{kind:"Name",value:"mainEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindows"}}]}},{kind:"Field",name:{kind:"Name",value:"endEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindows"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"correlation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"startTimestamp"}},{kind:"Field",name:{kind:"Name",value:"source"}},{kind:"Field",name:{kind:"Name",value:"clientLaunchId"}}]}},{kind:"Field",name:{kind:"Name",value:"extendedEntityContainerState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"containerState"}},{kind:"Field",name:{kind:"Name",value:"isExternal"}}]}},{kind:"Field",name:{kind:"Name",value:"layoutMode"}},{kind:"Field",name:{kind:"Name",value:"isMainWindow"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"entityFieldsForActiveWindows"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Entity"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"action"}},{kind:"Field",name:{kind:"Name",value:"options"}},{kind:"Field",name:{kind:"Name",value:"windowOptions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"windowOptionsFields"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"windowOptionsFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WindowOptions"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"left"}},{kind:"Field",name:{kind:"Name",value:"top"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}.definitions]},ue={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"authenticationUsersEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationUsersEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationUsers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isAuthenticated"}},{kind:"Field",name:{kind:"Name",value:"profile"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"puid"}}]}},{kind:"Field",name:{kind:"Name",value:"role"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"loginUserName"}}]}}]}}]}}]},me={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"authenticationUsers"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filter"}},type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUserFilter"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationUsers"},arguments:[{kind:"Argument",name:{kind:"Name",value:"filter"},value:{kind:"Variable",name:{kind:"Name",value:"filter"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isAuthenticated"}},{kind:"Field",name:{kind:"Name",value:"profile"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"puid"}}]}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"role"}},{kind:"Field",name:{kind:"Name",value:"loginUserName"}}]}}]}}]};var pe=n(95717),ge=n(722474),he=n(341939),ve=n(492661),fe=n(638739);class ye{constructor(e){this.commandHandler=e}showAccounts(){return this.commandHandler({entity:{type:ne.p.accounts,action:ne.u.list}})}}class Se{constructor(e){this.commandHandler=e}default(e){return this.commandHandler({entity:{type:ne.p.activity,action:ne.u.default},command:e})}}class ke{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}signinPage(e){return this.commandHandler({entity:{type:ne.p.identity,action:ne.u.default},command:e})}accountList(e){return this.commandHandler({entity:{type:ne.p.identity,action:ne.u.list},command:e})}signOutDialog(e){return this.extensionCommanding.executeCommand({type:ne.p.signoutdialog,action:ne.u.view},{entityCommand:e})}}var be=n(480177);class _e{constructor(e){this.commandHandler=e}navigateToFaceEnrollment(){return this.commandHandler({entity:{type:ne.p.faceenrollment,action:ne.u.view},command:{visibilityState:be.fe.show,stateTransition:be.su.flush,correlation:{startTimestamp:Date.now(),source:k.D.FaceEnrollmentGetStartedButton}}})}}class Ce{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}brbFeedbackDialogInMainWindow(e){return this.commandHandler({entity:{type:ne.p.brbfeedbackdialog,action:ne.u.view},command:e})}brbFeedbackDialog(e){return this.extensionCommanding.executeCommand({type:ne.p.brbfeedbackdialog,action:ne.u.view},{entityCommand:e})}}class we{constructor(e){this.commandHandler=e}default(e){return this.commandHandler({entity:{type:ne.p.breakoutrooms,action:ne.u.default},command:e})}breakoutRoomsById(e,t){return this.commandHandler({entity:{type:ne.p.breakoutrooms,action:ne.u.view,id:e},entityOptions:null==t?void 0:t.entityOptions,command:null==t?void 0:t.entityCommand})}}class Te{constructor(e){this.commandHandler=e}qnaPanelById(e,t){return this.commandHandler({entity:{type:ne.p.broadcastqna,action:ne.u.view,id:e,linkedEntity:{type:ne.p.calls,id:e}},command:t})}infoPanelById(e,t){return this.commandHandler({entity:{type:ne.p.broadcasts,action:ne.u.info,id:e,linkedEntity:{type:ne.p.calls,id:e}},command:t})}broadcastById(e,t,n){return this.commandHandler({entity:{type:ne.p.broadcasts,action:ne.u.view,id:e},command:t,entityOptions:n})}broadcastFeedbackById(e,t,n){return this.commandHandler({entity:{type:ne.p.broadcastfeedback,action:ne.u.view,id:e},command:t,entityOptions:n})}}class Ee{constructor(e,t){this.extensionCommanding=e,this.commandHandler=t}meetingDetails(e,t,n){return this.commandHandler({entity:{type:ne.p.schedulingform,action:ne.u.view,id:e},command:t,entityOptions:n})}openCalendarSurface(e,t,n){return this.commandHandler({entity:{type:ne.p.calendar,action:ne.u.view,id:e},command:t,entityOptions:n})}openSchedulingFormInMainWindow(e,t,n){return this.commandHandler({entity:{type:ne.p.schedulingform,action:ne.u.create,id:e},command:t,entityOptions:n})}openBroadcast(e,t,n,i){const a={type:ne.p.broadcastliveevent,id:e,action:t};return this.extensionCommanding.executeCommand(a,{entityCommand:{visibilityState:be.fe.show,stateTransition:be.su.none,correlation:{source:n}},entityOptions:i})}closeSchedulingForm(e,t,n){return this.commandHandler({entity:e,command:t,entityOptions:n})}openConnectedCalendarDialog(e){return this.extensionCommanding.executeCommand({type:ne.p.connectedcalendardialog,action:ne.u.view},{entityCommand:{visibilityState:be.fe.show,stateTransition:be.su.extend,correlation:{source:k.D.CalendarSettings}},entityOptions:e})}}var Ie=n(635649);class Ne{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}call(e,t){return this.commandHandler({entity:{type:ne.p.calls,action:ne.u.list,id:e},command:t})}callDebug(e){return this.commandHandler({entity:{type:ne.p.calls,action:ne.u.info},command:e})}dialPad(e){return this.commandHandler({entity:{type:ne.p.calls,action:ne.u.join},command:e})}callById(e,t,n,i,a){let o;return n&&(o={type:ne.p.chats,id:n}),a&&(o={type:ne.p.callingdeeplink,id:a}),this.commandHandler({entity:{type:i||ne.p.calls,action:ne.u.view,id:e,linkedEntity:o},command:t})}callStageContentById(e,t){return this.commandHandler({entity:{type:ne.p.stagecontent,action:ne.u.view},entityOptions:t,command:e})}callList(e){return this.commandHandler({entity:{type:ne.p.calls,action:ne.u.list},command:e})}deviceSettingsById(e,t){return this.commandHandler({entity:{type:ne.p.devicesettings,action:ne.u.view,linkedEntity:{type:ne.p.calls,id:e}},command:t})}callNotification(e,t,n,i){return i===Ie.CallingContentActionVisibility.Hide?this.commandHandler({entity:{id:t,action:ne.u.view,type:ne.p.toasts},command:{correlation:{id:n,source:k.D.Calling},stateTransition:be.su.new,visibilityState:be.fe.hide},entityOptions:e.entityOptions}):this.commandHandler({entity:{action:ne.u.view,type:ne.p.toasts,id:t},command:e.command,entityOptions:e.entityOptions})}cameraEffectsSettingsById(e,t){return this.commandHandler({entity:{type:ne.p.cameraeffects,action:ne.u.view,linkedEntity:{type:ne.p.calls,id:e}},entityOptions:{commandSource:null==t?void 0:t.correlation.source},command:t})}customVideoBackgroundSettingsById(e,t){return this.commandHandler({entity:{type:ne.p.videobackgrounds,action:ne.u.view,linkedEntity:{type:ne.p.calls,id:e}},command:t})}callRosterById(e,t){return this.commandHandler({entity:{type:ne.p.roster,action:ne.u.view,linkedEntity:{type:ne.p.calls,id:e}},command:t})}callDetailsById(e,t){return this.commandHandler({entity:{type:ne.p.meetingdetails,action:ne.u.view,linkedEntity:{type:ne.p.calls,id:e}},command:t})}callInfoById(e,t){return this.commandHandler({entity:{type:ne.p.calls,action:ne.u.info,linkedEntity:{type:ne.p.calls,id:e}},command:t})}callNotesById(e,t){return this.commandHandler({entity:{type:ne.p.notes,action:ne.u.view,linkedEntity:{type:ne.p.calls,id:e}},command:t})}transcriptPanelById(e,t){return this.commandHandler({entity:{type:ne.p.transcript,action:ne.u.view,linkedEntity:{type:ne.p.calls,id:e}},command:t})}callHealthPanelById(e,t){return this.commandHandler({entity:{type:ne.p.calls,action:ne.u.health,linkedEntity:{type:ne.p.calls,id:e}},command:t})}mediaStreamsPanelById(e,t){return this.commandHandler({entity:{type:ne.p.mediastreams,action:ne.u.view,linkedEntity:{type:ne.p.calls,id:e}},command:t})}callBreakoutRoomById(e,t){return this.commandHandler({entity:{type:ne.p.breakoutrooms,action:ne.u.view,linkedEntity:{type:ne.p.calls,id:e},id:e},command:t})}createById(e,t,n){return this.commandHandler({entity:{id:e,type:t,action:ne.u.create},command:n})}callMonitorById(e,t){return this.commandHandler({entity:{type:ne.p.callsmonitor,action:ne.u.view},entityOptions:{callingIntentId:e},command:t})}callShareMeetingInviteDialogById(e,t,n){return this.extensionCommanding.executeCommand(e,{entityOptions:t,entityCommand:{visibilityState:be.fe.show,stateTransition:be.su.extend,correlation:{source:n}}})}callsKeypad(e,t){return this.commandHandler({entity:{type:ne.p.callskeypad,action:ne.u.view,linkedEntity:{type:ne.p.calls,id:e}},command:t})}callMeetingOptionsById(e,t){return this.commandHandler({entity:{type:ne.p.meetings,action:ne.u.view,linkedEntity:{type:ne.p.calls,id:e}},command:t})}callsTransfer(e,t){return this.commandHandler({entity:{type:ne.p.callstransfer,action:ne.u.view,linkedEntity:{type:ne.p.calls,id:e}},command:t})}contentCameraSetupDialog(e,t,n){return this.extensionCommanding.executeCommand({id:e,type:ne.p.contentcamerasetup,action:ne.u.create},{entityOptions:t,entityCommand:{visibilityState:be.fe.show,stateTransition:be.su.none,correlation:{source:n}}})}startMeetingStream(e,t){return this.extensionCommanding.executeCommand({type:ne.p.meetingstream,action:ne.u.create},{entityCommand:{visibilityState:be.fe.show,stateTransition:be.su.none,correlation:{source:e}},entityOptions:t})}stagingRoomStartMeetingConfirmationDialog(e,t,n){return this.extensionCommanding.executeCommand({id:e,type:ne.p.stagingroomstartmeetingconfirmationdialog,action:ne.u.create},{entityCommand:{visibilityState:be.fe.show,stateTransition:be.su.extend,correlation:{source:t}},entityOptions:n})}openDialog(e,t,n){return this.extensionCommanding.executeCommand(e,{entityOptions:n,entityCommand:t})}}class Ae{constructor(e){this.commandHandler=e}default(e){return this.commandHandler({entity:{type:ne.p.channels,action:ne.u.default},command:e})}channelDeeplinkWithMessageId(e,t,n){return this.commandHandler({entity:{type:ne.p.channels,action:ne.u.view,id:e},command:t,entityOptions:n})}channelMessagesById(e,t,n,i){const a={channelId:e,replyChainId:t};return this.commandHandler({entity:{type:ne.p.channels,action:ne.u.view,id:JSON.stringify(a)},command:i,entityOptions:{deepLinkId:n}})}toggleChannelInfoPane(e,t){return this.commandHandler({entity:{type:ne.p.channels,action:ne.u.info,id:e},command:t})}}var Me=n(489321);class Fe{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}default(e){return this.commandHandler({entity:{type:ne.p.chats,action:ne.u.default},command:e})}chatList(e){return this.commandHandler({entity:{type:ne.p.chats,action:ne.u.list},command:e})}chatById(e,t){return this.commandHandler({entity:{type:ne.p.chats,action:ne.u.view,id:e},entityOptions:null==t?void 0:t.entityOptions,command:null==t?void 0:t.entityCommand,scenarioEventData:null==t?void 0:t.scenarioEventData})}chatWithUsers(e){const t=(0,Me.Mf)((null==e?void 0:e.userIds)||[],null==e?void 0:e.entityCommand);return this.commandHandler(Object.assign(Object.assign({},t),{entityOptions:null==e?void 0:e.entityOptions}))}chatWithGuardians(e,t,n,i,a){const o=(0,Me.Mf)(t||[],a),r={groupName:n,isGuardiansChat:!0,guardiansChatGroupId:e,guardiansChatStudentId:i};return this.commandHandler(Object.assign(Object.assign({},o),{entityOptions:r}))}orgChat(e,t){return this.commandHandler({entity:{type:ne.p.extensions,action:ne.u.view,id:be.oz.organization,linkedEntity:{type:ne.p.chats,id:(0,Me.f$)([e])}},command:t})}launchAltText(e,t){return this.extensionCommanding.executeCommand({type:ne.p.alttext,action:ne.u.view},{entityCommand:t,entityOptions:{element:e}})}launchInsertHyperlink(e,t,n){return this.extensionCommanding.executeCommand({type:ne.p.hyperlink,action:ne.u.view},{entityCommand:n,entityOptions:{displayText:e,address:t}})}launchDiscardCodeSnippet(e){return this.extensionCommanding.executeCommand({type:ne.p.codesnippet,action:ne.u.delete},{entityCommand:e})}launchTranslationFeedbackDialog(e,t){return this.extensionCommanding.executeCommand({type:ne.p.translationfeedback,action:ne.u.view},{entityCommand:t,entityOptions:e})}launchTwoWaySmsFriendlyNameDialog(e,t){return this.extensionCommanding.executeCommand({type:ne.p.twowaysmsfriendlyname,action:ne.u.view},{entityCommand:t,entityOptions:e})}launchDeleteChat(e,t){return this.extensionCommanding.executeCommand({type:ne.p.deletechat,action:ne.u.delete},{entityCommand:t,entityOptions:e})}launchDiscardFluid(e,t){return this.extensionCommanding.executeCommand({type:ne.p.fluid,action:ne.u.delete},{entityCommand:t,entityOptions:{isCompose:e}})}launchUpdatePermissionsFluid(e,t){return this.extensionCommanding.executeCommand({type:ne.p.fluid,action:ne.u.update},{entityCommand:t,entityOptions:{upns:e}})}launchUnpinMessageFromChat(e){return this.extensionCommanding.executeCommand({type:ne.p.pinnedconversationitems,action:ne.u.delete},{entityCommand:e})}launchReplaceMessageFromChat(e){return this.extensionCommanding.executeCommand({type:ne.p.pinnedconversationitems,action:ne.u.update},{entityCommand:e})}launchDiscardMessageDraft(e){return this.extensionCommanding.executeCommand({type:ne.p.messagedraft,action:ne.u.delete},{entityCommand:e})}launchGiphyConsent(e){return this.extensionCommanding.executeCommand({type:ne.p.giphyconsent,action:ne.u.view},{entityCommand:e})}launchLeaveChat(e){return this.extensionCommanding.executeCommand({type:ne.p.leavechat,action:ne.u.delete},{entityCommand:e})}launchMaxPinnedChatsReached(e,t){return this.extensionCommanding.executeCommand({type:ne.p.pinnedchatsmaxreached,action:ne.u.view},{entityCommand:t,entityOptions:{maxPinnedChats:e}})}launchUpdateGroupChatAvatar(e,t){return this.extensionCommanding.executeCommand({type:ne.p.updategroupchatavatar,action:ne.u.view},{entityCommand:t,entityOptions:{threadId:e}})}launchRemoveChatUser(e,t,n){return this.extensionCommanding.executeCommand({type:ne.p.removechatuser,action:ne.u.delete},{entityCommand:n,entityOptions:{userName:e,isRemoveTfwUserInTflChat:t}})}launchShareChatLink(e,t,n,i,a,o,r){return this.extensionCommanding.executeCommand({action:ne.u.view,id:e,type:ne.p.sharechatlink},{entityCommand:r,entityOptions:{chatTitle:t,hasError:n,sharedLink:i,cfet:a,panelType:o}})}launchChatError(e,t){return this.extensionCommanding.executeCommand({id:e,type:ne.p.chats,action:ne.u.error},{entityCommand:t})}launchStreamCamera(e){return this.extensionCommanding.executeCommand({type:ne.p.streamcamera,action:ne.u.default,id:null==e?void 0:e.correlation.id},{entityCommand:e})}transcriptTab(e,t,n,i){return this.commandHandler({entity:{type:ne.p.transcripttab,action:ne.u.view,id:t},entityOptions:{conversationId:e,storageId:n,teamsCallId:i}})}launchReportConcern(e,t){return this.extensionCommanding.executeCommand({type:ne.p.reportConcern,action:ne.u.create},{entityCommand:t,entityOptions:e})}launchReportConcernTY(e){return this.extensionCommanding.executeCommand({type:ne.p.reportConcern,action:ne.u.info},{entityCommand:e})}launchDlpDialog(e,t){return this.extensionCommanding.executeCommand({type:ne.p.dlp,action:ne.u.view},{entityCommand:t,entityOptions:e})}toggleChatInfoPane(e,t){return this.commandHandler({entity:{type:ne.p.chats,action:ne.u.info,id:e},command:t})}}class Re{constructor(e){this.commandHandler=e}coachReport(e,t){return this.commandHandler({entity:{type:ne.p.coachreport,action:ne.u.view},command:e,entityOptions:t})}}class Pe{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}openContactsSyncPopout(e){return this.commandHandler({entity:{type:ne.p.contactssync,action:ne.u.default,id:"default"},command:(null==e?void 0:e.entityCommand)||{stateTransition:be.su.new,visibilityState:be.fe.show,correlation:{source:k.D.Flyout}},windowOptions:null==e?void 0:e.windowOptions})}openContactsSyncModal(){return this.extensionCommanding.executeCommand({type:ne.p.contactssync,action:ne.u.view,id:"default"})}launchContactsModal(e,t){return this.extensionCommanding.executeCommand({type:ne.p.contactssync,action:ne.u.info,id:e},{entityCommand:{stateTransition:be.su.extend,visibilityState:be.fe.show,correlation:t}})}showHideContactsView(e,t,n){return this.commandHandler({entity:{type:ne.p.contactssync,action:ne.u.view,id:e},command:{stateTransition:be.su.flush,visibilityState:n?be.fe.show:be.fe.hide,correlation:t}})}}var De=n(448541);const je="DeepLink:: ";var xe,Oe;!function(e){e.DecodeURIComponentFailed="DecodeURIComponentFailed",e.ExecuteFromUrlFailed="ExecuteFromUrlFailed",e.IntentServiceExecutionFailed="IntentServiceExecutionFailed",e.InvalidDeepLinkUrl="InvalidDeepLinkUrl",e.OnBeforeDeeplinkParsedFailed="OnBeforeDeeplinkParsedFailed",e.ToNavigationIntentFailed="ToNavigationIntentFailed"}(xe||(xe={})),function(e){e.NavigationIntentNotFound="NavigationIntentNotFound"}(Oe||(Oe={}));var Le=n(121327),Ue=n(91087),Be=n(324819);const We=e=>!(!e||!e.startsWith(He)),He="https://teams.microsoft.com/l",$e="/task/",Ve="application/vnd.microsoft.card.adaptive",ze=(e,t,n)=>{const i={};return e&&(i["App.Id"]=e),t&&(i["App.EntryPoint"]=Le.gV[t]),n&&(i.errors=n),i},Ge=(e,t)=>{if(!t)throw new Error("Could not find app context");switch(e.type){case ne.p.extensions:return Object.assign(Object.assign({},t),{type:Ue.p.tab});case ne.p.channels:return Object.assign(Object.assign({},t),{type:Ue.p.channel});case ne.p.chats:return Object.assign(Object.assign({},t),{type:Ue.p.chat});default:throw new Error("unsupported launch context")}},qe=e=>e?JSON.parse(e):{},Je=e=>{switch(e&&e.type){case ne.p.extensions:return Ke(e);case ne.p.chats:return{chatId:e.id||""};case ne.p.channels:{const{channelId:t,replyChainId:n}=qe(e.id);return{chatId:t,parentMessageId:n}}default:return}},Ke=e=>{if(e.linkedEntity)switch(e.linkedEntity.type){case ne.p.chats:return{chatId:e.linkedEntity.id};case ne.p.channels:{const{channelId:t,replyChainId:n}=qe(e.linkedEntity.id);return{chatId:t,parentMessageId:n}}case ne.p.extensions:return e.linkedEntity.id?JSON.parse(e.linkedEntity.id):void 0}},Qe=e=>{const t=e.search.indexOf("?")+1;return(e.search.substring(t)||"").split("&").reduce(((e,t)=>{const[n,i]=t.split("="),a=decodeURIComponent(i);return Object.assign(Object.assign({},e),{[n]:(0,j.isString)(n)&&"card"===n.toLowerCase()?Ye(a):a})}),{})},Ye=e=>{try{const t=JSON.parse(e),n=(0,j.isString)(t.contentType)&&t.contentType.toLowerCase()===Ve.toLowerCase(),i=(0,j.isString)(t.type)&&"adaptivecard"===t.type.toLowerCase();return n?{content:JSON.stringify(t.content),contentType:t.contentType}:i?{content:e,contentType:Ve}:null}catch(e){return null}};class Xe{constructor(e,t,n,i,a,o,r,s){this.host=e,this.commandHandler=t,this.extensionCommandingService=n,this.scenarioFactory=i,this.deeplinkService=o,this.coreSettings=r,this.clientLaunchId=s,this.logger=a.newLogger("DeepLinkCommandingService")}checkForPendingDeeplink(e){return this.deeplinkService.checkForPendingIntent(e,this.clientLaunchId)}launchMainApp(e){return this.deeplinkService.launchMainApp(e,this.clientLaunchId)}executeFromUrlV2(e){var t;return(0,l.__awaiter)(this,void 0,void 0,(function*(){if(!!!(null===(t=this.coreSettings.get(b.J.Core))||void 0===t?void 0:t.handleInternalDeepLinks))return!1;try{return yield this.deeplinkService.executeFromUrlAsync(e,this.clientLaunchId)}catch(e){const t=`DeepLinkCommanding:: ${xe.ExecuteFromUrlFailed} ${(0,P.u4)(e)}`;throw this.logger.error(t),new Error(t)}}))}executeDeepLinkFromUrl(e,t,n,i){var a;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const n=!!(null===(a=this.coreSettings.get(b.J.Core))||void 0===a?void 0:a.handleInternalDeepLinks);try{if(yield this.executeFromUrlV2(e))return}catch(e){this.logger.error(e.message)}const o=this.createEntityCommandFromDeepLink(e,t);if(o){if(o.entity.type===ne.p.taskmodule){const t=new URL(e),[,,,n]=t.pathname.split("/");return((e,t,n,i,a,o)=>{const r=e.executeCommand(t.entity,{entityCommand:t.command,entityOptions:t.entityOptions}),s=n.newScenario(A.RG.ExtTaskModuleLaunch),l=Le.gV.DeepLink;return r.subscribe({complete:()=>{i.log(`task module complete for entrypoint ${l}`),s.stop(ze(a,l)),o&&o()},error:e=>{i.error(`error launching task module for entry point ${l}.  Error:`,e),s.fail(ze(a,l,e)),o&&o(e)},next:e=>{e.containerState===be.oq.Open&&s.stop(ze(a,l))}}),Promise.resolve()})(this.extensionCommandingService,o,this.scenarioFactory,this.logger,n,i)}return this.commandHandler(o)}if(!n)return this.host.opener.open(De.B.OpenOnMainRenderer,De._.DeepLink,{url:e});this.host.open(e)}))}createEntityCommandFromDeepLink(e,t){return(e=>{const t=new URL(e).pathname.split("/");if(4===t.length){const[,,e,n]=t;return!(!e||!n)}return!1})(e)&&(e=>{if(We(e))return"/task/"===e.substr(He.length).toLowerCase().substring(0,$e.length);return!1})(e)?((e,t)=>{const n=(0,Be.v4)(),i=new URL(e),[,,,a]=i.pathname.split("/"),o={entryPoint:Le.gV.DeepLink,appId:a,taskInfo:Qe(new URL(e))};return{entity:{id:n,type:ne.p.taskmodule,action:ne.u.create},command:{stateTransition:be.su.extend,visibilityState:be.fe.show,correlation:{source:k.D.ExtensionCommanding}},entityOptions:{input:o,launchContext:Ge(t,Je(t))}}})(e,t):null}}class Ze{constructor(e){this.commandHandler=e}launchErrorApp(e){return this.commandHandler({entity:{type:ne.p.error,action:ne.u.view},command:{stateTransition:be.su.forceFlush,visibilityState:be.fe.show,correlation:{source:k.D.LayoutError}},entityOptions:{errorReason:e.reason}})}}class et{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}displaySurface(e){return this.commandHandler({entity:{type:ne.p.esp,action:ne.u.create,id:e}})}launchDialog(e){return this.extensionCommanding.executeCommand({id:e,type:ne.p.esp,action:ne.u.view})}navigate(e,t,n){return this.commandHandler({entity:e,command:t,entityOptions:n})}}var tt=n(520410),nt=n(516175),it=n(632585),at=n(384986);const ot={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"activeWindowExtendedEntityContainerState"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindow"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"extendedEntityContainerState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"containerState"}},{kind:"Field",name:{kind:"Name",value:"isExternal"}}]}}]}}]}}]},rt={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"activeWindowBlockingExtension"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindow"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"blockingEntityExtension"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"entity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"action"}},{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]}}]}}]},st={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"addBlockingExtension"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entity"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EntityInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entityOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"removeBlock"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"addBlockingExtension"},arguments:[{kind:"Argument",name:{kind:"Name",value:"entity"},value:{kind:"Variable",name:{kind:"Name",value:"entity"}}},{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"entityOptions"},value:{kind:"Variable",name:{kind:"Name",value:"entityOptions"}}},{kind:"Argument",name:{kind:"Name",value:"removeBlock"},value:{kind:"Variable",name:{kind:"Name",value:"removeBlock"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]};class lt{constructor(e,t,n,i,a){this.commandHandler=e,this.client=t,this.windowId=n,this.scenarioFactory=i,this.onDestroy=new it.xQ,this.requestInFlight=!1,this.logger=a.newLogger("ExtensionCommandingService")}destroy(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){try{this.onDestroy.next(),this.reset()}catch(e){this.logger.warn(`Unable to destroy, error ocurred in persisting delete of extension entity. e.name: ${e.name}, e.message: ${e.message}`)}}))}executeCommand(e,t){const n=(null==t?void 0:t.entityCommand)||{stateTransition:be.su.none,visibilityState:be.fe.show,correlation:{source:k.D.ExtensionCommanding}};n.stateTransition=be.su.extend;const i={entity:e,command:n,entityOptions:null==t?void 0:t.entityOptions};return this.processRequest(i)}addBlockingExtension(e,t,n=!1){return(0,l.__awaiter)(this,void 0,void 0,(function*(){if(!n&&(yield this.isWindowBlocked()))return void this.logger.log("Window is currently blocked, addBlockingExtension no-op");this.logger.log(`addBlockingExtension, requesting an extension of type ${e.type} to block the window`);const i={entity:e,entityOptions:JSON.stringify(t),windowId:this.windowId,removeBlock:n};yield this.client.mutate({mutation:st,variables:i})}))}isWindowBlocked(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{data:e}=yield this.client.query({query:rt,variables:{windowId:this.windowId}});return!!e.activeWindow.blockingEntityExtension}))}pipeWhileStateIsValid(e){return e.pipe((0,pe.R)(this.onDestroy),(0,tt.G)(),(0,nt.o)((([e,t])=>{const n=t.containerState,i=e.containerState,a=n===be.oq.Confirmed,o=n===be.oq.Error,r=n===be.oq.Closed,s=i===be.oq.Open;return!a&&!o&&!(s&&r)}),!0),(0,y.U)((([,e])=>e)))}processRequest(e){if(this.requestInFlight)throw(0,Z.Tr)("ExtensionCommanding",S.jK.AlreadyInProgress,"",void 0,"Extension already rendered, only one extension command request can be processed at a time.");this.requestInFlight=!0,this.scenarioFactory.newScenario(A.RG.ExtensionOpen);const t=this.observeContainerState(this.client,this.windowId),n=this.pipeWhileStateIsValid(t);this.commandHandler(e).then((()=>{n.subscribe({next:e=>{this.stopActiveScenario(e.containerState),this.nextSubscriber(e),e.containerState===be.oq.Error&&this.resetSubscriber((0,Z.Tr)("ExtensionCommanding",S.jK.Unknown,`ExtendedContainerState ${e.containerState}`,void 0,"Error processing entity extension"))},complete:()=>{this.resetSubscriber()},error:e=>{this.resetSubscriber(e)}})})).catch((e=>{this.resetSubscriber(e)}));return new at.y((e=>{this.subscriber=e}))}nextSubscriber(e){this.subscriber&&this.subscriber.next(e)}resetSubscriber(e){const t=this.subscriber;this.reset(),e?(this.failActiveScenarios(),t&&t.error(e)):(this.stopActiveScenarios(),t&&t.complete())}reset(){this.requestInFlight=!1,this.subscriber=void 0}stopActiveScenarios(){var e,t;null===(e=this.scenarioFactory.findScenario(A.RG.ExtensionClose))||void 0===e||e.stop(),null===(t=this.scenarioFactory.findScenario(A.RG.ExtensionOpen))||void 0===t||t.stop()}failActiveScenarios(){var e,t;null===(e=this.scenarioFactory.findScenario(A.RG.ExtensionClose))||void 0===e||e.fail(),null===(t=this.scenarioFactory.findScenario(A.RG.ExtensionOpen))||void 0===t||t.fail()}stopActiveScenario(e){switch(e){case be.oq.Error:this.failActiveScenarios();break;case be.oq.Open:case be.oq.Closed:case be.oq.Confirmed:this.stopActiveScenarios();break;default:this.logger.error(`Unable to stop active scenario, no case mapped to container state provided: ${e}`)}}observeContainerState(e,t){return(0,te.G)(this.watchActiveWindow(e,t)).pipe((0,y.U)((({data:e})=>({containerState:e.activeWindow.extendedEntityContainerState.containerState}))))}watchActiveWindow(e,t){return e.watchQuery({query:ot,variables:{windowId:t}})}}class ct{constructor(e){this.commandHandler=e}surveyDialog(e,t){return this.commandHandler({entity:{type:ne.p.survey,action:ne.u.view,id:e},command:t})}}class dt{constructor(e,t){this.extensionCommanding=e,this.commandHandler=t}galleryImage(e,t){const n=e.galleryId,i={type:ne.p.galleryImages,action:ne.u.view,id:n};return this.commandHandler({entity:i,command:t,entityOptions:e})}galleryImageExtended(e,t){const n=e.galleryId,i={type:ne.p.galleryImages,action:ne.u.view,id:n};return this.extensionCommanding.executeCommand(i,{entityCommand:t,entityOptions:e})}fileById(e){const t=e.fileId;return this.commandHandler({entity:{type:ne.p.file,action:ne.u.view,id:t},entityOptions:e})}fileOpenSettingsSuggestion(e){return this.commandHandler({entity:{type:ne.p.fileopensettings,action:ne.u.info},entityOptions:e})}fileOpenSettingsUpdate(e){return this.commandHandler({entity:{type:ne.p.fileopensettings,action:ne.u.update},entityOptions:e})}chatFilesList(e,t){return this.commandHandler({entity:{id:null,type:ne.p.file,action:ne.u.list,linkedEntity:{type:ne.p.chats,id:e}},command:t})}photosList(e,t){return this.commandHandler({entity:{id:null,type:ne.p.gallery,action:ne.u.view,linkedEntity:{type:ne.p.chats,id:e}},command:t})}}const ut={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"executeEntityCommand"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entity"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EntityInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"executionContext"}},type:{kind:"NamedType",name:{kind:"Name",value:"ExecutionContextInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"command"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EntityCommandInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"clientLaunchId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entityOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"WindowOptionsInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"executeEntityCommand"},arguments:[{kind:"Argument",name:{kind:"Name",value:"entity"},value:{kind:"Variable",name:{kind:"Name",value:"entity"}}},{kind:"Argument",name:{kind:"Name",value:"executionContext"},value:{kind:"Variable",name:{kind:"Name",value:"executionContext"}}},{kind:"Argument",name:{kind:"Name",value:"command"},value:{kind:"Variable",name:{kind:"Name",value:"command"}}},{kind:"Argument",name:{kind:"Name",value:"clientLaunchId"},value:{kind:"Variable",name:{kind:"Name",value:"clientLaunchId"}}},{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"entityOptions"},value:{kind:"Variable",name:{kind:"Name",value:"entityOptions"}}},{kind:"Argument",name:{kind:"Name",value:"windowOptions"},value:{kind:"Variable",name:{kind:"Name",value:"windowOptions"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]};function mt(e){const t=e||{source:k.D.StandAlone};return Object.assign(Object.assign({},t),{id:pt(t),startTimestamp:gt(t)})}function pt(e){return e&&e.id||(0,Be.v4)()}function gt(e){return e&&e.startTimestamp||Date.now()}function ht({appName:e,entityCommand:t,getCommandScenarioName:n,logger:i}){const a=t.command.correlation,o=void 0===a.scenarioName||a.scenarioName===A.RG.EntityCommand;n&&o&&(a.scenarioName=n(t),i.log(`App ${e} is overwriting default scenario name to ${a.scenarioName} for command with entityType ${t.entity.type}`))}function vt(e){return Object.assign(Object.assign({},e),{command:ft(e.command)})}function ft(e){return Object.assign(Object.assign({},e),{correlation:mt(e.correlation)})}const yt=({appsRegistryService:e,client:t,commandReportingService:n,coreSettings:i,entityCommandInput:a,executionContext:o,loggerFactory:r,platformService:s,scenarioFactory:c,windowId:d,clientLaunchId:u})=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){var m,p;const g=r.newLogger("internalCommandHandler"),h=null!==(p=null===(m=a.command)||void 0===m?void 0:m.__UNSAFE_windowId)&&void 0!==p?p:d;h!==d&&g.log(`window id overridden to ${h}`);let v=vt(function(e){const t=e.command||ft({stateTransition:be.su.none,visibilityState:be.fe.show,correlation:{source:k.D.Unknown}});return Object.assign(Object.assign({},e),{command:t})}(a));const f=function(e,t){return t&&e.getApp({entityType:t.viewEntity.type})}(e,o),y=function(e,t){return e.getApp({entityType:t.entity.type})}(e,v);!function({entityCommand:e,logger:t,sourceApp:n,renderingApp:i}){e.entity.type===ne.p.default&&(e.command.correlation.scenarioName=A.RG.DefaultCommand),n&&ht({appName:n.manifest.name,entityCommand:e,getCommandScenarioName:n.getCommandScenarioNameFromSource,logger:t}),i&&ht({appName:i.manifest.name,entityCommand:e,getCommandScenarioName:i.getCommandScenarioName,logger:t})}({entityCommand:v,renderingApp:y,sourceApp:f,logger:g});const S=v.command.correlation.id;if(function({commandReportingService:e,entityCommand:t}){const n=t.command.correlation.id,{scenarioEventData:i}=t;e.registerCommandStart(t),i&&e.appendScenarioEventData(n,i),e.reportCommandEvent(n,ve.M.CommandReceived)}({commandReportingService:n,entityCommand:v}),y){const e=function(e,t,n,i,a){return{client:e,coreSettings:t,loggerFactory:n,platformService:i,scenarioFactory:a}}(t,i,r,s,c);v=yield function({app:e,commandReportingService:t,entityCommand:n,hookRequestContext:i,logger:a}){return(0,l.__awaiter)(this,void 0,void 0,(function*(){let o=n;if(e.onBeforeCommandHandled){const r=n.command.correlation,s=r.id;t.reportCommandEvent(s,ve.M.ApplicationHookReceivedCommand);try{const t={entityCommand:n,requestContext:i};o=yield e.onBeforeCommandHandled(t)}catch(n){const i=`Command 'onBeforeCommandHandled' rejected. An attempt to handle the command was made by app:${e.manifest.name}, but failed.`;return a.error(i),t.reportCommandEvent(s,ve.M.Failure,{errorInfo:ve.y.OnBeforeCommandHandledRejected}),Promise.reject(n)}void 0!==o&&(t.reportCommandEvent(s,ve.M.ApplicationHookContinuedCommand),o.command.correlation=r,t.registerCommandStart(o))}return Promise.resolve(o)}))}({app:y,commandReportingService:n,entityCommand:v,hookRequestContext:e,logger:g})}return v?function({entityCommand:e,mutateContext:{client:t,executionContext:n,windowId:i,clientLaunchId:a}}){return t.mutate({mutation:ut,variables:Object.assign(Object.assign({},e),{entityOptions:JSON.stringify(e.entityOptions),executionContext:n,windowId:i,clientLaunchId:a}),fetchPolicy:"no-cache"}).then((e=>{var t,n;return null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.executeEntityCommand)||void 0===n?void 0:n.id}))}({entityCommand:v,mutateContext:{client:t,executionContext:o,windowId:h,clientLaunchId:u}}):(n.reportCommandEvent(S,ve.M.CommandHandledPriorToResolution),Promise.resolve(void 0))}));class St{constructor(e){this.commandHandler=e}analytics(e,t){return this.commandHandler({entity:{type:ne.p.meetinganalytics,action:ne.u.view},command:e,entityOptions:t})}}class kt{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}meetingOptionsFormView(e,t,n,i,a,o){return this.commandHandler({entity:{type:ne.p.meetings,action:ne.u.view,id:this.serializeMeetingCoordinates(e,t,n,i,a)},command:o})}meetingOptionsCreateViewDialog(e,t,n){const i={type:ne.p.meetingoptionscreatedialog,id:e.id,action:e.action};return this.extensionCommanding.executeCommand(i,{entityCommand:t,entityOptions:n})}serializeMeetingCoordinates(e,t,n,i,a){return JSON.stringify({tenantId:e,organizerId:t,threadId:n,messageId:i,additionalMessageId:a})}}var bt=n(232712);class _t{constructor(e){this.commandHandler=e}trigger(e){return this.commandHandler({entity:wt(e.entity),command:Nt(e.command)})}}const Ct=e=>{switch(e){case bt.uk.view:return ne.u.view;case bt.uk.list:return ne.u.list;case bt.uk.default:return ne.u.default;default:throw(0,Z.Tr)(S.w5.Commanding,S.jK.NotImplemented,"Nova",void 0,`Mapping for Nova action type ${e} not implemented in Teams!`)}},wt=e=>{switch(e.type){case bt.py.identity:return Tt(e);case bt.py.teams_chat:return{type:ne.p.chats,id:e.id,action:Ct(e.action)};case bt.py.teams_channel:return{type:ne.p.channels,id:e.id,action:Ct(e.action)};case bt.py.teams_activity:return{type:ne.p.activity,id:e.id,action:Ct(e.action)};case bt.py.teams_calendar:return{type:ne.p.calendar,id:e.id,action:Ct(e.action)};case bt.py.m365_app:return{type:ne.p.extensions,id:e.id,action:Ct(e.action)};default:throw(0,Z.Tr)(S.w5.Commanding,S.jK.NotImplemented,"Nova",void 0,`Mapping for Nova entity type ${e.type} not implemented in Teams!`)}},Tt=e=>{switch(e.action){case bt.uk.signout:return{type:ne.p.signoutdialog,id:e.id,action:ne.u.view};case bt.uk.updateProfilePicture:return{type:ne.p.updatemsaprofileavatardialog,id:e.id,action:ne.u.view};case bt.uk.updateDisplayName:return{type:ne.p.updatemsaprofilenamedialog,id:e.id,action:ne.u.view};default:throw(0,Z.Tr)(S.w5.Commanding,S.jK.NotImplemented,"Nova",void 0,`Mapping for Nova identity entity with action type ${e.action} not implemented in Teams!`)}},Et=e=>{switch(e){case bt.fe.hide:return be.fe.hide;case bt.fe.show:return be.fe.show;case bt.fe.toggle:return be.fe.toggle}},It=e=>{switch(e){case bt.su.extend:return be.su.extend;case bt.su.flush:return be.su.flush;case bt.su.forceFlush:return be.su.forceFlush;case bt.su.new:return be.su.new;case bt.su.none:return be.su.none}},Nt=e=>({visibilityState:Et(e.visibilityState),stateTransition:It(e.stateTransition),correlation:{source:k.D.Nova}});class At{constructor(e,t,n){this.commandHandler=e,this.extensionCommanding=t,this.coreSettings=n}launchTaskModule(e,t){const n=(null==t?void 0:t.entityCommand)||this.getDefaultCommand();return n.visibilityState=be.fe.show,this.extensionCommanding.executeCommand({id:e,type:ne.p.taskmodule,action:ne.u.create},{entityCommand:n,entityOptions:null==t?void 0:t.taskModuleOptions})}launchStage(e){const t=(null==e?void 0:e.entityCommand)||this.getDefaultCommand();return t.visibilityState=be.fe.show,this.extensionCommanding.executeCommand({type:ne.p.platformStage,action:ne.u.view},{entityCommand:t,entityOptions:null==e?void 0:e.stageOptions})}launchAppInstall(e,t){const n=(null==t?void 0:t.entityCommand)||this.getDefaultCommand();return n.visibilityState=be.fe.show,this.extensionCommanding.executeCommand({id:e,type:ne.p.platformapp,action:ne.u.create},{entityCommand:n,entityOptions:null==t?void 0:t.platformAppDetailsOptions})}launchAppDetailsTutorial(e){const t=this.getDefaultCommand();return t.visibilityState=be.fe.show,this.extensionCommanding.executeCommand({type:ne.p.platformappdetails,action:ne.u.info},{entityCommand:t,entityOptions:e})}appDetailsPostInstall(e){const t=this.getDefaultCommand();return t.stateTransition=be.su.none,this.commandHandler({entity:{type:ne.p.platformappdetails,action:ne.u.config},command:t,entityOptions:e})}appDetailsOnDone(e,t){const n=this.getDefaultCommand();return n.stateTransition=be.su.none,this.commandHandler({entity:{id:e,type:ne.p.platformappdetails,action:ne.u.update},command:n,entityOptions:t})}launchAppStore(e,t){return this.commandHandler({entity:{type:ne.p.platformapps,action:ne.u.list},command:t,entityOptions:e})}launchAppUninstall(e,t){const n=(null==t?void 0:t.entityCommand)||this.getDefaultCommand();return n.visibilityState=be.fe.show,this.extensionCommanding.executeCommand({id:e,type:ne.p.platformapp,action:ne.u.delete},{entityCommand:n,entityOptions:null==t?void 0:t.uninstallOptions})}launchAppError(e){const t=this.getDefaultCommand();return t.visibilityState=be.fe.show,this.extensionCommanding.executeCommand({type:ne.p.platformapp,action:ne.u.error},{entityCommand:t,entityOptions:{errorCode:e}})}launchUploadCustomApp(){const e=this.getDefaultCommand();return e.visibilityState=be.fe.show,this.extensionCommanding.executeCommand({type:ne.p.customapp,action:ne.u.view},{entityCommand:e})}launchRequestSubmittedDialog(){const e=this.getDefaultCommand();return e.visibilityState=be.fe.show,this.extensionCommanding.executeCommand({type:ne.p.customapp,action:ne.u.info},{entityCommand:e})}launchLocationDialog(e){const t=this.getDefaultCommand();return t.visibilityState=be.fe.show,this.extensionCommanding.executeCommand({type:ne.p.locationapi,action:ne.u.create},{entityCommand:t,entityOptions:e})}launchSelectMediaDialog(e){const t=this.getDefaultCommand();return t.visibilityState=be.fe.show,this.extensionCommanding.executeCommand({type:ne.p.selectMediaApi,action:ne.u.create},{entityCommand:t,entityOptions:e})}launchViewImagesDialog(e){const t=this.getDefaultCommand();return t.visibilityState=be.fe.show,this.extensionCommanding.executeCommand({type:ne.p.viewImagesApi,action:ne.u.create},{entityCommand:t,entityOptions:e})}launchSelectPeoplePickerDialog(e){const t=this.getDefaultCommand();return t.visibilityState=be.fe.show,this.extensionCommanding.executeCommand({type:ne.p.selectpeoplepicker,action:ne.u.view},{entityCommand:t,entityOptions:e})}launchAppConfig(e,t){const n=(null==t?void 0:t.entityCommand)||this.getDefaultCommand();return n.visibilityState=be.fe.show,this.extensionCommanding.executeCommand({id:e,type:ne.p.platformapp,action:ne.u.config},{entityCommand:n,entityOptions:null==t?void 0:t.launchAppConfigOptions})}launchTabInfo(e,t){const n=(null==t?void 0:t.entityCommand)||this.getDefaultCommand();return n.visibilityState=be.fe.show,this.extensionCommanding.executeCommand({id:e,type:ne.p.platformtab,action:ne.u.info},{entityCommand:n,entityOptions:null==t?void 0:t.launchTabInfoOptions})}launchStagedApps(e){const t=(null==e?void 0:e.entityCommand)||this.getDefaultCommand();return t.visibilityState=be.fe.show,this.extensionCommanding.executeCommand({type:ne.p.stagedapps,action:ne.u.info},{entityCommand:t,entityOptions:null==e?void 0:e.launchStagedAppsOptions})}launchAppAuthConsent(e,t){const n=(null==t?void 0:t.entityCommand)||this.getDefaultCommand();return n.visibilityState=be.fe.show,this.extensionCommanding.executeCommand({id:e,type:ne.p.platformauthconsentdialog,action:ne.u.create},{entityCommand:n,entityOptions:null==t?void 0:t.launchAuthConsentOptions})}platformTabById(e,t,n,i){return this.commandHandler({entity:{id:e,type:ne.p.extensions,action:ne.u.view,linkedEntity:n},command:t,entityOptions:i})}platformAppById(e,t,n){return this.commandHandler({entity:{id:e,type:ne.p.extensions,action:ne.u.view,linkedEntity:n},command:t})}navigateToManageApps(e){return this.commandHandler({entity:{type:ne.p.platformapps,action:ne.u.manage},entityOptions:e})}launchSubscriptionPlansDialog(e,t,n){const i=n||this.getDefaultCommand();return i.visibilityState=be.fe.show,this.extensionCommanding.executeCommand({id:e,type:ne.p.platformsubscriptionplans,action:ne.u.info},{entityCommand:i,entityOptions:t})}launchAppDetails(e,t,n){const{enableAppDetailsAngularFeatureParity:i}=this.coreSettings.get(b.J.Extensibility);if(i)return this.launchAppInstall(e,{platformAppDetailsOptions:t,entityCommand:n});const a=n||this.getDefaultCommand();return a.visibilityState=be.fe.show,this.extensionCommanding.executeCommand({id:e,type:ne.p.platformapp,action:ne.u.info},{entityCommand:a,entityOptions:t})}launchCustomAppFilePicker(e,t,n){return this.extensionCommanding.executeCommand({id:e,type:ne.p.customapp,action:ne.u.create},{entityCommand:{visibilityState:be.fe.show,stateTransition:be.su.extend,correlation:{source:n||k.D.Store}},entityOptions:t})}launchWorkflowsDialog(e,t,n){return this.extensionCommanding.executeCommand({id:e,type:ne.p.workflows,action:ne.u.create},{entityCommand:{visibilityState:be.fe.show,stateTransition:be.su.extend,correlation:{source:n||k.D.Store}},entityOptions:t})}updatePlatformTabById(e,t,n,i){return this.commandHandler({entity:{id:e,type:ne.p.extensions,action:ne.u.update,linkedEntity:n},command:t,entityOptions:i})}videoEffectsCustomizationPanelById(e,t){return this.commandHandler({entity:{type:ne.p.videoeffectscustomization,action:ne.u.view,linkedEntity:{type:ne.p.calls,id:e}},command:t})}videoEffectsMoreViewPanelById(e,t){return this.commandHandler({entity:{type:ne.p.videoeffectsmoreview,action:ne.u.view,linkedEntity:{type:ne.p.calls,id:e}},command:t})}launchManageAppsUninstall(e,t){const n=this.getDefaultCommand();return n.visibilityState=be.fe.show,this.extensionCommanding.executeCommand({id:e,type:ne.p.manageapps,action:ne.u.delete},{entityCommand:n,entityOptions:t})}getDefaultCommand(){return{stateTransition:be.su.extend,visibilityState:be.fe.show,correlation:{source:k.D.ExtensionCommanding}}}}class Mt{constructor(e){this.commandHandler=e}registration(e){return this.commandHandler({entity:{action:ne.u.view,id:e,type:ne.p.registration},command:{visibilityState:be.fe.show,stateTransition:be.su.new,correlation:{source:k.D.Calendar}}})}}class Ft{constructor(e){this.commandHandler=e}showTeamsGrid(){return this.commandHandler({entity:{type:ne.p.schoolteams,action:ne.u.list},command:{visibilityState:be.fe.show,stateTransition:be.su.flush,correlation:{source:k.D.SchoolTeams}}})}showTabAppWithSimpleHeader(e,t,n){const i={appId:e,channelId:t};return this.commandHandler({entity:{type:ne.p.tabapps,action:ne.u.view,id:JSON.stringify(i)},command:{visibilityState:be.fe.show,stateTransition:be.su.flow,correlation:{source:k.D.SchoolTeams}},entityOptions:{tabName:n,channelName:"general",shouldUseSimpleHeader:!0}})}}class Rt{constructor(e){this.commandHandler=e,this.updateSearchState=e=>this.commandHandler({entity:{type:ne.p.search,action:ne.u.view},command:{correlation:{id:(0,Be.v4)(),startTimestamp:Date.now(),source:k.D.Search},stateTransition:be.su.none,visibilityState:be.fe.show},entityOptions:e}),this.updateSearchStateRW=e=>this.commandHandler({entity:{type:ne.p.search,action:ne.u.view},command:{correlation:{id:(0,Be.v4)(),startTimestamp:Date.now(),source:k.D.Search},stateTransition:be.su.flush,visibilityState:be.fe.show},entityOptions:e}),this.open3SFeedback=e=>this.commandHandler({entity:{type:ne.p.open3sfeedback,action:ne.u.view},command:{correlation:{source:k.D.Search},stateTransition:be.su.new,visibilityState:be.fe.show},entityOptions:e})}}class Pt{constructor(e){this.commandHandler=e}launch(e){return this.commandHandler({entity:{type:ne.p.settingsstore,action:ne.u.default},command:e})}launchSection(e,t,n){return this.commandHandler({entity:{type:ne.p.settingsstore,action:ne.u.view,id:e},command:t,entityOptions:Object.assign(Object.assign({},n),{commandSource:null==t?void 0:t.correlation.source})})}}class Dt{constructor(e,t,n,i,a,o){this.commandHandler=e,this.extensionCommanding=t,this.hostCommunicationService=n,this.windowId=i,this.host=a,this.coreSettings=o}bringWindowToFront(e){var t;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.hostCommunicationService.loadModule("osutils");return(null===(t=null==n?void 0:n.bringWindowToFront)||void 0===t?void 0:t.call(n,e))||Promise.resolve(!1)}))}desktopNotice(){var e;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("osutils");return null===(e=null==t?void 0:t.openThirdPartyNotice)||void 0===e?void 0:e.call(t)}))}dismissBanner(e,t=k.D.Unknown){return this.commandHandler({command:{correlation:{source:t},stateTransition:be.su.none,visibilityState:be.fe.hide},entity:{type:ne.p.bannerNotification,action:ne.u.delete,id:e}})}maximizeWindow(){var e;return(0,l.__awaiter)(this,void 0,void 0,(function*(){if(!this.coreSettings.get(b.J.Core).routeWindowActionsThroughHostComms)return this.host.maximize();const t=yield this.hostCommunicationService.loadModule("windowcontrols");return null===(e=null==t?void 0:t.maximize)||void 0===e?void 0:e.call(t,this.windowId)}))}minimizeWindow(){var e;return(0,l.__awaiter)(this,void 0,void 0,(function*(){if(!this.coreSettings.get(b.J.Core).routeWindowActionsThroughHostComms)return this.host.minimize();const t=yield this.hostCommunicationService.loadModule("windowcontrols");return null===(e=null==t?void 0:t.minimize)||void 0===e?void 0:e.call(t,this.windowId)}))}msaProfileAvatarUpdateDialog(e){return this.extensionCommanding.executeCommand({type:ne.p.updatemsaprofileavatardialog,action:ne.u.view},{entityCommand:e})}msaProfileNameUpdateDialog(e){return this.extensionCommanding.executeCommand({type:ne.p.updatemsaprofilenamedialog,action:ne.u.view},{entityCommand:e})}noticeDialog(e){return this.extensionCommanding.executeCommand({type:ne.p.tpndialog,action:ne.u.view},{entityCommand:e})}restoreWindow(){var e;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("windowcontrols");return null===(e=null==t?void 0:t.restore)||void 0===e?void 0:e.call(t,this.windowId)}))}showBanner(e){var{id:t,dismissable:n=!0,duration:i=4,source:a=k.D.Unknown}=e,o=(0,l.__rest)(e,["id","dismissable","duration","source"]);return this.commandHandler({command:{correlation:{source:a},stateTransition:be.su.none,visibilityState:be.fe.showWithoutFocusing},entity:{type:ne.p.bannerNotification,action:ne.u.create,id:t},entityOptions:Object.assign(Object.assign({},o),{dismissable:n,duration:i})})}showContextMenu(e){var t;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.hostCommunicationService.loadModule("windowcontrols");return null===(t=null==n?void 0:n.showTitleBarContextMenu)||void 0===t?void 0:t.call(n,this.windowId,e)}))}signOutDialog(e){return this.extensionCommanding.executeCommand({type:ne.p.signoutdialog,action:ne.u.view},{entityCommand:e})}startWindowDragListener(){var e;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("windowcontrols");return null===(e=null==t?void 0:t.startWindowDragListener)||void 0===e?void 0:e.call(t,this.windowId)}))}swapMeetingRoomFrontOfRoomWindows(){var e;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("windowcontrols");return null===(e=null==t?void 0:t.swapMeetingRoomFrontOfRoomWindows)||void 0===e?void 0:e.call(t)}))}zoomInWindow(){var e;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("windowcontrols");return null===(e=null==t?void 0:t.zoomIn)||void 0===e?void 0:e.call(t,this.windowId)}))}zoomOutWindow(){var e;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("windowcontrols");return null===(e=null==t?void 0:t.zoomOut)||void 0===e?void 0:e.call(t,this.windowId)}))}zoomResetWindow(){var e;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("windowcontrols");return null===(e=null==t?void 0:t.zoomReset)||void 0===e?void 0:e.call(t,this.windowId)}))}}class jt{constructor(e){this.commandHandler=e}viewStore(e,t,n){return this.commandHandler({entity:{type:ne.p.store,action:ne.u.view,id:e},command:n,entityOptions:t})}}class xt{constructor(e){this.commandHandler=e}viewLobNotifications(e,t){return this.commandHandler({entity:{type:ne.p.lobnotifications,action:ne.u.view},command:t,entityOptions:e})}}class Ot{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}editTeamPicture(e){return this.extensionCommanding.executeCommand({id:e,type:ne.p.teampicture,action:ne.u.view})}viewTeamJoinCode(e,t){return this.extensionCommanding.executeCommand({id:e,type:ne.p.teamjoincode,action:ne.u.view},{entityOptions:{teamJoinCode:t}})}viewTeamRenewal(e,t){return this.extensionCommanding.executeCommand({id:e,type:ne.p.teamrenewal,action:ne.u.view},{entityOptions:{expiryTime:t}})}channelById(e,t){return this.commandHandler({entity:{type:ne.p.channels,action:ne.u.view,id:e},command:null==t?void 0:t.entityCommand})}editTeam(e){return this.extensionCommanding.executeCommand({id:e,type:ne.p.teamedit,action:ne.u.view})}addMember(e){return this.extensionCommanding.executeCommand({id:e,type:ne.p.addmember,action:ne.u.view})}addMemberToNewTeam(e,t){return this.extensionCommanding.executeCommand({id:e,type:ne.p.addmembernewteam,action:ne.u.view},{entityOptions:t})}addChannel(e){return this.extensionCommanding.executeCommand({id:e,type:ne.p.addchannel,action:ne.u.view})}manageTags(e){return this.commandHandler({entity:{id:e,type:ne.p.teammanagetags,action:ne.u.view},command:{stateTransition:be.su.flush,visibilityState:be.fe.show,correlation:{source:k.D.ChannelListItem}}})}leaveTeam(e){return this.extensionCommanding.executeCommand({id:e,type:ne.p.teamleave,action:ne.u.view})}createTeam(){return this.extensionCommanding.executeCommand({type:ne.p.teamcreate,action:ne.u.view})}createTeamOnMainView(e){return this.commandHandler({entity:{type:ne.p.teams,action:ne.u.create},entityOptions:e,command:{stateTransition:be.su.flush,visibilityState:be.fe.show,correlation:{source:k.D.ChannelList}}})}teamDiscover(){return this.commandHandler({entity:{type:ne.p.teamdiscover,action:ne.u.view},command:{stateTransition:be.su.flush,visibilityState:be.fe.show,correlation:{source:k.D.ChannelListItem}}})}manageTeam(e){return this.commandHandler({entity:{id:e,type:ne.p.teammanage,action:ne.u.view},command:{stateTransition:be.su.flush,visibilityState:be.fe.show,correlation:{source:k.D.ChannelListItem}}})}teamDeepLink(e){return this.extensionCommanding.executeCommand({id:e,type:ne.p.teamdeeplink,action:ne.u.view})}channelDeepLink(e){return this.extensionCommanding.executeCommand({id:e,type:ne.p.channeldeeplink,action:ne.u.view})}viewChannelEmail(e){return this.extensionCommanding.executeCommand({id:e,type:ne.p.channelemail,action:ne.u.view})}manageChannelConnectors(e){return this.extensionCommanding.executeCommand({id:e,type:ne.p.channelconnectors,action:ne.u.view})}deleteChannel(e){return this.extensionCommanding.executeCommand({id:e,type:ne.p.channeldelete,action:ne.u.view})}editChannel(e){return this.extensionCommanding.executeCommand({id:e,type:ne.p.channeledit,action:ne.u.view})}manageChannel(e){return this.commandHandler({entity:{id:e,type:ne.p.channelmanage,action:ne.u.view},command:{stateTransition:be.su.flush,visibilityState:be.fe.show,correlation:{source:k.D.ChannelListItem}}})}}var Lt,Ut,Bt,Wt,Ht,$t;!function(e){e.toastFromWeb="toastFromWeb",e.toastFromHost="toastFromHost"}(Lt||(Lt={})),function(e){e.calls="calls",e.chats="chats",e.toasts="toasts",e.signout="signout"}(Ut||(Ut={})),function(e){e.hide="hide",e.show="show"}(Bt||(Bt={})),function(e){e.mutate="mutate",e.view="view"}(Wt||(Wt={})),function(e){e.success="success",e.critical="critical"}(Ht||(Ht={})),function(e){e.quickReply="quickReply",e.unknown="unknown",e.view="view"}($t||($t={}));class Vt{constructor(e){this.commandHandler=e}showMessage(e,{attributionText:t,conversationId:n,mainImage:i,messageId:a,quickReply:o,quickReplyButton:r,quickReplyPlaceholder:s,text:l,time:c,title:d}){const u={command:{correlation:{id:e,source:k.D.Notifications,startTimestamp:c.valueOf()},stateTransition:be.su.new,visibilityState:be.fe.show},entity:{action:ne.u.view,type:ne.p.toasts},entityOptions:{attributionText:t,mainImage:i,targetEntity:{action:Wt.view,dataOptions:{actionType:$t.view,messageId:a},id:n,type:Ut.chats},textInput:o?zt(n,r,s):void 0,text:l,time:c,title:d}};return this.commandHandler(u)}}const zt=(e,t,n)=>({placeholderText:n||"Send a quick reply",sendButton:{text:t||"Send",targetEntity:{action:Wt.mutate,type:Ut.chats,dataOptions:{actionType:$t.quickReply,convId:e}}}});class Gt{constructor(e){this.extensionCommanding=e}launchShareFormDialog(e,t){const n=(null==t?void 0:t.entityCommand)||this.getDefaultCommand();return n.visibilityState=be.fe.show,n.stateTransition=be.su.extend,this.extensionCommanding.executeCommand({id:e,type:ne.p.shareformdialog,action:ne.u.view},{entityCommand:n,entityOptions:null==t?void 0:t.entityOptions})}getDefaultCommand(){return{stateTransition:be.su.extend,visibilityState:be.fe.show,correlation:{source:k.D.ExtensionCommanding}}}}const qt=(e,t,n,i,a,o,r,s,l=S.ew,c)=>{const d=new lt(e,t,l,a,o);return{account:new ye(e),activity:new Se(e),authentication:new ke(e,d),biometricEnrollment:new _e(e),brbFeedback:new Ce(e,d),breakoutRooms:new we(e),broadcast:new Te(e),calendar:new Ee(d,e),call:new Ne(e,d),channel:new Ae(e),chat:new Fe(e,d),coachReport:new Re(e),contacts:new Pe(e,d),deepLink:new Xe(i,e,d,a,o,r,n,c),destroy:()=>d.destroy(),error:new Ze(e),esp:new et(e,d),feedback:new ct(e),file:new dt(d,e),meetingAnalytics:new St(e),meetingOptions:new kt(e,d),nova:new _t(e),platform:new At(e,d,n),registration:new Mt(e),school:new Ft(e),search:new Rt(e),settings:new Pt(e),shareForm:new Gt(d),shell:new Dt(e,d,s,l,i,n),store:new jt(e),lobnotifications:new xt(e),teamsAndChannels:new Ot(e,d),toasts:new Vt(e)}};var Jt=n(313176);function Kt(e){return function(e){const t=Yt(e),n=1,i=2,a=3;if(!t)return e;if(t[a])return t[n].replace(t[i],t[a]);return t[n]}(e)}function Qt(e){return e.message&&(e.message=Kt(e.message)),e.stack&&(e.stack=function(e){if(Yt(e.message))return"Sanitized due to potential PII leaks.";return e.stack}(e)),e}function Yt(e){return new RegExp(/(Can't find field ((chat)\(.*\)|.*) on object)/).exec(e)}const Xt=/-extension:\/\//;function Zt(e){return e===S.jK.TimedOut}class en{constructor(e,t,n,i,a){this.host=e,this.scenarioFactory=t,this.platformService=n,this.networkStateProvider=i,this.diagnosticsService=a,this._onWindowError=e=>(0,l.__awaiter)(this,void 0,void 0,(function*(){if(function(e){return e&&("resizeobserver loop limit exceeded"===e.message.toLowerCase()||Xt.test(e.filename))}(e))return;const{colno:t,filename:n,lineno:i,message:a}=e;let{error:o}=e;const r=!!o&&Zt(o.code);return o&&(o=Qt(o)),this._reportError(A.RG.GlobalWindowError,o||Object.assign(new Error(Kt(a)),{colno:t,error:o,filename:n,lineno:i}),S.jK.UndefinedWindowError,r)})),this._onUnhandledPromiseRejection=e=>(0,l.__awaiter)(this,void 0,void 0,(function*(){const{reason:t}=e,n=!!t&&Zt(t.code);return this._reportError(A.RG.UnhandledRejection,t,S.jK.UnhandledPromiseRejection,n)})),e.addEventListener(R.cr.UnhandledRejection,this._onUnhandledPromiseRejection),e.addEventListener(R.cr.GlobalWindowError,this._onWindowError)}dispose(){this.host.removeEventListener(R.cr.UnhandledRejection,this._onUnhandledPromiseRejection),this.host.removeEventListener(R.cr.GlobalWindowError,this._onWindowError)}set error(e){this.persistDiagnostics(),void 0!==e&&(this._error=e,this._reportError(A.RG.FatalError,e,S.jK.UndefinedGlobalError,!0))}get error(){return this._error}_reportError(e,t,n,i){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{code:a=n,context:o=""}=t||{},r=""===o?`${a}`:`${o}:${a}`,s=(0,G.A)((0,Z.B9)(t));let l="";try{l=this.extractError(t)}catch(e){l="Stringifying error failed"}const c=`[${l}]`;this.scenarioFactory.newScenario(e).fail({message:s,errorCode:r,errors:c,showOops:i,"AppInfo.NetworkState":this.networkStateProvider.isOnline()?"Online":"Offline"});let d=Promise.resolve();if(i){const e=1e3;d=(0,le.E)(V.ip.getInstance().flush(),e),this.persistDiagnostics()}const u=this.platformService.config.clientVersion;return d.catch((()=>this.diagnosticsService.pushDiagnosticsEvent(S.in.Warn,"Could not flush telemetry logs in time"))).then((()=>this.diagnosticsService.getDiagnosticsEvents(1e3))).then((e=>this.host.opener.postMessage(R.rY.WindowErrored,{errorCode:r,errorDescription:s,errorMsg:l,logs:e,showOops:i,clientVersion:u})))}))}extractError(e){return(0,G.A)(JSON.stringify(e,(0,Z.cm)()),[Jt.A4.SmtpAddress,Jt.A4.IPV4Address,Jt.A4.IPv6Address,Jt.A4.PhoneNumber])}persistDiagnostics(){this.diagnosticsService.persistDiagnostics(1e3)}}var tn,nn=n(161622);!function(e){e.JobChange="job_change"}(tn||(tn={}));class an{constructor(e,t,n,i,a,o,r){this._jobHandle=e,this._changes=t,this._meta=n,this._job=i,this._windowId=o,this._correlationId=r,this._timing={received:0,started:0,completed:0,canceled:0},this._execution=nn.Tf.None,this._logger=a.newLogger("Scheduled Job")}receive(){this._timing.received=Date.now(),this._execution=nn.Tf.Received,this.reportJobChange()}execute(){if(this._execution===nn.Tf.Canceled)return;if(this._execution!==nn.Tf.Received)throw new Error("Unable to execute a job that has not been received");let e;this._timing.started=Date.now(),this._execution=nn.Tf.Started;try{this.reportJobChange();const t=this._job();e=t instanceof Promise?t:Promise.resolve(t)}catch(t){this._logger.error(`Job with ID:${this._meta.id} failed to execute or rejected with error: ${t.message?t.message:t}`),e=Promise.reject(t)}this.complete(e)}equals(e){return this._jobHandle===e}cancel(){return this._timing.canceled=Date.now(),this._execution=nn.Tf.Canceled,this.reportJobChange(),{meta:this._meta,job:this._job}}complete(e){const t=e=>{let t;return this._timing.completed=Date.now(),this._execution=nn.Tf.Complete,this.isError(e)&&(t={message:e.message,code:e.code,context:e.context,name:e.name}),this.reportJobChange(t),e};e.then(t).catch(t)}isError(e){return!!e&&e instanceof Error}reportJobChange(e){this._changes.report({correlationId:this._correlationId,type:tn.JobChange,context:Object.assign(Object.assign({},this.toChangeState()),{target:"job",error:e}),windowId:this._windowId})}toChangeState(){return{handle:this._jobHandle,timing:this._timing,execution:this._execution,meta:this._meta}}}var on=n(744448);class rn extends on.default{remove(e,t){const n=[];let i;return this.forEach((a=>{t(a,e)?i=a:n.push(a)})),i&&(this.clear(),n.forEach((e=>this.enqueue(e)))),i}}const sn=(e,t)=>e.equals(t),ln=()=>0;class cn{constructor(e,t,n,i){this._jobExecutor=e,this._supportedPriority=t,this._changes=n,this._loggerFactory=i,this._logger=i.newLogger("GreedyJobExecutionQueue"),this._queue=new rn(ln)}clearExecutionSchedule(){this._jobExecutor.clearExecutionSchedule(),this._queue.clear()}cancel(e){const t=this._queue.remove(e,sn);return t&&t.cancel()}enqueue(e,t,n,i,a){if(n.priority!==this._supportedPriority)return this._logger.error(`Job priroty [${nn.vW[n.priority]}] not supported by this queue, this queue supports [${nn.vW[this._supportedPriority]}]`),!1;const o=new an(e,this._changes,n,t,this._loggerFactory,i,a);return this._queue.enqueue(o)?(o.receive(),this._jobExecutor.scheduleExecution({getJob:()=>this._queue.dequeue()}),!0):(this._logger.error("PriorityQueue did not enqueue the job"),!1)}}class dn{constructor(e,t,n){this._schedule=e,this._clearSchedule=t,this._logger=n}clearExecutionSchedule(){this._executionHandle&&this._clearSchedule(this._executionHandle)}scheduleExecution(e){this._executionHandle||(this._executionHandle=this._schedule((()=>{this._executionHandle=void 0,this.execute(e)})))}execute({getJob:e}){let t;for(;t=e();)try{t.execute()}catch(e){this._logger.error(`Job executor caught an exception executing a job. Continuing execution of remaining jobs. Error: ${e.message?e.message:e}`)}}}class un{constructor(e,t,n,i){this._changes=e,this._loggerFactory=n,this._windowId=i,this._logger=n.newLogger("Scheduler"),this._queues=new Map,this.createQueues(t)}destroy(){this._queues.forEach((e=>{e.clearExecutionSchedule()}))}schedule(e,t,n){const i=this._queues.get(t.priority);if(!i)return this._logger.error(`Job priority [${nn.vW[t.priority]}] supplied by ${t.scheduledById} not supported by scheduling`),nn.o_;const{id:a,runOncePerId:o}=t;if(un.uniqueJobIds.has(a)){if(o)return this._logger.debug(`Job by ID ${a} has already run once.`),nn.o_}else un.uniqueJobIds.add(a);const r=un.nextJobHandle;return i.enqueue(r,e,t,this._windowId,n),r}cancel(e){let t;if(e===nn.o_)return t;const n=Array.from(this._queues.values());for(const i of n)if(t=i.cancel(e),t)break;return t}static get uniqueJobIds(){return this._uniqueJobIds||(this._uniqueJobIds=new Set),this._uniqueJobIds}createQueues(e){this.createQueue(nn.vW.Macro,(t=>e.setTimeout(t)),(t=>e.clearTimeout(t))),this.createQueue(nn.vW.RenderBlocking,(t=>e.requestAnimationFrame(t)),(t=>e.cancelAnimationFrame(t)))}createQueue(e,t,n){const i=new dn(t,n,this._logger),a=new cn(i,e,this._changes,this._loggerFactory);this._queues.set(e,a)}static get nextJobHandle(){return this._nextJobHandle===Number.MAX_SAFE_INTEGER&&(this._nextJobHandle=0),this._nextJobHandle++,this._nextJobHandle}}un._nextJobHandle=0;const mn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"performWindowHistoryNavigation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"navigationDirection"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"NavigationDirection"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"performWindowHistoryNavigation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"navigationDirection"},value:{kind:"Variable",name:{kind:"Name",value:"navigationDirection"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]},pn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"navigateToWindowHistoryIndex"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowHistoryIndex"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"navigateToWindowHistoryIndex"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"windowHistoryIndex"},value:{kind:"Variable",name:{kind:"Name",value:"windowHistoryIndex"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]};class gn{constructor(e,t,n,i){this._client=e,this._host=t,this._coreSettings=n,this._windowId=i,this.onPopState=e=>(0,l.__awaiter)(this,void 0,void 0,(function*(){var t;this.navigateTo((null===(t=e.state)||void 0===t?void 0:t.windowHistoryIndex)||0)}))}init(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){this.hostHistoryNavigationEnabled&&this._host.addEventListener("popstate",this.onPopState)}))}destroy(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){this.hostHistoryNavigationEnabled&&this._host.removeEventListener("popstate",this.onPopState)}))}navigate(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){return this.mutate(mn,{navigationDirection:e})}))}navigateTo(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){return this.mutate(pn,{windowHistoryIndex:e})}))}get hostHistoryNavigationEnabled(){var e;return(null===(e=this._coreSettings.get(b.J.Core))||void 0===e?void 0:e.enableHostHistoryNavigation)||!1}mutate(e,t){return(0,l.__awaiter)(this,void 0,void 0,(function*(){return this._client.mutate({mutation:e,variables:Object.assign(Object.assign({},t),{windowId:this._windowId}),fetchPolicy:"no-cache"})}))}}var hn=n(545319),vn=n(823931);const fn=(e,t)=>t[e]||hn.Q2.DefaultV2,yn=e=>{const t=new URLSearchParams(e.location.search).get("theme");if(t){const e=Object.keys(hn.Q2).find((e=>e.toUpperCase()===t.toUpperCase()));return hn.Q2[e]}},Sn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"removeWindow"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"removeWindow"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},kn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"runGarbageCollection"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"runGarbageCollection"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]},bn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"windowStateEvent"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"windowStateEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isFocused"}},{kind:"Field",name:{kind:"Name",value:"correlation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"shouldClose"}}]}}]}}]};class _n{report(e){if(!this._changes||0===this._changes.observers.length)return;const t=e.changeCorrelationId||(0,Be.v4)();this.changes.next(Object.assign(Object.assign({},e),{changeCorrelationId:t}))}observeChanges(){return this.changes.asObservable()}get changes(){return this._changes||(this._changes=new it.xQ),this._changes}}const Cn=(e,t,n)=>{const{enableThemePreferenceResolution:i}=t.get(b.J.Core),{environment:a}=t.get(b.J.Metadata);if(i){return((e,t,n,i)=>{var a;const o=yn(t);if(o)return o;const r=null!==(a=e.getPreferences("theme"))&&void 0!==a?a:{};if(r.followOsTheme){const e=(0,vn.Z)(t,i);if(e)return fn(e,n)}else if(r.userTheme)return fn(r.userTheme,n);return hn.Q2.DefaultV2})(e,n,(e=>({[hn.f8.Light]:e===he.s.life?hn.Q2.DefaultTfl:hn.Q2.DefaultV2,[hn.f8.Dark]:e===he.s.life?hn.Q2.DarkTfl:hn.Q2.DarkV2,[hn.f8.Contrast]:hn.Q2.HighContrast}))(null!=a?a:he.s.prod))}return t.get(b.J.Host).theme||"default"},wn=(e,t)=>e.subscribe({query:bn,variables:{windowId:t}}),Tn=(e,t,n,i,a,o,r)=>{const{isFocused:s,shouldClose:l,correlation:c}=e&&e.data&&e.data.windowStateEvent;let d;const u=null==c?void 0:c.id;l?(t.close(),r.log(`host.close() called through window state event with correlationId ${u}`),d=ve.M.Close):s&&(t.focus(),r.log(`host.focus() called through window state event with correlationId ${u}`),d=ve.M.Focus,o.loadModule("windowcontrols").then((e=>{var t;null===(t=null==e?void 0:e.focus)||void 0===t||t.call(e,n),r.log(`HostComms focus() called through window state event with correlationId ${u}`)}))),d&&u&&(i.reportCommandEvent(u,d),a.report({type:fe.FV.WindowStateChange,context:{target:"context-providers-handle-window-event"},correlationId:u,windowId:n}))},En=(e,t,n)=>(n&&(e._cleanupFns||(e._cleanupFns=[]),e._cleanupFns.push(n)),Object.assign(Object.assign({},e),t)),In=(e,t)=>(0,y.U)((n=>En(n,e(n),t))),Nn=(e,t)=>In((n=>({regenerateEntityCommandingServices:(i,a)=>(({appsRegistryService:e,client:t,clientLaunchId:n,commandReportingService:i,coreSettings:a,deeplinkService:o,hostCommunicationService:r,loggerFactory:s,platformService:l,scenarioFactory:c,viewEntity:d,viewEntityName:u,windowId:m,windowProvider:p})=>qt((o=>yt({appsRegistryService:e,client:t,clientLaunchId:n,commandReportingService:i,coreSettings:a,entityCommandInput:o,loggerFactory:s,platformService:l,scenarioFactory:c,windowId:m,executionContext:{viewEntity:d,viewEntityName:u}})),t,a,p,c,s,o,r,m,n))({appsRegistryService:n.appsRegistryService,client:n.client,clientLaunchId:t,commandReportingService:n.commandReportingService,coreSettings:n.coreSettings,deeplinkService:n.deeplinkService,hostCommunicationService:n.hostCommunicationService,loggerFactory:n.loggerFactory,platformService:n.platformService,scenarioFactory:n.scenarioFactory,viewEntity:i,viewEntityName:a,windowId:e,windowProvider:n.windowProvider})}))),An=(e,t,n,i,a,o,r,s,l)=>{const c=[];return t.pipe((0,pe.R)(e),(e=>e.pipe((e=>In((()=>({windowProvider:e}))))(r),(e=>In((t=>({loggerFactory:new Q(t.diagnosticsService,e)}))))(a),((e,t)=>In((({loggerFactory:n})=>({scheduler:new un(new _n,t,n,e)})),(({scheduler:e})=>e.destroy())))(a,r),((e,t)=>In((n=>{const i=n.windowProvider.viewportContext,a=t.type,o=n.coreSettingsContext.createContextForViewport({id:e,viewportContext:i,entityType:a}),r=o.getCoreSettings();return{coreSettingsContext:o,coreSettings:r}}),(({coreSettingsContext:e})=>e.cleanup())))(a,l),(e=>In((()=>({scenarioFactory:e})),(({scenarioFactory:e})=>e.destroy())))(i),((e,t)=>In((n=>({userBiService:n.telemetryService.createUserBiService(n,e,{id:t.id,startTimestamp:+t.startTimestamp||0,source:t.source})})),(({userBiService:e})=>e.destroy())))(a,o),(e=>In((({experienceChangeReportingService:t})=>({experienceChangeReportingService:Object.assign(Object.assign({},t),{report:n=>{t.report(Object.assign({windowId:e},n))}})}))))(a),(e=>In((({appsRegistryService:t,appStateService:n,authenticationService:i,authenticationUser:a,cacheStorage:o,cdlWorkerService:r,client:s,clientPreferences:l,clientState:c,commandReportingService:d,coreSettings:u,dataCleanupService:m,discover:p,experienceChangeReportingService:g,hostCommunicationService:h,localStorage:v,loggerFactory:f,offlineCacheManager:y,platformService:S,rebootService:k,scenarioFactory:b,user:_,userBiService:C,windowProvider:w})=>{const T=s,E={appsRegistryService:t,appStateService:n,authenticationService:i,authenticationUser:a,cacheStorage:o,cdlWorkerService:r,clientPreferences:l,clientState:c,commandReportingService:d,coreSettings:u,dataCleanupService:m,discover:p,experienceChangeReportingService:g,hostCommunicationService:h,localStorage:v,loggerFactory:f,offlineCacheManager:y,platformService:S,pubsub:T.getServices().pubsub,rebootService:k,scenarioFactory:b,user:_,userBiService:C,windowId:e,windowProvider:w};return{client:T.clone(E)}}),(({client:e,entityCommanding:t})=>(e.destroy(),t.destroy()))))(a))),(e=>{var t,n;return e.pipe(((e,t,n)=>In((i=>({entityCommanding:qt((t=>yt({appsRegistryService:i.appsRegistryService,client:i.client,commandReportingService:i.commandReportingService,coreSettings:i.coreSettings,entityCommandInput:t,loggerFactory:i.loggerFactory,platformService:i.platformService,scenarioFactory:i.scenarioFactory,windowId:e,clientLaunchId:n}).then()),i.client,i.coreSettings,t,i.scenarioFactory,i.loggerFactory,i.deeplinkService,i.hostCommunicationService,e,n)}))))(a,r,null!==(t=o.clientLaunchId)&&void 0!==t?t:void 0),In((e=>({errorState:new en(e.windowProvider,e.scenarioFactory,e.platformService,e.networkState,e.diagnosticsService)})),(({errorState:e})=>e.dispose())),(e=>In((()=>({clientState:e}))))(s),Nn(a,null!==(n=o.clientLaunchId)&&void 0!==n?n:void 0),(e=>In((t=>{const n=new gn(t.client,t.windowProvider,t.coreSettings,e);return n.init(),{windowHistoryNavigationService:n}}),(({windowHistoryNavigationService:e})=>e.destroy())))(a))}),(0,f.b)((e=>c.push(e))),(0,ge.x)((()=>c.forEach((e=>Mn(e,n))))))},Mn=(e,t)=>{const{_cleanupFns:n=[]}=e;n.forEach((n=>{try{n(e)}catch(e){t.error("Failed to cleanup context",e)}}))},Fn=(e,t,n)=>{n.log(`Removing window ${e} from apollo cache`),t.client.mutate({mutation:Sn,variables:{windowId:e}}).then((()=>{t.client.mutate({mutation:kn})})).catch((e=>n.error("Error in removing window: ",e)))},Rn=(e,t,n,i)=>{var a;return e.telemetryService.createScenarioFactory(e,t,{id:n.id,startTimestamp:parseInt(n.startTimestamp,10)||0,source:n.source},null!==(a=n.clientLaunchId)&&void 0!==a?a:void 0,i)},Pn=(e,t)=>e.markStep(A.RG.WindowLaunchTime,t);var Dn=n(906386);const jn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"activeWindowForEntity"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entity"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EntityInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindowForEntity"},arguments:[{kind:"Argument",name:{kind:"Name",value:"entity"},value:{kind:"Variable",name:{kind:"Name",value:"entity"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"activeEntities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mainEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindow"}}]}},{kind:"Field",name:{kind:"Name",value:"endEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindow"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"correlation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"startTimestamp"}},{kind:"Field",name:{kind:"Name",value:"source"}}]}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"entityFieldsForActiveWindow"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Entity"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"action"}},{kind:"Field",name:{kind:"Name",value:"options"}}]}}]};function xn(e,t,n){var i;return(0,l.__awaiter)(this,void 0,void 0,(function*(){try{const n=yield t.query({query:jn,variables:{entity:e},fetchPolicy:"no-cache"});return null===(i=n.data.activeWindowForEntity)||void 0===i?void 0:i.id}catch(t){return void n.error(`query for entity failed. Entity: ${JSON.stringify(e)}, Error: ${t}`)}}))}function On(e,t,n){const i=t.getValue().find((t=>t.id===e)),a=!(!i||!i.window.document.hasFocus()),o=n.getState(),r=o===Dn.pk.LongInactive||o===Dn.pk.Inactive;return a&&!r}var Ln=n(773176),Un=n(136295),Bn=n(51485),Wn=n(431657);const Hn=(e,t,n,i)=>(0,Un.z)((0,Wn.fU)(((n,a)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){var o,r;const s=[];try{for(var c,d=(0,l.__asyncValues)(function(e,t,n,i){return(0,l.__asyncGenerator)(this,arguments,(function*(){const a=e[Symbol.iterator](),o=t[Symbol.iterator]();let r=a.next(),s=o.next();for(;!s.done||!r.done;)s.done||!r.done&&s.value.id>r.value[0].id?(yield(0,l.__await)(i(r.value[1])),r=a.next()):r.done||s.value.id<r.value[0].id?(yield yield(0,l.__await)([s.value,n(s.value)]),s=o.next()):(yield yield(0,l.__await)([s.value,r.value[1]]),r=a.next(),s=o.next())}))}(n,Array.from(a).sort(((e,t)=>e.id.localeCompare(t.id))),(t=>$n(t,e,i)),(e=>Vn(e,t))));!(c=yield d.next()).done;){const e=c.value;s.push(e)}}catch(e){o={error:e}}finally{try{c&&!c.done&&(r=d.return)&&(yield r.call(d))}finally{if(o)throw o.error}}return s}))),[]),(0,y.U)((e=>zn(e,n))),(0,h.b)((e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const t=yield e;return Promise.all(t)}))))),$n=(e,t,n)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){try{return{type:"value",value:yield t(e)}}catch(t){return n&&n(e,t),{type:"error",error:t}}})),Vn=(e,t)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const n=yield e;if("error"!==n.type)return t(Promise.resolve(n.value))})),zn=(e,t)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const n=[],i=yield Promise.all(e);for(const e of i){const i=yield e[1];"value"===i.type&&n.push(t(e[0],Promise.resolve(i.value)))}return n}));const Gn=(e,t)=>e.opener.postMessage(R.Gx.Destroy,{windowId:t});function qn(e,t,n,i,a,o,r){return(0,l.__awaiter)(this,void 0,void 0,(function*(){Pn(i,A.ck.BeginWindowCreation);const s=e.windowProvider;if(t===S.ew)return s;const l=yield function(e,t,n){return new Promise(((i,a)=>{const o=e.setTimeout((()=>{a("New Frame did not report in 10000ms")}),1e4),r=e.self;return r.frameResolvers=r.frameResolvers||{},r.frameResolvers[t]=n=>{e.clearTimeout(o),ti(e,t),i(n)},e.opener.postMessage(R.Gx.Create,{windowId:t,correlation:n})}))}(s,t,a);if(!l)return s;const c=(0,Bn.dP)(l,e,t,o,r),d=c.getHostedWindowContext();return Object.assign(c,{getHostedWindowContext:()=>Object.assign(Object.assign({},d),{windowId:t}),viewportContext:Ln.R.iFrame}),Pn(i,A.ck.EndWindowCreation),Kn(c,e,t,n),c.close=()=>Gn(s,t),c}))}function Jn(e){var t;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{window:n,windowClosing$:i,subscription:a,clientState:o}=yield e,r=null===(t=n.location.hash)||void 0===t?void 0:t.slice(1);r?Gn(n,r):n.close(),a&&a.unsubscribe(),o&&o.dispose(),i.next(!0)}))}const Kn=(e,t,n,i,a)=>{const o="onpagehide"in e?"pagehide":"unload",r=()=>{Fn(n,t,i),a&&a(),e.removeEventListener(o,r)};e.addEventListener(o,r)},Qn=({id:e,activeEntities:t},n)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{window:i,context$:a}=yield n;return{id:e,window:i,context$:a,activeEntities:t}})),Yn=(e,t,n)=>(0,Un.z)(Hn((i=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){return Zn(i,e,t,n)}))),Jn,Qn,((e,n)=>((e,t,n)=>{const i=n.loggerFactory.newLogger("IframeStateManager");i.error(`Creation for window ${e.id} failed with ${t}. Removing window from cache`),n.commandReportingService.reportCommandEvent(e.correlation.id,ve.M.Failure,{errorInfo:ve.y.CreateWindowError}),Fn(e.id,n,i)})(e,n,t)))),Xn=(e,t,n,i,a,o,r,s,c,d,u)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){return e&&t?Promise.resolve(((e,t,n,i,a,o,r)=>{const s=t.windowProvider,l=s.open(void 0,e,"width=600px,height=500px,toolbar=no,menubar=no,location=no");if(r){const{clientPreferences:e,coreSettings:n}=t,i=r({theme:Cn(e,n,s),viewportContext:Ln.R.iFrame});l.document.write(i),l.document.close()}const c=()=>{const e=new URL(s.location.href);e.searchParams.append("random",Date.now().toString()),e.hash=[s.location.pathname,i.mainEntity.type,encodeURIComponent(i.mainEntity.id)].join("/"),l.location.href=decodeURIComponent(e.href)};s.addEventListener("unload",c);let d=(0,Bn.dP)(l,t,e,a,o);return d=Object.assign(d,{getHostedWindowContext:()=>({startReason:N.zF.userInitiated,panelContext:N.QP.secondary})}),Kn(d,t,e,n,(()=>{s.removeEventListener("unload",c)})),d})(i,n,a,s,c,d,u)):qn(n,i,a,o,r,c,d)})),Zn=(e,t,n,i)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{id:a,correlation:o,activeEntities:r,isMainWindow:s,layoutMode:l}=e,{coreSettings:c}=n,d=o.source===k.D.PopOutButton,{enablePopOutChats:u}=c.get(b.J.Messaging),m=new Q(n.diagnosticsService,a),p=m.newLogger("IframeStateManager"),g=Object.assign(Object.assign({},n),{loggerFactory:m}),h=Rn(g,a,o,Ln.R.iFrame);return ei(t,g,p,a,o,r,d,u,h,s,l,i)})),ei=(e,t,n,i,a,o,r,s,c,d,u,m)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const l=yield Xn(s,r,t,i,n,c,a,o,d,u,m),p=new it.xQ,g=wn(t.client,i).subscribe((e=>Tn(e,l,i,t.commandReportingService,t.experienceChangeReportingService,t.hostCommunicationService,n))),h=t.clientState.getChildWindowStateProvider(l,t.loggerFactory),{mainEntity:v}=o,f=ni(l,i,p,g,h,e,n,c,a,v);return Pn(c,A.ck.WindowContextProvider),f})),ti=(e,t)=>e.opener.postMessage(R.Gx.Acquired,{windowId:t}),ni=(e,t,n,i,a,o,r,s,l,c)=>({window:e,windowClosing$:n,subscription:i,clientState:a,context$:An(n,o,r,s,t,l,e,a,c)});var ii=n(558388),ai=n(697950);const oi=(e,t,n)=>{e.opener.postMessage(R.rY.ShouldShowChatNotification,{shouldShowChatNotification:t,windowId:n})};var ri=n(226568),si=n(786744),li=n(909260),ci=n(324273);const di=(e,t)=>!!(e===t||!e&&!t||e&&t&&e.id===t.id&&e.type===t.type&&e.action===t.action);function ui(e,t){var n;if(!t||!t.activeEntities)return!1;const i=null===(n=t.activeEntities)||void 0===n?void 0:n.mainEntity,a=e.activeEntities.mainEntity;return!di(a,i)&&!function(e,t){const n=["subNavEntity","headerEntity","startEntity","mainEntity","endEntity"];for(const i of n)if(e[i]||t[i])return di(e[i],t[i]);return!1}(e.activeEntities,t.activeEntities)}const mi=e=>({isChanged:pi,execute:t=>e.dataCleanupService.markDataForWindowAsInactive(t.id)});function pi(e,t){return function(e){return!!e.isMainWindow&&e.layoutMode===be.lO.standard}(e)&&ui(e,t)}const gi=e=>({isChanged:ui,execute:(t,n)=>function(e,t,n){var i;const a=t.activeEntities.mainEntity,o=null==n?void 0:n.activeEntities.mainEntity,r=e.appsRegistryService.getApp({entityType:a.type});if(!r)throw new Error("Entity does not match to an existing app");const s=null===(i=r.getAppWindowFeatures)||void 0===i?void 0:i.call(r,{coreServices:e,isResize:!0,prevEntityType:null==o?void 0:o.type});if(!s)return;const{width:l,height:c,minWidth:d,minHeight:u}=s,{window:m}=t;e.loggerFactory.newLogger("WindowResizeCommand").log(`From ${null==o?void 0:o.type} of height ${m.innerHeight} and width ${m.innerWidth}, to ${a.type} of height ${c} and width ${l}`),d&&u&&m.setMinimumSize&&m.setMinimumSize(d,u);l&&c&&m.setBounds&&m.setBounds({x:m.screenX,y:m.screenY,width:l,height:c})}(e,t,n)});var hi=n(429145);const vi=(e,t)=>{switch(t){case Ie.LayoutModes.standard:return(0,li.ZN)(e,"window",N.d.main);case Ie.LayoutModes.minimal:return(0,li.ZN)(e,"window",N.d.flyout);default:return e}},fi=(e,t,n,i,a,o,r,s,c,d,u)=>{let m="",p="about:blank",g=0,h=0;p=t.platformService.config.clientType!==si.Bh.Web?(0,li.ZN)(p,"entityType",r.type):p;const v={url:p,windowId:n,windowFeatures:m,globalWindow:e,coreServices:t,logger:i,scenarioFactory:a,windowState:o,isMainWindow:c,layoutMode:d,templateGenerator:u};if(t.platformService.config.clientType===si.Bh.Maglev){const{addWindowIdQsp:e}=t.coreSettings.get(b.J.Core);if(e&&(p=(0,li.ZN)(p,"windowId",n)),c)return yi(Object.assign(Object.assign({},v),{url:vi(p,d)}))}return({expectedInnerHeight:g,expectedInnerWidth:h,url:p,windowFeatures:m}=function(e,t,n,i,a,o,r){var s;const c=e.appsRegistryService.getApp({entityType:n});if(!c)throw new Error("Entity does not match to an existing app");const d=(null===(s=c.getAppWindowFeatures)||void 0===s?void 0:s.call(c,{coreServices:e,host:t,screenState:a,windowOptions:i}))||{},{additionalFeatures:u={}}=d,m=(0,l.__rest)(d,["additionalFeatures"]);let p=Object.keys(m).reduce(((e,t)=>`${e}${e?",":""}${t}=${m[t]}`),"");return p=e.platformService.config.clientType===si.Bh.Web?`${p},toolbar=no,menubar=no,location=no`:p,r=Object.keys(u).reduce(((e,t)=>u?(0,li.ZN)(e,t,u[t]):e),r),o.log(`windowFeatures: ${p}, url: ${r}`),{expectedInnerHeight:(null==m?void 0:m.height)||0,expectedInnerWidth:(null==m?void 0:m.width)||0,url:r,windowFeatures:p}}(t,e,r.type,r.windowOptions,s,i,p)),yi(Object.assign(Object.assign({},v),{expectedInnerHeight:g,expectedInnerWidth:h,url:p,windowFeatures:m}))},yi=({url:e,windowId:t,windowFeatures:n,globalWindow:i,coreServices:a,logger:o,scenarioFactory:r,windowState:s,isMainWindow:l,layoutMode:c,templateGenerator:d,expectedInnerHeight:u,expectedInnerWidth:m})=>{const p=i.open(e,t,n||void 0);if(!p)throw new hi.G("WINDOW_UNDEFINED");const g=(0,Bn.dP)(p,a,t,l,c);g.expectedInnerHeight=u||0,g.expectedInnerWidth=m||0,Pi(g,t,e),o.log(`windowState: ${JSON.stringify(s)}`);const{minWidth:h=0,minHeight:v=0}=s;return g.setMinimumSize&&g.setMinimumSize(h,v),Si(i,g,a,d),Pn(r,A.ck.EndWindowCreation),ki(g,a,r,t,o),bi(a,g),g},Si=(e,t,n,i)=>{if(!i)return;if(!!t.document.getElementById("app"))return;const{clientPreferences:a,coreSettings:o,platformService:r}=n,s=r.config.clientVersion.split("/").pop(),l=i({theme:Cn(a,o,e),osPlatform:r.config.osPlatform,cspNonce:e.__webpack_nonce__,publicPathScript:`window.__webpack_public_path__="${r.config.publicPath}"`,containerVer:s,viewportContext:t.viewportContext});t.document.write(l),t.document.close()},ki=(e,t,n,i,a)=>{const{disableMainWindowMouseListeners:o}=t.coreSettings.get(b.J.Core),r=()=>{e.opener.postMessage(R.rY.UnhandledMouseEvent,{type:"mousemove"})},s=()=>{e.opener.postMessage(R.rY.UnhandledMouseEvent,{type:"click"})},l=e=>{if(!(e=>{var t,n;const i=e.target,a=null===(t=i.nodeName)||void 0===t?void 0:t.toLowerCase(),o=null===(n=i.type)||void 0===n?void 0:n.toLowerCase();return!(!i||!(i.isContentEditable||"textarea"===a||"input"===a&&/^(?:text|email|number|search|tel|url|password)$/i.test(o)))})(e))return e.preventDefault(),!1},c="onpagehide"in e?"pagehide":"unload",d=(e=>{const{disableContextMenu:t}=e.coreSettings.get(b.J.Core);return!!t})(t),u=()=>{a.log(`${c} called for window ${i}`),Di(e),Fi(n),Fn(i,t,a),e.document.removeEventListener("mouseenter",r),e.document.removeEventListener("click",s),d&&e.removeEventListener("contextmenu",l),e.removeEventListener(c,u),a.log(`blur/unload listeners removed for windowId: ${i}`),Ri(t,e,a,i)};i!==S.ew||o||(e.document.addEventListener("mouseenter",r),e.document.addEventListener("click",s)),e.addEventListener(c,u),d&&e.addEventListener("contextmenu",l)},bi=(e,t)=>{var n,i;null===(i=null===(n=e.leakDetectorService)||void 0===n?void 0:n.create())||void 0===i||i.track("unwrappedWindow",t)},_i=(e,t,n)=>{return(0,Un.z)((0,ci.j)((i=>Ci(i,e,t,n)),Ei,Ii,((e,n)=>((e,t,n)=>{var i;let a,o;const r=n.loggerFactory.newLogger("WindowStateManager");r.error(`Creation for window ${e.id} failed with ${t}. Removing window from cache`),t instanceof hi.G?(a=t.reason,o=null==t?void 0:t.message):(a=ve.y.CreateWindowError,o=(0,P.u4)(t));const s=null===(i=n.scenarioFactory)||void 0===i?void 0:i.findScenario(A.RG.ClientStart);null==s||s.fail({errorCode:a,reason:o?(0,G.A)(o):o}),n.commandReportingService.reportCommandEvent(e.correlation.id,ve.M.Failure,{errorInfo:a,errorMessage:o}),Fn(e.id,n,r)})(e,n,t))),Mi([gi(t),mi(t)]),(i=t.platformService.config.clientType===si.Bh.Web,a=e=>Ai(e,t),e=>i?e.pipe((0,f.b)((e=>a(e)))):e));var i,a},Ci=(e,t,n,i)=>{const{id:a,activeEntities:o,correlation:r,screenState:s,isMainWindow:l,layoutMode:c}=e,{mainEntity:d,endEntity:u}=o,m=new Q(n.diagnosticsService,a),p=m.newLogger("WindowStateManager"),g=Object.assign(Object.assign({},n),{loggerFactory:m}),h=Rn(g,a,r,(0,Bn.YR)(l,c)),v=h.findScenario(A.RG.WindowLaunchTime);null==v||v.appendEventData({mainEntityType:d.type,endEntityType:null==u?void 0:u.type});const f=((e,t)=>{var n;const i=e.appsRegistryService.getApp({entityType:t.type});return(null===(n=null==i?void 0:i.getAppWindowFeatures)||void 0===n?void 0:n.call(i,{coreServices:e,isResize:!0}))||{}})(g,d);return wi(t,g,a,d,p,h,f,r,s,l,c,i)},wi=(e,t,n,i,a,o,r,s,l,c,d,u)=>{const m=((e,t,n,i,a,o,r,s,l,c)=>{Pn(i,A.ck.BeginWindowCreation),n.log(`mainEntityId: ${o.id}, mainEntityType: ${o.type}, mainEntityAction: ${o.action}`);const d=e.windowProvider;return t===S.ew?(ki(d,e,i,t,n),d):fi(d,e,t,n,i,a,o,r,s,l,c)})(t,n,a,o,r,i,l,c,d,u),p=new it.xQ,g=((e,t,n,i)=>wn(e.client,t).subscribe((a=>Tn(a,n,t,e.commandReportingService,e.experienceChangeReportingService,e.hostCommunicationService,i))))(t,n,m,a),h=t.clientState.getChildWindowStateProvider(m,t.loggerFactory),v=Ti(m,n,p,g,h,e,a,o,s,i,t.loggerFactory,t.leakDetectorService);return Pn(o,A.ck.WindowContextProvider),t.commandReportingService.reportCommandEvent(s.id,ve.M.WindowCreated),v},Ti=(e,t,n,i,a,o,r,s,l,c,d,u)=>({id:t,window:e,windowClosing$:n,windowStateSubscription:i,clientState:a,leakDetectorService:u,context$:An(n,o,r,s,t,l,e,a,c),loggerFactory:d}),Ei=({clientState:e,id:t,window:n,windowClosing$:i,windowStateSubscription:a,loggerFactory:o,leakDetectorService:r})=>{const s=o.newLogger("WindowStateManager");s.log(`Destroy called on window ${t}`),t!==S.ew&&(n&&n.close(),s.log(`Window.close() called for window ${t}`)),null==a||a.unsubscribe(),null==r||r.cleanup(),e.dispose(),i.next(!0)},Ii=({id:e,activeEntities:t},{window:n,context$:i})=>({id:e,window:n,context$:i,activeEntities:t});let Ni;const Ai=(e,t)=>{const n=t.loggerFactory.newLogger("WindowStateManager"),{isChatHybridArchitectureEnabled:i}=t.coreSettings.get(b.J.Host);if(i){if(!e.find((e=>e.id===S.ew)))return}const a=t.windowProvider,o="onpagehide"in a?"pagehide":"unload";a.removeEventListener(o,Ni),Ni=()=>{n.log(`Global window unload handler called for ${e.length} windows`),e.forEach((e=>{e.id!==S.ew&&e.window.close()}))},a.addEventListener(o,Ni,{once:!0})},Mi=e=>(0,ri.R)(((t,n)=>(n.forEach((n=>{const i=t.find((e=>e.id===n.id));e.forEach((e=>{e.isChanged(n,i)&&e.execute(n,i)}))})),n)),[]),Fi=e=>{e.stopScenarioIfActive(A.RG.WindowLaunchTime,{},"abandoned")},Ri=(e,t,n,i)=>{(e=>{const{enableCdlRegistration:t}=e.coreSettings.get(b.J.Core);return!!t})(e)&&(t.opener.postMessage(R.rY.CdlRegistration,{childWindowId:i,eventType:"unregister"}),n.log(`CdlRegistration: windowId: '${i}', eventType: unregister`))},Pi=(e,t,n)=>{const i=new URL(n);e.windowLeakInfo={windowLeakInfoStartTime:(new Date).toUTCString(),windowLeakInfoEntityType:i.searchParams.get("entityType")||n,windowLeakInfoWindowId:t}},Di=e=>{e.windowLeakInfo||(e.windowLeakInfo={}),e.windowLeakInfo.windowLeakInfoEndTime=(new Date).toUTCString()};var ji;!function(e){e.Initializing="Initializing",e.Unrecoverable="Unrecoverable",e.LongInactive="LongInactive",e.Inactive="Inactive",e.Active="Active",e.VeryActive="VeryActive"}(ji||(ji={}));var xi,Oi=n(932252);class Li{constructor(e,t,n){this.handleMachineLockUpdate=e=>{var t;const n=null===(t=null==e?void 0:e.payload)||void 0===t?void 0:t.isMachineLocked;void 0!==n&&(this._logger.log(`Handling pushed machineLock update change: isMachineLocked = ${n}.`),this.updateMachineState(n))},this._logger=t.newLogger("HostStateProvider"),this._hostStateSubject=new c.X({windowState:Dn.kZ.InFocus,machineLockState:Dn.UV.Active}),this.registerForStateChanges(e,n)}observe(){return this._hostStateSubject.asObservable()}getState(){return Object.assign({},this._hostStateSubject.value)}dispose(){var e;null===(e=this._machineStateChangedSubscription)||void 0===e||e.call(this)}registerForStateChanges(e,t){e.opener.addEventListener(R.rY.AppStateSyncMessage,this.handleMachineLockUpdate),t.loadModule("osutils").then((e=>{var t;this._machineStateChangedSubscription=null===(t=null==e?void 0:e.registerForSessionStateChanged)||void 0===t?void 0:t.call(e,(e=>{this._logger.log(`Handling pushed machineLock update change: machine SessionStatus= ${e.status}.`),this.updateMachineState(e.status===Oi.$.Locked)}))}))}updateMachineState(e){const t=e?Dn.UV.Locked:Dn.UV.Active,n=this.getState().machineLockState;if(t!==n){this._logger.log(`Updating machine lock state from=${n} to=${t}.`);const e=this.getState();e.machineLockState=t,this._hostStateSubject.next(e)}}}!function(e){e.Active="Active",e.Inactive="Inactive",e.LongInactive="LongInactive"}(xi||(xi={}));class Ui{constructor(e,t,n,i){this._host=e,this._activityCallback=n,this.trackDocumentVisibility=i,this.handleMonitoredWindowEvent=(0,j.debounce)((()=>{this._idleStateBehaviorSubject.value!==xi.Active&&this._idleStateBehaviorSubject.next(xi.Active),this.restartIdleTimer(),this._activityCallback&&this._activityCallback()}),Ui.msDelayTime,{maxWait:Ui.msUntilIdle-Ui.msDelayTime*Ui.msMaxWaitTimeFactor,leading:!0}),this.handleIdleTimerTimeout=()=>{this._idleStateBehaviorSubject.next(xi.Inactive),this._idleCountdownTimer=void 0,this.restartLongIdleTimer()},this.handleLongIdleTimerTimeout=()=>{this._idleStateBehaviorSubject.next(xi.LongInactive),this._longIdleCountdownTimer=void 0},this.handleDocumentVisibilityChange=()=>{this._host.document.hidden?this._idleStateBehaviorSubject.next(xi.Inactive):(this._idleStateBehaviorSubject.next(xi.Active),this.restartIdleTimer())},this._idleStateBehaviorSubject=new c.X(xi.Inactive),this.restartLongIdleTimer(),Ui.monitoredWindowEvents.forEach((t=>{e.addEventListener(t,this.handleMonitoredWindowEvent)})),i&&e.addEventListener("visibilitychange",this.handleDocumentVisibilityChange),t.newLogger("IdleTracker").log("Initialized")}observe(){return this._idleStateBehaviorSubject.asObservable()}getState(){return this._idleStateBehaviorSubject.value}createChildWindowIdleTracker(e,t){const n=this._activityCallback||this.handleMonitoredWindowEvent;return new Ui(e,t,n)}restartIdleTimer(){this.stopIdleTimers(),this._idleCountdownTimer=this._host.setTimeout(this.handleIdleTimerTimeout,Ui.msUntilIdle)}dispose(){this.stopIdleTimers(),Ui.monitoredWindowEvents.forEach((e=>{this._host.removeEventListener(e,this.handleMonitoredWindowEvent)})),this.trackDocumentVisibility&&this._host.removeEventListener("visibilitychange",this.handleDocumentVisibilityChange),this._idleStateBehaviorSubject.complete(),this.handleMonitoredWindowEvent.cancel()}restartLongIdleTimer(){void 0!==this._longIdleCountdownTimer&&(this._host.clearTimeout(this._longIdleCountdownTimer),this._longIdleCountdownTimer=void 0),this._longIdleCountdownTimer=this._host.setTimeout(this.handleLongIdleTimerTimeout,Ui.msUntilLongIdle)}stopIdleTimers(){void 0!==this._idleCountdownTimer&&(this._host.clearTimeout(this._idleCountdownTimer),this._idleCountdownTimer=void 0),void 0!==this._longIdleCountdownTimer&&(this._host.clearTimeout(this._longIdleCountdownTimer),this._longIdleCountdownTimer=void 0)}}function Bi(e){switch(e){case Dn.pk.Unrecoverable:return S.eT.Disabled;case Dn.pk.Inactive:return S.eT.Inactive;case Dn.pk.LongInactive:return S.eT.LongInactive;case Dn.pk.VeryActive:return S.eT.InCall;default:return S.eT.Interactive}}function Wi(e){switch(e){case S.eT.InCall:case S.eT.InBroadcast:case S.eT.Presenting:return Dn.pk.VeryActive;case S.eT.Interactive:return Dn.pk.Active;case S.eT.Inactive:return Dn.pk.Inactive;case S.eT.LongInactive:return Dn.pk.LongInactive;case S.eT.Disabled:return Dn.pk.Unrecoverable;default:return}}Ui.monitoredWindowEvents=["scroll","DOMMouseScroll","mousewheel","touchstart","touchmove","mousemove","keydown"],Ui.longIdleFactor=4,Ui.msUntilIdle=3e5,Ui.msUntilLongIdle=Ui.msUntilIdle*Ui.longIdleFactor,Ui.msDelayTime=1e3,Ui.msMaxWaitTimeFactor=30;var Hi,$i=n(929331);class Vi{constructor(e,t,n){this._host=t,this._logger=n.newLogger("ClientStateSender"),this._subscriptionToStateChange=e.pipe((0,$i.x)()).subscribe((e=>this.handleStateChange(e))),this._logger.log("Initialized")}dispose(){this.stopRecurringSending(),this._subscriptionToStateChange.unsubscribe()}handleStateChange(e){try{e===Dn.pk.Active||e===Dn.pk.VeryActive?this.sendStateRecurringly(e):(this.stopRecurringSending(),this.sendState(e))}catch(t){this._logger.error(`Failed to send client state update: ClientState=${e}, Error: ${t}`)}}sendStateRecurringly(e){this._logger.log(`Starting recurring sending of client state: ${e}`);try{this.sendStateAndStartTimer(e)}catch(t){this._logger.error(`Failed to start recurring sending of client state: ClientState=${e}, Error: ${t}`)}}stopRecurringSending(){this.stopTimer(),this._logger.log("Stopped recurring client state sending")}stopTimer(){if(void 0!==this._recurringSendCountdownTimer)try{this._host.clearInterval(this._recurringSendCountdownTimer),this._recurringSendCountdownTimer=void 0}catch(e){this._logger.error(`Failed to stop sending of client state: ${e}`)}}sendStateAndStartTimer(e){this.sendState(e),this.stopTimer(),this._recurringSendCountdownTimer=this._host.setInterval((()=>this.sendState(e)),Vi.msUntilResend)}sendState(e){const t=Bi(e);this._logger.log(`Sending state to main window: ${t} (ClientState=${e})`),this._host.opener.postMessage(R.rY.UpdateWindowState,{childSettings:{appState:t}})}}Vi.msUntilResend=15e4;class zi{constructor(e,t,n,i,a){this._host=e,this._idleTracker=n,this._defaultClientState=Dn.pk.Active,this._initializing=!0,this._clientStateSubscription=null,this._idleTrackerStateSubscription=null,this.handleAppStateSyncMessage=e=>{var t;const n=null===(t=null==e?void 0:e.payload)||void 0===t?void 0:t.appState;void 0!==n&&(this._logger.log(`Handling pushed host appState update change to ${n}.`),this.handleMainWindowStateChange(n))},this._logger=t.newLogger("ClientStateProvider");let o=this._defaultClientState;if(void 0!==a){const e=Wi(a);void 0!==e&&(o=e)}this._logger.log(`Initializing clientState with state=${o}`),this._clientStateBehaviorSubject=new c.X(o),this._setupEventHandlers(t,i),this.restartIdleTimerWhenActiveState(),this._initializing=!1,this._logger.log("Initialized")}observe(){return this._clientStateBehaviorSubject.asObservable()}getState(){return this._clientStateBehaviorSubject.value}getChildWindowStateProvider(e,t){const n=this._idleTracker.createChildWindowIdleTracker(e,t);return new zi(e,t,n,void 0,Bi(this.getState()))}dispose(){var e,t;this._host.opener.removeEventListener(R.rY.AppStateSyncMessage,this.handleAppStateSyncMessage),this._idleTracker.dispose(),this._stateSender&&this._stateSender.dispose(),this._clientStateBehaviorSubject.complete(),null===(e=this._clientStateSubscription)||void 0===e||e.unsubscribe(),null===(t=this._idleTrackerStateSubscription)||void 0===t||t.unsubscribe()}startVeryActive(e){this._logger.log(`startVeryActive(): Client state is set to very active by ${e}.`),this.setClientState(Dn.pk.VeryActive)}stopVeryActive(e){this._logger.log(`stopVeryActive(): Client state is set to active by ${e}.`),this.setClientState(Dn.pk.Active)}_setupEventHandlers(e,t){this._clientStateSubscription=this.observe().subscribe((e=>{this._logger.log(`Client state is ${e}.`)})),this._host.opener.addEventListener(R.rY.AppStateSyncMessage,this.handleAppStateSyncMessage),this._idleTrackerStateSubscription=this._idleTracker.observe().subscribe((e=>this.handleIdleChange(e))),t&&(this._stateSender=new Vi(this.observe(),this._host,e))}handleIdleChange(e){this._logger.log(`Handling idleness change to ${e}.`),this._clientStateBehaviorSubject.value!==Dn.pk.VeryActive&&(this._initializing||this.setClientState(function(e){switch(e){case xi.Inactive:return Dn.pk.Inactive;case xi.LongInactive:return Dn.pk.LongInactive;default:return Dn.pk.Active}}(e),!1))}setClientState(e,t=!0){e!==Dn.pk.Active&&e!==Dn.pk.VeryActive||!t||this._idleTracker.restartIdleTimer(),e===Dn.pk.Inactive&&this._clientStateBehaviorSubject.value===Dn.pk.LongInactive||this._clientStateBehaviorSubject.value!==e&&(this._logger.log(`Updating client state from=${this._clientStateBehaviorSubject.value} to=${e}.`),this._clientStateBehaviorSubject.next(e))}handleMainWindowStateChange(e){const t=Wi(e);t!==Dn.pk.Active&&t!==Dn.pk.VeryActive||this.setClientState(t)}restartIdleTimerWhenActiveState(){this.getState()!==Dn.pk.Active&&this.getState()!==Dn.pk.VeryActive||this._idleTracker.restartIdleTimer()}}class Gi{constructor(e=S.eT.Interactive){this._appState=new c.X(e);(0,F.J)().opener.addEventListener(R.rY.AppStateSyncMessage,(e=>{var t;const n=null===(t=null==e?void 0:e.payload)||void 0===t?void 0:t.appState;this.setAppState(n)}))}observe(){return this._appState.asObservable().pipe((0,$i.x)())}getState(){return this._appState.value}setAppState(e){void 0!==e&&e!==this.getState()&&this._appState.next(e)}}!function(e){e[e.Offline=0]="Offline",e[e.Online=1]="Online"}(Hi||(Hi={}));class qi{constructor(e,t,n){this.scenarioFactory=n,this.observe=()=>this.networkStateBehaviorSubject.asObservable(),this.getState=()=>this.networkStateBehaviorSubject.getValue(),this.observeIsOnline=()=>this.isOnlineObservable,this.isOnline=()=>this.convertToIsOnline(this.getState()),this.convertToIsOnline=e=>e===Hi.Online,this.logger=e.newLogger(t);const i=Hi.Online;this.networkStateBehaviorSubject=new c.X(i),this.isOnlineObservable=this.networkStateBehaviorSubject.asObservable().pipe((0,y.U)((e=>this.convertToIsOnline(e))),(0,$i.x)()),this.setupBaseEventHandlers()}dispose(){var e;null===(e=this.networkStateSubscription)||void 0===e||e.unsubscribe(),this.networkStateSubscription=void 0,this.networkStateBehaviorSubject.complete(),this.previousNetworkStateChangeTime=void 0}setNetworkState(e,t){this.logger.log(`Set network to ${Hi[e]}${t?` due to ${t}`:""}`),this.getState()!==e&&this.networkStateBehaviorSubject.next(e)}setupBaseEventHandlers(){this.networkStateSubscription=this.observe().subscribe((e=>{this.logger.log(`Network is ${Hi[e]}`),this.sendStateChangeTelemetry(e)}))}sendStateChangeTelemetry(e){let t=-1;const n=(new Date).getTime();if(this.previousNetworkStateChangeTime&&(t=n-this.previousNetworkStateChangeTime),this.previousNetworkStateChangeTime=n,-1===t)return;const i=e===Hi.Online?A.RG.NetworkOnline:A.RG.NetworkOffline;this.scenarioFactory.newScenario(i).stop({delta:t})}}class Ji{constructor(e){this.logger=e,this.subscriptions=[],this.currentState=void 0}getLastState(){return this.currentState}subscribeToStateChange(e){const t=this;t.subscriptions.push(e);return()=>{const n=t.subscriptions.indexOf(e);n>=0&&t.subscriptions.splice(n,1)}}cleanUpSubscriptions(){this.subscriptions=[],this.currentState=void 0}notifyAboutStateChange(e){this.currentState=e,this.subscriptions.forEach((t=>t(e)))}doOverrideOfLastState(e){this.currentState=e}}class Ki extends Ji{constructor(e,t,n){super(e),this.label=t,this.onOverrideLastState=n,this.handleNetworkStateNotification=e=>{this.logger.debug(`${this.label} received ${Hi[e]}`),this.getLastState()!==e&&(this.logger.log(`${this.label} network state is ${Hi[e]}`),this.notifyAboutStateChange(e))}}overrideLastState(e){const t=this.getLastState();this.logger.debug(`EndpointsNetworkStateListener state is overriden from ${void 0===t?"undefined":Hi[t]} to ${Hi[e]}`),this.doOverrideOfLastState(e),this.onOverrideLastState(e)}cleanUpSubscriptions(){super.cleanUpSubscriptions()}}class Qi extends Ji{constructor(e,t){super(e),this.handleNetworkStateNotification=e=>{const t=e?Hi.Online:Hi.Offline;this.logger.debug("Endpoints network state is "+(e?"online":"offline")),this.getLastState()!==t&&(this.logger.log("Endpoints network state is "+(e?"online":"offline")),this.notifyAboutStateChange(t))};const n={next:this.handleNetworkStateNotification,complete:()=>{var e;return null===(e=this.subscription)||void 0===e?void 0:e.unsubscribe()}};this.subscription=t.observeIsOnline().subscribe(n)}overrideLastState(e){const t=this.getLastState();this.logger.debug(`EndpointsNetworkStateListener state is overriden from ${void 0===t?"undefined":Hi[t]} to ${Hi[e]}`),this.doOverrideOfLastState(e)}cleanUpSubscriptions(){var e;super.cleanUpSubscriptions(),this.subscription&&!this.subscription.closed&&(null===(e=this.subscription)||void 0===e||e.unsubscribe()),this.subscription=void 0}}var Yi=n(42723);class Xi extends Ji{constructor(e){super(e),this.failed_to_fetch_subContext="rejectHttpError",this.processResponse=e=>{void 0!==e.status&&this.handleNetworkStateNotification(Hi.Online)},this.processResponseError=e=>{e&&(e.serverResponse?this.handleNetworkStateNotification(Hi.Online):e.context===S.w5.RejectHttpError&&e.code===S.jK.RemoteOperationFailed&&e.subContext===this.failed_to_fetch_subContext?this.handleNetworkStateNotification(Hi.Offline):this.logger.log(`Not network related error: ${e.message||e}`))},this.handleNetworkStateNotification=e=>{this.logger.debug(`Send network state is ${Hi[e]}`),this.getLastState()!==e&&(this.logger.log(`Send network state listener is ${Hi[e]}`),this.notifyAboutStateChange(e))},this.unsubscribeFromSendTracking=(0,Yi.z)(this.processResponse,this.processResponseError)}overrideLastState(e){const t=this.getLastState();this.logger.debug(`Send state listener's state is overriden from ${void 0===t?"undefined":Hi[t]} to ${Hi[e]}`),this.doOverrideOfLastState(e)}cleanUpSubscriptions(){super.cleanUpSubscriptions(),this.unsubscribeFromSendTracking&&this.unsubscribeFromSendTracking(),this.unsubscribeFromSendTracking=void 0}}var Zi=n(459012);const ea=(e,t,n)=>Promise.resolve({apiName:"networkPing",baseUrl:e,constructRequest:()=>({apiName:"networkPing",url:`${t}?cb=${Date.now()}`,method:"HEAD",timeout:1e4,headers:n?{"cache-control":"no-store",BehaviorOverride:"redirectAs404"}:{"cache-control":"no-store"}})});var ta=n(415e3),na=n(972193);function ia(e,t){return new Promise(((n,i)=>{if(e<0)i((0,ta.T)(na.A.InvalidParameters));else{let i=0;i=t.setTimeout((()=>{t.clearTimeout(i),n()}),e)}}))}const aa=[5e3,1e4,3e4];class oa{constructor(e,t,n,i,a){this.coreSettings=e,this.scenarioFactory=n,this.host=i,this.logger=a.newLogger("NetworkPingService");const o=e=>{const{coreSettings:t,platformService:n}=e,i=t.get(b.J.Core).networkPingUri||"https://teams.microsoft.com/diagnostics/network";let a=!1;const o=new URL(i).origin,r=`${i}`;a=o!==new URL(n.config.currentUrl).origin;const s=t.get(b.J.Core).networkPingFallbackPingUri||`${n.config.staticsPath}/evergreen-assets/icons/1x1-000000ff.png`,l=new URL(s).origin;return{serviceName:Zi.EJ.NetworkPing,models:{getNetworkStatus:ea(o,r,a),getNetworkStatusFallback:ea(l,s,a)}}};this.endpoints=t.createApi(o),this.disableFallback=this.coreSettings.get(b.J.Core).networkPingDisableFallback||!1,this.logger.log("Initialized")}detectCurrentNetworkStatus(){const e=this.coreSettings.get(b.J.Core).networkPingDebounceDelay||3e4;return!(this.coreSettings.get(b.J.Core).networkPingDisableDebounce||!1)&&this.latestPingResult&&this.latestPingResult.isOnline&&this.latestPingResult.timestamp&&Date.now()-this.latestPingResult.timestamp<e?(this.logger.log(`Skipping network detection as last online check succeeded less than ${e}ms ago.`),Promise.resolve(!0)):(this.logger.log("doing network ping"),this.ping())}whenNetworkOnline(){if(this.whenNetworkOnlinePromise)return this.whenNetworkOnlinePromise;let e=!1;const t=this.coreSettings.get(b.J.Core).networkPingRetryIntervals||aa,n=Object.assign([],t),i=()=>{e=!0,this.whenNetworkOnlinePromise=void 0};let a=()=>{e=!0};const o=new Promise(((t,o)=>(0,l.__awaiter)(this,void 0,void 0,(function*(){a=()=>{e||(i(),o("cancelled"))};let r=n[0];for(let t=0;!e;t++){if(yield this.ping())break;t<n.length&&(r=n[t]),yield ia(r,this.host)}i(),t()}))));return this.whenNetworkOnlinePromise={promise:o,cancel:a},this.whenNetworkOnlinePromise}ping(){const e=this.scenarioFactory.newScenario(A.RG.NetworkPing);return e.appendEventData({operation:"initial ping"}),this.endpoints.getNetworkStatus().then((()=>this.pingSuccess("initial network ping",e))).catch((t=>t&&t.response?this.pingSuccess("initial network ping",e):(t&&t.reason===na.A.TimedOut?this.logger.log("initial network ping timed out"):this.logger.log("initial network ping failed"),this.disableFallback?this.pingFailed("initial network ping",t,e):this.pingFallback(e))))}pingFallback(e){return e.appendEventData({operation:"fallback ping"}),this.endpoints.getNetworkStatusFallback().then((()=>this.pingSuccess("network ping fallback",e))).catch((t=>t&&t.response?this.pingSuccess("network ping fallback",e):(t&&t.reason===na.A.TimedOut?this.logger.log("network ping fallback timed out"):this.logger.log("network ping fallback failed"),this.pingFailed("network ping fallback",t,e))))}updatePingResult(e){this.latestPingResult={isOnline:e,timestamp:Date.now()}}pingSuccess(e,t){return t.stop({message:`${e} successful!`},"success"),this.logger.log(`${e} successful!`),this.updatePingResult(!0),!0}pingFailed(e,t,n){this.updatePingResult(!1);const i=t&&t.reason?t.reason:"undefined";return n.fail({errors:`${e} failed. error reason: ${i}`}),!1}}class ra extends qi{constructor(e,t,n,i,a,o){super(e,"NetworkStateProvider",n),this.loggerFactory=e,this.coreSettings=t,this.host=i,this.clientStateProvider=a,this._defaultNetworkOnlineDetectionTimeoutInMs=15e3,this._listeners=[],this._isFirstSignal=!0,this.createNetworkStateTracker=(e,t)=>{const n={next:e=>{}},i=new Ki(this.logger,e,t);return n.next=i.handleNetworkStateNotification,this._listeners.push(i),i.subscribeToStateChange((t=>this._handleNetworkStateUpdate(t,`${e} network state is ${Hi[t]}`))),n},this._handleNetworkStateUpdate=(e,t)=>{if(this.logger.debug(`Update network to ${Hi[e]}${t?" due to ":""}${t}`),e===Hi.Offline){if(this.getState()===Hi.Offline)return;this._suspectOffline()}else this._cancelNetworkOnlineDetection(t),this.getState()!==e&&this.setNetworkState(e,t);this._isFirstSignal&&(this._isFirstSignal=!1)},this._handleWindowOnline=()=>{this.logger.log("browser network online"),this.isOnline()||(this._updateAllListenersTo(Hi.Offline),this._kickOffNetworkOnlineDetection(Hi.Online))},this._handleWindowOffline=()=>{if(this.logger.log("browser network offline"),this.coreSettings.get(b.J.Core).disableWindowEventsNetworkDetectionV2){if(this.getState()===Hi.Offline)return;this.setNetworkState(Hi.Offline,"browser offline"),this._updateAllListenersTo(Hi.Offline),this._kickOffNetworkOnlineDetection(Hi.Offline)}else this._suspectOffline()},this._subscribeToSendNetworkState(),this._subscribeToEndpointsNetworkStateTracking(o.networkState),this._subscribeToWindowNetworkEvents(),this._networkPingService=new oa(this.coreSettings,o,n,this.host,this.loggerFactory)}dispose(){super.dispose(),this._cancelNetworkOnlineDetection("dispose"),this._listeners.forEach((e=>e.cleanUpSubscriptions())),this._listeners=[],this._unsubscribeFromWindowNetworkEvents()}_subscribeToSendNetworkState(){const e=new Xi(this.logger);this._listeners.push(e),e.subscribeToStateChange((e=>this._handleNetworkStateUpdate(e,`Send network state is ${Hi[e]}`)))}_subscribeToEndpointsNetworkStateTracking(e){const t=new Qi(this.logger,e);this._listeners.push(t),t.subscribeToStateChange((e=>this._handleNetworkStateUpdate(e,`Endpoints network state is ${Hi[e]}`)))}_subscribeToWindowNetworkEvents(){this.host.addEventListener("online",this._handleWindowOnline),this.host.addEventListener("offline",this._handleWindowOffline)}_unsubscribeFromWindowNetworkEvents(){this.host.removeEventListener("online",this._handleWindowOnline),this.host.removeEventListener("offline",this._handleWindowOffline)}_updateAllListenersTo(e){this._listeners.forEach((t=>{var n;return null===(n=t.overrideLastState)||void 0===n?void 0:n.call(t,e)}))}_suspectOffline(){const{enableSkipNetworkDetectionTimeoutOnOfflineStart:e,useVeryActiveForNetworkOnlineDetection:t,enableNetworkOnlineDetectionTimeout:n,networkOnlineDetectionTimeoutInMs:i}=this.coreSettings.get(b.J.Core);if(t&&this.clientStateProvider.getState()===Dn.pk.VeryActive)return void this.logger.log("Network detection cancelled due to VeryActive client state.");const a=this._isFirstSignal&&!!e;if(!(this._networkDetectionTimeout&&!a||this._detectCurrentNetworkStatusPromise||this._networkPing))if(this._updateAllListenersTo(Hi.Offline),n&&!a){const e=i||this._defaultNetworkOnlineDetectionTimeoutInMs;void 0!==this._networkDetectionTimeout||this._detectCurrentNetworkStatusPromise||(this.logger.log(`Starting ${e}ms timeout before kicking off network online detection.`),this._networkDetectionTimeout=this.host.setTimeout((()=>{this._networkDetectionTimeout=void 0,this.logger.log("Timeout expired."),this._kickOffNetworkOnlineDetection(Hi.Offline)}),e))}else this._kickOffNetworkOnlineDetection(Hi.Offline)}_kickOffNetworkOnlineDetection(e){this._canPerformPing()?this._detectCurrentNetworkStatusPromise||this._networkPing||(this.logger.log("Kicking off network status detection."),this._detectCurrentNetworkStatusPromise=this._networkPingService.detectCurrentNetworkStatus().then((e=>{void 0!==this._detectCurrentNetworkStatusPromise?(this._detectCurrentNetworkStatusPromise=void 0,e?(this.logger.log("Network status verified as online."),this.setNetworkState(Hi.Online,"http online")):(this.setNetworkState(Hi.Offline,"http offline"),this._startNetworkPing())):this.logger.log("Network detection cancelled, ignoring result.")})).catch((e=>{this.logger.error(`Network status verification error: ${e}`),this._detectCurrentNetworkStatusPromise=void 0}))):this.getState()!==e&&this.setNetworkState(e)}_canPerformPing(){const{enablePingService:e}=this.coreSettings.get(b.J.Core);return!!e||(this.logger.warn("Network detection is disabled."),!1)}_startNetworkPing(){this._canPerformPing()&&!this._networkPing?(this.logger.log("Started recurring network ping."),this._networkPing=this._networkPingService.whenNetworkOnline(),this._networkPing.promise.then((()=>{this._networkPing?(this._networkPing=void 0,this.getState()!==Hi.Online&&this.setNetworkState(Hi.Online,"Network ping succeded")):this.logger.log("Network ping cancelled, ignoring result.")})).catch((e=>{this.logger.log(`network detection by ping terminated due to ${(null==e?void 0:e.message)?e.message:e}`)}))):this.logger.log(this._networkPing?"ping is already in progress":"can't perform ping")}_cancelNetworkPing(){this._networkPing&&(this._networkPing.cancel(),this._networkPing=void 0)}_cancelNetworkOnlineDetection(e){void 0!==this._networkDetectionTimeout&&(this.logger.log(`Cancelling network detection timeout due to ${e}`),this.host.clearTimeout(this._networkDetectionTimeout),this._networkDetectionTimeout=void 0),this._detectCurrentNetworkStatusPromise&&(this.logger.log(`Cancelling network detection due to ${e}`),this._detectCurrentNetworkStatusPromise=void 0),this._networkPing&&(this.logger.log(`Cancelling network ping due to ${e}`),this._cancelNetworkPing())}}class sa extends Ji{constructor(e,t){super(e),this.handleLegacyApplicationStateChange=e=>{const t=this.isOnlineAndConnectedInternal(e);this.logger.log(`LegacyApplicationState changed to ${S.eT[e]}`),this.notifyAboutStateChange(t)},this.isOnlineAndConnectedInternal=e=>{switch(e){case S.eT.Disabled:case S.eT.Offline:return Hi.Offline;default:return Hi.Online}},this.legacyApplicationStateSubscription=t.observe().pipe((0,$i.x)()).subscribe(this.handleLegacyApplicationStateChange)}cleanUpSubscriptions(){super.cleanUpSubscriptions(),this.legacyApplicationStateSubscription&&(this.legacyApplicationStateSubscription.unsubscribe(),this.legacyApplicationStateSubscription=void 0)}}class la extends qi{constructor(e,t,n,i,a,o){super(t,"LegacyNetworkStateProvider",n),this.hostCommunicationService=o,this._listeners=[],this._handleNetworkListenerUpdate=(e,t)=>(0,l.__awaiter)(this,void 0,void 0,(function*(){e!==this.getState()&&(this.logger.debug(`Network suspected ${Hi[e]}${t?" due to ":""}${t}`),yield this._sendSuspectedNetworkState(e!==Hi.Offline))})),this._subscribeToLegacyAppStateTracking(e),this._subscribeToSuspectedNetworkState(a,i)}dispose(){super.dispose(),this._listeners.forEach((e=>e.cleanUpSubscriptions())),this._listeners=[]}_subscribeToLegacyAppStateTracking(e){const t=new sa(this.logger,e);this._listeners.push(t);const n=this;t.subscribeToStateChange((e=>n._updateNetworkState(e,`LegacyApplicationState changed to ${Hi[e]}`)));const i=t.getLastState();void 0!==i&&this._updateNetworkState(i,"initial LegacyApplicationState")}_subscribeToSuspectedNetworkState(e,t){const{enableNetworkTrackingForLegacyNetworkState:n}=t.get(b.J.Core);n&&(this._subscribeToSendNetworkState(),this._subscribeToEndpointsNetworkStateTracking(e.networkState))}_subscribeToSendNetworkState(){const e=new Xi(this.logger);this._listeners.push(e),e.subscribeToStateChange((e=>this._handleNetworkListenerUpdate(e,`Send network state is ${Hi[e]}`)))}_subscribeToEndpointsNetworkStateTracking(e){const t=new Qi(this.logger,e);this._listeners.push(t),t.subscribeToStateChange((e=>this._handleNetworkListenerUpdate(e,`Endpoints network state is ${Hi[e]}`)))}_updateNetworkState(e,t){this.logger.log(`Update network to ${Hi[e]}${t?" due to ":""}${t}`),this.getState()!==e&&(this.setNetworkState(e),this._updateAllListenersTo(e))}_sendSuspectedNetworkState(e){return this.logger.log(`Sending isNetworkOnline to main window: ${e}`),this.hostCommunicationService.loadModule("core").then((t=>{t&&t.notifyCoreStateChanged?t.notifyCoreStateChanged({isNetworkOnline:e}):this.logger.warn("notifyCoreStateChanged is missing in HostComms")}))}_updateAllListenersTo(e){this._listeners.forEach((t=>{var n;return null===(n=t.overrideLastState)||void 0===n?void 0:n.call(t,e)}))}}class ca{constructor(){this.id=S.Yg.CreateAppState,this._updateTelemetryOnClientStateChange=(e,t)=>{e.observe().subscribe((e=>{t.setCoreContext("AppInfo.ClientState",e)}))},this._updateTelemetryOnNetworkStateChange=(e,t)=>{e.observeIsOnline().subscribe((e=>{const n=e?"Online":"Offline";t.setCoreContext("AppInfo.NetworkState",n)}))},this._updateHostOnClientStateChange=(e,t,n)=>{const i=n.newLogger("updateHostOnClientStateChange");e.observe().subscribe((e=>t.loadModule("webclientstates").then((t=>{if(t&&t.notifyWebClientStateChange){const n=ji[e];t.notifyWebClientStateChange(n),i.log(`messaged host new ClientState (${e}). WebClientState sent: ${n}`)}else i.warn("webclientstates.notifyWebClientStateChange is not loaded")})).catch((e=>{i.error(`Error happened: ${e.message||e}`)}))))}}execute(e){var t;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:n,hostCommunicationService:i,hostSettings:a,loggerFactory:o,platformService:r,scenarioFactory:s,telemetryService:l,windowProvider:c}=e,d=null===(t=null==a?void 0:a.hostSettings)||void 0===t?void 0:t.appState,u=void 0!==d?d:S.eT.Inactive;e.appStateService=new Gi(u);const m=new Ui(c,o);e.hostState=new Li(c,o,i),e.clientState=new zi(c,o,m,e.hostState,d),e.networkState=this._createNetworkStateProvider(e,e.clientState,e.appStateService),e.errorState=new en(c,s,r,e.networkState,e.diagnosticsService),this._updateTelemetryOnClientStateChange(e.clientState,l),this._updateTelemetryOnNetworkStateChange(e.networkState,l);const{enableUpdateHostOnClientStateChange:p}=n.get(b.J.Core);p&&this._updateHostOnClientStateChange(e.clientState,i,o)}))}_createNetworkStateProvider(e,t,n){const{coreSettings:i,loggerFactory:a,scenarioFactory:o,windowProvider:r,endpointsManager:s,hostCommunicationService:l}=e,{enableNetworkOnlineDetection:c}=i.get(b.J.Core);return c?new ra(a,i,o,r,t,s):new la(n,a,o,i,s,l)}}var da=n(67419),ua=n(684703),ma=n(295556),pa=n(975883),ga=n(132887),ha=n(755537),va=n(603250);const fa=(e,t,n)=>{var i;const{environment:a}=null!==(i=n.get(b.J.Metadata))&&void 0!==i?i:{},{clientType:o,currentUrl:r,hostingParent:s,isInIframe:l,isInCypressFrame:c,browser:d,browserVersion:u,osPlatform:m,osVersion:p}=t.config;return Object.assign(Object.assign({},e),{clientType:o,currentUrl:r,hostingParent:s,isInIframe:l,isInCypressFrame:c,browser:d,browserVersion:u,osPlatform:m,osVersion:p,environment:a})},ya=e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){e.initializeAuthenticationService&&(yield e.initializeAuthenticationService())})),Sa=(e,t,n)=>{const i={id:(0,pa.pW)(),scenarioName:"auth_web_initialization",source:"core-auth-tasks::init",scenarioPhase:"AuthInit"};return ma.c.create({correlation:i,subContext:"createAuthenticationServiceInstance",timeoutMs:ga.rF.ONE_HOUR,scenarioEventData:{context:`env:${e}||host:${t}||v2:${+!!n}`,scenarioPhase:"AuthStart"}})};class ka{constructor(){this.id=S.Yg.CreateAuth}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){e.authenticationService=yield(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){var t,i,a;const{loggerFactory:o,scenarioFactory:r,config:s,appStateService:l,coreSettings:c,windowProvider:d,platformService:u,authStateProvider:m,hostCommunicationService:p,rebootService:g}=e;(0,ua.k)(d),(0,ma.T)(r);const h=fa(s,u,c),v=(0,da.Gg)(l),{enableAuthV2:f}=(null==c?void 0:c.get(b.J.Auth))||{},y=Sa(null!==(t=h.environment)&&void 0!==t?t:"",null===(i=null==d?void 0:d.location)||void 0===i?void 0:i.hostname,!!f);let S;try{S=f?new((yield(0,ha.mT)((()=>n.e(96106).then(n.bind(n,658498))),"auth_v2",r)).AuthenticationService)(o,r,h,d,p,m,c,g):new((yield(0,ha.mT)((()=>Promise.all([n.e(12084),n.e(59818)]).then(n.bind(n,208569))),"auth",r)).AuthenticationService)(o,r,v,h,d,c),yield ya(S),y.closeScenario()}catch(e){const t=e instanceof va.l?e:new va.l(e);throw y.closeScenario({error:null!==(a=t.prevError)&&void 0!==a?a:e}),t}return S})))(e)}))}}var ba=n(143076);class _a{constructor(e,t){var n;this._coreSettings=t,this.skypeIsDown=!1,this._criticalResources=[],this.currentAuthState=new c.X(ba.jq.Up),this.defaultAuthStateChangeTimeout=3e4,this._logger=e.newLogger("AuthStateProvider"),this._logger.log("[AuthState] Initializing auth state to Up.");const{criticalResources:i,authStateChangeTimeout:a}=(null===(n=this._coreSettings)||void 0===n?void 0:n.get(b.J.Auth))||{};this._criticalResources=i||[],this._authStateChangeTimeout=null!=a?a:this.defaultAuthStateChangeTimeout,this.badTokenStates=new Map}observe(){return this.currentAuthState}getState(){return this.currentAuthState.value}reportResourceTokenState(e,t){this._criticalResources.includes(e)&&(t===ba.QI.Success?this.badTokenStates.delete(e):this.badTokenStates.set(e,t),this.evaluateCurrentState())}reportSkypeTokenState(e){const t=e===ba.QI.Failure;t!==this.skypeIsDown&&(this.skypeIsDown=t,this.evaluateCurrentState())}evaluateCurrentState(){let e;if(0===this.badTokenStates.size)e=this.skypeIsDown?ba.jq.SkypeReconnecting:ba.jq.Up;else{const t=this.badTokenStates.values();let n=t.next();for(;!n.done;){if(n.value===ba.QI.InteractionRequired){e=ba.jq.InteractionRequired;break}e=ba.jq.AADReconnecting,n=t.next()}}e&&this.changeAuthState(e)}changeAuthState(e){if(e===ba.jq.Up||e===ba.jq.InteractionRequired)this.pendingStateClearTimeout&&(globalThis.window.clearTimeout(this.pendingStateClearTimeout),this.pendingState=void 0,this.pendingStateClearTimeout=void 0),this.changeTo(e);else if(this.pendingState)this.pendingState=e;else{if(e===this.currentAuthState.value)return;this.pendingState=e,this.pendingStateClearTimeout=globalThis.window.setTimeout((()=>{this.pendingState&&this.changeTo(this.pendingState),this.pendingState=void 0,this.pendingStateClearTimeout=void 0}),this._authStateChangeTimeout)}}changeTo(e){e!==this.currentAuthState.value&&(this._logger.warn(`[AuthState] Transition from ${this.currentAuthState.value} to ${e}`),this.currentAuthState.next(e))}}class Ca{constructor(e,t,n,i,a){this.cache=e,this.dataOpsRepository=t,this.scenarioFactory=n,this.windowProvider=a,this.logger=i.newLogger("EvictionService")}evict(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){let e=!0;do{e=yield this.evictByWindowRequestIdleCallback()}while(e)}))}evictByWindowRequestIdleCallback(){return new Promise((e=>{this.windowProvider.requestIdleCallback((t=>{let n=!1,i=0;do{const e=performance.now(),a=t.timeRemaining();this.logger.debug("Time remaining at start",a);const o=this.scenarioFactory.newScenario(A.RG.CacheEviction);n=this.evictInternal(o);const r=t.timeRemaining(),s=performance.now();i=r>0?r:a-(s-e);const l={"Eviction.TimeRemaining":i};o.stop(l),this.logger.debug("Time remaining at end",i)}while(n&&i>10);e(n)}))}))}evictInternal(e){const{descriptors:t,hasMore:n}=this.dataOpsRepository.flush(10);let i=0,a=0;t.forEach((e=>{this.cache.evict(e)?i++:a++}));const o={"Eviction.EntriesEvicted":i,"Eviction.EntriesNotEvicted":a};e.mark("eviction",o);const r=i>0?this.cache.gc():[],s={"Eviction.EntriesCollected":r.length};return e.mark("gc",s),this.logger.debug("Eviction results",{entriesEvicted:i,entriesNotEvicted:a,entriesGCed:r.length}),n}}class wa{constructor(){this.id=S.Yg.CreateCacheClearing,this._clearCacheOnClientStateChangeToInactive=(e,t)=>{e.observe().subscribe((e=>(0,l.__awaiter)(this,void 0,void 0,(function*(){var n;e===Dn.pk.Inactive&&(yield null===(n=this.evictionService)||void 0===n?void 0:n.evict(),t.clearCache())}))))}}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{client:t,clientState:n,dataCleanupService:i,loggerFactory:a,scenarioFactory:o,coreSettings:r,windowProvider:s}=e,{enableSingleApolloCoreCache:l}=r.get(b.J.Core);l&&(this.evictionService=new Ca(t.client.cache,i,o,a,s)),this._clearCacheOnClientStateChangeToInactive(n,s)}))}}class Ta{constructor(e,t,n,i){this._caches=e,this._tenantId=t,this._userId=n,this._experienceName=i}createRequest(e,t,n,i,a=!1,o=this._experienceName){const r=this._getFormatKey(t,o,n,a);return{cacheName:e,request:new Request(r,i)}}add({cacheName:e,request:t}){return(0,l.__awaiter)(this,void 0,void 0,(function*(){return(yield this._caches.open(e)).add(t)}))}addAll(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{cacheName:t}=e[0],n=e.map((({request:e})=>e));return(yield this._caches.open(t)).addAll(n)}))}delete({request:e,cacheName:t},n){return(0,l.__awaiter)(this,void 0,void 0,(function*(){return(yield this._caches.open(t)).delete(e,n)}))}keys(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){return(yield this._caches.open(e)).keys()}))}match({request:e,cacheName:t},n){return(0,l.__awaiter)(this,void 0,void 0,(function*(){return(yield this._caches.open(t)).match(e,n)}))}matchAll({request:e,cacheName:t},n){return(0,l.__awaiter)(this,void 0,void 0,(function*(){return(yield this._caches.open(t)).matchAll(e,n)}))}put({request:e,cacheName:t},n){return(0,l.__awaiter)(this,void 0,void 0,(function*(){return(yield this._caches.open(t)).put(e,n)}))}clear(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){return this._caches.delete(e)}))}_getFormatKey(e,t,n,i){try{return new URL(e),e}catch(a){let o="";switch(n){case S.fO.Experience:o=`${t}/${e}`;break;case S.fO.User:o=`${this._tenantId}/${this._userId}/${e}`;break;case S.fO.Global:o=e;break;case S.fO.UserAndExperience:o=`${this._tenantId}/${this._userId}/${this._experienceName}/${e}`;break;default:return`/${e}`}return i?`//${o}`:o}}}class Ea{constructor(e,t){this._cacheStorage=e,this._cacheName="offline-cache-manager",this._logger=t.newLogger("OfflineCacheManager")}save(e,t,n){return(0,l.__awaiter)(this,void 0,void 0,(function*(){if(!e)throw this._error("get","Invalid key");try{this._logger.log(`saving item to offline cache: ${e}`);const i=this._getScopedRequest(e,n);return yield this._cacheStorage.put(i,t),i.request.url}catch(e){throw e instanceof DOMException&&this._logger.error(`DOMException name:${e.name}, message${e.message}`),this._error("save","Failed to save object to cache")}}))}saveDynamic(e,t){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const n=(0,Be.v4)();return[n,yield this.save(n,e,t)]}))}get(e,t){return(0,l.__awaiter)(this,void 0,void 0,(function*(){if(!e)throw this._error("get","Invalid key");try{const n=this._getScopedRequest(e,t),i=yield this._cacheStorage.match(n);if(!i)throw this._error("get","Object not found");return i}catch(e){throw e instanceof DOMException&&this._logger.error(`DOMException name:${e.name}, message${e.message}`),this._error("get","Failed to get item from cache")}}))}delete(e,t){return(0,l.__awaiter)(this,void 0,void 0,(function*(){if(!e)throw this._error("get","Invalid key");this._logger.log(`deleting item from offline cache: ${e}`);const n=this._getScopedRequest(e,t);return this._cacheStorage.delete(n)}))}clear(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){return this._logger.log("clearing offline cache"),this._cacheStorage.clear(this._cacheName)}))}getCachedUrlByKey(e,t){return this._getScopedRequest(e,t).request.url}_error(e,t){const n=(0,Z.Tr)("OfflineCacheManager",S.jK.Undefined,e,void 0,t);return this._logger.error(n.message),n}_getScopedRequest(e,t){return this._cacheStorage.createRequest(this._cacheName,`${this._cacheName}/${e}`,S.fO.UserAndExperience,t)}}class Ia{constructor(){this.id=S.Yg.CreateCacheStorageAndOfflineCacheManager}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,windowProvider:n}=e;t&&(e.cacheStorage=new Ta(n.caches,t.profile.tenantId,t.profile.objectId,e.config.experienceName)),e.cacheStorage&&(e.offlineCacheManager=new Ea(e.cacheStorage,e.loggerFactory))}))}}const Na=e=>{const t=e.get(b.J.Host).enableSyncEngine;return(0,j.isNil)(t)?!!e.get(b.J.CdlWorker).enableSyncEngine:t},Aa=e=>{const t=e.get(b.J.Host).enableProfileManagerStore;return(0,j.isNil)(t)?!!e.get(b.J.People).enableProfileManagerStore:t};class Ma{constructor(e){this.logger=e}log(e,t){e&&this.safeWrapILoggerCall((e=>this.logger.log(e)),e,t)}warn(e,t){e&&this.safeWrapILoggerCall((e=>this.logger.warn(e)),e,t)}debug(e,t){this.safeWrapILoggerCall((e=>this.logger.debug(e)),e,t)}error(e,t,n){e&&n&&this.safeWrapILoggerCall((e=>this.logger.error(e)),e,t,n)}safeWrapILoggerCall(e,t,n,i){!function(e){return(0,j.isObject)(e)&&"hostRendererId"in e&&"component"in e}(n)?e(t):e(this.serializeMessageFromParams(t,n,i))}serializeMessageFromParams(e,t,n){const i=Object.assign(Object.assign(Object.assign(Object.assign({},n?{errorCode:n}:{}),t?{requestId:t.requestId,hostRendererId:t.hostRendererId,component:t.component}:{}),t),{message:e});return JSON.stringify(i,void 0,"")}}const Fa=(e,t,n,i)=>{let a={};return e&&(a={experienceName:e}),t&&(a=Object.assign(Object.assign({},a),{ring:t})),n&&(a=Object.assign(Object.assign({},a),{environment:n})),i&&(a=Object.assign(Object.assign({},a),{sessionId:i})),JSON.stringify(a)};var Ra,Pa=n(695185);class Da{constructor(e,t){this.logger=e,this.loggingContext=t,this.isCompleted=!1,this.subscriptions=new Set,this.observable$=new Pa((e=>(this.subscriptions.add(e),()=>{this.subscriptions.has(e)&&this.subscriptions.delete(e)})))}get observable(){return this.observable$}subscribe(e){return this.isCompleted&&this.logger.error("Subject - tried to subscibe to a complete observable",this.loggingContext,S.jK.NotPresent),this.observable$.subscribe(e)}onNext(e){this.subscriptions.forEach((t=>{t.next(e)}))}onComplete(){this.isCompleted=!0,this.subscriptions.forEach((e=>{e.closed||e.complete()}))}onError(e){this.isCompleted=!0,this.subscriptions.forEach((t=>{t.error(e)}))}}class ja{constructor(e){this._state=null,this._checkpoints=new Set,this._context={bootstrapServices:e.bootstrapServices,loggingContext:{hostRendererId:e.loggingContext.hostRendererId,component:"CDLGlobalState"}},this.subject=new Da(e.bootstrapServices.logger,this._context.loggingContext)}get current(){return this._state}setState(e,t){if(!e)throw new TypeError("state should have name specified");this.hasReachedCheckpoint(e)||(this._context.bootstrapServices.logger.log(`Global state has reached checkpoint ${e}`,this._context.loggingContext),this._checkpoints.add(e),this._state=e,this.subject.onNext({newState:e,args:t}))}subscribe(e){return this.subject.subscribe(e)}hasReachedCheckpoint(e){if(!e)throw new TypeError("state should have name specified");return this._checkpoints.has(e)}}!function(e){e.auth="auth",e.appService="appService",e.appState="appState",e.control="control",e.database="database",e.diagnostics="diagnostics",e.endpointHealth="endpointHealth",e.graphql="graphql",e.networkState="networkState",e.supportedResolvers="supportedResolvers",e.syncEngine="syncEngine",e.tenantSwitch="tenantSwitch"}(Ra||(Ra={}));class xa{constructor(e,t,n,i){var a;this._context=i,this._clients=new Map,t.forEach(((t,a)=>{const o=new t((t=>e(t)),n,i,a);this._clients.set(a,o)})),null===(a=i.bootstrapServices.workerCacheManager)||void 0===a||a.saveWorkerStatusToCacheStorage({state:"Success",stepName:"ClientResponseRouterCreated"})}get cdlControlClient(){return this._clients.get(Ra.control)}get cdlDiagnosticsClient(){return this._clients.get(Ra.diagnostics)}get cdlAuthClient(){return this._clients.get(Ra.auth)}get cdlAppServiceClient(){return this._clients.get(Ra.appService)}get cdlAppStateClient(){return this._clients.get(Ra.appState)}get cdlDatabaseClient(){return this._clients.get(Ra.database)}get cdlSyncEngineClient(){return this._clients.get(Ra.syncEngine)}get cdlGraphQLClient(){return this._clients.get(Ra.graphql)}get cdlNetworkStateClient(){return this._clients.get(Ra.networkState)}get cdlEndpointsHealthClient(){return this._clients.get(Ra.endpointHealth)}handleResponse(e){const t=this._clients.get(e.type);if(!t)throw this._context.bootstrapServices.logger.error(`no client is configured for response type ${e.type}`,Object.assign({requestId:e.requestId,requestRendererId:e.rendererId,requestWindowId:e.windowId,component:"CDLClientResponseRouter"},this._context.loggingContext),S.jK.Unknown),new TypeError(`no client is configured for response type ${e.type}`);return t.handleResponse(e)}}class Oa{constructor(e,t,n,i){var a;this._bootstrapServices=e,this._stateAndRequestHandlers=i,this._globalState=n,this._context={component:"CDLServer",hostRendererId:t},this._bootstrapServices.logger.log("Booted up server",this._context),null===(a=this._bootstrapServices.workerCacheManager)||void 0===a||a.saveWorkerStatusToCacheStorage({state:"Success",stepName:"CDLServerCreated"})}handleRequest(e,t,n){const i=performance.now(),a=this._stateAndRequestHandlers.get(e.type);return a?a.stateMachine.isCompleted().then((o=>{const r=performance.now(),s={requestStartTime:i,stateMachineTime:r-i};return this._handleMessage(e,t,a.requestHandler,s,n,o).catch((t=>this._bootstrapServices.logger.error(`Failed to process request due to error ${(0,Z.VK)(t)}`,Object.assign(Object.assign({},this._context),{requestId:e.requestId,requestRendererId:e.rendererId,requestWindowId:e.windowId,requestType:e.type}),S.jK.Unknown)))})).catch((n=>this._returnCriticalError(e,t,`State machine initialization failed for request of type ${e.type} with error ${(0,Z.VK)(n)}`,n.errorCode))):this._returnCriticalError(e,t,`StateMachine and requestHandler not defined for request of type ${e.type}`)}start(){this._globalState.setState("Server_Start")}_handleMessage(e,t,n,i,a,o){const r=this._decorateResponseCallback(e,t,i);return n.handle(e,r,{bootstrapServices:this._bootstrapServices,loggingContext:{hostRendererId:this._context.hostRendererId,requestId:e.requestId,requestRendererId:e.rendererId,requestWindowId:e.windowId,requestType:e.type},portId:a},o)}_decorateResponseCallback(e,t,n){return i=>{const a=performance.now()-n.requestStartTime,o=a-n.stateMachineTime;if(n=Object.assign(Object.assign({},n),{handlerResponseTime:o}),"graphql"===e.type){const n=i.response;n.extensions=Object.assign({},n.extensions),n.extensions.perfStats=Object.assign(Object.assign({},n.extensions.perfStats),{workerResponseTime:a}),t(Object.assign({requestId:e.requestId,rendererId:e.rendererId,windowId:e.windowId,type:e.type},i))}else t(Object.assign(Object.assign(Object.assign({requestId:e.requestId,rendererId:e.rendererId,windowId:e.windowId,type:e.type},i),n),{workerResponseTime:a}))}}_returnCriticalError(e,t,n,i){return Promise.reject(t({rendererId:e.rendererId,windowId:e.windowId,requestId:e.requestId,status:"failure",type:e.type,response:{errors:n,errorCode:i},workerResponseTime:-1}))}}function La(e,t,n,i){var a,o;null===(a=e.workerCacheManager)||void 0===a||a.saveWorkerStatusToCacheStorage({state:"InProgress",stepName:"CDLPeerCreated"});const r=new xa((e=>t.postMessageCallback(JSON.stringify(e))),t.clients,{rendererId:i},{bootstrapServices:e,loggingContext:{hostRendererId:i}}),s=new Oa(e,i,n.globalState,n.requestAndStateHandlers);return null===(o=e.workerCacheManager)||void 0===o||o.saveWorkerStatusToCacheStorage({state:"Success",stepName:"CDLPeerCreated"}),{workerServer:s,workerClientResponseRouter:r,onMessageCallback:(t,n,a)=>{const o=t.data&&JSON.parse(t.data);o&&o.rendererId===i?r.handleResponse(o):o&&o.status?e.logger.error(`Received response with rendererId mismatch ${JSON.stringify(t)}`,{component:"CDLPeer",hostRendererId:i},S.jK.Unknown):o?s.handleRequest(o,(e=>{return t=e,n(JSON.stringify(t));var t}),a):e.logger.error(`Unknown message received that doesn't conform to CDL format ${JSON.stringify(t)}`,{component:"CDLPeer",hostRendererId:i},S.jK.Unknown)}}}var Ua=n(273350);class Ba{constructor(){this._rendererRequestMap=new Map}addRequest(e){if(!e.rendererId)throw new TypeError("No rendererId in request");if(!e.requestId)throw new TypeError("No requestId in request");const t=this.getRequestRegistrationKey(e);let n=this._rendererRequestMap.get(t);if(n||(n=new Map,this._rendererRequestMap.set(t,n)),n.has(e.requestId))throw new Error(`Request ${e.requestId} for renderer ${t} already exists, somthing is off here`);const i=(0,Ua.P)();return n.set(e.requestId,i),i.promise}reconcileResponse(e){if(!e.rendererId)throw new TypeError("No rendererId in response");if(!e.requestId)throw new TypeError("No requestId in response");const t=this.getRequestRegistrationKey(e);if(!this._rendererRequestMap.has(t))throw new Error(`Response ${t} is not found in map`);const n=this._rendererRequestMap.get(t);if(!n)throw new Error(`Request map for renderer/window ${t} does not exist`);const i=n.get(e.requestId);if(!i)throw new Error(`Request ${e.requestId} for renderer/window ${t} does not exist`);"success"===e.status?i.resolve(e):i.reject(e),n.delete(e.requestId),0===n.size&&this._rendererRequestMap.delete(t)}getRequestRegistrationKey(e){return`${e.rendererId}${e.windowId?`_${e.windowId}`:""}`}}class Wa{constructor(e){this.requestType=e,this.counter=0}toString(){return`${this.getOperationPrefix(this.currentCounterRequestType)||this.requestType}-${this.counter}`}next(e){return this.safeIncrementCounter(),this.currentCounterRequestType=e,this.toString()}getOperationPrefix(e){switch(e){case"mutation":return"m";case"subscription":return"s";case"query":return"q";default:return e}}safeIncrementCounter(){return this.counter===Wa.MAX_COUNTER_VALUE&&(this.counter=0),this.counter++}}Wa.MAX_COUNTER_VALUE=Number.MAX_SAFE_INTEGER;class Ha{constructor(e,{rendererId:t,windowId:n},i,a){this._context=i,this._loggingContext={component:"CDLClient",hostRendererId:t,requestWindowId:n},this._rendererId=t,this._windowId=n,this._clientRequestType=a,this._postMessage=t=>e(t),this._requestRegistrar=new Ba,this.requestId=new Wa(a)}sendRequest(e){const t={rendererId:this._rendererId,windowId:this._windowId,requestId:this.requestId.next(),type:this._clientRequestType,payload:e},n=this._requestRegistrar.addRequest(t);return this._postMessage(t),n}handleResponse(e){return new Promise(((t,n)=>{try{this._requestRegistrar.reconcileResponse(e),t()}catch(t){this._context.bootstrapServices.logger.error(`Error occured on reconciling response ${t}`,Object.assign(Object.assign({},this._loggingContext),{requestId:e.requestId,requestRendererId:e.rendererId,requestWindowId:e.windowId}),S.jK.Unknown),n(t)}}))}}const $a="MainRenderer",Va="GQL_STOP";class za extends Ha{constructor(e,{rendererId:t,windowId:n},i,a){super(e,{rendererId:t,windowId:n},i,a)}sendFilteredAppStateRequest(e){const t=e.context.appState;return this._rendererId===$a&&(e.context.appState=this.filterWorkerAppState(t)),super.sendRequest(e)}filterWorkerAppState(e){return e}}class Ga{constructor(){this.onResponseReceived=e=>{if(this.onMessage){const t=this.transformLegacyClientFields(e.payload.dataLayer);this.onMessage(t)}}}transformLegacyClientFields(e){return e.error&&(e.errors=e.error),e.extensions||(e.extensions={}),e.perfStats&&(e.extensions.perfStats=e.perfStats),e}}class qa extends Ga{constructor(e,{rendererId:t,windowId:n},i,a){super(),this._context=i,this._loggingContext={hostRendererId:t,component:"CDLClient",requestWindowId:n},this.sendMessage=t=>e({requestId:t.requestId,rendererId:t.rendererId,windowId:t.windowId,payload:t.request,type:a,cdlOperationCustomContext:t.cdlOperationCustomContext})}handleResponse(e){var t;return this._context.bootstrapServices.logger.debug("Received message",Object.assign(Object.assign({},this._loggingContext),{requestId:e.requestId,requestRendererId:e.rendererId,requestWindowId:e.windowId})),Promise.resolve(this.onResponseReceived({payload:{dataLayer:{rendererId:e.rendererId,requestId:e.requestId,windowId:e.windowId,data:e.response.data,errors:e.response.errors?e.response.errors:void 0,errorCode:null===(t=e.response)||void 0===t?void 0:t.errorCode,extensions:e.response.extensions}}}))}}class Ja{constructor(e,t,n,i){this._completionAwaiter=(0,Ua.P)(),this._context={bootstrapServices:i.bootstrapServices,loggingContext:Object.assign({component:"CDLStateMachine"},i.loggingContext)},this._actionStateMap=t,this._globalState=e,this._currentState=e.current,this._globalState.hasReachedCheckpoint(n)?this._transitionToNextState(n):this._subscribeToGlobalState()}isCompleted(){return this._completionAwaiter.promise}errorStateMachine(e){this._unsubscribeStateTransition&&this._unsubscribeStateTransition.unsubscribe(),this._completionAwaiter.reject(e),e&&e.code===S.jK.Disabled?this._context.bootstrapServices.logger.log(e.message,this._context.loggingContext):this._context.bootstrapServices.logger.error(`State machine is erroring out: ${(0,Z.VK)(e)}`,this._context.loggingContext,S.jK.Unknown)}completeStateMachine(e){this._unsubscribeStateTransition&&this._unsubscribeStateTransition.unsubscribe(),this._completionAwaiter.resolve(e),this._context.bootstrapServices.logger.log("State machine is reaching completion",this._context.loggingContext)}execute(e,t,n){const i=e,a=this._actionStateMap.get(i);if(!a)return this._context.bootstrapServices.logger.log(`State machine is transitioning from ${this._currentState} to ${e}, skipping action invoke as none is defined`,this._context.loggingContext),this._emitState(e,n);this._context.bootstrapServices.logger.log(`State machine is invoking action for transition state ${this._currentState} to ${e}`,this._context.loggingContext),a.action(t,n).then((t=>{this._context.bootstrapServices.logger.log(`State machine is transitioning from ${this._currentState} to ${e}`,this._context.loggingContext),this._emitState(e,t)})).catch((e=>{this.errorStateMachine(e)}))}_transitionToNextState(e,t){this._currentState=e,this.transitionState(e,t)}_subscribeToGlobalState(){this._unsubscribeStateTransition=this._globalState.subscribe({next:e=>{const{newState:t,args:n}=e;this._transitionToNextState(t,n)}})}_emitState(e,t){this._globalState.hasReachedCheckpoint(e)?this._transitionToNextState(e,t):(this._unsubscribeStateTransition||this._subscribeToGlobalState(),this._globalState.setState(e,t))}}class Ka extends Ja{transitionState(e,t){switch(e){case"authLoaded":this.execute("authServiceInjected",t,void 0);break;case"authServiceInjected":this.completeStateMachine(!0)}}}class Qa extends Ja{transitionState(e,t){switch(e){case"appService:Loaded":this.execute("appService:Injected",t,void 0);break;case"appService:Injected":this.completeStateMachine(!0)}}}class Ya{constructor(e){this._componentName=e,this._handlerMap=new Map}addHandlers(e){e.forEach((e=>{this._handlerMap.set(e.requestType,e.handlerFunc)}))}handle(e,t,n,...i){const a=e.payload;return new Promise(((e,o)=>{const r=this._handlerMap.get(a.requestOperationtype);if(!r){n.bootstrapServices.logger.error(`No handler found for request type ${a.requestOperationtype}`,Object.assign({component:this._componentName},n.loggingContext),S.jK.NotImplemented);const e={statusMsg:`Unknown request type: ${a.requestOperationtype}`,data:void 0},i=this._constructResponseMessage(e,"failure");return t(i),o(i)}r(a,n,...i).then((n=>e(t(this._constructResponseMessage(n,"success"))))).catch((e=>{const n=this._constructResponseMessage(e,"failure");return t(n),o(n)}))}))}_constructResponseMessage(e,t){e&&"function"==typeof e.toString&&e instanceof Error&&(e=e.toString());return{status:t,response:e}}static onHandlerError(e,t,n,i,a){e.bootstrapServices.logger.error(n,Object.assign({component:a},e.loggingContext),t);const o={statusMsg:i,data:void 0};return Promise.reject(o)}}var Xa,Za,eo,to;!function(e){e.AadGetToken="aadGetToken",e.AadGetCurrentUser="aadCurrentUser",e.AadClearCache="aadClearCache",e.StartupApiToken="startupApiToken",e.GetSkypeTokens="getSkypeTokens",e.GetUserDetails="getUserDetails"}(Xa||(Xa={}));class no{constructor(e){this._requestUtility=new Ya("CDLAuthHandler");let t=[];t=e===$a?[{requestType:Xa.AadGetToken,handlerFunc:no.getAadTokensAngular},{requestType:Xa.AadGetCurrentUser,handlerFunc:no.getUserInformationAngular},{requestType:Xa.GetSkypeTokens,handlerFunc:no.getSkypeTokensAngular},{requestType:Xa.GetUserDetails,handlerFunc:no.getUserDetailsAngular}]:[{requestType:Xa.AadGetToken,handlerFunc:no.getAadTokens},{requestType:Xa.AadGetCurrentUser,handlerFunc:no.getUserInformation},{requestType:Xa.GetSkypeTokens,handlerFunc:no.getSkypeTokens},{requestType:Xa.GetUserDetails,handlerFunc:no.getUserDetails}],this._requestUtility.addHandlers(t)}injectDependentServices(e){return new Promise((t=>{if(!e)throw new TypeError("Cannot injectDependentServices of undefined");if("function"==typeof e.getAuthTokens&&(e={authenticationService:e,discover:void 0}),!e.authenticationService)throw new TypeError("Cannot inject authentication service that is not defined");if(this._authenticationService)throw new TypeError("injectDependentServices has been called again, even though it's already initialized");return this._authenticationService=e.authenticationService,this._discover||(this._discover=e.discover),t()}))}handle(e,t,n){return this._requestUtility.handle(e,t,n,this._authenticationService,this._discover)}static convertAngularPromise(e){return new Promise(((t,n)=>{e.then((e=>t(e))).catch((e=>n(e)))}))}static handleAuthResult(e,t,n){const i=t.bootstrapServices.newScenario(A.RG.AuthHandlerRequest);return i.appendEventData({operation:n}),e.then((e=>{if(null==e){const e="response payload is empty";throw i.fail({message:e}),new Error(e)}const t={statusMsg:`${n} request in main renderer has been processed`,data:e};return i.stop(),t})).catch((e=>{const a=`the request type for ${n} failed due to ${(0,Z.VK)(e)}`;throw Ya.onHandlerError(t,S.jK.UnhandledPromiseRejection,"the auth handler has exception",a,"CDLAuthHandler"),e.isExpected?i.incomplete({message:a}):i.fail({message:a}),e}))}static getAadTokensAngular(e,t,n){const i=e.context.resource;return no.logStartHandle(e,t,i),no.handleAuthResult(no.convertAngularPromise(n.getAuthTokens([i])),t,Xa.AadGetToken)}static getAadTokens(e,t,n){const i=e.context.resource;return no.logStartHandle(e,t,i),no.handleAuthResult(n.acquireToken(i),t,Xa.AadGetToken)}static getUserInformationAngular(e,t,n){return no.logStartHandle(e,t),no.handleAuthResult(no.convertAngularPromise(n.getUserInformation()),t,Xa.AadGetCurrentUser)}static getUserDetailsAngular(e,t,n){return no.logStartHandle(e,t),no.handleAuthResult(no.convertAngularPromise(n.getUserDetails()),t,Xa.GetUserDetails)}static getUserDetails(e,t,n,i){var a;return(0,l.__awaiter)(this,void 0,void 0,(function*(){no.logStartHandle(e,t);const n=yield i.getSkypeTokenInfoFromDiscoveryResponse({forceRenew:!!(null===(a=e.context)||void 0===a?void 0:a.forceRenew)}),o={userDetails:n.userDetails,id:n.userDetails.id};return no.handleAuthResult(Promise.resolve(o),t,Xa.GetUserDetails)}))}static getSkypeTokensAngular(e,t,n){var i;return no.logStartHandle(e,t),no.handleAuthResult(n.getSkypeTokens(!!(null===(i=e.context)||void 0===i?void 0:i.forceRenew)),t,Xa.GetSkypeTokens)}static getSkypeTokens(e,t,n,i){var a;return no.logStartHandle(e,t),no.handleAuthResult(i.getSkypeTokenInfoFromDiscoveryResponse({forceRenew:!!(null===(a=e.context)||void 0===a?void 0:a.forceRenew)}),t,Xa.GetSkypeTokens)}static getUserInformation(e,t,n){return no.logStartHandle(e,t),no.handleAuthResult(n.getUser(),t,Xa.AadGetCurrentUser)}static logStartHandle(e,t,n){const i=n?` for resource ${n}`:"";t.bootstrapServices.logger.log(`Auth handler started serving request ${e.requestOperationtype}${i}`,Object.assign({component:"CDLAuthHandler"},t.loggingContext))}}!function(e){e.MachineActive="MachineActive",e.MachineInactive="MachineInactive",e.MachineLongInactive="MachineLongInactive",e.MachineLocked="MachineLocked"}(Za||(Za={})),function(e){e.NotifyAppState="NotifyAppState",e.NotifyCoreClientState="NotifyCoreClientState",e.NotifyCoreMachineState="NotifyCoreMachineState",e.NotifyServiceUp="NotifyServiceUp",e.NotifyServiceDown="NotifyServiceDown"}(eo||(eo={})),function(e){e[e.ChatSync=0]="ChatSync",e[e.Presence=1]="Presence",e[e.Files=2]="Files",e[e.OneNote=3]="OneNote",e[e.Groups=4]="Groups",e[e.Video=5]="Video",e[e.MasterTab=6]="MasterTab",e[e.IndexDb=7]="IndexDb",e[e.AdalTokens=8]="AdalTokens",e[e.AdalLogin=9]="AdalLogin",e[e.AdalReauth=10]="AdalReauth",e[e.SkypeTokens=11]="SkypeTokens",e[e.SkypeLicense=12]="SkypeLicense",e[e.SupportedBrowser=13]="SupportedBrowser",e[e.MSAGuestLicense=14]="MSAGuestLicense",e[e.AppSession=15]="AppSession",e[e.CSAStartup=16]="CSAStartup"}(to||(to={}));class io{constructor(){this._requestUtility=new Ya("CDLAppServiceHandler");const e=[{requestType:eo.NotifyServiceUp,handlerFunc:io.notifyServiceUp},{requestType:eo.NotifyServiceDown,handlerFunc:io.notifyServiceDown}];this._requestUtility.addHandlers(e)}injectAppState(e){return new Promise((t=>{if(this.appService)throw new TypeError("injectAppStateService has been called again, even though it's already initialized");return this.appService=e,t()}))}handle(e,t,n){return this._requestUtility.handle(e,t,n,this.appService)}static notifyServiceUp(e,t,n){return new Promise((i=>{t.bootstrapServices.logger.log(`App service change is received, ${e.context.appService} is up and running`,Object.assign({component:"CDLAppStateHandler"},t.loggingContext));const{appService:a,reason:o}=e.context;return n.notifyServiceUp(a,o),i()}))}static notifyServiceDown(e,t,n){return new Promise((i=>{t.bootstrapServices.logger.log(`App service change is received, ${e.context.appService} is down`,Object.assign({component:"CDLAppStateHandler"},t.loggingContext));const{appService:a,reason:o,code:r}=e.context;return n.notifyServiceDown(a,o,r),i()}))}}class ao{handle(e,t,n){return new Promise((i=>{var a;n.bootstrapServices.logger.log(`Network state received from CDL worker. Network state: ${e.payload.networkState}`,Object.assign({component:"NetworkStateHandler"},n.loggingContext)),null===(a=this.networkStateChangeHandler)||void 0===a||a.next(e.payload.networkState);i(t({response:{statusMsg:"Network state received success.",data:void 0},status:"success"}))}))}injectNetworkStateTracker(e){return new Promise((t=>{if(this.networkStateChangeHandler)throw new TypeError("injectNetworkStateTracker has been called again, even though it's already initialized");return this.networkStateChangeHandler=e,t()}))}}class oo extends Ja{transitionState(e,t){switch(e){case"networkStateService:Loaded":this.execute("networkStateService:Injected",t,void 0);break;case"networkStateService:Injected":this.completeStateMachine(!0)}}}class ro{constructor(){this._componentName="EndpointsHealthMessageHandler"}handle(e,t,n){return new Promise((i=>{var a,o;(!e.payload||void 0===e.payload.healthState&&void 0===e.payload.endpointHealth)&&(this.log("Endpoints health message received from CDL. Payload is empty.",n),i(t(this.getSuccessMessage()))),e.payload.endpointHealth&&(this.log(`Endpoints health message received from CDL. Update: ${JSON.stringify(e.payload.endpointHealth)}.`,n),null===(a=this.endpointsHealthUpdateHandler)||void 0===a||a.handleEndpointHealthUpdate(e.payload.endpointHealth),i(t(this.getSuccessMessage()))),e.payload.healthState&&(this.log("Endpoints state dump message received from CDL.",n),null===(o=this.endpointsHealthUpdateHandler)||void 0===o||o.handleStateDump(e.payload.healthState),i(t(this.getSuccessMessage())))}))}injectEndpointsHealthUpdateHandler(e){return new Promise((t=>{if(this.endpointsHealthUpdateHandler)throw new TypeError("injectEndpointsHealthUpdateHandler has been called again, even though endpointsHealthUpdateHandler is already initialized");return this.endpointsHealthUpdateHandler=e,t()}))}log(e,t){t.bootstrapServices.logger.log(e,Object.assign({component:this._componentName},t.loggingContext))}getSuccessMessage(){return{response:{statusMsg:"Endpoints health received success.",data:void 0},status:"success"}}}class so extends Ja{transitionState(e,t){switch(e){case"endpointsHealthUpdateHandler:Loaded":this.execute("endpointsHealthUpdateHandler:Injected",t,void 0);break;case"endpointsHealthUpdateHandler:Injected":this.completeStateMachine(!0)}}}function lo(e,t,n){const{authStateMachine:i,authHandler:a}=co(e,t,n),{appServiceStateMachine:o,appServiceMessageHandler:r}=uo(e,t,n),{networkStateHandlerStateMachine:s,networkStateHandler:l}=mo(e,t,n),{endpointsHealthHandlerStateMachine:c,endpointsHealthHandler:d}=po(e,t,n);return new Map([[Ra.auth,{stateMachine:i,requestHandler:a}],[Ra.appService,{stateMachine:o,requestHandler:r}],[Ra.networkState,{stateMachine:s,requestHandler:l}],[Ra.endpointHealth,{stateMachine:c,requestHandler:d}]])}const co=(e,t,n)=>{const i=new no(t),a={action:i.injectDependentServices.bind(i)},o=new Map;o.set("authServiceInjected",a);return{authHandler:i,authStateMachine:new Ka(n,o,"authLoaded",{bootstrapServices:e,loggingContext:{hostRendererId:t,requestType:"auth"}})}},uo=(e,t,n)=>{const i=new io,a={action:i.injectAppState.bind(i)},o=new Map;o.set("appService:Injected",a);return{appServiceMessageHandler:i,appServiceStateMachine:new Qa(n,o,"appService:Loaded",{bootstrapServices:e,loggingContext:{hostRendererId:t,requestType:"appService"}})}},mo=(e,t,n)=>{const i=new ao,a={action:i.injectNetworkStateTracker.bind(i)},o=new Map;o.set("networkStateService:Injected",a);return{networkStateHandler:i,networkStateHandlerStateMachine:new oo(n,o,"networkStateService:Loaded",{bootstrapServices:e,loggingContext:{hostRendererId:t,requestType:Ra.networkState}})}},po=(e,t,n)=>{const i=new ro,a={action:i.injectEndpointsHealthUpdateHandler.bind(i)},o=new Map;o.set("endpointsHealthUpdateHandler:Injected",a);return{endpointsHealthHandler:i,endpointsHealthHandlerStateMachine:new so(n,o,"endpointsHealthUpdateHandler:Loaded",{bootstrapServices:e,loggingContext:{hostRendererId:t,requestType:Ra.endpointHealth}})}};function go(){return new SharedWorker("/statics/teams-modular-packages/hashed-assets/precompiled-shared-worker-6d629b1944e69392.js")}function ho(){return new Worker("/statics/teams-modular-packages/hashed-assets/precompiled-web-worker-26819d665c6d81af.js")}var vo=n(9654);const fo=120*vo.gT.MILLI_PER_SECOND;function yo(e,t,n,i,a,o,r,s,l){var c;let d;const u=function(){const e=new Map;return e.set(Ra.appState,za),e.set(Ra.control,Ha),e.set(Ra.database,Ha),e.set(Ra.diagnostics,Ha),e.set(Ra.endpointHealth,Ha),e.set(Ra.graphql,qa),e.set(Ra.networkState,Ha),e.set(Ra.syncEngine,Ha),e.set(Ra.supportedResolvers,Ha),e}();return null===(c=e.workerCacheManager)||void 0===c||c.saveWorkerStatusToCacheStorage({state:"InProgress",stepName:"CreateCDLWorker"}),d=n?function(e,t,n,i,a,o,r,s,l){if(s){_o(e,s,!0);const l=new SharedWorker(s);return So(e,i,a,r,t,n,(e=>l.port.postMessage(e)),(e=>{l.port.onmessage=t=>e(t,(e=>l.port.postMessage(e)))}),(e=>{l.onerror=t=>e(t)}),o)}const c=SharedWorker;SharedWorker=bo(c,e,Fa(null==l?void 0:l.experienceName,null==l?void 0:l.ring,null==l?void 0:l.environment,null==l?void 0:l.sessionId));const d=new go;return SharedWorker=c,So(e,i,a,r,t,n,(e=>d.port.postMessage(e)),(e=>{d.port.onmessage=t=>e(t,(e=>d.port.postMessage(e)))}),(e=>{d.onerror=t=>e(t)}),o)}(e,t,u,i,a,o,r,s&&s.cdlSharedWorkerUrl,l):function(e,t,n,i,a,o,r,s,l){if(s){_o(e,s,!0);const l=new Worker(s);return So(e,i,a,r,t,n,(e=>l.postMessage(e)),(e=>{l.onmessage=t=>e(t,(e=>l.postMessage(e)))}),(e=>{l.onerror=t=>e(t)}),o)}const c=Worker;Worker=bo(c,e,Fa(null==l?void 0:l.experienceName,null==l?void 0:l.ring,null==l?void 0:l.environment,null==l?void 0:l.sessionId));const d=new ho;return Worker=c,So(e,i,a,r,t,n,(e=>d.postMessage(e)),(e=>{d.onmessage=t=>e(t,(e=>d.postMessage(e)))}),(e=>{d.onerror=t=>e(t)}),o)}(e,t,u,i,a,o,r,s&&s.cdlWebWorkerUrl,l),d}function So(e,t,n,i,a,o,r,s,c,d){return new Promise(((u,m)=>(0,l.__awaiter)(this,void 0,void 0,(function*(){const p={hostRendererId:a,component:"CDLWorker"},g=new ja({bootstrapServices:e,loggingContext:p});g.setState("bootstrapped");const h=La(e,{postMessageCallback:e=>r(e),clients:o},{globalState:g,requestAndStateHandlers:lo(e,a,g)},a);h.workerServer.start(),s(((e,t)=>h.onMessageCallback(e,t,-1))),c((t=>{m(ko(t,e,p))}));const v={workerServer:h.workerServer,workerClientResponseRouter:h.workerClientResponseRouter,state:g,syncEngineInitializationPromise:d};v.state.setState("loaded");try{yield function(e,t,n,i){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{response:a}=yield(0,le.E)(t.workerClientResponseRouter.cdlControlClient.sendRequest({type:"health_check",bootstrapData:i,initiatorExperience:n}),e);t.cdlWorkerSessionId=a.cdlWorkerSessionId,t.cdlWorkerSupportedResolvers=a.cdlWorkerSupportedResolvers,t.state.setState("health_checked")}))}(t||fo,v,n,i)}catch(t){m(ko(t,e,p))}u(v)}))))}function ko(e,{logger:t,workerCacheManager:n},i){const a=(0,Z.Tr)(S.w5.DataLayerClient,S.jK.ScriptLoadError,(0,Z.VK)(e.message),void 0,`Uncaught exception in Worker: ${(0,Z.VK)(e.message)}`);return t.error(a.message,i,a.code),null==n||n.saveWorkerStatusToCacheStorage({state:"Failure",stepName:"CDLWorkerOnError",error:(0,Z.VK)(a)}),a}const bo=(e,t,n)=>class{constructor(i){const a=n?`${i}#${n}`:i;return _o(t,a,!1),new e(a)}};function _o(e,t,n){e.logger.log(`Creating CDL Worker with ${n?"passed":"determined"} url ${t}`,{hostRendererId:e.hostRendererId,component:"CDLWorkerManager"})}const Co=(e,t,n,i,a,o,r,s)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const c=n.newScenario(A.RG.CentralDataLayerWorkerManagerStartup);c.appendEventData({origin:o});const d="electron"===t||"sharedworker"===t;try{const t=(0,Ua.P)(),u=yield yo(n,e,d,a,o,t.promise,r,i,s);return c.appendEventData({newState:A.ck.CdlWorkerManagerLoaded}),c.appendEventData({newState:A.ck.CdlWorkerManagerHealthChecked,searchSessionId:u.cdlWorkerSessionId}),u.state.setState("initialized"),c.mark("CDLWorkerManagerInitialized"),function(e,t,n,i,a){(0,l.__awaiter)(this,void 0,void 0,(function*(){const o=wo(n);try{const{response:n}=yield e.workerClientResponseRouter.cdlSyncEngineClient.sendRequest({type:"startup_info",subType:"Messaging",params:void 0}),r=n;if(r&&"string"!=typeof r&&"error"===r.type){const e="string"==typeof r.details?r.details:JSON.stringify(r.details);throw t.logger.warn(`Sync engine for Messaging strategy: ${e}`,o),new Error(e)}a.resolve(!0),e.state.setState("syncEngine:Initialized"),i.stop()}catch(n){const r=`Failed to initialize sync engine :: err: ${(0,Z.VK)(n)}`,s=n.code||S.jK.Unknown,l={errors:r,errorCode:s};t.logger.error(r,o,s),i.fail(l),e.state.setState("syncEngine:FailedToInitialize"),a.resolve(!1)}}))}(u,n,e,c,t),u}catch(t){throw yield function(e,t,n,i,a){var o,r;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const s=a?"shared-worker":"web-worker",l=yield null===(o=t.workerCacheManager)||void 0===o?void 0:o.getWorkerStartupStatus(s),c=`Failed to initialize CDL Worker :: err: ${(0,Z.VK)(e)}`,d=`WorkerStartupStatus: ${l?JSON.stringify(l):"Unable to get CDL worker startup status"}`,u=`${c} :: ${d}`,m=wo(n),p=(0,Z.Tr)("CDLWorkerManager",S.jK.Unknown,JSON.stringify(m),void 0,u);t.logger.error(c,m,p.code),t.logger.error(d,m,p.code);const g={errors:u,errorCode:t.workerCacheManager?p.code:S.jK.NotInitialized};return e&&e.code===S.jK.TimedOut?i.stop(g,"timeout"):i.fail(g),null===(r=t.workerCacheManager)||void 0===r||r.saveWorkerStatusToCacheStorage({state:"Failure",stepName:"CreateCDLWorker",error:u}),p}))}(t,n,e,c,d)}}));function wo(e){return{hostRendererId:e,component:"CDLWorkerManager"}}const To="cdl-worker-startup-status";class Eo{constructor(e,t){this._cacheStorage=e,this._cacheName="cdl-worker-cache-manager",this._logger=t}save(e,t,n){return(0,l.__awaiter)(this,void 0,void 0,(function*(){try{if(!e)throw this._error("get","Invalid key");const i=JSON.stringify(t);this._logger.log(`[CDLWorkerCacheManager]: Saving item to ${this._cacheName} cache: ${e} data ${i}`);const a=new Response(i),o=this._getScopedRequest(e,n);return yield this._cacheStorage.put(o,a),o.request.url}catch(e){const t=this._error("save",`[CDLWorkerCacheManager]: Failed to save object to cache, err: ${(0,Z.VK)(e)}`);return this._logger.error((0,Z.VK)(t)),null}}))}get(e,t,n){return(0,l.__awaiter)(this,void 0,void 0,(function*(){try{if(!e)throw this._error("get","Invalid key");const i=this._getScopedRequest(e,t,n),a=yield this._cacheStorage.match(i);if(!a||!a.body)throw this._error("get","Object not found");return yield a.json()}catch(e){const t=this._error("get",`[CDLWorkerCacheManager]: Failed to get item from cache, err: ${(0,Z.VK)(e)}`);return this._logger.error((0,Z.VK)(t)),null}}))}delete(e,t){return(0,l.__awaiter)(this,void 0,void 0,(function*(){try{if(!e)throw this._error("get","Invalid key");this._logger.log(`[CDLWorkerCacheManager]: Deleting item from cdl worker cache: ${e}`);const n=this._getScopedRequest(e,t);return this._cacheStorage.delete(n)}catch(e){const t=this._error("delete",`[CDLWorkerCacheManager]: Failed to delete item from cache, err: ${(0,Z.VK)(e)}`);return this._logger.error((0,Z.VK)(t)),!1}}))}clear(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){try{return this._logger.log("[CDLWorkerCacheManager]: Clearing cdl-worker cache"),this._cacheStorage.clear(this._cacheName)}catch(e){const t=this._error("clear",`[CDLWorkerCacheManager]: Failed to clear the cache: ${this._cacheName}, err: ${(0,Z.VK)(e)}`);return this._logger.error((0,Z.VK)(t)),!1}}))}getCachedUrlByKey(e,t){return this._getScopedRequest(e,t).request.url}saveWorkerStatusToCacheStorage(e){var t;return(0,l.__awaiter)(this,void 0,void 0,(function*(){return this.save(To,{state:e.state,stepName:e.stepName,error:null!==(t=e.error)&&void 0!==t?t:""})}))}getWorkerStartupStatus(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){return this.get(To,void 0,e)}))}_error(e,t){return(0,Z.Tr)("CDLWorkerCacheManager",S.jK.Undefined,e,void 0,t)}_getScopedRequest(e,t,n){return this._cacheStorage.createRequest(this._cacheName,`${this._cacheName}/${e}`,S.fO.Experience,t,!0,n)}}const Io=(e,t)=>{try{const n=new Eo(new Ta(caches,"","",e),t);return n.delete(To),n}catch(e){return void t.error(`[createCDLWorkerCacheManager]: Error occurred while creating CDLWorkerCacheManager: ${(0,Z.VK)(e)}`)}};function No(e,t,n,i,a,o,r,s,c,d,u,m){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const p=Fo(d,o),g=Po(o,e,a,u),h=Mo(d,o,a,e,u);!function(e,t,n,i){i.log(`Initializing workerType ${e} ${t?"as Worker host":`as non-Worker host with sharedWorkerUrl ${n}`}`)}(p,h,g,u);try{let e;h&&(e=yield function(e,t,n,i,a,o,r,s){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const c=yield function(e,t,n){return(0,l.__awaiter)(this,void 0,void 0,(function*(){let i,a;try{i=yield e.getUser()}catch(e){n.error("Worker bootstrap authentication error - cannot authenticationService.getUser")}if(!i)return{};try{a=yield t.getUser()}catch(e){n.error("Worker bootstrap authentication error - cannot discover.getUser")}if(!a)return{userInformation:i};return{userInformation:i,userDetails:{userDetails:a,id:null==a?void 0:a.id}}}))}(e,n,r);return{hostSettings:Ro(t,i,a,o,s),auth:c}}))}(s,n,c,o,r,d,u,m));return yield function(e,t,n,i,a,o,r,s){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{ring:l,environment:c}=s.get(b.J.Metadata),{sessionId:d}=s.get(b.J.Platform),u=c?(0,j.get)(he.s,c):void 0;return Co(e,t,{logger:new Ma(o.newLogger("CDL:DataClientCoreWorkerManager")),newScenario:(e,t,n)=>r.newScenario(e,{callback:n,timeoutMs:t}),workerCacheManager:Io(i,o.newLogger("CDL:DataClientCoreWorkerManager")),hostRendererId:e},n?{cdlSharedWorkerUrl:n,cdlWebWorkerUrl:""}:void 0,void 0,i,a,{experienceName:i,ring:(null==l?void 0:l.id)||void 0,environment:u,sessionId:d||void 0})}))}(t.clientId,p,g,t.experienceName,e,i,a,o)}catch(e){return void u.error(`Failed to start CDL Worker from DataClientCore: ${(0,Z.VK)(e)}`)}}))}function Ao(e,t,n,i,a,o,r,s){return(0,l.__awaiter)(this,void 0,void 0,(function*(){if(Mo(o,n,t,e,r)){const e=yield s.getCDLWorkerManager();null==e||e.state.setState("authLoaded",{authenticationService:i,discover:a}),function(e,t,n,i){if(!t.get(b.J.CdlWorker).enableCleanUpOnLogout)return;if(!e.registerCleanUpOnLogoutCallback)return void i.error("Cannot register for Worker cleanup on logout. Method unavailable.");e.registerCleanUpOnLogoutCallback((e=>n.logoutCurrentUser(t)))}(i,n,s,r)}}))}const Mo=(e,t,n,i,a)=>{const o=Fo(e,t),r=Po(t,i,n,a);return"webworker"===o||"web"===o||!r};function Fo(e,t){let n=e.config.clientType===si.Bh.Web?"webworker":"sharedworker";const i=t.get(b.J.Host).cdlWorkerType,a=t.get(b.J.CdlWorker).cdlWorkerType;return i?n=i:a&&(n=a),n}function Ro(e,t,n,i,a){var o;const{enableNetworkStateCommsBetweenCoreAndWorker:r}=t.get(b.J.Core);let s=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({enableNetworkStateCommsBetweenCoreAndWorker:!!r,policiesNamespaces:e("policies").namespaces||[],enableSyncEngine:Na(t),enableProfileManagerStore:Aa(t),imageCookieAuthEnabled:!t.get(b.J.Auth).skipAmsAuthRequest,msgEnableChannelsV2:!!t.get(b.J.Host).msgEnableChannelsV2,msgEnableChannelsV2Header:!!t.get(b.J.Host).msgEnableChannelsV2Header,enableHybridChannelList:!!t.get(b.J.Host).enableHybridChannelList,enableEspInWorker:!!t.get(b.J.Esp).enableEsp,desktopVersion:i.host.hostAppVersion,locale:a||S.ZW,userType:t.get(b.J.Host).userType||"",windowsInsiderChannel:t.get(b.J.Host).windowsInsiderChannel},function(e){const{enableClassBasedErrors:t,enablePoliciesSyncEngine:n,enableAppsPlatformSyncEngine:i,enableUserPreferencesWorkerFetch:a,enableOpenWindowsSettingsMaglev:o,enableChatWithUserNetworkFetch:r,enableOfflineActionsSyncEngine:s}=e.get(b.J.CdlWorker);return{enableClassBasedErrors:!!t,enablePoliciesSyncEngine:!!n,enableOpenWindowsSettingsMaglev:!!o,enableUserPreferencesWorkerFetch:!!a,enableAppsPlatformSyncEngine:!!i,enableChatWithUserNetworkFetch:!!r,enableOfflineActionsSyncEngine:!!s}}(t)),function(e){const{enableActivityManagerStore:t,enableActivityBellCount:n,paginationFirstLoad:i,maxActivityFeedLatency:a,clientStableBufferTimeForAPT:o}=e.get(b.J.Activity);return{enableActivityManagerStore:!!t,enableActivityBellCount:!!n,feedItemsCountOnAppLoad:i||0,maxActivityFeedLatency:a||0,clientStableBufferTimeForAPT:o||0}}(t)),function(e){const{enableWorkerEndpointsHealthMonitor:t,enableWorkerEndpointsHealthService:n}=e.get(b.J.Core);return{enableWorkerEndpointsHealthMonitor:!!t,enableWorkerEndpointsHealthService:!!n}}(t)),function(e){const{enableBuddyListService:t,buddyListRefreshTimeoutInMilliSeconds:n,enableContactsSync:i,enableMultipleAliasesForContactsSync:a,maxNumberOfRoamingDevices:o,enableInstantSyncForRoamingDevices:r,fetchTFLContactsRefreshInterval:s,enableEndpointsManagerOnBuddyService:l,contactsSyncDeltaRefreshIntervalInMs:c,contactsSyncFullRefreshIntervalInMs:d,contactsSyncKeepAliveIntervalInMs:u,maxBatchSizeforSCDDeletion:m,lokiTokenResourceUrl:p,buddyServiceEndpointManagerMaxRetries:g}=e.get(b.J.People);return{enableBuddyListService:!!t,buddyListRefreshTimeoutInMilliSeconds:n||0,enableContactsSync:!!i,enableMultipleAliasesForContactsSync:!!a,maxNumberOfRoamingDevices:o||0,enableInstantSyncForRoamingDevices:!!r,fetchTFLContactsRefreshInterval:s||[],enableEndpointsManagerOnBuddyService:!!l,contactsSyncDeltaRefreshIntervalInMs:c||0,contactsSyncFullRefreshIntervalInMs:d||0,contactsSyncKeepAliveIntervalInMs:u||0,maxBatchSizeforSCDDeletion:m||0,lokiTokenResourceUrl:p||"",buddyServiceEndpointManagerMaxRetries:g||0}}(t)),function(e){const{enableChatWithNonTflUsers:t,enableTflSmsCreate:n,tflSmsAllowedPhoneNumberRegionCodes:i}=e.get(b.J.Messaging);return{enableChatWithNonTflUsers:!!t,enableTflSmsCreate:!!n,tflSmsAllowedPhoneNumberRegionCodes:i||[]}}(t)),function(e){const{enableCalendarSyncEngine:t,enableConnectedCalendarSettingsSync:n,connectedCalendarSettingsRefreshIntervalInMs:i}=e.get(b.J.Calendar);return{enableCalendarSyncEngine:!!t,enableConnectedCalendarSettingsSync:!!n,connectedCalendarSettingsRefreshIntervalInMs:i||0}}(t)),function(e){const{enablePresenceInWorker:t}=e.get(b.J.Presence);return{enablePresenceInWorker:!!t}}(t)),function(e){const{enableDbOpenTimeout:t,dbOpenTimeoutLengthSeconds:n,dataStoreMapType:i,disableDataStoreInMemoryProvider:a}=e.get(b.J.CdlWorker),o=60;return{enableDbOpenTimeout:!!t,dbOpenTimeoutLengthSeconds:n||o,dataStoreMapType:i||"",disableDataStoreInMemoryProvider:!!a}}(t)),function(e){const{preferGraphOverVroom:t,vroomEndpointBaseUrl:n,graphEndpointBaseUrl:i,graphAuthScope:a,vroomAuthScope:o}=e.get(b.J.Files);return{filesOverrides:{preferGraphOverVroom:!!t,vroomEndpointBaseUrl:n||"",graphEndpointBaseUrl:i||"",graphAuthScope:a||"",vroomAuthScope:o||""}}}(t)),l=function(e){const t=e;return{localStorageTestOverrides:t.getLocalStorageTestOverrides()||{},qspTestOverrides:t.getQspTestOverrides()||{}}}(n);const{isRunningGlassjar:c}=t.get(b.J.Test);if(i.config.isInCypressFrame||c){const e={authOverrides:{authzEndpointUrl:t.get(b.J.Auth).authzEndpointUrl},csaOverrides:{csaHostUrl:null===(o=t.get(b.J.CsaService).apiConstants)||void 0===o?void 0:o.host},msgSearchOverrides:{msgSearchHostUrl:t.get(b.J.Serp).osearchBaseUrl}};s=Object.assign(Object.assign({},s),e),l={localStorageTestOverrides:{},qspTestOverrides:{}}}return Object.assign(Object.assign({},s),l)}function Po(e,t,n,i){let{cdlSharedWorkerUrl:a}=e.get(b.J.Host);const o=t.localStorage.getItem("ts.cdlSharedWorkerJsUrl");if(a&&o&&a!==o){i.error(`Worker URL saved in TSW:${a} is different from worker url in TMP:${o}`);n.newScenario(A.RG.HostSettingsSync).fail({reason:JSON.stringify({cdlSharedWorkerUrl:a,storedWorkerUrl:o})}),a=o}return a}class Do{constructor(){this.id=S.Yg.CreateCDLWorkerAuthTask}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){return Na(e.coreSettings)&&e.cdlWorkerService?Ao(e.windowProvider,e.scenarioFactory,e.coreSettings,e.authenticationService,e.discover,e.platformService,e.loggerFactory.newLogger("CDLWorkerManager"),e.cdlWorkerService):Promise.resolve()}))}}var jo,xo,Oo=n(723128),Lo=n(16381);class Uo{constructor(e,t,n,i){this.cdlWorkerService=i,this.handleClientStateChange=e=>{const t={requestOperationtype:eo.NotifyCoreClientState,context:{appState:e}};return this.getCdlAppStateClient().then((n=>{if(n)return this._logger.log(`Alerting CDL Worker of client state change: ${e}`),n.sendFilteredAppStateRequest(t)})).catch((t=>{this._logger.error(`Failed to send client state to CDL Worker. ClientState: ${e}, Error: ${(0,P.u4)(t)}`)}))},this.handleHostStateChange=e=>{const t={requestOperationtype:eo.NotifyCoreMachineState,context:{appState:e.machineLockState}};return this.getCdlAppStateClient().then((n=>{if(n)return this._logger.log(`Alerting CDL Worker of host state change: ${e.machineLockState}`),n.sendFilteredAppStateRequest(t)})).catch((t=>{this._logger.error(`Failed to send host state to CDL Worker: MachineLockState: ${e.machineLockState}, Error: ${(0,P.u4)(t)}`)}))},this._logger=n.newLogger("CDLWorkerStateSender"),this._clientStateSubscription=e.observe().subscribe((e=>this.handleClientStateChange(e))),this._hostStateSubscription=t.observe().pipe((0,$i.x)(((e,t)=>e.machineLockState===t.machineLockState))).subscribe((e=>this.handleHostStateChange(e)))}dispose(){this._clientStateSubscription&&(this._clientStateSubscription.unsubscribe(),this._clientStateSubscription=void 0),this._hostStateSubscription&&(this._hostStateSubscription.unsubscribe(),this._hostStateSubscription=void 0)}getCdlAppStateClient(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.cdlWorkerService.getCDLWorkerManager();return null==e?void 0:e.workerClientResponseRouter.cdlAppStateClient}))}}class Bo extends Ga{constructor(e,t){super(),this.workerClientResponseRouter=e,this.logger=t.loggerFactory.newLogger("CDLControlPlaneCommunicator")}sendMessage(e){this.getRequestForOperationName(e).then((t=>this.handleResponse(e.rendererId,e.requestId,this.extractPerfStats(t)))).catch((t=>this.handleResponse(e.rendererId,e.requestId,void 0,(0,P.u4)(t)||"Unknown Error")))}getRequestForOperationName(e){const t=e.operationName;if(!t)return Promise.reject(`Request could not be sent: operationName unavailable. RequestId: ${e.requestId}.`);switch(this.logger.log(`Converting GQL operation ${t} to CDL Worker control plane message.`),t){case"notifyWorkerSyncCanStart":return this.workerClientResponseRouter.cdlControlClient.sendRequest({type:"sync_can_start"})}}handleResponse(e,t,n,i){return Promise.resolve(this.onResponseReceived({payload:{dataLayer:{rendererId:e,requestId:t,data:!i,errors:i,extensions:{perfStats:n}}}}))}extractPerfStats(e){return{workerResponseTime:e.workerResponseTime||0,dataStorePerfStats:[]}}}class Wo{constructor(e,t,n,i,a,o,r,s,l,c,d,u,m){this.loggerFactory=i,this.isDisposed=!1,this.logger=i.newLogger("DataClientCoreCDLWorkerService"),this.cdlWorkerManagerInitializationPromise=No(e,t,n,i,a,o,r,s,l,c,this.logger,m);Mo(c,o,a,e,this.logger)&&(this.cdlWorkerStateSender=new Uo(d,u,i,this))}getCDLWorkerManager(){return this.cdlWorkerManagerInitializationPromise}getControlPlaneCommunicator(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){if(!this.controlPlaneCommunicator){const e=yield this.getCDLWorkerManager();if(!e)throw(0,Z.Tr)(Wo.ComponentName,S.jK.NotInitialized,"getControlPlaneCommunicator",void 0,"Worker manager is not initialized");this.controlPlaneCommunicator=new Bo(e.workerClientResponseRouter,{loggerFactory:this.loggerFactory})}return this.controlPlaneCommunicator}))}dispose(){this.cdlWorkerStateSender&&this.cdlWorkerStateSender.dispose(),this.isDisposed=!0}logoutCurrentUser(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const t=e.get(b.J.CdlWorker).maxLogoutTime||5e3;if(this.isDisposed)return void this.logger.warn("Unable to cleanup CDL Worker: Already disposed.");const n=yield this.getCDLWorkerManager();if(n)try{yield(0,le.E)(n.workerClientResponseRouter.cdlSyncEngineClient.sendRequest({type:"logout",subType:"",params:void 0}),t,`logout request to CDL worker timed out after ${t} ms`)}catch(e){this.logger.error("Failed to cleanup CDL Worker on logout.")}else this.logger.warn("Unable to cleanup CDL Worker: Worker manager not available.")}))}}Wo.ComponentName="DataClientCoreCDLWorkerService",function(e){e.Messaging="messaging_logs",e.Policies="policies_logs",e.Calendar="calendar_logs",e.Esp="esp_logs",e.UserPreferences="user_preferences_logs",e.OfflineActions="offline_actions_manager_logs",e.PinnedChannels="pinned_channels_logs",e.People="people_logs",e.Presence="presence_logs",e.AppsPlatform="apps_platform_logs",e.NoLog="no_logs",e.Activities="activities_logs",e.ConnectedCalendar="connected_calendar_logs",e.MfuContacts="mfu_contacts_logs"}(jo||(jo={}));class Ho{constructor(e,t,n,i){this.cdlWorkerManager=e,this.logger=t,this.diagnosticsService=n,this.authenticationService=i,this.logsProviderName="CdlWorkerLogsProvider"}getLogsFiles(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){let e=[];const t=yield this.authenticationService.getUser(),n=yield this.getWorkerDiagnosticsLogsFromCdlWorkerManager();if(t&&t.isAuthenticated)e=yield this.getSyncEngineLogsFromCdlWorkerManager();else{const t="Sync logs cannot be retrieved for unauthenticated users.";e.push({isPiiSafe:!1,fileName:"sync-failure-logs.txt",content:t}),this.logger.warn(t)}return[{isPiiSafe:!1,fileName:"cdl-worker-diagnostics-logs.txt",content:n?this.diagnosticsService.formatEvents(n):"No logs found"},...e]}))}getSystemInfo(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){return new Map}))}getWorkerDiagnosticsLogsFromCdlWorkerManager(){var e;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const t=this.cdlWorkerManager.workerClientResponseRouter.cdlDiagnosticsClient;try{const n=yield t.sendRequest("get_logs");if(null===(e=null==n?void 0:n.response)||void 0===e?void 0:e.data)return n.response.data;this.logger.warn("Diagnostic event list empty or ill-formed")}catch(e){this.logger.error(`Unable to retrieve worker diagnostics logs. ${e.message?e.message:e}`)}}))}getSyncEngineLogsFromCdlWorkerManager(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const e=[];for(const t of(0,j.values)(jo))t!==jo.NoLog&&e.push(this.getSyncEngineLogsForTypeFromCdlWorkerManager(t));return Promise.all(e)}))}getSyncEngineLogsForTypeFromCdlWorkerManager(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const t=this.cdlWorkerManager.workerClientResponseRouter.cdlSyncEngineClient;let n;try{const i=yield t.sendRequest({type:"get_logs",subType:e,params:{conversationId:void 0}});(null==i?void 0:i.response)?n=i.response:(this.logger.warn(`Sync engine logs empty. LogType: ${e}`),n="No logs available.")}catch(e){this.logger.error(`Unable to retrieve worker diagnostics logs. ${e.message?e.message:e}`),n="Failed to get logs."}return{isPiiSafe:!1,fileName:`sync-${this.syncEngineLogTypeToFileName(e)}-logs.txt`,content:n}}))}syncEngineLogTypeToFileName(e){switch(e){case jo.Messaging:return"messaging";case jo.People:return"people";case jo.Presence:return"presence";case jo.Esp:return"esp";case jo.Policies:return"policies";case jo.UserPreferences:return"user-preferences";case jo.OfflineActions:return"offline_actions_manager";case jo.Calendar:return"calendar";case jo.AppsPlatform:return"apps-platform";case jo.Activities:return"activities";case jo.PinnedChannels:return"pinned-channels";case jo.ConnectedCalendar:return"connected_calendar";case jo.MfuContacts:return"mfu_contacts";default:throw new Error(`Invalid sync engine log type: ${e}`)}}}class $o{constructor(){this.id=S.Yg.CreateCDLWorkerTask}execute(e){var t;return(0,l.__awaiter)(this,void 0,void 0,(function*(){return Na(e.coreSettings)?(e.cdlWorkerService=new Wo(e.windowProvider,e.config,e.configLoader,e.loggerFactory,e.scenarioFactory,e.coreSettings,e.coreSettingsContext,e.authenticationService,e.discover,e.platformService,e.clientState,e.hostState,null===(t=e.i18NextWrapper)||void 0===t?void 0:t.locale),e.cdlWorkerService.getCDLWorkerManager().then((t=>{if(t){const n=new Ho(t,e.loggerFactory.newLogger("CdlWorkerLogsProvider"),e.diagnosticsService,e.authenticationService);e.logsCollectorService.registerLogsProvider(n),this.initializeNetworkStateCommsBetweenCoreAndWorker(e,t),this.initializeEndpointsHealthCommsBetweenCoreAndWorker(e,t),this.updateAltScenarioWithAppLaunchMode(t,e.altScenarioService)}})),(0,Lo._)(1)):Promise.resolve()}))}initializeNetworkStateCommsBetweenCoreAndWorker(e,t){var n,i;const{enableNetworkStateCommsBetweenCoreAndWorker:a}=e.coreSettings.get(b.J.Core);if(a){const a=n=>{const i={networkState:e.networkState.getState(),baselineNetworkStateOverride:n};t.workerClientResponseRouter.cdlNetworkStateClient.sendRequest(i)},o=null===(i=(n=e.networkState).createNetworkStateTracker)||void 0===i?void 0:i.call(n,"CDL Worker EM",a);o&&t.state.setState("networkStateService:Loaded",o);e.networkState.observe().subscribe((e=>{const n={networkState:e};t.workerClientResponseRouter.cdlNetworkStateClient.sendRequest(n)}))}}initializeEndpointsHealthCommsBetweenCoreAndWorker(e,t){const{enableEndpointsHealthCommsBetweenCoreAndWorker:n}=e.coreSettings.get(b.J.Core);if(n){let n;if(e.endpointsHealthService&&(n=e.endpointsHealthService)){const e=n.getEndpointsHealthUpdateHandler();t.state.setState("endpointsHealthUpdateHandler:Loaded",e),e.onStateDumpRequest((()=>{t.workerClientResponseRouter.cdlEndpointsHealthClient.sendRequest("get_health_state")}))}}}updateAltScenarioWithAppLaunchMode(e,t){var n,i;const a=null==t?void 0:t.altScenario;a&&(null===(i=null===(n=e.workerClientResponseRouter)||void 0===n?void 0:n.cdlSyncEngineClient)||void 0===i||i.sendRequest({type:"startup_info",subType:"Messaging",params:void 0}).then((e=>{e&&"success"===e.status&&"string"==typeof e.response&&(null==a||a.appendEventData({messagingSyncEngineStartupMode:e.response,appLaunchMode:"clean"===e.response?Oo.pU.Cold:Oo.pU.Warm}))})))}}!function(e){e.LifeCycleScopeChange="LifeCycleScopeChange"}(xo||(xo={}));class Vo{constructor(){this.id=S.Yg.CreateChangeReporting}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){e.schedulerChangeReporting=new _n,e.experienceChangeReportingService=new _n,e.lifeCycleScopeChangeReportingService=new _n,e.commandResultChangeReportingService=new _n}))}}const zo="local-user-preferences",Go={theme:{userTheme:"light",followOsTheme:!0},animation:{disableAnimations:!1},performance:{mode:"normal"},videoEffect:{lastUsedVideoFilter:void 0,lastUsedBackgroundImage:void 0}},qo={get:()=>null,set:()=>{}};class Jo{constructor(e,t=qo){this.storage=t,this.subjectCache=new Map,this.logger=e.newLogger("ClientPreferencesService"),this.clientPreferences=this.hydrateClientPreferences()}getPreferences(e){return this.clientPreferences[e]}getAllPreferences(){return this.clientPreferences}updatePreferences(e){const t=this.clientPreferences;this.clientPreferences=(0,j.merge)({},this.clientPreferences,e),this.storage.set(zo,JSON.stringify(this.clientPreferences)),this.subjectCache.forEach(((e,n)=>{(0,j.isEqual)(t[n],this.clientPreferences[n])||(this.logger.log(`Notifying subscribers of: '${n}', settings changed to: `,this.clientPreferences[n]),e.next(this.clientPreferences[n]))}))}getPreferenceObservable(e){return this.createOrGetSubjectFromCache(e).asObservable()}createOrGetSubjectFromCache(e){const t=this.subjectCache.get(e);if(t)return t;const n=this.getPreferences(e),i=new c.X(n);return this.subjectCache.set(e,i),this.logger.log(`Creating subject for '${e}' category, settings:`,n),i}hydrateClientPreferences(){try{const e=this.storage.get(zo);if(!e)return this.logger.log("Client preferences were not found in local storage; returning defaults."),Go;this.logger.log("Client preferences was found in local storage.");const t=JSON.parse(e);return(0,j.defaultsDeep)(t,Go)}catch(e){return this.logger.error("Unable fetch client preferences from local storage. ",e),Go}}}function Ko(e,t,...n){var i;const{coreSettings:a}=t,o=null!==(i=null==a?void 0:a.get(b.J.Core).enableCoreErrorsV2)&&void 0!==i&&i,r=[];for(const i of n)if(!t[i]&&(r.push(i),!o)){const t=`${e}: ${i} is missing`;throw(0,Z.Tr)(S.w5.Core,S.jK.CoreServiceMissing,e,void 0,t)}if(o&&r.length>0)throw re.fromMissingDependencies(e,r);return t}class Qo{constructor(){this.id=S.Yg.CreateClientPreferences}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{localStorage:t,loggerFactory:n}=Ko("CreateClientPreferencesTask",e,"localStorage","loggerFactory");e.clientPreferences=new Jo(n,{set:(e,n)=>t.set(e,n,S.fO.Experience),get:e=>t.get(e,S.fO.Experience)})}))}}class Yo{constructor(){this.id=S.Yg.CreateCommandHandler}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{appsRegistryService:t,client:n,commandReportingService:i,coreSettings:a,loggerFactory:o,platformService:r,scenarioFactory:s}=Ko("CreateCommandHandlerTask",e,"appsRegistryService","client","commandReportingService","coreSettings","loggerFactory","platformService","scenarioFactory");e.commandHandler=(e,l)=>yt({appsRegistryService:t,client:n,commandReportingService:i,coreSettings:a,entityCommandInput:e,loggerFactory:o,platformService:r,scenarioFactory:s,clientLaunchId:l})}))}}var Xo,Zo;!function(e){e.CommandStart="CommandStart",e.AppAddedScenarioEventData="AppAddedScenarioEventData",e.AppAddedScenarioMark="AppAddedScenarioMark"}(Xo||(Xo={})),function(e){e[e.Canceled=0]="Canceled",e[e.Failure=1]="Failure",e[e.Incomplete=2]="Incomplete",e[e.Success=3]="Success"}(Zo||(Zo={}));class er{constructor(e){this._cap=e,this._map=new Map}entries(){return this._map.entries()}get(e){return this._map.get(e)}set(e,t){if(this._map.size>=this._cap){const e=this._map.keys().next().value;this._map.delete(e)}return this._map.set(e,t)}}const tr=[ve.M.Abandoned,ve.M.Close],nr=[ve.M.Incomplete],ir=[ve.M.CommandHandledPriorToResolution,ve.M.Blanked,ve.M.NotHandled,ve.M.LayoutRendered,ve.M.LayoutRenderUpdated],ar=[ve.M.Failure,ve.M.SlotPhasedRenderingTimedOut];function or(e){switch(e){case ve.M.RenderStarted:case ve.M.ChunkLoadStarted:case ve.M.ChunkLoadSucceeded:case ve.M.Rendered:return!0;default:return!1}}var rr;!function(e){e.Core="Core",e.App="App"}(rr||(rr={}));var sr=n(188682);var lr,cr,dr;!function(e){e.LoadModuleCoreFailed="LoadModuleCoreFailed",e.ExecuteCommandFailed="ExecuteCommandFailed"}(lr||(lr={})),function(e){e.LoadModuleCoreSuccess="LoadModuleCoreSuccess",e.ExecuteCommandSuccess="ExecuteCommandSuccess"}(cr||(cr={})),function(e){e.CallingToastActionMutationFailed="CallingToastActionMutationFailed",e.CallsActionTypeToNotificationActionFailed="CallsActionTypeToNotificationActionFailed",e.ChatActionTypeToNotificationActionFailed="ChatActionTypeToNotificationActionFailed",e.ChatToastActionMutationFailed="ChatToastActionMutationFailed",e.ConversionToHostEntityOptionsFailed="ConversionToHostEntityOptionsFailed",e.DateConversionFailed="DateConversionFailed",e.EmptyEvent="EmptyEvent",e.NotEnabled="NotEnabled",e.RequiredFieldMissing="RequiredFieldMissing",e.SubscriptionFailed="SubscriptionFailed",e.ToastSuppressedForWindowInFocus="ToastSuppressedForWindowInFocus",e.UnhandledType="UnhandledType",e.ImageFetchFailed="ImageFetchFailed",e.ImageUrlGenerationFailed="ImageUrlGenerationFailed"}(dr||(dr={}));const ur={eventId:"executeEntityCommand"};function mr(e,t,n,i){const{replyContent:a}=e,{id:o,type:r}=t;if(!i)return void n.error(`HostComms:: ${dr.RequiredFieldMissing} Toast activation command received from host without target host entity options`);const{actionType:s,convId:l}=i;switch(r){case ne.p.chats:return function(e,t,n,i){let a=$t.unknown;switch(t){case"quickReply":a=$t.quickReply;break;default:i.error(`HostComms:: ${dr.RequiredFieldMissing} Toast activation command received from host with unknown chats action Type`)}return{actionType:a,convId:e||void 0,message:n}}(l,s,a,n);case ne.p.calls:return function(e,t,n){return t||(n.error(`HostComms:: ${dr.RequiredFieldMissing} Toast activation command received from host with unknown calls action type`),t="Unknown"),{actionType:t,toastId:e||void 0}}(o,s,n);default:return void n.error(`HostComms:: ${dr.RequiredFieldMissing} Unkown target entity type received from host for toast activation command`)}}function pr(e,t){switch(e){case Wt.mutate:return ne.u.mutate;case Wt.view:return ne.u.view;default:return t.error(`HostComms:: ${dr.RequiredFieldMissing} Toast activation command received from host with unknown entity action. Defaulting to view.`),ne.u.view}}function gr(e,t){const{entity:n,entityOptions:i,command:a}=e,{visibilityState:o,correlation:r}=a,{id:s,startTimestamp:l,source:c}=r,d=null==i?void 0:i.toastActivationEntityOptions;if(!d)return ur;if(!n)return ur;const{optionsJson:u}=n,m=function(e,t){const{id:n,type:i,action:a,linkedEntity:o}=e;return{action:pr(a,t),id:n,linkedEntity:Er(o,t),type:vr(i,t)}}(n,t),p=u?(0,sr.D)(u,void 0):void 0;return Object.assign(Object.assign({},ur),{payload:{entity:m,command:{visibilityState:fr(o,t),correlation:{id:s,startTimestamp:l?l.getTime():void 0,source:c,scenarioName:A.RG.ToastActivation},stateTransition:Ir(n.type,t)},entityOptions:hr(p),dataOptions:n.action===Wt.mutate?mr(d,m,t,p):void 0}})}function hr(e){if(!(null==e?void 0:e.messageId))return;const{messageId:t}=e;return{messageId:t}}function vr(e,t){switch(e){case Ut.chats:return ne.p.chats;case Ut.calls:return ne.p.calls;default:return t.error(`HostComms:: ${dr.RequiredFieldMissing} Toast activation command received from host with unknown entity type. Defaulting to chats`),ne.p.chats}}function fr(e,t){switch(e){case Bt.show:return be.fe.show;case Bt.hide:return be.fe.hide;default:return t.error(`HostComms:: ${dr.RequiredFieldMissing} Toast activation command received from host with unknown visibility state. Defaulting to show`),be.fe.show}}function yr(e,t){var n;const{command:i}=e,{correlation:a,visibilityState:o}=i;let r;return(null==a?void 0:a.startTimestamp)&&(r=new Date(+a.startTimestamp),r=Mr(r)?r:void 0),{correlation:{id:null!==(n=null==a?void 0:a.id)&&void 0!==n?n:(0,Be.v4)(),startTimestamp:r,source:Lt.toastFromWeb},visibilityState:Tr(o,t)}}function Sr(e,t){try{const{entity:n}=e,{action:i,id:a,type:o}=n;return{action:kr(i,t),id:a,type:Cr(o)}}catch(e){throw t.error(`HostComms:: ${(0,P.u4)(e)}`),e}}function kr(e,t){switch(e){case ne.u.mutate:return Wt.mutate;case ne.u.view:return Wt.view;default:return t.error(`HostComms:: ${dr.RequiredFieldMissing}: EntityAction. Defaulting to HostEntityAction.view`),Wt.view}}function br(e){const{id:t,linkedEntity:n,action:i,type:a,dataOptions:o}=e;return{action:i,id:t,linkedEntity:n,type:a,optionsJson:(0,P.u4)(o)}}function _r(e){!function(e){if(!e)throw(0,Z.Tr)(S.w5.Commanding,dr.RequiredFieldMissing,ne.p.toasts,void 0,`${dr.RequiredFieldMissing}: entityOptions`);const t=e;if(!(t.targetEntity&&t.targetEntity.action&&t.targetEntity.type&&t.targetEntity.dataOptions&&t.time&&t.title))throw(0,Z.Tr)(S.w5.Commanding,dr.RequiredFieldMissing,ne.p.toasts,void 0,`${dr.RequiredFieldMissing}: hostEntityOptions?.toastEntityOptions`)}(e);const{buttons:t,targetEntity:n,textInput:i,time:a}=e;return{toastEntityOptions:Object.assign(Object.assign({},e),{targetEntity:br(n),time:a,buttons:Ar(t),textInput:wr(i)})}}function Cr(e){switch(e){case ne.p.toasts:return Ut.toasts;default:throw(0,Z.Tr)(S.w5.Commanding,dr.RequiredFieldMissing,ne.p.toasts,void 0,`${dr.RequiredFieldMissing}: EntityType`)}}function wr(e){if(!e)return;const{placeholderText:t,sendButton:n}=e;return{placeholderText:t,sendButton:n?Nr(n):void 0}}function Tr(e,t){switch(e){case be.fe.hide:return Bt.hide;case be.fe.show:return Bt.show;default:return t.error(`HostComms:: ${dr.RequiredFieldMissing}: EntityVisibilityState. Defaulting to HostEntityVisibilityState.show`),Bt.show}}function Er(e,t){if(!e)return;const{id:n,type:i,action:a}=e;return{action:a?pr(a,t):void 0,id:n,type:vr(i,t)}}function Ir(e,t){switch(e){case Ut.chats:case Ut.calls:return be.su.new;default:return t.error(`HostComms:: ${dr.RequiredFieldMissing} Toast activation command received from host with unhandled host entity type - ${e}.`),be.su.new}}function Nr(e){const{image:t,targetEntity:n,text:i,preferImageOnly:a,style:o}=e;return{image:t,preferImageOnly:a,style:o,targetEntity:br(n),text:i}}function Ar(e){if(e)return e.map(Nr)}const Mr=e=>e instanceof Date&&!isNaN(e.getTime());function Fr(e,t,n,i){var a;return(0,l.__awaiter)(this,void 0,void 0,(function*(){if(e.entity.type!==ne.p.toasts)return;let o;(null===(a=e.command.correlation)||void 0===a?void 0:a.id)&&(o=i.findScenarioByNameAndId(A.RG.ToastView,e.command.correlation.id));const r=yield function(e,t){return(0,l.__awaiter)(this,void 0,void 0,(function*(){let n;try{n=yield e.loadModule("core"),t.log(`HostComms:: ${cr.LoadModuleCoreSuccess}`)}catch(e){t.error(`HostComms:: ${lr.LoadModuleCoreFailed} ${(0,P.u4)(e)}`)}return n}))}(t,n);if(!r)return n.error(`HostComms:: ${lr.LoadModuleCoreFailed}`),void(null==o||o.fail({errorCode:lr.LoadModuleCoreFailed}));try{const t=function(e,t){return{command:yr(e,t),entity:Sr(e,t),entityOptions:_r(null==e?void 0:e.entityOptions)}}(e,n);(null==r?void 0:r.executeCommand)&&(yield null==r?void 0:r.executeCommand(t),n.log(`HostComms:: ${cr.ExecuteCommandSuccess}`)),null==o||o.stop()}catch(e){n.error(`HostComms:: ${lr.ExecuteCommandFailed} ${(0,P.u4)(e)}`),null==o||o.fail({errorCode:lr.ExecuteCommandFailed})}}))}const Rr=[ve.M.Rendered];class Pr{constructor(e,t,n,i,a,o,r){this._commandResultChangeReportingService=t,this._window=n,this._scenarioFactory=i,this._hostCommunicationService=a,this._logger=e.newLogger("CommandReportingService"),this._pendingCommands=new Map,this._coreSettings=r,this._commandSequence=0;(null==r?void 0:r.get(b.J.Diagnostics).isDiagnosticsPanelEnabled)&&(this._commandsHistory=new er(30)),this.lifeCycleScopeChangeSubscription=this.subscribeToLifeCycleScopeChange(o)}appendCommandEventData(e,t){const n=this._pendingCommands.get(e);if(n){if(this._pendingCommands.set(e,Object.assign(Object.assign({},n),{eventData:Object.assign(Object.assign({},n.eventData),t)})),this._commandsHistory){const n=this._commandsHistory.get(e);n&&(n.isCommandTargetedToMainWindow=t.isCommandTargetedToMainWindow)}}else this._logger.warn(`appendCommandEventData called with correlationId ${e}, but there was no such pending command`)}appendScenarioEventData(e,t){const n=this._pendingCommands.get(e);n?n.commandScenario.appendEventData(t):this._logger.warn(`appendScenarioEventData called with correlationId ${e}, but there was no such pending command`)}addScenarioMark(e,t,n,i,a){const o=this._pendingCommands.get(e);o?(o.previousStep=t,o.commandScenario.mark(t,n,i,a)):this._logger.warn(`addScenarioMark called with correlationId ${e}, but there was no such pending command`)}registerNavigationCommandStart(e,t){var n;const i=t.id;let a=this._pendingCommands.get(i);if(a)this._logger.debug(`registerNavigationCommandStart called with an already pending correlation id ${i}, updating command info.`);else{t.scenarioName=null!==(n=t.scenarioName)&&void 0!==n?n:A.RG.NavigationCommand;const i=this._scenarioFactory.findScenarioByNameAndId(t.scenarioName,e);a=this.createPendingCommand({correlation:t,clientId:e,commandScenario:null!=i?i:void 0})}this.updatePendingCommand(a)}registerCommandStart(e){const t=e.command.correlation.id;let n=this._pendingCommands.get(t);n?(this._logger.debug(`registerCommandStart called with an already pending correlation id ${t}, updating command info.`),n.entityCommand=e):n=this.createPendingCommand({entityCommand:e}),this.updatePendingCommand(n)}reportCommandEvent(e,t,n){const i=this._pendingCommands.get(e);if(!i||Rr.includes(t))return;if(i.previousEvents.has(t))return;i.previousEvents.add(t),this.addCommandEventToHistory(e,t);const{eventData:a,commandScenario:o}=i,r=Object.assign(Object.assign({},a),n);this._logger.log(`Command event reported ${t} for scenario ${o.name} and correlation id ${e}`),this.reportCommandEventInternal(i,t,r)}destroy(){var e;null===(e=this.lifeCycleScopeChangeSubscription)||void 0===e||e.unsubscribe()}reportCommandEventInternal(e,t,n){const{commandScenario:i,previousStep:a,correlation:{id:o}}=e;if(e.previousStep=t,function(e){return ir.includes(e)}(t))i.stop({reason:t,previousStep:a}),this.onCommandResult(Zo.Success,o,e);else if(function(e){return ar.includes(e)}(t)){const l=(r=t,s=n.errorInfo,r===ve.M.SlotPhasedRenderingTimedOut?ve.y.SlotPhasedRenderingTimedOut:s||ve.y.UnknownCommandError),c=n.errorMessage&&(0,G.A)(n.errorMessage);i.fail({errorCode:l,reason:l,previousStep:a,errors:n.errorMessage&&(0,G.A)(n.errorMessage)}),this.onCommandResult(Zo.Failure,o,e,{errorCode:l,errorMessage:c,previousStep:a})}else if(function(e,t){return e===ve.M.RenderStarted&&!1===t}(t,n.contentExistsAndHasChanged)){const t=ve.y.AlreadyRendered;i.incomplete({errorCode:t,reason:t,previousStep:a}),this._logger.log(`AlreadyRendered, ${e.correlation.scenarioName}, ${o}`),this.onCommandResult(Zo.Incomplete,o,e,{errorCode:t,previousStep:a})}else if(function(e){return tr.includes(e)}(t)){const n=function(e,t){return e===ve.M.Close?t&&or(t)?ve.y.WindowCloseRunningApp:ve.y.WindowCloseRunningCore:e===ve.M.Abandoned?ve.M.Abandoned:ve.y.UnknownCommandError}(t,a);i.cancel({errorCode:n,reason:n,previousStep:a}),this.onCommandResult(Zo.Canceled,o,e,{errorCode:n,previousStep:a})}else!function(e){return nr.includes(e)}(t)?(or(t)&&i.appendEventData({scenarioPhase:rr.App}),i.mark(t)):(i.incomplete({errorCode:t,reason:t,previousStep:a}),this.onCommandResult(Zo.Incomplete,o,e,{errorCode:t,previousStep:a}));var r,s;(function(e){return e===ve.M.NotHandled})(t)&&this.processNotHandledCommandEvent(e)}onCommandResult(e,t,n,i){this.cleanUpPendingCommand(t,n),this.reportCommandResult(t,e,n.entityCommand,i)}processNotHandledCommandEvent(e){var t;!!(null===(t=this._coreSettings)||void 0===t?void 0:t.get(b.J.Core).enableCommandToHostCommService)&&e.entityCommand&&Fr(e.entityCommand,this._hostCommunicationService,this._logger,this._scenarioFactory)}get CommandsHistory(){return this._commandsHistory}addCommandEventToHistory(e,t){if(this._commandsHistory){const n=this._commandsHistory.get(e);null==n||n.steps.push({event:t,timestamp:Date.now()-(parseInt(n.entityCommand.command.correlation.startTimestamp,10)||0)})}}createPendingCommand({entityCommand:e,correlation:t,clientId:n,commandScenario:i}){var a;if(!(t=null!=t?t:null==e?void 0:e.command.correlation)){const e=new Error("correlation cannot be undefined. A valid entityCommand or correlation should be passed.");throw this._logger.errorToTelemetry&&this._logger.errorToTelemetry(e.message,"webclient_framework_foundation_command_reporting_service_event"),e}const o=t.id,{startTimestamp:r}=t,s=r&&Mr(new Date(+r))?+r:void 0,l=this._window.setTimeout(this.getCommandTimeoutHandler(o),3e4);return t.scenarioName=null!==(a=t.scenarioName)&&void 0!==a?a:A.RG.EntityCommand,e&&(i=this.findExistingActivitySwitchScenario(e)),i||((i=this._scenarioFactory.newScenario(t.scenarioName,{startTime:s})).clientId=n,i.appendEventData({"EventInfo.CorrelationId":o,commandSequence:++this._commandSequence,commandSource:t.source,scenarioPhase:rr.Core})),this._logger.log(`Starting to track a new command\n\tscenarioName: ${t.scenarioName}\n\tcorrelationId: ${o}\n\tentityType: ${null==e?void 0:e.entity.type}\n\tentityAction: ${null==e?void 0:e.entity.action}`),{correlation:t,entityCommand:e,commandScenario:i,previousEvents:new Set,timeoutId:l}}findExistingActivitySwitchScenario(e){var t;const n=e.command.correlation.id;if(e.command.correlation.source===k.D.ActivityFeedBellClick){const e=Array.from(this._pendingCommands.values());for(const i of e)if((null===(t=i.entityCommand)||void 0===t?void 0:t.command.correlation.scenarioName)===A.RG.ActivitySwitch){const e=i.entityCommand.command.correlation.id;this._logger.log(`Command was sent by activity app as a result of a bell click, correlationId ${n}. Combining scenario with existing activity_switch of correlationId ${e}`);const t=i.commandScenario;return this.onCommandResult(Zo.Canceled,e,i),t}}}reportCommandResult(e,t,n,i){n&&this._commandResultChangeReportingService.report({correlationId:e,context:{entityCommand:n,target:"command-reporting-service",error:i},type:t})}cleanUpPendingCommand(e,{timeoutId:t}){this._window.clearTimeout(t),this._pendingCommands.delete(e)}getCommandTimeoutHandler(e){return()=>{const t=this._pendingCommands.get(e);if(!t)return;const n=t.commandScenario.clientId?this._scenarioFactory.findScenarioByNameAndId(t.commandScenario.name,t.commandScenario.clientId):this._scenarioFactory.findScenario(t.commandScenario.name),{previousStep:i}=t,a=function(e){return e&&or(e)?ve.y.TimeoutRunningApp:ve.y.TimeoutRunningCore}(i);n&&(this._logger.error(`Command timeout, reason: ${a}`),n.fail({errorCode:a,reason:a,previousStep:i})),this.onCommandResult(Zo.Failure,e,t,{errorCode:a,previousStep:i})}}updatePendingCommand(e){const{correlation:t,commandScenario:n,entityCommand:i}=e,a=t.id;if(n.name!==t.scenarioName&&this._logger.warn(`Attempt to update active scenario name from '${n.name}' \n          to '${t.scenarioName}'.\n          Update of scenario name is not supported in scenario infra.`),i&&n.appendEventData({mainEntityAction:i.entity.action,mainEntityType:i.entity.type}),this._pendingCommands.set(a,e),this._commandsHistory&&i){let e=this._commandsHistory.get(a);const t={entityCommand:i,isCommandTargetedToMainWindow:!1,steps:[]};e=e?Object.assign(Object.assign({},e),{entityCommand:i}):t,this._commandsHistory.set(a,e)}}subscribeToLifeCycleScopeChange(e){return e.observeChanges().pipe((0,y.U)((({correlationId:e,context:{apps:t}})=>{let n=!1;return t.forEach((({id:t,type:i})=>{i===fe.c4.Initialized&&(n=!0,this._logger.log(`${t} initialized, correlationId: ${e}`))})),{appInitialized:n,correlationId:e}})),(0,g.h)((({appInitialized:e})=>e))).subscribe((({correlationId:e,appInitialized:t})=>{this.appendScenarioEventData(e,{appInitialized:t})}))}}const Dr=[ve.M.ApplicationHookReceivedCommand,ve.M.ApplicationHookContinuedCommand];class jr{constructor(e,t,n,i){this._host=t,this._scenarioFactory=n,this.commandTimedOutAtHostHandler=e=>{var t;const{correlationId:n,reason:i}=e.payload,a=this._pendingCommands.get(n);a&&(a.onCommandTimeOut&&a.onCommandTimeOut(),null===(t=this._pendingCommands.get(n))||void 0===t||t.commandScenario.fail({reason:i}),this.cleanUpPendingCommand(n))},this._logger=e.newLogger("CommandReportingServiceHybrid"),this._pendingCommands=new Map;(null==i?void 0:i.get(b.J.Diagnostics).isDiagnosticsPanelEnabled)&&(this._commandsHistory=new er(30)),this._host.opener.addEventListener(R.rY.EntityCommandTimedOutAtHost,this.commandTimedOutAtHostHandler)}registerNavigationCommandStart(){this._logger.error("registerNavigationCommandStart: Not supported on hybrid")}registerCommandStart(e){const t=e.command.correlation.id;if(!t)return void this._logger.error("registerCommandStart called without a command correlation id");const n=this._pendingCommands.get(t);n&&(this._logger.log(`registerCommandStart called with a pending command with correlation id ${t}, overwriting and starting new timeout interval`),this._host.clearTimeout(n.timeoutId));const i=this._host.setTimeout((()=>{this.reportCommandEvent(t,ve.M.CommandReportingTimedOut),this.cleanUpPendingCommand(t)}),9e4);this._logger.log(`Starting to track command with correlation Id ${t}`);const a=this._scenarioFactory.newScenario(A.RG.CommandEvent);a.appendEventData({"EventInfo.CorrelationId":t,commandSource:e.command.correlation.source,mainEntityAction:e.entity.action,mainEntityType:e.entity.type}),this._pendingCommands.set(t,{entityCommand:e,timeoutId:i,commandScenario:a,previousEvents:new Set}),this._commandsHistory&&this._commandsHistory.set(t,{entityCommand:e,isCommandTargetedToMainWindow:!1,steps:[]})}appendCommandEventData(e,t){const n=this._pendingCommands.get(e);if(n){if(this._pendingCommands.set(e,Object.assign(Object.assign({},n),{eventData:Object.assign(Object.assign({},n.eventData),t)})),this._commandsHistory){const n=this._commandsHistory.get(e);n&&(n.isCommandTargetedToMainWindow=t.isCommandTargetedToMainWindow)}}else this._logger.warn(`appendCommandEventData called with correlationId ${e}, but there was no such pending command`)}reportCommandEvent(e,t,n){const i=this._pendingCommands.get(e);if(!i)return;if(i.previousEvents.has(t))return;i.previousEvents.add(t);const{entityCommand:a,eventData:o,commandScenario:r}=i,s=Object.assign(Object.assign(Object.assign({entityCommand:a,commandEvent:t},o),n),{timestamp:Date.now()});if(this._commandsHistory){const n=this._commandsHistory.get(e);null==n||n.steps.push({event:t,timestamp:Date.now()-(parseInt(n.entityCommand.command.correlation.startTimestamp,10)||0)})}if(t===ve.M.CommandReportingTimedOut)r.stop();else if(!Dr.includes(t)){this._logger.log(`Command event reported ${t} for correlation id ${e}`);const i=t===ve.M.Failure,a=this.isChunkLoadEvent(t);r.mark(t,{errorCode:i?null==n?void 0:n.errorInfo:void 0,operationName:a?null==n?void 0:n.chunkName:void 0},i?"failure":"success")}Dr.includes(t)||this._host.opener.postMessage(_.W.CommandEvent,s)}registerForCommandTimeOut(e,t){const n=this._pendingCommands.get(e);n&&(n.onCommandTimeOut=t)}unRegisterForCommandTimeOut(e){const t=this._pendingCommands.get(e);t&&(t.onCommandTimeOut=void 0)}get CommandsHistory(){return this._commandsHistory}appendScenarioEventData(){}addScenarioMark(){}cleanUpPendingCommand(e){const t=this._pendingCommands.get(e);t&&(this._host.clearTimeout(t.timeoutId),this._pendingCommands.delete(e))}isChunkLoadEvent(e){return e===ve.M.ChunkLoadStarted||e===ve.M.ChunkLoadSucceeded}}class xr{constructor(){this.id=S.Yg.CreateExternalCommandListener}execute(e){var t;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:n,loggerFactory:i,scenarioFactory:a,windowProvider:o}=Ko("CreateCommandReportingServiceTask",e,"coreSettings","loggerFactory","scenarioFactory","windowProvider");if(null===(t=n.get(b.J.Core))||void 0===t?void 0:t.enableStandaloneCommandReportingService){const{commandResultChangeReportingService:t,hostCommunicationService:r,lifeCycleScopeChangeReportingService:s}=Ko("CreateCommandReportingServiceTask",e,"commandResultChangeReportingService","hostCommunicationService","lifeCycleScopeChangeReportingService");e.commandReportingService=new Pr(i,t,o,a,r,s,n)}else e.commandReportingService=new jr(i,o,a,n)}))}}class Or{constructor(e,t,n,i){this._appsRegistry=e,this._client=t,this._commandResultChangeReportingService=n,this._entityCommanding=i}init(){this._changes&&this.destroy(),this._changes=this._commandResultChangeReportingService.observeChanges().subscribe((e=>this.executeOnCommandResultAppHooks(e)))}destroy(){var e;null===(e=this._changes)||void 0===e||e.unsubscribe(),this._changes=void 0}executeOnCommandResultAppHooks({context:{entityCommand:e},type:t}){const n=e.entity.type,i=n&&this._appsRegistry.entityTypeToAppMap.get(n),a=null==i?void 0:i.onAfterCommandResolved;a&&a({requestContext:{client:this._client,entityCommanding:this._entityCommanding},entityCommand:e,result:t})}}var Lr,Ur=n(213678);!function(e){e[e.Configuration=0]="Configuration",e[e.Override=1]="Override",e[e.Policy=2]="Policy",e[e.TestOverride=3]="TestOverride"}(Lr||(Lr={}));class Br{constructor(){this.providers={[Lr.Configuration]:[],[Lr.Override]:[],[Lr.Policy]:[],[Lr.TestOverride]:[]}}registerProvider(e,t){this.providers[t].push(e)}getSettings(e){const t=this.mergeProviders(Lr.Configuration,e),n=this.mergeProviders(Lr.Override,e,t),i=this.mergeProviders(Lr.Policy,e),a=this.combinePoliciesAndConfigs(n,i);return this.mergeProviders(Lr.TestOverride,e,a)}mergeProviders(e,t,n={}){return this.providers[e].map((e=>(0,j.pick)(e.getSettings(),t))).reduce(((e,t)=>((0,j.mergeWith)(e,t,Ur.g),e)),n)}combinePoliciesAndConfigs(e,t){return Object.keys(t).map((n=>{const i=(0,j.get)(e,n)||{},a=(0,j.get)(t,n);Object.keys(a).map((t=>{const o=(0,j.get)(i,t),r=(0,j.get)(a,t),s=this.policyAndConfigMergeRule(o,r);(0,j.set)(i,t,s),(0,j.set)(e,n,i)}))})),e}policyAndConfigMergeRule(e,t){return(0,j.isNil)(e)?t:(0,j.isNil)(t)?void 0:(0,j.isBoolean)(t)?e&&t:t}}class Wr{constructor(e,t){this.subjectCache=new Map,this.observedCategories=[],this.subscriptions=[],this.notifySettingsChanged=()=>{this.logger.log("Settings have changed, checking for differences in these categories:",this.observedCategories);const e=this.ruleEngine.getSettings(this.observedCategories);this.logger.log("Updated settings:",e),this.observedCategories.forEach((t=>{const n=this.createOrGetSubjectFromCache(t),i=e[t]||{};(0,j.isEqual)(n.value,i)||(this.logger.log(`Notifying subscribers of: '${t}', settings changed to: `,i),n.next(i))}))},this.logger=t.newLogger(`CoreSettings/Service(${e})`),this.ruleEngine=new Br,this.logger.log("Created.")}cleanup(){this.logger.log("Cleaning up."),this.subscriptions.forEach((e=>e.unsubscribe()))}get(e){return this.createOrGetSubjectFromCache(e).value}getObservable(e){return this.createOrGetSubjectFromCache(e).asObservable()}registerProvider(e,t){this.ruleEngine.registerProvider(e,t);const n=e.subscribe(this.notifySettingsChanged);this.subscriptions.push(n)}createOrGetSubjectFromCache(e){let t=this.subjectCache.get(e);if(!t){this.observedCategories.push(e);const n=this.getSettingsForCategory(e);t=new c.X(n),this.subjectCache.set(e,t),this.logger.log(`Creating subject for '${e}' category, settings:`,n)}return t}getSettingsForCategory(e){return this.ruleEngine.getSettings([e])[e]||{}}}class Hr{constructor(e){this.cacheMap=new Map,this.logger=e.newLogger("CoreSettings/ContextCache")}cache(e,t){if(this.cacheMap.has(e))throw new Error(`Context '${e}' already stored.`);this.cacheMap.set(e,{context:t,refCount:1}),this.logger.debug(`Context '${e}' cached.`)}acquire(e,t){const n=this.cacheMap.get(e);if(n)return n.refCount++,this.logger.debug(`Acquiring context '${e}', ref count: '${n.refCount}'.`),n.context;if(!t)throw new Error(`Context '${e}' not found in cache.`);this.logger.debug(`Context '${e}' not found in cache, constructing...`);const i=t();return this.cache(e,i),i}release(e,t){const n=this.cacheMap.get(e);if(!n)throw new Error(`Cannot release context '${e}', not found in cache.`);n.refCount--,this.logger.debug(`Releasing context '${e}', ref count: '${n.refCount}'.`),0===n.refCount&&(t(),this.cacheMap.delete(e))}}class $r{constructor(){this.callbacks=[]}subscribe(e){if(!(0,j.isFunction)(e))throw Error("Callback is not a valid function.");const t=this;t.callbacks.push(e);return{unsubscribe:()=>{const n=t.callbacks.indexOf(e);n>=0&&t.callbacks.splice(n,1)}}}getRawSettings(){}getDiagnosticsInfo(){}cleanup(){}notifySettingsChanged(){this.callbacks.forEach((e=>e()))}}class Vr extends $r{constructor(e,t,n,i,a,o,r,s=18e5){super(),this.ecsParameters=e,this.scenarioFactory=n,this.host=i,this.networkStateProvider=a,this.clientStateProvider=o,this.ecsTransportConstructor=r,this.refreshIntervalInMs=s,this.diagnosticsInfo={},this.isInitialized=!1,this.providerName="EcsProvider",this.performRequest=(e=!1)=>(0,l.__awaiter)(this,void 0,void 0,(function*(){const t=this.scenarioFactory.newScenario(A.RG.EcsFetch);return t.appendEventData({endpointUrl:this.ecsTransport.endpointUrl,operation:e?"initial":"refresh"}),this.validateEnvironment().then((()=>(this.logger.log(`Getting ECS settings from: ${this.ecsTransport.endpointUrl}`),this.diagnosticsInfo.fetchUrl=this.ecsTransport.endpointUrl,this.diagnosticsInfo.lastAttemptedFetch=new Date,this.ecsTransport.fetch(this.currentETag).then((e=>this.handleEcsBody(e,t))).catch((e=>this.handleError(e,t)))))).catch((e=>(t.stop({message:e},"abandoned"),!1)))})),this.validateEnvironment=()=>new Promise(((e,t)=>{var n;this.networkStateProvider&&!this.networkStateProvider.isOnline()&&(this.logger.debug("Skipping override settings check due to app being offline."),t("no network")),(null===(n=this.clientStateProvider)||void 0===n?void 0:n.getState())===Dn.pk.VeryActive&&(this.logger.debug("Skipping override settings check due to app being in a very active state."),t("very active")),e()})),this.cleanupClientStateSubscription=()=>{var e;null===(e=this.clientStateSubscription)||void 0===e||e.unsubscribe(),this.clientStateSubscription=void 0},this.logger=t.newLogger("CoreSettings/EcsProvider"),this.ecsTransport=r(e)}initialize(e=!0){return(0,l.__awaiter)(this,void 0,void 0,(function*(){if(this.isInitialized)throw new Error("Already initialized!");this.isInitialized=!0;let t=!0;return e&&(t=yield this.fetchImmediately()),this.queueEcsFetch(),t}))}getSettings(){return this.settings||{}}getDiagnosticsInfo(){return this.diagnosticsInfo}cleanup(){super.cleanup(),this.cleanupClientStateSubscription()}updateEcsParametersAndFetchSettings(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const t=this.ecsTransport.endpointUrl;this.ecsTransport=this.ecsTransportConstructor(e),this.ecsTransport.endpointUrl!==t&&this.isInitialized&&(yield this.fetchImmediately(),this.queueEcsFetch())}))}updateRefreshInterval(e){this.refreshIntervalInMs!==e&&(this.refreshIntervalInMs=0===e?e:Math.max(e,6e4),this.refreshIntervalInMs!==e&&this.logger.debug("Provided refresh interval was lower than the minimum.",6e4),this.logger.debug("Refresh interval changed to",this.refreshIntervalInMs),this.isInitialized&&this.queueEcsFetch())}fetchImmediately(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){try{return yield this.performRequest(!0)}catch(e){return this.logger.warn("Initial override check failed.",e),!1}}))}queueEcsFetch(){if(!this.isInitialized)throw new Error("Provider not initialized to queue the fetch.");this.setIntervalHandle&&(this.host.clearInterval(this.setIntervalHandle),this.setIntervalHandle=void 0,this.logger.debug("clearInterval() called.")),this.refreshIntervalInMs>0&&(this.setIntervalHandle=this.host.setInterval(this.performRequest,this.refreshIntervalInMs),this.logger.debug("setInterval() called."))}extractSettings(e){if((0,j.isNil)(this.ecsParameters.namespaces))return{};let t={};const n=[];this.diagnosticsInfo.configIds=e.ConfigIDs,this.ecsParameters.namespaces.forEach((i=>{const{ConfigIDs:{[i]:a},[i]:o}=e;if(a){const e=a.split(",");n.push(...e.filter((e=>e.startsWith("P-E"))))}t=Object.assign(Object.assign({},t),o)}));const{Headers:{ETag:i}}=e;return t=Object.assign(Object.assign({},t),{metadata:Object.assign(Object.assign({},t.metadata),{eTag:i,configIds:{experiments:n}})}),t}handleEcsBody(e,t){if(!e){const e=new Error("body is empty");throw Object.assign(e,{reason:e.message}),e}const n=e.Headers.ETag;let i=!1,a=!1;return this.currentETag&&this.currentETag===n?this.logger.debug("Settings are the same, eTag:",this.currentETag):(this.settings=this.extractSettings(e),this.logger.log("Settings updated to:",this.settings),this.currentETag=n,a=this.notifySettingsChangedDeferred(),i=!0),this.diagnosticsInfo.etag=n,this.diagnosticsInfo.lastAttemptedFetch=new Date,this.diagnosticsInfo.lastSuccessfulFetch=this.diagnosticsInfo.lastAttemptedFetch,t.stop({message:JSON.stringify({settingsUpdated:i,notified:a})}),!0}handleError(e,t){var n;const i=e&&JSON.stringify(e)||"unknown error";switch(null==e?void 0:e.reason){case na.A.TimedOut:t.stop({message:i},"timeout");break;case na.A.TransformFailed:return t.stop({message:JSON.stringify({statusCode:null===(n=e.serverResponse)||void 0===n?void 0:n.status})}),!1;default:t.fail({errors:i})}return this.logger.warn("Override settings check failed with:",e),!1}notifySettingsChangedDeferred(){const e=()=>{this.cleanupClientStateSubscription(),this.notifySettingsChanged(),this.logger.debug("Notified about settings change")};return this.clientStateProvider&&this.clientStateProvider.getState()===Dn.pk.VeryActive?(this.clientStateSubscription||(this.clientStateSubscription=this.clientStateProvider.observe().subscribe((t=>{t!==Dn.pk.VeryActive&&e()}))),this.logger.debug(`Postponed settings change notification due to client state being ${Dn.pk[this.clientStateProvider.getState()]}`),!1):(e(),!0)}}class zr extends $r{constructor(e,t,n,i){super(),this.policiesDataProvider=t,this.configLoader=n,this.enablePoliciesDefaultValues=i,this.providerName="PolicyProvider",this.refreshSettings=e=>{this.rawPolicies=e;const t=this.policySettings,n=this.mapPoliciesToSettings(e);if(this.enablePoliciesDefaultValues){const e=(0,j.cloneDeep)(this.policySettingsDefaults);this.policySettings=(0,j.mergeWith)(e,n,Ur.g)}else this.policySettings=n;(0,j.isEqual)(t,this.policySettings)?this.logger.log("No changes detected."):(this.logger.log("Policy settings updated to: ",this.policySettings),this.notifySettingsChanged())},this.logger=e.newLogger("CoreSettings/PolicyProvider"),this.policiesDataProvider.subscribeForSettingsUpdates(this.refreshSettings),this.policySettingsDefaults={},this.policySettings={},this.rawPolicies={}}initialize(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){this.policiesJson=this.configLoader("policies").mappings,this.logger.log("Loaded policies mapping: ",this.policiesJson),this.enablePoliciesDefaultValues&&this.policiesJson&&(this.policySettingsDefaults=this.getPolicySettingsDefaults(this.policiesJson),this.policySettings=(0,j.cloneDeep)(this.policySettingsDefaults),this.logger.log("Loaded default for policies settings: ",this.policySettingsDefaults)),yield this.policiesDataProvider.initialize(!0),this.logger.log("Initial fetch completed.")}))}getSettings(){return this.policySettings}getRawSettings(){return this.rawPolicies}cleanup(){this.policiesDataProvider.cleanup()}getPolicySettingsDefaults(e){const t={};return Object.keys(e).map((e=>{const n={},i=(0,j.get)(this.policiesJson,e);Object.keys(i).map((e=>{const t=(0,j.get)(i,e);if(t&&(0,j.has)(t,"defaultValue")){const i=(0,j.get)(t,"defaultValue");(0,j.set)(n,e,i)}})),(0,j.set)(t,e,n)})),t}mapPoliciesToSettings(e){const t={};return this.policiesJson&&Object.keys(this.policiesJson).map((n=>{const i={},a=(0,j.get)(this.policiesJson,n);Object.keys(a).map((t=>{const n=(0,j.get)(a,t);if(n&&(0,j.has)(n,"name")){const a=(0,j.get)(n,"name"),o=(0,j.get)(e,a);(0,j.set)(i,t,o)}})),(0,j.set)(t,n,i)})),t}}function Gr(e,t){const n={};return(0,j.forOwn)(e,((e,i)=>{const a={};(0,j.forOwn)(e,((e,n)=>{(0,j.forEach)(e,(e=>!function(e,t){let n=!0;return(0,j.forOwn)(t,((t,i)=>{const a=(0,j.get)(e,i)||[];return null==t?n=0===a.length:a.length>0&&(n=a.includes(t)),n})),n}(e,t)||(a[n]=e.value,!1)))})),a&&!(0,j.isEmpty)(a)&&(n[i]=a)})),n}class qr extends $r{constructor(e,t,n,i){super(),this.configLoader=e,this.platformService=t,this.clientPreferences=n,this.loggerFactory=i,this.logger=i.newLogger("CoreSettings/ConfigProviderDynamic")}cleanup(){var e;null===(e=this.clientPreferencesSubscription)||void 0===e||e.unsubscribe()}getSettings(){return this.settings||{}}getConfigId(){const{ecsOverrides:{environment:e}}=this.platformService;return`${e}`}setConfigs(e){var t,n;this.configs=e,this.applyFilters();(null===(n=null===(t=this.settings)||void 0===t?void 0:t.core)||void 0===n?void 0:n.enableLowPerformanceModeCoreSettingsFilter)&&!this.clientPreferencesSubscription&&(this.clientPreferencesSubscription=this.clientPreferences.getPreferenceObservable("performance").subscribe((({mode:e})=>this.applyFilters(e))))}applyFilters(e){if(!this.configs)return void this.logger.error("Failed to apply filters because configs have not yet been defined.");const t=this.getFilters(e),n=Gr(this.configs,t);this.logger.log("Filters:",t),this.logger.log("Filtered settings:",n),this.settings?(0,j.isEqual)(this.settings,n)||(this.settings=n,this.notifySettingsChanged()):this.settings=n}getFilters(e){const{ecsOverrides:{environment:t},config:{platformId:n,vdi:{configFilter:i},osPlatform:a}}=this.platformService;return{environment:t,platform:n,virtualization:i,os:a,performanceMode:e}}}class Jr extends qr{constructor(){super(...arguments),this.providerName="ConfigProviderAsync"}initialize(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const e=this.getConfigId(),t=yield this.configLoader(e);this.setConfigs(t)}))}}class Kr extends qr{constructor(){super(...arguments),this.providerName="ConfigProviderSync"}initialize(){const e=this.configLoader("config");this.setConfigs(e)}}class Qr extends $r{constructor(e,t,n,i){var a;super(),this.settings={},this.providerName="HostProvider",this.logger=t.newLogger("CoreSettings/HostProvider"),n?(this.logger.log("Host settings found."),this.updateSettingsAndCheckForChanges(n)):this.logger.log("No host settings found."),this.notifySettingsChangedDeferred=function(e,t,n){let i;const a=()=>{null==i||i.unsubscribe(),i=void 0},o=()=>{e(),a(),t.debug("Notified about settings change")},r=()=>n&&n.getState()===Dn.pk.VeryActive?(i||(i=n.observe().subscribe((e=>{e!==Dn.pk.VeryActive&&o()}))),t.log(`Postponed settings change notification due to client state being ${Dn.pk[n.getState()]}`),!1):(o(),!0);return r.cancel=a,r}((()=>this.notifySettingsChanged()),this.logger,i),null===(a=e.opener)||void 0===a||a.addEventListener(R.rY.UpdateWindowState,(e=>{var t,n;if(null==e?void 0:e.payload){let i=e.payload;(null===(n=null===(t=e.payload)||void 0===t?void 0:t.hostSettings)||void 0===n?void 0:n.hostSettings)&&(i=e.payload.hostSettings),this.logger.log("Host settings update received, payload:",i),this.updateSettingsAndCheckForChanges(i)&&this.notifySettingsChangedDeferred()}}))}getSettings(){return this.settings}cleanup(){super.cleanup(),this.notifySettingsChangedDeferred.cancel()}updateSettingsAndCheckForChanges(e){const t=Object.assign({},this.settings.host),n=Object.assign({},this.settings.metadata);e.hostSettings&&Object.assign(t,e.hostSettings),e.desktopSettings&&Object.assign(t,e.desktopSettings),this.updateSettings(t,n,e);const i={[b.J.Host]:t,[b.J.Metadata]:n};return(0,j.isEqual)(this.settings,i)?(this.logger.log("Host settings did not change."),!1):(this.settings=i,this.logger.log("Host settings updated to:",this.settings),!0)}updateSettings(e,t,n){var i;if(n.bootstrapData&&(e.authBootstrapData=n.bootstrapData),(null===(i=n.hostSettings)||void 0===i?void 0:i.hostETag)&&(t.hostETag=n.hostSettings.hostETag),n.dataLayerSettings){const t=n.dataLayerSettings,i=t.query||[],a=t.mutation||[],o=t.subscription||[];e.dataLayerSettings={query:i,mutation:a,subscription:o}}}}class Yr extends $r{constructor(e){super(),this.settings={},this.providerName="MaglevHostProvider",this.logger=e.newLogger("CoreSettings/MaglevHostProvider")}initialize(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.getWindowsInsiderChannel(e);this.settings={[b.J.Host]:{windowsInsiderChannel:t}},this.notifySettingsChanged()}))}getSettings(){return this.settings}getWindowsInsiderChannel(e){var t;return(0,l.__awaiter)(this,void 0,void 0,(function*(){try{const n=yield e.loadModule("ecs");return yield null===(t=null==n?void 0:n.getWindowsInsiderChannel)||void 0===t?void 0:t.call(n)}catch(e){this.logger.warn("Unable to get windows insider channel from host:",e)}}))}}const Xr="tmp";var Zr;function es(e,t){return[Xr,null==t?void 0:t.experienceName,null==t?void 0:t.ring,e].filter((e=>!(0,j.isNil)(e))).join(".")}!function(e){e.TestOverrides="settings",e.EcsCache="ecs-settings-cache",e.PolicyCache="policy-cache"}(Zr||(Zr={}));const ts="CachedProvider";class ns extends $r{constructor(e,t,n,i){super(),this.storage=t,this.cacheValid=!1,this.providerName=ts,this.updateCache=()=>(0,l.__awaiter)(this,void 0,void 0,(function*(){if(!this.provider)return;const e=this.provider.getSettings();if(0===Object.keys(e).length)return this.logger.log(`updateCache(): Got empty settings from provider with storage key: ${this.storageKey}. Has cached settings: ${this.hasValidCache}.`),Promise.resolve();this.settings=e,yield this.storage.setItem(this.storageKey,JSON.stringify(this.settings)),this.logger.log(`Cache '${this.storageKey}' updated.`),this.notifySettingsChanged()})),this.storageKey=es(e,i),this.logger=n.newLogger("CoreSettings/CachedProvider")}initialize(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){this.settings=yield this.loadCache()}))}setProvider(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){this.cleanup(),this.provider=e,this.providerName=`CachedProvider:${this.provider.providerName}`,this.subscription=this.provider.subscribe(this.updateCache),yield this.updateCache()}))}getProvider(){return this.provider}getSettings(){return this.settings||{}}getDiagnosticsInfo(){return this.provider?this.provider.getDiagnosticsInfo():super.getDiagnosticsInfo()}get hasValidCache(){return this.cacheValid}cleanup(){var e;this.subscription&&(this.subscription.unsubscribe(),this.subscription=void 0),this.providerName=ts,null===(e=this.provider)||void 0===e||e.cleanup()}loadCache(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){let e={};try{const t=yield this.storage.getItem(this.storageKey);t&&(e=JSON.parse(t),this.cacheValid=!0)}catch(e){this.logger.log(`Error while loading from cache '${this.storageKey}': ${e}`)}return e}))}}class is extends $r{constructor(e,t){super(),this.workerHostSettings=t,this.providerName="WorkerHostProvider",this.logger=e.newLogger("CoreSettings/WorkerHostSettingsProvider"),this.hostSettings={},this.testSettings={},this.logger.log("Worker host settings is initialized",this.hostSettings)}initialize(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const e=yield(0,le.E)(this.workerHostSettings.getHostSettings(),1e4).catch((e=>(this.logger.error(`retrieve worker host setting timed out, the error is ${e}`),{hostSettings:{},testSettings:{}})));this.hostSettings=e.hostSettings,this.testSettings=e.testSettings,this.logger.log("Worker host setting is being initialized")}))}getSettings(){return{[b.J.Host]:this.hostSettings,[b.J.Test]:this.testSettings}}}class as extends $r{constructor(e,t,n){super(),this.loggerFactory=e,this.configLoader=n,this.providerName="ViewportOverrideProvider",this.logger=this.loggerFactory.newLogger("CoreSettings/ViewportOverrideProvider"),this.settings=this.filterSettings(t)}getSettings(){return this.settings}hasOverrides(){return!(0,j.isEmpty)(this.settings)}hasDifferences(e){const t=this.filterSettings(e);return!(0,j.isEqual)(this.settings,t)}filterSettings(e){const t=Gr(this.configLoader("viewportOverrides"),e);return this.logger.debug(`Calculated overrides for ${(0,P.u4)(e)}:`,t),t}}class os extends $r{constructor(e,t,n,i){super(),this.host=t,this.providerName="LocalStorageProvider",this.onStorageEvent=e=>{e.key===this.storageKey&&(this.logger.log("Local storage settings updated."),this.settings=this.loadStorageSettings(),this.notifySettingsChanged())},this.logger=n.newLogger("CoreSettings/LocalStorageProvider"),this.storageKey=es(e,i),this.settings=this.loadStorageSettings(),this.host.addEventListener("storage",this.onStorageEvent)}getSettings(){return this.settings}cleanup(){this.host.removeEventListener("storage",this.onStorageEvent)}setSettings(e){try{this.host.localStorage.setItem(this.storageKey,(0,P.u4)(e))}catch(e){this.logger.log("Could not write settings to local storage, error:",e)}this.settings=e,this.notifySettingsChanged()}loadStorageSettings(){const e=this.host.localStorage.getItem(this.storageKey);if(e)try{return JSON.parse(e)}catch(e){this.logger.log(`Could not parse settings stored in local storage, key: ${this.storageKey}, error: ${e}`)}return{}}}class rs{constructor(e){this.logger=e.newLogger("CoreSettings/QspSettingsParser")}parse(e,t={}){return new URLSearchParams(e).forEach(((e,n)=>{const i=this.parseQspSetting(n,e);i&&(this.logger.log("QSP override: ",i.key,i.value),(0,j.set)(t,i.key,i.value))})),t}parseQspSetting(e,t){const n=this.extractQspKeyObject(e);if("config"===n.config)return{key:`${n.category}.${n.featureName}`,value:this.tryGetBooleanValueOrReturnOriginalValue(t)}}extractQspKeyObject(e){const t=e.split(".");let n="";for(let e=2;e<t.length;e++)n+=t[e],e<t.length-1&&(n+=".");return{config:t[0],category:t[1],featureName:n}}tryGetBooleanValueOrReturnOriginalValue(e){const t=e.toLowerCase();return"true"===t||"false"===t?"true"===t:encodeURIComponent(e)}}class ss extends $r{constructor(e,t,n){super(),this.host=e,this.providerName="QspProvider",this.settings={},t.config.isInternalUser&&(this.parser=new rs(n))}getSettings(){return this.parseQsp(),this.settings}parseQsp(){if(!this.parser)return;const e={};this.host.location.search&&this.parser.parse(this.host.location.search,e);const t=this.getQueryStringFromHash();t&&this.parser.parse(t,e),this.settings=e}getQueryStringFromHash(){const e=this.host.location.hash;if(!e)return null;const t=e.indexOf("?");return t>-1?e.substr(t):null}}var ls;!function(e){e.None="0",e.CitrixXenDesktop="1",e.CitrixXenApp="2",e.VMWare="3",e.WVD="5"}(ls||(ls={}));var cs=n(946101),ds=n(384560);class us extends $r{constructor(e){super(),this.platformService=e,this.providerName="PlatformProvider",this.platformSettings={[b.J.Platform]:{localeCode:this.platformService.config.localeCode,staticsPath:this.platformService.config.staticsPath,clientVersion:this.platformService.config.clientVersion,buildSource:this.getBuildSource(),sessionId:this.platformService.host.sessionId,useEdgeSpecificImages:this.platformService.config.browser===si.AR.Edge,isHtmlInputSelectApiSupported:this.getIsHtmlInputSelectApiSupported(),useMacKeyboardLayout:this.getUseMacKeyboardLayout(),isScreenRecordingPermissionRequired:this.getIsScreenRecordingPermissionRequired(),enableSlotBorderRadius:this.getEnableSlotBorderRadius(),vdi:this.getVdiSettings()},[b.J.Metadata]:{environment:this.platformService.ecsOverrides.environment,ring:{id:this.platformService.ecsOverrides.ring}}}}getSettings(){return this.platformSettings}getVdiSettings(){const{vdi:{provider:e,mode:t,isAvRemoted:n,configFilter:i}}=this.platformService.config;return{provider:(e=>{switch(e){case ls.CitrixXenDesktop:return cs.$w.CitrixXenDesktop;case ls.CitrixXenApp:return cs.$w.CitrixXenApp;case ls.VMWare:return cs.$w.VMWare;case ls.WVD:return cs.$w.WVD;default:return cs.$w.None}})(e),mode:t,isAvRemoted:n,configFilter:i}}getIsHtmlInputSelectApiSupported(){return this.platformService.config.osPlatform!==si.NR.IOS}getUseMacKeyboardLayout(){return this.platformService.config.osPlatform===si.NR.Mac}getIsScreenRecordingPermissionRequired(){if(this.platformService.config.osPlatform!==si.NR.Mac||!this.platformService.config.osVersion)return!1;const e=this.platformService.config.osVersion.toString();return(0,ds.compare)(e,"10.15",">=")}getEnableSlotBorderRadius(){return this.platformService.config.osPlatform===si.NR.Mac}getBuildSource(){return this.platformService.config.clientVersion.includes("local")?"Local":this.platformService.config.clientVersion.includes("-oncdn-")?"Container":void 0}}var ms=n(356452);const ps={audienceGroup:"general",environment:"prod"},gs=(e,t)=>Promise.resolve({baseUrl:e,constructRequest:e=>({apiName:"settings",url:t,method:"GET",headers:e?Object.assign({"If-None-Match":e}):void 0}),allowedResponses:[ms.qb.OK,ms.qb.NOT_MODIFIED,ms.qb.CREATED,ms.qb.NO_CONTENT]});function hs(e){const t=e.client||"MicrosoftTeams";return`${e.hostUrl||"https://config.teams.microsoft.com"}/config/v1/${t}/`}function vs(e){const t=e.platformId||1415,n=e.version||"1.0.0.0";e.filters=e.filters?e.filters:ps;const i=[];if((0,j.forOwn)(e.filters,((e,t)=>{e&&i.push(`${t}=${e}`)})),e.namespaces){const t=e.namespaces.join(",");i.push(`agents=${t},Segmentation`)}else i.push("agents=TeamsNorthstar,Segmentation");return`${t}_${n}${`?${i.join("&")}`}`}const fs=e=>t=>{const{endpointUrl:n,endpointModels:i}=function(e){const t=hs(e),n=vs(e);return{endpointUrl:`${t}${n}`,endpointModels:()=>({serviceName:Zi.EJ.ECS,models:{getEcsSettings:gs(t,n)}})}}(t),a=e.createApi(i);return{endpointUrl:n,fetch:e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){return a.getEcsSettings(e)}))}},ys=e=>function(t){const n=(e=>`${hs(e)}${vs(e)}`)(t);return{endpointUrl:n,fetch:t=>(0,l.__awaiter)(this,void 0,void 0,(function*(){const i=t&&{"If-None-Match":t};try{const t=yield e({url:n,method:"GET",headers:Object.assign({},i),serviceName:Zi.EJ.ECS,apiName:"settings"});return Ss(t)}catch(e){throw e&&"TimedOut"===e.code&&(e=(0,ta.T)(na.A.TimedOut)),e}}))}},Ss=e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){if(![ms.qb.OK,ms.qb.NOT_MODIFIED,ms.qb.CREATED,ms.qb.NO_CONTENT].some((t=>t===e.status)))throw(0,ta.T)(na.A.RequireStatusFailed,e);return e.body.json().catch((()=>{throw(0,ta.T)(na.A.TransformFailed,e)}))}));class ks{constructor(e){this.host=e}setItem(e,t){return this.host.localStorage.setItem(e,t),Promise.resolve()}getItem(e){const t=this.host.localStorage.getItem(e);return Promise.resolve(t)}}class bs{constructor(e,t){this.coreSettingsContext=t,this.providers=[],this.logsProviderName="CoreSettingsLogsProvider",this.logger=e.newLogger("CoreSettingsLogsProvider")}getLogsFiles(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){return[{isPiiSafe:!1,fileName:"settings.json",content:(yield this.getCurrentSettingsSnapshot())||"Could not fetch settings"}]}))}getSystemInfo(){const e=new Map;return this.providers.forEach((({provider:t})=>{const n=t.getDiagnosticsInfo();n&&e.set(t.providerName,(0,P.u4)(n))})),Promise.resolve(e)}registerProvider(e,t){this.providers.push({provider:e,type:t})}getCurrentSettingsSnapshot(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){try{const e=yield this.coreSettingsContext.getDebugService(),t=e.getSettings(),n={settings:this.getGroupedSettings(t),rawPolicies:e.getRawPolicies()};return JSON.stringify(n)}catch(e){this.logger.error("Diagnostics: Failed to get settings snapshot: ",e)}return""}))}getGroupedSettings(e){if(!e||0===e.length)return"";return e.reduce(((e,t)=>{var n;if(void 0===t.value&&(!t.providers||0===t.providers.length))return e;e[t.category]=e[t.category]||{},e[t.category][t.key]={};let i=!1;return null===(n=t.providers)||void 0===n||n.forEach((n=>{e[t.category][t.key][n.shortName]=n.value,(0,j.isEqual)(t.value,n.value)||(i=!0)})),i&&t.providers&&(t.providers.length>1||void 0===t.value)&&(e[t.category][t.key].value=void 0===t.value?"undefined":t.value),e}),{})}}class _s extends $r{constructor(e,t){super(),this.workerHostSettings=t,this.providerName="WorkerHostTestOverridesProvider",this.logger=e.newLogger("CoreSettings/WorkerHostTestOverridesProvider"),this.settings={}}initialize(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const e=yield(0,le.E)(this.workerHostSettings.getHostSettings(),1e4).catch((e=>(this.logger.error(`Retrieving worker host setting timed out, the error is ${e}`),{localStorageTestOverrides:{},qspTestOverrides:{}})));this.settings=(0,j.merge)({},e.localStorageTestOverrides,e.qspTestOverrides),this.logger.log("Worker host test overrides setting is being initialized")}))}getSettings(){return this.settings}}var Cs=n(649189);class ws{constructor(e,t,n,i,a,o,r,s){this.id=e,this.experienceName=t,this.cache=n,this.loggerFactory=i,this.platformService=a,this.clientPreferences=o,this.configLoader=r,this.partitionCacheByExperience=s,this.getChildId=e=>`${this.id}/${e}`,this.logger=this.loggerFactory.newLogger(`CoreSettings/Context(${e})`),this.cleanupFunctions=[],this.logger.log("Created.")}static createContext(e,t,n,i,a,o,r){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const s=new Hr(t),l=new ws("g",e.experienceName,s,t,n,i,o,e.partitionCacheByExperience);yield l.createConfigProviderAsync(),l.createHostProvider(a,r),l.createMaglevHostProvider(),l.createPlatformProvider(n),l.createViewportOverrideProvider({viewportContext:a.viewportContext,entityType:null});const c=new ks(a);return yield l.createEcsCachedProvider(c),yield l.createPolicyCachedProvider(c),l.createLocalStorageProvider(a),l.createQspProvider(a),s.cache(l.id,l),l}))}static createContextForWorker(e,t,n,i,a){const o=new Hr(t),r=new ws(e,e,o,t,n,i,a);return r.createConfigProviderSync(),r.createPlatformProvider(n),o.cache(r.id,r),r}createContextForViewport(e){var t;if(this.logger.log("Acquiring context for viewport params: ",e),!this.viewportOverrideProvider||(null===(t=this.viewportOverrideProvider)||void 0===t?void 0:t.hasDifferences(e))){const t=this.getChildId(`v-${e.viewportContext}-${e.entityType}`);return this.cache.acquire(t,(()=>{const n=this.clone(t);return n.createViewportOverrideProvider(e),n}))}return this.cache.acquire(this.id)}createContextForUser(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const e=this.getChildId("u");return this.cache.acquire(e,(()=>this.clone(e)))}))}cleanup(){this.cache.release(this.id,(()=>{this.logger.log("Cleaning up."),this.cleanupFunctions.forEach((e=>e()))}))}getCoreSettings(){return this.settingsService||(this.settingsService=new Wr(this.id,this.loggerFactory),this.logsProvider||(this.logsProvider=new bs(this.loggerFactory,this)),this.registerProvider(Lr.Configuration,this.configProvider),this.registerProvider(Lr.Configuration,this.platformProvider),this.registerProvider(Lr.Configuration,this.hostProvider),this.registerProvider(Lr.Configuration,this.maglevHostProvider),this.registerProvider(Lr.Configuration,this.workerHostProvider),this.registerProvider(Lr.Configuration,this.ecsCachedProvider),this.registerProvider(Lr.Override,this.viewportOverrideProvider),this.registerProvider(Lr.Policy,this.policyCachedProvider),this.registerProvider(Lr.TestOverride,this.localStorageProvider),this.registerProvider(Lr.TestOverride,this.qspProvider),this.registerProvider(Lr.TestOverride,this.workerTestProvider),this.registerProvider(Lr.TestOverride,this.workerHostTestOverridesProvider),this.cleanupFunctions.push((()=>{this.settingsService&&(this.settingsService.cleanup(),this.settingsService=void 0)}))),this.settingsService}getLogsProvider(){return this.logsProvider||(this.logsProvider=new bs(this.loggerFactory,this)),this.logsProvider}getDebugService(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){if(!this.debugSettingsService){const{DebugSettingsService:e}=yield n.e(26842).then(n.bind(n,571616));this.debugSettingsService=new e(this,this.loggerFactory,this.id)}return this.debugSettingsService}))}initializeMaglevHostProvider(e){var t;return(0,l.__awaiter)(this,void 0,void 0,(function*(){yield null===(t=this.maglevHostProvider)||void 0===t?void 0:t.initialize(e)}))}initializeEcsProvider(e,t,n,i,a,o,r){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const s=yield this.getEcsParameters(e),l=this.getCoreSettings(),{enableEndpointsManagerOnEcs:c}=l.get(b.J.Core),d=new Vr(s,this.loggerFactory,t,o,i,a,((e,t)=>t?fs(t):ys(e))(n,c?r:void 0)),u=l.getObservable(b.J.Core).subscribe((({ecsRefreshIntervalInMs:e})=>{e&&d.updateRefreshInterval(e)}));this.cleanupFunctions.push((()=>{u.unsubscribe()}));let m=!0;const p=d.initialize(!0);return this.ecsCachedProvider&&(this.ecsCachedProvider.hasValidCache||(this.logger.log("ECS cache is invalid, waiting to fetch ECS flags."),m=yield p),yield this.ecsCachedProvider.setProvider(d)),m}))}reinitializeEcsProvider(e){var t;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const n=null===(t=this.ecsCachedProvider)||void 0===t?void 0:t.getProvider();if(!n)return;const i=yield this.getEcsParameters(e);return n.updateEcsParametersAndFetchSettings(i)}))}initializePolicyProvider(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{enablePoliciesDefaultValues:t}=this.getCoreSettings().get(b.J.Core),n=new zr(this.loggerFactory,e,this.configLoader,!!t);if(this.policyCachedProvider){const e=n.initialize();this.policyCachedProvider.hasValidCache||(this.logger.log("Policy cache is invalid, waiting to fetch policies."),yield e),yield this.policyCachedProvider.setProvider(n)}}))}initializeWorkerProviders(e,t){return(0,l.__awaiter)(this,void 0,void 0,(function*(){yield this.createWorkerHostProvider(t),yield this.createEcsCachedProvider(e),yield this.createWorkerTestProvider(e),yield this.createWorkerHostTestOverridesProvider(t),this.settingsService&&(this.registerProvider(Lr.Configuration,this.workerHostProvider),this.registerProvider(Lr.Configuration,this.ecsCachedProvider),this.registerProvider(Lr.TestOverride,this.workerTestProvider),this.registerProvider(Lr.TestOverride,this.workerHostTestOverridesProvider),this.settingsService.notifySettingsChanged())}))}getLocalStorageTestOverrides(){var e;return null===(e=this.localStorageProvider)||void 0===e?void 0:e.getSettings()}getQspTestOverrides(){var e;return null===(e=this.qspProvider)||void 0===e?void 0:e.getSettings()}clone(e){const t=new ws(e,this.experienceName,this.cache,this.loggerFactory,this.platformService,this.clientPreferences,this.configLoader,this.partitionCacheByExperience);return t.configProvider=this.configProvider,t.ecsCachedProvider=this.ecsCachedProvider,t.hostProvider=this.hostProvider,t.maglevHostProvider=this.maglevHostProvider,t.policyCachedProvider=this.policyCachedProvider,t.qspProvider=this.qspProvider,t.localStorageProvider=this.localStorageProvider,t.platformProvider=this.platformProvider,t}registerProvider(e,t){this.settingsService&&t&&(this.logsProvider||(this.logsProvider=new bs(this.loggerFactory,this)),this.settingsService.registerProvider(t,e),this.logsProvider.registerProvider(t,e))}createConfigProviderAsync(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){this.configProvider=new Jr(this.configLoader,this.platformService,this.clientPreferences,this.loggerFactory),yield this.configProvider.initialize(),this.cleanupFunctions.push((()=>{this.configProvider&&this.configProvider.cleanup()}))}))}createConfigProviderSync(){this.configProvider=new Kr(this.configLoader,this.platformService,this.clientPreferences,this.loggerFactory),this.configProvider.initialize(),this.cleanupFunctions.push((()=>{this.configProvider&&this.configProvider.cleanup()}))}createHostProvider(e,t){this.hostProvider=new Qr(e,this.loggerFactory,t),this.cleanupFunctions.push((()=>{this.hostProvider&&this.hostProvider.cleanup()}))}createMaglevHostProvider(){this.maglevHostProvider=new Yr(this.loggerFactory),this.cleanupFunctions.push((()=>{this.maglevHostProvider&&this.maglevHostProvider.cleanup()}))}createEcsCachedProvider(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{ring:t}=this.platformService.ecsOverrides,n="general"===t?void 0:t,i=this.partitionCacheByExperience?this.experienceName:void 0;this.ecsCachedProvider=new ns(Zr.EcsCache,e,this.loggerFactory,{experienceName:i,ring:n}),yield this.ecsCachedProvider.initialize(),this.cleanupFunctions.push((()=>{this.ecsCachedProvider&&this.ecsCachedProvider.cleanup()}))}))}createWorkerTestProvider(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){this.workerTestProvider=new ns(Zr.TestOverrides,e,this.loggerFactory),yield this.workerTestProvider.initialize(),this.cleanupFunctions.push((()=>{this.workerTestProvider&&this.workerTestProvider.cleanup()}))}))}createWorkerHostTestOverridesProvider(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){this.workerHostTestOverridesProvider=new _s(this.loggerFactory,e),yield this.workerHostTestOverridesProvider.initialize(),this.cleanupFunctions.push((()=>{this.workerHostTestOverridesProvider&&this.workerHostTestOverridesProvider.cleanup()}))}))}createWorkerHostProvider(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){this.workerHostProvider=new is(this.loggerFactory,e),yield this.workerHostProvider.initialize(),this.cleanupFunctions.push((()=>{this.workerHostProvider&&this.workerHostProvider.cleanup()}))}))}createViewportOverrideProvider(e){this.viewportOverrideProvider=new as(this.loggerFactory,e,this.configLoader),this.cleanupFunctions.push((()=>{this.viewportOverrideProvider&&this.viewportOverrideProvider.cleanup()}))}createPolicyCachedProvider(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){this.policyCachedProvider=new ns(Zr.PolicyCache,e,this.loggerFactory),yield this.policyCachedProvider.initialize(),this.cleanupFunctions.push((()=>{this.policyCachedProvider&&this.policyCachedProvider.cleanup()}))}))}createLocalStorageProvider(e){this.localStorageProvider=new os(Zr.TestOverrides,e,this.loggerFactory),this.cleanupFunctions.push((()=>{this.localStorageProvider&&this.localStorageProvider.cleanup()}))}createQspProvider(e){this.qspProvider=new ss(e,this.platformService,this.loggerFactory),this.cleanupFunctions.push((()=>{this.qspProvider&&this.qspProvider.cleanup()}))}createPlatformProvider(e){this.platformProvider=new us(e)}getUserProfileFromRingFinder(){try{const e=Cs.get("ringFinder");if(!e)return;return JSON.parse(decodeURIComponent(e))}catch(e){return void this.logger.error(`Error parsing ringFinder cookie when user not authenticated: ${e}`)}}getUserProfile(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){let t;try{const n=yield e.getUser();t=null==n?void 0:n.profile}catch(e){this.logger.warn("Can't get user: ",e)}return t||(t=this.getUserProfileFromRingFinder()),t}))}getEcsParameters(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.getUserProfile(e),{ecsOverrides:n,config:{platformId:i,buildVersion:a,vdi:{configFilter:o},osPlatform:r}}=this.platformService,{ecsNamespaces:s,ecsEndpoint:l,enableEcsNativeRingResolution:c}=this.getCoreSettings().get(b.J.Core),d=this.getRingFilters(n,c),{windowsInsiderChannel:u}=this.getCoreSettings().get(b.J.Host);return{hostUrl:n.hostUrl||l,platformId:i,namespaces:s,filters:Object.assign(Object.assign({},d),{experience:this.experienceName,virtualization:o,osPlatform:r,wip:u,id:null==t?void 0:t.oid,aaduserid:null==t?void 0:t.oid,tenantId:null==t?void 0:t.tid,experienceBuild:this.parseBuildVersion(a),desktopVersion:this.getDesktopVersion()})}}))}getRingFilters(e,t){const{environment:n="prod",ring:i,originalRing:a}=e,o={environment:n};return t&&!a||(o.audienceGroup=i,o.teamsRing=i),o}parseBuildVersion(e){if(e){if(e.includes("-oncdn-"))return"99999999999";const t=parseInt(e,10);if(!isNaN(t))return t.toString()}}getDesktopVersion(){const{desktopVersion:e}=this.getCoreSettings().get(b.J.Host);if(e){const t=e.indexOf("/");return t>-1?e.substr(t+1):e}return this.platformService.host.hostAppVersion}}class Ts{constructor(){this.id=S.Yg.CreateSettings,this.registerShellHandlers=(e,t)=>{var n;null===(n=e.opener)||void 0===n||n.addEventListener(R.rY.GetSettings,(()=>(0,l.__awaiter)(this,void 0,void 0,(function*(){return t.getCurrentSettingsSnapshot().then((t=>e.opener.postMessage(R.rY.GetSettings,{settings:t})),(()=>e.opener.postMessage(R.rY.GetSettings,{settings:""})))}))))}}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{hostSettings:t}=e,{clientPreferences:n,config:i,configLoader:a,diagnosticsService:o,loggerFactory:r,logsCollectorService:s,platformService:l,windowProvider:c}=Ko("CreateCoreSettingsTask",e,"clientPreferences","config","configLoader","diagnosticsService","loggerFactory","logsCollectorService","platformService","windowProvider"),d=yield ws.createContext(i,r,l,n,c,a,t),u=d.getCoreSettings(),m=d.getLogsProvider();e.coreSettingsContext=d,e.coreSettings=u,o.subscribeToCoreSettings(u),s.subscribeToCoreSettings(u),s.registerLogsProvider(m),this.registerShellHandlers(c,m)}))}}class Es{constructor(){this.id=S.Yg.CreateCoreUtilities}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{isEntityInView:t}=Ko("CreateCoreUtilitiesTask",e,"isEntityInView");e.coreUtilities={isEntityInView:t}}))}}var Is=n(949318);const Ns=["lockedTiles","pinnedTiles","mostRecentlyUsedTiles","activeCalls","activeMeetings","appsInstalledByCurrentUser","recentMeetings","pinnedMeetings","requestImmersiveReader","activeWindow","activeWindowForEntity","activeWindows","appsUsage","fetchDynamicCommandsV2","bannerNotificationQueue","callingScreenLayout","meetingRoomLayoutToggleState","callingScreenStatus","clientPreferences","allClientPreferences"],As=["updateActiveCalls","setActiveCalls","removeWindow","executeEntityCommand","updateEntityState","updateExtendedEntityContainerState","recordAppUsage","recordAppActionUsage","recordAppSceneUsage","performWindowHistoryNavigation","setCallingScreenLayout","updateMeetingRoomLayoutToggleState","toggleParticipantPin","setCallingScreenStatus","updateClientPreferences","updateEntity"],Ms=["appsInstalledByCurrentUserEvent","appsUsageUpdateEvent","dynamicCommandsUpdateEvent","launchTileUpdatedEvent","callParticipantPinnedEventv2"],Fs=["chat","messages","installedAppsV2"],Rs=[...Ns,"lpcState"],Ps={query:"ROOT_QUERY",mutation:"ROOT_MUTATION",subscription:"ROOT_SUBSCRIPTION"};var Ds=n(72442);const js=n(853072);class xs{constructor(){this._activeOperations=new Map,this._inactiveOperations=new Map,this._windowToDataMap=new Map,this._dataToWindowMap=new Map}trackOperation(e,t){const{fetchPolicy:n,variables:i}=e,a=e.query||e.mutation;if("no-cache"===n)return;((e,t)=>{const n=(0,Is.p$)(e),{operation:i,selectionSet:{selections:a}}=n,o=Ps[i];return a.filter((e=>"Field"===e.kind&&!Rs.includes(e.name.value))).map((e=>e.name.value)).map((e=>({id:o,fieldName:e,args:t})))})(a,i).forEach((e=>{const n=(e=>{const t=js(e);return(0,Ds.Z)(t)})(e);this._activeOperations.set(n,e),this.addDataForWindow(t,n),this._inactiveOperations.has(n)&&this._inactiveOperations.delete(n)}))}markDataForWindowAsInactive(e){const t=this._windowToDataMap.get(e)||[];this._windowToDataMap.delete(e),t.forEach((t=>{const n=this._dataToWindowMap.get(t);if(n&&(n.delete(e),n.size))return;const i=this._activeOperations.get(t);i&&this._inactiveOperations.set(t,i),this._dataToWindowMap.delete(t),this._activeOperations.delete(t)}))}flush(e=this._inactiveOperations.size){const t=[],n=[];let i=0;return this._inactiveOperations.forEach(((a,o)=>{i>=e||(t.push(a),n.push(o),Fs.includes(a.fieldName)&&(i=e),i++)})),n.forEach((e=>this._inactiveOperations.delete(e))),{descriptors:t,hasMore:!!this._inactiveOperations.size}}addDataForWindow(e,t){let n=this._windowToDataMap.get(e);n||(n=new Set,this._windowToDataMap.set(e,n)),n.add(t);let i=this._dataToWindowMap.get(t);i||(i=new Set,this._dataToWindowMap.set(t,i)),i.add(e)}}var Os=n(95181),Ls=n(959577),Us=n(988576),Bs=n(159153),Ws=n(669673),Hs=n(81749),$s=n(416138);class Vs{constructor(e,t,n,i){var a;this.client=n,this.name=i,this.ctx=t,this.services=e,null===(a=this.services.leakDetector)||void 0===a||a.track("dataClient",this)}updateContext(e,t){this.ctx=e,this.client.setLink(t)}destroy(){this.ctx=void 0,this.services=void 0}getServices(){return this.services}__UNSAFE_getApolloClientReferencesForDebugPanel(){return{self:this.client,parent:null,selfIsMainClient:!1}}mutate(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const t=this.getApolloClientInstance(e.mutation),n=this.patchOptions(e);return t.mutate(n)}))}query(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const t=this.getApolloClientInstance(e.query),n=this.patchOptions(e);return t.query(n)}))}readQuery(e,t){return this.getApolloClientInstance(e.query).readQuery(e,t)}subscribe(e){return this.getApolloClientInstance(e.query).subscribe(e)}watchQuery(e){try{const t=this.getApolloClientInstance(e.query),n=this.patchOptions(e);return t.watchQuery(n)}catch(e){return new Is.y$((t=>t.error(e)))}}writeQuery(e){return this.getApolloClientInstance(e.query).writeQuery(e)}writeFragment(e){return this.getApolloClientInstance(e.fragment).writeFragment(e)}readFragment(e,t){return this.getApolloClientInstance(e.fragment).readFragment(e,t)}getApolloClientInstance(e){return this.client}patchOptions(e){const{context:t}=e,n=(0,l.__rest)(e,["context"]);return Object.assign(Object.assign({},n),{context:Object.assign(Object.assign({},this.ctx),t)})}}const zs=e=>e;class Gs extends Vs{constructor(e,t,n,i){super(e,i,n,i.windowId||"INVALID"),this.parent=t}clone(e){throw new Error("Trying to clone child instance")}__UNSAFE_getApolloClientReferencesForDebugPanel(){return{self:this.client,parent:this.parent,selfIsMainClient:!1}}getApolloClientInstance(e){const t=(0,Is.p$)(e);if("OperationDefinition"===t.kind||"FragmentDefinition"===t.kind){const{selectionSet:{selections:n}}=t,i=this.getSharedGlobalOperationsList(t),a=n.map((e=>"Field"===e.kind&&-1===i.indexOf(e.name.value)));if(a.every(zs))return this.client;if(a.some(zs))throw(0,Z.Tr)("ChildDataClient",S.jK.InvalidInput,"route",{operation:e},"Operation contains mix of shared and window private selections")}return this.parent}getSharedGlobalOperationsList(e){return"OperationDefinition"===e.kind&&"mutation"===e.operation?As:"OperationDefinition"===e.kind&&"subscription"===e.operation?Ms:Ns}}class qs extends Vs{constructor(e,t,n){super(e,n,t,n.windowId||"INVALID")}clone(e){throw new Error("Trying to clone child instance")}__UNSAFE_getApolloClientReferencesForDebugPanel(){return{self:this.client,parent:null,selfIsMainClient:!!this.ctx&&this.ctx.windowId===S.ew}}}class Js extends Vs{constructor(e,t,n){super(e,n,t(),n.windowId||S.ew),this.createApolloClient=t}clone(e){return e.windowId===S.ew?new qs(this.getServices(),this.client,Object.assign(Object.assign({},this.ctx),e)):new Gs(this.getServices(),this.client,this.createApolloClient(),Object.assign(Object.assign({},this.ctx),e))}}class Ks extends qs{constructor(e,t,n,i,a){super(e,t,n),this.dataOpsTracker=i,this.dataReleaseService=a}mutate(e){const t=Object.create(null,{mutate:{get:()=>super.mutate}});return(0,l.__awaiter)(this,void 0,void 0,(function*(){return t.mutate.call(this,e).then((t=>(this.trackReadOperation(e),t)))}))}query(e){const t=Object.create(null,{query:{get:()=>super.query}});return(0,l.__awaiter)(this,void 0,void 0,(function*(){return t.query.call(this,e).then((t=>(this.trackReadOperation(e),t)))}))}readQuery(e,t){try{const n=super.readQuery(e,t);return this.trackReadOperation(e),n}catch(e){throw e}}subscribe(e){return super.subscribe(e).map((t=>(this.trackReadOperation(e),t)))}watchQuery(e){return this.trackReadOperation(e),super.watchQuery(e)}writeQuery(e){return this.trackWriteOperation(e),super.writeQuery(e)}writeFragment(e){return this.trackWriteOperation(e),super.writeFragment(e)}trackReadOperation(e){this.ctx&&this.dataOpsTracker.trackOperation(e,this.name)}trackWriteOperation(e){this.ctx&&this.dataReleaseService.trackWriteOperation(e)}}class Qs{constructor(e){this.cache=e}trackWriteOperation(e){const{id:t}=e;t&&!t.startsWith("ROOT_")&&this.cache.release(t)}}class Ys extends Vs{constructor(e,t,n,i){super(e,n,t,n.windowId||S.ew),this.dataOpsService=i}destroy(){super.destroy()}clone(e){const t=new Qs(this.client.cache);return new Ks(this.getServices(),this.client,Object.assign(Object.assign({},this.ctx),e),this.dataOpsService,t)}}var Xs=n(868546);const Zs={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"WriteCallingDefaults"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callingDebugTool"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"visible"}},{kind:"Field",name:{kind:"Name",value:"passiveBarHiddenParticipantsCount"}}]}},{kind:"Field",name:{kind:"Name",value:"streamPermissionsDebug"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"acknowledged"}},{kind:"Field",name:{kind:"Name",value:"acknowledgementRequired"}},{kind:"Field",name:{kind:"Name",value:"url"}}]}},{kind:"Field",name:{kind:"Name",value:"pptSharingSession"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"_"}}]}},{kind:"Field",name:{kind:"Name",value:"isFake"}},{kind:"Field",name:{kind:"Name",value:"calls"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]};const el={callingDebugTool:{__typename:"CallingDebugTool",visible:!0,passiveBarHiddenParticipantsCount:0},streamPermissionsDebug:{__typename:"StreamPermissionsDebug",acknowledged:!1,acknowledgementRequired:!1,url:"https://www.microsoft.com/"},pptSharingSession:{__typename:"ActivePptSession",_:!1},isFake:!1,calls:[]},tl={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"lpcState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lpcState"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isLivePersonaCardInitialized"}}]}}]}}]},nl={Query:{lpcState:(e,t,{cache:n})=>n.readQuery({query:tl})},Mutation:{setLpcState(e,{newLpcState:t},{cache:n}){const i={lpcState:Object.assign(Object.assign({},t),{__typename:"LpcState"})};return n.writeQuery({query:tl,data:i}),i.lpcState}}};var il=n(192320);function al(e){(0,il.k)(e),function(e){(0,Xs.tW)(e),(0,Xs.bC)(e),e.writeQuery({query:Zs,data:el})}(e),function(e){e.writeQuery({query:tl,data:{lpcState:{__typename:"LpcState",isLivePersonaCardInitialized:!1}}})}(e)}var ol=n(570650),rl=n(380573);function sl({resolvers:e,contextValue:t}){return new $s.i0(((n,i)=>{const a=function(e,t){const{query:n}=e,i=(0,Is.p$)(n);if("OperationDefinition"!==i.kind)return;const{operation:a,selectionSet:{selections:o}}=i;if("mutation"!==a)return;const r=function(e,t){let n;return e.forEach((e=>{if("Field"===e.kind){const i=function(e,t){let n;return t.forEach((({Mutation:t})=>{t[e]&&(n=n||t[e])})),n}(e.name.value,t);if(i){if(n)throw new Error("There cannot be more than 1 matching forward resolver for a document");n={selection:e,resolver:i}}}})),n}(o,t);if(!r)return;return function(e){if(!e.arguments.every((({name:e,value:t})=>"Variable"!==t.kind||t.name.value===e.value))){const t=e.arguments.map((e=>e.name.value)).join(","),n=e.arguments.map((e=>e.value.name.value)).join(",");throw new Error(`Argument name mismatch. Mutation queries, which have forward mutation resolvers should \n                    have a 1-1 name match between the document variable names and the field resolver variable names.\n                    Allowed argument names ${t} does not match the supplied argument names ${n}`)}}(r.selection),r.resolver}(n,e);if(!a)return i(n);const o=n.getContext();return(0,rl.p4)(a(n.variables,Object.assign(Object.assign({},t),o))).flatMap((e=>(n.variables=e,i(n))))}))}var ll=n(466489),cl=n(109458);function dl(e){return"subscription"===e.operationType}function ul(e){const{operation:t,graphQLErrors:n,operationType:i}=e,a=t.getContext(),o={operationName:t.operationName,operationType:i,rendererId:a.windowId};return n&&n.length>0&&(o.errors=n.map((e=>function(e,t){let n=S.jK.UnhandledRuntimeException;const i={path:t};if(!e)return i;e.code?n=e.code:"Failed to fetch"===e.message&&(n=S.jK.FailedToFetch);if(i.code=n,i.message=e.message,e.hasOwnProperty("serverResponse")&&e.serverResponse){"number"==typeof e.serverResponse.status&&(i.status=e.serverResponse.status),i.mscv=e.serverResponse.headers["ms-cv"],i.xmsCorrelationId=e.serverResponse.headers["x-ms-correlation-id"];try{i.contextId=JSON.stringify(e.serverResponse.headers.contextid),i.message=JSON.stringify(e.serverResponse.body)}catch(e){}}return i}(e.originalError,e.path&&e.path.join("::"))))),o}function ml(e,t,n){!pl(e)&&n&&function(e,t,n){const i=ul(e);if(i.errors&&i.errors.length>0){!function(e,t){const{operation:n,graphQLErrors:i,operationType:a}=e;t.error(`'${n.operationName}' operation of type '${a}' failed.`);const o=i.reduce(((e,t)=>`${e}${t.originalError?`['${t.originalError.message}']`:""}`),"");t.error("Errors",o)}(e,t);const a=Object.assign(Object.assign({},i),{errors:JSON.stringify(i.errors),"Panel.WindowID":i.rendererId});i.errors[0].code===S.jK.FailedToFetch?n.cancel(a):n.fail(a)}else n.stop({operationName:i.operationName,operationType:i.operationType,"Panel.WindowID":i.rendererId})}(e,t,n)}function pl(e){return dl(e)}function gl(e,t){const n=e.newLogger("TrackRequestLink");return new $s.i0(((e,i)=>{const{query:a}=e,{operation:o}=(0,cl.S)(a,null),r=i(e);let s=function(e,t){let n;return pl(e)||(n=t.newScenario(A.RG.QueryExecution)),n}({operationType:o,operation:e},t);return new Is.y$((t=>{let i;try{i=r.subscribe({next:i=>{i.errors&&i.errors.length>0?ml({operation:e,operationType:o,graphQLErrors:i.errors,response:i},n,s):function(e,t){if(!dl(e)&&t){const n=ul(e);t.mark(A.ck.QueryResult,{operationName:n.operationName,operationType:n.operationType,"Panel.WindowID":n.rendererId})}}({operation:e,operationType:o,response:i},s),t.next(i)},error:i=>{const a=(e=>e&&e.result?e.result.errors:e instanceof Error?[new ll._("Unhandled exception",void 0,void 0,void 0,void 0,e)]:[new ll._("Unknown error payload provided from forward link")])(i);ml({operation:e,operationType:o,graphQLErrors:a},n,s),t.error(i)},complete:()=>{ml({operationType:o,operation:e},n,s),s=void 0,t.complete()}})}catch(t){throw ml({operationType:o,operation:e,graphQLErrors:[new ll._("Unhandled exception in forward link",void 0,void 0,void 0,void 0,t)]},n,s),s=void 0,t}return()=>{ml({operationType:o,operation:e},n,s),s=void 0,i&&i.unsubscribe()}}))}))}const hl=new class{constructor(){this.map=new Map}destroy(e){const t=this.map.get(e);t&&(t.subscriptions.forEach((e=>{e.next(void 0),e.complete()})),t.subscriptions.length=0,this.map.delete(e))}register(e){if(!this.map.has(e)){const t=new Is.y$((t=>{const{subscriptions:n}=this.map.get(e)||{};n&&n.push(t)}));this.map.set(e,{cancellationObservable:t,subscriptions:[]})}return this.map.get(e).cancellationObservable}};function vl(e){hl.destroy(e)}function fl(e,t){const n=e.newLogger("TrackSubscriptionLinks");return new $s.i0(((e,i)=>{const{eventsWithoutCancellationListener:a}=t.get(b.J.Calling),{operationName:o,query:r}=e,{operation:s}=(0,cl.S)(r,null);if("subscription"!==s||(null==a?void 0:a.includes(o)))return i(e);const l=(0,Be.v4)(),c=hl.register(l);n.debug(`Forwarding request ${l} for operation ${o}`),e.setContext((e=>Object.assign(Object.assign({},e),{cancellationListener:c})));const d=i(e);return new Is.y$((e=>{let t;try{t=d.subscribe({next:t=>{var n;(null===(n=null==t?void 0:t.errors)||void 0===n?void 0:n.length)&&vl(l),e.next(t)},error:t=>{vl(l),e.error(t)},complete:()=>{vl(l),e.complete()}})}catch(e){throw vl(l),e}return()=>{vl(l),t&&t.unsubscribe()}}))}))}function yl(e){const t=new Map;if(!e)throw new Error("Need an operation name to support");return new $s.i0(((n,i)=>{if(!((e,t)=>{const{query:n}=e,i=(0,Is.p$)(n);if(!i||"OperationDefinition"!==i.kind)return!1;const{selectionSet:{selections:a}}=i,{operation:o}=(0,cl.S)(n,null);if("subscription"!==o)return!1;if(a.length>1)throw new Error("There cannot be more than 1 selection for this link");const r=a[0];if("Field"===r.kind&&r.name.value===t){if(r.arguments.every((({name:e,value:t})=>"Variable"!==t.kind||t.name.value===e.value)))return!0;throw new Error("Argument name must match value")}return!1})(n,e))return i(n);const a=(o=n.variables,JSON.stringify(Object.keys(o).sort().map((e=>{const t=o[e];if(-1!==["boolean","string"].indexOf(typeof t)||null===t||Number.isSafeInteger(t))return[e,t];throw new Error("Unsupported argument type")}))));var o;return new Is.y$((e=>{const o=t.get(a);if(o)o.observersCollection.push(e);else{const o=i(n).subscribe({next:e=>{t.get(a).observersCollection.slice().forEach((t=>{t.next(e)}))},error:e=>{const{observersCollection:n}=t.get(a);t.delete(a);for(const t of n)t.error(e)},complete:()=>{const{observersCollection:e}=t.get(a);t.delete(a);for(const t of e)t.complete()}});t.set(a,{observersCollection:[e],forwardSubscription:o})}return()=>{const n=t.get(a);if(!n)return;const{observersCollection:i,forwardSubscription:o}=n,r=i.indexOf(e);-1!==r&&(i.splice(r,1),0===i.length&&(t.delete(a),o&&o.unsubscribe()))}}))}))}var Sl=n(513830);function kl(){return new $s.i0(((e,t)=>t(e).map((t=>{if(!t.data||!e.query)return t;const{definitions:n}=e.query,i=n.find((e=>e.kind===Sl.h.OPERATION_DEFINITION));if(!i||!i.selectionSet)return t;try{const e=i.selectionSet.selections,n=bl(_l(t.data),e);return t.data=n,t}catch(e){return t}}))))}function bl(e,t){for(const n of t){if(n.kind!==Sl.h.FIELD)continue;const t=n.name.value;if("__typename"!==t)if(t in e){if(null!==e[t]&&n.selectionSet&&n.selectionSet.selections){e[t]=_l(e[t]);const i=n.selectionSet.selections;bl(e[t],i)}}else e[t]=null}return e}function _l(e){return Array.isArray(e)?e.slice():"object"==typeof e?Object.assign({},e):e}function Cl(e){return new $s.i0((t=>{const{query:n,variables:i,operationName:a}=t,o=t.getContext(),r={callerInfo:null==o?void 0:o.callerInfo,callerScenarioId:null==o?void 0:o.callerScenarioId};return e.execute(n,i,a,null==o?void 0:o.rendererId,null==o?void 0:o.windowId,r)}))}var wl=n(517285);class Tl{constructor(){this.IPCTimesByOperationName=new Map}static getInstance(){return this.subscriptionEventAggregatorSingleton||(this.subscriptionEventAggregatorSingleton=new Tl),this.subscriptionEventAggregatorSingleton}init(e,t){this.logger=e.newLogger("SubscriptionEventAggregator"),this.intervalCancellationToken=setInterval((()=>{this.logStats(t)}),wl.A_)}addToTimeline(e,t,n){if(this.intervalCancellationToken||this.init(t,n),!e.responseSendTime)return void(this.logger&&this.logger.log("Received subscription perf stat without responseSendTime. Ignoring."));const i=Date.now()-e.responseSendTime;if(!(i<0)&&(e.operationName&&!this.IPCTimesByOperationName.has(e.operationName)&&this.IPCTimesByOperationName.set(e.operationName,[]),e.operationName)){const t=this.IPCTimesByOperationName.get(e.operationName);t&&t.push(i)}}logStats(e){const t=Array.from(this.IPCTimesByOperationName.entries());this.IPCTimesByOperationName.clear();for(const[n,i]of t){const t={operationName:n,numberOfRequests:i.length,averageIPCTimeOneWay:i.reduce(((e,t)=>e+t),0)/i.length};e.newScenario(A.RG.CentralDataLayerSubscription).stop(t)}}}class El{constructor(e,t){this.internalPerfStat={operationName:t,requestTime:performance.now(),responseTime:void 0,workerResponseTime:0,dataStorePerfStats:[],responseSendTime:void 0},this.operationName=t||"",this.operationType=e,performance.mark(`${this.getPerformanceName()}-start`)}stopMeasurement(e,t,n){return this.internalPerfStat.responseTime=performance.now(),this.internalPerfStat=Object.assign(Object.assign({},this.internalPerfStat),e),"subscription"===this.operationType&&Tl.getInstance().addToTimeline(this.internalPerfStat,t,n),0===performance.getEntriesByName(`${this.getPerformanceName()}-start`).length&&performance.mark(`${this.getPerformanceName()}-start`),performance.mark(`${this.getPerformanceName()}-end`),performance.measure(this.getPerformanceName(),`${this.getPerformanceName()}-start`,`${this.getPerformanceName()}-end`),performance.clearMarks(`${this.getPerformanceName()}-start`),performance.clearMarks(`${this.getPerformanceName()}-end`),{totalRequestTime:this.internalPerfStat.responseTime-this.internalPerfStat.requestTime,workerResponseTime:this.internalPerfStat.workerResponseTime}}getPerformanceName(){return`cdl-request-${this.operationName||this.operationType}`}}const Il=["callParticipantsVoiceLevelsChangedEvent","callParticipantsChangedEvent"],Nl=["callingIntent","chat","messageList"],Al=["putConversations"],Ml="debug";class Fl{constructor(e,t,n,i,a,o,r,s,l,c,d=[],u,m){var p;this._logger=a,this.loggerFactory=o,this.scenarioFactory=r,this.syncEngineInitializationPromise=s,this.rendererId=l,this.requestHealthMonitor=u,this.enableClassBasedErrors=m,this._scenario=void 0,this._requestId=e,this._windowId=c,this._requestType=t,this._perfStats=new El(t,i),this._requestComplete=!1,this._operationName=i,this._loggingContext={requestId:e,component:"RequestHandler",requestRendererId:this.rendererId,requestWindowId:this.windowId,hostRendererId:n,operationType:t,operationName:i},d=d&&d.length?d:Al,this.subject=new Da(this._logger,this._loggingContext),this.logRequest(),i&&!d.includes(i)&&"subscription"!==t&&(this._scenario=this.scenarioFactory.newScenario(A.RG.CentralDataLayeRequest),this._scenario.clientName=i,this._scenario.appendEventData({operationName:i,operationType:t,context:this.rendererId,"Panel.WindowID":this.windowId}),this.isRequestFromWindowLaunch(i,r)&&r.startStep(A.RG.WindowLaunchTime,A.ck.FetchWait)),null===(p=this.requestHealthMonitor)||void 0===p||p.requestCreated(this)}get requestId(){return this._requestId}get windowId(){return this._windowId}get response(){return this.subject.observable}get requestType(){return this._requestType}get operationName(){return this._operationName}isComplete(){return this._requestComplete}setResponseAndEndScenario(e){const t=!e.errors&&e.data;t?this.onSuccess(e):this.onError(e),this.onComplete(t?"success":"error")}cancel(){this._requestComplete||(this._requestComplete=!0,this._scenario&&this._scenario.incomplete(),this.onComplete("cancelled"))}onComplete(e){var t;this._requestComplete&&(this.subject.onComplete(),null===(t=this.requestHealthMonitor)||void 0===t||t.requestCompleted(this,e))}onSuccess(e){this.mergeAndEndStatsSnapshot(e.extensions&&e.extensions.perfStats),this.logResponse(),this.subject.onNext(e)}onError(e){var t,n;this._requestComplete=!0;const i=(null==e?void 0:e.errors)||"Unexpected: data layer query response missing both data and error",a=Array.isArray(i)?i.map((e=>(0,Z.VK)(e))).join():(0,Z.VK)(i);if(this.mergeAndEndStatsSnapshot(null===(t=e.extensions)||void 0===t?void 0:t.perfStats,a),this.enableClassBasedErrors)this.subject.onNext(e);else{let t=e.errorCode;!t&&(null===(n=e.errors)||void 0===n?void 0:n.length)&&(t=e.errors[0].name||S.jK.RemoteOperationFailed),t||(t=S.jK.InvalidResponse);const i=(0,Z.Tr)(S.w5.DataLayerClient,t,"onError",void 0,a);this._logger.error(`error while processing ${this._requestId}: ${i.message} (reason: ${i.reason})`,this._loggingContext,t),this.subject.onError(i)}}mergeAndEndStatsSnapshot(e,t){let n;e&&(n=this._perfStats.stopMeasurement(e,this.loggerFactory,this.scenarioFactory)),this._scenario&&(t?this.syncEngineInitializationPromise.then((e=>{var i,a;e?null===(i=this._scenario)||void 0===i||i.fail(Object.assign(Object.assign({},n),{errors:(0,G.A)(t)})):null===(a=this._scenario)||void 0===a||a.incomplete(Object.assign(Object.assign({},n),{errors:(0,G.A)(t)}))})):(this._scenario.stop(n),this.isRequestFromWindowLaunch(this.operationName,this.scenarioFactory)&&this.createWltSteps(n)))}logResponse(){this._logger[this.getLogLevel()]("Received response data for request",this._loggingContext)}createWltSteps(e){const t=this.scenarioFactory.findScenario(A.RG.WindowLaunchTime);t&&t.currentStep!==A.ck.FetchProcessResponse&&(e&&(t.mark(A.ck.FetchWaitIpc,{offsetCurrentTimeInMs:Math.round(e.workerResponseTime)}),t.mark(A.ck.FetchWaitWorker)),t.startStep(A.ck.FetchProcessResponse))}isRequestFromWindowLaunch(e,t){return!!t.findScenario(A.RG.WindowLaunchTime)&&Nl.indexOf(e)>-1}logRequest(){this._logger.debug("Created new request",this._loggingContext)}getLogLevel(){var e;return Il.indexOf(null!==(e=this._loggingContext.operationName)&&void 0!==e?e:"")>=0?Ml:"log"}}class Rl extends Fl{onSuccess(e){super.onSuccess(e),this._requestComplete=!0}}class Pl extends Fl{onSuccess(e){super.onSuccess(e),this._requestComplete=!0}}class Dl extends Fl{onSuccess(e){super.onSuccess(e)}}var jl=n(940822);class xl{constructor(e,t,n,i,a){this.config=t,this.timeoutProvider=n,this.syncEngineInitializationPromise=i,this.dataLayerTarget=a,this.isRequestInProcess=!1,this.requestTimer=null,this.openRequests=new Map,this.timedOutDistinctRequestCount=0,this.failedDistinctRequestCount=0,this.timedOutOperationNames=new Set,this.failedOperationNames=new Set,this.lastSucceededRequest=this.firstTimedOutRequest=xl.DefaultRequestLoggingData,this.logger=e.newLogger("RequestHealthMonitor")}requestCreated(e){if(!this.shouldMonitor(e))return;let t;null!==this.requestTimer||this.isRequestInProcess?t=!1:(this.startTimer(),t=!0),this.openRequests.set(e.requestId,{operationName:e.operationName,shouldTimeout:t,timeAdded:Date.now()})}requestCompleted(e,t){if(!this.shouldMonitor(e))return;this.openRequests.delete(e.requestId)||this.logger.warn(`Unknown request completed. Possibly timed out. RequestId ${e.requestId}, OperationName ${e.operationName}, Target ${this.dataLayerTarget}.`),0===this.openRequests.size&&null!==this.requestTimer&&this.clearTimer(),"success"===t&&this.onSuccess(e),"error"===t&&this.onError(e)}onSuccess(e){this.lastSucceededRequest={requestId:e.requestId,operationName:e.operationName},this.timedOutDistinctRequestCount=0,this.failedDistinctRequestCount=0,this.timedOutOperationNames.clear(),this.failedOperationNames.clear(),this.firstTimedOutRequest=xl.DefaultRequestLoggingData}onError(e){this.failedOperationNames.has(e.operationName)||(this.failedDistinctRequestCount++,this.failedOperationNames.add(e.operationName),this.failedDistinctRequestCount===this.failureCountThreshold&&this.indicateTargetUnhealthy("error"))}onTimeout(){let e=xl.DefaultRequestLoggingData,t=Number.MAX_SAFE_INTEGER;this.openRequests.forEach(((n,i)=>{if(n.shouldTimeout){const a=n.operationName;n.timeAdded<t&&(t=n.timeAdded,e={operationName:a,requestId:i}),this.logger.warn(`Request reached time out in health monitor. RequestId ${i}, OperationName ${a}, Target ${this.dataLayerTarget}.`),this.openRequests.delete(i),this.timedOutOperationNames.has(a)||(this.timedOutDistinctRequestCount++,this.timedOutOperationNames.add(a),this.timedOutDistinctRequestCount===this.timedOutCountThreshold&&this.indicateTargetUnhealthy("timedOut"))}else n.shouldTimeout=!0})),this.firstTimedOutRequest===xl.DefaultRequestLoggingData&&(this.firstTimedOutRequest=e),this.requestTimer=null,this.isRequestInProcess=!1,this.openRequests.size>0&&this.startTimer()}startTimer(){null!==this.requestTimer&&(this.logger.warn(`Health monitor timer already running when attempting to start new. Clearing old timer. Target ${this.dataLayerTarget}.`),this.timeoutProvider.clearTimeout(this.requestTimer)),this.isRequestInProcess=!0,this.syncEngineInitializationPromise.then((e=>{e&&(this.requestTimer=this.timeoutProvider.setTimeout((()=>this.onTimeout()),this.timeOutLengthMs))}))}clearTimer(){null!==this.requestTimer?(this.timeoutProvider.clearTimeout(this.requestTimer),this.requestTimer=null,this.isRequestInProcess=!1):this.logger.warn(`Health monitor timer tried to cancel non-existent timer. Ignoring. Target ${this.dataLayerTarget}.`)}indicateTargetUnhealthy(e){var t,n;const i="error"===e?`ErrorCount: ${this.failureCountThreshold}.`:`TimedOutCount: ${this.timedOutCountThreshold}. TimeOutMs: ${this.timeOutLengthMs}.`,a=`Last succeeded operation: ${this.lastSucceededRequest.operationName}, ${this.lastSucceededRequest.requestId}.`,o=`First timeout operation: ${this.firstTimedOutRequest.operationName}, ${this.firstTimedOutRequest.requestId}`,r=`RequestHealthMonitor: DataLayer is unhealthy due to successive requests failing with ${e}. Target: ${this.dataLayerTarget}. ${i} ${a} ${o}`;this.logger.error(r),null===(n=(t=this.config).unhealthyDataLayerCallback)||void 0===n||n.call(t,r)}shouldMonitor(e){return"subscription"!==e.requestType}get failureCountThreshold(){return this.config.failureCountThreshold||xl.DefaultFailureCountThreshold}get timeOutLengthMs(){return(this.config.timeoutLengthSeconds||xl.DefaultTimeoutLengthSeconds)*wl.NO}get timedOutCountThreshold(){return this.config.timeoutCountThreshold||xl.DefaultTimeoutCountThreshold}}xl.DefaultFailureCountThreshold=5,xl.DefaultTimeoutCountThreshold=5,xl.DefaultTimeoutLengthSeconds=60,xl.DefaultRequestLoggingData={operationName:"na",requestId:"na"};class Ol{constructor(e,t,n,i,a,o,r,s,l,c){var d;this.logger=e,this.scenarioFactory=n,this.syncEngineInitializationPromise=a,this.leakDetectorService=o,this.dataLayerCommunicatorTarget=r,this.timeoutProvider=s,this.enableClassBasedErrors=c,this.requestMap=new Map,this.recentlyCancelledRequests=new Map,this.loggingContext={hostRendererId:t,component:"RequestRegistrar"},this.leakDetector=null===(d=this.leakDetectorService)||void 0===d?void 0:d.create(),l&&l.enableRequestHealthMonitor&&s&&(this.requestHealthMonitor=new xl(i,l,s,this.syncEngineInitializationPromise,r))}createRequest(e,t,n,i,a,o){var r;const s=class{static createDataLayerRequest(e,t,n,i,a,o,r,s,l,c,d,u){const m=[e,t,n,i,a,o,r,s,l,c,void 0,d,u];switch(t){case"mutation":return new Rl(...m);case"query":return new Pl(...m);case"subscription":return new Dl(...m)}}}.createDataLayerRequest(e,t,this.loggingContext.hostRendererId,n,this.logger,i,this.scenarioFactory,this.syncEngineInitializationPromise,a,o,this.requestHealthMonitor,this.enableClassBasedErrors);return null===(r=this.leakDetector)||void 0===r||r.track(`Request-${s.requestType}-${n}`,s),this.requestMap.set(e,s),jl.Q.Instance.processRequest(t,n,e),s}reconcileResponse(e,t){const n=this.requestMap.get(e),i=t.data?t.data&&Object.keys(t.data).toString():"";if(this.recentlyCancelledRequests.has(e))return void this.logger.log(`Received response to a requestId that was recently cancelled. RequestId: ${e}. OperationNameHints: ${i}.`,this.loggingContext);if(!n)return void this.logger.error(`Received response to a requestId that cannot be found in the map. RequestId: ${e}. OperationNameHints: ${i}. RendererId: ${t.rendererId}, WindowId: ${t.windowId}, Target ${this.dataLayerCommunicatorTarget}`,this.loggingContext,S.jK.UnknownRequestId);const a=t.extensions&&t.extensions.perfStats;a||this.logger.warn(`Received response without perfStats for request. RequestId: ${e} RendererId: ${t.rendererId}, WindowId: ${t.windowId}, Target ${this.dataLayerCommunicatorTarget}`,this.loggingContext);const o=a;n.setResponseAndEndScenario(t),n.isComplete()&&(this.requestMap.delete(e),jl.Q.Instance.processResponse(e,o&&o.workerResponseTime))}cancelRequest({requestId:e,rendererId:t,windowId:n}){const i=this.requestMap.get(e);i?(i.cancel(),this.requestMap.delete(e),this.recentlyCancelledRequests.set(e,(new Date).getTime()),this.scheduleCancelledRequestsMapCleanup()):this.logger.debug(`Nothing to cancel, request no longer in map. RequestId: ${e} RendererId: ${t}, WindowId: ${n}, Target ${this.dataLayerCommunicatorTarget}`,this.loggingContext)}scheduleCancelledRequestsMapCleanup(){var e;if(!this.recentlyCancelledRequestsTimer){const t=2,n=(new Date).getTime();this.recentlyCancelledRequestsTimer=null===(e=this.timeoutProvider)||void 0===e?void 0:e.setTimeout((()=>this.cleanRecentlyCancelledRequestsMap(n)),t*wl.A_)}}cleanRecentlyCancelledRequestsMap(e){this.recentlyCancelledRequests.forEach(((t,n)=>{t<e&&this.recentlyCancelledRequests.delete(n)})),this.recentlyCancelledRequestsTimer=void 0}}var Ll=n(696758);class Ul{constructor(e,t,n,i,a,o,r,s,l=!1,c=Promise.resolve(!0)){this.hostRendererId=e,this.loggerFactory=t,this.scenarioFactory=n,this.dataLayerCommunicator=i,this.leakDetectorService=a,this.loggingContext={component:"DataLayerClient",hostRendererId:e},this.logger=new Ma(t.newLogger("CDL")),this.logger.log("logger created for renderer",this.loggingContext),this.dataLayerCommunicator.onMessage=this.onMessageReceived.bind(this),this.requestRegistrar=new Ol(this.logger,e,this.scenarioFactory,this.loggerFactory,c,this.leakDetectorService,o,r,s,l),this.requestId=new Wa("graphql")}execute(e,t,n,i,a,o){const r=(0,cl.S)(e,n),s=r&&r.operation||"query",l=this.requestId.next(s),c=this.requestRegistrar.createRequest(l,s,n||s,this.loggerFactory,i,a);this.logger.log("executing graphql request to data layer",Object.assign(Object.assign({requestId:c.requestId},this.loggingContext),{operationType:s,operationName:n,hostRendererId:this.hostRendererId,requestRendererId:i,requestWindowId:a})),this.dataLayerCommunicator.sendMessage({requestId:l,windowId:a,rendererId:this.hostRendererId,request:{graphqlQuery:(0,Ll.S)(e),variables:t},cdlOperationCustomContext:o,operationName:n});return function(e,t){const n=e.subscribe;return e.subscribe=i=>{const a=n.call(e,i),o=a.unsubscribe;return a.unsubscribe=()=>(t(),o.call(a)),a},e}(c.response,this.onUnsubscribe(c,n))}onUnsubscribe(e,t){return()=>{e.isComplete()||(this.logger.log("Notifying server of unsubscription",Object.assign(Object.assign({},this.loggingContext),{requestId:e.requestId,requestType:Va,operationName:t})),this.dataLayerCommunicator.sendMessage({requestId:e.requestId,rendererId:this.hostRendererId,windowId:e.windowId,request:{graphqlQuery:Va,variables:void 0}}),this.requestRegistrar.cancelRequest({requestId:e.requestId,rendererId:this.hostRendererId,windowId:e.windowId}))}}onMessageReceived(e){this.requestRegistrar.reconcileResponse(e.requestId,e)}}var Bl=n(730397),Wl=n(602136),Hl=n(101014),$l=n(432327);const Vl={modules:[()=>(0,ha.mT)((()=>Promise.all([n.e(10523),n.e(6693)]).then(n.bind(n,870214))),"data-client-calling"),()=>(0,ha.mT)((()=>Promise.resolve().then(n.bind(n,396065))),"data-resolvers-windows"),()=>(0,ha.mT)((()=>Promise.all([n.e(68413),n.e(21706)]).then(n.bind(n,753781))),"data-schema-cdl"),()=>(0,ha.mT)((()=>n.e(10683).then(n.bind(n,543081))),"data-resolvers-activity"),()=>(0,ha.mT)((()=>n.e(49073).then(n.bind(n,304289))),"data-resolvers-activity-bell-count"),()=>(0,ha.mT)((()=>Promise.all([n.e(29862),n.e(20058)]).then(n.bind(n,75515))),"data-resolvers-activity-settings"),()=>(0,ha.mT)((()=>Promise.all([n.e(56242),n.e(1420)]).then(n.bind(n,290307))),"data-resolvers-appbar"),()=>(0,ha.mT)((()=>n.e(78594).then(n.bind(n,511292))),"data-resolvers-apps-platform"),()=>(0,ha.mT)((()=>n.e(17097).then(n.bind(n,877014))),"data-resolvers-azure-maps"),()=>(0,ha.mT)((()=>n.e(56874).then(n.bind(n,792234))),"data-resolvers-banners"),()=>(0,ha.mT)((()=>n.e(76138).then(n.bind(n,905370))),"data-resolvers-biometric-enrollment"),()=>(0,ha.mT)((()=>Promise.all([n.e(77351),n.e(30087)]).then(n.bind(n,681052))),"data-resolvers-bots-platform"),()=>(0,ha.mT)((()=>n.e(96386).then(n.bind(n,803245))),"data-resolvers-bots-platform-worker"),()=>(0,ha.mT)((()=>n.e(84042).then(n.bind(n,524065))),"data-resolvers-brb"),()=>(0,ha.mT)((()=>n.e(48195).then(n.bind(n,846585))),"data-resolvers-breakout-rooms"),()=>(0,ha.mT)((()=>Promise.all([n.e(92923),n.e(5632)]).then(n.bind(n,70750))),"data-resolvers-calendar"),()=>(0,ha.mT)((()=>n.e(34653).then(n.bind(n,611909))),"data-resolvers-callable-channel"),()=>(0,ha.mT)((()=>Promise.all([n.e(72748),n.e(6020)]).then(n.bind(n,276533))),"data-resolvers-calling"),()=>(0,ha.mT)((()=>n.e(86639).then(n.bind(n,657878))),"data-resolvers-channel-messages"),()=>(0,ha.mT)((()=>n.e(82991).then(n.bind(n,641188))),"data-resolvers-channels"),()=>(0,ha.mT)((()=>Promise.all([n.e(29862),n.e(81e3),n.e(72748),n.e(32504),n.e(16366)]).then(n.bind(n,865099))),"data-resolvers-chat"),()=>(0,ha.mT)((()=>n.e(75499).then(n.bind(n,219949))),"data-resolvers-coach-report"),()=>(0,ha.mT)((()=>n.e(12767).then(n.bind(n,620362))),"data-resolvers-compose-language"),()=>(0,ha.mT)((()=>n.e(76003).then(n.bind(n,410402))),"data-resolvers-connected-calendar"),()=>(0,ha.mT)((()=>n.e(87314).then(n.bind(n,346110))),"data-resolvers-contacts-sync"),()=>(0,ha.mT)((()=>n.e(61627).then(n.bind(n,459917))),"data-resolvers-contacts-sync-banner"),()=>(0,ha.mT)((()=>n.e(84226).then(n.bind(n,466681))),"data-resolvers-contacts-sync-settings"),()=>(0,ha.mT)((()=>n.e(27133).then(n.bind(n,732338))),"data-resolvers-developer-switchers"),()=>(0,ha.mT)((()=>n.e(67767).then(n.bind(n,488741))),"data-resolvers-distribution-list"),()=>(0,ha.mT)((()=>n.e(31192).then(n.bind(n,748092))),"data-resolvers-dynamics-marketing"),()=>(0,ha.mT)((()=>n.e(19778).then(n.bind(n,270432))),"data-resolvers-esp"),()=>(0,ha.mT)((()=>n.e(87574).then(n.bind(n,7563))),"data-resolvers-esp-target"),()=>(0,ha.mT)((()=>n.e(88542).then(n.bind(n,695742))),"data-resolvers-external-accounts"),()=>(0,ha.mT)((()=>Promise.all([n.e(29862),n.e(37301)]).then(n.bind(n,612659))),"data-resolvers-files"),()=>(0,ha.mT)((()=>n.e(66263).then(n.bind(n,559097))),"data-resolvers-fluid"),()=>(0,ha.mT)((()=>n.e(97323).then(n.bind(n,41326))),"data-resolvers-gallery"),()=>(0,ha.mT)((()=>n.e(45029).then(n.bind(n,102247))),"data-resolvers-host-updates"),()=>(0,ha.mT)((()=>n.e(32529).then(n.bind(n,814166))),"data-resolvers-import-msa-contacts"),()=>(0,ha.mT)((()=>n.e(84091).then(n.bind(n,322845))),"data-resolvers-invite-links"),()=>(0,ha.mT)((()=>Promise.all([n.e(43612),n.e(61803),n.e(48129)]).then(n.bind(n,573100))),"data-resolvers-live-state-broadcast"),()=>(0,ha.mT)((()=>Promise.resolve().then(n.bind(n,548426))),"data-resolvers-local-preferences"),()=>(0,ha.mT)((()=>n.e(68054).then(n.bind(n,403581))),"data-resolvers-localization-settings"),()=>(0,ha.mT)((()=>n.e(49087).then(n.bind(n,150749))),"data-resolvers-loki"),()=>(0,ha.mT)((()=>n.e(99367).then(n.bind(n,781829))),"data-resolvers-manage-tenant"),()=>(0,ha.mT)((()=>n.e(8687).then(n.bind(n,491345))),"data-resolvers-meeting-analytics"),()=>(0,ha.mT)((()=>n.e(68400).then(n.bind(n,585398))),"data-resolvers-mfu-contacts"),()=>(0,ha.mT)((()=>n.e(65398).then(n.bind(n,511701))),"data-resolvers-msa-authentication"),()=>(0,ha.mT)((()=>n.e(9355).then(n.bind(n,350975))),"data-resolvers-offline-actions"),()=>(0,ha.mT)((()=>n.e(22616).then(n.bind(n,686602))),"data-resolvers-people-avatar"),()=>(0,ha.mT)((()=>Promise.all([n.e(45814),n.e(93844)]).then(n.bind(n,695676))),"data-resolvers-people-picker"),()=>(0,ha.mT)((()=>n.e(79932).then(n.bind(n,762373))),"data-resolvers-people-targeting"),()=>(0,ha.mT)((()=>n.e(41809).then(n.bind(n,433430))),"data-resolvers-pinned-channels"),()=>(0,ha.mT)((()=>n.e(82329).then(n.bind(n,342077))),"data-resolvers-platform-tabs"),()=>(0,ha.mT)((()=>n.e(60115).then(n.bind(n,143224))),"data-resolvers-policies"),()=>(0,ha.mT)((()=>Promise.all([n.e(92923),n.e(60532)]).then(n.bind(n,978440))),"data-resolvers-presence"),()=>(0,ha.mT)((()=>n.e(93902).then(n.bind(n,564139))),"data-resolvers-privacy-settings"),()=>(0,ha.mT)((()=>n.e(26759).then(n.bind(n,412668))),"data-resolvers-pstn"),()=>(0,ha.mT)((()=>n.e(2090).then(n.bind(n,35069))),"data-resolvers-reply-chains"),()=>(0,ha.mT)((()=>Promise.all([n.e(38294),n.e(86060)]).then(n.bind(n,872268))),"data-resolvers-search"),()=>(0,ha.mT)((()=>n.e(44462).then(n.bind(n,112330))),"data-resolvers-search-prefetch"),()=>(0,ha.mT)((()=>Promise.all([n.e(45814),n.e(7598)]).then(n.bind(n,263166))),"data-resolvers-search-suggestions"),()=>(0,ha.mT)((()=>n.e(70225).then(n.bind(n,749301))),"data-resolvers-shell"),()=>(0,ha.mT)((()=>n.e(25270).then(n.bind(n,981112))),"data-resolvers-store"),()=>(0,ha.mT)((()=>n.e(47806).then(n.bind(n,957929))),"data-resolvers-suggestions"),()=>(0,ha.mT)((()=>n.e(87227).then(n.bind(n,560543))),"data-resolvers-system-settings"),()=>(0,ha.mT)((()=>n.e(51661).then(n.bind(n,502202))),"data-resolvers-targeting-hierarchy"),()=>(0,ha.mT)((()=>Promise.all([n.e(56242),n.e(80574)]).then(n.bind(n,764822))),"data-resolvers-taskbar"),()=>(0,ha.mT)((()=>n.e(78866).then(n.bind(n,662646))),"data-resolvers-team-gallery"),()=>(0,ha.mT)((()=>n.e(67785).then(n.bind(n,524378))),"data-resolvers-team-settings"),()=>(0,ha.mT)((()=>n.e(65365).then(n.bind(n,817195))),"data-resolvers-teams"),()=>(0,ha.mT)((()=>Promise.all([n.e(29862),n.e(86205)]).then(n.bind(n,682868))),"data-resolvers-teams-and-channels"),()=>(0,ha.mT)((()=>n.e(17902).then(n.bind(n,649026))),"data-resolvers-teams-meeting-policies"),()=>(0,ha.mT)((()=>n.e(88540).then(n.bind(n,749587))),"data-resolvers-tenant-membership"),()=>(0,ha.mT)((()=>n.e(81694).then(n.bind(n,413848))),"data-resolvers-third-party-calendar"),()=>(0,ha.mT)((()=>Promise.all([n.e(29862),n.e(588)]).then(n.bind(n,238514))),"data-resolvers-toast"),()=>(0,ha.mT)((()=>n.e(83028).then(n.bind(n,958362))),"data-resolvers-update-client-state"),()=>(0,ha.mT)((()=>n.e(73676).then(n.bind(n,451728))),"data-resolvers-user"),()=>(0,ha.mT)((()=>n.e(84335).then(n.bind(n,120930))),"data-resolvers-user-license"),()=>(0,ha.mT)((()=>Promise.all([n.e(29862),n.e(55919)]).then(n.bind(n,985455))),"data-resolvers-user-preferences"),()=>(0,ha.mT)((()=>n.e(8806).then(n.bind(n,89207))),"data-resolvers-browser-ams"),()=>(0,ha.mT)((()=>n.e(90963).then(n.bind(n,79147))),"data-resolvers-browser-audience"),()=>(0,ha.mT)((()=>Promise.resolve().then(n.bind(n,110451))),"data-resolvers-browser-authentication"),()=>(0,ha.mT)((()=>n.e(12353).then(n.bind(n,268023))),"data-resolvers-browser-broadcast-attendee"),()=>(0,ha.mT)((()=>Promise.all([n.e(92923),n.e(32606),n.e(41292),n.e(30038)]).then(n.bind(n,250312))),"data-resolvers-browser-calendar"),()=>(0,ha.mT)((()=>n.e(46310).then(n.bind(n,795028))),"data-resolvers-browser-call-recording"),()=>(0,ha.mT)((()=>n.e(488).then(n.bind(n,807699))),"data-resolvers-browser-calls-screen"),()=>(0,ha.mT)((()=>n.e(88314).then(n.bind(n,291534))),"data-resolvers-browser-chat"),()=>(0,ha.mT)((()=>n.e(98722).then(n.bind(n,576736))),"data-resolvers-browser-core"),()=>(0,ha.mT)((()=>n.e(55221).then(n.bind(n,334712))),"data-resolvers-browser-files"),()=>(0,ha.mT)((()=>n.e(40868).then(n.bind(n,886598))),"data-resolvers-browser-floodgate"),()=>(0,ha.mT)((()=>n.e(90170).then(n.bind(n,588694))),"data-resolvers-browser-guardians"),()=>(0,ha.mT)((()=>Promise.all([n.e(4867),n.e(83836),n.e(90070),n.e(10104)]).then(n.bind(n,145475))),"data-resolvers-browser-live-stream-rendering"),()=>(0,ha.mT)((()=>n.e(22540).then(n.bind(n,89311))),"data-resolvers-browser-lms-integration"),()=>(0,ha.mT)((()=>n.e(48840).then(n.bind(n,41626))),"data-resolvers-browser-logs-files"),()=>(0,ha.mT)((()=>n.e(91029).then(n.bind(n,904138))),"data-resolvers-browser-meeting-artifacts"),()=>(0,ha.mT)((()=>n.e(17400).then(n.bind(n,37028))),"data-resolvers-meeting-options"),()=>(0,ha.mT)((()=>n.e(78996).then(n.bind(n,705437))),"data-resolvers-meeting-templates"),()=>(0,ha.mT)((()=>n.e(51949).then(n.bind(n,695768))),"data-resolvers-browser-mention"),()=>(0,ha.mT)((()=>n.e(93553).then(n.bind(n,583783))),"data-resolvers-browser-settings"),()=>(0,ha.mT)((()=>n.e(229).then(n.bind(n,418080))),"data-resolvers-browser-share"),()=>(0,ha.mT)((()=>n.e(73969).then(n.bind(n,746907))),"data-resolvers-browser-survey"),()=>(0,ha.mT)((()=>n.e(35241).then(n.bind(n,54288))),"data-resolvers-browser-teams"),()=>(0,ha.mT)((()=>n.e(76023).then(n.bind(n,805263))),"data-resolvers-browser-tpn"),()=>(0,ha.mT)((()=>n.e(70357).then(n.bind(n,840099))),"data-resolvers-browser-url-preview"),()=>(0,ha.mT)((()=>n.e(79455).then(n.bind(n,511866))),"data-resolvers-browser-virtual-events"),()=>(0,ha.mT)((()=>n.e(27490).then(n.bind(n,912514))),"data-resolvers-browser-voicemail"),()=>(0,ha.mT)((()=>Promise.all([n.e(55531),n.e(26124)]).then(n.bind(n,636876))),"data-resolvers-browser-webinar"),()=>(0,ha.mT)((()=>n.e(91443).then(n.bind(n,308321))),"data-resolvers-cypress-only")],preloadModules:[1,40,81],sharedModule:()=>(0,ha.mT)((()=>Promise.all([n.e(47933),n.e(35922),n.e(34882)]).then(n.bind(n,890966))),"data-schema"),dependencies:{0:[107,2],2:[107],4:[3],5:[107,2,78],7:[107,2],11:[107,2],14:[107,2],17:[107,2],20:[107,2],24:[107,2],26:[107,2],45:[107,2],49:[107,2],52:[107,2],54:[107,2],58:[107,2],69:[107,2],76:[107,2],82:[107,2],86:[107,2],88:[107,2],91:[107,2],95:[107,2]},types:{Query:{userCallingSettings:0,deviceList:0,defaultVideoBackgroundImages:0,call:0,callWhiteboardSharingSources:0,callMeetingInfo:0,callQuestionnaire:0,callingIntent:0,videoAvailableForConversation:0,callStartTimestamp:0,callParticipants:0,transportCompanionDeviceInfo:0,teamsCallId:0,callingDialogData:0,callTranscriptState:0,callingAlerts:0,shouldShowTheUpsellScreen:0,meetingInfoFromCall:0,getDeviceBlurringCapability:0,callScreenPreviewsV2:0,noiseSuppressionSetting:0,isMeetingRoomCortanaEnabled:0,isContentCameraEnhancementSupported:0,systemAudioState:0,speakerMuted:0,speakerHWMuted:0,searchUsersByIdsOrQuery:0,threadMembers:0,meetingRoomInMeetingSpeakerAttributionState:0,currentSeatingAssignment:0,appDevicePermission:2,callingServiceState:2,favoritePhoneNumbers:2,isStandardFormatNormalized:2,parsedAndFormattedNumber:2,botSsoConsentRequest:2,getBatchUserPresence:2,callingAggregateSettings:2,getUsersForConversation:2,getUsersFromCallingRoster:2,vdiCapabilities:2,smsUsersForConversation:2,isBlockedContact:2,isVideoExtensibilityEnabled:2,messagesWithUnreadActivities:2,devicePermission:2,suggestedUsers:2,suggestedTransferTargets:2,teamsCallIdByCallId:2,callParticipantsForScope:2,conversationForCall:2,callScreenPreviews:2,callPptFiles1:2,callInvisionWhiteboardSharingSources:2,getInvisionWhiteboard:2,callAttendeeRestrictedModalities:2,instantScdSearch:2,parkedCallDetails:2,parkedCalls:2,streamPermissions:2,overflowRoomId:2,getMeetingNotes:2,ongoingConsultation:2,meetingInfoFromExchange:2,hasVideoOwnership:2,channelSiteInfo:2,sharepointIds:2,suggestedRooms:2,autoMuteChatAlertBannerDismissed:2,callTranscriptData:2,callTranscriptDataByUrl:2,isAttendanceReportEnabledInRoster:2,isAttendanceReportAvailableAfterCallEnded:2,screenRecordingEnabled:2,biometricEnrollmentEnabled:2,biometricEnrollmentStatus:2,mergeableCalls:2,isVideoEffectCapableOnDevice:2,videoTouchUpStrength:2,isWhiteboardDeviceCapableOf:2,isCameraSharingEnabled:2,videoEffectStateV2:2,isWhiteboardVideoEffectOn:2,userVideoBackgroundImages:2,tenantVideoBackgroundImages:2,meetingBrandingLogoUrl:2,composerStream:2,isTenantVerifiedDomain:2,searchFederatedUsers:2,searchFederatedUsersByMri:2,searchXtapUser:2,messageUniqueIdentifier:2,callHealthCategories:2,buddyGroup:2,buddyGroups:2,sharedMailIdForGroupId:2,callingPerformanceScenarioId:2,biometricEnrollmentPrivacyLink:2,scdImageData:2,dialpadSuggestedUsers:2,validateUpgradePolicyOfChatRecipient:2,systemAudioDriverState:2,roomCoordinates:2,breakoutRoom:2,listBreakoutRooms:2,maxNumberOfVideoStreams:2,msaUserProfilePicture:2,msaGroupProfilePicture:2,joinTenantUrl:2,pptSharingTelemetry:2,joinLink:2,slaCalls:2,messageLanguages:2,getTranscriptAcl:2,hasVideoBackgroundEffect:2,ignoreMirroringVideoPreferenceSetting:2,callByThreadId:2,fetchDynamicCommandsV2:2,calendarEvents:2,openInDesktopAsDeviceSpecificFileOpenPreference:2,environmentSupport:2,liveStreamState:2,virtualDesktopInfrastructureConnectedState:2,videoEffectApplyingState:2,getGestureBasedReactionOption:2,activities:3,activitySettingsComponents:5,activitySettings:5,launchTileBar:6,lockedTiles:6,pinnedTiles:6,mostRecentlyUsedTiles:6,installedApps:7,installedAppsV2:7,installedChatAppsWithPreCheck:7,installedSideLoadApp:7,installedTrustedSideLoadApp:7,installedApp:7,appDefinitions:7,appDefinition:7,sideLoadAppDefinition:7,trustedSideLoadAppDefinition:7,stagedApps:7,installedAppsForContainerApp:7,customAppPolicy:7,appsUsage:7,appsInstalledByCurrentUser:7,appImpressions:7,installedAppsForUser:7,installedAppThreads:7,addresses:8,bannerNotificationQueue:9,fetchAdaptiveCardsForTab:11,searchMessageExtension:11,searchUniversalSearch:11,selectItemMessageExtension:11,fetchDynamicCommands:11,getAppPreview:11,querySettingUrlMessageExtension:11,getBotFileUploadUrl:11,taskMessageExtension:11,getAuthToken:11,fetchTaskForAdaptiveCardTab:11,fetchTaskModule:11,brbFormData:13,brbScreenshots:13,listBreakoutRoomsWithDetails:14,breakoutRoomSettings:14,getBreakoutRoomsUsers:14,getGroupsMembers:14,teamCalendarEvent:15,calendarEventsV3:15,calendarEvent:15,callQueueSettings:16,replyChainSummaries:18,replyChainMessages:18,messages:20,message:20,previousNextChats:20,chats:20,pinnedChats:20,recentsChats:20,suggestedContactsInChatList:20,chat:20,chatAwait:20,chatMembers:20,chatsByTitle:20,chatWithUser:20,defaultChat:20,newChatIntentId:20,membersConsumptionHorizon:20,chatsWithUsers:20,chatsWithGuardians:20,badgeCounts:20,searchUsersByConversation:20,messageAnnotations:20,translationSuggestionRequired:20,lastTranslationSuggestion:20,typingUsers:20,chatFilesSuggestions:20,coachArtifactsByThreadId:21,coachArtifact:21,connectedCalendarSettings:23,syncConnectedCalendarSettings:23,suggestedContacts:24,contactsSyncSettings:26,transitiveMembersCountForDistributionList:28,transitiveMembersForDistributionList:28,transitiveMembersForDistributionLists:28,getWebinarLinkDetails:29,espState:30,getExternalAccounts:32,oneDriveDetails:33,p2pFilesList:33,fluidSharepointInfo:34,getFluidSPOEnabled:34,getPermissions:34,checkUserAccess:34,mediaFiles:35,hostUpdateState:36,hostUpdaterAvailable:36,fetchMsaContacts:37,chatInviteLink:38,userInviteLink:38,getLiveStateAuth:39,getLiveStateRegionalUrl:39,allClientPreferences:40,clientPreferences:40,userExperiencePreferences:40,localizationSettings:41,lokiConfig:42,getTenantAdmins:43,getJoinTenantUrl:43,aadDomain:43,meetingArtifactsByThreadId:44,meetingArtifact:44,attendanceReport:44,getAccessToken:46,pstnUser:49,getCacheResults:49,people:49,searchUsers:49,searchUsersWithGroupChats:49,warmupPeopleSubstrateSearch:49,teamsTagCards:50,teamsTagCardsByTeamIds:50,tagCard:50,teamTagSettings:50,membersForTag:50,membersOfTag:50,platformTab:52,platformTabs:52,platformTabsV2:52,recentPlatformTabs:52,policies:53,presence:54,presences:54,blockedContacts:55,pstnAssignment:56,replyChains:57,replyChain:57,getTeamForFile:58,parentPostTeamAndChannel:58,buildChatTitle:58,searchMessages:58,searchAllMessages:58,searchAllData:58,searchFiles:58,osearchFiles:58,metaPreview:58,searchOdcFilePreview:58,searchReplyChain:58,searchReplyChainFromPost:58,channelPost:58,searchPeople:58,searchEmails:58,searchPrefetchConfigs:59,getSearchSuggestionResults:60,windowState:61,zoomState:61,storeCollection:62,storeCollectionList:62,storeCollectionItemList:62,storeHeroItemList:62,storeSearchItems:62,storeItemsDetail:62,storeHeroItemsDetail:62,storeSearchItemsLegacy:62,init3S:63,suggestions:63,systemSettings:64,hierarchyNodeCharacteristics:65,hierarchyNodeDescendantsCount:65,hierarchyNodeChildren:65,recommendedTeams:67,discoverableTeams:67,joinedTeams:69,defaultChannel:69,pinnedChannels:69,team:69,teamLevelApps:69,canCreateTWT:70,channelByID:70,myGroupSettings:70,sensitivityLabels:70,sensitivityLabelByTeamId:70,sensitivityPolicySettings:70,gridViewSections:70,teamTemplatesSummary:70,teamTemplate:70,teamsMeetingConfiguration:71,getInviteErrorMessageFromErrorCode:72,toastImageAsDataUri:74,me:76,userLicenseDetails:76,user:76,userFromEmail:76,users:76,getUsers:76,msaMeProfile:76,ephemeralMsaMeProfile:76,consumerLicenseDetails:77,userPreferences:78,audienceBackgroundScenes:80,audienceSceneDefinition:80,authenticationUsers:81,authenticatedUser:81,authenticationToken:81,hostMachineUsers:81,broadcastAttendeeMeeting:82,broadcast:82,broadcastCaptions:82,teamCalendarEventByUid:83,teamCalendarEvents:83,calendarEventMasterCategories:83,meetingRecommendedFiles:83,calendarEventsCacheV2:83,calendarViewV2_1:83,calendarEventByUid:83,buildings:83,rooms:83,userMailboxSettings:83,userTimeZoneSettings:83,callRecordingsInfo:84,blockedPstnContacts:85,messageDraft:86,messageDraftsIndex:86,tflTwoWaySmsProfiles:86,giphys:86,searchEmoticons:86,emoticonCategories:86,pinnedSkinTone:86,downloadAmsItem:86,constructAmsUrl:86,downloadImageItemUsingProxy:86,getUrlReputationRest:86,safelinksGetPolicy:86,offlineAssetBlobUrl:86,supportedTranslationLanguages:86,optionalTelemetry:86,filePermission:88,filePermissionWarning:88,currentFiles:88,parseFileLabelFromUrl:88,fileDetailsForChiclet:88,redeemFile:88,fileDownloadDetailsUsingItemDetailsService:88,fileDownloadDetailsUsingLegacyVroomService:88,redeemFileById:88,fileDetailsWithSharepointId:88,getPersonalSiteInfoForUpload:88,shareDialogAudience:88,fetchVideoInfo:88,membersAndRelatedContacts:90,relatedContacts:90,liveStreamCaptionsCultures:91,liveStreamDiagnosticData:91,liveStreamIsAvailable:91,liveStreamIsStreaming:91,liveStreamIsActive:91,liveStreamIsRendering:91,teamsForCourse:92,courseMembersAndOwners:92,meetingArtifacts:94,reserveMeetingArtifact:94,getMeetingOptions:95,getMeetingOptionsByCode:95,meetingOptionsForMeetingCreation:95,meetingTemplateDescriptions:96,searchForMention:97,settingsListItems:98,emailMessagePreview:99,checkCloudFilesStatus:99,recentShareToTeamsRecipients:99,shareToTeamsDesktopUpsellDisplayedStatus:99,survey:100,instantAnswers:100,teams:101,teamsLocal:101,notice:102,urlPreview:103,virtualEvent:104,virtualEvents:104,virtualEventSession:104,virtualEventSessions:104,virtualEventSpeaker:104,virtualEventSpeakers:104,voicemailAudio:105,voicemails:105,webinar:106,webinarImage:106},Mutation:{changeAudienceViewBackground:0,selectAudienceSceneAndAssignSeats:0,addAudienceBotDataChannel:0,startBotView:0,addParticipant1:0,stopCall:0,startCall:0,startSharing:0,stopSharing:0,addScreenRecordingDisabledAlert:0,downloadVideoBackgroundImage:0,toggleIncomingVideo:0,toggleMute:0,toggleVideo:0,fireCallingIntent:0,startOrContinueInstantMeeting:0,resolveCallingAppEvent:0,removeParticipant1:0,admitParticipant1:0,admitAllParticipants1:0,muteParticipant1:0,muteAllParticipants1:0,spotlightParticipant:0,stopSpotlightOnParticipant:0,stopSpotlight:0,bringOnStage:0,removeFromStage:0,createOrGetInstantMeetingInfo:0,applyVideoBackgroundEffects:0,joinCallFromIntent:0,notifyCallingViewportCreation:0,endCallingIntent:0,updateExternalCallMonitorVisibility:0,sendDtmf:0,submitCallFeedback:0,cancelCallFeedback:0,callFeedbackRendered:0,toggleHoldCall:0,dismissAlert:0,actionOnAlert:0,createCompositorV2:0,disposeCompositor:0,updateCompositorLayout:0,videoSizeChanged:0,setTextureSharingSupported:0,setMaxVideoChannels:0,stopStream:0,stopStream1:0,setVideosSizeAndPreference:0,setVideoPreference:0,acknowledgeFirstFrame:0,devicePermission:0,isVideoEffectCapableOnDevice:0,toggleVideoWithState:0,startStream1:0,startStream:0,openFeedbackDialog:0,openMeetingRoomCortana:0,initCallingService:0,toggleRemotePtzCamera:0,toggleCortana:0,toggleMeetingRoomInMeetingSpeakerAttribution:0,toggleHighFidelityAudio:0,triggerCallingToastAction:0,selectDevice:0,selectAudioDevice:0,setSpeakerVolume:0,tryToggleIncludeSystemAudio:0,toggleMuteSpeaker:0,toggleRaiseHands:0,toggleRoomRemote:0,updateNoiseSuppression:0,lowerOtherParticipantsHand:0,lowerAllRaisedHands:0,startPreview:0,stopPreview:0,toggleTogetherModePinning:0,startClosedCaptions:0,stopClosedCaptions:0,setClosedCaptionsLanguage:0,newCallingScenario:0,markCallingScenario:0,stopCallingScenario:0,failCallingScenario:0,cancelCallingScenario:0,incompleteCallingScenario:0,updateCallingScenarioEventData:0,pauseCallingScenario:0,resumeCallingScenario:0,acceptScreenshareControlRequest:0,denyScreenshareControlRequest:0,screenSharingRequestControl:0,screenSharingReleaseControl:0,triggerDialogAction:0,turnOnCallGroupNotification:2,turnOffCallGroupNotification:2,changeCallForwardingTargetTo:2,clearBotSsoConsentRequest:2,disableCallForwarding:2,addFavoritePhoneNumber:2,callMeBack:2,callMeBackWithResult:2,messageListRendered:2,storeAnonymousUsers:2,altScenario:2,createMeetingNotes:2,updateAttendeeTranscription:2,acceptBlockSfCChat:2,addBlockedMri:2,deleteBlockedMri:2,rejectCall:2,cancelCallParticipantAddition:2,promoteAttendeeToPresenter:2,demotePresenterToAttendee:2,parkCall:2,unparkCall:2,unparkCallById:2,dismissParkedCallById:2,transferCall:2,mergeCalls:2,startConsultation:2,resumeCallBeingConsulted:2,transferCallConsultation:2,transferUserConsultation:2,retryCall:2,rejoinCall:2,cancelRetry:2,startStopStreams:2,toggleNativeRenderer:2,setIgnoreMirroring:2,startPstnCall:2,toggleIncomingAudio:2,sendMeetingReaction:2,lowerOtherParticipantHand:2,lowerHandsForEveryone:2,toggleVideoSharing:2,toggleTimeZoneIndicator:2,toggleVideoEffectV2:2,toggleWhiteboardVideoEffect:2,toggleMuteWithState:2,togglePushToTalk:2,updateCallParticipantRestrictions:2,clearCallParticipantRestriction:2,userFacingDiagnosticsV2:2,downloadAttendanceInRoster:2,downloadAttendanceAfterCallEnded:2,showInteropScreenshareAlert:2,toggleContentCameraShare:2,toggleMeetingRoomDisplayOemPlugin:2,updateMeetingRoomRemoteHandlerState:2,toggleContentCameraEnhancement:2,startSharingFromChat:2,startInteropMeeting:2,callPptSharingTogglePrivateViewing:2,callPptSharingStopContentSharing:2,callPptWeathepersonFailed:2,callPptSharingChangeSlide:2,callPptSharingMediaEventUpdate:2,callPptSharingUpdatePresentationUrl:2,callPptSharingTakeControl:2,callPptSharingUpdateSlidesCount:2,callPptSharingUpdateLayout:2,startFileSharing1:2,startWhiteboardSharing:2,startAnnotation:2,stopAnnotation:2,stopWhiteboardSharing:2,updateLayoutToggleState:2,startRecording:2,stopRecording:2,startRecordingAndTranscript:2,stopRecordingAndTranscript:2,acceptStreamPermissions:2,toggleScd:2,updateVideoPrivacyPolicy:2,setCurrentDeviceVideoEffect:2,downloadVideoBackgroundImageV2:2,uploadVideoBackgroundImage:2,deleteVideoBackgroundImage:2,dismissAutoMuteChatAlertBanner:2,startTranscript:2,stopTranscript:2,openSecurityAndPrivacyPane:2,openSettingsPane:2,openInviteDialog:2,updateCurrentActiveCard:2,updateCardDocumentUrl:2,updatePlayerInteractionResult:2,sendToBroadcast:2,startBroadcast:2,stopBroadcast:2,resumeOverflowRoom:2,startHolographicInteraction:2,startHolographicFreezeFrameInteraction:2,stopHolographicInteraction2:2,stopHolographicFreezeFrameInteraction:2,updateHolographicViewingParticipant:2,placeHolographicAnnotation:2,continueHolographicInking:2,stopHolographicInking:2,deleteHolographicAnnotations:2,recoverHolographicAnnotations:2,clearAllHolographicAnnotations:2,notifyHolographicImageLoaded:2,deleteFailedMessage:2,startScd:2,stopScd:2,showHiddenChatHistory:2,addContact:2,removeContact:2,removeContactFromBuddyGroup:2,requestSystemAudioDriverInstallation:2,reportParticipant:2,clearAttendeeRestrictions:2,updateAttendeeRestrictions:2,createBreakoutRooms:2,markActivitiesAsRead:2,moveToAnotherBreakoutRoom:2,moveToMainMeeting:2,moveToBreakoutRoom:2,goToMainMeetingFromBreakoutRoom:2,goToBreakoutRoomFromMainMeeting:2,openBreakoutRooms:2,closeBreakoutRooms:2,takeControlToManageBreakoutRooms:2,markUpsellScreenAsDisplayed:2,sendBreakoutRoomAnnouncementAlert:2,updateSelectedUserFrequency:2,askToJoinBreakoutRoom:2,toggleCallableQueueOptInStatus:2,deleteJoinLink:2,updateThreadJoinLink:2,makeTranscriptEdit:2,toggleNdi:2,updateMeetingRoomAppState:2,updateMeetingLock:2,applyWhiteboardVideoEffect:2,updateIgnoreMirroringVideoPreferenceSetting:2,showPrivateMeetingConversation:2,upgradeConsumerLicense:2,downloadClassicalAttachment:2,setWeatherpersonCapable:2,setAplCustomBackground:2,setAplCustomBackgroundV2:2,setTouchUpVideoEffect:2,joinScheduledMeeting:2,startLiveStreaming:2,stopLiveStreaming:2,toggleGestureBasedReactionOption:2,updateGroupProfileAvatar:2,deleteGroupProfileAvatar:2,toggleActivityRead:4,clearBellCount:4,updateActivitySettings:5,installApp:7,installCustomApp:7,installSideLoadApp:7,installTrustedSideLoadApp:7,deleteApp:7,pinMessageExtensionV2:7,pinMessageExtension:7,unpinMessageExtensionV2:7,unpinMessageExtension:7,deleteStagedApp:7,recordAppActionUsage:7,recordAppUsage:7,recordAppSceneUsage:7,recordAppImpression:7,startVoiceCaptureBiometricEnrollment:10,stopVoiceCaptureBiometricEnrollment:10,cancelVoiceBiometricEnrollment:10,sendInvoke:11,sendExecuteInvoke:11,submitTab:11,cardCacheOperation:11,postFileUploadInfoAndUserConsent:11,updateSettingsMessageExtension:11,verifyCardSignInState:11,tokenExchangeInvoke:11,submitO365Action:11,submitTaskMessageExtension:11,submitTaskModule:11,submitTaskAdaptiveCardTab:11,cardCacheOperationV2:12,createBrbItem:13,addBreakoutRoom:14,deleteAllBreakoutRooms:14,updateBreakoutRoomInfo:14,deleteBreakoutRoom:14,createBreakoutRoomsWithDetails:14,updateBreakoutRooms:14,updateBreakoutRoomSettings:14,breakoutRoomBulkMoveAction:14,importCalendarEvent:15,updateMeetingResponse:15,deleteCalendarEvent:15,cancelCalendarEvent:15,cancelTeamEvent:15,updateAttendeeEvent:15,createOrUpdateCalendarEvent:15,createOrUpdateTeamEvent:15,createChannel:19,updateChannel:19,submitReport:20,sendMessage:20,sendTypingIndicator:20,createChat:20,createNewChat:20,setMuteChat:20,setThreadPropertyMeeting:20,setThreadPropertyLiveness:20,addMembersToConversation:20,registerBadgeCounts:20,removeMemberFromConversation:20,updateMessageEmotion:20,ackUrgentMessage:20,setConsumptionHorizon:20,leaveChat:20,setConsumptionHorizonBookmark:20,setChatPinned:20,discardDraftChat:20,setChatVisibility:20,deleteChat:20,setConversationTitle:20,reorderPinnedChats:20,saveMessage:20,unsaveMessage:20,deleteMessage:20,undeleteMessage:20,updateMessageLinks:20,setPinnedItemsThreadProperty:20,setPinnedItemsConversationProperty:20,detectComposeLanguage:22,setComposeLanguage:22,switchSpellCheckLanguage:22,publishConnectedCalendarSetting:23,deleteConnectedCalendarSetting:23,invokeUserActionOnContactsSyncBanner:25,publishContactsSyncSettings:26,deleteContactsSyncSettings:26,switchRing:27,recordEligibleSurface:30,recordDisplayedSurface:30,activateEspTarget:31,deactivateEspTarget:31,registerEspTarget:31,unregisterEspTarget:31,addExternalAccount:32,removeExternalAccount:32,deleteFile:34,createShareLink:34,odspAtMention:34,renameFile:34,grantUserPermissions:34,tryInstallUpdate:36,disableChatInviteLink:38,enableChatInviteLink:38,redeemClaimInviteLink:38,redeemInviteLink:38,sendMeetingReactionLiveState:39,sendMeetingNotesLiveState:39,updateClientPreferences:40,updateUserExperiencePreferences:40,clearUserExperiencePreferences:40,updateCurrentLocale:41,downloadAttendanceReportFromType:44,addUpdateMostFrequentlyUsedContact:45,updateTeamTagSettings:50,updatePinnedChannel:51,updatePinnedChannelsOrder:51,executeDeepLink:52,updatePlatformTab:52,createPlatformTab:52,removePlatformTab:52,setPresence:54,setStatusNote:54,blockOrUnblockUser:55,sendSearchActionsInstrumentation:58,sendSearchEntityActionsInstrumentation:58,sendSearchResultsRenderedInstrumentation:58,sendSearchClientLayoutInstrumentation:58,editSearchHistory:60,setHostTheme:61,toggleSetting:64,joinTeam:67,joinTeamByCode:67,updateTeamSetting:68,updateTeamDiscoverability:68,resetTeamJoinCode:68,removeTeamJoinCode:68,renewTeam:68,createTeam:70,editTeam:70,leaveChannel:70,setFavoriteConversationProperty:70,validateTeamName:70,createTeamFromTemplate:70,inviteMembersToTenant:72,addThirdPartyCalendar:73,removeThirdPartyCalendar:73,updateClientStateVeryActive:75,updateMSAMeSearchability:76,updateMsaUserName:76,createMsaMeProfileAndStampAliases:76,updateMsaProfileAvatar:76,removeProfilePicture:76,updateUserPreferences:78,uploadAmsItem:79,authenticateUser:81,loginUser:81,authenticationLogout:81,reauthenticateUser:81,startLiveStreamCaptions:82,stopLiveStreamCaptions:82,subscribeToBroadcastUpdates:82,unsubscribeFromBroadcastUpdates:82,meetingRecommendationSearchFeedbackResponse:83,forwardCalendarEvent:83,addToMyCalendar:83,forwardTeamEvent:83,suggestedTime:83,patchCalendarEvent:83,createSchedulingServiceEvent:83,deleteSchedulingServiceEvent:83,unhidePrivateMeetingConversation:83,publishFormCacheSyncEvent:83,publishFormLoadingSpinnerEvent:83,publishFormShareDialogEvent:83,publishFormErrorEvent:83,blockOrUnblockPstnContact:85,saveMessageDraft:86,removeMessageDraft:86,transferMessageDraft:86,tflTwoWaySmsSaveProfile:86,tflTwoWaySmsRemoveProfiles:86,translateMessage:86,requestMessageTranslations:86,updateMessageTranslationStatus:86,addOfflineAsset:86,removeOfflineAsset:86,setPinnedSkinTone:86,addVideoMessageBlobsAsOfflineAsset:86,removeAuthenticatedUser:87,provisionPersonalSharepointSite:88,backfillThreadPropertiesWithSpoIDs:88,uploadFile:88,uploadItems:88,cancelUpload:88,deleteAttachedFile:88,refreshSiteUrl:88,removeFileFromSharePoint:88,attachFiles:88,downloadFile:88,bootstrapFloodgate:89,addLiveStreamCues:91,clearLiveStreamCues:91,showLiveStreamCaptions:91,startLiveStream:91,stopLiveStream:91,setLiveStreamOptions:91,downloadLogsFiles:93,addMeetingArtifacts:94,commitMeetingArtifact:94,updateMeetingArtifacts:94,setMeetingOptions:95,setMeetingOptionsByCode:95,updateLocalMeetingOptions:95,updateLocalMeetingOptionsToSS:95,updateLocalMeetingOptionsInvitees:95,sendEmailMessage:99,saveShareToTeamsRecipient:99,deleteShareToOutlookEmailDraft:99,setShareToTeamsDesktopUpsellIsDisplayedStatus:99,submitTranslationFeedback:100,submitSurvey:100,sendInstantAnswersTelemetryIsInsightUseful:100,sendInstantAnswersTelemetryDwellTime:100,sendSmartRepliesOCVFeedback:100,createVirtualEvent:104,updateVirtualEvent:104,cancelVirtualEvent:104,addVirtualEventSpeaker:104,updateVirtualEventSpeaker:104,deleteVirtualEventSpeaker:104,addVirtualEventSession:104,updateVirtualEventSession:104,deleteVirtualEventSession:104,markReadUnread:105,deleteVoicemail:105,saveWebinar:106,submitAttendeeRegistration:106,cancelAttendeeRegistration:106,createWebinar:106,deleteWebinar:106,sendUpdateEmail:106,saveWebinarImage:106,increaseWebinarPageViewCount:106,registerConsentForD365Link:106,setPrivacyLink:106},Subscription:{activeCallsChangedEvent:0,callParticipantPinnedEventv2:0,callingServiceEvent:0,callTransferEvents:0,dominantSpeakerInfoEvent:0,callTitleChangedEvent:0,fullFrameRequiredEvent:0,callAudienceBotDataChannelEvents:0,highFidelityAudioSwitchChangedEvent:0,callMicNrgLevelsChangedEvent:0,callSpeakerVolumeChangedEvent:0,callSpeakerMutedChangedEvent:0,callSpeakerHWMutedChangedEvent:0,callPptSharingAddedEvent:0,whiteboardSharingAddedEvent:0,companionStreamAddedEvent:0,companionStreamRemovedEvent:0,callPptSharingRemovedEvent:0,callPptSharingSlideChangedEvent:0,callPptSharingPresentationUrlReadyEvent:0,callPptSharingChangeSlideCortanaInvocationEvent:0,callRecordingStateChangedEvent:0,callVoiceCollectionChangedEvent:0,callPptSharingStartedEvent:0,whiteboardSharingStartedEvent:0,callPptSharingStartFailedEvent:0,noiseSuppressionChangedEvent:0,whiteboardSharingStartFailedEvent:0,annotationChangedEvent:0,callPptSharingJoinFailedEvent:0,callLayoutChangedEvent:0,callContentCameraSharingChangedEvent:0,callParticipantPinnedEvent:0,callingScreenGalleryTypeChangedEvent:0,callingPoliciesChangedEvent:0,hasOngoingCallsChangedEvent:0,subscribedCallChangedEvent:0,bluetoothStateChangedEvent:0,callTranscriptStateEvent:0,callTranscriptEditEvent:0,callTranscriptEntryEvent:0,teamsCallIdChangedEvent:0,callHealthCategoriesUpdatedEvent:0,callingIntentEvent:0,callParticipantsChangedEvent:0,callParticipantsOnlyChangedEvent:0,callParticipantsCountsOnlyChangedEvent:0,cortanaEvent:0,meetingRoomCortanaEnabled:0,callParticipantsVoiceLevelsChangedEvent:0,callParticipantsReactionsEvent:0,callingAllowedEvent:0,hasUnreadMessagesChanged:0,startStreamsEvent:0,callingScreenStatusChanged:0,callingAppEvent:0,callingClientStateEvent:0,raiseHandStateChangedEvent:0,systemAudioStateChanged:0,closedCaptionsEntryEvent:0,closedCaptionsStatusEvent:0,videoAvailableForConversationChangedEvent:0,audienceSceneSeatingChangedEvent:0,sharingEvent:0,windowStateEvent:1,ignoreMirroringVideoPreferenceSettingChangedEvent:2,callingServiceStateEvent:2,blockedContactChangedEvent:2,callChatBubbleToggleEvent:2,localMediaVideoStreamUpdatesEvent:2,callPptSharingMediaEventUpdatedEvent:2,callPptSharingTelemetryUpdatedEvent:2,callPptSharingPrivateViewingChangedEvent:2,callPptSharingContentSharingStatusChangedEvent:2,whiteboardSharingStatusChangedEvent:2,whiteboardUrlChangedEvent:2,meetingRoomAppStateEvent:2,meetingRoomSwapScreensButtonStateChangedEvent:2,callRemotePtzCameraStateChangedEvent:2,ongoingConsultationEvent:2,bleLoudSpeakerInMeetingEvent:2,parkedCallsChangedEvent:2,adjacentRoomFoundWithIntentEvent:2,nearbyRoomsChangedEvent:2,broadcastStreamingDetailsUpdatedEvent:2,playerInteractionOperationEvent:2,contentCameraState:2,meetingRoomRemoteControlVisibilityChangedEvent:2,meetingRoomRemoteSelectedLayoutChangedEvent:2,meetingRoomCortanaStateChangedEvent:2,meetingRoomOemPluginConnectionChangedEvent:2,scdStatusEvent:2,holographicAnnotationEvent:2,callingAggregateSettingsEvent:2,biometricEnrollmentDevicesEvent:2,botSsoRequestEvent:2,buddyGroupUpdatedEvent:2,broadcastAttendeeCountEvent:2,attendeeTranscriptionEvent:2,callTechnicalInfoEvent:2,systemAudioDriverStateChangedEvent:2,callAttendeeRestrictionsChangedEvent:2,callParticipantRestrictionsChangedEvent:2,callParticipantAudioRestrictionsChangedEvent:2,callParticipantVideoRestrictionsChangedEvent:2,overflowRoomCallStateChange:2,delegateSettingsChangedEvent:2,slaCallsChangedEvent:2,callQueueIntentIdTeamsCallIdChangedEvent:2,broadcastQnaFeedUpdatedEvent:2,callCompositorFailedEvent:2,dynamicCommandsUpdateEvent:2,frameSizeChangedEvent:2,e2eeStatusChangedEvent:2,liveStreamChangedEvent:2,videoEffectConfigChangedEvent:2,videoEffectStateChangedEvent:2,gestureBasedReactionEvent:2,activityEvent:3,activitySettingsChangedEvent:5,launchTileBarItemUpdatedEvent:6,launchTileUpdatedEvent:6,installedAppsUpdateEvent:7,installedAppsUpdateEventV2:7,taskModuleUpdateEvent:7,taskModuleUpdateEventV2:7,appsUsageUpdateEvent:7,appsInstalledByCurrentUserEvent:7,biometricVoiceEnrollmentProgressEvent:10,biometricVoiceEnrollmentMicNrgLevelEvent:10,syncCalendarEvents:15,callableChannelUpdatedEvent:16,callingConversationStateEvent:17,hasMessageChanged:17,replyChainSummaryEvent:18,replyChainMessageEvent:18,messagePaneActivityEvent:20,chatListEvent:20,chatPinEvent:20,chatServiceEvent:20,chatServicePostActiveEvent:20,suggestedContactsEvent:20,keyboardLanguageEvent:22,connectedCalendarSettingsChangedEvent:23,suggestedContactsChangeEvent:24,displayContactsSyncBannerEvent:25,contactsSyncSettingsChangedEvent:26,activeEspTargetChangedEvent:31,p2pFilesListUpdated:33,p2pFilesListStoreErrorUpdated:33,hostUpdateState:36,callParticipantsReactionsLiveStateEvent:39,callMeetingNotesLiveStateEvent:39,clientPreferencesChangedEvent:40,platformTabsEvent:52,platformTabEventV2:52,platformTabEvent:52,policiesUpdatedEvent:53,presencePostActiveEvent:54,presenceUpdateEvent:54,windowState:61,zoomState:61,flyoutBeaconUpdatedEvent:66,taskbarBadgeUpdatedEvent:66,teamsAndChannelsSyncEvent:70,toastEvent:74,msaProfileAvatarChangedEvent:76,userPreferencesChangedEvent:78,authenticationUsersEvent:81,authenticationStateChanged:81,broadcastQnaFeedStatusEvent:82,broadcastUpdatedEvent:82,multiSlotFormEvent:83,callBlockingListChangedEvent:85,fileUploadProgressEvent:88,onSurveySend:89,liveStreamErrorEvent:91,liveStreamPlaybackStartedEvent:91,liveStreamPlaybackNotLiveEvent:91,liveStreamPlaybackStateChangedEvent:91,liveStreamPlaybackSeekedEvent:91,liveStreamUrlSwitchedEvent:91,liveStreamFirstFrameRenderedEvent:91,liveStreamFullScreenToggledEvent:91,liveStreamCaptionsToggledEvent:91,voicemailsChangedEvent:105}}};class zl extends Ga{constructor(e){super(),this.shellWindow=e,this.shellWindow.opener.addEventListener(R.rY.CentralDataLayerResponse,(e=>{this.onResponseReceived(e)}))}sendMessage(e){this.shellWindow.opener.postMessage(R.rY.CentralDataLayerRequest,{dataLayer:e})}}const Gl=[{predicate:e=>!!e.get(b.J.Host).msgEnableChannelsV2,resolvers:{query:["replyChainMessages","replyChainSummaries"],mutation:[],subscription:["replyChainSummariesEvent","replyChainMessagesEvent","replyChainSummaryEvent","replyChainMessageEvent"]}},{predicate:e=>!!e.get(b.J.Presence).enablePresenceInWorker,resolvers:{query:["presence","presences"],mutation:["setPresence","setStatusNote"],subscription:["presenceUpdateEvent"]}},{predicate:e=>!!e.get(b.J.Host).enableHybridChannelList||!!e.get(b.J.Host).enableHybridEduLeftRail,resolvers:{query:["defaultChannel","joinedTeams"],mutation:[],subscription:["teamsAndChannelsUpdateEvent","teamsAndChannelsSyncEvent"]}},{predicate:e=>!!e.get(b.J.Host).enableEspInWorker||!!e.get(b.J.Esp).enableEsp,resolvers:{query:["espState"],mutation:["recordEligibleSurface","recordDisplayedSurface"],subscription:[]}}],ql=[{predicate:e=>!!e.get(b.J.Host).enableOfflineActionsManager&&!!e.get(b.J.Host).msgEnableOfflineReactions,resolvers:{query:[],mutation:["updateMessageEmotion"],subscription:[]}},{predicate:e=>!!e.get(b.J.Messaging).msgEnableAutoSetConsumptionHorizonResolver,resolvers:{query:[],mutation:["setConsumptionHorizon"],subscription:[]}},{predicate:e=>!!e.get(b.J.Extensibility).enableAdaptiveAppletCacheFromCDL,resolvers:{query:[],mutation:["cardCacheOperation"],subscription:[]}}];function Jl(e,t,n){const i=function(e,t){let n;try{if(!t)throw new Error("CDL Worker did not return supported operations");n=JSON.parse(t)}catch(t){e.error(`getWorkerSupportedOperations: Failed to set CDL Worker supported operations: ${t&&t.message}`),n={query:[],mutation:[],subscription:[]}}return(0,j.mapValues)(n,(e=>e?new Set(e):new Set))}(t,n),{supportedResolvers:a,activitySupportedResolvers:o,chatSupportedResolvers:r,chatPartiallySupportedResolvers:s}=e.get(b.J.CdlWorker),l=function(e){const t={query:[],mutation:[],subscription:[]};return e.forEach((e=>e&&(0,j.mergeWith)(t,e,Yl))),t}([a,o,r,s]);return Xl(l,Gl,e,t),Kl(l,i,t,"Worker")}function Kl(e,t,n,i){if(!e)return{query:new Set,mutation:new Set,subscription:new Set};n.log(`Supported operations received from ${i}: ${JSON.stringify(e,Ql)}`);const a=(0,j.mapValues)(e,((e,n)=>new Set(e.filter((e=>t[n]&&t[n].has(e))))));return n.log(`Merged datalayer settings with config: ${JSON.stringify(a,Ql)}`),a}const Ql=(e,t)=>"object"==typeof t&&t instanceof Set?Array.from(t):t,Yl=(e,t)=>(0,j.isArray)(e)?e.concat(t):void 0;function Xl(e,t,n,i){const a={query:[],mutation:[],subscription:[]};t.forEach((({predicate:e,resolvers:t})=>{e(n)&&(0,j.mergeWith)(a,t,Yl)})),i.log(`Supported additional operations: ${JSON.stringify(a,Ql)}`),(0,j.mergeWith)(e,a,Yl)}const Zl={mutation:new Set};function ec(e){return sl({contextValue:e,resolvers:[ol.s]})}function tc(e,t,n){if(!t||0===Object.keys(t).length)return!1;const{query:i}=e,a=(0,Is.p$)(i);if(!a||a&&"OperationDefinition"!==a.kind)return!1;const{selectionSet:{selections:o}}=a,r=(0,cl.S)(i,null);if(!r)return!1;const s=r.operation;let l=!1;return o.every((e=>{if("Field"===e.kind){if(t[s]&&t[s].has(e.name.value))return l=!0,!0;if(l){n.newLogger("isDataLayerClientOperationSupported").error(`Unexpected partially supported operation - unsupported selection = ${e.name.value}`)}}return!1}))}class nc{constructor(){}static create(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){if(nc._links)throw new Error("Links are already created");return nc._links=yield ic(e),nc._links}))}static get links(){return nc._links}}nc._links=null;const ic=e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{contextValue:t,loggerFactory:n,scenarioFactory:i,coreSettings:a}=e,o=yield function({config:e,contextValue:t,cdlWorkerService:n,loggerFactory:i,scenarioFactory:a,coreSettings:o,leakDetectorService:r,windowProvider:s}){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const c=function(e,t,n,i,a,o){const r=a.get(b.J.Cdl);return Cl(new Ul(e,t,n,new zl((0,F.J)()),o,"Angular",i,{enableRequestHealthMonitor:!!r.enableRequestHealthMonitor,failureCountThreshold:r.requestHealthMonitorFailureCountThreshold,timeoutCountThreshold:r.requestHealthMonitorTimeoutCountThreshold,timeoutLengthSeconds:r.requestHealthMonitorTimeoutLengthSeconds}))}(e.clientId,i,a,s,o,r),d=$s.i0.concat(function(e){return(0,Wl.G)({map:Vl,contextBuilder:()=>e.contextValue,schemaBuilder:({typeDefs:e,resolvers:t})=>(0,Hl.sJ)({typeDefs:e,resolvers:(0,$l.yM)(t),noExtensionExtraction:!0,updateResolversInPlace:!0,resolverValidationOptions:{requireResolversForResolveType:"ignore"},skipASTValidation:!0})})}({contextValue:t}),(0,Bl.B)()),u=i.newLogger("createTerminatingLink"),m=function(e,t){const{experimentalResolvers:n,stableResolvers:i}=e.get(b.J.Cdl),a=i&&i.resolvers||{query:[],mutation:[],subscription:[]};if(t.log(`Supported operations from config: ${JSON.stringify(a,Ql)}`),i&&i.version&&n&&n.version&&i.version>=n.version){const e=n.resolvers||{query:[],mutation:[],subscription:[]};t.log(`Supported operations from ECS: ${JSON.stringify(e,Ql)}`),(0,j.mergeWith)(a,e,Yl)}Xl(a,ql,e,t);const o=(0,j.mapValues)(a,(e=>e?new Set(e):new Set)),{dataLayerSettings:r}=e.get(b.J.Host);return Kl(r,o,t,"Angular")}(o,u);let p=$s.i0.split((e=>function(e,t,n,i){const{enableCentralDataLayer:a}=n.get(b.J.Host);return!!a&&tc(e,t,i)}(e,m,o,i)),(0,$s.zo)(kl(),c),d);return Na(o)&&(p=yield function(e,t,n,i,a,o,r,s){return(0,l.__awaiter)(this,void 0,void 0,(function*(){if(!e)return o.warn("Not creating CDL Worker terminating link. Worker is enabled, but service is unavailable."),s;const c=yield e.getCDLWorkerManager();if(c){const d=a.get(b.J.CdlWorker),u=Cl(new Ul(t.clientId,n,i,c.workerClientResponseRouter.cdlGraphQLClient,void 0,"Worker",r,{enableRequestHealthMonitor:!!d.enableRequestHealthMonitor,failureCountThreshold:d.requestHealthMonitorFailureCountThreshold,timeoutCountThreshold:d.requestHealthMonitorTimeoutCountThreshold,timeoutLengthSeconds:d.requestHealthMonitorTimeoutLengthSeconds},!!d.enableClassBasedErrors,c.syncEngineInitializationPromise)),m=Jl(a,o,c.cdlWorkerSupportedResolvers);s=$s.i0.split((e=>function(e,t,n){return tc(e,t,n)}(e,m,n)),(0,$s.zo)(kl(),u),s),a.get(b.J.CdlWorker).enableControlPlaneLink&&(s=yield function(e,t,n,i,a){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const o=yield e.getControlPlaneCommunicator(),r=Cl(new Ul(t.clientId,n,i,o));return a=$s.i0.split((e=>function(e,t){return tc(e,Zl,t)}(e,n)),(0,$s.zo)(kl(),r),a)}))}(e,t,n,i,s))}return s}))}(n,e,i,a,o,u,s,p)),p}))}(e),r=ec(t);return[...a.get(b.J.Core).enableTrackRequestsLink?[gl(n,i)]:[],...a.get(b.J.Calling).enableSubscriptionCancellationListener?[fl(n,a)]:[],r,yl("presenceUpdateEvent"),yl("callParticipantUpdatedEvent"),yl("callParticipantsChangedEvent"),yl("callParticipantsVoiceLevelsChangedEvent"),yl("chatServiceEvent"),o]}));function ac(e){return function(t,{args:n,toReference:i,canRead:a}){if(a(t))return t;const o=e(n);return a(o)?i(o):void 0}}const oc={merge:["prejoinState","callTranscriptState","activeWindow","activeWindowForEntity","messages","userPreferences"],replace:["activeWindows","callingAlerts","workWeekDays","dateRange","activeCalls","listBreakoutRoomsWithDetails"]},rc={Query:{fields:Object.assign(Object.assign({user:ac((e=>({__typename:"User",id:null==e?void 0:e.userId}))),call:ac((e=>({__typename:"Call",id:null==e?void 0:e.id}))),breakoutRoomSettings:{keyArgs:["coordinates"]},listBreakoutRoomsWithDetails:{keyArgs:["coordinates"]}},oc.merge.reduce(((e,t)=>Object.assign({[t]:{merge:!0}},e)),{})),oc.replace.reduce(((e,t)=>Object.assign({[t]:{merge:!1}},e)),{}))},Subscription:{fields:{chatServiceEvent:{merge:!1},callRecordingStateChangedEvent:{merge:!1},callingServiceEvent:{merge:!1}}},MessagesResult:{keyFields:!1},WindowHistoryItem:{keyFields:!1},Window:{fields:{windowHistory:{merge:!1},activeEntities:{merge:!0},correlation:{merge:!0},extendedEntityContainerState:{merge:!0}}},DeviceList:{fields:{cameras:{merge:!1},microphones:{merge:!1},selectedDevices:{merge:!1}}},Call:{fields:{extendedCallType:{merge:!1},capabilities:{merge:!1},breakoutRoomDetails:{merge:!1}}},RoomCoordinates:{keyFields:["threadId"]},BasicParticipant:{keyFields:["participantId"]},BreakoutRoom:{fields:{isSyncInProgress:{read:e=>e||null},clientActionState:{read:e=>e||null},participants:{merge:!1}}},Entity:{keyFields:["id","type","action","options"]},CalendarEvent:{keyFields:["objectId"]},InDayEvents:{keyFields:["mailboxAddress","date"],fields:{events:{merge:!1}}},AllDayEvents:{keyFields:["mailboxAddress","date"],fields:{events:{merge:!1}}},Building:{keyFields:["address"]},RecurrenceEvents:{keyFields:["mailboxAddress","cleanGlobalObjectId"]},MeetingCompositeKey:{keyFields:["conversationId","messageId","eventId","modifiedStamp"]},Translation:{keyFields:!1},DiagnosticInfo:{keyFields:!1},EmailUser:{keyFields:["smtp"]},AuthenticationUserProfile:{keyFields:["objectId","tenantId"]},FluidPendingMention:{keyFields:["atMentionId"]},Participant:{keyFields:["participantId"]},Rectangle:{keyFields:!1},AudienceSceneExtent:{keyFields:!1},AudienceSceneParticipant:{keyFields:!1}},sc=()=>(0,Is.ZB)(["filter","typeFilter"]);function lc(e,t){return t("timestamp",e||{})||""}const cc=()=>{const e=(0,Is.ZB)(!1),{read:t,merge:n}=e,i=(0,l.__rest)(e,["read","merge"]);return Object.assign(Object.assign({},i),{merge:(e,t,i)=>{var a,o;if("function"==typeof n){const r=n(e,t,i),{readField:s}=i,l=(0,j.uniqBy)(r.edges,(e=>s("id",e.node)));return Object.assign(Object.assign({},r),{edges:l,pageInfo:Object.assign(Object.assign({},r.pageInfo),{startCursor:s("timestamp",null===(a=(0,j.head)(l))||void 0===a?void 0:a.node),endCursor:s("timestamp",null===(o=(0,j.last)(l))||void 0===o?void 0:o.node)})})}return n},read:(...e)=>{const n=e[0],{readField:i}=e[1];if(!n||!t)return;if(!n.edges)return n;const a=[...n.edges].sort(((e,t)=>function(e,t,n){const i=null==e?void 0:e.node,a=null==t?void 0:t.node,o=lc(i,n),r=lc(a,n);return o?r?parseInt(r,10)-parseInt(o,10):-1:1}(e,t,i)));return Object.assign(Object.assign({},t(...e)),{edges:a})}})};const dc=()=>{const e=rc.Query||{fields:{}};return Object.assign(Object.assign({},rc),{Query:Object.assign(Object.assign({},e),{fields:Object.assign(Object.assign({},e.fields),{chats:sc(),recentsChats:sc(),pinnedChats:sc(),activities:cc(),suggestedContactsInChatList:(0,Is.ZB)(["filter","typeFilter"]),fluidMessages:{merge:(e,t)=>[...t]}})})})},uc=e=>"cache-and-network"===e||"network-only"===e?"cache-first":e;var mc=n(303632);const pc={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"quotedReply"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"quotedReply"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"preview"}},{kind:"Field",name:{kind:"Name",value:"timestamp"}}]}}]}}]};var gc=n(539646);var hc=n(624438),vc=n.n(hc);var fc=n(837824),yc=n(23285),Sc=n(359261),kc=n(876850);const bc={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"chat"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"chat"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"isOneOnOne"}},{kind:"Field",name:{kind:"Name",value:"isDisabled"}},{kind:"Field",name:{kind:"Name",value:"chatSubType"}},{kind:"Field",name:{kind:"Name",value:"chatType"}},{kind:"Field",name:{kind:"Name",value:"isSfB"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"isMeeting"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"isMuted"}},{kind:"Field",name:{kind:"Name",value:"isFederated"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"isRetentionHorizonSet"}},{kind:"Field",name:{kind:"Name",value:"isModerator"}},{kind:"Field",name:{kind:"Name",value:"hasBotMember"}},{kind:"Field",name:{kind:"Name",value:"chatDisabledContext"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isUIDisabled"}},{kind:"Field",name:{kind:"Name",value:"disabledReason"}},{kind:"Field",name:{kind:"Name",value:"extendedData"}},{kind:"Field",name:{kind:"Name",value:"lastUpdatedTime"}}]}},{kind:"Field",name:{kind:"Name",value:"consumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonFields"}}]}},{kind:"Field",name:{kind:"Name",value:"consumptionHorizonBookmark"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonBookmarkFields"}}]}},{kind:"Field",name:{kind:"Name",value:"userConsumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonBookmarkFields"}}]}},{kind:"Field",name:{kind:"Name",value:"memberIds"}},{kind:"Field",name:{kind:"Name",value:"botMembers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userFields"}}]}},{kind:"Field",name:{kind:"Name",value:"creator"}},{kind:"Field",name:{kind:"Name",value:"meetingInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"meetingInformationFields"}}]}},{kind:"Field",name:{kind:"Name",value:"tenantId"}}]}}]}},...fc.T.definitions,...yc.v.definitions,...Sc.f.definitions,...kc.q.definitions]},_c=e=>({__typename:"ChatDisabledContext",isUIDisabled:e.isUIDisabled,disabledReason:e.disabledReason,extendedData:e.extendedData,lastUpdatedTime:e.lastUpdatedTime}),Cc=()=>({__typename:"ChatDisabledContext",isUIDisabled:!1,disabledReason:Ie.ChatDisabledContextReason.UnknownReason,extendedData:null,lastUpdatedTime:null}),wc=()=>({__typename:"ChatDisabledContext",isUIDisabled:!1,disabledReason:Ie.ChatDisabledContextReason.ChatDisabledDueToBotStatus,extendedData:null,lastUpdatedTime:null}),Tc={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fluidMessages"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fluidMessages"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}}]}}]}}]},Ec={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fluidPendingMentions"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"componentHash"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fluidPendingMentions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"componentHash"},value:{kind:"Variable",name:{kind:"Name",value:"componentHash"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"atMentionId"}},{kind:"Field",name:{kind:"Name",value:"userPrincipalName"}},{kind:"Field",name:{kind:"Name",value:"contentId"}},{kind:"Field",name:{kind:"Name",value:"navigationPath"}}]}}]}}]};const Ic={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"composeState"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"composeState"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isExpanded"}}]}}]}}]},Nc={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"imageAltText"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"imageAltText"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]};var Ac=n(884333),Mc=n(391566);const Fc={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"messagePaneScrolledToStartState"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"messagePaneScrolledToStartState"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isScrolledToStart"}}]}}]}}]},Rc={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"messageFieldsForTranslation"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"fromLanguage"}}]}}]}}]},Pc={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"twoWaySmsFriendlyName"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"twoWaySmsFriendlyName"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]},Dc={Query:{requestImmersiveReader:(e,{conversationId:t,messageId:n,setFocusOnClose:i},a)=>function(e,t,n){return(0,F.J)().opener.open(De.B.OpenOnMainRenderer,De._.ImmersiveReader,{conversationId:e,messageId:t,setFocusOnClose:n}),!0}(t,n,i)},Conversation:Object.assign({isFederated:e=>(0,gc.eX)(e.id),isMeeting:e=>e.id.startsWith("19:meeting_"),isSfB:e=>(0,gc.C6)(e.id),chatDisabledContext:e=>(e=>{if(!e)return null;if(!e.chatDisabledContext){const t=e;return t&&t.isDisabled&&t.isOneOnOne&&t.hasBotMember?wc():Cc()}return e.chatDisabledContext})(e)},{isHighImportance:()=>null,isUrgentImportance:()=>null,activeCallsCount:()=>null,datatid:()=>null,displayName:()=>null,hasActiveCalls:()=>null,hasFailedMessages:()=>null,otherMemberMris:()=>null,isNewChat:()=>null,isBotBlocked:()=>null,isBotUser:()=>null,isHidden:()=>null,isContactTagged:()=>null,pictureUpn:()=>null,pinnedIndex:()=>null,showAtMention:()=>null,showMarkers:()=>null,tooltipTitle:()=>null,longTitle:()=>null,pictureGroup:()=>null,lastMessageTime:()=>null,messagePreview:()=>null,messagePreviewAria:()=>null,isLastMessageText:()=>null,plGroupKey:()=>null,presenceSource:()=>null,hasActions:()=>null,canBeDiscarded:()=>null,canBotBeBlocked:()=>null,canBePinned:()=>null,canBeMuted:()=>null,canBeLeft:()=>null,canBeHidden:()=>null,canBeFavorited:()=>null,canTagContact:()=>null,canPopOut:()=>null,canManageApps:()=>null}),Mutation:{untranslateMessage:(e,{messageId:t},{cache:n,loggerFactory:i})=>function(e,t,n){if(!t)return null;const i=vc()`
    fragment originalMessageFields on Message {
      id
      content
    }
  `;try{const n=e.readFragment({id:`Message:${t}`,fragment:i});return n?n.content:null}catch(e){return n.error(`Failed to get message from cache: ${e}`),null}}(n,t,i.newLogger("untranslateMessage")),updateChatDisabledContext:(e,{convId:t,isUIDisabled:n,disabledReason:i,extendedData:a},{cache:o})=>((e,t,n,i,a)=>{const o={convId:t},r={__typename:"ChatDisabledContextResponse",message:"",success:!1,chatDisabledContext:Cc()};try{const t=e.readQuery({query:bc,variables:o});if(!t||!t.chat)return r.message="Could not update chatDisabledContext for a null chat conversation",r;const s=Date.now().toString();t.chat.chatDisabledContext&&(r.chatDisabledContext=Object.assign({},t.chat.chatDisabledContext));const l={__typename:"ChatDisabledContext",isUIDisabled:n,disabledReason:i,extendedData:a,lastUpdatedTime:s},c={chat:Object.assign(Object.assign({},t.chat),{chatDisabledContext:l})};e.writeQuery({query:bc,variables:o,data:c}),r.success=!0,c&&c.chat&&c.chat.chatDisabledContext&&(r.chatDisabledContext=_c(c.chat.chatDisabledContext))}catch(e){r.message=`Exception: Failed to update chatDisabledContext for conversation ${t}. Exception Details: ${e.message}`}return r})(o,t,n,i,a),resetQuotedReply:(e,{convId:t},{cache:n})=>((e,t)=>(t.writeQuery({query:pc,variables:{convId:e},data:{quotedReply:null}}),!0))(t,n),setQuotedReply:(e,{convId:t,quotedReply:n},{cache:i})=>((e,{displayName:t,from:n,messageId:i,preview:a,timestamp:o},r)=>{const s={quotedReply:{__typename:"QuotedReply",displayName:t,from:n,messageId:i,preview:a,timestamp:o}};return r.writeQuery({query:pc,variables:{convId:e},data:s}),!0})(t,n,i),updateComposeState(e,{id:t,isExpanded:n},{cache:i,loggerFactory:a}){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const e={__typename:"ComposeMessageState",id:t,isExpanded:n};try{i.writeQuery({query:Ic,variables:{id:t},data:{composeState:Object.assign(Object.assign({},e),{__typename:"ComposeMessageState"})}})}catch(e){a.newLogger("update-compose-state").error(`Failed to write to client cache the compose state query. Error: ${e.message}`)}return e}))},setImageAltText(e,{altText:t},{cache:n,loggerFactory:i}){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const e={imageAltText:t};try{n.writeQuery({query:Nc,data:e})}catch(e){i.newLogger("update-image-alt-text").error(`Failed to write to client cache the image alt text query. Error: ${e.message}`)}return!0}))},insertHyperlink(e,{displayText:t,address:n},{cache:i,loggerFactory:a}){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const e={__typename:"FluidInsertedHyperlink",displayText:t,address:n};try{i.writeQuery({query:Ac.D,data:{insertedHyperlink:Object.assign(Object.assign({},e),{__typename:"FluidInsertedHyperlink"})}})}catch(e){a.newLogger("insert-hyperlink-dialog-data").error(`Failed to write to client cache the insert hyperlink dialog data query. Error: ${e.message}`)}return!0}))},setTwoWaySmsFriendlyName(e,{twoWaySmsFriendlyName:t},{cache:n,loggerFactory:i}){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const e={twoWaySmsFriendlyName:t};try{n.writeQuery({query:Pc,data:e})}catch(e){i.newLogger("update-tfl-two-way-sms-friendly-name").error(`Failed to write to client cache the tfl two way sms friendly name query. Error: ${e.message}`)}return!0}))},updateMessagePaneScrolledToStartState(e,{id:t,isScrolledToStart:n},{cache:i,loggerFactory:a}){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const e={__typename:"MessagePaneScrolledToStartState",id:t,isScrolledToStart:n};try{i.writeQuery({query:Fc,variables:{id:t},data:{messagePaneScrolledToStartState:Object.assign(Object.assign({},e),{__typename:"MessagePaneScrolledToStartState"})}})}catch(e){a.newLogger("update-chat-bottom-state").error(`Failed to write to client cache the chat bottom state query. Error: ${e.message}`)}return e}))},setDlpDialogData(e,{isReport:t,isOverride:n,justification:i},{cache:a,loggerFactory:o}){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const e={__typename:"DlpDialogData",isReport:t,isOverride:n,justification:i};try{a.writeQuery({query:Mc.C,data:{dlpDialogData:Object.assign(Object.assign({},e),{__typename:"DlpDialogData"})}})}catch(e){o.newLogger("set-dlp-dialog-data").error(`Failed to write to client cache the set dlp dialog data query. Error: ${e.message}`)}return e}))},setFluidMessage:(e,{fluidMessage:t,remove:n},{cache:i,loggerFactory:a})=>(({messageId:e,originalArrivalTime:t},n,i,a)=>{try{const a=i.readQuery({query:Tc}),o=n?function(e,t){var n;return{fluidMessages:(null===(n=null==e?void 0:e.fluidMessages)||void 0===n?void 0:n.filter((e=>e.messageId!==t)))||[]}}(a,e):function(e,t,n){const i=[],a={__typename:"FluidMessage",id:t,messageId:t,originalArrivalTime:n};let o=!1;if(null==e?void 0:e.fluidMessages)for(const t of e.fluidMessages)t.originalArrivalTime<a.originalArrivalTime&&!o&&(i.push(a),o=!0),i.push(t);return o||i.push(a),{fluidMessages:i}}(a,e,t);return i.writeQuery({query:Tc,data:o}),!0}catch(e){return a.newLogger("set-fluid-messages-pending-load").error(`Failed to write to client cache the set fluid message pending load query. Error: ${e.message}`),!1}})(t,!!n,i,a),updateFluidPendingMentions:(e,{componentHash:t,pendingMention:n,remove:i},{cache:a,loggerFactory:o})=>((e,t,n,i,a)=>{try{const a=Object.assign({__typename:"FluidPendingMention"},t),o={componentHash:e},r=i.readQuery({query:Ec,variables:o}),s=((null==r?void 0:r.fluidPendingMentions)||[]).filter((e=>a.userPrincipalName!==e.userPrincipalName)),l=n?s:[...s,a];return i.writeQuery({query:Ec,variables:o,data:{fluidPendingMentions:l}}),!0}catch(e){return a.newLogger("fluid-resolvers-update-pending-fluid-mentions").error(`Failed to write pending mentions to the cache, error="${e.message}"`),!1}})(t,n,!!i,a,o),clearFluidPendingMentions:(e,{componentHash:t},{cache:n,loggerFactory:i})=>((e,t,n)=>{try{const n={componentHash:e};return t.writeQuery({query:Ec,variables:n,data:{fluidPendingMentions:[]}}),!0}catch(e){return n.newLogger("fluid-resolvers-clear-fluid-pending-mentions").error(`Failed to clear pending mentions from the cache, error="${e.message}"`),!1}})(t,n,i)},Message:{deletionInfo:(e,t,{cache:n})=>(0,mc.sE)(n,e),translation:(e,t,{cache:n})=>{var i;const a={status:Ie.TranslationStatus.NotStarted,content:null,fromLanguage:null};try{const t=`Message:${e.id}`,o=null===(i=n.readFragment({id:t,fragment:Rc}))||void 0===i?void 0:i.translation;return Object.assign({__typename:"Translation"},null!=o?o:a)}catch(e){return Object.assign({__typename:"Translation"},a)}},diagnosticInfo:()=>({__typename:"DiagnosticInfo",diagnosticErrorCode:-1,diagnosticMessage:null})}};var jc=n(702482);var xc=n(910952);const Oc={Mutation:{addFileUpload(e,{fileToAdd:t},{cache:n}){const{fileContainerId:i}=t,a=(({uploadId:e,fileName:t,serviceName:n})=>({title:t,status:Ie.FileUploadStatus.PROGRESS,id:e,itemId:null,type:(0,jc.mD)(t),objectUrl:"",baseUrl:"",progress:1,fileId:"",isReferencedFile:!1,shareUrl:"",shareId:"",previewUrl:"",chicletBreadcrumbs:null,permissionScope:null,previewHeight:null,previewWidth:null,progressComplete:null,state:Ie.FileChicletState.active,hasUploadFailed:!1,serviceName:n,__typename:"FileUpload"}))(t);return(0,xc.zz)([a],n,i),!0},removeFileUpload(e,{input:t},{cache:n}){const{uploadId:i,fileContainerId:a}=t;return(0,xc.Fj)(i,a,n),!0}}};var Lc=n(607823);const Uc=e=>{if(e){const{appIcon:t,appId:n,appName:i,contentType:a,content:o,locale:r}=e;return{__typename:"PlatformCard",appIcon:t||null,appId:n||null,appName:i||null,content:o,contentType:a,locale:r||null}}return null};var Bc=n(380382);var Wc=n(259567);const Hc={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"selectPeoplePickerResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"selectPeoplePickerResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"email"}}]}}]}}]},$c={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"platformAppsFetchPolicyFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PlatformAppsFetchPolicy"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"forceNetworkFetch"}},{kind:"Field",name:{kind:"Name",value:"scope"}},{kind:"Field",name:{kind:"Name",value:"convId"}}]}}]},Vc="PlatformAppsFetchPolicy",zc=(e,t)=>{let n=`${Vc}:${e}`;return t&&(n=`${n}:${t}`),n},Gc=(e,t)=>{let n=!0;try{const n=zc(t.scope,t.convId);e.writeFragment({id:n,fragment:$c,data:t})}catch(e){n=!1}return n},qc=(e,t,n)=>{let i=`${e}`;return t&&(i=`${i}:${t}`),{__typename:Vc,id:i,scope:e,forceNetworkFetch:n,convId:null!=t?t:null}};var Jc=n(66957);var Kc=n(392696);var Qc=n(834954);const Yc={__typename:"MessageExtensionsAppsState",toggleRefetch:!1},Xc=(e,t)=>{try{const n=e.readQuery({query:Qc.F,variables:{convId:t}});if(!n)throw new Error("Unable to read ME apps state from cache");return n}catch(e){throw e}};var Zc=n(229183);var ed=n(374737);var td=n(946552);var nd=n(805373);const id={Query:{platformAppsBatchFetchPolicy:(e,{options:t},{cache:n})=>t.map((({scope:e,convId:t})=>((e,{scope:t,convId:n})=>{let i;try{const a=zc(t,n),o=e.readFragment({id:a,fragment:$c});i=null==o?void 0:o.forceNetworkFetch}catch(e){i=!1}return qc(t,n,null!=i&&i)})(n,{scope:e,convId:t}))),messageExtensionsAppsState:()=>Yc},Mutation:{toggleAppsRefetch:(e,{convId:t},{cache:n})=>{try{const e=Xc(n,t),{messageExtensionsAppsState:i}=e,a=!i.toggleRefetch,o={messageExtensionsAppsState:Object.assign(Object.assign({},i),{toggleRefetch:a})};n.writeQuery({query:Qc.F,variables:{convId:t},data:o});return Xc(n,t).messageExtensionsAppsState.toggleRefetch}catch(e){throw e}},updateTaskModuleResult:(e,{text:t,taskModuleId:n,draftId:i,card:a,conversationId:o,adaptiveCardTabResult:r,reason:s,entryPoint:l},{cache:c})=>{var d;try{const e={taskModuleResult:{__typename:"TaskModuleResult",text:null!=t?t:null,card:Uc(a),adaptiveCardTabResult:null!==(d=r&&r.map((e=>Uc(e))))&&void 0!==d?d:null,taskModuleId:n,draftId:null!=i?i:null,conversationId:null!=o?o:null,reason:s,entryPoint:l}};return c.writeQuery({query:Lc.s,data:e}),!0}catch(e){return!1}},resetTaskModuleResult:(e,t,{cache:n})=>{try{return n.writeQuery({query:Lc.s,data:{taskModuleResult:null}}),!0}catch(e){return!1}},updateAppDetailsResult:(e,{input:t},{cache:n})=>{try{if(!t)throw new Error("No appInstallDetails input received");const{appId:e,appInstallId:i,isAppInstalled:a,errorCode:o}=t,r={appDetailsResult:{__typename:"AppDetailsResult",appInstallId:i,appId:e,isAppInstalled:a,errorCode:o||null}};return n.writeQuery({query:Bc.i,data:r}),!0}catch(e){return!1}},setPlatformAppsFetchPolicy:(e,{input:t},{cache:n})=>((e,t)=>{var n;let i=!0;for(const a of t){let t=!0;const o={__typename:Vc,forceNetworkFetch:a.fetchSource===Ie.PlatformAppsFetchSource.Network,scope:a.scope,convId:null!==(n=a.convId)&&void 0!==n?n:null};t=Gc(e,o),i=i&&t}return i})(n,t),updateTabConfigurationResult:(e,{id:t,tabId:n},{cache:i})=>{try{const e={tabConfigurationResult:{__typename:"tabConfigurationResult",id:t,tabId:n}};return i.writeQuery({query:Zc.s,variables:{threadId:t},data:e}),!0}catch(e){return!1}},updateMessageToParentResult:(e,{appId:t,message:n},{cache:i})=>{try{const e={messageToParentResult:{__typename:"messageToParentResult",appId:t,message:n}};return i.writeQuery({query:ed.y,variables:{appId:t},data:e}),!0}catch(e){return!1}},updateMessageToChildResult:(e,{appId:t,message:n},{cache:i})=>{try{const e={messageToChildResult:{__typename:"messageToChildResult",appId:t,message:n}};return i.writeQuery({query:td.n,variables:{appId:t},data:e}),!0}catch(e){return!1}},updateSelectMediaResult:(e,{input:t},{cache:n})=>{var i;try{const{selectMediaError:e,mediaUrls:a}=t,o={selectMediaResult:{__typename:"SelectMediaResult",selectMediaError:null!=e?e:null,mediaUrls:null!==(i=a)&&void 0!==i?i:null}};return n.writeQuery({query:Jc.a,data:o}),!0}catch(e){return!1}},resetSelectMediaResult:(e,t,{cache:n})=>{try{return n.writeQuery({query:Jc.a,data:{selectMediaResult:null}}),!0}catch(e){return!1}},updateViewImagesResult:(e,{input:t},{cache:n})=>{try{const{viewImagesError:e,errorCode:i}=t,a={viewImagesResult:{__typename:"ViewImagesResult",viewImagesError:null!=e?e:null,errorCode:null!=i?i:null}};return n.writeQuery({query:Kc.R,data:a}),!0}catch(e){return!1}},resetViewImagesResult:(e,t,{cache:n})=>{try{return n.writeQuery({query:Kc.R,data:{viewImagesResult:null}}),!0}catch(e){return!1}},updateMapCoordinateResult:(e,{coordinates:t},{cache:n})=>{try{const{latitude:e,longitude:i}=t,a={mapCoordinateResult:{__typename:"MapCoordinateResult",latitude:null!=e?e:null,longitude:null!=i?i:null}};return n.writeQuery({query:Wc.i,data:a}),!0}catch(e){return!1}},resetMapCoordinateResult:(e,t,{cache:n})=>{try{return n.writeQuery({query:Wc.i,data:{mapCoordinateResult:null}}),!0}catch(e){return!1}},resetSelectPeoplePickerResult:(e,t,{cache:n})=>{try{return n.writeQuery({query:Hc,data:{selectPeoplePickerResult:[]}}),!0}catch(e){return!1}},updateSelectPeoplePickerResult:(e,{selectPeoplePickerResult:t},{cache:n})=>{try{const e={selectPeoplePickerResult:t.map((e=>({__typename:"SelectPeoplePickerResult",objectId:e.objectId,displayName:e.displayName||"",email:e.email||""})))};return n.writeQuery({query:Hc,data:e}),!0}catch(e){return!1}},updateCustomAppUploadResult:(e,{input:t},{cache:n})=>{try{if(!t)throw new Error("No customAppUpload input received");const{customAppType:e}=t,i={customAppUploadResult:{__typename:"CustomAppUploadResult",customAppType:e}};return n.writeQuery({query:nd.k,data:i}),!0}catch(e){return!1}}}};var ad=n(803878),od=n(34432),rd=n(886449),sd=n(402604),ld=n(403223);const cd="mainAppWindowActiveEntities";function dd(e,t){return!(!e||!t)&&(e.id===t.id&&e.type===t.type&&e.action===t.action)}function ud(e,t,n){const i=new Map,a=new Map;for(const o of e){if(n&&!n(o))continue;const{mainEntity:e,endEntity:r}=o.activeEntities;i.set(t(e),[o,e]);const{linkedEntity:s}=e;if(s&&a.set(t(s),[o,s]),r){i.set(t(r),[o,r]);const{linkedEntity:e}=r;e&&a.set(t(e),[o,e])}}return[i,a]}function md(e){return`${e.type}-${e.id}`}function pd(e){return!!e.activeEntities}function gd(e,t){if(!t)return{subNavEntity:null,headerEntity:null,startEntity:null,mainEntity:null,endEntity:null,entityExtension:null};const{__typename:n}=t,i=(0,l.__rest)(t,["__typename"]),a=Object.assign({},i);if(!e)return a;const{subNavEntity:o,headerEntity:r,startEntity:s,mainEntity:c,endEntity:d,entityExtension:u}=e,{subNavEntity:m,headerEntity:p,startEntity:g,mainEntity:h,endEntity:v,entityExtension:f}=t;return a.subNavEntity=dd(o,m)?null:m,a.headerEntity=dd(r,p)?null:p,a.startEntity=dd(s,g)?null:g,a.mainEntity=dd(c,h)?null:h,a.endEntity=dd(d,v)?null:v,a.entityExtension=dd(u,f)?null:f,a}function hd(e,t){var n;const i=function(e,t){if(!t)return{subNavEntity:null,headerEntity:null,startEntity:null,mainEntity:null,endEntity:null,entityExtension:null};const n=Object.assign({},t);if(!e)return n;const{subNavEntity:i,headerEntity:a,startEntity:o,mainEntity:r,endEntity:s,entityExtension:l}=e,{subNavEntity:c,headerEntity:d,startEntity:u,mainEntity:m,endEntity:p,entityExtension:g}=t;return n.subNavEntity=dd(i,c)?null:null!=c?c:i,n.headerEntity=dd(a,d)?null:null!=d?d:a,n.startEntity=dd(o,u)?null:null!=u?u:o,n.mainEntity=dd(r,m)?null:null!=m?m:r,n.endEntity=dd(s,p)?null:null!=p?p:s,n.entityExtension=dd(l,g)?null:null!=g?g:l,n}(pd(e)?e.activeEntities:null,pd(t)?t.activeEntities:null);return!(null==i.mainEntity&&null==i.entityExtension&&null!==i.endEntity&&"search"!==(null===(n=i.endEntity)||void 0===n?void 0:n.type))}function vd(e){return!!(e.mainEntity||e.endEntity||e.entityExtension)}function fd(){return{__typename:"ExtendedEntityContainerState",containerState:Ie.ExtendedContainerState.Closed,isExternal:!1}}const yd=()=>({id:(0,Be.v4)(),startTimestamp:Date.now().toString(),source:k.D.Unknown});function Sd(e){if(!e)return null;const{action:t=null,entityState:n={flushableByLinkedEntity:!0},id:i,linkedEntity:a=null,options:o=null,type:r,windowOptions:s=null}=Object.assign({},e);return{action:null!=t?t:Ie.EntityAction.view,entityState:{flushableByLinkedEntity:n.flushableByLinkedEntity,__typename:"EntityState"},id:i||null,linkedEntity:a&&bd(a)||null,options:o,type:r,windowOptions:s?Object.assign(Object.assign({},s),{__typename:"WindowOptions"}):null,__typename:"Entity"}}function kd(e,t,n){return{id:e.id||null,type:e.type,action:e.action,options:t||null,windowOptions:n?Object.assign(Object.assign({},n),{__typename:"WindowOptions"}):null,linkedEntity:e.linkedEntity&&bd(e.linkedEntity)||null,entityState:{flushableByLinkedEntity:!0,__typename:"EntityState"},__typename:"Entity"}}function bd(e){return{action:e.action||null,id:e.id,type:e.type,__typename:"LinkedEntity"}}function _d(e,t,n,i,a,o){return vd(e)&&!!Cd(e,t)||!!wd(e,Id)||!!wd(e,Nd)||!!wd(e,Ad)||!!wd(e,Md)||!!wd(e,Fd)||!!wd(e,Ud)||!!wd(e,Rd)||!!wd(e,Wd)||!!wd(e,zd)||!!wd(e,$d)||function(e,t,n){const{launchPlatformBIMDialog:i}=t.get(b.J.Core);return function(e,t,n){return!!n&&t===S.ew&&!!wd(e,Bd)}(e,n,i)||function(e,t){return!!t&&!!wd(e,Hd)}(e,i)||!!i&&!!wd(e,Vd)}(e,a,t)||function(e,t){const{enableBrb:n}=t.get(b.J.Brb);return!n&&!!wd(e,Ld)}(e,a)||function(e,t){const{enableHybridChannelList:n,msgEnableChannelsV2:i}=t.get(b.J.Host);return!(i||n||!wd(e,Pd))}(e,a)||function(e,t){const{isCalendarSurfaceHybridArchitectureEnabled:n}=t.get(b.J.Host),i=!!wd(e,Od);if(i&&n)return!1;return i}(e,a)||function(e,t){const{isSchedulingFormHybridArchitecureEnabled:n}=t.get(b.J.Host),{enableMultiWindowCalendarSchedulingForm:i}=t.get(b.J.Calendar),a=!!wd(e,jd);if(i&&a)return!1;return a&&!n}(e,a)||function(e,t,n,i,a){const{isSchedulingFormHybridArchitecureEnabled:o}=a.get(b.J.Host),{enableMultiWindowCalendarSchedulingFormViewAndEdit:r}=a.get(b.J.Calendar),s=!!wd(e,xd);if(s&&i)return!1;if(o&&s)return t!==S.ew;if(r&&s)return!(t!==S.ew||!n);return s}(e,t,n,i,a)||function(e,t,n,i){const{isChatHybridArchitectureEnabled:a}=t.get(b.J.Host),o=wd(e,Ed);let r=!!o;o&&(i.log(`Checking if opener should handle chat ${o.id}: isChatHybridArchitectureEnabled\n      ${a}, and isNotNewNorNoneOnMainContext ${n}`),r=!1===a&&n,i.log(`Opener should handle chat ${o.id} ${r}`));return r}(e,a,n,o)}function Cd(e,t){return t===S.ew?wd(e,Td):null}function wd(e,t){const{mainEntity:n,endEntity:i,entityExtension:a}=e;let o=null;return n&&t(n)&&(o=n),i&&t(i)&&(o=i),a&&t(a)&&(o=a),o}function Td(e){return!!e&&[Ie.EntityType.addchannel,Ie.EntityType.addmember,Ie.EntityType.addmembernewteam,Ie.EntityType.broadcastliveevent,Ie.EntityType.channelconnectors,Ie.EntityType.channeldeeplink,Ie.EntityType.channeldelete,Ie.EntityType.channeledit,Ie.EntityType.channelemail,Ie.EntityType.teamcreate,Ie.EntityType.teamdeeplink,Ie.EntityType.teamedit,Ie.EntityType.teamjoincode,Ie.EntityType.teamleave,Ie.EntityType.teampicture,Ie.EntityType.teamrenewal].indexOf(e.type)>=0}function Ed(e){return e&&e.type===Ie.EntityType.chats}function Id(e){const t=!(!e||e.type!==Ie.EntityType.extensions||e.id!==be.oz.organization);if(t&&!(null==e?void 0:e.linkedEntity))throw(0,Z.Tr)(S.w5.Commanding,S.jK.Undefined,"CommandChangeNotification",void 0,"Org chart entity defined without a linked entity. Cannot notify host of route change.");return t}function Nd(e){return(null==e?void 0:e.type)===Ie.EntityType.transcripttab}function Ad(e){return!(!e||e.type!==Ie.EntityType.platformapps||e.action!==Ie.EntityAction.list)}function Md(e){return!(!e||e.type!==Ie.EntityType.platformStage)}function Fd(e){return!(!e||e.type!==Ie.EntityType.platformapps||e.action!==Ie.EntityAction.manage)}function Rd(e){return!(!e||(e.type!==Ie.EntityType.file||e.action!==Ie.EntityAction.view)&&e.type!==Ie.EntityType.fileopensettings)}function Pd(e){return!(!e||e.type!==Ie.EntityType.channels||!e.id)}function Dd(e){return!(!e||e.type!==Ie.EntityType.schedulingform)}function jd(e){return!(!e||e.type!==Ie.EntityType.schedulingform||e.action!==Ie.EntityAction.create)}function xd(e){return!(!e||e.type!==Ie.EntityType.schedulingform||e.action!==Ie.EntityAction.view)}function Od(e){return!(!e||e.type!==Ie.EntityType.calendar)}function Ld(e){return!(!e||e.type!==Ie.EntityType.brbfeedbackdialog)}function Ud(e){return!(!e||e.type!==Ie.EntityType.open3sfeedback)}function Bd(e){return!(!e||e.type!==Ie.EntityType.taskmodule)}function Wd(e){return!(!e||e.type!==Ie.EntityType.accounts)}function Hd(e){return!(!e||e.type!==Ie.EntityType.platformapp&&e.type!==Ie.EntityType.platformsubscriptionplans||e.action!==Ie.EntityAction.info)}function $d(e){return!(!e||e.type!==Ie.EntityType.platformappdetails||e.action!==Ie.EntityAction.config&&e.action!==Ie.EntityAction.update)}function Vd(e){return!(!e||e.type!==Ie.EntityType.workflows||e.action!==Ie.EntityAction.create)}function zd(e){return!(!e||e.type!==Ie.EntityType.customapp||e.action!==Ie.EntityAction.create)}var Gd=n(348154);const qd={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"TileWithSelection"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"LaunchTile"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isSelected"}}]}}]},Jd={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"UpdateNovaAppSelectionQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lockedTiles"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"TilesWithSelectionStatus"}}]}},{kind:"Field",name:{kind:"Name",value:"pinnedTiles"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"TilesWithSelectionStatus"}}]}},{kind:"Field",name:{kind:"Name",value:"mostRecentlyUsedTiles"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"TilesWithSelectionStatus"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"TilesWithSelectionStatus"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"TileConnection"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"edges"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"node"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"command"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"entity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}},{kind:"FragmentSpread",name:{kind:"Name",value:"TileWithSelection"}}]}}]}}]}},...qd.definitions]}.definitions]},Kd={activity:"teams_activity",chats:"teams_chat",calendar:"teams_calendar"};function Qd(e,t,n){e.writeFragment({id:`LaunchTile:${t}`,fragment:qd,data:{__typename:"LaunchTile",isSelected:n}})}const Yd=e=>{var t,n,i;return null!==(i=null!==(n=null!==(t=e.subNavEntity)&&void 0!==t?t:e.headerEntity)&&void 0!==n?n:e.startEntity)&&void 0!==i?i:e.mainEntity},Xd=({appsRegistryService:e,contextEntity:t,coreSettings:n,entity:i,layoutMode:a})=>{if(!i)throw new Error("entity used to match app is null");const o=e.getApp({entityType:i.type});if(o&&o.getAppViewEntities)return o.getAppViewEntities({contextEntity:t,coreSettings:n,entity:i,layoutMode:a})},Zd={[Ie.SupportedViewEntities.subNavEntity]:{children:[Ie.SupportedViewEntities.headerEntity,Ie.SupportedViewEntities.startEntity,Ie.SupportedViewEntities.mainEntity,Ie.SupportedViewEntities.endEntity]},[Ie.SupportedViewEntities.headerEntity]:{children:[Ie.SupportedViewEntities.startEntity,Ie.SupportedViewEntities.mainEntity,Ie.SupportedViewEntities.endEntity]},[Ie.SupportedViewEntities.startEntity]:{children:[Ie.SupportedViewEntities.mainEntity,Ie.SupportedViewEntities.endEntity]},[Ie.SupportedViewEntities.mainEntity]:{children:[Ie.SupportedViewEntities.endEntity]},[Ie.SupportedViewEntities.endEntity]:{children:null}};function eu(e,t,n=e.windowHistory.length-1){e.currentWindowHistoryIndex=n,e.windowHistoryNavigationState.canNavigateBack=1===e.windowHistory.length||n>0,e.windowHistoryNavigationState.canNavigateForward=n<e.windowHistory.length-1,e.windowHistoryNavigationState.backHistory=tu(0,n-1,e.windowHistory).reverse(),e.windowHistoryNavigationState.forwardHistory=tu(n+1,e.windowHistory.length-1,e.windowHistory),t.debug(`Reset windowHistoryNavigationState. size: ${e.windowHistory.length}, windowHistoryIndex: ${n}`),t.debug(`Reset windowHistoryNavigationState. canNavigateBack: ${e.windowHistoryNavigationState.canNavigateBack}, canNavigateForward: ${e.windowHistoryNavigationState.canNavigateForward}, backHistory size: ${e.windowHistoryNavigationState.backHistory.length}, forwardHistory size: ${e.windowHistoryNavigationState.forwardHistory.length}`)}function tu(e,t,n){if(!n)return[];const i=[];for(let a=e;a<=t;a++)i.push({__typename:"WindowHistoryNavigationItem",windowHistoryIndex:a,entity:n[a].activeEntities.mainEntity});return i}const nu=(e,t,n)=>{const i=i=>!i||n(t.getApp({entityType:i.type}),{mainEntity:e.mainEntity,subNavEntity:e.subNavEntity});return i(e.mainEntity)&&i(e.subNavEntity)};function iu(e,t,n,i,a,o){const{activeEntities:r,currentWindowHistoryIndex:s}=n;let{windowHistory:l}=n;if(r&&vd(gd(r,i))&&((e,t)=>nu(e,t,((e,t)=>{var n;return!(null===(n=null==e?void 0:e.onBeforeAddToNavigation)||void 0===n?void 0:n.shouldAddEntitiesToWindowHistory)||e.onBeforeAddToNavigation.shouldAddEntitiesToWindowHistory(t)})))(r,a)){s<l.length-1&&(l=l.slice(0,s+1),t.debug(`Reset windowHistory navigation path after index ${s}.`));const n=[...l,{__typename:"WindowHistoryItem",activeEntities:r}];return o&&(e.history.pushState({windowHistoryIndex:n.length},""),t.debug(`Added browser history entry with windowHistoryIndex: ${n.length}.`)),n}return l}function au(e,t){try{const{activeWindows:t=[]}=e.readQuery({query:Gd.fX})||{};return(0,j.cloneDeep)(t)}catch(e){return t.debug("activeWindowsQuery entry not found in cache"),[]}}function ou(e,t,n,i,a,o,r,s,l){const c=function(e,t,n,i){let a;const o=t.slice(0);if(pd(e)){const t=o.findIndex((t=>t.id===e.id));a=e,-1===t?o.push(a):o[t]=a}else{const t=e.windowHistory.length;if(t>0&&!e.windowHistory[t-1].activeEntities)throw(0,Z.Tr)(S.w5.Commanding,S.jK.Undefined,"executeEntityCommand",e.correlation,"Unable to resolve to active entities");a=o.splice(o.findIndex((t=>t.id===e.id)),1)[0],n.log(`Window has no active entities so destroying for correlation ${i}`)}return o}(n,t,i,n.correlation.id);try{e.writeQuery({query:Gd.fX,data:{activeWindows:c}})}catch(e){return i.error(`activeWindowsQuery cache write failed - ${e.message}`),!1}return su(t,n,a,o,r,l),ru(s,e,t,n,i),i.log(`After updating window cache, there are ${c.length} active windows`),!0}const ru=(e,t,n,i,a)=>{e&&pd(i)&&cu(n,i.id)&&function(e,t,n){const i=Kd[t.type];try{const t=e.readQuery({query:Jd});if(t){let n,a;for(const[,e]of(0,j.entries)(t))if(n||(n=e.edges.find((e=>e.node.isSelected))),a||(a=e.edges.find((e=>e.node.command.entity.type===i))),n&&a)break;if((null==n?void 0:n.node.id)===(null==a?void 0:a.node.id))return;n&&Qd(e,n.node.id,!1),a&&Qd(e,a.node.id,!0)}}catch(e){n.error("Error thrown updating Nova AppBar selection.")}}(t,Yd(i.activeEntities),a)},su=(e,t,n,i,a,o)=>{if(pd(t)&&cu(e,t.id)&&(((e,t)=>nu(e,t,((e,t)=>{var n;return!(null===(n=null==e?void 0:e.onBeforeAddToNavigation)||void 0===n?void 0:n.shouldRestoreClientToEntities)||e.onBeforeAddToNavigation.shouldRestoreClientToEntities(t)})))(t.activeEntities,i)&&a&&n.set(cd,JSON.stringify(t.activeEntities)),o)){const e=Yd(t.activeEntities),a=i.getApp({entityType:e.type});if(null==a?void 0:a.manifest.shouldUseHistoryOnDefaultCommand){const e=null==a?void 0:a.manifest.id;n.set(`appActiveEntitiesHistory-${e}`,JSON.stringify(t.activeEntities))}}},lu=(e,t)=>e.find((e=>e.layoutMode===t&&e.isMainWindow)),cu=(e,t)=>{const n=lu(e,Ie.LayoutModes.standard);return t===S.ew||t===(null==n?void 0:n.id)};function du(e,t){const n=e.get(t);return n&&n[0]}function uu(e,t){return e.find((e=>e.id===t))}function mu(e,t,n){let i=du(t,md(e));const{linkedEntity:a}=e;let o=!1;return!i&&a&&(i=du(t,md(a)),o=!!i),!i&&e.id&&(i=du(n,md({id:e.id,type:e.type})),o=!!i),[i,o]}function pu({pubsub:e,fromWindowId:t,sourceWindowId:n,diff:i,targetWindow:a,targetVisibilityState:o,stateTransition:r,correlation:s,logger:l}){!function(e,t,n,i,a,o,r){pd(o)&&o.id!==S.ew&&gu(t,a)&&(n.log(`Focusing window ${r} for correlation ${e.id}`),i.publish(`windowStateEvent-${r}`,{windowStateEvent:{isFocused:!0,correlation:e}}))}(s,i,l,e,o,a,n),function(e,t,n,i,a,o,r,s){!gu(t,r)||n===S.ew||s.id===n||o!==Ie.EntityStateTransition.flush&&o!==Ie.EntityStateTransition.forceFlush||(i.log(`Closing ${n} for correlation ${e.id}`),a.publish(`windowStateEvent-${n}`,{windowStateEvent:{correlation:e,shouldClose:!0}}))}(s,i,t,l,e,r,o,a)}function gu(e,t){return t===Ie.EntityVisibilityState.show||t===Ie.EntityVisibilityState.toggle&&vd(e)}const hu=(e,t,n,i,a,o)=>{if(i===t.windowHistory.length-1){const r={activeEntities:t.activeEntities,windowHistory:t.windowHistory,currentWindowHistoryIndex:i},s=t.windowHistory.length;t.windowHistory=iu(e,n,r,t.windowHistory[i].activeEntities,a,o),t.windowHistory.length!==s&&(i++,n.log("Currently active entities pushed to history and index adjusted."))}return i},vu=(e,t,n,i,a,o,r,s,l,c)=>(e.activeEntities=e.windowHistory[t].activeEntities,eu(e,n,t),ou(i,a,e,n,o,r,s,l,c));function fu(e){if(!e)return"{}";const{id:t,type:n,action:i,linkedEntity:a,entityState:o}=Object.assign({},e);return`{\n    id: ${t}, \n    type: ${n}, \n    action: ${i}, \n    linkedEntity: { \n      id: ${a&&a.id}, \n      type: ${a&&a.type}}, \n    entityState: {\n      flushableByLinkedEntity: ${null==o?void 0:o.flushableByLinkedEntity}\n    }\n  }`}function yu(e){return e?`{\n    id: ${e.id}\n    startTimestamp: ${e.startTimestamp},\n    source: ${e.source}\n  }`:"{}"}function Su(e){const{id:t,correlation:n,isMainWindow:i,layoutMode:a}=e;return`{\n    id: ${t},\n    correlation: ${yu(n)},\n    activeEntities: ${pd(e)?(o=e.activeEntities,`{\n    subNavEntity: ${fu(o.subNavEntity)},\n    headerEntity: ${fu(o.headerEntity)},\n    startEntity: ${fu(o.startEntity)},\n    mainEntity: ${fu(o.mainEntity)},\n    endEntity: ${fu(o.endEntity)},\n    entityExtension: ${fu(o.entityExtension)}\n  }`):void 0},\n    isMainWindow: ${i},\n    layoutMode: ${a}\n  }`;var o}function ku(e,t,{entity:n,stateTransition:i,logger:a,window:o,correlation:r,commandReportingService:s,entityOptions:l}){var c,d;if(!o.blockingEntityExtension)throw(0,Z.Tr)(S.w5.Commanding,S.jK.Undefined,"executeEntityCommand",o.correlation,"Unable to resolve blockingEntityExtension");const u={activeEntities:t,windowHistory:[...o.windowHistory],currentWindowHistoryIndex:o.windowHistory.length-1};a.log("Blocking command transition due to blockingEntityExtension");const m=fd();u.activeEntities=Object.assign(Object.assign({},t),{entityExtension:o.blockingEntityExtension.entity});const p=Object.assign(Object.assign({},o.blockingEntityExtension),{blockedEntity:n,blockedEntityOptions:l||null,blockedCommand:{stateTransition:i,visibilityState:e,correlation:r,__typename:"EntityCommand"}});s.appendCommandEventData(r.id,{transitionBlockedByExtension:!0});const g=o.windowHistoryNavigationState,h=Object.assign(Object.assign({},g),{backHistory:[...null!==(c=g.backHistory)&&void 0!==c?c:[]],forwardHistory:[...null!==(d=g.forwardHistory)&&void 0!==d?d:[]]});return Object.assign(Object.assign(Object.assign({},o),u),{correlation:r,extendedEntityContainerState:m,blockingEntityExtension:p,windowHistoryNavigationState:h})}const bu=(e,t,n)=>{const i=e.activeEntities.entityExtension;if(!i)return t.error(`Unable to create hide command for extension in the given window. The window does not have an active extension. Window ID: ${e.id}`),null;const a=yd();a.source=k.D.CoreResolvers;const o={correlation:a,stateTransition:Ie.EntityStateTransition.extend,visibilityState:Ie.EntityVisibilityState.hide};return n.registerCommandStart({entity:i,command:Object.assign(Object.assign({},o),{correlation:Object.assign(Object.assign({},a),{startTimestamp:parseInt(a.startTimestamp,10)})})}),{entity:i,command:o}},_u=(e,t,n)=>{var i;if(pd(e)){const a=bu(e,t,n),o=null===(i=null==a?void 0:a.command.correlation)||void 0===i?void 0:i.id;o&&(t.log(`Closing external dialog, sending hide command with new correlation ${o}`),n.reportCommandEvent(o,ve.M.NotHandled))}},Cu=(e,t)=>{const n=pd(e)?e.activeEntities.entityExtension:null,i=pd(t)?t.activeEntities.entityExtension:null;return!(t.extendedEntityContainerState.containerState===Ie.ExtendedContainerState.Closed||!(function(e,t){const n=pd(e)?e.activeEntities:null,i=pd(t)?t.activeEntities:null;if(!n||!i)return!0;const{subNavEntity:a,headerEntity:o,startEntity:r,mainEntity:s,endEntity:l,entityExtension:c}=n,{subNavEntity:d,headerEntity:u,startEntity:m,mainEntity:p,endEntity:g,entityExtension:h}=i;return!(dd(a,d)&&dd(o,u)&&dd(r,m)&&dd(s,p)&&dd(l,g)&&dd(c,h))}(e,t)&&n||!i))},wu=(e,t,n,i,a,o,r,s,l,c,d)=>{e.extendedEntityContainerState.isExternal?(n.log(`Routing externally - closing external dialog for correlation ${a.id}`),_u(e,n,i)):(n.log(`Routing externally - closing BIM dialog from command with correlation ${a.id}`),((e,t,n,i,a,o,r,s,l,c)=>{pd(t)&&ou(a,n,Tu(t,i),e,o,r,s,l,c)})(n,e,t,a,o,r,s,l,c,d))};function Tu(e,t){const{activeEntities:n}=e;return Object.assign(Object.assign({},e),{correlation:t,extendedEntityContainerState:Object.assign(Object.assign({},e.extendedEntityContainerState),{containerState:Ie.ExtendedContainerState.Closed}),activeEntities:Object.assign(Object.assign({},n),{entityExtension:null})})}function Eu({commandReportingService:e,correlation:t,entitiesMap:n,entity:i,logger:a,window:o}){const{id:r}=t;return a.log(`Hiding main entity and popping history - ${fu(i)} and correlation ${r}`),e.appendCommandEventData(r,{popWindowHistory:!0}),function(e,t,n,i){let a;const{windowHistory:o}=e,r=o.pop();if(r){if(du(t,md(r.activeEntities.mainEntity))||r.activeEntities.endEntity&&du(t,md(r.activeEntities.endEntity)))return a=void 0,Object.assign(Object.assign({},e),{correlation:n,activeEntities:a});a=r.activeEntities,eu(e,i)}else e.id===S.ew&&(a={__typename:"ActiveEntities",subNavEntity:null,startEntity:null,headerEntity:null,mainEntity:{__typename:"Entity",action:Ie.EntityAction.view,entityState:{__typename:"EntityState",flushableByLinkedEntity:!0},id:S.ew,linkedEntity:null,type:Ie.EntityType.blank,options:null,windowOptions:null},endEntity:null,entityExtension:null});return Object.assign(Object.assign({},e),{correlation:n,activeEntities:a})}(o,n,t,a)}function Iu({activeEntities:e,correlation:t,entity:n,logger:i,window:a}){const o=a;return dd(e.startEntity,n)?(i.log(`Hiding start entity - ${fu(n)} and correlation ${t.id}`),Object.assign(Object.assign({},o),{activeEntities:Object.assign(Object.assign({},e),{startEntity:null}),correlation:t})):dd(e.endEntity,n)?(i.log(`Hiding end entity - ${fu(n)} and correlation ${t.id}`),Object.assign(Object.assign({},o),{activeEntities:Object.assign(Object.assign({},e),{endEntity:null}),correlation:t})):void 0}function Nu({appViewEntities:e,correlation:t,enableMultiSlotNone:n,entity:i,executionContext:a,logger:o,window:r}){let s;const l={activeEntities:Du(r),windowHistory:[...r.windowHistory],currentWindowHistoryIndex:r.currentWindowHistoryIndex};if(pd(r)){const{activeEntities:c}=r,d=Iu({activeEntities:c,correlation:t,entity:i,logger:o,window:r});if(d)return function({logger:e,newEntity:t,correlation:n}){e.log(`Toggling entity (hide) - ${fu(t)} and correlation ${n.id}`)}({logger:o,newEntity:i,correlation:t}),d;dd(c.mainEntity,i)||(o.log(`Toggling end entity (show) - ${fu(i)} and correlation ${t.id}`),s=ju({activeEntities:c,appViewEntities:e,correlation:t,enableMultiSlotNone:n,executionContext:a,logger:o,newEntity:i,windowContentState:l}).activeEntities)}else o.warn(`Toggle command only supported when active entities set - ${i}`);return Object.assign(Object.assign({},r),{correlation:t,activeEntities:s})}function Au({activeEntities:e,stateTransition:t,executionContext:n}){const i=e.mainEntity.entityState.flushableByLinkedEntity,a=!e.endEntity||e.endEntity.entityState.flushableByLinkedEntity,o=Pu({executionContext:n,viewEntityName:Ie.SupportedViewEntities.mainEntity});return t===Ie.EntityStateTransition.forceFlow||o&&i&&t===Ie.EntityStateTransition.flow||!o&&a&&t===Ie.EntityStateTransition.flow}function Mu({mainEntity:e,entity:t,stateTransition:n,matchedLinkedEntity:i}){const a=e.entityState.flushableByLinkedEntity;return n===Ie.EntityStateTransition.forceFlush||a&&(n===Ie.EntityStateTransition.flush||n===Ie.EntityStateTransition.new)||i&&t.type!==Ie.EntityType.chats&&t.type!==Ie.EntityType.devicesettings&&t.type!==Ie.EntityType.transcript}function Fu(e,t){const n={__typename:"Entity",action:Ie.EntityAction.view,entityState:{__typename:"EntityState",flushableByLinkedEntity:!0},id:null,linkedEntity:null,type:Ie.EntityType.hybridplaceholder,options:null,windowOptions:null};return t===Ie.CorrelationSourceHint.Activity||t===Ie.CorrelationSourceHint.NonHybridLeftRail?n:Sd(e)}function Ru({currentEntity:e,entityFromAppViewEntities:t,isExecutionContextUpstreamOfEntity:n}){const i=!e||e.entityState.flushableByLinkedEntity;return n&&i&&!!t}function Pu({executionContext:e,viewEntityName:t}){const n=e&&e.viewEntityName?e.viewEntityName:Ie.SupportedViewEntities.subNavEntity,{children:i}=Zd[n];return!(!i||!i.includes(t))}function Du(e){return pd(e)?e.activeEntities:void 0}function ju({activeEntities:e,appViewEntities:t,correlation:n,enableMultiSlotNone:i,executionContext:a,logger:o,newEntity:r,windowContentState:s}){return i&&t?(o.log("Using multi slot none behavior"),function({activeEntities:e,appViewEntities:t,executionContext:n,windowContentState:i}){return Object.assign(Object.assign({},i),{activeEntities:Object.assign(Object.assign({},e),{startEntity:Ru({currentEntity:e.startEntity,entityFromAppViewEntities:t.startEntity,isExecutionContextUpstreamOfEntity:Pu({executionContext:n,viewEntityName:Ie.SupportedViewEntities.startEntity})})?Sd(t.startEntity):e.startEntity,endEntity:Ru({currentEntity:e.endEntity,entityFromAppViewEntities:t.endEntity,isExecutionContextUpstreamOfEntity:Pu({executionContext:n,viewEntityName:Ie.SupportedViewEntities.endEntity})})?Sd(t.endEntity):e.endEntity})})}({activeEntities:e,appViewEntities:t,executionContext:a,windowContentState:s})):(o.log("Falling back to default none behavior"),function(e,t,n,i,a){return i.log(`Adding as end entity - ${fu(n)} and correlation ${a}`),Object.assign(Object.assign({},e),{activeEntities:Object.assign(Object.assign({},t),{endEntity:n})})}(s,e,r,o,n.id))}function xu(e){var t,n,{appViewEntities:i,correlation:a,enableMultiSlotNone:o,entity:r,executionContext:s,isInputDefaultEntity:c,logger:d,matchedLinkedEntity:u,sourceHint:m,stateTransition:p,window:g,host:h,writeNavigationToHostHistory:v,appsRegistryService:f}=e,y=(0,l.__rest)(e,["appViewEntities","correlation","enableMultiSlotNone","entity","executionContext","isInputDefaultEntity","logger","matchedLinkedEntity","sourceHint","stateTransition","window","host","writeNavigationToHostHistory","appsRegistryService"]);const S=Du(g);let k=g.extendedEntityContainerState,b={activeEntities:S,windowHistory:[...g.windowHistory],currentWindowHistoryIndex:g.currentWindowHistoryIndex};if(g.blockingEntityExtension&&S&&p!==Ie.EntityStateTransition.extend)return ku(Ie.EntityVisibilityState.show,S,Object.assign({appViewEntities:i,correlation:a,enableMultiSlotNone:o,executionContext:s,entity:r,isInputDefaultEntity:c,logger:d,matchedLinkedEntity:u,sourceHint:m,stateTransition:p,window:g,host:h,writeNavigationToHostHistory:v,appsRegistryService:f},y));!S||Mu({mainEntity:S.mainEntity,entity:r,stateTransition:p,matchedLinkedEntity:u})?b=function({appsRegistryService:e,host:t,windowContentState:n,newEntity:i,logger:a,correlation:o,appViewEntities:r,isInputDefaultEntity:s,sourceHint:l,writeNavigationToHostHistory:c}){var d;const{subNavEntity:u=null,headerEntity:m=null,startEntity:p=null,mainEntity:g=null,endEntity:h=null}=Object.assign({},r),{activeEntities:v}=n,{action:f,type:y}=i;if(f===Ie.EntityAction.default&&v&&y===Yd(v).type||n.activeEntities&&s)return n;const S={__typename:"ActiveEntities",subNavEntity:Fu(u,l),headerEntity:Sd(m),startEntity:Sd(p),mainEntity:null!==(d=Sd(g))&&void 0!==d?d:i,endEntity:Sd(h),entityExtension:null},k=iu(t,a,n,S,e,c);return a.log(`Flushing window - ${fu(i)} and correlation ${o.id}`),{activeEntities:S,windowHistory:k,currentWindowHistoryIndex:k.length-1}}({appViewEntities:i,appsRegistryService:f,correlation:a,host:h,isInputDefaultEntity:c,logger:d,newEntity:r,sourceHint:m,windowContentState:b,writeNavigationToHostHistory:v}):Au({activeEntities:S,stateTransition:p,executionContext:s})?b=function({activeEntities:e,appViewEntities:t,executionContext:n,logger:i,windowContentState:a,host:o,appsRegistryService:r,writeNavigationToHostHistory:s}){var l;const c=Pu({executionContext:n,viewEntityName:Ie.SupportedViewEntities.headerEntity}),d=c||Pu({executionContext:n,viewEntityName:Ie.SupportedViewEntities.startEntity}),u=d||Pu({executionContext:n,viewEntityName:Ie.SupportedViewEntities.mainEntity}),m=u||Pu({executionContext:n,viewEntityName:Ie.SupportedViewEntities.endEntity});i.log(`Issuing flow command on window - headerEntity ${c}, startEntity ${d}, \n        mainEntity ${u}, endEntity ${m}`);const p=Object.assign(Object.assign({},e),{headerEntity:c?Sd(null==t?void 0:t.headerEntity):e.headerEntity,startEntity:d?Sd(null==t?void 0:t.startEntity):e.startEntity,mainEntity:u&&null!==(l=Sd(null==t?void 0:t.mainEntity))&&void 0!==l?l:e.mainEntity,endEntity:m?Sd(null==t?void 0:t.endEntity):e.endEntity}),g=iu(o,i,a,p,r,s);return{activeEntities:p,windowHistory:g,currentWindowHistoryIndex:g.length-1}}({executionContext:s,windowContentState:b,activeEntities:S,appViewEntities:i,logger:d,host:h,appsRegistryService:f,writeNavigationToHostHistory:v}):!function(e,t,n){return!!e&&(dd(e.mainEntity,t)||dd(e.endEntity,t))&&n!==Ie.EntityStateTransition.extend}(S,r,p)?p===Ie.EntityStateTransition.extend?(k=fd(),b.activeEntities=Object.assign(Object.assign({},S),{entityExtension:r})):b=ju({activeEntities:S,appViewEntities:i,correlation:a,enableMultiSlotNone:o,newEntity:r,executionContext:s,logger:d,windowContentState:b}):(!function(e,t,n,i){e!==Ie.EntityStateTransition.new&&t.log(`Entity already exists in the active entities no state transition made - ${fu(n)} and correlation ${i}`)}(p,d,r,a.id),b=function(e,t,n,i,a,o){const{activeEntities:r}=n;if(!r)return n;const{mainEntity:s,endEntity:c}=r,d=Object.assign({},r),{entityState:u}=i,m=(0,l.__rest)(i,["entityState"]);dd(s,i)?d.mainEntity=Object.assign(Object.assign({},s),m):c&&dd(c,i)&&(d.endEntity=Object.assign(Object.assign({},c),m));const p=iu(e,t,n,r,a,o);return{activeEntities:d,windowHistory:p,currentWindowHistoryIndex:p.length-1}}(h,d,b,r,f,v));const _=g.windowHistoryNavigationState,C=Object.assign(Object.assign({},_),{backHistory:[...null!==(t=_.backHistory)&&void 0!==t?t:[]],forwardHistory:[...null!==(n=_.forwardHistory)&&void 0!==n?n:[]]});return Object.assign(Object.assign(Object.assign({},g),b),{correlation:a,extendedEntityContainerState:k,windowHistoryNavigationState:C})}function Ou(e,t){switch(e){case Ie.EntityVisibilityState.hide:return function(e){var{commandReportingService:t,correlation:n,enableMultiSlotHide:i,entitiesMap:a,entity:o,logger:r,stateTransition:s,window:c}=e,d=(0,l.__rest)(e,["commandReportingService","correlation","enableMultiSlotHide","entitiesMap","entity","logger","stateTransition","window"]);if(pd(c)){const{activeEntities:e}=c;if(c.blockingEntityExtension&&s!==Ie.EntityStateTransition.extend)return ku(Ie.EntityVisibilityState.hide,e,Object.assign({commandReportingService:t,correlation:n,enableMultiSlotHide:i,entitiesMap:a,entity:o,logger:r,stateTransition:s,window:c},d));if((!i||s===Ie.EntityStateTransition.flush)&&dd(e.mainEntity,o))return Eu(Object.assign({commandReportingService:t,correlation:n,enableMultiSlotHide:i,entitiesMap:a,entity:o,logger:r,stateTransition:s,window:c},d));if(!i||s===Ie.EntityStateTransition.none){const t=Iu({entity:o,logger:r,window:c,correlation:n,activeEntities:e});if(t)return t}if(dd(e.entityExtension,o))return r.log(`Closing extended entity container with correlation ${n.id}`),Tu(c,n);r.warn(`Hide command issued for an entity but that entity is not present - ${fu(o)}`)}else r.warn(`Hide command issued for an entity but are no active entities - ${fu(o)}`);return c}(t);case Ie.EntityVisibilityState.toggle:return Nu(t);case Ie.EntityVisibilityState.show:case Ie.EntityVisibilityState.showWithoutFocusing:return xu(t)}}function Lu(e,t){if(void 0!==t){const n=t?bd(t):null;e.linkedEntity=n}}function Uu(e,t,n,i,a){const{visibilityState:o,stateTransition:r,layoutMode:s}=e;if(o!==Ie.EntityVisibilityState.hide&&o!==Ie.EntityVisibilityState.showWithoutFocusing){if(i&&r===Ie.EntityStateTransition.new)return(0,Be.v4)();if(a&&n===S.ew){if(!lu(t,null!=s?s:be.lO.standard))return(0,Be.v4)()}else if(function(e,t){return t===S.ew&&!uu(e,S.ew)}(t,n))return S.ew}}function Bu({activeWindows:e,command:t,correlation:n,entitiesMap:i,entity:a,isNewContextSupportEnabled:o,layoutMode:r,linkedEntitiesMap:s,logger:l,windowId:c,webNrcEnabled:d}){const u=cu(e,c)&&t.stateTransition===Ie.EntityStateTransition.forceFlush,m=t.stateTransition===Ie.EntityStateTransition.flow,[p,g]=!o||u||m?[void 0,!1]:mu(a,i,s);p&&l.log(`Entity matched to ${Su(p)}, matched via linked entity ${g} for correlation ${n.id}`);const h=p||function({command:e,activeWindows:t,windowId:n,correlation:i,logger:a,isNewContextSupportEnabled:o,layoutMode:r,webNrcEnabled:s}){const l=Uu(e,t,n,o,s);return void 0!==l?(a.log(`Creating new window with id ${l} for correlation ${i.id}`),function(e,t,n,i,a,o){return{__typename:"Window",id:t,windowHistory:[],currentWindowHistoryIndex:0,windowHistoryNavigationState:{__typename:"WindowHistoryNavigationState",canNavigateBack:!1,canNavigateForward:!1,backHistory:[],forwardHistory:[]},correlation:Object.assign(Object.assign({},e),{__typename:"Correlation"}),extendedEntityContainerState:fd(),blockingEntityExtension:null,layoutMode:null!=n?n:t===S.ew||o&&a!==Ie.EntityStateTransition.new?Ie.LayoutModes.standard:Ie.LayoutModes.focus,isMainWindow:a!==Ie.EntityStateTransition.new&&i===S.ew}}(i,l,r,n,e.stateTransition,s)):(e=>e===S.ew)(n)?(a.log(`Retrieving mainWindow with layoutMode ${r} for correlation ${i.id}`),lu(t,null!=r?r:be.lO.standard)):(a.log(`Retrieving window with id ${n} for correlation ${i.id}`),uu(t,n))}({activeWindows:e,command:t,correlation:n,isNewContextSupportEnabled:o,layoutMode:r,logger:l,windowId:c,webNrcEnabled:d});if(!h)throw function(e){return(0,Z.Tr)(S.w5.Commanding,S.jK.UndefinedWindowError,"CommandResolvers",e,"Unable to find applicable target window")}(n);return[h,g]}function Wu(e,t,n){const i=kd(e),[a,o]=ud(t,md,(e=>e.id!==S.ew)),[r]=mu(i,a,o);return r&&n.log(`Found window ${Su(r)} for entity ${fu(i)}`),r||null}function Hu(e,t,n,i,a,o,r,s,l){const c=e.activeEntities;return!!(null==c?void 0:c.entityExtension)&&(c.entityExtension=null,e.extendedEntityContainerState.containerState=Ie.ExtendedContainerState.Error,ou(t,n,e,i,a,o,r,s,l))}const $u=(e,t,n,i,a,o)=>{const{appsRegistryService:r,cache:s,windowId:c,commandReportingService:d,localStorage:u,coreSettings:m}=n,p=(0,l.__rest)(n,["appsRegistryService","cache","windowId","commandReportingService","localStorage","coreSettings"]),{enableAppBarQueryUpdate:g,enableWriteActiveEntitiesToLocalStorage:h,enableWriteAppHistoryToLocalStorage:v}=m.get(b.J.Core),f=Object.assign(Object.assign({},e),{extendedEntityContainerState:Object.assign(Object.assign({},e.extendedEntityContainerState),t)}),y=e.blockingEntityExtension;f.blockingEntityExtension=null;const S=ou(s,a,f,i,u,r,h,g,v),_=((e,t,n)=>{const i=null==e?void 0:e.blockedEntity,a=null==e?void 0:e.blockedCommand,o=null==e?void 0:e.blockedEntityOptions;if(!i||!a)return t.warn("Unable to re-create the command which was blocked and saved."),null;const r=yd();r.source=k.D.CoreResolvers;const s={entity:i,command:Object.assign(Object.assign({},a),{correlation:r}),entityOptions:o};return n.registerCommandStart(Object.assign(Object.assign({},s),{entityOptions:o?JSON.parse(o):void 0})),s})(y,i,d);if(_){const{entity:e,command:t,entityOptions:n}=_;return!!Vu({entity:e,command:t,entityOptions:n,windowId:c,clientLaunchId:f.correlation.clientLaunchId},Object.assign({appsRegistryService:r,cache:s,windowId:c,commandReportingService:d,localStorage:u,coreSettings:m},p),o)}return S},Vu=({command:e,entity:t,entityOptions:n,executionContext:i,windowId:a,windowOptions:o,clientLaunchId:r},{appsRegistryService:s,cache:l,commandReportingService:c,coreSettings:d,experienceChangeReportingService:u,localStorage:m,loggerFactory:p,windowProvider:g,scenarioFactory:h},v)=>{const f=a||S.ew,y=p.newLogger("executeEntityCommand-mutation"),k=au(l,y),[_,C]=ud(k,md,(e=>!cu(k,e.id))),{visibilityState:w,stateTransition:T,correlation:E,layoutMode:I}=e,N=((e,t)=>t?Object.assign(Object.assign({},t),{clientLaunchId:null!=e?e:null,__typename:"Correlation"}):Object.assign(Object.assign({},yd()),{clientLaunchId:null!=e?e:null,__typename:"Correlation"}))(null!=r?r:void 0,E),M=(e=>e.action===Ie.EntityAction.default&&e.type===Ie.EntityType.default)(t),F=null==E?void 0:E.sourceHint,R=(({entity:e,isInputDefaultEntity:t,logger:n,appsRegistryService:i})=>{if(t){const e=i.getDefaultCommand();return e?(n.log("Default command found"),e):(n.error("No default command defined"),null)}return e})({entity:t,isInputDefaultEntity:M,logger:y,appsRegistryService:s});if(!R)return y.error("Unable to use entity from command input"),null;const P=kd(R,n,o);if(function(e){return e.type===Ie.EntityType.toasts}(P))return y.log("Send all toast commands to Maglev host for execution"),c.reportCommandEvent(N.id,ve.M.NotHandled),null;y.log(`Command received for entity ${fu(P)}`),y.log(`Command received :${function(e){return`{\n    visibilityState: ${e.visibilityState},\n    stateTransition: ${e.stateTransition},\n    correlation: ${yu(e.correlation)}\n  }`}(e)}`),y.log(`Command with id ${N.id} received on window context ${f}`),y.log(`Command received with execution context: ${null==i?void 0:i.viewEntityName}`);const{isNewContextSupportEnabled:D,webNrcEnabled:j}=d.get(b.J.Host),{enableHostHistoryNavigation:x,enableMultiSlotHide:O,enableMultiSlotNone:L,enableWriteActiveEntitiesToLocalStorage:U,enableAppBarQueryUpdate:B,enableWriteAppHistoryToLocalStorage:W}=d.get(b.J.Core);y.log(`isNewContextSupportEnabled ${D}, enableMultiSlotHide ${O}, enableMultiSlotNone ${L}`);const H=($=g.Cypress)&&($.layoutMode||be.lO.focus);var $;const[V,z]=Bu({activeWindows:k,command:e,correlation:N,entitiesMap:_,entity:P,isNewContextSupportEnabled:null==D||D,layoutMode:null!=H?H:I,linkedEntitiesMap:C,logger:y,windowId:f,webNrcEnabled:null!=j&&j});let G=null;M&&V.isMainWindow&&U?G=((e,t)=>{const n=e.get(cd);if(n)try{return JSON.parse(n)}catch(e){t.error(`Could not restore active entities from local storage. Stored string was in an invalid JSON format. String: ${n}.`)}return null})(m,y):t.action===Ie.EntityAction.default&&V.isMainWindow&&(G=((e,t,n,i)=>{var a;const o=null===(a=i.getApp({entityType:n}))||void 0===a?void 0:a.manifest.id,r=e.get(`appActiveEntitiesHistory-${o}`);if(r)try{return JSON.parse(r)}catch(e){t.error(`Could not restore active entities from local storage. Stored string was in an invalid JSON format. String: ${r}.`)}return null})(m,y,t.type,s));const q=pd(V)?V.activeEntities:void 0;if(!G){const e=(({currentEntities:e,newEntity:t,matchedLinkedEntity:n,stateTransition:i,executionContext:a})=>!e||Mu({entity:t,mainEntity:e.mainEntity,matchedLinkedEntity:n,stateTransition:i})||Au({activeEntities:e,stateTransition:i,executionContext:a}))({currentEntities:q,newEntity:P,matchedLinkedEntity:z,stateTransition:T,executionContext:i});y.log(`Should use entity from command input for getAppViewEntities ${e} `);const{appEntity:t,contextEntity:n}=(({entity:e,currentEntities:t,shouldUseNewEntity:n})=>{var i;return n?{appEntity:null!==(i=e.linkedEntity)&&void 0!==i?i:e,contextEntity:e.linkedEntity?e:null}:t?{appEntity:Yd(t),contextEntity:e}:{appEntity:e,contextEntity:null}})({currentEntities:pd(V)?V.activeEntities:void 0,entity:P,shouldUseNewEntity:e});G=Xd({appsRegistryService:s,contextEntity:n,coreSettings:d,entity:t,layoutMode:V.layoutMode}),(({appViewEntities:e,stateTransition:t,appEntity:n,linkedEntity:i})=>t!==Ie.EntityStateTransition.none&&null===e&&n===i)({appEntity:t,appViewEntities:G,linkedEntity:P.linkedEntity,stateTransition:T})&&(y.log(`Initial getAppViewEntities for ${t} returned null`),G=Xd({entity:P,contextEntity:null,coreSettings:d,layoutMode:V.layoutMode,appsRegistryService:s}))}if(y.log(`Final appViewEntities: ${function(e){return void 0===e?"undefined - app not ported to multi slot":null===e?"null - no app supports this entity":`{\n      subNavEntity: ${fu(e.subNavEntity)},\n      headerEntity: ${fu(e.headerEntity)},\n      startEntity: ${fu(e.startEntity)},\n      mainEntity: ${fu(e.mainEntity)},\n      endEntity: ${fu(e.endEntity)}\n  }`}(G)}`),y.log(`Before updating cache, There are ${k.length} active windows`),y.log(`Source window: ${Su(V)}`),V.correlation.id!==N.id&&(q&&c.appendScenarioEventData(N.id,{fromMainEntityType:q.mainEntity.type,fromMainEntityAction:q.mainEntity.action}),c.reportCommandEvent(V.correlation.id,ve.M.Abandoned),u.report({correlationId:N.id,type:fe.yU.ActiveEntitiesDestroyed,context:{target:"entity-command-resolver"},windowId:V.id})),null===G)throw new Error("no app view entities for entity input");let J=Ou(w,{appViewEntities:G,commandReportingService:c,correlation:N,enableMultiSlotHide:O,enableMultiSlotNone:L,entitiesMap:_,entity:P,entityOptions:n,executionContext:i,isInputDefaultEntity:M,logger:y,matchedLinkedEntity:z,sourceHint:F,stateTransition:T,window:V,host:g,writeNavigationToHostHistory:null!=x&&x,appsRegistryService:s});y.log(`Target window: ${Su(J)}`);const K=function(e,t){return gd(pd(e)?e.activeEntities:null,pd(t)?t.activeEntities:null)}(V,J);!function(e,t,n,i,a,o,r){const s=(0,Bn.YR)(e,n);r.log(`ViewportContext: ${s}`);const l={"Panel.WindowID":t,"Window.ViewportContext":s};a.appendScenarioEventData(i,l);const c=null==o?void 0:o.findScenario(A.RG.ClientStart);null==c||c.appendEventData(l);const d=o.findScenario(A.RG.WindowLaunchTime);null==d||d.appendEventData(l)}(J.isMainWindow,J.id,J.layoutMode,N.id,c,h,y),c.appendCommandEventData(N.id,{isCommandTargetedToMainWindow:J.id===S.ew,shouldNavigate:hd(V,J)});if(_d(K,f,V.id===S.ew&&T!==Ie.EntityStateTransition.new&&T!==Ie.EntityStateTransition.none,T===Ie.EntityStateTransition.flow||T===Ie.EntityStateTransition.none,d,y)){y.log(`Opener will handle the requested entity change with correlationId ${N.id} and entityId ${t.id}`);let e=!0;K.entityExtension&&(J.extendedEntityContainerState.isExternal=!0,e=ou(l,k,J,y,m,s,U,B,W));const n=uu(k,S.ew);n&&(e=>!(!e.activeEntities.entityExtension||e.extendedEntityContainerState.containerState===Ie.ExtendedContainerState.Closed))(n)&&wu(n,k,y,c,N,l,m,s,U,B,W);let i=!1;if(e)try{if(i=function(e,t,n,i){let a=!1,o=null;const r=ve.M.NotHandled;return o=wd(t,Id)||wd(t,Nd)||wd(t,Ad)||wd(t,Md)||wd(t,Fd)||wd(t,Hd)||wd(t,Pd)||wd(t,Od)||wd(t,Dd)||wd(t,$d)||Cd(t,i)||wd(t,Ld)||wd(t,Ud)||wd(t,Bd)||wd(t,Ed)||wd(t,Rd)||wd(t,Wd)||wd(t,zd)||wd(t,Vd),o&&(n.reportCommandEvent(e.id,r),a=!0),a}(N,K,c,f),i)return null;throw Hu(J,l,k,y,m,s,U,B,W),(0,Z.Tr)(S.w5.Commanding,S.jK.UnhandledRuntimeException,"executeEntityCommand",void 0,"Unable to update cache, opener did not handle the entity change")}catch(e){throw Hu(J,l,k,y,m,s,U,B,W),(0,Z.Tr)(S.w5.Commanding,S.jK.UnhandledRuntimeException,"executeEntityCommand",e,"Unable to update cache, opener threw an exception and did not handle the entity change")}}Cu(V,J)&&(J=((e,t,n,i,a)=>{if(e.extendedEntityContainerState.isExternal)n.log(`Internal routing - closing external dialog for correlation ${a.id}`),_u(t,n,i);else if(n.log(`Internal routing - closing internal dialog for correlation ${a.id}`),pd(e))return Tu(e,a);return e})(J,V,y,c,N)),y.log(`Handling the requested entity command internally for correlation ${N.id}`),pu({pubsub:v,fromWindowId:f,sourceWindowId:V.id,diff:K,targetWindow:J,targetVisibilityState:w,stateTransition:T,correlation:N,logger:y}),eu(J,y);const Q=ou(l,k,J,y,m,s,U,B,W);if(Q){const e=function(e){const t=[];return Object.keys(e).map((n=>{const i=e[n];i&&t.push(i)})),t}(K);e.length>0&&u.report({correlationId:N.id,type:fe.yU.ActiveEntitiesResolved,context:{target:"entity-command-resolver",entities:e},windowId:J.id}),c.reportCommandEvent(N.id,ve.M.WindowUpdated)}else c.reportCommandEvent(N.id,ve.M.Failure,{errorInfo:ve.y.WindowCacheFailedToUpdate});return Q&&pd(J)?J:null},zu=(e,t,n,i)=>{var{cache:a,windowId:o,commandReportingService:r}=n,s=(0,l.__rest)(n,["cache","windowId","commandReportingService"]);if(!e.activeEntities.entityExtension)return!1;const c=bu(e,t,r);if(c){const{entity:t,command:n}=c;return Vu({entity:t,command:n,windowId:o,clientLaunchId:e.correlation.clientLaunchId},Object.assign({cache:a,windowId:o,commandReportingService:r},s),i)}return!1},Gu=e=>({Query:{activeWindow(e,{windowId:t},{cache:n,loggerFactory:i}){const a=i.newLogger("activeWindow"),o=t||S.ew,r=au(n,a).find((e=>e.id===o));if(!r)throw new Error(`Requesting activeWindow for unknown windowId ${o}`);return r},activeWindowForEntity(e,{entity:t},{cache:n,loggerFactory:i}){const a=i.newLogger("activeWindowForEntity-query");return Wu(t,au(n,a),a)}},Mutation:{navigateToWindowHistoryIndex:(e,t,n)=>(({windowId:e,windowHistoryIndex:t},{appsRegistryService:n,cache:i,coreSettings:a,localStorage:o,loggerFactory:r,windowProvider:s})=>{var l;const c=r.newLogger("navigateToWindowHistoryIndex-mutation");c.debug(`Navigating to windowHistoryIndex ${t} on window ${e}.`);const{enableAppBarQueryUpdate:d,enableWriteAppHistoryToLocalStorage:u}=a.get(b.J.Core),m=au(i,c),p=uu(m,e);if(!p)throw new Error("Could not find window.");return!(0===(null===(l=p.windowHistory)||void 0===l?void 0:l.length)||t<0||t>p.windowHistory.length-1)&&(hu(s,p,c,p.currentWindowHistoryIndex,n,!1),vu(p,t,c,i,m,o,n,!1,d,u))})(t,n),performWindowHistoryNavigation:(e,t,n)=>(({windowId:e,navigationDirection:t},{appsRegistryService:n,cache:i,coreSettings:a,localStorage:o,loggerFactory:r,windowProvider:s})=>{var l;const c=r.newLogger("performWindowHistoryNavigation-mutation");c.debug(`Navigating ${e} with direction ${t}.`);const d=au(i,c),u=uu(d,e);if(!u)throw new Error("Could not find window.");if(0===(null===(l=u.windowHistory)||void 0===l?void 0:l.length))return!1;let m=u.currentWindowHistoryIndex;const p=e=>c.warn(`Could not navigate ${t}. Index ${e} is out of the bounds of the window history.`);if(t===Ie.NavigationDirection.back){if(m=hu(s,u,c,m,n,!1),m--,m<0)return p(m),!1}else if(++m,m>u.windowHistory.length-1)return p(m),!1;const{enableAppBarQueryUpdate:g,enableWriteActiveEntitiesToLocalStorage:h,enableWriteAppHistoryToLocalStorage:v}=a.get(b.J.Core);return vu(u,m,c,i,d,o,n,h,g,v)})(t,n),updateEntity(e,{entity:t,entityOptions:n,viewEntityName:i,windowId:a},{appsRegistryService:o,cache:r,coreSettings:s,localStorage:l,loggerFactory:c}){const d=a||S.ew,u=c.newLogger("updateEntity-mutation"),m=au(r,u),p=uu(m,d),{enableWriteActiveEntitiesToLocalStorage:g,enableAppBarQueryUpdate:h,enableWriteAppHistoryToLocalStorage:v}=s.get(b.J.Core);if(!p)return u.warn("Trying to update entity in window that does not exist"),!1;return function({entity:e,window:t,viewEntityName:n}){t.activeEntities[n]=Object.assign(Object.assign({},t.activeEntities[n]),e)}({window:p,entity:kd(t,n),viewEntityName:i}),ou(r,m,p,u,l,o,g,h,v)},updateEntityState(e,{entity:t,entityState:n},{appsRegistryService:i,cache:a,coreSettings:o,loggerFactory:r,localStorage:s}){const{enableWriteActiveEntitiesToLocalStorage:l,enableAppBarQueryUpdate:c}=o.get(b.J.Core),d=r.newLogger("updateEntityState-mutation"),u=au(a,d),m=Wu(t,u,d);if(!m)return d.warn("Trying to update flushable entity that does not exist"),!1;return function(e,t,n,i){const{mainEntity:a,endEntity:o}=e.activeEntities,{flushableByLinkedEntity:r,linkedEntityUpdate:s}=n;dd(a,t)?(null!=r&&(a.entityState.flushableByLinkedEntity=r),Lu(a,s)):o&&dd(o,t)?(i.log("Updating entity state for end entity"),Lu(o,s)):i.warn(`Updating entity state for entity the does not exist ${t}`)}(m,kd(t),n,d),ou(a,u,m,d,s,i,l,c,l),!0},updateExtendedEntityContainerState(t,n,i){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{appsRegistryService:t,cache:a,coreSettings:o,localStorage:r,loggerFactory:s,windowId:l,windowProvider:c}=i,{enableWriteActiveEntitiesToLocalStorage:d,enableAppBarQueryUpdate:u,enableWriteAppHistoryToLocalStorage:m}=o.get(b.J.Core),p=s.newLogger("updateExtendedEntityContainerState-mutation"),g=au(a,p),h=uu(g,l);if(h)if(((e,t)=>{var n,i;return e===Ie.ExtendedContainerState.Confirmed&&(null===(n=t.blockingEntityExtension)||void 0===n?void 0:n.entity)&&dd(t.activeEntities.entityExtension,null===(i=t.blockingEntityExtension)||void 0===i?void 0:i.entity)})(n.containerState,h))h.id===S.ew&&c.opener.postMessage(_.W.MainWindowBlockedState,{isBlocked:"Confirmed",entity:null}),$u(h,n,i,p,g,e);else{if(n.containerState!==Ie.ExtendedContainerState.Closed)return h.extendedEntityContainerState=Object.assign(Object.assign({},h.extendedEntityContainerState),n),ou(a,g,h,p,r,t,d,u,m);zu(h,p,i,e)}return!1}))},executeEntityCommand:(t,n,i)=>Vu(n,i,e),addBlockingExtension:(t,{entity:n,entityOptions:i,windowId:a,removeBlock:o},r)=>{var{cache:s,loggerFactory:c,windowProvider:d}=r,u=(0,l.__rest)(r,["cache","loggerFactory","windowProvider"]);const m=c.newLogger("addBlockingExtension-mutation");m.log(`${o?"Removing":"Adding"} an entity extension blocker of type ${n.type}`);const p=au(s,m),g=uu(p,a);if(g){const t=Object.assign(Object.assign({},n),{id:n.id||null,linkedEntity:null,options:i||null,windowOptions:null,__typename:"Entity",entityState:{flushableByLinkedEntity:!1,__typename:"EntityState"}});if(o&&g.blockingEntityExtension)return((e,t,n,i,a,o)=>{var{appsRegistryService:r,cache:s,coreSettings:c,windowProvider:d,localStorage:u}=o,m=(0,l.__rest)(o,["appsRegistryService","cache","coreSettings","windowProvider","localStorage"]);const{enableWriteActiveEntitiesToLocalStorage:p,enableAppBarQueryUpdate:g,enableWriteAppHistoryToLocalStorage:h}=c.get(b.J.Core);if(!t.blockingEntityExtension||!dd(t.blockingEntityExtension.entity,e))return!1;const v=Object.assign(Object.assign({},t),{blockingEntityExtension:null}),f=ou(s,n,v,i,u,r,p,g,h);return v.id===S.ew&&d.opener.postMessage(_.W.MainWindowBlockedState,{isBlocked:"Unblocked",entity:null}),zu(t,i,Object.assign({appsRegistryService:r,cache:s,windowProvider:d,localStorage:u,coreSettings:c},m),a),f})(t,g,p,m,e,Object.assign({cache:s,loggerFactory:c,windowProvider:d},u));if(!o)return((e,t,n,i,{appsRegistryService:a,cache:o,coreSettings:r,localStorage:s,windowProvider:l})=>{const{enableWriteActiveEntitiesToLocalStorage:c,enableAppBarQueryUpdate:d,enableWriteAppHistoryToLocalStorage:u}=r.get(b.J.Core),m={entity:e,__typename:"BlockingEntityExtension",blockedEntity:null,blockedCommand:null,blockedEntityOptions:null},p=Object.assign(Object.assign({},t),{blockingEntityExtension:m});return p.id===S.ew&&l.opener.postMessage(_.W.MainWindowBlockedState,{isBlocked:"Blocked",entity:m.entity}),ou(o,n,p,i,s,a,c,d,u)})(t,g,p,m,Object.assign({cache:s,windowProvider:d,loggerFactory:c},u))}return!1}}});var qu,Ju=n(566464),Ku=n(514002);!function(e){e.AppBasedLinkService="AppBasedLinkService",e.AppsPlatformService="AppsPlatformService",e.AsyncMediaService="AsyncMediaService",e.AtpSafelinksService="AtpSafelinksService",e.AzureMapsService="AzureMapsService",e.BadgeCountService="BadgeCountService",e.BiometricEnrollmentService="BiometricEnrollmentService",e.BotsPlatformService="BotsPlatformService",e.BrbService="BrbService",e.BreakoutRoomsService="BreakoutRoomsService",e.BroadcastAttendeeService="BroadcastAttendeeService",e.BroadcastCaptionsService="BroadcastCaptionsService",e.BroadcastSignalRService="BroadcastSignalRService",e.CalendarService="CalendarService",e.CallBlockingService="CallBlockingService",e.CallingAdapterServices="CallingAdapterServices",e.CallingAppEventsService="CallingAppEventsService",e.CallingDialogServiceAdapter="CallingDialogServiceAdapter",e.CallingNotificationServiceAdapter="CallingNotificationServiceAdapter",e.CallingService="CallingService",e.CallRecordingService="CallRecordingService",e.ChatService="ChatService",e.ChatServiceEndpointProvider="ChatServiceEndpointProvider",e.CollabObjectService="CollabObjectService",e.ConnectedAccountsService="ConnectedAccountsService",e.ConnectedCalendarSettingsService="ConnectedCalendarSettingsService",e.ConsumerGroupsService="ConsumerGroupsService",e.CSAService="CSAService",e.DeveloperSwitchersService="DeveloperSwitchersService",e.DistributionListService="DistributionListService",e.DynamicsMarketingService="DynamicsMarketingService",e.EmoticonService="EmoticonService",e.EspService="EspService",e.ExternalAccountsService="ExternalAccountsService",e.FilesBackfillThreadPropertiesService="FilesBackfillThreadPropertiesService",e.FilesRedeemService="FilesRedeemService",e.FilesReferenceService="FilesReferenceService",e.FilesSharepointUrlService="FilesSharepointUrlService",e.FileUploadPreviewService="FileUploadPreviewService",e.FileUploadService="FileUploadService",e.FileDownloadManagerService="FileDownloadManagerService",e.FluidService="FluidService",e.GalleryService="GalleryService",e.GiphyService="GiphyService",e.GoogleCalendarAuthenticationService="GoogleCalendarAuthenticationService",e.GoogleContactsAuthenticationService="GoogleContactsAuthenticationService",e.GuardiansService="GuardiansService",e.ImageProxyService="ImageProxyService",e.ImportMsaContactsService="ImportMsaContactsService",e.InstantAnswersService="InstantAnswersService",e.ItemDeleteService="ItemDeleteService",e.ItemDetailsService="ItemDetailsService",e.DriveItemShareService="DriveItemShareService",e.ItemUploadService="ItemUploadService",e.InviteLinksService="InviteLinksService",e.LiveStateBroadcastService="LiveStateBroadcastService",e.LiveStreamRenderingService="LiveStreamRenderingService",e.LmsIntegrationService="LmsIntegrationService",e.LogsFilesService="LogsFilesService",e.LokiMetaPreviewService="LokiMetaPreviewService",e.LokiService="LokiService",e.ManageTenantService="ManageTenantService",e.MeetingArtifactsService="MeetingArtifactsService",e.MeetingOptionsClientDataService="MeetingOptionsClientDataService",e.MeetingOptionsService="MeetingOptionsService",e.MeetingTemplateService="MeetingTemplateService",e.MsaAuthenticationService="MsaAuthenticationService",e.OdcFilePreviewService="OdcFilePreviewService",e.OSearchService="OSearchService",e.PeopleSearchService="PeopleSearchService",e.PeopleService="PeopleService",e.PeopleTargetingService="PeopleTargetingService",e.PersonalFileDetailsService="PersonalFileDetailsService",e.PetrolService="PetrolService",e.FloodgateService="FloodgateService",e.PoliciesService="PoliciesService",e.PresenceService="PresenceService",e.PstnService="PstnService",e.RefreshSiteUrlService="RefreshSiteUrlService",e.ReportConcernService="ReportConcernService",e.SCISService="SCISService",e.SearchPrefetchService="SearchPrefetchService",e.SearchSubstrateService="SearchSubstrateService",e.SharepointRestClient="SharepointRestClient",e.SharepointShareService="SharepointShareService",e.ShareService="ShareService",e.StatefulLongPoll="StatefulLongPoll",e.StoreService="StoreService",e.SubstrateFilesSearchService="SubstrateFilesSearchService",e.SubstrateMeetingRecommendationsService="SubstrateMeetingRecommendationsService",e.SubstrateSearchService="SubstrateSearchService",e.SubstrateSuggestionsService="SubstrateSuggestionsService",e.TargetingHierarchyService="TargetingHierarchyService",e.TeamCalendarService="TeamCalendarService",e.TeamsAndChannelsService="TeamsAndChannelsService",e.TenantMembershipService="TenantMembershipService",e.ThirdPartyCalendarService="ThirdPartyCalendarService",e.ToastImageService="ToastImageService",e.TpnNoticeService="TpnNoticeService",e.TranslateService="TranslateService",e.UrlPreviewService="UrlPreviewService",e.UserLicenseService="UserLicenseService",e.UserProfileService="UserProfileService",e.VideoFileService="VideoFileService",e.VoicemailService="VoicemailService",e.WebinarService="WebinarService"}(qu||(qu={}));const Qu=(e,t)=>n=>(0,ha.mT)(e,t,n),Yu=()=>Promise.all([n.e(69432),n.e(92923),n.e(7001),n.e(12724),n.e(83266),n.e(16702)]).then(n.bind(n,700625)),Xu=Qu((()=>n.e(85108).then(n.bind(n,595064))),"services-app-based-link"),Zu=Qu((()=>n.e(5203).then(n.bind(n,848072))),"services-apps-platform"),em=Qu((()=>n.e(91494).then(n.bind(n,192472))),"services-atp-safelinks"),tm=Qu((()=>n.e(71401).then(n.bind(n,535205))),"services-async-media"),nm=Qu((()=>Promise.all([n.e(99110),n.e(87927)]).then(n.bind(n,687928))),"services-azure-maps"),im=Qu((()=>Promise.all([n.e(91942),n.e(56255)]).then(n.bind(n,431722))),"services-biometric-enrollment"),am=Qu((()=>Promise.all([n.e(77351),n.e(20672)]).then(n.bind(n,339849))),"services-bots-platform"),om=Qu((()=>n.e(40060).then(n.bind(n,388841))),"services-brb"),rm=Qu((()=>n.e(11846).then(n.bind(n,210707))),"services-breakout-rooms"),sm=Qu((()=>n.e(63685).then(n.bind(n,193650))),"services-broadcast-attendee"),lm=Qu((()=>n.e(28560).then(n.bind(n,272961))),"services-broadcast-captions"),cm=Qu((()=>Promise.all([n.e(33937),n.e(12549)]).then(n.bind(n,213883))),"services-broadcast-signalr"),dm=Qu((()=>Promise.all([n.e(92923),n.e(32606),n.e(93376)]).then(n.bind(n,456529))),"services-io-calendar"),um=Qu((()=>n.e(34692).then(n.bind(n,979849))),"services-chat-endpoint-provider"),mm=Qu((()=>n.e(77209).then(n.bind(n,757658))),"services-chat"),pm=Qu((()=>n.e(76808).then(n.bind(n,690505))),"services-report-concern"),gm=(Qu((()=>Promise.all([n.e(69432),n.e(92923),n.e(83266),n.e(75925)]).then(n.bind(n,155049))),"services-calling"),Qu((()=>n.e(56737).then(n.bind(n,869247))),"services-collab-object")),hm=Qu((()=>n.e(32034).then(n.bind(n,32926))),"services-connected-accounts"),vm=Qu((()=>n.e(675).then(n.bind(n,811207))),"services-io-connected-calendar"),fm=Qu((()=>n.e(923).then(n.bind(n,466781))),"services-distribution-list"),ym=Qu((()=>n.e(5794).then(n.bind(n,870224))),"services-dynamics-marketing"),Sm=Qu((()=>n.e(78832).then(n.bind(n,825573))),"services-emoticon"),km=Qu((()=>n.e(21174).then(n.bind(n,784721))),"services-esp"),bm=Qu((()=>n.e(69081).then(n.bind(n,285578))),"services-external-accounts"),_m=Qu((()=>n.e(3137).then(n.bind(n,403606))),"services-files"),Cm=Qu((()=>n.e(22121).then(n.bind(n,397605))),"services-file-upload"),wm=Qu((()=>n.e(2653).then(n.bind(n,729907))),"services-file-download-manager"),Tm=Qu((()=>n.e(51425).then(n.bind(n,779612))),"services-fluid"),Em=Qu((()=>n.e(73806).then(n.bind(n,155))),"services-giphy"),Im=Qu((()=>n.e(94248).then(n.bind(n,477583))),"services-gallery"),Nm=Qu((()=>n.e(83483).then(n.bind(n,217672))),"services-google-calendar-authentication"),Am=Qu((()=>n.e(83483).then(n.bind(n,217672))),"services-google-contacts-authentication"),Mm=Qu((()=>n.e(87480).then(n.bind(n,226845))),"services-image-proxy"),Fm=Qu((()=>n.e(70972).then(n.bind(n,110965))),"services-import-msa-contacts"),Rm=Qu((()=>n.e(17965).then(n.bind(n,989099))),"services-instant-answers"),Pm=Qu((()=>n.e(23088).then(n.bind(n,293591))),"services-invite-links"),Dm=Qu((()=>Promise.all([n.e(43612),n.e(61803),n.e(96978)]).then(n.bind(n,209552))),"services-live-state-broadcast"),jm=Qu((()=>Promise.all([n.e(4867),n.e(83836),n.e(90070),n.e(14408)]).then(n.bind(n,901224))),"services-live-stream-renderer"),xm=Qu((()=>n.e(22581).then(n.bind(n,743226))),"services-lms-integration"),Om=Qu((()=>n.e(89829).then(n.bind(n,882010))),"services-loki"),Lm=Qu((()=>n.e(3998).then(n.bind(n,18379))),"services-guardians"),Um=Qu((()=>n.e(88975).then(n.bind(n,809036))),"services-logs-files"),Bm=Qu((()=>n.e(2066).then(n.bind(n,110223))),"services-manage-tenant"),Wm=Qu((()=>n.e(45626).then(n.bind(n,576527))),"services-meeting-artifacts"),Hm=Qu((()=>n.e(20516).then(n.bind(n,559349))),"services-meeting-options"),$m=Qu((()=>n.e(88137).then(n.bind(n,238241))),"services-meeting-templates"),Vm=Qu((()=>n.e(50104).then(n.bind(n,941017))),"services-msa-authentication"),zm=Qu((()=>Promise.all([n.e(81469),n.e(16151)]).then(n.bind(n,499789))),"services-people"),Gm=Qu((()=>n.e(54165).then(n.bind(n,103306))),"services-people-targeting"),qm=Qu((()=>n.e(50718).then(n.bind(n,792426))),"services-files-personal"),Jm=Qu((()=>n.e(42461).then(n.bind(n,772236))),"services-petrol"),Km=Qu((()=>Promise.all([n.e(20248),n.e(94166)]).then(n.bind(n,808852))),"services-floodgate"),Qm=Qu((()=>n.e(4609).then(n.bind(n,126576))),"services-policies"),Ym=Qu((()=>n.e(76130).then(n.bind(n,70359))),"services-presence"),Xm=Qu((()=>Promise.all([n.e(92923),n.e(23363)]).then(n.bind(n,552524))),"scis-service"),Zm=Qu((()=>Promise.all([n.e(92923),n.e(38294),n.e(79506)]).then(n.bind(n,243563))),"services-search"),ep=Qu((()=>Promise.all([n.e(38294),n.e(19161)]).then(n.bind(n,192894))),"search-substrate"),tp=Qu((()=>n.e(2078).then(n.bind(n,844092))),"services-substrate-meeting-recommendations"),np=Qu((()=>n.e(64574).then(n.bind(n,742610))),"services-sharepoint-client"),ip=Qu((()=>n.e(30288).then(n.bind(n,40843))),"services-sharepoint-share"),ap=Qu((()=>n.e(15793).then(n.bind(n,500839))),"services-share"),op=Qu((()=>Promise.all([n.e(85256),n.e(88591),n.e(59098)]).then(n.bind(n,462369))),"services-store"),rp=Qu((()=>n.e(38431).then(n.bind(n,524638))),"services-suggestions"),sp=Qu((()=>n.e(52761).then(n.bind(n,815143))),"services-targeting-hierarchy"),lp=Qu((()=>n.e(62437).then(n.bind(n,570224))),"services-tenant-membership"),cp=Qu((()=>n.e(77412).then(n.bind(n,624887))),"services-third-party-calendar"),dp=Qu((()=>n.e(54692).then(n.bind(n,195662))),"services-toast-image"),up=(Qu((()=>n.e(51309).then(n.bind(n,394341))),"services-teams-and-channels"),Qu((()=>n.e(16014).then(n.bind(n,27830))),"services-translate")),mp=Qu((()=>n.e(6408).then(n.bind(n,312456))),"services-tpn-notice"),pp=Qu((()=>n.e(14826).then(n.bind(n,182316))),"services-url-preview"),gp=Qu((()=>n.e(13549).then(n.bind(n,908542))),"services-user-profile"),hp=Qu((()=>n.e(1172).then(n.bind(n,870708))),"services-voicemail"),vp=Qu((()=>n.e(48693).then(n.bind(n,298450))),"services-item-crud"),fp=Qu((()=>n.e(51792).then(n.bind(n,344305))),"services-webinar"),yp=Qu((()=>n.e(14621).then(n.bind(n,783898))),"services-developer-switchers"),Sp=Qu((()=>n.e(78053).then(n.bind(n,347385))),"services-search-prefetch"),kp=Qu((()=>n.e(84615).then(n.bind(n,273591))),"services-call-recording"),bp=Qu((()=>n.e(59616).then(n.bind(n,161273))),"services-user-license"),_p=new Map,Cp=(e,t)=>{let n;return _p.has(e)?n=_p.get(e):(n=t(),_p.set(e,n)),n},wp=e=>()=>Cp(qu.AsyncMediaService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{send:t,gtmRegistry:n,discover:i,coreSettings:a,loggerFactory:o,scenarioFactory:r}=e,{AsyncMediaService:s}=yield tm(r);return new s(t,n,i,a,o,r)})))(e))),Tp=e=>()=>Cp(qu.SharepointRestClient,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,platformService:n,scenarioFactory:i}=e,{SharepointRestClient:a}=yield np(i);return new a(t,n)})))(e))),Ep=(e,t)=>()=>Cp(qu.BotsPlatformService,(()=>((e,t)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:n,scenarioFactory:i,gtmRegistry:a,send:o,discover:r}=e,s=yield t(),{BotsPlatformService:l}=yield am(i);return new l(n,s,a.bind(o,cs.Pn.middleTier),r,i)})))(e,t))),Ip=e=>()=>Cp(qu.ConnectedAccountsService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{discover:t,gtmRegistry:n,platformService:i,scenarioFactory:a,send:o}=e,{ConnectedAccountsService:r}=yield hm(a);return new r(t,n,i,a,o)})))(e))),Np=e=>()=>Cp(qu.GoogleCalendarAuthenticationService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n,windowProvider:i}=e,{GoogleCalendarAuthenticationService:a}=yield Nm(t);return new a(n,i)})))(e))),Ap=e=>()=>Cp(qu.MsaAuthenticationService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:t,scenarioFactory:n,windowProvider:i}=e,{MsaAuthenticationService:a}=yield Vm(n);return new a(t,n,i)})))(e))),Mp=(e,t,n)=>()=>Cp(qu.ExternalAccountsService,(()=>((e,t,n)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:i,scenarioFactory:a,authenticationService:o}=e,r=yield t(),s=yield n(),{ExternalAccountsService:l}=yield bm(a);return new l(i,o,r,s,a)})))(e,t,n))),Fp=(e,t,n)=>()=>Cp(qu.ThirdPartyCalendarService,(()=>((e,t,n)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:i,scenarioFactory:a,authenticationService:o,localStorage:r}=e,s=yield t(),l=yield n(),{ThirdPartyCalendarService:c}=yield cp(a);return new c(i,o,s,l,a,r)})))(e,t,n)));var Rp=n(388451);const Pp=e=>()=>Cp(qu.TeamsAndChannelsService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t}=e;return new Rp.K(t)})))(e))),Dp=e=>()=>Cp(qu.ToastImageService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{ToastImageService:i}=yield dp(t);return new i(n)})))(e)));var jp=n(108929);const xp=e=>()=>Cp(qu.CallingAppEventsService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:t,windowProvider:n}=e,{ObservableFactory:i}=yield Yu(),a=new i;return new jp.n(t,a,n)})))(e))),Op=(e,t)=>()=>Cp(qu.AppBasedLinkService,(()=>((e,t)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:n,scenarioFactory:i,loggerFactory:a}=e,{AppBasedLinkService:o}=yield Xu(i);return new o(n,yield t(),i,a)})))(e,t))),Lp=e=>()=>Cp(qu.AppsPlatformService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,coreSettings:n,endpointsManager:i,localStorage:a}=e,{enableMetaOsSdkIntegration:o}=n.get(b.J.Extensibility),{AppsPlatformService:r,AppsPlatformServiceMetaOS:s}=yield Zu(t);return o?new s(i):new r(n,i,a)})))(e))),Up=e=>()=>Cp(qu.AzureMapsService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:t,i18NextWrapper:n,scenarioFactory:i,coreSettings:a}=e,{AzureMapsService:o}=yield nm(i);return new o(t,a,n)})))(e))),Bp=e=>()=>Cp(qu.BadgeCountService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,config:n,discover:i,platformService:a,scenarioFactory:o}=e,{BadgeCountService:r}=yield mm(o);return new r(a,t,i,n)})))(e))),Wp=e=>()=>Cp(qu.BrbService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n,coreSettings:i,logsCollectorService:a,authenticationService:o,platformService:r,discover:s,hostCommunicationService:l,endpointsManager:c}=e,{BrbService:d}=yield om(t);return new d(n,i,a,o,r,s,l,c,t)})))(e))),Hp=e=>()=>Cp(qu.BreakoutRoomsService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{BreakoutRoomsService:i}=yield rm(t);return new i(n)})))(e))),$p=e=>()=>Cp(qu.AtpSafelinksService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,coreSettings:n,gtmRegistry:i,loggerFactory:a,scenarioFactory:o,localStorage:r,send:s}=e,{AtpSafelinksService:l}=yield em(o);return new l(i.bind(s,cs.Pn.middleTier),t,n,o,a,r)})))(e))),Vp=e=>()=>Cp(qu.BroadcastAttendeeService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,loggerFactory:n,scenarioFactory:i}=e,{BroadcastAttendeeService:a}=yield sm(i);return new a(t,n)})))(e))),zp=e=>()=>Cp(qu.BroadcastCaptionsService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,send:n,endpointsManager:i,scenarioFactory:a,windowProvider:o,loggerFactory:r}=e,{BroadcastCaptionsService:s}=yield lm(a);return new s(o,r,a,t,n,i)})))(e))),Gp=e=>()=>Cp(qu.BroadcastSignalRService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n,endpointsManager:i,windowProvider:a}=e,{BroadcastSignalRService:o}=yield cm(t);return new o(n,i,t,a)})))(e)));var qp=n(893302);const Jp=(e,t)=>n=>{t({payload:n,pubsub:e})},Kp=e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,coreSettings:i,gtmRegistry:a,loggerFactory:o,pubsub:r,send:s,windowProvider:l}=e,{CallBlockingService:c}=yield n.e(67417).then(n.bind(n,900365));return new c(t,i,a.bind(s,cs.Pn.middleTier),o.newLogger("CallBlockingService"),l,Jp(r,Qp))})),Qp=({payload:e,pubsub:t})=>{t.publish(qp.oo,e.newBlockedMris)};var Yp=n(324118);const Xp=(e,t)=>()=>Cp(qu.CallingDialogServiceAdapter,(()=>((e,t)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:n}=e,i=yield t();return new Yp.l(n,i)})))(e,t)));var Zp=n(694539);const eg=(e,t)=>()=>Cp(qu.CallingNotificationServiceAdapter,(()=>((e,t)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:n,coreSettings:i}=e,a=yield t();return new Zp.L(n,i,a)})))(e,t))),tg=e=>()=>{var t;const{coreSettings:n}=e;if(!(null===(t=null==n?void 0:n.get(b.J.CMDMeetingArtifactsService))||void 0===t?void 0:t.enableCMDMeetingArtifactsService))throw new Error("FF is disabled");return Cp(qu.CollabObjectService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{send:t,coreSettings:n,loggerFactory:i,endpointsManager:a,scenarioFactory:o}=e,{CollabObjectService:r}=yield gm(o);return new r(t,n,i,a)})))(e)))},ng=e=>()=>Cp(qu.ConnectedCalendarSettingsService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{ConnectedCalendarSettingsService:i}=yield vm(t);return new i(t,n)})))(e))),ig=e=>()=>Cp(qu.BiometricEnrollmentService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{discover:t,gtmRegistry:n,loggerFactory:i,platformService:a,scenarioFactory:o,send:r}=e,{BiometricEnrollmentService:s}=yield im(o);return new s(t,n,i,a,r)})))(e))),ag=e=>()=>Cp(qu.DeveloperSwitchersService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,rebootService:n,windowProvider:i,loggerFactory:a}=e,{DeveloperSwitchersService:o}=yield yp(t);return new o(n,i,a.newLogger("DeveloperSwitchersService"))})))(e))),og=e=>()=>Cp(qu.DistributionListService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,send:n,loggerFactory:i,coreSettings:a,scenarioFactory:o}=e,{DistributionListService:r}=yield fm(o);return new r(i,t.bind(n,cs.Pn.middleTier),a)})))(e))),rg=e=>()=>Cp(qu.DynamicsMarketingService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,coreSettings:n,send:i,scenarioFactory:a}=e,{DynamicsMarketingService:o}=yield ym(a);return new o(t,n,i)})))(e))),sg=e=>()=>Cp(qu.EmoticonService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{platformService:t,loggerFactory:n,localStorage:i,scenarioFactory:a,coreSettings:o}=e,{EmoticonService:r}=yield Sm(a),s=new r(t.config.localeCode,i,o,n.newLogger("EmoticonService"));return yield s.isInitialized,s})))(e))),lg=e=>()=>Cp(qu.EspService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:n}=e,{EspService:i}=yield km(n);return new i(t)})))(e))),cg=e=>()=>Cp(qu.FluidService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,scenarioFactory:i}=e,{FluidService:a}=yield Tm(i);return new a(t,n)})))(e))),dg=e=>()=>Cp(qu.GalleryService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,discover:n,send:i,scenarioFactory:a}=e,{GalleryService:o}=yield Im(a);return new o(i,t,n,a)})))(e))),ug=e=>()=>Cp(qu.GiphyService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,gtmRegistry:n,platformService:i,send:a,scenarioFactory:o}=e,{GiphyService:r}=yield Em(o);return new r(n.bind(a,cs.Pn.middleTier),t,i.config.localeCode)})))(e))),mg=e=>()=>Cp(qu.GoogleContactsAuthenticationService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n,windowProvider:i}=e,{GoogleContactsAuthenticationService:a}=yield Am(t);return new a(n,i)})))(e))),pg=e=>()=>Cp(qu.GuardiansService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,discover:n,send:i,scenarioFactory:a,loggerFactory:o}=e,{GuardiansService:r}=yield Lm(a);return new r(t,o,n,i)})))(e))),gg=e=>()=>Cp(qu.ImageProxyService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,gtmRegistry:n,send:i,scenarioFactory:a}=e,{ImageProxyService:o}=yield Mm(a);return new o(n,i,t)})))(e))),hg=(e,t)=>()=>Cp(qu.ImportMsaContactsService,(()=>((e,t)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:n,endpointsManager:i,scenarioFactory:a}=t,{ImportMsaContactsService:o}=yield Fm(a);return new o(yield e(),n,i,a)})))(e,t))),vg=e=>()=>Cp(qu.InstantAnswersService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{platformService:t,coreSettings:n,send:i,scenarioFactory:a,loggerFactory:o}=e,{InstantAnswersService:r}=yield Rm(a);return new r(o,a,t,n,i)})))(e))),fg=e=>()=>Cp(qu.InviteLinksService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{InviteLinksService:i}=yield Pm(t);return new i(n)})))(e))),yg=e=>()=>Cp(qu.LiveStateBroadcastService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{pubsub:t,scenarioFactory:n,loggerFactory:i,coreSettings:a,authenticationService:o,platformService:r,discover:s}=e,{LiveStateBroadcastService:l}=yield Dm(n);return new l(t,i,a,o,r,n,s)})))(e))),Sg=e=>()=>Cp(qu.LiveStreamRenderingService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,scenarioFactory:i,loggerFactory:a,pubsub:o,platformService:r,clientState:s,coreSettings:l}=e,{LiveStreamRenderingService:c}=yield jm(i);return new c(a,t,r,s,o,n,l,i)})))(e))),kg=e=>()=>Cp(qu.LmsIntegrationService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,discover:n,send:i,scenarioFactory:a}=e,{LmsIntegrationService:o}=yield xm(a);return new o(t,n,i)})))(e))),bg=e=>()=>Cp(qu.LokiService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,platformService:n,scenarioFactory:i,coreSettings:a}=e,{LokiService:o}=yield Om(i);return new o(n,t,a)})))(e))),_g=e=>()=>Cp(qu.ManageTenantService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{discover:t,endpointsManager:n,loggerFactory:i,scenarioFactory:a}=e,{ManageTenantService:o}=yield Bm(a);return new o(t,i,a,n)})))(e))),Cg=e=>()=>Cp(qu.MeetingArtifactsService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,coreSettings:i,scenarioFactory:a,i18n:o,loggerFactory:r}=e,{MeetingArtifactsService:s}=yield Wm(a);return new s(n,t,i,o,r,a)})))(e))),wg=e=>()=>Cp(qu.PeopleService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,send:n,scenarioFactory:i,endpointsManager:a,coreSettings:o}=e,{PeopleService:r}=yield zm(i);return new r(t.bind(n,cs.Pn.middleTier),o,a)})))(e))),Tg=e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{windowProvider:t}=e,{MeetingOptionsClientDataService:i}=yield n.e(20516).then(n.bind(n,682168)),a=wg(e);return new i(t,yield a())})),Eg=e=>()=>Cp(qu.MeetingOptionsClientDataService,(()=>Tg(e))),Ig=e=>()=>Cp(qu.MeetingOptionsService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,scenarioFactory:i,coreSettings:a,gtmRegistry:o,discover:r}=e,{MeetingOptionsService:s}=yield Hm(i);return new s(t,n,i,a,o,r)})))(e))),Ng=e=>()=>Cp(qu.MeetingTemplateService,(()=>(({scenarioFactory:e,send:t,authenticationService:n,coreSettings:i})=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{MeetingTemplateService:a}=yield $m(e);return new a(t,n,i,e)})))(e))),Ag=e=>()=>Cp(qu.PeopleTargetingService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,loggerFactory:n,send:i,coreSettings:a,scenarioFactory:o}=e,{PeopleTargetingService:r}=yield Gm(o);return new r(t,n,i,a)})))(e))),Mg=e=>()=>Cp(qu.PetrolService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{platformService:t,authenticationService:n,coreSettings:i,send:a,scenarioFactory:o,loggerFactory:r}=e,{PetrolService:s}=yield Jm(o);return new s(n,o,r,t,i,a)})))(e))),Fg=e=>()=>Cp(qu.FloodgateService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:t,scenarioFactory:n,coreSettings:i,platformService:a,clientState:o,i18NextWrapper:r,windowProvider:s}=e,{FloodGateService:l}=yield Km(n);return new l(t,n,o,i,a,r,s)})))(e))),Rg=e=>()=>Cp(qu.PoliciesService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,loggerFactory:n,scenarioFactory:i}=e,{PoliciesService:a}=yield Qm(i);return new a(t,n,i)})))(e))),Pg=e=>()=>Cp(qu.PresenceService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,pubsub:n,send:i,scenarioFactory:a}=e,{PresenceService:o}=yield Ym(a);return new o(t.bind(i,cs.Pn.unifiedPresence),n)})))(e))),Dg=e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,send:i}=e,{PstnService:a}=yield n.e(93393).then(n.bind(n,47781));return new a(t.bind(i,cs.Pn.middleTier))})),jg=e=>()=>Cp(qu.PstnService,(()=>Dg(e))),xg=e=>()=>Cp(qu.SCISService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{send:t,authenticationService:n,platformService:i,scenarioFactory:a,loggerFactory:o}=e,{SCISService:r}=yield Xm(a);return new r(t,n,i,a,o)})))(e))),Og=e=>()=>Cp(qu.SearchPrefetchService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n,authenticationService:i}=e,{SearchPrefetchService:a}=yield Sp(t);return new a(i,n)})))(e))),Lg=e=>()=>Cp(qu.SearchSubstrateService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{send:t,scenarioFactory:n,loggerFactory:i,platformService:a,authenticationService:o}=e,{SearchSubstrateService:r}=yield ep(n);return new r(t,i,o,a)})))(e))),Ug=e=>()=>Cp(qu.ShareService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,discover:n,gtmRegistry:i,platformService:a,scenarioFactory:o,send:r}=e,{ShareService:s}=yield ap(o);return new s(t,n,i,a,r)})))(e))),Bg=e=>()=>Cp(qu.StoreService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n,gtmRegistry:i,send:a,coreSettings:o,authenticationService:r,platformService:s,endpointsManager:l}=e,{StoreService:c}=yield op(t);return new c(t,n,i,a,o,r,s,l)})))(e))),Wg=e=>()=>Cp(qu.TenantMembershipService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{TenantMembershipService:i}=yield lp(t);return new i(t,n)})))(e))),Hg=e=>()=>Cp(qu.TranslateService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,scenarioFactory:n,send:i}=e,{TranslateService:a}=yield up(n);return new a(t.bind(i,cs.Pn.middleTier),n)})))(e))),$g=e=>()=>Cp(qu.TargetingHierarchyService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,coreSettings:n,loggerFactory:i,scenarioFactory:a,send:o}=e,{TargetingHierarchyService:r}=yield sp(a);return new r(t,i,o,n)})))(e))),Vg=e=>()=>Cp(qu.TpnNoticeService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{send:t,platformService:n,scenarioFactory:i}=e,{TpnNoticeService:a}=yield mp(i);return new a(t,n)})))(e))),zg=(e,t)=>()=>Cp(qu.UrlPreviewService,(()=>((e,t)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:n,send:i,coreSettings:a,scenarioFactory:o}=e,{UrlPreviewService:r}=yield pp(o);return new r(n,i,a,yield t())})))(e,t))),Gg=e=>()=>Cp(qu.UserProfileService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,send:n,scenarioFactory:i}=e,{UserProfileService:a}=yield gp(i);return new a(n,t)})))(e)));var qg=n(369183);const Jg=({payload:e,pubsub:t})=>{t.publish(qg.Gq,e)},Kg=e=>()=>Cp(qu.VoicemailService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,coreSettings:n,loggerFactory:i,scenarioFactory:a,pubsub:o,send:r,windowProvider:s}=e,{VoicemailService:l}=yield hp(a);return new l(t,n,r,i,s,Jp(o,Jg))})))(e))),Qg=e=>()=>Cp(qu.WebinarService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,send:n,authenticationService:i,coreSettings:a,discover:o,i18n:r,loggerFactory:s}=e,{WebinarService:l}=yield fp(t);return new l(n,i,a,s,t,r,o)})))(e))),Yg=e=>()=>Cp(qu.CallRecordingService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n,endpointsManager:i}=e,{CallRecordingService:a}=yield kp(t);return new a(n,i)})))(e))),Xg=e=>()=>Cp(qu.UserLicenseService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{discover:t,endpointsManager:n,loggerFactory:i,scenarioFactory:a}=e,{UserLicenseService:o}=yield bp(a);return new o(t,n,i)})))(e))),Zg=e=>()=>Cp(qu.LokiMetaPreviewService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,loggerFactory:i,scenarioFactory:a}=e,{LokiMetaPreviewService:o}=yield Zm(a);return new o(n,t,i)})))(e))),eh=e=>()=>Cp(qu.OdcFilePreviewService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,loggerFactory:i,scenarioFactory:a}=e,{OdcFilePreviewService:o}=yield Zm(a);return new o(n,t,i)})))(e))),th=e=>()=>Cp(qu.OSearchService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{send:t,discover:n,loggerFactory:i,scenarioFactory:a}=e,{OSearchService:o}=yield Zm(a);return new o(t,n,i)})))(e))),nh=e=>()=>Cp(qu.PeopleSearchService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{send:t,gtmRegistry:n,loggerFactory:i,scenarioFactory:a,discover:o}=e,{PeopleSearchService:r}=yield Zm(a);return new r(n.bind(t,cs.Pn.middleTier),i,o)})))(e))),ih=e=>()=>Cp(qu.SubstrateFilesSearchService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,platformService:i,loggerFactory:a,scenarioFactory:o}=e,{SubstrateFilesSearchService:r}=yield Zm(o);return new r(n,t,i,o,a)})))(e))),ah=e=>()=>Cp(qu.SubstrateSearchService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,loggerFactory:i,platformService:a,scenarioFactory:o,windowProvider:r}=e,{SubstrateSearchService:s}=yield Zm(o);return new s(n,t,a,o,i,r)})))(e))),oh=e=>()=>Cp(qu.SubstrateSuggestionsService,(()=>(({authenticationService:e,coreSettings:t,discover:n,gtmRegistry:i,send:a,scenarioFactory:o})=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{SubstrateSuggestionsService:r}=yield rp(o);return new r(a,e,t,n,i)})))(e))),rh=e=>()=>Cp(qu.ChatService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,endpointsManager:n,platformService:i,coreSettings:a,send:o,scenarioFactory:r}=e,{ChatService:s}=yield mm(r);return new s(t.bind(o,cs.Pn.chatService),a,i,n)})))(e))),sh=(e,t)=>()=>Cp(qu.ChatServiceEndpointProvider,(()=>((e,t)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:n}=e,i=yield t(),{ChatServiceEndpointProvider:a}=yield um(n);return new a(i,n)})))(e,t))),lh=e=>()=>Cp(qu.ConsumerGroupsService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n,loggerFactory:i}=e,{ConsumerGroupsService:a}=yield mm(t);return new a(n,i,t)})))(e))),ch=e=>()=>Cp(qu.CSAService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,platformService:n,coreSettings:i,scenarioFactory:a,discover:o,endpointsManager:r,config:s,send:l}=e,{createCSAService:c}=yield mm(a);return c(t,n,i,o,l,r,s)})))(e))),dh=e=>()=>Cp(qu.StatefulLongPoll,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t}=e,{StatefulLongPoll:n}=yield mm(t);return new n})))(e))),uh=e=>()=>Cp(qu.ReportConcernService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,send:n,gtmRegistry:i,platformService:a}=e,{ReportConcernService:o}=yield pm(t);return new o(i.bind(n,cs.Pn.middleTier),a)})))(e))),mh=(e,t)=>()=>Cp(qu.SharepointShareService,(()=>((e,t)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:n,loggerFactory:i,send:a,scenarioFactory:o}=e,{SharepointShareService:r}=yield ip(o);return new r(a,i,n,yield t())})))(e,t))),ph=(e,t)=>()=>Cp(qu.FilesSharepointUrlService,(()=>((e,t)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:n,coreSettings:i}=t,{FilesSharepointUrlService:a}=yield ip(n);return new a(yield e(),i)})))(e,t))),gh=(e,t)=>()=>Cp(qu.FilesRedeemService,(()=>((e,t)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:n,loggerFactory:i,send:a,scenarioFactory:o}=e,{FilesRedeemService:r}=yield ip(o);return new r(a,i,n,yield t())})))(e,t))),hh=(e,t)=>()=>Cp(qu.FilesReferenceService,(()=>((e,t)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:n}=t,{FilesReferenceService:i}=yield _m(n);return new i(yield e())})))(e,t))),vh=(e,t)=>()=>Cp(qu.FileUploadPreviewService,(()=>((e,t)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:n,scenarioFactory:i}=e,{FileUploadPreviewService:a}=yield Cm(i);return new a(yield t(),n)})))(e,t))),fh=(e,t)=>()=>Cp(qu.FileUploadService,(()=>((e,t)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:n,scenarioFactory:i,coreSettings:a}=e,{FileUploadService:o}=yield Cm(i);return new o(yield t(),a,n)})))(e,t))),yh=e=>()=>Cp(qu.FileDownloadManagerService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n}=e,{FileDownloadManagerService:i}=yield wm(t);return new i(n.newLogger("fileDownloadManagerService"))})))(e)));var Sh=n(377692);const kh=(e,t)=>()=>Cp(qu.PersonalFileDetailsService,(()=>((e,t)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{discover:n,gtmRegistry:i,loggerFactory:a,scenarioFactory:o,send:r}=e,s=yield t(),{PersonalFileDetailsService:l}=yield qm(o),c=new Sh.q(n);return new l(s,o,a,i.bind(c.authorize(r,"x-skypetoken"),cs.Pn.middleTier))})))(e,t))),bh=e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,send:i,discover:a}=e,{RefreshSiteUrlService:o}=yield n.e(6545).then(n.bind(n,242654));return new o(t,a,i)})),_h=e=>()=>Cp(qu.FilesBackfillThreadPropertiesService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{discover:t,gtmRegistry:n,scenarioFactory:i,loggerFactory:a,send:o}=e,{FilesBackfillThreadPropertiesService:r}=yield _m(i),s=new Sh.q(t);return new r(a,n.bind(s.authorize(o,"x-skypetoken"),cs.Pn.middleTier))})))(e))),Ch=(e,t=Us.l)=>(n,i=ba.hO.BEARER)=>{var a,o;return n?null!==(o=null===(a=e.authorizeV2)||void 0===a?void 0:a.call(e,t,n,{scheme:i}))&&void 0!==o?o:e.authorize(t,n):t},wh=(e,t)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:n,authenticationService:i,loggerFactory:a,coreSettings:o}=t,r=Th(o),s=Eh(o,r)||"",l=Ih(o,r)||"",c=Ch(i),{ItemUploadService:d,ItemDeleteService:u,ItemDetailsService:m}=yield vp(n),p=a.newLogger(e);switch(e){case qu.ItemUploadService:return new d(c,r,s,l,p);case qu.ItemDeleteService:return new u(c,r,p);case qu.ItemDetailsService:return new m(c,r,p);default:return}})),Th=e=>!!e.get(b.J.Files).preferGraphOverVroom,Eh=(e,t)=>t?e.get(b.J.Files).graphEndpointBaseUrl:e.get(b.J.Files).vroomEndpointBaseUrl,Ih=(e,t)=>t?e.get(b.J.Files).graphAuthScope:e.get(b.J.Files).vroomAuthScope,Nh=e=>()=>Cp(qu.ItemUploadService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){return yield wh(qu.ItemUploadService,e)})))(e))),Ah=e=>()=>Cp(qu.ItemDeleteService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){return yield wh(qu.ItemDeleteService,e)})))(e))),Mh=e=>()=>Cp(qu.ItemDetailsService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){return yield wh(qu.ItemDetailsService,e)})))(e))),Fh=e=>()=>Cp(qu.DriveItemShareService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t}=e,{DriveItemShareService:n}=yield ip(t),{authenticationService:i,coreSettings:a}=e,o=Th(a);return new n(Ch(i),o)})))(e))),Rh=(e,t)=>()=>Cp(qu.VideoFileService,(()=>((e,t)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:n,loggerFactory:i,send:a,scenarioFactory:o}=e,{VideoFileService:r}=yield ip(o);return new r(a,i,n,yield t())})))(e,t))),Ph=e=>()=>Cp(qu.CalendarService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,send:n,authenticationService:i,coreSettings:a,discover:o,loggerFactory:r,platformService:s}=e,{CalendarService:l}=yield dm(t);return new l(n,i,o,a,r,s)})))(e))),Dh=e=>()=>Cp(qu.TeamCalendarService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,send:n,authenticationService:i,coreSettings:a,discover:o,loggerFactory:r,platformService:s}=e,{TeamCalendarService:l}=yield dm(t);return new l(n,i,o,a,r,s)})))(e))),jh=e=>()=>Cp(qu.SubstrateMeetingRecommendationsService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,send:n,authenticationService:i,loggerFactory:a}=e,{SubstrateMeetingRecommendationsService:o}=yield tp(t);return new o(n,i,a)})))(e))),xh=(e,t)=>()=>Cp(qu.CallingService,(()=>((e,t)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:i,i18NextWrapper:a,loggerFactory:o,i18n:r,platformService:s,endpointsManager:l,cmdApolloClient:c,scenarioFactory:d,hostCommunicationService:u,logsCollectorService:m}=e,{CallingService:p}=yield Promise.all([n.e(69432),n.e(92923),n.e(83266),n.e(75925)]).then(n.bind(n,155049));return new p(t,i,s,r,l,c,d,a,o,u,m)})))(e,t))),Oh=e=>()=>Cp(qu.LogsFilesService,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n,logsCollectorService:i,coreSettings:a}=e,{LogsFilesService:o}=yield Um(t);return new o(n,i,a)})))(e))),Lh=e=>()=>Cp(qu.CallingAdapterServices,(()=>(e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,cmdApolloClient:n,coreSettings:i,discover:a,i18NextWrapper:o,localStorage:r,loggerFactory:s,scenarioFactory:l,send:c,windowProvider:d,networkState:u}=e,{ACSCallingAuthenticationServiceAdapter:m,AdminSettingsStore:p,CallingAuthenticationServiceAdapter:g,AggregatedSettingsStoreService:h,AppStateServiceImplementation:v,AriaLiveService:f,AtMentionServiceImplementation:y,AttendanceReportService:S,BatteryStatusService:k,BrbV2FeedbackService:_,CallingHttpAdapterService:C,CallingPeopleServiceAdapter:w,CallingLoggingService:T,CallingMultiWindowService:E,CallingPolicyStore:I,CallingStorageService:N,CallingLayoutAdapterService:A,CallStateService:M,ChannelServiceAdapter:F,ChatServiceClientAdapter:R,ChatServiceUtils:P,ClientDatabaseService:D,ConversationsAsyncServiceAdapter:j,ConversationsLocalStoreAdapter:x,ConversationsServiceAdapter:O,ConversationsStoreAdapter:L,DataManagerAdapter:U,DeepLinkProviderAdapter:B,DelegationSettingsService:W,DesktopUtilityService:H,DiagnosticsService:$,DistributionListServiceImplementation:V,ECSProvider:z,ElectronIpcService:G,EventingServiceAdapter:q,ExperienceContainerFeatureService:J,FilesNotificationService:K,FreemiumUtilities:Q,GeoRoutingService:Y,HybridContentVisibilityManager:X,LocalizationService:Z,MeetingPolicySettingsStore:ee,MessageFetchServiceImplementation:te,MessagingTelemetryService:ne,MsGraphRestClient:ie,MTMASubscriptionUtility:ae,MyUserPreferencesStore:oe,initNativeRenderingHelper:re,customVideoBackgroundServiceHelpers:se,NavigationService:le,NetworkDetectorService:ce,Observable:de,ObservableFactory:ue,OnlineDialinConferencingPolicyStore:me,PaywallService:pe,PhoneNumberUtil:ge,PlatformDetectServiceAdapter:he,PerfStatsNotifierService:ve,PolicySettingsStore:fe,ResourceManagerService:ye,RetryService:Se,SfbTeamsUpgradeService:ke,StaticUtils:be,SXConfig:_e,SyntheticAutomatedCallPolicySettingsStore:Ce,TeamsMeetingBrandingPolicySettingsStore:we,TelemetryProvider:Te,TenantSettingsStore:Ee,TenantVoiceSettingsStore:Ie,TsCallingTelemetryService:Ne,UserResourcesSettingsStore:Ae,UtilityServiceImplementation:Me,VoiceAdminSettingsStore:Fe,WatchServiceAdapter:Re,WebApiService:Pe}=yield Yu(),{PeopleService:De}=yield zm(l),je=new De(c,i),xe=new h(s,i),Oe=new A(s),Le=yield t.getUser(),Ue=i.get(b.J.Calling).enableACSEmbed?new m(a,Le,s):new g(t,a,Le,s),Be=new he(i),We=new p(s,i,xe);yield We.startup();const He=new f,$e=new y(o,s,n),Ve=new te(s,n),ze=new v(u),Ge=new S(i,s),qe=new X(s),Je=new k(s),Ke=new _(s),Qe=new w(s,n,je),Ye=new P,Xe=new N(r,s),Ze=new ee(s,i,xe);Ze.startup();const et=yield xp(e)(),tt=new C(c,s),nt=new H(e.platformService),it=re(e.hostCommunicationService,s),at=new V,ot=new W(a),rt=new $(s),st=new J(s),lt=new z(i),ct=new ie(s),dt=new ne(s),ut=new ue,mt=new q(ut),pt=yield Xp(e,(()=>Promise.resolve(et)))(),gt=yield eg(e,(()=>Promise.resolve(et)))(),ht=new le(s,et),vt=new G(s),ft=new K(s),yt=se(vt,e.hostCommunicationService,e.platformService),St=new Q(s),kt=new Y(s),bt=new Z(o),_t=new ae,Ct=new oe,wt=new ce(d),Tt=new me(s,i,xe),Et=new pe(i,d),It=new ve(s),Nt=new ye(s,i,d);let At=[];const Mt=new fe(s,i,xe);At=At.concat(Mt),yield Mt.startup();const Ft=new Se(mt,s,l,d),Rt=new Ce(s,i,xe);yield Rt.startup();const Pt=new ke(s,i,je,l,a),Dt=new E(s,et,pt,i),jt=new I(s,i,xe);yield jt.startup();const xt=new T(s,l,e.platformService),Ot=new Ne(l),Lt=new B,Ut=new D(s,r),Bt=new F(s),Wt=new x(s,n,l,d,i),Ht=new O(s,Wt,i,xe,Pt,ut),$t=new j(s,Wt,i,xe,Pt,n),Vt=new R(s,n,$t),zt=new U,Gt=new ge(s),qt=new Me(d),Jt=new be(s),Kt=new _e(yield a.skypeid()),Qt=new M,Yt=new Re,Xt=new we(s,i,xe);yield Xt.startup();const Zt=new Te,en=new Ee(s,i,xe);At=At.concat(en);const tn=new Ie(s,i,xe);At=At.concat(tn);const nn=new Ae(s,i,xe);At=At.concat(nn);const an=new Fe(s,i,xe);At=At.concat(an);const on=new de,rn=new L(n,s,Ht);return yield Promise.all(At.map((e=>e.startup()))),{adminSettingsStore:We,aggregatedSettingsStoreService:xe,appStateServiceImplementation:ze,authenticationService:Ue,ariaLiveService:He,atMentionServiceImplementation:$e,attendanceReportService:Ge,batteryStatusService:Je,brbV2FeedbackService:Ke,callingDialogServiceAdapter:pt,callingHttpAdapterService:tt,callingLoggingService:xt,callingNotificationService:gt,callingMultiWindowService:Dt,callingPeopleServiceAdapter:Qe,callingPolicyStore:jt,callingStorageService:Xe,callStateService:Qt,channelServiceAdapter:Bt,chatServiceClientAdapter:Vt,chatServiceUtils:Ye,conversationsAsyncServiceAdapter:$t,conversationsServiceAdapter:Ht,conversationsStoreAdapter:rn,clientDatabaseService:Ut,customVideoBackgroundServiceHelpers:yt,dataManagerAdapter:zt,deepLinkProviderAdapter:Lt,delegationSettingsService:ot,desktopUtilityService:nt,diagnosticsService:rt,distributionListService:at,ecsProvider:lt,electronIpcService:vt,experienceContainerFeatureService:st,eventingServiceAdapter:mt,filesNotificationService:ft,freemiumUtilities:St,geoRoutingService:kt,layoutService:Oe,hybridContentVisibilityManager:qe,localizationService:bt,meetingPolicySettingsStore:Ze,messageFetchServiceImplementation:Ve,messagingTelemetryService:dt,msGraphRestClient:ct,mtmaSubscriptionUtility:_t,myUserPreferencesStore:Ct,nativeRenderingHelper:it,navigationService:ht,networkDetectorService:wt,observable:on,observableFactory:ut,onlineDialinConferencingPolicyStore:Tt,paywallService:Et,perfStatsNotifierService:It,platformDetectService:Be,policySettingsStore:Mt,phoneNumberUtil:Gt,resourceManagerService:Nt,retryService:Ft,sfbTeamsUpgradeService:Pt,staticUtils:Jt,sxConfig:Kt,syntheticAutomatedCallPolicySettingsStore:Rt,teamsMeetingBrandingPolicySettingsStore:Xt,telemetryProvider:Zt,tenantSettingsStore:en,tenantVoiceSettingsStore:tn,tsCallingTelemetryService:Ot,userResourcesSettingsStore:nn,utilityServiceImplementation:qt,voiceAdminSettingsStore:an,watchServiceAdapter:Yt,webApiService:new Pe(d)}})))(e))),Uh=e=>({getLokiMetaPreviewService:Zg(e),getOdcFilePreviewService:eh(e),getOSearchService:th(e),getPeopleSearchService:nh(e),getSubstrateFilesSearchService:ih(e),getSubstrateSearchService:ah(e),getSubstrateSuggestionsService:oh(e)}),Bh=e=>{const t=rh(e),n=sh(e,t),i=lh(e),a=ch(e),o=dh(e);return{getChatService:t,getChatServiceEndpointProvider:n,getConsumerGroupsService:i,getCSAService:a,getReportConcernService:uh(e),getStatefulLongPoll:o}},Wh=(e,t,n,i)=>{const a=mh(e,i),o=ph(a,e);return{getFilesRedeemService:gh(e,i),getFilesReferenceService:hh(o,e),getFilesSharepointUrlService:o,getFileUploadPreviewService:vh(e,t),getFileUploadService:fh(e,i),getFileDownloadManagerService:yh(e),getPersonalFileDetailsService:kh(e,n),getRefreshSiteUrlService:(r=e,()=>Cp(qu.RefreshSiteUrlService,(()=>bh(r)))),getFilesBackfillThreadPropertiesService:_h(e),getSharepointShareService:a,getItemUploadService:Nh(e),getItemDeleteService:Ah(e),getItemDetailsService:Mh(e),getDriveItemShareService:Fh(e),getVideoFileService:Rh(e,i)};var r},Hh=e=>({getCalendarService:Ph(e),getTeamCalendarService:Dh(e),getMeetingRecommendationsService:jh(e)}),$h=e=>xh(e,{getCallingServiceAdapters:Lh(e)}),Vh=e=>({getLogsFilesService:Oh(e)});function zh(e,t){const{appsRegistryService:n,appStateService:i,authenticationService:a,authenticationUser:o,authStateProvider:r,cacheStorage:s,clientPreferences:l,clientState:c,commandReportingService:d,coreSettings:u,discover:m,experienceChangeReportingService:p,hostCommunicationService:g,localStorage:h,loggerFactory:v,offlineCacheManager:f,platformService:y,pubsub:S,rebootService:k,scenarioFactory:b,userBiService:_,windowProvider:C}=e;return Object.assign({appsRegistryService:n,appStateService:i,authenticationUser:o,authenticationService:a,authStateProvider:r,cacheStorage:s,clientPreferences:l,clientState:c,commandReportingService:d,coreSettings:u,discover:m,experienceChangeReportingService:p,hostCommunicationService:g,localStorage:h,loggerFactory:v,offlineCacheManager:f,platformService:y,pubsub:S,rebootService:k,scenarioFactory:b,userBiService:_,windowId:"",windowProvider:C},(e=>{const t=wp(e),n=Bh(e),i=Tp(e),a=Ep(e,n.getChatService),o=Wh(e,t,n.getChatService,i),r=Ip(e),s=Np(e),l=Ap(e),c=Mp(e,s,r),d=Fp(e,s,r),u=Pp(e),m=Dp(e),p=Hh(e),g=xp(e);var h;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n),{getAppBasedLinkService:Op(e,a),getAppsPlatformService:Lp(e),getAsyncMediaService:t,getAzureMapsService:Up(e),getBadgeCountService:Bp(e),getBotsPlatformService:a,getBrbService:Wp(e),getBreakoutRoomsService:Hp(e),getAtpSafelinksService:$p(e),getBroadcastAttendeeService:Vp(e),getBroadcastCaptionsService:zp(e),getBroadcastSignalRService:Gp(e)}),p),{getCallBlockingService:(h=e,()=>Cp(qu.CallBlockingService,(()=>Kp(h)))),getCallingAppEventsService:g,getCallingDialogService:Xp(e,g),getCallingNotificationService:eg(e,g),getCallingService:$h(e),getCollabObjectService:tg(e),getConnectedAccountsService:r,getConnectedCalendarSettingsService:ng(e),getBiometricEnrollmentService:ig(e),getDeveloperSwitchersService:ag(e),getDistributionListService:og(e),getDynamicsMarketingService:rg(e),getEmoticonService:sg(e),getEspService:lg(e),getExternalAccountsService:c}),o),{getFluidService:cg(e),getGalleryService:dg(e),getGiphyService:ug(e),getGoogleCalendarAuthenticationService:s,getGoogleContactsAuthenticationService:mg(e),getGuardiansService:pg(e),getImageProxyService:gg(e),getImportMsaContactsService:hg(l,e),getInstantAnswersService:vg(e),getInviteLinksService:fg(e),getLiveStateBroadcastService:yg(e),getLiveStreamRenderingService:Sg(e),getLmsIntegrationService:kg(e),getLokiService:bg(e),getManageTenantService:_g(e),getMeetingArtifactsService:Cg(e),getMeetingOptionsClientDataService:Eg(e),getMeetingOptionsService:Ig(e),getMeetingTemplateService:Ng(e),getMsaAuthenticationService:l,getPeopleService:wg(e),getPeopleTargetingService:Ag(e),getPetrolService:Mg(e),getFloodgateService:Fg(e),getPoliciesService:Rg(e),getPresenceService:Pg(e)}),Uh(e)),{getPstnService:jg(e),getSCISService:xg(e),getSearchPrefetchService:Og(e),getSearchSubstrateService:Lg(e),getSharepointRestClient:i,getShareService:Ug(e),getStoreService:Bg(e),getTenantMembershipService:Wg(e),getTranslateService:Hg(e),getTargetingHierarchyService:$g(e),getThirdPartyCalendarService:d,getToastImageService:m,getTeamsAndChannelsService:u,getTpnNoticeService:Vg(e),getUrlPreviewService:zg(e,o.getFilesReferenceService),getUserProfileService:Gg(e),getVoicemailService:Kg(e),getWebinarService:Qg(e)}),Vh(e)),{getCallRecordingService:Yg(e),getUserLicenseService:Xg(e)})})(Object.assign(Object.assign({},e),{cmdApolloClient:t})))}class Gh{constructor(){}static create(e){if(Gh._clientResolvers)throw new Error("ClientResolvers are already created");return Gh._clientResolvers=function(e){return(0,j.merge)((0,Ju.w)(),od.w,Dc,(0,ad.w)(),function(){let e;const t=t=>i=>(a,o,r)=>(0,l.__awaiter)(this,void 0,void 0,(function*(){if(!e){const{broadcastClientResolvers:t}=yield Promise.all([n.e(51963),n.e(91789)]).then(n.bind(n,42621));e=t()}return e[t][i](a,o,r)}));return{Query:{broadcastLayout:t("Query")("broadcastLayout"),attendeeCaptionsVisibility:t("Query")("attendeeCaptionsVisibility")},Mutation:{setBroadcastActiveSectionSource:t("Mutation")("setBroadcastActiveSectionSource"),updateBroadcastLayout:t("Mutation")("updateBroadcastLayout"),selectBroadcastSection:t("Mutation")("selectBroadcastSection"),clearBroadcastSource:t("Mutation")("clearBroadcastSource"),createDebugBroadcast:t("Mutation")("createDebugBroadcast"),updateAttendeeCaptionsVisibility:t("Mutation")("updateAttendeeCaptionsVisibility")}}}(),function(e){let t;const i=i=>a=>(o,r,s)=>(0,l.__awaiter)(this,void 0,void 0,(function*(){if(!t){const{clientResolvers:i}=yield Promise.all([n.e(51963),n.e(91789)]).then(n.bind(n,42621));t=i(e)}return t[i][a](o,r,s)}));return{CallingIntent:{isFake:i("CallingIntent")("isFake")},CallLogParticipant:{hasDisplayName:i("CallLogParticipant")("hasDisplayName"),displayName:i("CallLogParticipant")("displayName")},Query:{whiteboardSharingSession:i("Query")("whiteboardSharingSession"),pptSharingSession:i("Query")("pptSharingSession"),bulkMoveStatus:i("Query")("bulkMoveStatus"),prejoinState:i("Query")("prejoinState"),callingScreenStatus:i("Query")("callingScreenStatus"),callingScreenLayout:i("Query")("callingScreenLayout"),pinnedParticipantIds:i("Query")("pinnedParticipantIds"),videoScanType:i("Query")("videoScanType"),captionFontSize:i("Query")("captionFontSize"),debugVideoEffectState:i("Query")("debugVideoEffectState"),selectedVideoEffectsInfo:i("Query")("selectedVideoEffectsInfo")},Mutation:{moveRoomRetainedParticipants:i("Mutation")("moveRoomRetainedParticipants"),acceptStreamPermissionsDebug:i("Mutation")("acceptStreamPermissionsDebug"),setDebugToolVisible:i("Mutation")("setDebugToolVisible"),updateMeetingRoomLayoutToggleState:i("Mutation")("updateMeetingRoomLayoutToggleState"),setDebugToolHiddenParticipantsCount:i("Mutation")("setDebugToolHiddenParticipantsCount"),setBulkMoveStatus:i("Mutation")("setBulkMoveStatus"),createDebugBreakoutRooms:i("Mutation")("createDebugBreakoutRooms"),createDebugCall:i("Mutation")("createDebugCall"),addDebugSuggestedUser:i("Mutation")("addDebugSuggestedUser"),joinDebugCallFromIntent:i("Mutation")("joinDebugCallFromIntent"),createDebugCallingIntent:i("Mutation")("createDebugCallingIntent"),createDebugConversation:i("Mutation")("createDebugConversation"),updateDebugCall:i("Mutation")("updateDebugCall"),stopDebugCall:i("Mutation")("stopDebugCall"),stopSpotlightSelfDebugCall:i("Mutation")("stopSpotlightSelfDebugCall"),toggleHoldDebugCall:i("Mutation")("toggleHoldDebugCall"),addDebugParticipant:i("Mutation")("addDebugParticipant"),toggleDebugLocalMute:i("Mutation")("toggleDebugLocalMute"),startDebugRecording:i("Mutation")("startDebugRecording"),stopDebugRecording:i("Mutation")("stopDebugRecording"),setCallTranscriptStateDebug:i("Mutation")("setCallTranscriptStateDebug"),sendCallTranscriptEntryEventDebug:i("Mutation")("sendCallTranscriptEntryEventDebug"),sendClosedCaptionsEntryEventDebug:i("Mutation")("sendClosedCaptionsEntryEventDebug"),sendClosedCaptionsStatusEventDebug:i("Mutation")("sendClosedCaptionsStatusEventDebug"),removeDebugParticipant:i("Mutation")("removeDebugParticipant"),toggleDebugVideo:i("Mutation")("toggleDebugVideo"),toggleDebugScreenShare:i("Mutation")("toggleDebugScreenShare"),updateDebugParticipant:i("Mutation")("updateDebugParticipant"),updateDebugPinParticipantFromOutside:i("Mutation")("updateDebugPinParticipantFromOutside"),updateDebugRigelLayout:i("Mutation")("updateDebugRigelLayout"),updateDebugContentCameraSharing:i("Mutation")("updateDebugContentCameraSharing"),triggerDebugCallingScreenGalleryTypeChange:i("Mutation")("triggerDebugCallingScreenGalleryTypeChange"),toggleVoiceLevel:i("Mutation")("toggleVoiceLevel"),setDebugDevicesList:i("Mutation")("setDebugDevicesList"),setPrejoinState:i("Mutation")("setPrejoinState"),triggerSubscribedCallChangedDebugEvent:i("Mutation")("triggerSubscribedCallChangedDebugEvent"),setAcceptStreamPermissionsDebugResponse:i("Mutation")("setAcceptStreamPermissionsDebugResponse"),setStreamPermissionsDebugAcknowledged:i("Mutation")("setStreamPermissionsDebugAcknowledged"),setStreamPermissionsDebugAcknowledgedRequired:i("Mutation")("setStreamPermissionsDebugAcknowledgedRequired"),setCallingScreenStatus:i("Mutation")("setCallingScreenStatus"),setCallingScreenLayout:i("Mutation")("setCallingScreenLayout"),setPinnedParticipantIds:i("Mutation")("setPinnedParticipantIds"),setVideoScanType:i("Mutation")("setVideoScanType"),updateCaptionFontSize:i("Mutation")("updateCaptionFontSize"),setDebugDeviceBlurringCapability:i("Mutation")("setDebugDeviceBlurringCapability"),triggerBluetoothStateChangedDebugEvent:i("Mutation")("triggerBluetoothStateChangedDebugEvent"),toggleDebugVideoEffect:i("Mutation")("toggleDebugVideoEffect"),updateMeetingLockDebug:i("Mutation")("updateMeetingLockDebug"),updateSelectedVideoEffectsInfo:i("Mutation")("updateSelectedVideoEffectsInfo"),setShouldShowVideoApp:i("Mutation")("setShouldShowVideoApp"),setVideoAppPostMessageEvent:i("Mutation")("setVideoAppPostMessageEvent"),setShouldRefreshVideoFilters:i("Mutation")("setShouldRefreshVideoFilters"),toggleParticipantPin:i("Mutation")("toggleParticipantPin")}}}(e),Gu(e),nl,rd.D,sd.w,id,Oc,ld.s,Ku.s)}(e),Gh._clientResolvers}static get clientResolvers(){return Gh._clientResolvers}}Gh._clientResolvers=null;const qh=(e,t,n,i)=>{const a=(0,Hs.a)({leakDetector:e,typePolicies:dc(),possibleTypes:Ws.g_h,dataIdFromObject:Bs.X,resultCachMaxSize:i}),o=(0,Hs.n)({leakDetector:e,cache:a,link:$s.i0.from(t),resolvers:n,defaultOptions:{watchQuery:{nextFetchPolicy:uc}}});return al(a),o};function Jh(e,t){var n;const i=Object.assign(Object.assign({},t),{pubsub:e.getServices().pubsub,send:(0,da.UZ)(Us.l,t.networkState.observeIsOnline())}),a=nc.links,o=Gh.clientResolvers;if(!a||!o)throw new Error("Links and client resolvers should be created at this point");const{maxApolloResultCacheSize:r}=t.coreSettings.get(b.J.Core),s=null!=r?r:void 0,l=null===(n=t.leakDetectorService)||void 0===n?void 0:n.create(),c=qh(l,a,o,s),d=zh(i,c),u=((e,t)=>{const n=(0,Ls.v)(((t,n)=>Object.assign(Object.assign({},e),n)));return t.unshift(n),$s.i0.from(t)})(d,a);return e.updateContext(d,u),c.setLink(u),e}function Kh(e,t){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{networkState:n,coreSettings:i,leakDetectorService:a}=e,o=new Os.pS,r=(0,da.UZ)(Us.l,n.observeIsOnline()),s=Object.assign(Object.assign({},e),{pubsub:o,send:r}),l=Gh.create(o),c=function(e){return Object.assign(Object.assign({},e),Vh(e))}(s),d=yield nc.create(Object.assign({contextValue:c},s)),u=Qh(e,o),{enableSingleApolloCoreCache:m,maxApolloResultCacheSize:p}=i.get(b.J.Core),g=null!=p?p:void 0,h=null==a?void 0:a.create();if(m){const e=qh(h,d,l,g);return new Ys({pubsub:o,leakDetector:h},e,u,t)}return new Js({pubsub:o,leakDetector:h},(()=>qh(h,d,l,g)),u)}))}const Qh=(e,t)=>{const{appsRegistryService:n,appStateService:i,authenticationService:a,authenticationUser:o,cacheStorage:r,clientPreferences:s,clientState:l,commandReportingService:c,coreSettings:d,discover:u,experienceChangeReportingService:m,hostCommunicationService:p,leakDetectorService:g,localStorage:h,loggerFactory:v,offlineCacheManager:f,platformService:y,rebootService:k,scenarioFactory:b,userBiService:_,windowProvider:C}=e;return{appsRegistryService:n,appStateService:i,authenticationService:a,authenticationUser:o,cacheStorage:r,clientPreferences:s,clientState:l,commandReportingService:c,coreSettings:d,discover:u,experienceChangeReportingService:m,hostCommunicationService:p,leakDetectorService:g,localStorage:h,loggerFactory:v,offlineCacheManager:f,platformService:y,pubsub:t,rebootService:k,scenarioFactory:b,userBiService:_,windowId:S.ew,windowProvider:C}};class Yh{constructor(){this.id=S.Yg.CreateDataClient}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const t=new xs;e.dataCleanupService=t,e.client=yield Kh(e,t)}))}}const Xh=["/l/claim","/l/invite","/meet","/l/meetup-join"];var Zh;!function(e){e.core="core",e.flyout="flyout",e.default="default"}(Zh||(Zh={}));var ev=n(887143),tv=n(972124);const nv=new Map,iv=/^\/|\/$/g;function av(e){if(!e||0===e.length)return;const t=nv.get(e);if(t)return t;const n=e.replace(iv,"");if(0===n.length)return;const i=n.split("/");try{let t;if(i){let e=i.length-1;for(;e>=0;){const t=i[e].toLowerCase();if(ne.p[t])break;e--}e>=0&&(t=function(e){let t;switch(e.length){case 3:t={type:rv(e[0]),id:e[1],action:ov(e[2])};break;case 2:{const n=e[1].toLowerCase();t=ne.u[n]?{type:rv(e[0]),action:ov(e[1])}:{type:rv(e[0]),id:e[1],action:ne.u.view};break}default:throw new Error("Invalid entity fragment format found. Valid type, id or action is required.")}return t}(i.splice(e)))}return nv.size<=1e3&&t&&nv.set(e,t),t}catch(e){throw new Error(`Unable to parse path into proper command. ${e.message}`)}}function ov(e){return e.toLowerCase()}function rv(e){return e.toLowerCase()}function sv(e,{clientLaunchId:t,correlation:n},i){return{intent:{entityCommand:vt({entity:e,command:{visibilityState:be.fe.show,stateTransition:be.su.flush,layoutMode:i,correlation:n}}),metadata:{allowAnonymous:!1}},clientLaunchId:t}}function lv(e,t,n,i,a,o,r,s,c,d){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const l=Zh[n];if(l){let e;switch(o.log(`Static deeplink: ${l}`),n){case Zh.flyout:e=sv({type:ne.p.flyout,action:ne.u.default},i,be.lO.minimal);break;case Zh.default:if(!d)throw new Error("A default command for a desktop deeplink navigation set to 'default' should be defined.");e=sv(d,i,be.lO.standard);break;case Zh.core:}return uv(c,i.correlation.id,l,null==e?void 0:e.intent.entityCommand.entity.type,null==e?void 0:e.intent.entityCommand.entity.action),e}return cv(function(e){return decodeURIComponent(e).replace(/[^A-Za-z0-9/.?&=#\-,_:@{}"]/g,"")}(n),i,t,e,a,o,r,s,c,d)}))}function cv(e,t,n,i,a,o,r,s,c,d){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const u=new URL(e,n.get(b.J.Host).deepLinkDomain||void 0);!function(e,t,n,i){const{pathname:a,search:o}=i,r="/"===a[0]?a.substr(1):a,s=Xh.find((e=>{const t="/"===e[0]?e.substr(1):e;return r.startsWith(t)}));if(!s)return;const l={};l["DataBag.joinLinkType"]=s.toString();const c=new URLSearchParams(o);l["DataBag.deeplinkId"]=c.get("deeplinkId"),l["DataBag.joinLinkVariant"]=c.get("v"),e.recordPanelAction({actionGesture:Oo.uS.open,actionOutcome:Oo.$K.open,actionScenario:Oo.Tk.deeplink,actionScenarioType:Oo.Yu.deeplink,moduleType:Oo.PO.deeplink,moduleName:Oo.rA.deeplinkService,panelType:n?Oo.wh.Internal:Oo.wh.External,dataBag:{id:"",data:Object.assign({},l),dispose:()=>{}}},t)}(r,o,s,u);const{prefixType:m,intent:p,errorCode:g,reason:h}=yield function(e,t,n,i,a,o){var r;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{pathname:s}=n;let l,c,d,u;try{const o="/"===s[0]?s.substr(1):s;let d;for(const t of e.registeredApps){const{match:e,normalizedPrefix:n}=dv(t,o);if(e){d=t,l=n;break}}d&&(c=yield null===(r=null==d?void 0:d.onBeforeDeeplinkParsed)||void 0===r?void 0:r.execute({context:{coreSettings:t,loggerFactory:a},deeplinkUrl:n}),c&&(c.entityCommand.command.correlation=i.correlation))}catch(e){o.error("App delegated deeplink parsing failed",e),d=xe.OnBeforeDeeplinkParsedFailed,u=e.message}return{prefixType:l,intent:c?{intent:c,clientLaunchId:i.clientLaunchId}:void 0,errorCode:d,reason:u}}))}(i,n,u,t,a,o);p?o.log(`Deeplink parsed to intent: { type: ${p.intent.entityCommand.entity.type}, action: ${p.intent.entityCommand.entity.action} }`):o.log("Returning default entity to be executed as fallback");const v=null!=p?p:d?sv(d,t,be.lO.standard):void 0;return uv(c,t.correlation.id,m,null==v?void 0:v.intent.entityCommand.entity.type,null==v?void 0:v.intent.entityCommand.entity.action,g,h),v}))}function dv(e,t){if(e.onBeforeDeeplinkParsed)for(const n of Array.from(e.onBeforeDeeplinkParsed.filter)){const e="/"===n[0]?n.substr(1):n;if(t.startsWith(e))return{match:!0,normalizedPrefix:e}}return{match:!1}}function uv(e,t,n,i,a,o,r){e.addScenarioMark(t,ve.M.DeeplinkParsed,{type:n,mainEntityType:i,mainEntityAction:a,errorCode:o,reason:r}),e.appendScenarioEventData(t,{type:n,mainEntityType:i,mainEntityAction:a})}function mv(e,t,n,i,a,o,r,s,c,d){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const l=a.newLogger("DeeplinkUtilities"),{hash:u}=n,m=hv(n,a);let p;if(m&&u){const n=function(e,t,n,i){const{deepLink:a}=e;let o=a;if(function(e,t){const{deepLink:n,crash:i,reload:a,reloadSource:o}=e;if(i||a){const e=i?"crash":"reload";if(t.log(`Recovering from a ${e}: ${e} QSP present.`),!i&&o&&!function(e){switch(e){case ev.d.ReloadAppTask:case ev.d.RemoveAuthenticatedUserResolver:return!0;default:return!1}}(o))return t.log(`Recovering from a ${e}: Do not restore deeplink for reload source: ${o}`),!1;switch(Zh[n]){case Zh.default:case Zh.core:return!0;case Zh.flyout:return t.log(`Recovering from a ${e}: flyout requested, do not recover a persisted deeplink.`),!1;default:return t.log(`Recovering from a ${e}: new deeplink present, do not recover a persisted one.`),!1}}return!1}(e,i)){const e=function(e,t){const n=e.getAllStoredDeeplinks();let i;return t.registeredApps.forEach((e=>{n[e.manifest.id]&&(i=n[e.manifest.id])})),i}(t,n);e?(o=e,i.log("Found deeplink from the previous session.")):i.log("No deeplink found to restore.")}return t.clear(),o}(m,c,e,l);return p=yield lv(e,t,n,i,a,l,o,r,s,d),p}return m&&(p=yield cv(m.deepLink,i,t,e,a,l,o,r,s)),p||(p=function(e,t,n){const{hash:i,pathname:a}=e;let o,r;if(i&&!(0,j.isEmpty)(i)){const e=i.indexOf("?");o=e>=0?i.substr(0,e):i}else o=a;let s=av(o);s||(s=n);s&&(r=sv(s,t));return r}(n,i,d)),p}))}function pv(e,t){let n=function(e){const{hash:t,search:n}=e;let i=n;if(t&&!(0,j.isEmpty)(t)){const e=t.indexOf("?");e>=0&&(i=t.substr(e+1,t.length-1))}const a=function(e){return(0,tv.Qc)(e||"")}(i);let o;a.correlationId&&a.startTimestamp&&a.source&&(o={id:a.correlationId,startTimestamp:a.startTimestamp,source:a.source});return o}(e);return n=n||mt({scenarioName:A.RG.NavigationCommand,source:t}),n}function gv(e){const{deepLink:t,crash:n,reload:i,source:a,clientId:o}=(0,tv.Qc)(e);return{deepLink:t,crash:"true"===n,reload:"true"===i,source:a&&ev.d[a],clientId:o}}function hv(e,t){const{hash:n,href:i,pathname:a}=e;if(n||i||a)if(n){const{deepLink:e,crash:t,reload:i,source:a}=gv(n);if(e)return{deepLink:e,crash:t,reload:i,reloadSource:a}}else if(i){let e;try{e=decodeURIComponent(i)}catch(e){return void t.newLogger(je).error(`${xe.DecodeURIComponentFailed} ${i}`)}return{deepLink:e,crash:!1,reload:!1,reloadSource:void 0}}}function vv(e,t){var n;return null!==(n=null!=t?t:function(e){const{hash:t}=e;if(t){const{clientId:e}=gv(t);return e}return}(e))&&void 0!==n?n:(0,Be.v4)()}var fv=n(557553);const yv={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"activeWindows"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindows"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},Sv={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"removeWindow"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"removeWindow"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]};var kv,bv;!function(e){e[e.Other=0]="Other",e[e.Main=1]="Main",e[e.Flyout=2]="Flyout"}(kv||(kv={})),function(e){e.MatchingPendingIntentFound="MatchingPendingIntentFound",e.IntentOverridenByOnBeforeAuth="IntentOverridenByOnBeforeAuth",e.IntentOverridenByOnAfterAuth="IntentOverridenByOnAfterAuth"}(bv||(bv={}));class _v{constructor(e,t,n,i,a,o,r){this.appsRegistryService=t,this.coreSettings=n,this.commandHandler=i,this.client=a,this.waitForRenderingContextReady=o,this.commandReportingService=r,this.pendingIntentMap=new Map,this.logger=e.newLogger("IntentService"),this.observeActiveWindows()}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){let t,n;this.logInternal("execute: Original intent:",e.intent);const i=this.getIntentType(e.intent);yield this.cleanupActiveWindowsIfNeeded(i);const a=this.pendingIntentMap.get(i);a&&(t=a.windowId,n=bv.MatchingPendingIntentFound,this.logInternal(`execute: Replacing intent for window id: ${t} with layout type ${i}:`,e.intent)),this.pendingIntentMap.set(i,{input:(0,j.cloneDeep)(e),windowId:t}),this.logInternal("execute: Intent for evaluation:",e.intent),this.commandReportingService.addScenarioMark(e.intent.entityCommand.command.correlation.id,ve.M.IntentReceived,{mainEntityType:e.intent.entityCommand.entity.type,mainEntityAction:e.intent.entityCommand.entity.action,errorCode:n});const{intentExecuted:o,targetWindowId:r}=yield this.executeInternal(e,t);o?(this.logger.log("execute: Intent was not overriden and executed. Removing from state."),this.pendingIntentMap.delete(i)):(this.pendingIntentMap.set(i,{input:(0,j.cloneDeep)(e),windowId:r}),this.logInternal(`execute: updated window ID: ${r}: For pending intent:`,e.intent))}))}checkForPendingIntent(e){var t;return(0,l.__awaiter)(this,void 0,void 0,(function*(){for(const[n,{input:{intent:i,clientLaunchId:a},windowId:o}]of Array.from(this.pendingIntentMap)){const r=(0,j.cloneDeep)(i);if(r){r.entityCommand.command.visibilityState=be.fe.showWithoutFocusing,r.entityCommand.entity.type===ne.p.default&&(this.logger.log("checkForPendingIntent: Translating default entity to a real entity"),r.entityCommand.entity=null!==(t=this.appsRegistryService.getDefaultCommand())&&void 0!==t?t:r.entityCommand.entity),r.entityCommand.command.correlation=e,this.logInternal("checkForPendingIntent: Executing pending intent:",r);const{intentExecuted:i}=yield this.executeInternal({intent:r,clientLaunchId:a},o);i&&(this.logger.log("checkForPendingIntent: Intent was not overriden and executed. Removing from state."),this.pendingIntentMap.delete(n))}}}))}launchMainApp({correlation:e,clientLaunchId:t}){return(0,l.__awaiter)(this,void 0,void 0,(function*(){this.logger.log("launchMainApp"),yield this.execute({intent:{entityCommand:vt({entity:{type:ne.p.default,action:ne.u.default},command:{visibilityState:be.fe.show,stateTransition:be.su.flush,layoutMode:be.lO.standard,correlation:e}}),metadata:{allowAnonymous:!1}},clientLaunchId:t})}))}cleanupActiveWindowsIfNeeded(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){try{switch(e){case kv.Other:const e=this.pendingIntentMap.get(kv.Main);e&&(this.logger.log(`Closing main window with id=${e.windowId}.`),yield this.client.mutate({mutation:Sv,variables:{windowId:e.windowId}}));case kv.Main:const t=this.pendingIntentMap.get(kv.Other);t&&(this.logger.log(`Closing other window with id=${t.windowId}.`),yield this.client.mutate({mutation:Sv,variables:{windowId:t.windowId}}))}}catch(t){this.logger.warn(`cleanupActiveWindowsIfNeeded: Failed to remove window of type ${e}: ${t.message}`)}}))}observeActiveWindows(){this.client.watchQuery({query:yv}).subscribe((e=>{e.loading||e.errors||this.checkAndCleanupIfWindowRemoved(e.data.activeWindows.map((e=>e.id)))}))}checkAndCleanupIfWindowRemoved(e){for(const[t,{input:{intent:n},windowId:i}]of Array.from(this.pendingIntentMap))i&&!e.find((e=>e===i))&&(this.logInternal(`checkAndCleanupIfWindowRemoved: window id: ${i} no longer exists, removing intent:`,n),this.pendingIntentMap.delete(t))}getIntentType(e){return e.entityCommand.entity.type===ne.p.flyout||e.entityCommand.command.layoutMode===be.lO.minimal?kv.Flyout:e.entityCommand.command.layoutMode===be.lO.focus?kv.Other:kv.Main}setWindowIdIfKnown(e,t){if(t){const n=(0,j.cloneDeep)(e.entityCommand);return n.command.stateTransition=be.su.flush,n.command.__UNSAFE_windowId=t,n}return e.entityCommand}executeCommand({intent:e,clientLaunchId:t},n,i){return(0,l.__awaiter)(this,void 0,void 0,(function*(){this.logger.log(`Executing Intent in windowId: ${i}`);const a=this.setWindowIdIfKnown(e,i),o=yield n(a,t);return this.logger.log(`Command execution happened in windowId: ${o}`),o}))}executeInternal({intent:e,clientLaunchId:t},n){return(0,l.__awaiter)(this,void 0,void 0,(function*(){let i,a=this.commandHandler;this.logInternal(`executeInternal: windowId: ${n}: Original intent:`,e);const{intentOverridenByHook:o,targetWindowId:r,errorCode:s}=yield this.evaluateHook("onBeforeIntentAuthenticated",{intent:e,context:{client:this.client,coreSettings:this.coreSettings}},a,n,t);if(i=s,o)return this.logger.log("executeInternal: Intent overriden by onBeforeIntentAuthenticated."),{intentExecuted:!1,targetWindowId:r};const l=yield this.getUserContext();if(l){a=(e,t)=>yt(Object.assign(Object.assign({},l),{entityCommandInput:e,clientLaunchId:t}));const{intentOverridenByHook:o,targetWindowId:r,errorCode:s}=yield this.evaluateHook("onAfterIntentAuthenticated",{intent:e,context:{authenticatedUser:l.authenticationUser,client:l.client,localStorage:l.localStorage,coreSettings:this.coreSettings,experienceChangeReportingService:l.experienceChangeReportingService}},a,n,t);if(s&&(i=s),o)return this.logger.log("executeInternal: Intent overriden by onAfterIntentAuthenticated."),{intentExecuted:!1,targetWindowId:r}}else this.logger.log("executeInternal: user context is not defined - skip execution of onAfterIntentAuthenticated");this.logInternal(`executeInternal: windowId: ${n}: Executing original intent:`,e),this.commandReportingService.addScenarioMark(e.entityCommand.command.correlation.id,ve.M.IntentExecuted,{mainEntityType:e.entityCommand.entity.type,mainEntityAction:e.entityCommand.entity.action,errorCode:i});return{intentExecuted:!0,targetWindowId:yield this.executeCommand({intent:e,clientLaunchId:t},a,n)}}))}getUserContext(){var e,t;return(0,l.__awaiter)(this,void 0,void 0,(function*(){if(null===(t=null===(e=this.coreSettings)||void 0===e?void 0:e.get(b.J.Auth))||void 0===t?void 0:t.enableIntegratedAuthApp){this.logger.log("execute: Waiting for user rendering context creation");try{return yield this.waitForRenderingContextReady(!0)}catch(e){return void this.logger.warn("execute: waitForRenderingContextReady failed, executing original intent.")}}else this.logger.log("execute: Skipping waiting for user rendering context creation")}))}evaluateHook(e,t,n,i,a){var o,r;return(0,l.__awaiter)(this,void 0,void 0,(function*(){let s,l;this.logger.log(`evaluateHook(${e}): windowId: ${i}: Begin evaluation`);for(const c of this.filterMatchingApps(e,t.intent.entityCommand.entity.type)){this.logger.log(`evaluateHook(${e}) - Matching app found: ${c.manifest.id}`);try{switch(e){case"onBeforeIntentAuthenticated":s=yield null===(o=c.onBeforeIntentAuthenticated)||void 0===o?void 0:o.execute(t),l=bv.IntentOverridenByOnBeforeAuth;break;case"onAfterIntentAuthenticated":s=yield null===(r=c.onAfterIntentAuthenticated)||void 0===r?void 0:r.execute(t),l=bv.IntentOverridenByOnAfterAuth;break;default:const n=`evaluateHook(${e}): Unknown hook and options.`;throw this.logger.error(n),new Error(n)}(0,j.isEqual)(s,t.intent)&&(l=void 0)}catch(n){this.logger.warn(`evaluateHook(${e}) windowId: ${i}: - Evaluating hook threw an error: ${n}. Falling back to original intent.`),s=t.intent,l="onBeforeIntentAuthenticated"===e?ve.y.OnBeforeIntentAuthenticatedRejected:ve.y.OnAfterIntentAuthenticatedRejected}if(!s)return this.logger.warn(`evaluateHook(${e}) windowId: ${i}: - Hook overriden to undefined. Stopping further processing`),this.commandReportingService.reportCommandEvent(t.intent.entityCommand.command.correlation.id,ve.M.Failure,{errorInfo:"onBeforeIntentAuthenticated"===e?ve.y.OnBeforeIntentAuthenticatedReturnedUndefined:ve.y.OnAfterIntentAuthenticatedReturnedUndefined}),{intentOverridenByHook:!0,targetWindowId:i};if(!(0,j.isEqual)(s,t.intent)){this.logInternal(`evaluateHook(${e}), windowId: ${i}: - Executing overriden intent:`,s),this.commandReportingService.addScenarioMark(s.entityCommand.command.correlation.id,ve.M.IntentExecuted,{mainEntityType:s.entityCommand.entity.type,mainEntityAction:s.entityCommand.entity.action,errorCode:l});return{intentOverridenByHook:!0,targetWindowId:yield this.executeCommand({intent:s,clientLaunchId:a},n,i),errorCode:l}}}return this.logger.log(`evaluateHook(${e}): windowId: ${i}: Completing evaluation. Intent was not overriden.`),{intentOverridenByHook:!1,targetWindowId:i,errorCode:l}}))}filterMatchingApps(e,t){const n=[];for(const i of this.appsRegistryService.registeredApps){const a=i[e];if(a)for(const e of Array.from(a.filter))"*"!==e&&e!==t||n.push(i)}return n}logInternal(e,t){this.logger.log(`${e} {${t.entityCommand.entity.type}, ${t.entityCommand.entity.action}, ${t.entityCommand.command.layoutMode}, ${t.entityCommand.command.visibilityState}}`)}}class Cv{constructor(e,t,n,i,a,o,r,s,l,c,d,u,m,p){this._waitForRenderingContextReady=a,this._host=o,this._appsRegistryService=r,this._config=s,this._correlation=l,this._scenarioFactory=c,this._userBiService=d,this._commandReportingService=u,this._hostComms=m,this._localStorage=p,this._logger=e.newLogger("DeepLinkService"),this._intentService=new _v(e,this._appsRegistryService,t,n,i,a,this._commandReportingService),this._loggerFactory=e,this._coreSettings=t}init(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){return this._host.addEventListener("hashchange",(()=>{const e=function(e,t,n){return{clientLaunchId:vv(e,n),correlation:pv(e,t)}}(this._host.location,k.D.ExternalCommand);return this._handleUrl(e)})),this._handleUrl({clientLaunchId:vv(this._host.location),correlation:this._correlation})}))}executeFromUrlAsync(e,t){return(0,l.__awaiter)(this,void 0,void 0,(function*(){if(!this._isValidDeepLinkUrl(e))return!1;const n=new URL(e);try{const e={correlation:pv(n,k.D.InternalDeeplink),clientLaunchId:t};t&&this.sendDeeplinkReceivedSignal(e);const i=yield this._getNavigationIntentAsync(n,!0,e);return!!i&&(yield this._intentService.execute(i),!0)}catch(t){const n=`DeepLink:: ${xe.ToNavigationIntentFailed} ${e} ${(0,P.u4)(t)}`;throw new Error(n)}}))}checkForPendingIntent(e,t){const n=mt({source:e,scenarioName:A.RG.NavigationCommand});return t&&this.sendDeeplinkReceivedSignal({clientLaunchId:t,correlation:n},"pendingIntent"),this._intentService.checkForPendingIntent(n)}launchMainApp(e,t){const n={correlation:mt({source:e,scenarioName:A.RG.NavigationCommand}),clientLaunchId:t};return n.clientLaunchId&&this.sendDeeplinkReceivedSignal(n,"default"),this._intentService.launchMainApp(n)}_handleUrl(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const t=this._host.location,n=this._scenarioFactory.findScenario(A.RG.ClientStart);null==n||n.mark(A.ck.CoreDeeplinkProcessingStart),e.correlation.scenarioName&&e.clientLaunchId&&this.sendDeeplinkReceivedSignal(e);const i=this._config.shouldExecuteDefaultCommand?this._getDefaultEntity():void 0,a=yield this._getNavigationIntentAsync(t,!1,e,i);if(yield this._notifyIntentHandled(),!a){this._logger.debug(`DeepLink:: ${Oe.NavigationIntentNotFound}`),yield this._waitForRenderingContextReady(!1);const t=this._scenarioFactory.findScenario(A.RG.ApplicationLaunchTime);return null==t||t.stop({reason:"nrc_background_launch",mainEntityType:ne.p.noux}),null==n||n.appendEventData({systemInitiated:!0,mainEntityType:"none"}),null==n||n.mark(A.ck.CoreDeeplinkProcessingStop),null==n||n.stop(),void this._commandReportingService.reportCommandEvent(e.correlation.id,ve.M.Blanked)}return null==n||n.mark(A.ck.CoreDeeplinkProcessingStop,{mainEntityType:a.intent.entityCommand.entity.type,mainEntityAction:a.intent.entityCommand.entity.action}),this._intentService.execute(a)}))}_isValidDeepLinkUrl(e){try{new URL(e)}catch(t){return this._logger.error(`DeepLink:: ${xe.InvalidDeepLinkUrl}${e}`),!1}return!0}_getDefaultEntity(){return{action:ne.u.default,type:ne.p.default}}_notifyIntentHandled(){var e;return(0,l.__awaiter)(this,void 0,void 0,(function*(){try{const t=yield this._hostComms.loadModule("core");yield null===(e=null==t?void 0:t.intentHandled)||void 0===e?void 0:e.call(t)}catch(e){this._logger.warn("Failed to notify host that intent was handled")}}))}_getNavigationIntentAsync(e,t,n,i){return(0,l.__awaiter)(this,void 0,void 0,(function*(){let a;try{a=yield mv(this._appsRegistryService,this._coreSettings,e,n,this._loggerFactory,this._userBiService,t,this._commandReportingService,new fv.I(this._localStorage),i)}catch(e){this._logger.error(`DeepLink:: ${xe.ToNavigationIntentFailed}`)}return a}))}sendDeeplinkReceivedSignal({clientLaunchId:e,correlation:t},n){this._commandReportingService.registerNavigationCommandStart(e,t),this._commandReportingService.addScenarioMark(t.id,ve.M.DeeplinkReceived),this._commandReportingService.appendScenarioEventData(t.id,{type:n,commandSource:t.source,scenarioPhase:"Core"})}}class wv{constructor(){this.id=S.Yg.CreateDeeplinkService}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{loggerFactory:t,windowProvider:n,appsRegistryService:i,config:a,correlation:o,commandHandler:r,coreSettings:s,client:l,scenarioFactory:c,userBiService:d,commandReportingService:u,localStorage:m,hostCommunicationService:p,waitForRenderingContextReady:g}=this.validateContext(e);e.deeplinkService=new Cv(t,s,r,l,g,n,i,a,o,c,d,u,p,m)}))}validateContext(e){const{loggerFactory:t,windowProvider:n,appsRegistryService:i,config:a,correlation:o,commandHandler:r,coreSettings:s,client:l,scenarioFactory:c,userBiService:d,commandReportingService:u,localStorage:m,hostCommunicationService:p,waitForRenderingContextReady:g}=Ko("CreateDeeplinkServiceTask",e,"loggerFactory","windowProvider","appsRegistryService","config","commandHandler","commandReportingService","coreSettings","correlation","client","scenarioFactory","userBiService","commandReportingService","localStorage","hostCommunicationService","waitForRenderingContextReady");return{loggerFactory:t,windowProvider:n,appsRegistryService:i,config:a,correlation:o,commandHandler:r,coreSettings:s,client:l,scenarioFactory:c,userBiService:d,commandReportingService:u,localStorage:m,hostCommunicationService:p,waitForRenderingContextReady:g}}}const Tv="default";class Ev{constructor(){this.id=S.Yg.CreateCacheStorageAndOfflineCacheManager}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{windowProvider:t}=e;e.cacheStorage=new Ta(t.caches,Tv,Tv,e.config.experienceName),e.offlineCacheManager=new Ea(e.cacheStorage,e.loggerFactory)}))}}const Iv="tmp";class Nv{constructor(e,t,n,i){this.tid=e,this.oid=t,this.experienceName=n,this.windowProvider=i}set(e,t,n=S.fO.UserAndExperience){const i=this.getFormatKey(e,n);return this.windowProvider.localStorage.setItem(i,t)}setSafe(e,t,n=S.fO.UserAndExperience){try{return this.set(e,t,n),!0}catch(e){return!1}}get(e,t=S.fO.UserAndExperience){const n=this.getFormatKey(e,t);return this.windowProvider.localStorage.getItem(n)}remove(e,t=S.fO.UserAndExperience){const n=this.getFormatKey(e,t);return this.windowProvider.localStorage.removeItem(n)}clear(e){if(e){const t=e.map((e=>this.getFormatKey("",e)));Object.keys(this.windowProvider.localStorage).filter((e=>e.startsWith(Iv)&&t.some((t=>e.startsWith(t))))).forEach((e=>this.windowProvider.localStorage.removeItem(e)))}else this.windowProvider.localStorage.clear()}UNSAFE_TransferFromPartitionedStorage(e,t,n){const i=this.windowProvider.localStorage.getItem(e);return!(i&&!this.setSafe(t,i,n))&&(this.windowProvider.localStorage.removeItem(e),!0)}getFormatKey(e,t){switch(t){case S.fO.Experience:return`tmp.${this.experienceName}.${e}`;case S.fO.User:return`tmp.${this.tid}.${this.oid}.${e}`;case S.fO.Global:return`tmp.${e}`;case S.fO.UserAndExperience:default:return`tmp.${this.tid}.${this.oid}.${this.experienceName}.${e}`}}}const Av="default";class Mv{constructor(){this.id=S.Yg.CreateLocalStorage}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{windowProvider:t}=e;e.localStorage=new Nv(Av,Av,e.config.experienceName,t)}))}}class Fv{constructor(){this.id=S.Yg.DisableExperience}execute(e){var t,n,i;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const a=null===(n=null===(t=e.platformService)||void 0===t?void 0:t.config)||void 0===n?void 0:n.browser,o=null===(i=e.coreSettings)||void 0===i?void 0:i.get(b.J.Core).supportedBrowsers;if(a&&o){if(!!!(null==o?void 0:o.find((e=>e===a))))throw(0,Z.Tr)(S.w5.Core,S.jK.Disabled,"DisableUnsupportedBrowsersTask",void 0,`Browser "${a}" is not supported.`)}else if(!a){e.loggerFactory.newLogger("DisableUnsupportedBrowsersTask").warn("Unable to detect Browser.")}}))}}var Rv=n(226658),Pv=n(926353),Dv=n(772635),jv=n(524130),xv=n(70941),Ov=n(144680);const Lv="Login Rate limit exceeded",Uv={AdminUserLicenseNotPresentForbidden:"AdminUserLicenseNotPresentForbidden",AdminTeamsDisabledForTenantForbidden:"AdminTeamsDisabledForTenantForbidden",UserLicenseNotPresentForbidde:"UserLicenseNotPresentForbidde",TeamsDisabledForTenantForbidden:"TeamsDisabledForTenantForbidden",UserLicenseNotPresentTrialEligible:"UserLicenseNotPresentTrialEligible",TrialLicenseTenantNotReady:"TrialLicenseTenantNotReady",NewFederatedUsersNotAllowed:"NewFederatedUsersNotAllowed"},Bv=(e,t)=>(t<0||Date.now()-t>=vo.gT.MILLISECONDS_PER_HOUR)&&((0,Z.o7)(e)||[ms.qb.THROTTLED,ms.qb.NOT_AUTHORIZED,-1].indexOf(e)>-1),Wv=(e,t,n,i,a)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){var o;const r=(0,jv.uc)(i),{serverResponse:{status:s,body:l}={}}=e;null==r||r.appendEventData({statusCode:s}),(0,Z.o7)(null!=s?s:0)?null==r||r.fail({message:(0,pa.VK)(e),errorCode:S.jK.ServiceUnavailable,statusCode:s}):-1!==s?((null===(o=l.message)||void 0===o?void 0:o.indexOf(Lv))>-1&&(null==r||r.incomplete({message:(0,pa.VK)(e),errorCode:Lv,statusCode:s}),a.error(`DiscoverRetryPolicy: Delaying skype token fetch for ${Ov.b3.DEFAULT_SKYPE_TOKEN_COOL_OFF_PERIOD}' .`),(0,Lo._)(Ov.b3.DEFAULT_SKYPE_TOKEN_COOL_OFF_PERIOD)),yield Hv(e,t,n,i,a)):null==r||r.incomplete({message:(0,pa.VK)(e),errorCode:S.jK.TimedOut,statusCode:s})})),Hv=(e,t,n,i,a)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){var o,r;const s=(0,jv.uc)(i),{serverResponse:{status:l,body:c,headers:d}={}}=e;let u;try{const e=yield c.json();u=null===(o=null==e?void 0:e.error)||void 0===o?void 0:o.code}catch(e){a.error(`Body jsonify failed: ${e}`)}switch(a.error(`Getting errorCode: [${u}] from response`),l){case ms.qb.NOT_AUTHORIZED:yield Vv(d,n,a,null===(r=t.options)||void 0===r?void 0:r.userIdentifier),null==s||s.incomplete({message:(0,pa.VK)(e),errorCode:null!=u?u:S.jK.Unauthorized,statusCode:l});break;case ms.qb.FORBIDDEN:((e,t)=>e===ms.qb.FORBIDDEN&&!!t&&t in Uv)(l,u)&&$v(u,t,i),null==s||s.cancel({message:(0,pa.VK)(e),errorCode:null!=u?u:S.jK.Forbidden,statusCode:l});break;case ms.qb.THROTTLED:default:null==s||s.incomplete({message:(0,pa.VK)(e),errorCode:null!=u?u:S.jK.Throttled,statusCode:l})}})),$v=(e,t,n)=>{const i=(0,jv.uc)(n);if(e===Uv.NewFederatedUsersNotAllowed)return t.headerUpdate||(t.headerUpdate={strongConsistencyValue:(a=Ov.vu.strongConsistencyMsInternalUserSignup,Ov.vu.strongConsistencyDefaultValue.replace("{id}",a))}),void(null==i||i.mark(Uv.NewFederatedUsersNotAllowed));var a;e===Uv.UserLicenseNotPresentTrialEligible?(null==i||i.mark(Uv.UserLicenseNotPresentTrialEligible),t.lastLicenseErrorTime=-1):t.lastLicenseErrorTime=Date.now()},Vv=(e,t,n,i)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){var a;e&&0!==(null===(a=Object.keys(e))||void 0===a?void 0:a.length)?yield t(e,i):n.error("DiscoverUnauthorizeError: header is empty")}));const zv=(e,t,n,i)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){return Gv(e,t,qv)({policy:n,delay:n.createDelay(),retryCount:0,retriesTable:{},startTime:Date.now().valueOf(),forever:n.foreverCheck,headerUpdate:void 0,lastLicenseErrorTime:-1,options:{userIdentifier:null!=i?i:void 0}})})),Gv=(e,t,n)=>i=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){for(var a;;){const o=t;(null===(a=i.headerUpdate)||void 0===a?void 0:a.strongConsistencyValue)&&(o.headers||(o.headers={}),o.headers.ConsistencyLevel=i.headerUpdate.strongConsistencyValue);try{return yield e(o)}catch(e){yield n(e,i)}}})),qv=(e,t)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){if(!e.serverResponse)throw e;const n=!(yield t.forever()),{serverResponse:{status:i}}=e;if(-1!==t.startTime&&Date.now().valueOf()-t.startTime>=t.policy.retryMaxTimeMs&&(t.startTime=-1,t.policy.retryMaxTimeCallback(n)),i&&t.policy.isOnline()&&(t.retryCount++<t.policy.maxRetryCount&&!n||n)&&t.policy.shouldRetry(i,t.lastLicenseErrorTime))return t.retriesTable[i]=(t.retriesTable[i]||0)+1,t.policy.errorHandler(e,t);throw e}));var Jv=n(238091),Kv=n(547514),Qv=n(149073),Yv=n(738051);class Xv{constructor(e,t,n,i,a,o,r,s,d,u,m,p,g=(0,F.J)()){var h,v,f,y,k;this._authenticationService=e,this._coreSettings=i,this._scenarioFactory=a,this._networkStateProvider=o,this._authStateProvider=r,this.onDiscoverSuccess=s,this.onDiscoverFail=d,this.isCDLWorker=u,this.cdlAuthClient=m,this.platformService=p,this.globalScope=g,this._skypeToken=new c.X(null),this._localStorageKeys=[],this.clearDiscoveryCacheForLogout=e=>(0,l.__awaiter)(this,void 0,void 0,(function*(){const t=(0,Jv.Xx)(e);this.clearDiscoveryCache(t,["^fn:clearDiscoveryCacheForLogout"])})),this.clearDiscoveryCache=(e,t,n)=>{this._logger.log(`[clearDiscoveryCache] start clearing discover cache. tokenOnly: ${!!n}`),this._skypeToken=new c.X(null),ua.J.del((0,jv.Z2)(e)),null==t||t.push("skypeCacheClear"),n||(ua.J.del((0,jv.Mu)(e)),null==t||t.push("userDetailsCacheClear"),ua.J.del((0,jv.S9)(e)),null==t||t.push("regionGtmsCacheClear")),this._clearFromLocalStorage(n),null==t||t.push("localstorageCacheClear"),this._logger.log(`[clearDiscoveryCache] Discover cache cleared, tokenOnly: ${!!n}.`)},this._getUserIdentifier=e=>(0,l.__awaiter)(this,void 0,void 0,(function*(){const t=(0,pa.pW)();null==e||e.push("fn:getuid");const n=yield this._authenticationService.getUser({correlationId:t});if(null==e||e.push("user:"+ +!!n),n){this._logger.log(`[_getUserIdentifier][${t}]user found by getUser call`);return(0,Jv.Xx)(n)}const i=`[_getUserIdentifier] User missing cannot perform action. ${null==e?void 0:e.join(";")}`;throw this._logger.warn(i),(0,Kv.Tr)({context:Ov.xm,subContext:"_getUserIdentifier",errorCode:ga.SM.UserNotFoundError,isExpected:!0,message:i,correlationId:null!=t?t:(0,pa.pW)()})})),this._getDiscoverResponse=e=>(0,l.__awaiter)(this,void 0,void 0,(function*(){var t,n;const{correlationId:i=(0,pa.pW)(),eventData:a=[]}=e;null==a||a.push("_getDiscoverResponse|startScenario");const o=this._scenarioFactory.newScenario(A.RG.GetSkypeToken);let r,s;this._logger.log(`[_getDiscoverResponse][${i}] Start request`);try{if(!this._isAppOnline())throw(0,Kv.Tr)(Object.assign(Object.assign({},jv.bO),{correlationId:i}));s=(0,jv.wF)(o,e,this._coreSettings,this.globalScope),r=yield this._discoverProvider(Object.assign(Object.assign({},e),{eventData:a}))}catch(e){throw null===(t=this._authStateProvider)||void 0===t||t.reportSkypeTokenState(ba.QI.Failure),null==a||a.push("authState:0"),this.onDiscoverFail&&this.onDiscoverFail(!!this._bootstrapData),(0,jv.lm)(e,a,this._isAppOnline(),o,this._logger,this._coreSettings,this.platformService)}finally{(0,jv._1)(s,this.globalScope)}null===(n=this._authStateProvider)||void 0===n||n.reportSkypeTokenState(ba.QI.Success);const l=(0,jv.ZC)(r,this._logger);this._setSkypePropertiesInCache(e.userIdentifier,l,a,i);const c=yield this._getUserIdentifier();return(null==e?void 0:e.userIdentifier)&&c&&(0,Jv.FG)(null==e?void 0:e.userIdentifier,c)||!(null==e?void 0:e.userIdentifier)?this._skypeToken.next(r.skypeToken):this._logger.error(`[_getDiscoverResponse][${i}] option uid:${null==e?void 0:e.userIdentifier}`),null==o||o.stop({reason:a.join(";")}),this.onDiscoverSuccess&&this.onDiscoverSuccess(),this._logger.log(`[_getDiscoverResponse][${i}] Finished setting skype properties in cache.`),r})),this._setSkypePropertiesInCache=(e,t,n,i)=>{ua.J.put((0,jv.Mu)(e),t.userDetails),null==n||n.push("userDetails:1"),ua.J.put((0,jv.Z2)(e),t),null==n||n.push("skypeToken:1"),(null==t?void 0:t.regionGtms)?(ua.J.put((0,jv.S9)(e),null==t?void 0:t.regionGtms),null==n||n.push("regionGtms:1")):(null==n||n.push("regionGtms:-1"),this._logger.error(`[_getDiscoverResponse][${i}] RegionGtm is missing in response, not able to cache.`))},this._isSkypeTokenValidInMemory=e=>(0,l.__awaiter)(this,void 0,void 0,(function*(){const t=null!=e?e:yield this._getUserIdentifier();return!!ua.J.getValue((0,jv.Z2)(t))})),this._retryMaxTimeCallback=e=>{var t;return e?(null===(t=this._authStateProvider)||void 0===t||t.reportSkypeTokenState(ba.QI.Failure),this._logger.error("[_retryMaxTimeCallback]Reporting skype token failure to authState"),!1):(this._logger.warn("[_retryMaxTimeCallback] Reached retry max time."),!1)},this._getResponseFromLocalStorage=(e,t)=>{if(!t||!e)return;const n=this._getFromLocalStorage(e,t,"auth.gtm.table"),i=this._getFromLocalStorage(e,t,"auth.skype.token");return n&&i?Object.assign(Object.assign({},i.userDetails),{skypeToken:i.skypeToken,expires:new Date(i.expiration),regionGtms:n}):void 0},this._getCachedResponseWrapper=e=>(0,l.__awaiter)(this,void 0,void 0,(function*(){var t,n;return this._getResponseFromLocalStorage(null===(t=null==e?void 0:e.profile)||void 0===t?void 0:t.oid,null===(n=null==e?void 0:e.profile)||void 0===n?void 0:n.tid)})),this._acquireSkypeTokenWeb=e=>(0,l.__awaiter)(this,void 0,void 0,(function*(){var t,n,i,a,o;null===(t=e.eventData)||void 0===t||t.push("fn:_acquireSkypeTokenWeb");let r=yield this._authenticationService.getUser({userIdentifier:e.userIdentifier,correlationId:e.correlationId});if(null===(n=e.eventData)||void 0===n||n.push("user:"+ +!!r),null===(i=e.eventData)||void 0===i||i.push("uid:"+ +!!e.userIdentifier),!r){if(r=yield this._authenticationService.getUser({correlationId:e.correlationId}),!r)throw(0,Kv.Tr)({context:Ov.xm,subContext:"_acquireSkypeTokenWeb",errorCode:ga.SM.UserNotFoundError,message:"User not found for provided userIdentifier nor globally.",correlationId:e.correlationId,isExpected:!1});(0,jv.nD)(e,r,this._logger)}const s=yield this._getCachedResponseWrapper(r);if(s)return null===(a=e.eventData)||void 0===a||a.push("cache:1"),s;this._appendPhoneAccrualEventData(e.eventData);const l=(0,jv.TB)(r,e.correlationId,this._coreSettings,this._logger,this.platformService),c=this._scenarioFactory.findScenario(A.RG.GetSkypeToken);null==c||c.mark(Ov.j.SKYPE_SEND_REQUEST,(0,jv.nd)(e.eventData,this._isAppOnline(),this._coreSettings));const d=yield this.send({userIdentifier:e.userIdentifier,correlationId:e.correlationId})(l);return null===(o=e.eventData)||void 0===o||o.push("response:1"),null==c||c.mark(Ov.j.SKYPE_RECEIVED_RESPONSE,(0,jv.nd)(e.eventData,this._isAppOnline(),this._coreSettings)),c&&(c.eventData.authzCorrelationId=d.headers["correlation-id"],c.eventData.correlationTags=d.headers["correlation-tags"],c.eventData.correlationId=null==e?void 0:e.correlationId),(0,jv.Qe)(d,e,this._logger)})),this._appendPhoneAccrualEventData=e=>{const{authzResource:t,disablePhoneAccrualSkip:n}=this._coreSettings.get(b.J.Auth);null==e||e.push(`cache:0;authZResource:${t};HasPhoneAccHeader:${+!n}`)},this._acquireSkypeTokenDesktop=e=>(0,l.__awaiter)(this,void 0,void 0,(function*(){var t,n,i,a;null===(t=e.eventData)||void 0===t||t.push("fn:_acquireSkypeTokenDesktop");const o=yield this._authenticationService.getUser({userIdentifier:e.userIdentifier,correlationId:e.correlationId}),r=yield this._getCachedResponseWrapper(o);if(r)return r;null===(n=e.eventData)||void 0===n||n.push("cache:0");const s=this._scenarioFactory.findScenario(A.RG.GetSkypeToken);null==s||s.mark(Ov.j.SKYPE_SEND_REQUEST_DESKTOP);const l=yield this.globalScope.opener.requestMessage(R.rY.GetStateData,{requestType:"skypeToken",timeout:vo.lP.ACQUIRE_TOKEN_TIMEOUT});null==s||s.mark(Ov.j.SKYPE_RECEIVED_RESPONSE),this._logger.log(`[_acquireSkypeTokenDesktop][${null==e?void 0:e.correlationId}] Response parsed succeed.`);const c=null==l?void 0:l.skypeTokenData;s&&(s.eventData.correlationId=null==l?void 0:l.correlationId);return{userId:(0,jv.LO)(null===(i=null==c?void 0:c.token)||void 0===i?void 0:i.skypeToken,this._logger),userDetails:null==c?void 0:c.userDetails,skypeToken:null===(a=null==c?void 0:c.token)||void 0===a?void 0:a.skypeToken,regionGtms:null==c?void 0:c.regionGtms,expires:new Date(null==c?void 0:c.token.expiration)}})),this._acquireSkypeTokenWorker=e=>(0,l.__awaiter)(this,void 0,void 0,(function*(){const{eventData:t}=e;if(t.push("fn:_acquireSkypeTokenWorker"),!this.cdlAuthClient)throw(0,Kv.Tr)({context:Ov.xm,subContext:"_acquireSkypeTokenWorker",errorCode:S.jK.NotPresent,message:"CDL worker auth client unavailable",correlationId:e.correlationId,isExpected:!1});const n=!1!==e.forceRenew,i=this._scenarioFactory.findScenario(A.RG.GetSkypeToken);null==i||i.mark(Ov.j.SKYPE_SEND_REQUEST_WORKER);const a=yield this.cdlAuthClient.getSkypeToken(n);return null==i||i.mark(Ov.j.SKYPE_TOKEN_RECEIVED_WORKER),Object.assign(Object.assign({userId:(0,jv.LO)(a.skypeToken,this._logger)},a.userDetails),{skypeToken:a.skypeToken,regionGtms:a.regionGtms,expires:new Date(a.expiration)})})),this._getRetryForSend=e=>{const{authzResource:t,disableRetryInDiscoverV2:n}=this._coreSettings.get(b.J.Auth);return i=>{var a;if(!this._authenticationService.authorizeV2)throw(0,Kv.Tr)({context:Ov.xm,subContext:"_getRetryForSend",errorCode:"AuthorizeV2NotFound",message:"AuthorizeV2 endpoint not accessible",correlationId:null!==(a=i.correlationId)&&void 0!==a?a:(0,pa.pW)(),isExpected:!1});const o=this._authenticationService.authorizeV2.bind(this._authenticationService),r=()=>(0,Dv.B)(o(e,t||vo.ej.MT_AAD_KEY,{userIdentifier:i.userIdentifier}),ms.qb.OK);return n?r():function(e,t,n){return i=>zv(e,i,t,n)}(r(),((e,t,n,i,a,o)=>({shouldRetry:Bv,errorHandler:(i,a)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const o=(0,jv.uc)(t),{serverResponse:{status:r,headers:s}={}}=i;if(!r||!a.retriesTable[r])throw i.reason=Object.assign(Object.assign({},i.reason),{scenarioStep:"fail"}),i.message=`dicoverRetryPolicy: retry count for ${r} is empty`,i;const l=null==s?void 0:s["correlation-id"],c=null==s?void 0:s["correlation-tags"];null==o||o.appendEventData({authzCorrelationId:l,correlationTags:c}),a.headerUpdate=void 0,yield Wv(i,a,n,t,e),e.error(`[DiscoverRetryPolicy]: retrying '[${a.retryCount}]' times due to response status - '[${r}], wait for '[${a.delay.next()}] for next retry..'`);const d=yield a.forever();if(a.retryCount>=a.policy.maxRetryCount&&d)throw e.log(`[DiscoverRetryPolicy]: maxTimeReached count: ${a.retryCount} and tokenValid, cancel forever`),i.reason=["LoggedAlready"],i;return(0,Lo._)(a.delay.next())})),retryMaxTimeMs:vo.lP.DEFAULT_SKYPE_MAX_RETRY_DURATION_MS,maxRetryCount:vo.lP.DEFAULT_SKYPE_MAX_RETRY_COUNT,createDelay:()=>new xv.df(vo.lP.DEFAULT_SKYPE_MIN_RETRY_INTERVAL_MS,vo.lP.DEFAULT_SKYPE_EXP_DELAY_FACTOR,vo.lP.DEFAULT_SKYPE_MAX_DELAY_TIME_MS),isOnline:i,retryMaxTimeCallback:a,foreverCheck:o}))(this._logger,this._scenarioFactory,this.unauthorizedErrorHandler,this._isAppOnline,this._retryMaxTimeCallback,this._isSkypeTokenValidInMemory),i.userIdentifier)}},this._isRefreshInBackgroundRequired=(e,t,n,i)=>{(null==e?void 0:e.shouldRefresh)?(null==n||n.push("shouldrefreshbg"),this._logger.log(`[getSkypeTokenInfoFromDiscoveryResponse][${i}] Skype token retrieved but needs refresh.`),this._debouncedGetDiscoverResponse((0,P.u4)(t),{userIdentifier:t,correlationId:i,eventData:n}).catch((e=>{this._logger.error(`[getSkypeTokenInfoFromDiscoveryResponse][${i}] Skype token refresh background fail.`),(0,jv.H)(e,null==e?void 0:e.message,n,this._logger)}))):this._logger.log(`[_isRefreshInBackgroundRequired][${i}] No refresh required`)},this._populateDiscoverResponseFromBootstrapdata=()=>{this._bootstrapData=this._coreSettings.get(b.J.Host).authBootstrapData,this._bootstrapData},this._isAppOnline=()=>this._networkStateProvider.getState()===Hi.Online,this.unauthorizedErrorHandler=(e,t)=>(0,l.__awaiter)(this,void 0,void 0,(function*(){const{disableClaimsChallenge:n}=this._coreSettings.get(b.J.Auth);if(n)this._logger.log("[unauthorizedErrorHandler] Claims challenge handling disabled.");else if(e)if(t)ua.J.deleteType(t,"Token");else{const e=yield this._authenticationService.getUser();ua.J.deleteType((0,Jv.Xx)(e),"Token")}else this._logger.log("[unauthorizedErrorHandler] No header passed in.")})),this._logger=t.newLogger(Ov.xm),(0,Qv.g)(this,"DiscoverV2",this._getConfig("mockApi"),this._getConfig("enableMockApi")),this.send=this._getRetryForSend(n),this._debouncedGetDiscoverResponse=(0,Yv.k)(this._getDiscoverResponse),(0,ua.k)(g),this._populateDiscoverResponseFromBootstrapdata(),this._discoverProvider=this.resolveProvider(),null===(v=null===(h=this._authenticationService)||void 0===h?void 0:h.registerCleanUpOnLogoutCallback)||void 0===v||v.call(h,this.clearDiscoveryCacheForLogout),this._tokenObserver=null===(k=null===(y=(f=this._authenticationService).observeMiddleTierToken)||void 0===y?void 0:y.call(f))||void 0===k?void 0:k.subscribe((e=>{void 0===e&&this._getUserIdentifier().then((e=>{e&&ua.J.del((0,jv.Z2)(e))}))})),this._logger.log("[ctor]Service initialized.")}observeSkypeToken(){return this._skypeToken.pipe((0,g.h)((e=>null!==e)))}regionGtm(e,t){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const n=(0,pa.pW)(),i=["^fn:regionGtm:uid:"+ +!!t];try{const a=null!=t?t:yield this._getUserIdentifier(i);let o=ua.J.getValue((0,jv.S9)(a));if(!o){this._logger.log(`[regionGtm][${n}] No cached regionGtm, start network call..`),null==i||i.push("cache:0");const e=yield this._debouncedGetDiscoverResponse((0,P.u4)(a),{userIdentifier:a,correlationId:n,eventData:i});o=null==e?void 0:e.regionGtms,null==i||i.push(`InResponse:${!!o}`)}const r=(0,li.m)(null==o?void 0:o[e]);if(r)return r;throw new Error(`${Ov.xm}[regionGtm][${n}] ${e} not found in regionGtms table`)}catch(e){throw(0,jv.WA)(e,"regionGtm",n),(0,jv.H)(e,null==e?void 0:e.message,i,this._logger)}}))}skypeid(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const t=(0,pa.pW)(),n=["^fn:skypeid:uid:"+ +!!e];try{const n=yield this.getUser(t,e);if(!n)throw this._logger.error(`[skypeid][${t}] No userDetail for getting skypeId`),new Error(`${Ov.xm} No user for getting skypeId`);return n.id}catch(e){throw(0,jv.WA)(e,"skypeid",t),(0,jv.H)(e,null==e?void 0:e.message,n,this._logger)}}))}validateSkypeToken(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){return(yield this.validateSkypeTokenV2(e)).skypeToken}))}validateSkypeTokenV2(e){var t;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const n=(0,pa.pW)(),i=["^fn:validateSkypeToken:uid:"+ +!!(null==e?void 0:e.userIdentifier)];try{const a=null!==(t=null==e?void 0:e.userIdentifier)&&void 0!==t?t:yield this._getUserIdentifier(i),o=ua.J.get((0,jv.Z2)(a)),r=null==o?void 0:o.item;i.push(`cache:${!!r}`);const s=null==e?void 0:e.forceRenew,l=null==e?void 0:e.invalidSkypeToken;if(!s&&r&&r.skypeToken!==l&&r.expiration&&r.expiration>Date.now())return this._isRefreshInBackgroundRequired(o,a,i,n),{skypeToken:r.skypeToken,fromCache:!0};this.clearDiscoveryCache(a,i,!0),this._logger.log(`[validateSkypeToken][${n}] Skype token not valid during ping of forceRenew:${s}, clear old cache and start wire request.`);const c=yield this._debouncedGetDiscoverResponse((0,P.u4)(a),{userIdentifier:a,correlationId:n,eventData:i});return this._logger.log(`[validateSkypeToken][${n}] SkypeToken fetched from network.`),i.push(`InResponse:${!!c.skypeToken}`),{skypeToken:c.skypeToken,fromCache:!1}}catch(e){throw(0,jv.WA)(e,"validateSkypeToken",n),(0,jv.H)(e,null==e?void 0:e.message,i,this._logger)}}))}getRegion(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const t=(0,pa.pW)(),n=["^fn:getRegion:uid:"+ +!!e];try{const i=null!=e?e:yield this._getUserIdentifier(n),a=ua.J.getValue((0,jv.Mu)(i));if(a)return a.region;n.push("cache:0"),this._logger.log(`[getRegion][${t}] No user details found in cache. Getting it from request.`);const o=yield this._debouncedGetDiscoverResponse((0,P.u4)(i),{userIdentifier:i,correlationId:t,eventData:n});return n.push(`InResponse:${!!o.region}`),o.region}catch(e){throw(0,jv.WA)(e,"getRegion",t),(0,jv.H)(e,null==e?void 0:e.message,n,this._logger)}}))}getUser(e=(0,pa.pW)(),t){var n,i;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const a=["^fn:getUser:uid:"+ +!!t];try{const o=null!=t?t:yield this._getUserIdentifier(a);let r=ua.J.getValue((0,jv.Mu)(o));if(r||(this._logger.log(`[getUser][${e}]No cache, start network call...`),a.push("cache:0"),a.push(`IsCDL:${this.isCDLWorker&&this.cdlAuthClient}`),r=this.isCDLWorker&&this.cdlAuthClient?null===(n=yield this.cdlAuthClient.getUserDetails())||void 0===n?void 0:n.userDetails:(0,jv.br)(a,this._bootstrapData,this._logger)||(null===(i=yield this.getSkypeTokenInfoFromDiscoveryResponse({silent:!1,correlationId:e,userIdentifier:t,eventData:a}))||void 0===i?void 0:i.userDetails)),!r)throw new Error(`${Ov.xm}[getUser][${e}] UserDetails fetched failure from network request`);return(0,jv.wC)(r)}catch(t){(0,jv.WA)(t,"getUser",e);const n=(0,jv.H)(t,null==t?void 0:t.message,a,this._logger);throw new va.l(n)}}))}getSkypeTokenInfoFromDiscoveryResponse(e){var t;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{correlationId:n=(0,pa.pW)(),userIdentifier:i}=e||{},a=null!==(t=null==e?void 0:e.eventData)&&void 0!==t?t:[];null==a||a.push("fn:getSkypeTokenInfoFromDiscoveryResponse");try{const t=null!=i?i:yield this._getUserIdentifier(a),o=null==e?void 0:e.forceRenew,r=ua.J.get((0,jv.Z2)(t));let s;if(r&&r.item&&!o)this._isRefreshInBackgroundRequired(r,t,a,n),s=r.item;else{null==a||a.push("cache:0"),this._logger.log(`[getSkypeTokenInfoFromDiscoveryResponse][${n}] No response retrieved from cache.`),this.clearDiscoveryCache(t,a,!0);const i=yield this._debouncedGetDiscoverResponse((0,P.u4)(t),Object.assign(Object.assign({},e),{userIdentifier:t,eventData:a}));s=(0,jv.ZC)(i,this._logger)}return s}catch(e){throw(0,jv.WA)(e,"getSkypeTokenInfoFromDiscoveryResponse",n),(0,jv.H)(e,null==e?void 0:e.message,a,this._logger)}}))}unsubscribeMtToken(){var e;null===(e=this._tokenObserver)||void 0===e||e.unsubscribe()}getConsumerLicenseDetails(e){var t;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const n=(0,pa.pW)(),i=["^fn:getConsumerLicenseDetails:uid:"+ +!!e];try{const a=null!=e?e:yield this._getUserIdentifier();if(!(a.accountType===Pv.C.MsaLife))return this._logger.log(`[getConsumerLicenseDetails][${n}] User account type is not MsaLife.`),Promise.resolve(void 0);const o=ua.J.getValue((0,jv.Mu)(a)),r=null===(t=null==o?void 0:o.licenseDetails)||void 0===t?void 0:t.consumerLicenseDetails;if(r)return r;i.push("cache:0"),this._logger.log(`[getConsumerLicenseDetails][${n}] No user license details found in cache. Getting it from request.`);const s=yield this._debouncedGetDiscoverResponse((0,P.u4)(a),{userIdentifier:a,correlationId:n,eventData:i});return i.push(`InResponse:${!!(null==s?void 0:s.consumerLicenseDetails)}`),null==s?void 0:s.consumerLicenseDetails}catch(e){throw(0,jv.WA)(e,"getConsumerLicenseDetails",n),(0,jv.H)(e,null==e?void 0:e.message,i,this._logger)}}))}_clearFromLocalStorage(e){var t;(null===(t=this.globalScope)||void 0===t?void 0:t.localStorage)&&(e?this._localStorageKeys.forEach((e=>{e.indexOf("auth.skype.token")>-1&&this.globalScope.localStorage.removeItem(e)})):this._localStorageKeys.forEach((e=>{this.globalScope.localStorage.removeItem(e)})),this._localStorageKeys=[])}resolveProvider(){return this._bootstrapData?this._acquireSkypeTokenDesktop:this.isCDLWorker?this._acquireSkypeTokenWorker:this._acquireSkypeTokenWeb}_getFromLocalStorage(e,t,n){var i;if(!(null===(i=this.globalScope)||void 0===i?void 0:i.localStorage))return;let a=`ts.${t}-${e}.${n}`,o=this.globalScope.localStorage.getItem(a);if(o||(a=`ts.${e}.${n}`,o=this.globalScope.localStorage.getItem(a)),o){this._localStorageKeys.push(a);try{return JSON.parse(o)}catch(e){this._logger.error(`[_getFromLocalStorage] ${e}`)}}}_getConfig(e){return this._coreSettings.get(b.J.Auth)[e]}}class Zv{constructor(){this.id=S.Yg.CreateDiscovery}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{onDiscoverSuccess:t,onDiscoverFail:n}=this.getDiscoverCallback(e),{authenticationService:i,loggerFactory:a,coreSettings:o,scenarioFactory:r,appStateService:s,networkState:l,platformService:c,authStateProvider:d}=e,u=(0,da.Gg)(s);e.discover=((e,t,n,i,a,o,r,s,l,c,d,u,m,p,g)=>{const{enableRequireDiscoverV2:h}=i.get(b.J.Auth);return h?new Xv(e,t,n,i,a,r,s,c,d,u,m,p,g):new Rv.Jq(e,t,n,i,a,o,l,c,d,u,m,g)})(i,a,Us.l,o,r,u,l,d,void 0,t,n,void 0,void 0,c)}))}getDiscoverCallback(e){var t;let n,i;return(null===(t=e.platformService)||void 0===t?void 0:t.config.hostingParent)===si.GJ.Outlook&&(n=()=>{e.windowProvider.sessionStorage.removeItem(ba.v4),e.windowProvider.sessionStorage.removeItem(ba.F_)},i=t=>{t||"true"!==e.windowProvider.sessionStorage.getItem(ba.F_)||(e.windowProvider.sessionStorage.setItem(ba.v4,"true"),e.windowProvider.location.reload())}),{onDiscoverSuccess:n,onDiscoverFail:i}}}var ef=n(861937);const tf=({apiName:e,url:t,method:n,body:i,headers:a,cancellationToken:o,credentials:r,timeout:s=3e4},l,c,d)=>{let u;if(o&&(u=c.get(o),null==u?void 0:u.signal.aborted))throw d.log(`Request ${e} is cancelled`),(0,ta.T)(na.A.RequestCancelled);return function(e,t,n){let i;const a=new Promise((e=>{i=t.setTimeout(e,n)}));return Promise.race([e,a.then((()=>{throw(0,ta.T)(na.A.TimedOut)}))]).then((e=>(t.clearTimeout(i),e)))}(ef(t,{method:n,headers:a&&new Headers(a),body:i,signal:u&&u.signal,credentials:r}),l,s).then((e=>{var t;const n={};return null===(t=e.headers)||void 0===t||t.forEach(((e,t)=>n[t]=e)),{status:e.status,headers:n,body:e,url:e.url}}))};function nf(e,t){const n=new WeakSet;return JSON.stringify(e,((e,t)=>{if(!n.has(t)){if(t&&"object"==typeof t){if(n.add(t),t instanceof Map||t instanceof Set)return Array.from(t);if(t instanceof Error)return`${t.name}: ${t.message}`;if(t.constructor&&t.constructor!==Object&&t.constructor!==Array||t.prototype)return}return t}}),t)}const af=(e,t,n)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){try{return yield t(e)}catch(t){throw n.log(`Failed to authorize request: ${nf(e)}`),(0,ta.T)(na.A.AuthFailed)}})),of=(e,t,n,i)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){var a;const o=null===(a=t.operationLogger)||void 0===a?void 0:a.beginStep(ms.nz.AuthResolve,t);try{const i=n(e,t);return i.then((t=>(o&&t&&o(ms.qb[e.status],e),t))),yield i}catch(t){throw i.log(`Failed to resolve claim on response: ${nf(e)}`),(0,ta.T)(na.A.AuthResolveFailed,e)}}));function rf(e,t=ms.qb.NOT_FOUND){return Array.isArray(t)?t.some((t=>sf(e,t))):sf(e,t)}function sf(e,t){return"string"==typeof t?new RegExp(t.replace(/x/gi,"\\d")).test(e.toString()):e===t}const lf=(e,t)=>t.indexOf(e)>-1||t.filter(cf).map((e=>new RegExp(e.replace(/x/gi,"\\d")))).some((t=>t.test(e.toString())));function cf(e){return"string"==typeof e}const df=(e,t,n,{logger:i,globalContext:a})=>o=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){var r,s;let l=yield uf(e)(o);for(let c=0;;c++){const{response:d,message:u,error:m}=l,p=(null==d?void 0:d.status)||(null==m?void 0:m.reason)||na.A.FailedToFetch,g=null==d?void 0:d.headers,h=n.get(p)||0;if(n.set(p,h+1),!t.shouldRetry(c,p,n)){if(m)throw m;return l.response}{const n=t.nextDelay(c,g,p);i.log(`Retrying ${o.apiName} count=${c} with delay ${n}`),null===(r=o.operationLogger)||void 0===r||r.nextStep(ms.nz.RetryDelay,u,void 0,d),yield ia(n,a),null===(s=o.operationLogger)||void 0===s||s.nextStep(ms.nz.Retry,"",o),l=yield uf(e)(o)}}})),uf=e=>t=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){try{const n=yield e(t);return{response:n,message:ms.qb[n.status]}}catch(e){return{response:e.serverResponse,message:e.reason,error:e}}}));const mf=(e,t,n,i)=>{const{logger:a,cancellationMap:o}=n;let r=e;return r=((e,t)=>n=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){try{n.url=new URL(n.url,t.baseUrl).href}catch(e){throw(0,ta.T)(na.A.InvalidUrl)}return e(n)})))(r,t),i&&(r=((e,t,n)=>i=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){var a,o;const r=null===(a=i.operationLogger)||void 0===a?void 0:a.logStep(ms.nz.AuthDecorate),s=yield af(i,t,n);if(r&&r(""),!s)throw(0,ta.T)(na.A.AuthFailed);const l=yield e(s.request),c=yield of(l,s.request,s.resolver,n);return c?(null===(o=c.operationLogger)||void 0===o||o.nextStep(ms.nz.Auth,ms.qb[l.status],c,l),e(c)):l})))(r,i,a)),r=((e,t)=>{if(!t.redirectPolicy)return e;const{maxRedirects:n,useAbsoluteRedirect:i,headers:a,redirectOn:o,onRedirect:r}=t.redirectPolicy;return s=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){var l;const c=Object.assign(Object.assign({},s),{headers:Object.assign(Object.assign({},s.headers),a)});let d=yield e(c);for(let a=0;;a++){const{status:u,headers:{location:m}}=d;if(!(a<n&&rf(u,o)))return d;try{let e;if(r)e=r(m,u);else{if(!m)return d;e=new URL(m)}i?(t.baseUrl=e.origin,c.url=e.pathname):(c.url=s.url,t.baseUrl=e.href)}catch(e){throw(0,ta.T)(na.A.InvalidUrl,d)}null===(l=c.operationLogger)||void 0===l||l.nextStep(ms.nz.Redirect,ms.qb[d.status],c,d),d=yield e(c)}}))})(r,t),t.rejectHttpError&&(r=function(e){return t=>(0,l.__awaiter)(this,void 0,void 0,(function*(){const n=yield e(t);if(n.status>=ms.qb.BAD_REQUEST)throw(0,ta.T)(na.A.RequireStatusFailed,n);return n}))}(r)),t.allowedResponses&&(r=function(e,...t){return n=>e(n).then((e=>{if(lf(e.status,t))return e;throw(0,ta.T)(na.A.RequireStatusFailed,e)}))}(r,...t.allowedResponses)),t.retryPolicy&&(r=function(e,t,n){const i=new Map;return a=>df(e,t,i,n)(a)}(r,t.retryPolicy,n)),r=((e,t)=>n=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{cancellationToken:i}=n;i&&t.set(i,new AbortController);try{return yield e(n)}finally{i&&t.delete(i)}})))(r,o),r},pf=e=>{const t=[];let n;const i=(e,n,i)=>{const a=new Date;return(o,r,s)=>{t.push({type:e,duration:o-n,result:r,request:gf(a,i,s)})}},a=(e,t)=>{const a=performance.now();return(o,r)=>{n(a,o,r),n=i(e,a,t)}};return n=i(ms.nz.Initial,performance.now(),e),{nextStep:(e,t,n,i)=>{a(e,n)(t,i)},beginStep:a,logStep:(e,t,n)=>{const a=i(e,performance.now(),t);return e=>a(performance.now(),e,n)},complete:(e,i)=>(n(performance.now(),e,i),t)}};function gf(e,t,n){if(!t)return;const i=n?new URL(n.url).hostname:"";return{dateTime:e,method:t.method,hostname:i,requestHeaders:t.headers||{},responseHeaders:(null==n?void 0:n.headers)||{},status:null==n?void 0:n.status,performance:hf(t.url),authPerformanceLogs:t.authPerformanceLogs||{}}}function hf(e){const t=performance.getEntriesByName(e);if(t.length>0&&"resource"===t[t.length-1].entryType){const e=t[t.length-1],{name:n,entryType:i}=e;return(0,l.__rest)(e,["name","entryType"])}}class vf{constructor(e){this.isCompleted=!1,this.subscriptions=new Set,this.observedValue=e,this.observable$=new Pa((e=>(this.subscriptions.add(e),()=>{this.subscriptions.has(e)&&this.subscriptions.delete(e)})))}get observable(){return this.observable$}subscribe(e,t){return this.isCompleted&&t.error("Subject: tried to subscribe to a complete observable"),this.observable$.subscribe(e)}onNext(e){this.observedValue=e,this.subscriptions.forEach((t=>{t.next(e)}))}onComplete(){this.isCompleted=!0,this.subscriptions.forEach((e=>{e.closed||e.complete()}))}onError(e){this.isCompleted=!0,this.subscriptions.forEach((t=>{t.error(e)}))}get value(){return this.observedValue}}const ff=!0,yf=new vf(ff),Sf=()=>{const e=new Map,t=(t,n)=>e.get(_f(t,n))||((t,n)=>{const i={responseHistory:[],healthSubject:new vf({serviceName:t,endpointName:n,isHealthy:void 0})};return e.set(_f(t,n),i),i})(t,n),n=(e,n,i,a)=>{const o=t(n,e);((e,t,n)=>{e.responseHistory.push(t),e.responseHistory.length>n&&e.responseHistory.shift()})(o,i,a.historyLength);const r=a.isHealthy([...o.responseHistory]);if(o.healthSubject.value.isHealthy!==r){const t={serviceName:n,endpointName:e,isHealthy:r};o.healthSubject.onNext(t)}};return{trackHealth:(e,t,i)=>Cf(e,n,t,kf(i)),observeEndpointHealth:(e,n)=>{if(!e||!n)return;return t(e,n).healthSubject.observable},getEndpointHealth:(t,n)=>bf(t,n,e),dumpState:()=>Tf(e)}},kf=e=>Object.assign(Object.assign({},wf),e),bf=(e,t,n)=>{var i;const a=null===(i=n.get(_f(e,t)))||void 0===i?void 0:i.healthSubject.value;return a&&Object.assign({},a)},_f=(e,t)=>`${e}_${t}`,Cf=(e,t,n,i)=>a=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){return e(a).then((e=>(t(a.apiName,n,e.status,i),e))).catch((e=>{throw t(a.apiName,n,e.reason,i),e}))})),wf={isHealthy:e=>{if(e&&e.length>0){const t=e[e.length-1];if("number"!=typeof t&&t!==na.A.RequestCancelled)return!1}return!0},historyLength:5};const Tf=e=>{let t="";return e.forEach((e=>{t=`${t}${JSON.stringify(e.healthSubject.value)}`})),t?null==(n=t)||0===n.length?n:` ${n}`.substr(1):"";var n},Ef=e=>t=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){var n,i;try{if(e.transformResponse)return yield e.transformResponse(t);const a=e.responseType||function(e){if(e.headers){const t=e.headers["content-type"];if(t){if(-1!==t.indexOf("application/json"))return"json";if(-1!==t.indexOf("text/"))return"text"}if("0"===e.headers["content-length"])return"text"}return}(t)||"json";return yield t.body&&(null===(i=(n=t.body)[a])||void 0===i?void 0:i.call(n))}catch(e){const n=nf(e);throw(0,ta.T)(na.A.TransformFailed,t,n)}}));const If=(e,t,n)=>{let i,a;return t.then((e=>{if(e.throttlePolicy){a=e.throttlePolicy;const t=null==a?void 0:a.throttleKey;t?(i=n.get(t)||[],n.has(t)||n.set(t,i)):i=[]}})),t=>a?n=>function n(o){var r;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const s=function(e,t){const{maxPerThrottleInterval:n,throttleInterval:i}=t,a=Date.now()-i;let o=e.length-1;for(;o>=0&&a<e[o];)o--;e.splice(0,o);const r=e.length-n;return r>=0?e[r]-a:0}(i,a);if(!s)return function(e){return i.push(Date.now()),t(e)}(o);const l=null===(r=o.operationLogger)||void 0===r?void 0:r.logStep(ms.nz.Throttle);return yield ia(s,e),l&&l("OK"),n(o)}))}(n):t};function Nf(e,t){const{globalContext:n,logger:i}=t,a=new Map,o=new Map,{networkMonitor:r,networkState:s}=(()=>{const e=e=>yf.onNext(e);return{networkMonitor:{processResponse:t=>{void 0!==t.status&&e(ff)},processResponseError:t=>{t&&(t.reason===na.A.RejectHttpError?e(!1):t.serverResponse&&e(ff))}},networkState:{observeIsOnline:()=>yf.observable,isOnline:()=>yf.value}}})(),c=((e,t)=>n=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){return t(n).then((t=>(e.processResponse(t),t))).catch((t=>{throw e.processResponseError(t),t}))})))(r,function(e){return t=>(0,l.__awaiter)(this,void 0,void 0,(function*(){var n;try{return yield e(t)}catch(e){const i=nf(e);if(e instanceof TypeError&&"failed to fetch"===(null===(n=e.message)||void 0===n?void 0:n.toLowerCase())){const n=t.headers&&t.headers.cache;if(n&&-1!==n.indexOf("only-if-cached"))return{status:ms.qb.GATEWAY_TIMEOUT};e=(0,ta.T)(na.A.RejectHttpError,void 0,i)}throw"AbortError"===e.name&&(e=(0,ta.T)(na.A.RequestCancelled)),e}}))}(((e,t,n)=>i=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){return tf(i,e,t,n)})))(n,a,i))),d=Sf(),{trackHealth:u}=d;return{createApi:n=>Af(n,e,Object.assign(Object.assign({},t),{cancellationMap:a,trackHealth:u,throttleMap:o}),c),createCancelToken:()=>{const e=(0,Be.v4)();return{token:e,cancel:()=>{const t=a.get(e);return t&&t.abort(),!t}}},networkState:s,health:(0,l.__rest)(d,["trackHealth"])}}const Af=(e,t,n,i)=>{const a={},o=e(t);for(const e in o.models){const t=o.models[e];a[e]=Mf(t,o,n,i)}return a},Mf=(e,t,n,i)=>{const{trackHealth:a,throttleMap:o,globalContext:r}=n,s=If(r,e,o);return(...o)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){var r;const l=yield e,c=l.constructRequest(...o);let d=mf(i,l,n,t.authResource);d=a(d,t.serviceName,l.healthPolicy),d=s(d);const u=Object.assign(Object.assign({},c),{serviceName:t.serviceName,operationLogger:pf(c)});return Ff(d,t.serviceName,null===(r=l.customTelemetry)||void 0===r?void 0:r.call(l,...o),l,n)(u)}))},Ff=(e,t,n,i,a)=>o=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){var r;let s,l;const c=(new Date).toISOString(),d=performance.now(),{logger:u,telemetryProvider:m}=a;try{return s=yield e(o),Ef(i)(s)}catch(e){throw e.serverResponse&&(s=e.serverResponse),l=e.innerException?`${e.reason} / ${e.innerException}`:e.reason,e}finally{const e=performance.now()-d,i=null==s?void 0:s.status,a=i&&ms.qb[i]||l||"",{apiName:p,apiNameDecoration:g,method:h,correlationId:v}=o,f=`${t}/${p}/${h}`,y=(null===(r=o.operationLogger)||void 0===r?void 0:r.complete(a,s))||[];u.log(`Request ${f} completed ${a}/${i}`),m({apiName:p,apiNameDecoration:g,serviceName:t,createdTime:c,parameters:n,duration:e,result:a,operationLogs:y,correlationId:v})}}));var Rf,Pf=n(604174),Df=n(906693);!function(e){e[e.Success=0]="Success",e[e.InvalidArguments=1]="InvalidArguments",e[e.GroupNameExists=2]="GroupNameExists"}(Rf||(Rf={}));class jf{constructor(e){this.isCompleted=!1,this.subscriptions=new Set,this.observedValue=e,this.observable$=new Pa((e=>(this.subscriptions.add(e),()=>{this.subscriptions.has(e)&&this.subscriptions.delete(e)})))}get observable(){return this.observable$}subscribe(e,t){return this.isCompleted&&t.error("Subject: tried to subscribe to a complete observable"),this.observable$.subscribe(e)}onNext(e){this.observedValue=e,this.subscriptions.forEach((t=>{t.next(Object.assign({},e))}))}onComplete(){this.isCompleted=!0,this.subscriptions.forEach((e=>{e.closed||e.complete()}))}onError(e){this.isCompleted=!0,this.subscriptions.forEach((t=>{t.error(e)}))}get value(){return this.observedValue}}class xf{constructor(){this._endpointsHealthCache={},this._groupsHealthCache={},this.getEndpointHealth=(e,t)=>{if(e&&t){const n=this._endpointsHealthCache[this._getCacheKey(e,t)];return n?Object.assign({},n.value):void 0}},this.observeEndpointHealth=(e,t)=>e&&t?this._getHealthRecord(e,t).observable:void 0,this.observeAggregatedHealth=e=>e?this._getHealthRecord(e,void 0).observable:void 0,this.dumpState=()=>JSON.stringify(Object.assign(Object.assign({},this._endpointsHealthCache),this._groupsHealthCache),((e,t)=>t instanceof jf?t.value:t)),this.updateRemoteEndpointHealth=e=>{if(!e.serviceName)return;const t=this._getHealthRecord(e.serviceName,e.endpointName);t.value.isHealthy!==e.isHealthy&&(t.value.isHealthy=e.isHealthy,t.onNext(t.value))},this._getCacheKey=(e,t)=>`${e}_${t||""}`,this._getHealthRecord=(e,t)=>(t?this._endpointsHealthCache[this._getCacheKey(e,t)]:this._groupsHealthCache[this._getCacheKey(e,t)])||this._startTrackingHealth(e,t),this._startTrackingHealth=(e,t)=>{if(t){const n=new jf({serviceName:e,endpointName:t,isHealthy:void 0});return this._endpointsHealthCache[this._getCacheKey(e,t)]=n,n}{const n=new jf({groupName:e,isHealthy:void 0});return this._groupsHealthCache[this._getCacheKey(e,t)]=n,n}}}getAggregatedHealth(e){if(e){const t=this._groupsHealthCache[this._getCacheKey(e,void 0)];return t?Object.assign({},t.value):void 0}}dispose(){this._endpointsHealthCache={},this._groupsHealthCache={}}}class Of{constructor(e,t){this._endpointsManager=e,this._logger=t,this._subscriptions=[],this._aggregatedHealthMap=new Map,this._remoteEndpointsHealthCache=new xf,this.observeEndpointHealth=(e,t)=>this._getLocalEndpointHealth(e,t)?this._getLocalEndpointObservable(e,t):this._getRemoteEndpointHealth(e,t)?this._getRemoteEndpointObservable(e,t):this._getLocalEndpointObservable(e,t),this.getEndpointHealth=(e,t)=>this._getLocalEndpointHealth(e,t)||this._getRemoteEndpointHealth(e,t),this.observeAggregatedHealth=e=>{var t;return null===(t=this._aggregatedHealthMap.get(e))||void 0===t?void 0:t.healthSubject.observable},this.getAggregatedHealth=e=>this._getLocalAggregatedHealth(e)||this._getRemoteAggregatedHealth(e),this.dumpState=()=>(0,P.LQ)(`{ "aggregated endpoints health": [\n      ${this._printAggregatedHealth(this._aggregatedHealthMap)}\n    ],\n    "endpoints health": [\n      ${this._endpointsManager.health.dumpState()}\n    ]},\n    "remote endpoints health": ${this._remoteEndpointsHealthCache.dumpState()}`),this.getWorkerDumpState=()=>this._requestWorkerStateDumpCallback?(this._deferredWorkerStateDump=(0,Ua.P)(),this._requestWorkerStateDumpCallback(),this._deferredWorkerStateDump.promise):Promise.reject("Worker endpoints health snapshot can't be requested"),this.getEndpointsHealthUpdateHandler=()=>({handleEndpointHealthUpdate:this._remoteEndpointsHealthCache.updateRemoteEndpointHealth,handleStateDump:this._handleWorkerStateDumpResponse,onStateDumpRequest:this._setWorkerStateDumpRequestCallback}),this._getLocalEndpointHealth=(e,t)=>this._endpointsManager.health.getEndpointHealth(e,t),this._getLocalEndpointObservable=(e,t)=>this._endpointsManager.health.observeEndpointHealth(e,t),this._getRemoteEndpointHealth=(e,t)=>this._remoteEndpointsHealthCache.getEndpointHealth(e,t),this._getRemoteEndpointObservable=(e,t)=>this._remoteEndpointsHealthCache.observeEndpointHealth(e,t),this._updateAggregatedHealth=(e,t,n)=>{const i=e.healthSubject.value,a=[];if(i.endpoints)for(const e of i.endpoints)if(e.endpointName===t.endpointName&&e.serviceName===t.serviceName)a.push(t);else{const t=this._endpointsManager.health.getEndpointHealth(e.serviceName,e.endpointName);t&&a.push(t)}try{const t=n(a);t!==i.isHealthy&&(i.isHealthy=t,e.healthSubject.onNext(i))}catch(e){this._logger.error(`Error happened in aggregated group health policy. Group: ${i.groupName}. Error: ${JSON.stringify(e.reason||e)}`)}},this._printAggregatedHealth=e=>{let t="";return e.forEach((e=>{t=`${t},${JSON.stringify(e.healthSubject.value)}`})),t?(0,P.LQ)(t):""},this._handleWorkerStateDumpResponse=e=>{this._logger.log("Received worker endpoints health state dump."),this._deferredWorkerStateDump&&(this._deferredWorkerStateDump.resolve(e),this._deferredWorkerStateDump=void 0)},this._setWorkerStateDumpRequestCallback=e=>{this._requestWorkerStateDumpCallback=e}}createAggregatedHealthGroup(e,t,n){if(!e||0===e.length||!t||0===t.length)return this._logger.error(`createAggregatedHealthGroup: Group name is empty or no endpoints are provided. groupName: ${e}; endpoints: ${t&&JSON.stringify(t)}`),Rf.InvalidArguments;if(this.getAggregatedHealth(e))return this._logger.error(`createAggregatedHealthGroup: Group name already exists. groupName: ${e}`),Rf.GroupNameExists;const i={healthSubject:new jf({groupName:e,endpoints:t,isHealthy:void 0})};return this._aggregatedHealthMap.set(e,i),t.forEach((t=>{var i;const a=null===(i=this.observeEndpointHealth(t.serviceName,t.endpointName))||void 0===i?void 0:i.subscribe((t=>{const i=this._aggregatedHealthMap.get(e);i||this._logger.error(`Can't update group health. Group '${e}' is not registered`),i&&this._updateAggregatedHealth(i,t,n)}));a&&this._subscriptions.push(a)})),Rf.Success}dispose(){var e;this._subscriptions.map((e=>e.unsubscribe())),this._subscriptions=[],this._aggregatedHealthMap.clear(),this._remoteEndpointsHealthCache.dispose(),this._requestWorkerStateDumpCallback=void 0,null===(e=this._deferredWorkerStateDump)||void 0===e||e.reject("CombinedEndpointsHealthService is disposed"),this._deferredWorkerStateDump=void 0}_getLocalAggregatedHealth(e){var t;return null===(t=this._aggregatedHealthMap.get(e))||void 0===t?void 0:t.healthSubject.value}_getRemoteAggregatedHealth(e){return this._remoteEndpointsHealthCache.getAggregatedHealth(e)}}class Lf{constructor(e,t){this._endpointsManager=e,this._logger=t,this._subscriptions=[],this._aggregatedHealthMap=new Map,this.observeEndpointHealth=(e,t)=>this._endpointsManager.health.observeEndpointHealth(e,t),this.getEndpointHealth=(e,t)=>this._endpointsManager.health.getEndpointHealth(e,t),this.observeAggregatedHealth=e=>{var t;return null===(t=this._aggregatedHealthMap.get(e))||void 0===t?void 0:t.healthSubject.observable},this.getAggregatedHealth=e=>{var t;return null===(t=this._aggregatedHealthMap.get(e))||void 0===t?void 0:t.healthSubject.value},this.dumpState=()=>`{ "aggregated endpoints health": [\n      ${this._printAggregatedHealth(this._aggregatedHealthMap)}\n    ],\n    "endpoints health": [\n      ${this._endpointsManager.health.dumpState()}\n    ]}`,this._updateAggregatedHealth=(e,t,n)=>{const i=e.healthSubject.value,a=[];if(i.endpoints)for(const e of i.endpoints)if(e.endpointName===t.endpointName&&e.serviceName===t.serviceName)a.push(t);else{const t=this._endpointsManager.health.getEndpointHealth(e.serviceName,e.endpointName);t&&a.push(t)}try{const t=n(a);t!==i.isHealthy&&(i.isHealthy=t,e.healthSubject.onNext(i))}catch(e){this._logger.error(`Error happened in aggregated group health policy. Group: ${i.groupName}. Error: ${JSON.stringify(e.reason||e)}`)}},this._printAggregatedHealth=e=>{let t="";return e.forEach((e=>{t=`${t},${JSON.stringify(e.healthSubject.value)}`})),t?(0,P.LQ)(t):""}}createAggregatedHealthGroup(e,t,n){if(!e||0===e.length||!t||0===t.length)return this._logger.error(`createAggregatedHealthGroup: Group name is empty or no endpoints are provided. groupName: ${e}; endpoints: ${t&&JSON.stringify(t)}`),Rf.InvalidArguments;if(this.getAggregatedHealth(e))return this._logger.error(`createAggregatedHealthGroup: Group name already exists. groupName: ${e}`),Rf.GroupNameExists;const i={healthSubject:new jf({groupName:e,endpoints:t,isHealthy:void 0})};return this._aggregatedHealthMap.set(e,i),t.forEach((t=>{var i;const a=null===(i=this.observeEndpointHealth(t.serviceName,t.endpointName))||void 0===i?void 0:i.subscribe((t=>{const i=this._aggregatedHealthMap.get(e);i||this._logger.error(`Can't update group health. Group '${e}' is not registered`),i&&this._updateAggregatedHealth(i,t,n)}));a&&this._subscriptions.push(a)})),Rf.Success}dispose(){this._subscriptions.map((e=>e.unsubscribe())),this._subscriptions=[],this._aggregatedHealthMap.clear()}}class Uf{constructor(){this.id=S.Yg.CreateEndpointsManager}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{loggerFactory:t,windowProvider:n,coreSettings:i}=e,{disableEndpointsHealthService:a,enableCombinedEndpointsHealthService:o}=i.get(b.J.Core);e.endpointsManager=Nf(e,{logger:t.newLogger("EPM"),globalContext:n,telemetryProvider:(0,Pf.YK)(n)}),a?t.newLogger("EndpointsHealthService").log("Disabled by disableEndpointsHealthService feature flag"):(e.endpointsHealthService=o?new Of(e.endpointsManager,t.newLogger("CombinedEndpointsHealthService")):new Lf(e.endpointsManager,t.newLogger("EndpointsHealthService")),(0,Df.Yf)().setEndpointHealth(e.endpointsHealthService.getEndpointHealth))}))}}class Bf{constructor(){this.id=S.Yg.CreateEntityCommanding}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{client:t,commandHandler:n,windowProvider:i,hostCommunicationService:a,scenarioFactory:o,loggerFactory:r,deeplinkService:s,coreSettings:l}=Ko("CreateEntityCommandingTask",e,"client","commandHandler","windowProvider","hostCommunicationService","scenarioFactory","loggerFactory","deeplinkService","coreSettings");e.entityCommanding=qt(n,t,l,i,o,r,s,a)}))}}function Wf(e,t,n,i,a){const o=e.newLogger("External Command Listener"),r=Hf(o,n);if(t.opener.addEventListener("executeEntityCommand",r),a.get(b.J.Core).enableHostCommandListener){const e=e=>{const{entity:t}=e,{type:n}=t;switch(n){case Ut.calls:case Ut.chats:case Ut.toasts:r(gr(e,o));break;case Ut.signout:!function(e,t){(0,l.__awaiter)(this,void 0,void 0,(function*(){try{yield e(Object.assign(Object.assign({},ur),{payload:{entity:{type:ne.p.default,action:ne.u.default},command:{visibilityState:be.fe.show,stateTransition:be.su.flush}}})),t.log("HostComms:: Executed default command"),yield e(Object.assign(Object.assign({},ur),{payload:{entity:{type:ne.p.signoutdialog,action:ne.u.view},command:{visibilityState:be.fe.show,stateTransition:be.su.extend}}})),t.log("HostComms:: Executed signout modal command")}catch(e){throw t.error(`HostComms:: SignoutCommandFailed - ${(0,P.u4)(e)}`),e}}))}(r,o);break;default:r(ur)}};i.loadModule("core").then((t=>{var n;t&&(null===(n=t.registerForOnExecuteCommand)||void 0===n||n.call(t,e))})).catch((e=>{o.error(`Loading core host comms module failed with: ${(0,P.u4)(e)}`)}))}return Promise.resolve()}const Hf=(e,t)=>({payload:n})=>{if(n&&n.entity&&n.command&&n.entity.type in ne.p&&n.entity.action in ne.u&&n.command.visibilityState in be.fe&&n.command.stateTransition in be.su){e.debug("pushing entity command to cache");const{entity:i,entityOptions:a,dataOptions:o,command:r,windowOptions:s}=n,{linkedEntity:l}=i;if(l){if(!l.id||!(l.type in ne.p))return e.warn("Invalid linked entity data from payload"),Promise.reject()}else i.linkedEntity=null;return r.correlation=r.correlation||{},r.correlation.source=r.correlation.source||k.D.ExternalCommand,t({dataOptions:o,entity:i,entityOptions:a,command:ft(r),windowOptions:s})}return e.warn("Invalid payload for executeEntityCommand handler"),Promise.reject()};class $f{constructor(){this.id=S.Yg.CreateExternalCommandListener}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{windowProvider:t,loggerFactory:n,commandHandler:i,hostCommunicationService:a,coreSettings:o}=Ko("CreateExternalCommandListenerTask",e,"windowProvider","loggerFactory","commandHandler","hostCommunicationService","coreSettings");return Wf(n,t,i,a,o)}))}}var Vf=n(813489);class zf{constructor(){this.id=S.Yg.CreateGtmRegistry}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){e.gtmRegistry=new Vf.a(e.authenticationService,e.discover,e.coreSettings,e.loggerFactory)}))}}n(483295);const Gf=(e,t)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){if("core"===e)return(e=>({setCoreInitialized:function(){return Promise.resolve(e.opener.postMessage("coreInitialized",{}))}}))(t)})),qf=e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){return"auth"===e?(0,l.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Auth})):"brb"===e?(0,l.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Brb})):"core"===e?(0,l.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Core})):"customvideobackground"===e?(0,l.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Customvideobackground})):"ecs"===e?(0,l.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Ecs})):"heartbeat"===e?(0,l.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Heartbeat})):"moduleloader"===e?(0,l.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Moduleloader})):"osutils"===e?(0,l.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Osutils})):"profiler"===e?(0,l.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Profiler})):"scenario"===e?(0,l.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Scenario})):"taskbar"===e?(0,l.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Taskbar})):"telemetry"===e?(0,l.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Telemetry})):"updates"===e?(0,l.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Updates})):"webclientstates"===e?(0,l.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Webclientstates})):"windowcontrols"===e?(0,l.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Windowcontrols})):void 0})),Jf=(e,t)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){return"core"===e?(e=>({setCoreInitialized:function(){return Promise.resolve(e.opener.postMessage("coreInitialized",{}))},notifyCoreStateChanged:function(t){const n={childSettings:t};return Promise.resolve(e.opener.postMessage("updateWindowState",n))}}))(t):"windowcontrols"===e?(e=>({swapMeetingRoomFrontOfRoomWindows:function(){return Promise.resolve(e.opener.postMessage("swapMeetingRoomFrontOfRoomWindows",{}))}}))(t):void 0})),Kf=(e,t=!1)=>new Qf(qf,e,void 0,t);class Qf{constructor(e,t,n,i=!1){this._internalLoadModule=e,this._logger=t,this._host=n,this._enableScenarioCache=i,this._hostCommsScenarioFactory=Yf(this._enableScenarioCache)}loadModule(e){var t,n,i;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const a=this._hostCommsScenarioFactory.newScenario("host_comms_load_module");let o;try{this._logger.log(`Loading module: ${e}`),o=yield this._internalLoadModule(e,null!==(t=this._host)&&void 0!==t?t:void 0)}catch(t){throw null===(i=(n=this._logger).errorToTelemetry)||void 0===i||i.call(n,"Error while loading module","webclient_framework_host_comms",void 0,!0),null==a||a.fail({reason:"Error while loading module",message:e}),t}return o?(this._logger.log(`Module "${e}" loaded`),null==a||a.stop({message:e})):(this._logger.error(`Failed to load module. Module, undefined ${e}}`),null==a||a.fail({reason:"Failed to load module",message:e})),o}))}setScenarioFactory(e){this._hostCommsScenarioFactory.setScenarioFactory(e)}}const Yf=e=>{let t;const n=[];return{newScenario:i=>{if(t)return t.newScenario(i);if(e){const e=Zf(i);return n.push(e),e}},setScenarioFactory:e=>{t=e,Xf(n,t)}}},Xf=(e,t)=>{let n=e.pop();for(;n;){const i=t.newScenario(n.name,{startTime:n.time});"failed"===n.status&&i.fail(Object.assign({cached:!0},n.result)),"stopped"===n.status&&i.stop(Object.assign({cached:!0},n.result)),n=e.pop()}},Zf=e=>{let t,n;return{name:e,time:Date.now(),fail:e=>{n="failed",t=e},stop:e=>{n="stopped",t=e},get result(){return t},get status(){return n}}};class ey{constructor(){this.id=S.Yg.CreateHostCommunication}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{windowProvider:t,platformService:n,coreSettings:i,loggerFactory:a}=Ko("CreateHostCommunicationServiceTask",e,"windowProvider","platformService","coreSettings","loggerFactory");e.hostCommunicationService=((e,t,n,i)=>{const{clientType:a}=e.config,o=i.newLogger("HostComms");return o.log(`Create HostComms for ${a}`),a===si.Bh.Maglev&&t.get(b.J.Core).enablePieCommunication?Kf(o,!0):a===si.Bh.Desktop?new Qf(Jf,o,n,!0):new Qf(Gf,o,n,!0)})(n,i,t,a)}))}}var ty=n(900984);class ny{constructor(){this.id=S.Yg.CreateI18n}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){e.i18n=new ty.o(e.i18NextWrapper)}))}}var iy=n(594645),ay=n(71744);class oy{constructor(e,t){this.options={},this.setOptions(t),this.logger=e("i18n:selective-icu"),this.name="selective-icu",this.type="postProcessor",this.icu=new ay.Z}setOptions(e){this.options=Object.assign(Object.assign({},this.options),e)}process(e,t,n,i){const a=Array.isArray(t)?t[t.length-1]:t;if(!this.options.filterRegex||!this.options.filterRegex.test(a))return e;try{return this.icu.parse(e,n,i.language,n.ns,a,!1)}catch(a){return this.logger.error(`ICU parse failed for namespace: "${n.ns||""}" key: "${t.toString()}" locale: "${i.language||""}"`),e}}}class ry{constructor(){this.name="simple-pseudo",this.type="postProcessor"}process(e){return`([{${e}}])`}}var sy=n(416350);class ly{constructor(e){this.scenarioFactory=e,this.entries={}}getState(e){const t=this.entries[e];return t?t.state:sy.i.Missing}waitForNamespace(e,t){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const n=this.getState(t);if(n===sy.i.Loaded)return;if(n===sy.i.Failed)throw new Error(`Loading of namespace ${t} has previously failed`);const i=n===sy.i.Missing?this.load(e,t):this.entries[t];return i&&i.promise?i.promise:void 0}))}loadStatic(e,t){e.i18next.addResourceBundle(e.locale,t.namespace,t.translations),this.entries[t.namespace]={state:sy.i.Loaded,error:void 0,promise:void 0}}load(e,t,n){const i="en-us",a=n?i:e.locale,o=`${a}/${(0,j.kebabCase)(t)}`,r=`./generated/resources/${o}`,s={state:sy.i.Loading,error:void 0,promise:void 0};this.entries[t]=s,e.logger.log("importing",r);const l=this.getNamespaceEntry(a,t).then((n=>{e.i18next.addResourceBundle(e.locale,t,n.default.translations),e.logger.log("imported",r),s.state=sy.i.Loaded,s.promise=void 0})).catch((l=>n||a===i?(this.failI18nLoad({errors:`[${l.message}]`,origin:o}),e.logger.error("failed to import",r,l),s.state=sy.i.Failed,s.error=l.message,s.promise=void 0,Promise.reject(l)):(e.logger.log("trying fallback to the default locale as failed to import",r,l),this.failI18nLoad({fallbackLocale:i,errors:`[${l.message}]`,origin:o}),this.load(e,t,!0).promise)));return s.promise=l,s}getNamespaceEntry(e,t){return(0,ha.mT)((()=>n(122057)(`./${e}/${(0,j.kebabCase)(t)}.js`)),`${(0,j.kebabCase)(t)}-locale-${e}`,this.scenarioFactory)}failI18nLoad(e){this.scenarioFactory.newScenario(A.RG.I18nNamespaceLoad).fail(e)}}var cy=n(990461);const dy=()=>{};class uy{constructor(e,t,n,i,a,o,r){this.preloadNamespaces=e,this.coreSettings=i,this.staticNamespaces=o;const s=t("i18n"),l=n.config.localeCode,c="pseudo"===l;let d=(0,cy.Ax)(n,a,r);const u=b.J.Core&&this.coreSettings.get(b.J.Core);u&&u.useEnglishOnlyUI&&(d="en-us");const m=this.initPlugins(t,c,d,s);this.namespaceLoader=(e=>new ly(e))(a),this.i18next=m,this.latestTranslation={},this.originLocale=l,this.logger=s,this.scenarioFactory=a,this.osPlatform=n.config.osPlatform,this.initOsDateTimeLocalization(i,a,n,s),this.initI18next(d,a,s),this._locale=d,this.loadLocales()}get locale(){return this._locale}get osLocaleInfo(){return this._osLocaleInfo}setOSLocaleInfo(e){this._osLocaleInfo=e}setLocale(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const t=b.J.Core&&this.coreSettings.get(b.J.Core);t&&t.useEnglishOnlyUI&&(e="en-us");const n=(0,cy.um)(this.scenarioFactory,e);this.i18next.changeLanguage(n),this._locale=n,yield this.loadLocales()}))}initPlugins(e,t,n,i){const a=[new oy(e,{filterRegex:/.*\_mf$/})];if(t){const e=new ry;a.push(e),n="en-us"}cy.cL.locale=n;let o=iy.Z.createInstance();for(const e of a)o=o.use(e);const r=this.getInitOptions(n,a);return o.init(r).catch((e=>i.error("The i18next initialization failed",e))),o}removeDefaultI18nNamespaces(e){var t;("string"==typeof this.i18next.options.ns?[this.i18next.options.ns]:null!==(t=this.i18next.options.ns)&&void 0!==t?t:[]).forEach((t=>this.i18next.removeResourceBundle(e,t))),this.i18next.setDefaultNamespace("")}setMissingHandlers(e,t){this.i18next.options.saveMissing=!0,this.i18next.options.missingKeyHandler=(n,i,a)=>{this.missingKeyHandler(e,t,this.i18next,n,i,a)},this.i18next.options.missingInterpolationHandler=(n,i)=>this.missingInterpolationHandler(e,t,this.latestTranslation,i)}initI18next(e,t,n){this.removeDefaultI18nNamespaces(e),this.setMissingHandlers(t,n)}initOsDateTimeLocalization(e,t,n,i){const a=b.J.Host&&e.get(b.J.Host),o=a&&a.enableOsDateTimeFormatting,r=a&&a.enableOsDateTimeFormattingTelemetry;if(o||r){const e=t.newScenario(A.RG.I18nGetLocaleInfo);n.config.getLocaleInfoAsync().then((t=>{if(null==t?void 0:t.regionalFormat){const e="_",n="-";t.regionalFormat=t.regionalFormat.split(e).join(n).toLowerCase()}if(r){let n="",i="";t&&(0,j.isObject)(t)&&(n=t.regionalFormat,i=t.date.calendar),e.stop({message:JSON.stringify({regionalFormat:n,calendar:i})})}else e.stop();o&&this.setOSLocaleInfo(t)})).catch((t=>{i.error(`getLocaleInfoAsync failed for ${JSON.stringify(t)}`),e.fail({errors:JSON.stringify(["getLocaleInfoAsync failed"])})}))}}loadLocales(){const e=[];this.staticNamespaces&&this.namespaceLoader.loadStatic(this,this.staticNamespaces);for(const t of this.preloadNamespaces){const n=this.namespaceLoader.load(this,t);n.promise&&e.push(n.promise.catch(dy))}return Promise.all(e)}missingKeyHandler(e,t,n,i,a,o){const r="string"==typeof n.options.ns?[n.options.ns]:n.options.ns||[""];let s="",l="";r.indexOf(a)<0?(s=`The namespace "${a}" has not been loaded. The only loaded namespaces: "${r.join(", ")}"`,l=o):s=`The key "${o}" doesn't exist in namespace "${a}" for locale "${i[0]}"`;e.newScenario(A.RG.I18nMissingKeyHandler).stop({message:s,origin:l}),t.error(s)}missingInterpolationHandler(e,t,n,i){const a=`Undefined interpolation "${i[1]}" token for namespace "${n.namespace}" and key "${n.key}"`;e.newScenario(A.RG.I18nMissingInterpolationHandler).stop({message:a}),t.error(a)}getInitOptions(e,t){return{initImmediate:!1,interpolation:{escapeValue:!1},react:{bindI18n:"languageChanged",bindStore:"",nsMode:"default"},lng:e,fallbackLng:e,load:"currentOnly",lowerCaseLng:!0,postProcess:t.filter((e=>"postProcessor"===e.type)).map((e=>e.name))}}}class my{constructor(){this.id=S.Yg.CreateI18NextWrapper}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){var t,n,i,a,o,r,s;e.i18NextWrapper=(t=e.config.preloadedI18nNamespaces||[],n=e.loggerFactory.newLogger,i=e.platformService,a=e.coreSettings,o=e.scenarioFactory,r=e.config.staticNamespaces,s=e.config.locale,new uy(t,n,i,a,o,r,s))}))}}class py{constructor(e,t){this.host=e,this.parentLeakDetector=t,this.trackedObjectsByKey={}}track(e,t){var n,i;(null===(n=this.host)||void 0===n?void 0:n.WeakReference)&&(this.trackedObjectsByKey[e]||(this.trackedObjectsByKey[e]=[]),null===(i=this.parentLeakDetector)||void 0===i||i.track(e,t),this.trackedObjectsByKey[e].push({weakReference:new this.host.WeakReference(t)}))}getLeaks(e){return this.cleanupReferencesOfType(e),this.trackedObjectsByKey[e]?this.trackedObjectsByKey[e].map((e=>e.weakReference.getTarget())):[]}getAllLeaks(){const e={};for(const t of Object.keys(this.trackedObjectsByKey)){const n=this.getLeaks(t);n.length>0&&(e[t]=n)}return e}cleanup(){for(const e of Object.keys(this.trackedObjectsByKey))this.cleanupReferencesOfType(e)}cleanupReferencesOfType(e){this.trackedObjectsByKey[e]&&(this.trackedObjectsByKey[e]=this.trackedObjectsByKey[e].filter((e=>!e.weakReference.isDead())),0===this.trackedObjectsByKey[e].length&&delete this.trackedObjectsByKey[e])}}class gy{constructor(e){this.host=e,this.leakDetectorReferences=[],this.leaksAggregator=new py(e)}create(){var e;if(!(null===(e=this.host)||void 0===e?void 0:e.WeakReference))return;const t=new py(this.host,this.leaksAggregator),n=new this.host.WeakReference(t);return this.leakDetectorReferences.push(n),this.cleanup(),t}getReachableObjects(e){this.cleanup();const t=this.leaksAggregator.getLeaks(e);return new Set(t)}getReachableObjectsByKey(){this.cleanup();const e={},t=this.leaksAggregator.getAllLeaks();for(const n of Object.keys(t))e[n]=new Set(t[n]);return e}getReachableObjectCountsByKey(){const e={},t=this.getReachableObjectsByKey();for(const n of Object.keys(t))e[n]=t[n].size;return e}cleanup(){this.leaksAggregator.cleanup(),this.leakDetectorReferences=this.leakDetectorReferences.filter((e=>!e.isDead())),this.leakDetectorReferences.forEach((e=>{var t;null===(t=e.getTarget())||void 0===t||t.cleanup()}))}}class hy{constructor(){this.id=S.Yg.LeakDetector}execute(e){var t,i;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{loggerFactory:a}=e,o=null==a?void 0:a.newLogger("CreateLeakDetectorTask"),r=null===(t=e.coreSettings)||void 0===t?void 0:t.get(b.J.Core);if(o&&o.log(`enableObjectLeakDetection ${null==r?void 0:r.enableObjectLeakDetection}`),!(null==r?void 0:r.enableObjectLeakDetection))return;const s=e.windowProvider;if(function(e){if(!e)return;e.WeakReference=e.WeakReference||n.g.WeakReference;const t=e.WeakRef||n.g.WeakRef;if(!e.WeakReference&&t){class n{constructor(e){this._weakRef=new t(e)}getTarget(){return this._weakRef.deref()}isDead(){return void 0===this._weakRef.deref()}}e.WeakReference=n}}(s),!(null==s?void 0:s.WeakReference))return void(o&&o.log("windowProvider?.WeakReference is undefined"));const l=new gy(s);e.leakDetectorService=l,o&&o.log("leakDetectorService instantiated"),s.opener.addEventListener(R.rY.GetLeaks,(()=>this.sendLeaksStats(s,l,o))),this.initTestingMode(s,l,null===(i=e.coreSettings)||void 0===i?void 0:i.get(b.J.Host))}))}sendLeaksStats(e,t,n){let i=0;const a=e.parent;a.gc?(n&&n.log("executing gc() on experience renderer"),a.gc(),i=1e4):n&&n.warn("gc() not defined on experience renderer");let o=0;o=e.setTimeout((()=>{e.clearTimeout(o);const n={leaks:t.getReachableObjectCountsByKey()};e.opener.postMessage(R.rY.GetLeaks,n)}),i)}initTestingMode(e,t,n){if(n){const{userType:i}=n;i&&i.indexOf("test")>-1&&!("getLeakDetectorService"in e.parent)&&(e.parent.getLeakDetectorService=()=>t)}}}class vy{constructor(){this.id=S.Yg.CreateLocalStorage}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,windowProvider:n}=e;t&&(e.localStorage=new Nv(t.profile.tenantId,t.profile.objectId,e.config.experienceName,n))}))}}var fy=n(745534);function yy(e){const t=null==e?void 0:e.document.getElementsByTagName("head");if(t)return t[0]}function Sy(e){return-1!==((null==e?void 0:e.navigator.userAgent)||"").indexOf("maglev/")}function ky(e){const t=e.navigator.userAgent.match(/maglev\/(\d+\.\d+\.\d+\.\d+)/);return t&&t.length>1?t[1]:void 0}function by(e){var t,n;const i=null===(n=null===(t=e.navigator)||void 0===t?void 0:t.serviceWorker)||void 0===n?void 0:n.controller;return"activated"===(null==i?void 0:i.state)}class _y extends class{constructor(e){this.userAgent=e,this.UAParser=fy.getParser(e)}getBrowser(){switch(this.UAParser.getBrowserName()){case"Microsoft Edge":return si.AR.Edge;case"Internet Explorer":return si.AR.IE;case"Safari":return si.AR.Safari;case"Chrome":return si.AR.Chrome;case"Firefox":return si.AR.Firefox;case"Electron":return si.AR.Electron;default:return si.AR.Unknown}}getBrowserVersion(){return this.UAParser.getBrowserVersion()}getRingConfig(e=he.s.prod,t){switch(t){case"ring0_gcc":t="ring0",e=he.s.gcc;break;case"general_gcc":t="general",e=he.s.gcc}return{ring:t,environment:e}}getOsPlatform(){const e=this.getOsOverride();if(null!=e)return e;switch(this.UAParser.getOSName()){case"Windows":return si.NR.Windows;case"macOS":return si.NR.Mac;case"Linux":return si.NR.Linux;case"Chrome OS":return si.NR.ChromeOS;case"Android":return si.NR.Android;case"iOS":return si.NR.IOS;case"Windows Phone":return si.NR.WindowsPhone;default:return si.NR.Unknown}}getOSPlatformVersion(){return this.UAParser.getOSVersion()}getOsOverride(){return null}getPlatformId(e,t){let n=this.getClientType(e,t);if(Sy(t))return si.us.Maglev;const i=this.getMetaOsPlatformId(e);return i||(n===si.Bh.Desktop&&this.getOsPlatform()===si.NR.Mac&&(n="Mac"),n=`${n[0].toUpperCase()}${n.substr(1)}`,si.us[n])}getMetaOsPlatformId(e){var t;switch(null===(t=null==e?void 0:e.metaoshost)||void 0===t?void 0:t.toLowerCase()){case"office":return si.us.MetaOsOffice;case"outlook":return si.us.MetaOsOutlook}return null}getClientType(e,t){if(Sy(t))return si.Bh.Maglev;let n=e&&e.host;if(!n&&t){const e="host";n=t.localStorage.getItem(e)||""}return"outlookDesktop"===n?si.Bh.Desktop:"outlookWeb"===n?si.Bh.Web:this.getBrowser()===si.AR.Electron?si.Bh.Desktop:si.Bh.Web}getVdiConfig(){return{provider:ls.None,mode:"",isAvRemoted:!1,configFilter:null}}}{constructor(e,t,n){super(n.navigator.userAgent),this.loggerFactory=e,this.routingServices=t,this.windowHost=n,this.logger=this.loggerFactory.newLogger("PlatformService"),this.queryStringParameters=this.routingServices.state.getSearchState()||{},this.headConfig=function(e,t){var n;try{const t=yy(e),i=null===(n=null==t?void 0:t.dataset)||void 0===n?void 0:n.config;return i?JSON.parse(decodeURIComponent(i)):{}}catch(e){null==t||t.error("Failed to parse head-data config with error: ",e)}return{}}(this.windowHost,this.logger),this.cachedConfig=this.computeConfig(),this.cachedEcsOverrides=this.computeEcsOverrides()}get config(){return this.cachedConfig}get ecsOverrides(){return this.cachedEcsOverrides}get host(){var e,t;return Object.assign({bootType:(null===(t=null===(e=this.windowHost.loader)||void 0===e?void 0:e.getBootType)||void 0===t?void 0:t.call(e))||a.Unknown,deviceId:Cs.get("deviceId")||this.windowHost.localStorage.getItem(o.DeviceID),hostAppVersion:ky(this.windowHost),sessionId:Cs.get("sessionId")||this.windowHost.sessionStorage.getItem(o.SessionID)},this.windowHost.getHostedWindowContext())}getOsOverride(){return this.windowHost.localStorage.getItem("platformOverride")}getVdiConfig(){const e=super.getVdiConfig(),t=this.windowHost.vdiSettings;if(t){switch(t.provider){case"1":e.provider=ls.CitrixXenDesktop;break;case"2":e.provider=ls.CitrixXenApp;break;case"3":e.provider=ls.VMWare;break;case"5":e.provider=ls.WVD;break;default:e.provider=ls.None}e.mode=t.mode,e.isAvRemoted=t.isAvRemoted,e.configFilter=(0,j.isEmpty)(t.configFilter)?null:t.configFilter}return e}computeConfig(){var e,t;const n=this.getBrowser(),i=this.getClientType(this.queryStringParameters,this.windowHost),a=this.getPlatformIdFromCookie()||this.getPlatformId(this.queryStringParameters,this.windowHost),o=this.getHostingParent(),r="21092203717",s=`${a}/21092203717`,l=this.windowHost.__webpack_public_path__;let c="https://statics.teams.cdn.office.net";try{l&&!l.includes("local")&&(c=new URL(l).origin)}catch(e){this.logger.warn(`Failed to parse dynamic staticsPath origin from '${l}'`)}const d=this.windowHost.navigator.language||"en-us";return this.logger.log(`PlatformService: configuring with clientVersion: ${s}`),{browser:n,browserVersion:this.getBrowserVersion(),clientType:i,clientContext:this.getClientContext(o),currentUrl:null===(t=null===(e=this.windowHost)||void 0===e?void 0:e.location)||void 0===t?void 0:t.href,osPlatform:this.getOsPlatform(),osVersion:this.getOSPlatformVersion(),platformId:a,userAgent:this.userAgent,localeCode:this.getLocaleCode(),isInIframe:this.getIsInIframe(),isInCypressFrame:this.getIsInCypressFrame(),isEdgeOrIE:n===si.AR.Edge||n===si.AR.IE,buildVersion:r,clientVersion:s,hostingParent:o,getLocaleInfoAsync:this.windowHost.getLocaleInfoAsync,userLanguage:d,publicPath:l,staticsPath:c,vdi:this.getVdiConfig(),isInternalUser:this.headConfig.isInternalUser}}getPlatformIdFromCookie(){const e=Cs.get("platformId");return void 0===e||e.length<1?void 0:parseInt(e,10)}getHostUrl(){const e=this.windowHost.localStorage.getItem("ecsHostUrl")||this.headConfig.ecsHostUrl;if(e)return new URL(e,this.windowHost.location.origin).href}computeEcsOverrides(){const e=this.getHostUrl(),t=(0,j.get)(he.s,function(e,t){let n=(null==t?void 0:t.environment)||"prod";return"infer"===n&&(n=function(e){return e.location.origin.includes("live")?"life":"dev"}(e)),n}(this.windowHost,this.headConfig)),n=this.getRingOverride(),{originalRing:i,unauthenticated:a}=this.headConfig;return Object.assign(Object.assign({hostUrl:e},this.getRingConfig(t,n)),{originalRing:i,unauthenticated:a})}getLocaleCode(){const e=this.getQspLocale();if(e)return e;const t=this.windowHost.getHostedWindowContext(),n="localeCode";return t&&t.localeCode?(this.windowHost.localStorage.setItem(n,t.localeCode),t.localeCode):this.headConfig.localeCode||this.windowHost.localStorage.getItem(n)||"en-us"}getQspLocale(){if(this.queryStringParameters.localeCode)return this.queryStringParameters.localeCode;if(this.queryStringParameters.language)return this.queryStringParameters.language.toLowerCase();if(!this.queryStringParameters.setting)return;const e=this.queryStringParameters.setting;let t;if(Array.isArray(e)){for(const n of e)if(n.startsWith("localeCode:")){t=n;break}}else e.startsWith("localeCode:")&&(t=e);return t?t.split(":")[1]:void 0}getRingOverride(){if(this.headConfig.isInternalUser&&this.queryStringParameters.ring)return this.queryStringParameters.ring;const e=this.windowHost.getHostedWindowContext();if(null==e?void 0:e.ring)return e.ring;const{ring:t}=this.headConfig;return t?"string"==typeof t?t:t.id:void 0}getHostingParent(){const e=yy(this.windowHost);return e&&e.dataset&&"outlook"===e.dataset.host?si.GJ.Outlook:si.GJ.Unknown}getClientContext(e){return e===si.GJ.Outlook?si.RY.Embed:void 0}getIsInIframe(){return!!this.windowHost.getHostedWindowContext().isInIframe}getIsInCypressFrame(){return!!this.windowHost.getHostedWindowContext().isInCypressFrame}}class Cy{constructor(){this.id=S.Yg.CreatePlatform}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{windowProvider:t,loggerFactory:n,routingServices:i}=e;e.platformService=new _y(n,i,t)}))}}var wy,Ty;!function(e){e.LoadModuleProfilerFailed="LoadModuleProflierFailed",e.ExecuteCommandFailed="ExecuteCommandFailed"}(wy||(wy={})),function(e){e.LoadModuleProfilerSuccess="LoadModuleProfilerSuccess",e.ExecuteCommandSuccess="ExecuteCommandSuccess"}(Ty||(Ty={}));class Ey{constructor(e,t){this.hostCommunicationService=t,this.logger=e.newLogger("ProfilerService"),this.exposeToCoreWindow()}getHeapSnapshot(e=!0){var t;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.getProfilerModuleAsync();if(!n)return;e&&(yield this.requestTriggerGC());const i=yield null===(t=n.getHeapSnapshot)||void 0===t?void 0:t.call(n);return(null==i?void 0:i.snapshot)?i.snapshot:void 0}))}getMemoryTracing(){var e;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.getProfilerModuleAsync();if(!t)return;const n=yield null===(e=t.getMemoryTracing)||void 0===e?void 0:e.call(t,{duration:5e3});return(null==n?void 0:n.data)?n.data:void 0}))}requestTriggerGC(){var e;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.getProfilerModuleAsync();if(!t)return!1;const n=yield null===(e=t.triggerGC)||void 0===e?void 0:e.call(t);return!!(null==n?void 0:n.status)}))}startMemoryTracing(e=!0){var t;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.getProfilerModuleAsync();if(!n)return!1;e&&(yield this.requestTriggerGC());const i=yield null===(t=n.startMemoryTracing)||void 0===t?void 0:t.call(n);return!!(null==i?void 0:i.status)}))}stopMemoryTracing(e=!0){var t;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.getProfilerModuleAsync();if(!n)return;e&&(yield this.requestTriggerGC());const i=yield null===(t=n.stopMemoryTracing)||void 0===t?void 0:t.call(n);return(null==i?void 0:i.data)?i.data:void 0}))}getProfilerModuleAsync(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){let e;try{e=yield this.hostCommunicationService.loadModule("profiler"),this.logger.log(`Profiler:: ${Ty.LoadModuleProfilerSuccess}`)}catch(e){this.logger.error(`Profiler:: ${wy.LoadModuleProfilerFailed} ${(0,P.u4)(e)}`)}return e}))}exposeToCoreWindow(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.hostCommunicationService.loadModule("profiler"),t=yield this.hostCommunicationService.loadModule("heartbeat");e&&t?globalThis.window.profiler=Object.assign(Object.assign({},e),{getTotalWorkingSetSizeBytes:()=>this.getWorkingSetSizeFromProcesses(null==t?void 0:t.getPerfMetrics)}):this.logger.log("HostComms is unable to load profiler and/or heartbeat module. We are running on Web or Teams 1.0. Bailing out.")}))}getWorkingSetSizeFromProcesses(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){if(e){const t=yield e();return null==t?void 0:t.reduce(((e,t)=>(e.workingSetSizeBytes+=t.workingSetSizeBytes,e)),{workingSetSizeBytes:0}).workingSetSizeBytes}return this.logger.warn("Unable to get perf metrics."),-1}))}}class Iy{constructor(){this.id=S.Yg.CreateProfiler}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){e.profilerService=new Ey(e.loggerFactory,e.hostCommunicationService)}))}}class Ny{constructor(e,t,n,i,a,o,r){this.loggerFactory=e,this.host=t,this.clientStateProvider=n,this.networkStateProvider=i,this.platformService=a,this.hostCommunicationService=o,this.localStorage=r,this.clientStateSubscription=null,this.didUrlChange=e=>(0,li.IC)(e)!==(0,li.IC)(this.host.location.href),this.areMaxRetriesExhausted=(e,t)=>{if(null==t?void 0:t.maxRetries){const n=this.getRetryStorageKey(e),i=this.localStorage.get(n,S.fO.Experience),a=i&&parseInt(i,10)||0,o=a>=t.maxRetries;return this.logger.warn(`Max retries exhausted for '${e}', retries: ${a}, maxRetries: ${t.maxRetries}`),this.localStorage.set(n,`${a+1}`,S.fO.Experience),o}return!1},this.getRetryStorageKey=e=>`rebootRetries.${e}`,this.logger=this.loggerFactory.newLogger("rebootService")}rebootApp(e,t,n){var i;return(0,l.__awaiter)(this,void 0,void 0,(function*(){if(null===(i=this.clientStateSubscription)||void 0===i||i.unsubscribe(),this.logger.log(`Reboot app triggered for ${e} from ${t} with options:`,n),this.areMaxRetriesExhausted(t,n))return!1;try{const i=this.getReloadUrl(n,t);this.platformService.config.clientType===si.Bh.Maglev?yield this.rebootThroughDesktopApi(i,t,e):this.didUrlChange(i)?this.host.location.replace(i):this.host.location.reload()}catch(e){return this.logger.error("Reboot app failed"),!1}return!0}))}rebootWhenLongInactive(e,t,n){return this.clientStateSubscription?(this.logger.log(`Reboot subscription failed from ${t} with reason ${e}`),!1):(this.logger.log(`Reboot when longInactive is subscribed from ${t} with reason ${e}`),this.clientStateSubscription=this.clientStateProvider.observe().subscribe((i=>this.handleClientStateChange(i,e,t,n))),!0)}clearRetryCount(e){this.localStorage.remove(this.getRetryStorageKey(e),S.fO.Experience)}dispose(){var e;null===(e=this.clientStateSubscription)||void 0===e||e.unsubscribe()}rebootThroughDesktopApi(e,t,n){var i;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const a=yield this.hostCommunicationService.loadModule("core");a?null===(i=a.relaunch)||void 0===i||i.call(a,{url:e,reason:`${n}; source: ${ev.d[t]}`}):this.logger.error("HostComms is unable to load core module.")}))}handleClientStateChange(e,t,n,i){this.networkStateProvider.getState()===Hi.Online?(this.logger.log(`Handling clientState change to ${e}.`),e===Dn.pk.LongInactive&&this.rebootApp(t,n,i)):this.logger.log(`Reboot skipped, network state is offline when client state change to ${e}.`)}getReloadUrl(e,t){const n=new URL((null==e?void 0:e.customUrl)||this.host.location.href),i=n.searchParams;i.delete("tenantId"),n.hash=this.getReloadHash(t,n.hash);const a=(null==e?void 0:e.qsps)||{};return Object.keys(a).forEach((e=>{i.set(e,a[e])})),n.toString()}getReloadHash(e,t){if(this.platformService.config.clientType===si.Bh.Maglev){let n;if(gv(t).deepLink===Zh.core)n=Zh.core;else switch(e){case ev.d.WebClientUpdateService:n=Zh.core;break;default:n=Zh.default}return`deepLink=${n}&source=${ev.d[e]}`}return""}}class Ay{constructor(){this.id=S.Yg.CreateReboot}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{windowProvider:t,loggerFactory:n,clientState:i,networkState:a,platformService:o,hostCommunicationService:r,localStorage:s}=(e=>Ko("CreateRebootTask",e,"windowProvider","loggerFactory","clientState","networkState","platformService","hostCommunicationService","localStorage"))(e);e.rebootService=new Ny(n,t,i,a,o,r,s)}))}}var My,Fy,Ry,Py=n(88637),Dy=n(432490);class jy{constructor(){this.id=S.Yg.CreateRouting}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const t=e.config.forceUseBrowserHistory||!e.windowProvider||""===e.windowProvider.location.hash?(0,Py.lX)({basename:e.config.basePath}):(0,Py.q_)({basename:e.config.basePath});e.history=t,e.routingServices=(0,Dy.I)(e.loggerFactory,e.history,e.windowProvider&&e.windowProvider.location)}))}}function xy(e,t){const n=e.get(t);return n&&n.context}function Oy(e){return e.has(fe.yU.UserAuthenticated)&&e.has(fe.yU.UserConsentedToConsumeResources)}function Ly(e,t){let n=[];const i=e[t.state];return i&&(n=n.concat(i({context:t.context}))),n}function Uy(e,t,n){let i;if(e){const{app:a,state:o,callback:r}=e;let s=r();if(s){const e=s.length;if(e>0){t.log(`App:${a.manifest.id} supports the state: ${o}, job count returned from the app: ${e}.`),s=s.filter((e=>function(e,t,n){if(n===Ry.start)return!1;const i=t&&t[n];if(Array.isArray(i))return i.indexOf(e)>-1;if(n===Ry.onPreWarm)return!1;return!0}(e.id,n,o)));const i=s.length;i!==e&&t.log(`Jobs filtering by permissions took place. Job count is now: ${i}`)}i={state:o,jobs:s}}}return i}function By({app:e,currentChanges:t,getCachedSupportSet:n,sessionContext:i}){const a=function(e){if(e.has(fe.c4.Initialized))return;const t=xy(e,fe.yU.ActiveEntitiesResolved);return Oy(e)&&t?t:void 0}(t);if(a)return{app:e,state:Ry.onPreInit,callback:()=>function(e,t,n){let i;const a=n(),{entities:o,target:r}=t,s=(0,l.__rest)(t,["entities","target"]);for(const t of o)if(t&&a&&a.has(t.type)){i=i||[];const n=Ly(e,{context:Object.assign(Object.assign({},s),{entity:t}),state:Ry.onPreInit});i=i.concat(n)}return i}(e,Object.assign(Object.assign({},i),a),n)}}function Wy({app:e,currentChanges:t,sessionContext:n}){const i=function(e){if(e.has(fe.c4.Warm))return;const t=xy(e,fe.yU.CoreDeepLinkResolved),n=Oy(e)&&(t&&t.deepLinkType===Zh.core||e.has(fe.FV.LayoutRenderComplete)),i=Array.from(e.values()).pop();return n&&(null==i?void 0:i.context)}(t);if(i){const t=Ry.onPreWarm;return{app:e,state:t,callback:()=>Ly(e,{context:Object.assign(Object.assign({},n),i),state:t})}}}function Hy({appId:e,jobState:t,change:n,currentChanges:i,logger:a}){let o;if(t){const{jobs:r,state:s}=t,l=function(e,t){let n;switch(e){case Ry.start:n=fe.c4.Started;break;case Ry.onPreInit:n=fe.c4.Initialized;break;case Ry.onPreWarm:n=fe.c4.Warm}return function(e,{correlationId:t,windowId:n,context:{target:i}}){return{type:e,context:{target:i},correlationId:t,windowId:n}}(n,t)}(s,n);i.set(l.type,l),a.debug(`Life Cycle - Change type: ${n.type}, initiated by: ${n.context.target}. Resulted in app:${e} transition to state: ${s} and job count: ${r.length}`),o={change:l,jobs:r}}return o}function $y({application:e,appLifeCyclePermissions:t,change:n,currentChanges:i,getNextState:a,getCachedSupportSet:o,logger:r,sessionContext:s}){const l=Uy(a({currentChanges:i,app:e,change:n,getCachedSupportSet:o,sessionContext:s}),r,t);return Hy({appId:e.manifest.id,jobState:l,change:n,currentChanges:i,logger:r})}!function(e){e.incomplete="incomplete",e.success="success",e.failure="failure"}(My||(My={})),function(e){e.LifeCycleReport="life_cycle_report"}(Fy||(Fy={})),function(e){e.start="start",e.onPreInit="onPreInit",e.onPreWarm="onPreWarm"}(Ry||(Ry={}));class Vy{constructor(e,t){this._appLifeCyclePermissions=e,this._sessionContext=t,this._currentChanges=new Map,this._logger=t.loggerFactory.newLogger("ApplicationLifeCycleManager")}get managedId(){var e;return null===(e=this._application)||void 0===e?void 0:e.manifest.id}manageApplication(e){this._application=e}onChange(e){const t=[];if(!this._application)return t;this._currentChanges.set(e.type,e);const n=[By,Wy];for(const i of n){const n=$y({application:this._application,appLifeCyclePermissions:this._appLifeCyclePermissions,change:e,currentChanges:this._currentChanges,getNextState:i,getCachedSupportSet:()=>this.supportedSets,logger:this._logger,sessionContext:this._sessionContext});n&&t.push(n)}return t}get supportedSets(){return this._supportedEntitySet=this._supportedEntitySet||this._application&&function(e){const t=e.manifest.supportedEntities,n=new Set;return t&&t.reduce(((e,t)=>e.add(t)),n),n}(this._application),this._supportedEntitySet}}function zy({applicationManagers:e,change:t,logger:n,scheduler:i}){const a=[];return e.forEach((e=>{const o=e.managedId,r=e.onChange(t);o&&r.length>0&&r.forEach((e=>a.push(function(e,t,n,i){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{jobs:a,change:o}=e,r=[];a.forEach((e=>{r.push(function(e,t,n){var{job:i}=e,a=(0,l.__rest)(e,["job"]);return new Promise(((e,o)=>{t.schedule((()=>(0,l.__awaiter)(this,void 0,void 0,(function*(){try{const t=yield i();return e(t),t}catch(e){throw o(e),e}}))),Object.assign(Object.assign({priority:nn.vW.Macro},a),{scheduledById:"services-life-cycle-manager"}),n)===nn.o_&&e(void 0)}))}(e,i,o.correlationId))}));let s=My.incomplete;try{yield Promise.all(r),s=My.success}catch(e){t.error(`Not all jobs scheduled by ${n} completely successfully. Continuing execution of remaining jobs. Error: ${e.message?e.message:e}`),s=My.failure}return Promise.resolve({id:n,type:o.type,stateJobStatus:s,jobCount:a.length})}))}(e,n,o,i))))})),{change:t,lcChanges:a}}function Gy({change:e,lcChanges:t}){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const n=yield Promise.all(t);return{change:e,lcChanges:n}}))}class qy{constructor(e,t,n,i,a,o){this._scheduler=e,this._experienceChangeReportingService=t,this._sessionContext=n,this._lifeCycleChangeReportingService=i,this._lifeCycleJobPermissions=o,this._applicationManagers=[],this._activelyManagedApplications=new Set,this._lifeCycleJobPermissions=this._lifeCycleJobPermissions||{},this._logger=a.newLogger("LifeCycleManager")}init(){const e=this._experienceChangeReportingService.observeChanges();this._subscription=e.pipe((0,y.U)((e=>zy({applicationManagers:this._applicationManagers,change:e,logger:this._logger,scheduler:this._scheduler}))),(0,h.b)(Gy),(0,y.U)((e=>function({change:e,lcChanges:t},n){const{type:i}=e;return 0===t.length&&n.debug(`Experience change type: ${i} produced no application life cycle changes`),Object.assign(Object.assign({},e),{type:Fy.LifeCycleReport,context:{apps:t,target:"life_cycle_manager",reportedChange:e}})}(e,this._logger))),(0,y.U)((e=>this._lifeCycleChangeReportingService.report(e)))).subscribe()}destroy(){this._subscription&&this._subscription.unsubscribe(),this._scheduler.destroy()}manageApplication(e){var t;if(!this._subscription)throw new Error("Unable to manage provided application prior to LifeCycleManager init.");if(this._activelyManagedApplications.has(e))return;this._activelyManagedApplications.add(e);const n=new Vy(null===(t=this._lifeCycleJobPermissions)||void 0===t?void 0:t.Application,this._sessionContext);n.manageApplication(e),this._applicationManagers.push(n)}}const Jy=({correlationId:e,windowId:t})=>`${e}:${t||S.QU}`,Ky=e=>`${e.changeCorrelationId}:${Jy(e)}`;const Qy=(e,t,n,i)=>{const a=function(e,t,n){const{context:{execution:i}}=e;return n||t.error(`Received a scheduler change in state: ${nn.Tf[i]} with no active scenario: ${JSON.stringify(e)}`),n}(e,t,i);if(a){const{correlationId:t,context:{execution:i,handle:o,meta:{id:r,priority:s,scheduledById:l,runOncePerId:c},target:d,error:u},type:m}=e;a.appendEventData({"Job.Id":r,"Job.Priority":nn.vW[s],"Job.ScheduledBy":l,"Job.RunOncePerId":c,target:d,correlationId:t,type:m,errorCode:null==u?void 0:u.code,message:null==u?void 0:u.message,context:null==u?void 0:u.context}),a.mark(`${A.ck.ScheduledJobStateChange}_${nn.Tf[i].toLocaleLowerCase()}_${o}`),n(a)}};function Yy({change:e,activeScenariosMap:t,scenarioName:n,scenarioKey:i,scenarioFactory:a}){const{context:{target:o},changeCorrelationId:r,correlationId:s,type:l,windowId:c}=e;let d=t.get(i);d||(d=a.newScenario(n),d.appendEventData({InstanceId:r,"EventInfo.CorrelationId":s,target:o,type:l,windowId:c}),d.mark(l),t.set(i,d))}class Xy{constructor(e,t,n,i,a){this._experienceChangeReportingService=e,this._lifeCycleChangeReportingService=t,this._schedulerChangeReporting=n,this._scenarioFactory=i,this._activeExpScenariosMap=new Map,this._activeAppScenariosMap=new Map,this._activeSchedulerScenariosMap=new Map,this._logger=a.newLogger("LifeCycleTelemetry")}init(){const e=e=>({change:e,scenarioFactory:this._scenarioFactory,activeAppScenariosMap:this._activeAppScenariosMap,activeExpScenariosMap:this._activeExpScenariosMap,activeSchedulerScenariosMap:this._activeSchedulerScenariosMap,logger:this._logger});this._experienceChangeSubscription=this._experienceChangeReportingService.observeChanges().pipe((0,y.U)((t=>function({change:e,scenarioFactory:t,activeAppScenariosMap:n,activeExpScenariosMap:i,logger:a}){const{type:o}=e;Yy({change:e,activeScenariosMap:n,logger:a,scenarioName:A.RG.ExperienceChange,scenarioKey:Ky(e),scenarioFactory:t}),o===fe.yU.ActiveEntitiesResolved&&Yy({change:e,activeScenariosMap:i,logger:a,scenarioName:A.RG.CriticalRenderStable,scenarioKey:Jy(e),scenarioFactory:t})}(e(t))))).subscribe(),this._lifeCycleChangeSubscription=this._lifeCycleChangeReportingService.observeChanges().pipe((0,y.U)((t=>function({change:e,activeAppScenariosMap:t,activeExpScenariosMap:n}){const{context:{apps:i,reportedChange:a}}=e,o=Ky(e),r=t.get(o);r&&(0===i.length?r.mark(`${A.ck.ApplicationLifeCycleStateChange}_no_transition`):i.forEach((({id:e,jobCount:t,stateJobStatus:n,type:i})=>{r.mark(`${A.ck.ApplicationLifeCycleStateChange}_${i}_jobs_result_${n}`,{"App.Id":e,"Job.Count":t})})),r.stop(),t.delete(o));const s=Jy(e),l=n.get(s);if(l){let e=!1;a.type!==fe.FV.LayoutRenderComplete&&a.type!==fe.FV.WindowStateChange||(l.stop(),e=!0),a.type===fe.yU.ActiveEntitiesDestroyed&&(l.cancel(),e=!0),e&&n.delete(s)}}(e(t))))).subscribe(),this._schedulingChangeSubscription=this._schedulerChangeReporting.observeChanges().pipe((0,y.U)((t=>function({change:e,activeSchedulerScenariosMap:t,scenarioFactory:n,logger:i}){const{context:{execution:a}}=e,o=(({windowId:e,context:{handle:t}})=>`${t}:${e}`)(e);let r=t.get(o);switch(a){case nn.Tf.Started:r?i.error(`Received a scheduler change in state: ${nn.Tf[a]} with an active scenario already running. Change: ${JSON.stringify(e)}`):(r=n.newScenario(A.RG.ScheduledJobComplete),t.set(o,r));break;case nn.Tf.Canceled:Qy(e,i,(e=>e.cancel()),r);break;case nn.Tf.Complete:Qy(e,i,(e=>e.stop()),r),t.delete(o);break;case nn.Tf.Received:i.log(`Received a scheduler change in state: ${nn.Tf[a]}: Change:${JSON.stringify(e)}`)}}(e(t))))).subscribe()}destroy(){this._experienceChangeSubscription&&this._experienceChangeSubscription.unsubscribe(),this._experienceChangeSubscription=void 0,this._lifeCycleChangeSubscription&&this._lifeCycleChangeSubscription.unsubscribe(),this._lifeCycleChangeSubscription=void 0,this._schedulingChangeSubscription&&this._schedulingChangeSubscription.unsubscribe(),this._schedulingChangeSubscription=void 0}}var Zy;!function(e){e.LifeCycleScopeChange="LifeCycleScopeChange"}(Zy||(Zy={}));class eS{constructor(){this.id=S.Yg.Scheduling}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{appsRegistryService:t,client:n,config:i,coreSettings:a,coreUtilities:o,entityCommanding:r,experienceChangeReportingService:s,hostCommunicationService:l,i18n:c,lifeCycleScopeChangeReportingService:d,loggerFactory:u,networkState:m,platformService:p,scenarioFactory:g,schedulerChangeReporting:h}=(e=>Ko("CreateSchedulingTask",e,"appsRegistryService","client","config","coreSettings","coreUtilities","entityCommanding","experienceChangeReportingService","hostCommunicationService","i18n","lifeCycleScopeChangeReportingService","loggerFactory","networkState","platformService","scenarioFactory","schedulerChangeReporting"))(e);new Xy(s,d,h,g,u).init();const v=new un(h,window,u,S.QU),{isEntityInView:f}=o,y=new qy(v,s,{client:n,coreSettings:a,entityCommanding:r,i18n:c,isEntityInView:f,loggerFactory:u,networkState:m,platformService:p,scenarioFactory:g,hostCommunicationService:l},d,u,i.lifeCycleJobPermissions);y.init(),t.registeredApps.forEach((e=>y.manageApplication(e))),e.scheduler=v}))}}class tS{initialize(e){e.debug("Initialized telemetry context service"),this.telemetryProvider=(0,Df.Yf)()}isInitialized(){return!!this.telemetryProvider}static getInstance(){return this.instance||(this.instance=new tS),this.instance}setContext(e,t,n){var i;null===(i=this.telemetryProvider)||void 0===i||i.setContext(e,t,n)}setDeviceAuthToken(e){var t;null===(t=this.telemetryProvider)||void 0===t||t.setDeviceAuthToken(e)}}function nS(){return tS.getInstance()}class iS{constructor(){this.id=S.Yg.InitTelemetry}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{loggerFactory:t}=Ko("CreateTelemetryContextTask",e,"loggerFactory"),n=t.newLogger("CreateTelemetryContextTask");nS().initialize(n)}))}}const aS="serviceWorkerDeferInstallDurationInMs",oS="enableServiceWorkerDynamicManifest",rS="localeSettingValue",sS="environment",lS="clientType",cS="swHandleCdlHashRoute",dS="teams-service-worker-telemetry-v2",uS="1",mS="LogEvents",pS="timestamp",gS="teams-service-worker-v2",hS="2",vS="SwState",fS="key";var yS,SS,kS,bS;!function(e){e.Install="install",e.Activate="activate",e.Fetch="fetch"}(yS||(yS={})),function(e){e.Intermediate="intermediate",e.Old="old"}(SS||(SS={})),function(e){e.Info="sw_info",e.InstallSuccess="sw_install_success",e.InstallFailure="sw_install_failure",e.ActivateSuccess="sw_activate_success",e.ActivateFailure="sw_activate_failure",e.FetchCacheMiss="sw_fetch_cache_miss",e.CleanupCacheSuccess="sw_cleanup_cache_success",e.CleanupCacheFailure="sw_cleanup_cache_failure",e.CleanupCacheRetry="sw_cleanup_cache_retry",e.CorruptCache="sw_corrupt_cache",e.CorruptCacheDeleteSuccess="sw_corrupt_cache_delete_success",e.CorruptCacheDeleteFailure="sw_corrupt_cache_delete_failure",e.DeferInstallStarted="sw_install_defer_started",e.DeferInstallCancelled="sw_install_defer_cancelled",e.DeferInstallCancelledOnMaxIncomplete="sw_install_defer_cancelled_max_incomplete",e.DeferInstallOldCacheCleanupInProgress="sw_install_defer_old_cache_cleanup_inprogress",e.DeferInstallTimerCompleted="sw_install_defer_timer_completed",e.DeferInstallRetryAttempted="sw_install_defer_retry",e.ResetInstallIncompleteCounterFailure="sw_install_reset_counter_failure",e.ResetCacheCleanupStateFailure="sw_reset_cache_cleanup_state_failure",e.InstallIntegrityCheckPerformed="sw_install_integrity_check_performed",e.ReadIndexedDbFailure="sw_read_indexeddb_failure",e.AssetSetGenerationFailure="sw_asset_set_generation_failure",e.WriteIndexedDbFailure="sw_write_indexeddb_failure"}(kS||(kS={})),function(e){e.Start="start",e.Success="success",e.Failure="failure",e.CacheMiss="cache_miss",e.HighLatency="high_latency",e.CDNAssetNotInManifest="cdn_asset_not_in_manifest",e.OfflineAssetStart="offline_asset_start",e.OfflineAssetSuccess="offline_asset_success",e.OfflineAssetFailure="offline_asset_failure",e.OfflineAssetCacheMiss="offline_asset_cache_miss"}(bS||(bS={}));const _S=3e5,CS=18e4,wS=72e5,TS="serviceWorkerCheckingForUpdates",ES="serviceWorkerUnregisterSuccess",IS="serviceWorkerUnregisterFailure",NS="serviceWorkerMaxUpdateFailureCountReached",AS="serviceWorkerRegistrationNotFound",MS=5;var FS=n(87912);class RS{constructor(e){this.context=e,this.fetchTelemetryStore=new Map,this.isSwInstalling=!1,this.isSwWaiting=!1,this.serviceWorkerUpdateFailureCount=0,this.basePath=this.context.config.basePath,this.loggerFactory=this.context.loggerFactory,this.logger=this.loggerFactory.newLogger("WebClientUpdateService"),this.rebootService=this.context.rebootService,this.host=this.context.windowProvider,this.scenarioFactory=this.context.scenarioFactory,this.enableSWSubscription=this.context.coreSettings.getObservable(b.J.Core).subscribe((e=>{this.registerOrUnregisterServiceWorker(!!e.enableServiceWorker)}))}cleanup(){this.enableSWSubscription.unsubscribe(),this.clearTimer()}checkForUpdateAndRestartWebClient(){this.configureServiceWorkerEvents(),this.addUpdateServiceWorkerSettings(!0),this.registerAndCheckForServiceWorkerUpdates()}sendMessageToServiceWorker(e,t){return new Promise(((n,i)=>{const a=new MessageChannel;a.port1.onmessage=e=>{e.data.error?i(e.data.error):n(e.data)},e.postMessage(t,[a.port2])}))}handleOnStateChange(e,t,n,i){switch(this.sendServiceWorkerLifeCycleEventTelemetry(),t){case"installed":this.handleInstalledSWState(i);break;case"activated":this.isSwWaiting=!1,this.setServiceWorkerContextForScenarios(!0);case"redundant":this.handleRedundantSWState(e,n)}e={state:t}}SendIncompleteEvent(e,t){this.fetchTelemetryStore.set(e.url,e),this.sendServiceWorkerFetchEventTelemetryInCompleteEvent(t)}setServiceWorkerContextForScenarios(e=!1){e?this.setScenarioContext(e):this.getServiceWorkerRegistration().then((e=>{this.setScenarioContext(!!e)}))}handleRedundantSWState(e,t){"installing"===e.state?(this.isSwInstalling=!1,this.scenarioFactory.markStep(A.RG.SwStateChange,A.ck.SwInstallFailure),t.fail(),this.serviceWorkerUpdateFailureCount++,this.triggerForceUpdate()):"installed"===e.state&&(this.isSwWaiting=!1),this.setServiceWorkerContextForScenarios(!0)}triggerForceUpdate(){this.serviceWorkerUpdateFailureCount>=MS&&(this.logger.error("Will force an update when the app is idle as SW update failed repeatedly with",NS),this.handleUpdateReady())}handleInstalledSWState(e){this.isSwInstalling=!1,this.isSwWaiting=!0,this.setServiceWorkerContextForScenarios(!0),this.scenarioFactory.markStep(A.RG.SwStateChange,A.ck.SwInstalled),this.scenarioFactory.stopScenarioIfActive(A.RG.SwStateChange),e||this.handleUpdateReady(),this.serviceWorkerUpdateFailureCount=0}logServiceWorkerTelemetry(){this.sendServiceWorkerFetchEventTelemetry(),this.recurringSendSWFetchEventTelemetryInterval=this.host.setInterval(this.sendServiceWorkerFetchEventTelemetry.bind(this),_S),this.sendServiceWorkerLifeCycleEventTelemetry()}sendServiceWorkerLifeCycleEventTelemetry(){const e=parseInt(uS,10);(0,FS.q8)(dS,e,mS,pS,this.scenarioFactory,!0).then((e=>{var t;if(void 0!==e){let n=0;const i=null!==(t=this.recentProcessedLifeCycleEventTimestamp)&&void 0!==t?t:-1;e.map((e=>{var t;const a=null!==(t=e.timestamp)&&void 0!==t?t:0;a>i&&(this.sendServiceWorkerLifeInfoAndInstallTelemetry(e),n=Math.max(n,a))})),this.recentProcessedLifeCycleEventTimestamp=n}})).catch((e=>{this.logger.error("Error fetching service worker state telemetry. Error:",e)})).then((()=>(0,FS.dR)(dS,e,mS,pS,this.scenarioFactory).catch((e=>{this.logger.error("Error deleting service worker state telemetry. Error:",e)}))))}sendServiceWorkerLifeInfoAndInstallTelemetry(e){const t={message:e.message,version:e.version,type:e.type};this.scenarioFactory.newScenario(A.RG.SwStateInfo).stop(t),e.type===kS.InstallSuccess?this.scenarioFactory.newScenario(A.RG.SwInstall).stop(t):e.type===kS.InstallFailure&&this.scenarioFactory.newScenario(A.RG.SwInstall).fail(t)}registerServiceWorker(){const e=this.scenarioFactory.newScenario(A.RG.SwRegistration);this.host.navigator.serviceWorker.register(`/${this.basePath}/serviceworker.js`,{updateViaCache:"all"}).then((t=>{e.stop(),this.attachEventsToInstallingServiceWorker(t,!0)})).catch((t=>{e.fail({message:`Error: ${t}`})}))}handleUpdateReady(){this.skipWaitingServiceWorkerIfNeeded(),this.rebootService.rebootWhenLongInactive("App got updated using Service Worker",ev.d.WebClientUpdateService)}unregisterServiceWorker(){"serviceWorker"in this.host.navigator&&(this.getServiceWorkerRegistration().then((e=>{e&&e.unregister().then((e=>{this.logger.log(ES)}))})).catch((e=>{this.logger.error(IS,e)})),this.DeleteCacheStorage(),this.clearTimer())}DeleteCacheStorage(){if(void 0!==this.host.caches){const e=this.scenarioFactory.newScenario(A.RG.SwCleanupSwCache);this.host.caches.delete(S.eL).then((t=>{t?e.stop():e.fail({reason:"cache not found"})}))}}registerAndCheckForServiceWorkerUpdates(){this.getServiceWorkerRegistration().then((e=>{e?(this.logger.log(TS),e.update()):(this.logger.log(AS),this.registerServiceWorker())})).catch((e=>{this.logger.error(`Error getting Service Worker registration object: ${e}`)}))}configureServiceWorkerEvents(){"serviceWorker"in this.host.navigator&&this.getServiceWorkerRegistration().then((e=>{e?(this.attachEventsToInstallingServiceWorker(e),e.onupdatefound=()=>{this.attachEventsToInstallingServiceWorker(e)}):this.logger.log(AS)}))}registerServiceWorkerAndLogTelemetry(){this.cleanupServiceWorkerCache(),this.addUpdateServiceWorkerSettings(),this.registerServiceWorker(),this.logServiceWorkerTelemetry()}addUpdateServiceWorkerSettings(e=!1){var t,n;const i=[],{serviceWorkerDeferInstallDurationInMs:a,enableServiceWorkerDynamicManifest:o,handleCdlHashRouteInServiceWorkerInstall:r}=this.context.coreSettings.get(b.J.Core);a&&Number.isInteger(a)&&this.swDeferInstallDurationInMs!==a&&(this.swDeferInstallDurationInMs=a,i.push({key:aS,value:this.swDeferInstallDurationInMs})),this.swEnableDynamicManifest!==o&&(this.swEnableDynamicManifest=null!=o&&o,i.push({key:oS,value:this.swEnableDynamicManifest})),this.swhandleCdlHashRoute!==r&&(this.swhandleCdlHashRoute=null!=r&&r,i.push({key:cS,value:this.swhandleCdlHashRoute}));const s=null!==(n=null===(t=this.context.i18NextWrapper)||void 0===t?void 0:t.locale)&&void 0!==n?n:"en-us";if(this.localeSetting!==s&&(this.localeSetting=s,i.push({key:rS,value:this.localeSetting})),!e){i.push({key:sS,value:this.context.platformService.ecsOverrides.environment.toString()});const e=this.context.platformService.config.clientType===si.Bh.Maglev?"desktop":this.context.platformService.config.clientType.toString();i.push({key:lS,value:e})}i.length&&this.writeSettingsInServiceWorkerDb(i)}writeSettingsInServiceWorkerDb(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const t=parseInt(hS,10);yield(0,FS.Zl)(gS,t,vS,fS,e,this.scenarioFactory).then((()=>{this.logger.log("Successfully updated service worker settings in Indexed DB")})).catch((e=>{this.logger.error("Error updating service worker settings in Indexed DB. Error:",e)}))}))}sendServiceWorkerFetchEventTelemetry(){this.host.navigator.serviceWorker.controller&&this.sendMessageToServiceWorker(this.host.navigator.serviceWorker.controller,"getFetchTelemetryEvents").then((e=>{e.forEach((e=>{this.sendServiceWorkerFetchEventTelemetryCompletedEvent(e)}))})).catch((e=>{this.logger.error("Error getting service worker fetch telemetry. Error:",e)})),this.sendServiceWorkerFetchEventTelemetryInCompleteEvent(_S)}sendServiceWorkerFetchEventTelemetryInCompleteEvent(e){const t=Date.now();this.fetchTelemetryStore.forEach(((n,i)=>{if(void 0===e||t-n.timestamp>e){const e={endpointUrl:n.url,delta:t-n.timestamp,operationType:n.type,version:n.version,message:n.message},a=n.type===bS.OfflineAssetStart?A.RG.SwOfflineAssetFetchEvent:A.RG.SwFetchEvent;this.scenarioFactory.newScenario(a).cancel(e),this.fetchTelemetryStore.delete(i)}}))}sendServiceWorkerFetchEventTelemetryCompletedEvent(e){const t={endpointUrl:e.url,operationType:e.type,message:e.message,version:e.version};if(this.captureFetchEvent(e,t)){let n=A.RG.SwFetchEvent;this.isOfflineFetchOperation(e.type)&&(n=A.RG.SwOfflineAssetFetchEvent);const i=this.scenarioFactory.newScenario(n);this.sendFetchEvent(i,e.type,t)}}isOfflineFetchOperation(e){let t;switch(e){case bS.OfflineAssetSuccess:case bS.OfflineAssetFailure:case bS.OfflineAssetCacheMiss:t=!0;break;default:t=!1}return t}sendFetchEvent(e,t,n){switch(t){case bS.Success:case bS.OfflineAssetSuccess:case bS.CacheMiss:case bS.OfflineAssetCacheMiss:e.stop(n);break;case bS.Failure:case bS.OfflineAssetFailure:e.fail(n);break;default:e.incomplete(n)}}captureFetchEvent(e,t){switch(e.type){case bS.Start:case bS.OfflineAssetStart:return this.fetchTelemetryStore.set(e.url,e),!1;case bS.Failure:case bS.Success:case bS.OfflineAssetFailure:case bS.OfflineAssetSuccess:case bS.CDNAssetNotInManifest:case bS.CacheMiss:case bS.OfflineAssetCacheMiss:const n=this.fetchTelemetryStore.get(e.url);return n?(t.delta=e.timestamp-n.timestamp,this.fetchTelemetryStore.delete(e.url)):t.reason="orphan",!0;case void 0:return this.logger.error("unexpected fetch event type:",e.type),!1}return!1}clearTimer(){this.host.clearInterval(this.recurringCheckForUpdateInterval),this.host.clearTimeout(this.registerSWAndLogTelemetryTimer),this.host.clearInterval(this.recurringSendSWFetchEventTelemetryInterval)}registerOrUnregisterServiceWorker(e){if(e){if(!this.recurringCheckForUpdateInterval){this.recurringCheckForUpdateInterval=this.host.setInterval((()=>this.checkForUpdateAndRestartWebClient()),wS);const{serviceWorkerRegistrationDelayInMs:e}=this.context.coreSettings.get(b.J.Core),t=e&&Number.isInteger(e)?e:CS;this.registerSWAndLogTelemetryTimer=this.host.setTimeout((()=>this.registerServiceWorkerAndLogTelemetry()),t)}}else this.unregisterServiceWorker();this.setServiceWorkerContextForScenarios()}setScenarioContext(e){var t,n;null===(n=(t=this.scenarioFactory).setContext)||void 0===n||n.call(t,{isServiceWorkerRegistered:e,isServiceWorkerActive:by(this.host),isServiceWorkerInstalling:this.isSwInstalling,isServiceWorkerWaiting:this.isSwWaiting})}attachEventsToInstallingServiceWorker(e,t=!1){if(!e||!e.installing)return;const n=this.scenarioFactory.newScenario(A.RG.SwStateChange);this.scenarioFactory.markStep(A.RG.SwStateChange,A.ck.SwInstalling);const i=e.installing,a={state:i.state};this.isSwInstalling=!0,this.setServiceWorkerContextForScenarios(!0),i.onstatechange=()=>this.handleOnStateChange(a,i.state,n,t)}skipWaitingServiceWorkerIfNeeded(){"serviceWorker"in this.host.navigator&&this.getServiceWorkerRegistration().then((e=>{e&&e.waiting&&e.waiting.postMessage("skipWaiting")}))}getServiceWorkerRegistration(){return this.host.navigator.serviceWorker.getRegistration(`/${this.basePath}/serviceworker.js`)}cleanupServiceWorkerCache(){"serviceWorker"in this.host.navigator&&this.host.navigator.serviceWorker.controller&&this.sendMessageToServiceWorker(this.host.navigator.serviceWorker.controller,"cleanupOldCache").catch((e=>{this.logger.error("Send cleanupOldCache message to service worker failed. Error:",e)}))}}var PS=n(356773);class DS{constructor(){this.id=S.Yg.CreateWindow,this.registerShellHandlers=(e,t)=>{e.opener.addEventListener(R.rY.GetLogs,(()=>{const n=t.getDiagnosticsEvents();e.opener.postMessage(R.rY.GetLogs,{logs:n})}))}}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const t=PS.n.getInstance(),n=t.config.hostedWindowContext,i=t.window;i.onAppStart();const{diagnosticsService:a}=e;this.registerShellHandlers(i,a),e.hostedWindowContext=n,e.windowProvider=i}))}}class jS{constructor(){this.id=S.Yg.DiscoverUser}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{discover:t}=e;e.user=yield t.getUser()}))}}var xS=n(91741);class OS{constructor(){this.id=S.Yg.InitATPPolicyTask}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{authenticationService:t,coreSettings:n,gtmRegistry:i,scenarioFactory:a,localStorage:o,loggerFactory:r}=e,{enableFastSharepointSafelinks:s}=n.get(b.J.Messaging),l=r.newLogger("InitATPPolicyTask");if(!(null==s?void 0:s.enabled))return void l.log("InitATPPolicyTask - Do nothing, FF is disabled");const c=new xS.c(i.bind(Us.l,cs.Pn.middleTier),t,n,a,r,o);l.log("Getting ATP Safelinks policy"),c.initPolicy()}))}}const LS={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"removeAuthenticatedUser"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"reason"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"removeAuthenticatedUser"},arguments:[{kind:"Argument",name:{kind:"Name",value:"reason"},value:{kind:"Variable",name:{kind:"Name",value:"reason"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"succeed"}}]}}]}}]};let US;class BS{constructor(e,t,n,i,a,o,r,s){var l,c;this._auth=e,this._client=t,this._discover=n,this._networkStateProvider=i,this._scenarioFactory=a,this._windowProvider=o,this._keepTokenActive=!1,this._keepCheckingSignInRestrictions=!1,this._isLoginRequired=void 0,this._tokenIntervalId=void 0,this._logger=r.newLogger("AuthTokenStoreService"),this._mtResourceKey=(null===(l=null==s?void 0:s.get(b.J.Auth))||void 0===l?void 0:l.mtResource)||ga.ej.MT_AAD_KEY,this._tokenWarmingIntervalInMs=(null===(c=null==s?void 0:s.get(b.J.Auth))||void 0===c?void 0:c.tokenWarmingIntervalInMs)||vo.lP.MT_TOKEN_INTERVAL,this._subscriptions=new Map,this.observeIsLoginRequired(),this.observeAppOnlineState()}observe(e){let t=this._subscriptions.get(e);return t||(t=this.createSubscription(e),this._subscriptions.set(e,t)),t}createSubscription(e){let t;switch(e){case ga.ej.MT_KEY:this._keepTokenActive=!0,t=this._auth.observeMiddleTierToken(),this.keepTokenActive();break;case ga.ej.SIGNIN_RESTRICTIONS_KEY:this._keepCheckingSignInRestrictions=!0,this.keepTokenActive();break;default:this._logger.error("Unable to create subscription, token key %s is not supported",e)}return t}keepTokenActive(){this._tokenIntervalId||(this._keepTokenActive||this._keepCheckingSignInRestrictions)&&(this._tokenIntervalId=this._windowProvider.setInterval((()=>{if(this._keepCheckingSignInRestrictions){let e=(0,pa.pW)();e=`sign${e.substr(ga.uI.FOUR)}`,this._auth.acquireToken(ga.ej.SIGNIN_RESTRICTIONS_KEY,{correlationId:e}).catch((e=>{this.handleSignInRestrictionsError(e)}))}this._keepTokenActive&&this._auth.acquireToken(this._mtResourceKey).then((()=>this._discover.validateSkypeToken())).catch((e=>{this._logger.error("Error occurred in keeping MT token active.",e)}))}),this._tokenWarmingIntervalInMs))}handleSignInRestrictionsError(e){var t,n;if(this._logger.error(`Error occurred in keeping SignInRestrictions token active. ErrorCode: ${null==e?void 0:e.errorCode}`,e),(null==e?void 0:e.errorCode)===ga.SM.SignInRestrictions){this._logger.error("Sign in restrictions was enabled and caught by the periodic check. Forcibly signing out the user");const e=this._scenarioFactory.newScenario(A.RG.AuthWebLogout);null===(n=(t=this._scenarioFactory).hoistScenarioToCore)||void 0===n||n.call(t,e),e.appendEventData({operation:ga.SM.SignInRestrictions}),this._client.mutate({mutation:LS,variables:{reason:ga.SM.SignInRestrictions}})}else this._logger.error("Sign in restrictions token acquisition threw an unexpected error",e)}observeIsLoginRequired(){this._auth.isLoginRequired.subscribe((e=>{if(this._isLoginRequired===e)return;const t=void 0===this._isLoginRequired;this._isLoginRequired=e,t||(this._isLoginRequired?this._tokenIntervalId&&(this._windowProvider.clearInterval(this._tokenIntervalId),this._tokenIntervalId=void 0):this.replayKeepTokenActiveState())}))}observeAppOnlineState(){this._networkStateProvider.observeIsOnline().subscribe((e=>{e?this.replayKeepTokenActiveState():this._tokenIntervalId&&(this._windowProvider.clearInterval(this._tokenIntervalId),this._tokenIntervalId=void 0)}))}replayKeepTokenActiveState(){if(0===this._subscriptions.size)return;const e=this._subscriptions.keys();let t=e.next();for(;!t.done;)this.keepTokenActive(),t=e.next()}}class WS{constructor(){this.id=S.Yg.InitAuthenticationService}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{client:t,discover:n,authenticationUser:i,authenticationService:a,networkState:o,loggerFactory:r,coreSettings:s,scenarioFactory:l}=e,{enableSignInRestrictions:c,prefetchTokens:d,disableTokenWarming:u}=s.get(b.J.Auth);if(!i)return;const m=((e,t,n,i,a,o,r)=>(US||(US=new BS(n,e,t,i,a,(0,F.J)(),o,r)),US))(t,n,a,o,l,r,s);c&&m.observe(ga.ej.SIGNIN_RESTRICTIONS_KEY),!u&&m.observe(ga.ej.MT_KEY),null==d||d.forEach((e=>e&&a.acquireToken(e).catch((()=>{}))))}))}}const HS="reactWebClient",$S="maglev";class VS{constructor(e,t){var n,i,a,o,r,s,l,d;this.coreSettings=e,this.hostCommunicationService=t;const u=this.coreSettings.get(b.J.Metadata);this.expConfigMetadata=[{client:HS,config:{expIds:null!==(a=null===(i=null===(n=u.configIds)||void 0===n?void 0:n.experiments)||void 0===i?void 0:i.join(","))&&void 0!==a?a:"",rolloutIds:null!==(s=null===(r=null===(o=u.configIds)||void 0===o?void 0:o.rollouts)||void 0===r?void 0:r.join(","))&&void 0!==s?s:"",eTag:null!==(l=u.eTag)&&void 0!==l?l:""}},{client:$S,config:{expIds:"",rolloutIds:"",eTag:null!==(d=u.hostETag)&&void 0!==d?d:""}}],this.subject=new c.X(this.expConfigMetadata),this.ecmObservable=this.subject.asObservable(),this.registerSyncHostEcm()}updateHostExperimentConfigMetadata(e){const t=e.find((e=>e.client===$S)),n=this.expConfigMetadata.findIndex((e=>e.client===$S));t&&n>-1&&(this.expConfigMetadata[n]=t,this.subject.next(this.expConfigMetadata))}updateWebExperimentConfigMetadata(e){var t;const n=null===(t=this.expConfigMetadata.find((e=>e.client===HS)))||void 0===t?void 0:t.config;n&&e.eTag&&e.configIds&&e.configIds.experiments&&(n.eTag=e.eTag,n.expIds=e.configIds.experiments.join(","))}communicateWithHost(){var e,t;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const n=null===(e=this.expConfigMetadata.find((e=>e.client===HS)))||void 0===e?void 0:e.config;if(!n)return;const i=yield this.hostCommunicationService.loadModule("ecs");if(!i)return;const a=yield null===(t=i.syncEcm)||void 0===t?void 0:t.call(i,[{client:HS,config:n}]);if(a&&a.client===$S){const e=[{client:$S,config:{eTag:a.config.eTag,expIds:a.config.expIds,rolloutIds:a.config.rolloutIds}}];this.updateHostExperimentConfigMetadata(e)}}))}registerSyncHostEcm(){this.hostCommunicationService.loadModule("ecs").then((e=>{var t;null===(t=null==e?void 0:e.registerForOnSyncEcm)||void 0===t||t.call(e,(e=>{this.updateHostExperimentConfigMetadata(e)}))}))}}class zS{constructor(){this.id=S.Yg.InitSettingsEcsProvider}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{authenticationService:t,clientState:n,coreSettingsContext:i,endpointsManager:a,networkState:o,scenarioFactory:r,windowProvider:s}=e;yield i.initializeEcsProvider(t,r,Us.l,o,n,s,a)}))}}class GS{constructor(e,t,n,i,a,o,r){this.scenarioFactory=a,this.host=o,this.clientStateProvider=r,this.namespacesToFetch=[],this.settings={},this.refreshIntervalInMs=36e5,this.fetch=()=>{if(0===this.namespacesToFetch.length)return this.logger.debug("Skipping fetch() as no namespacesToFetch registered."),Promise.resolve();const e=this.scenarioFactory.newScenario(this.getScenarioName());return this.validateEnvironment().then((()=>this.fetchPolicies(e))).catch((t=>{e.stop({errors:t},"abandoned"),this.logger.warn(`Error fetching policies: ${t}`)}))},this.validateEnvironment=()=>new Promise(((e,t)=>{this.clientStateProvider.getState()===Dn.pk.VeryActive&&(this.logger.log("Cancel policy fetching, due to app being in a very active state."),t("very active")),e()})),this.cleanupClientStateSubscription=()=>{var e;null===(e=this.clientStateSubscription)||void 0===e||e.unsubscribe(),this.clientStateSubscription=void 0},this.logger=e.newLogger(`CoreSettings/${t}`),this.namespacesToFetch=n("policies").namespaces||[],this.namespacesToFetch.forEach((e=>{this.settings[e]={}})),this.updateConfigs(i)}initialize(e=!0){return(0,l.__awaiter)(this,void 0,void 0,(function*(){this.isInitialized=!0,yield this.fetchAndSetRefreshCadence()}))}subscribeForSettingsUpdates(e){this.settingsChangedCallbackFunction=e}cleanup(){var e;this.cleanupClientStateSubscription(),this.settingsChangedCallbackFunction=void 0,null===(e=this.coreSubscription)||void 0===e||e.unsubscribe()}notifySettingsChanged(){const e=()=>{var e;this.cleanupClientStateSubscription(),null===(e=this.settingsChangedCallbackFunction)||void 0===e||e.call(this,this.settings),this.logger.debug("Notified about policy change")};return this.clientStateProvider.getState()!==Dn.pk.VeryActive?(e(),!0):(this.clientStateSubscription||(this.clientStateSubscription=this.clientStateProvider.observe().subscribe((t=>{t!==Dn.pk.VeryActive&&e()}))),!1)}handleError(e){this.logger.error(`Failed to fetch tenant settings with error: ${e}`)}updateConfigs(e){const t=e.getObservable(b.J.Core);this.coreSubscription=t.subscribe((e=>{e.policyRefreshIntervalInMs&&this.updateRefreshCadence(e.policyRefreshIntervalInMs)}))}updateRefreshCadence(e){this.refreshIntervalInMs=e,this.isInitialized&&this.queueNextPolicyFetch()}fetchAndSetRefreshCadence(){return this.fetch().then((()=>{this.queueNextPolicyFetch()})).catch((e=>{this.logger.error(`Error fetching policies: ${e}`)}))}queueNextPolicyFetch(){if(!this.isInitialized)throw new Error("Service not initialized to queue the fetch.");this.setIntervalHandle&&(this.host.clearInterval(this.setIntervalHandle),this.setIntervalHandle=void 0,this.logger.debug("clearInterval() called.")),this.refreshIntervalInMs>0?(this.setIntervalHandle=this.host.setInterval(this.fetch,this.refreshIntervalInMs),this.logger.debug("setInterval() called.")):this.logger.error(`Refresh interval not valid: ${this.refreshIntervalInMs}`)}}class qS extends GS{constructor(e,t,n,i,a,o){super(e,"PoliciesIpcDataProvider",t,n,i,a,o),this.handleSetAggregatedSettings=e=>{const{payload:t}=e;Object.keys(t).length>0?(this.logger.log(`handleSetAggregatedSettings() called: ${Object.keys(t).join(", ")}.`),this.parsePolicies(t),this.notifySettingsChanged()):this.logger.log("handleSetAggregatedSettings() called with empty payload.")},this.windowOpener=a.opener}initialize(e=!0){const t=Object.create(null,{initialize:{get:()=>super.initialize}});return(0,l.__awaiter)(this,void 0,void 0,(function*(){return this.windowOpener.addEventListener(R.rY.SetAggregatedSettings,this.handleSetAggregatedSettings),t.initialize.call(this)}))}cleanup(){super.cleanup(),this.windowOpener.removeEventListener(R.rY.SetAggregatedSettings,this.handleSetAggregatedSettings)}getScenarioName(){return A.RG.IPCPolicyFetch}fetchPolicies(e){return this.windowOpener.requestMessage(R.rY.GetAggregatedSettings).then((t=>{let n=!1,i="success";const a=null==t?void 0:t.data;a&&0!==Object.keys(a).length?(this.logger.log(`fetchPolicies: Got policies for namespaces: ${Object.keys(a).join(", ")}.`),this.parsePolicies(a),n=this.notifySettingsChanged()):(this.logger.log("Failed to fetch policies via IPC, got empty payload data response."),i="incomplete"),e.stop({message:(0,P.u4)({notified:n})},i)})).catch((t=>{var n;this.handleError(t),e.fail({errors:null!==(n=t.message)&&void 0!==n?n:"Failed to fetch policies via IPC."})}))}parsePolicies(e){this.namespacesToFetch.forEach((t=>{e[t]&&e[t].hasOwnProperty("value")&&(this.settings[t]=e[t].value)}))}}const JS={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"policies"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"namespaces"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"policies"},arguments:[{kind:"Argument",name:{kind:"Name",value:"namespaces"},value:{kind:"Variable",name:{kind:"Name",value:"namespaces"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"jsonData"}}]}}]}}]},KS={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"policiesUpdatedEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"policiesUpdatedEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"jsonData"}}]}}]}}]};class QS extends GS{constructor(e,t,n,i,a,o,r){super(e,"PoliciesResolversDataProvider",t,n,i,a,r),this.apolloClient=o,this.handlePoliciesUpdatedEvent=e=>{this.logger.log("handlePoliciesUpdatedEvent() called.");try{void 0!==e&&this.parsePolicies(e)?this.notifySettingsChanged():this.logger.log(`handlePoliciesUpdatedEvent(): policiesString is ${void 0===e?"undefined":"empty"}.`)}catch(e){this.logger.error(`handlePoliciesUpdatedEvent(): ${e.message}`)}}}initialize(e=!0){const t=Object.create(null,{initialize:{get:()=>super.initialize}});return(0,l.__awaiter)(this,void 0,void 0,(function*(){const e=this;return this.policiesApolloSubscription=this.apolloClient.subscribe({query:KS}).subscribe({next(t){var n,i,a;e.handlePoliciesUpdatedEvent(null!==(a=null===(i=null===(n=null==t?void 0:t.data)||void 0===n?void 0:n.policiesUpdatedEvent)||void 0===i?void 0:i.jsonData)&&void 0!==a?a:void 0)}}),t.initialize.call(this)}))}cleanup(){var e;super.cleanup(),null===(e=this.policiesApolloSubscription)||void 0===e||e.unsubscribe()}getScenarioName(){return A.RG.PoliciesFetchDataResolvers}fetchPolicies(e){return this.apolloClient.query({query:JS,variables:{namespaces:this.namespacesToFetch},fetchPolicy:"no-cache"}).then((t=>{var n,i;const a=null!==(i=null===(n=t.data.policies)||void 0===n?void 0:n.jsonData)&&void 0!==i?i:void 0;let o=!1,r="success";void 0!==a&&this.parsePolicies(a)?o=this.notifySettingsChanged():(this.logger.log(`fetchPolicies(): Failed to fetch policies, got ${void 0===a?"undefined":"empty"} response.`),r="incomplete"),e.stop({message:(0,P.u4)({notified:o})},r)})).catch((t=>{var n;this.handleError(t),e.fail({errors:null!==(n=t.message)&&void 0!==n?n:"Failed to fetch policies via resolvers."})}))}parsePolicies(e){let t={};try{t=JSON.parse(e)}catch(e){throw new Error("parsePolicies(): Unable to parse policies string.")}return 0!==Object.keys(t).length&&(this.namespacesToFetch.forEach((e=>{t[e]&&(this.settings[e]=t[e])})),!0)}}class YS{constructor(){this.id=S.Yg.InitSettingsPolicyProvider}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,coreSettingsContext:n,coreSettings:i,loggerFactory:a}=e,{disableNonBlockingPolicyProviderInit:o,disablePolicyProvider:r}=i.get(b.J.Core);if(r)return;if(!t||t.role===Pv.w.Anonymous)return;const s=this.createPoliciesDataProvider(e),{enableMainWindowPolicyFetch:l}=i.get(b.J.Host);if(l||o)yield n.initializePolicyProvider(s);else{const e=a.newLogger("InitPolicyProviderTask");n.initializePolicyProvider(s).then((()=>{e.log("Initialized policy provider successfully.")})).catch((t=>{e.error("Initialization of policy provider failed.",t)}))}}))}createPoliciesDataProvider(e){const{clientState:t,coreSettings:n,loggerFactory:i,scenarioFactory:a,windowProvider:o,client:r,configLoader:s}=e;let l;const{enableMainWindowPolicyFetch:c}=n.get(b.J.Host);return l=c?new qS(i,s,n,a,o,t):new QS(i,s,n,a,o,r,t),l}}class XS{constructor(e,t){this.isScenarioMemorySnapshotEnabled=e,this.globalWindow=t,this.cachedMemoryData={},this.cacheToExpireTime=0}snapshotMemoryUsage(){return this.isScenarioMemorySnapshotEnabled?(this.cacheToExpireTime<Date.now()&&this.snapshot(),this.cachedMemoryData):{}}snapshotMemoryUsageAsync(){if(!this.isScenarioMemorySnapshotEnabled)return Promise.resolve({});if(this.ongoingPromise)return this.ongoingPromise;const e=this.cacheToExpireTime-Date.now();return e>0?(this.ongoingPromise=new Promise((t=>{this.globalWindow.setTimeout((()=>{this.snapshot(),t(this.cachedMemoryData),this.ongoingPromise=void 0}),e)})),this.ongoingPromise):(this.snapshot(),Promise.resolve(this.cachedMemoryData))}snapshot(){this.cachedMemoryData={jsHeapStatistics:this.globalWindow.envPerformance.getJSHeapStatistics()||this.cachedMemoryData.jsHeapStatistics,processMemoryInfo:this.globalWindow.envPerformance.getProcessMemoryInfo()||this.cachedMemoryData.processMemoryInfo},this.cacheToExpireTime=Date.now()+3e4}}const ZS=12e4,ek={"cdl-request":!0,application_launch_time:!0},tk="Scenario.Step",nk="Scenario.Name";class ik{constructor(e,t,n,i,a,o,r,s,l,c=!1,d=!1,u=!1,m=A.t7.Expanded,p=0,g,h,v,f){var y,S,k;this._id=e,this._name=t,this._eventData=n,this.scenarioFactory=i,this.logger=a,this.timeout=o,this.diagnosticsService=r,this.callback=s,this.memoryAnalyzer=l,this.enableDiagnostics=c,this.markStepsInTrace=d,this.showAllConsoleLogs=u,this.scenarioMode=m,this._sequence=p,this.reportActivity=g,this.hostCommunicationService=h,this.crossClientOptions=v,this.clientId=f,this.steps=[],this.stepsEx=[],this.__stepsPerfInfo__=[],this.getTotalPauseDuration=()=>this.pauseInfo.totalTime,this._currentStep=A.ck.Unknown,this._previousStep=A.ck.Unknown,this._timestamps=[],this._isHoisted=!1,this.active=!0,this.pauseInfo={reason:"",startTime:0,totalTime:0,eventData:void 0,monitoringData:void 0};let b=0;n.overrideTimestamp?(b=n.overrideTimestamp-Date.now(),n.overrideTimestamp=void 0):n.offsetCurrentTimeInMs&&(b=-n.offsetCurrentTimeInMs,n.offsetCurrentTimeInMs=void 0),this._absoluteStartTime=Date.now()+b,this.intervalTimestamp=this.relativeTimestamp=this.scenarioFactory.timestamp({isCrossClient:null===(y=this.crossClientOptions)||void 0===y?void 0:y.enabled})+b,this.memoryDataInitial=null===(S=this.memoryAnalyzer)||void 0===S?void 0:S.snapshotMemoryUsage(),(null===(k=this.crossClientOptions)||void 0===k?void 0:k.enabled)&&this.syncStateToCrossClientStart(this.crossClientOptions)}get id(){return this._id}get name(){return this._name}get absoluteStartTime(){return this._absoluteStartTime}get delta(){return this.scenarioFactory.timestamp()-this.relativeTimestamp}get timeoutMs(){return this.timeout}set timeoutMs(e){this.timeout=e}get eventData(){return this._eventData}set eventData(e){this._eventData=e}get timestamps(){return this._timestamps}get currentStep(){return this._currentStep}get isPaused(){return!!this.pauseInfo.startTime}set isHoisted(e){this._isHoisted=e}get isHoisted(){return this._isHoisted}appendEventData(e){this.eventData=Object.assign(Object.assign({},this.eventData),e)}markAggregateStart(e){this.active?this.isPaused?this.logger.debug(`[Scenario]${this.name} - ignoring aggregated start step [${e}] due to paused state`):(this.aggregateStepStartTime||(this.aggregateStepStartTime={}),this.aggregateStepStartTime[e]||(this.aggregateStepStartTime[e]=performance.now())):this.logger.debug(`[Scenario]${this.name} - ignoring aggregated start step [${e}] due to inactive`)}markAggregateStop(e){this.active&&this.aggregateStepStartTime[e]&&(this.aggregateStepTotalTime||(this.aggregateStepTotalTime={}),this.aggregateStepTotalTime[e]||(this.aggregateStepTotalTime[e]=0),this.aggregateStepTotalTime[e]+=performance.now()-this.aggregateStepStartTime[e],this.aggregateStepStartTime[e]=void 0)}pause(e,t){if(!this.active||this.isPaused)return;this._currentStep!==A.ck.Unknown&&this.mark(this._currentStep);const{reason:n}=e,i=(0,l.__rest)(e,["reason"]);this.startStep(A.ck.Pause),this.pauseInfo=Object.assign(Object.assign({},this.pauseInfo),{reason:n,startTime:Date.now(),eventData:i,monitoringData:t})}resume(e,t){if(!this.active||!this.isPaused)return;const n=this.pauseInfo.startTime?Date.now()-this.pauseInfo.startTime:0;this.pauseInfo.totalTime=(this.pauseInfo.totalTime||0)+n,this.mark(A.ck.Pause,Object.assign(Object.assign({pauseReason:this.pauseInfo.reason},e),this.pauseInfo.eventData),void 0,t||this.pauseInfo.monitoringData),this._currentStep=A.ck.Unknown,this.pauseInfo.reason="",this.pauseInfo.startTime=0}stop(e,t="success",n){this._currentStep!==A.ck.Unknown&&this.mark(this._currentStep,void 0,t,n),this.aggregateStepTotalTime&&((0,j.each)(Object.keys(this.aggregateStepTotalTime),(e=>{const t=parseInt(this.aggregateStepTotalTime[e].toString(),10);this.mark(e,{stepDelta:t},void 0,n)})),this.aggregateStepTotalTime=null,this.aggregateStepStartTime=null),this.createMark(A.ck.Stop,t,!0,e,n).then((()=>{var e;if(this.active&&(this.active=!1),this.markSubscription&&!this.markSubscription.closed&&this.markSubscription.unsubscribe(),this.stopSubscription&&!this.stopSubscription.closed&&this.stopSubscription.unsubscribe(),this.callback&&this.callback(t),this.hostCommunicationService&&(null===(e=this.crossClientOptions)||void 0===e?void 0:e.enabled)){const e={scenarioName:this.name};this.hostCommunicationService.loadModule("scenario").then((t=>{t&&t.setScenarioCompletion&&t.setScenarioCompletion(e)}))}this.scenarioFactory.clearScenario(this)}))}fail(e,t){this.stop(e,"failure",t)}cancel(e,t){this.stop(e,"abandoned",t)}incomplete(e,t){this.stop(e,"incomplete",t)}mark(e,t,n="success",i){var a;this.isPaused&&e!==A.ck.Pause?this.logger.debug(`[Scenario]${this.name} - ignoring mark step [${e}] due to paused state`):(this.createMark(e,n,!1,t,i),this._currentStep=A.ck.Unknown,(null===(a=this.crossClientOptions)||void 0===a?void 0:a.enabled)&&this.crossClientOptions.previousStep&&e===A.ck.Start&&(this._previousStep=this.crossClientOptions.previousStep))}startStep(e){this.isPaused?this.logger.debug(`[Scenario]${this.name} - ignoring start step [${e}] due to paused state`):(this._currentStep!==A.ck.Unknown&&e!==this._currentStep&&this.mark(this._currentStep),this._currentStep=e)}setCrossClientMarkObservables(e){this.markSubscription=e.mark.subscribe((e=>this.mark(e.step,e.eventData,e.status))),this.stopSubscription=e.stop.subscribe((e=>{this.stop(e.eventData,e.status)}))}prepareAndSendTelemetry(e,t,n){this.eventData&&this.eventData!==e&&(e=Object.assign(Object.assign({},this.eventData),e)),e.InstanceId=this.id,this.computeScenarioData(e,t);const i=(0,j.isNumber)(e.elapsedSinceCoreInit)?e.elapsedSinceCoreInit:this.scenarioFactory.timestamp({isFromCoreInit:!0}),a=!!this.scenarioFactory.findScenario(A.RG.WindowLaunchTime);e=Object.assign(Object.assign({},e),{elapsedSinceCoreInit:i,isInEst:a}),this.enableDiagnostics&&this.diagnosticsService&&this.diagnosticsService.pushTelemetryEvent($.x[$.x.Scenario],e);const o=t[tk];if(o!==A.ck.Start){let i;this.scenarioMode!==A.t7.Expanded&&(this.prepareAndStorePackedSteps(t),o===A.ck.Stop&&(t["Scenario.Steps"]=JSON.stringify(this.steps),i={columnName:"Scenario.StepsEx",packedData:this.stepsEx})),this.sendScenario(o,e,t,i,n)}this.logScenarioPerf(t)}syncStateToCrossClientStart(e){if(e.existingEventData){const t=e.existingEventData.reduce(((e,t)=>Object.assign({[t.name]:t.value},e)),{});this.appendEventData(t)}e.previousStep&&(this._previousStep=e.previousStep),this.intervalTimestamp=this.relativeTimestamp+e.previousStepTimestamp-this._absoluteStartTime,this.active=!0}sendScenario(e,t,n,i,a){if(this.scenarioMode!==A.t7.Packed||e===A.ck.Stop){const o=()=>(0,V.Yx)(this.name,t,n,a,i);e!==A.ck.Stop?o():Promise.all([this.updateEventDataMemory(t)]).then((()=>{o()})).catch((()=>{o()}))}}prepareAndStorePackedSteps(e){const t={"Scenario.Status":e["Scenario.Status"],"Scenario.Step":e["Scenario.Step"],delta:e.delta,elapsed:e.elapsed,sequence:e.sequence,stepDelta:e.stepDelta,previousStep:e.previousStep};this.steps.push(t)}logScenarioPerf(e){if(this.showAllConsoleLogs){const t=e[tk],n=t===A.ck.Start?`[step](${this._sequence})${t}`:t===A.ck.Stop?`[step](${this._sequence})${t} (${e.stepDelta}ms/${e.delta}ms)`:`[step](${this._sequence})${t} (${e.stepDelta}ms)`;this.logger&&this.logger.log(`[Scenario]${this.name} ${n}`),this.__stepsPerfInfo__.push({name:t,stepDelta:e.stepDelta,delta:e.delta,status:e["Scenario.Status"]})}}updateEventDataMemory(e){return this.memoryAnalyzer?this.memoryAnalyzer.snapshotMemoryUsageAsync().then((t=>{var n,i,a;t&&(t.jsHeapStatistics&&(e.jsUsedHeapSize=t.jsHeapStatistics.used_heap_size,e.jsUsedHeapSizeDelta=(null===(n=this.memoryDataInitial)||void 0===n?void 0:n.jsHeapStatistics)?this.memoryDataInitial.jsHeapStatistics.used_heap_size-t.jsHeapStatistics.used_heap_size:void 0),t.processMemoryInfo&&(e.workingSet=t.processMemoryInfo.workingSetSize,e.workingSetDelta=(null===(i=this.memoryDataInitial)||void 0===i?void 0:i.processMemoryInfo)?t.processMemoryInfo.workingSetSize-this.memoryDataInitial.processMemoryInfo.workingSetSize:void 0,e.privateBytes=t.processMemoryInfo.privateBytes,e.privateBytesDelta=(null===(a=this.memoryDataInitial)||void 0===a?void 0:a.processMemoryInfo)?t.processMemoryInfo.privateBytes-this.memoryDataInitial.processMemoryInfo.privateBytes:void 0))})):Promise.resolve()}computeScenarioData(e,t){var n,i;const a=this.intervalTimestamp;let o;(0,j.isNumber)(e.overrideTimestamp)?(o=this.relativeTimestamp+e.overrideTimestamp-this._absoluteStartTime,e.overrideTimestamp=void 0):e.offsetCurrentTimeInMs?(o=this.scenarioFactory.timestamp({isCrossClient:null===(n=this.crossClientOptions)||void 0===n?void 0:n.enabled})-e.offsetCurrentTimeInMs,e.offsetCurrentTimeInMs=void 0):o=t[tk]===A.ck.Start?this.relativeTimestamp:this.scenarioFactory.timestamp({isCrossClient:null===(i=this.crossClientOptions)||void 0===i?void 0:i.enabled}),this._timestamps.push(o),this.intervalTimestamp=o;const r=(0,j.isNumber)(e.stepDelta)?e.stepDelta:o-a,s=(0,j.isNumber)(e.delta)?e.delta:o-this.relativeTimestamp-this.getTotalPauseDuration(),l=(0,j.isNumber)(e.elapsed)?e.elapsed:o,c=this._sequence;t.delta=s,t.elapsed=l,t.sequence=c,t.stepDelta=r}getMonitoringDataOverride(e){let t=e;return this.name!==A.RG.WindowLaunchTime&&this.name!==A.RG.ExperienceReady||(t=e?(0,j.cloneDeep)(e):{scenarioPriority:"P0",data:[]},t.data.push({key:"App",value:this.eventData.contentSlotApp})),t}createMark(e,t,n,i={},a){var o;return(0,l.__awaiter)(this,void 0,void 0,(function*(){if(!e||!this.active)return;e!==A.ck.Start&&this.scenarioMode!==A.t7.Expanded&&this.stepsEx.push((0,j.cloneDeep)(Object.assign(Object.assign({},this.eventData),i))||{});const r={"Scenario.Status":t,"Scenario.Mode":this.scenarioMode,[nk]:this.name,[tk]:e};e===A.ck.Stop&&(r.previousStep=this._previousStep);const s=this.getMonitoringDataOverride(a);this.markPerformanceApi(r),this.prepareAndSendTelemetry(null!==(o=i)&&void 0!==o?o:{},r,s),this.active=this.active&&!n,this.reportActivity&&this.reportActivity(r),this._previousStep=e,this._sequence+=1}))}markPerformanceApi(e){if(performance&&performance.mark&&performance.measure&&!ek.hasOwnProperty(this.name)){const t=`${e[tk]} ${e[nk]}-${this.id}`;if(performance.mark(t),e[tk]===A.ck.Stop){let n=`start ${e[nk]}-${this.id}`;0===(performance.getEntriesByName(n,"mark")||[]).length&&(n="navigationStart");const i=this.clientName?` (${this.clientName})`:"";performance.measure(`${e[nk]}${i}`,n,t)}this.markStepsInTrace&&(this.previousMark&&performance.measure(`${e[nk]} [${this.previousMark} <=> ${e[tk]}]`,`${this.previousMark} ${e[nk]}-${this.id}`,`${e[tk]} ${e[nk]}-${this.id}`),this.previousMark=e[tk])}}}class ak{constructor(e){this._name=e}get id(){return"noop"}get name(){return this._name}get delta(){return 0}get timeoutMs(){return 0}get eventData(){return{}}set eventData(e){}get timestamps(){return[]}get isPaused(){return!1}set isHoisted(e){}get isHoisted(){return!1}appendEventData(e){}pause(e){}resume(e){}cancel(e){}mark(e,t,n){}startStep(e){}stop(e,t){}fail(e){}incomplete(e){}markAggregateStart(e){}markAggregateStop(e){}getTotalPauseDuration(){return 0}}var ok=n(138826);class rk{constructor(e,t,n={}){this.name=e,this.id=t,this.excludedTimings=n,this.previousMark=""}markPerformanceApi(e,t=""){if(performance&&performance.mark&&performance.measure&&this.shouldMark(this.name)){const n=`${e} ${this.name}-${this.id}`;if(performance.mark(n),e===A.ck.Stop){let e=`start ${this.name}-${this.id}`;0===(performance.getEntriesByName(e,"mark")||[]).length&&(e="navigationStart");const i=[this.name,t&&`(${t})`].join(" ");performance.measure(i,e,n)}this.previousMark&&performance.measure(`${this.name} [${this.previousMark} <=> ${e}]`,`${this.previousMark} ${this.name}-${this.id}`,n),this.previousMark=e}}shouldMark(e){return!(e in this.excludedTimings)||this.excludedTimings[e]}}class sk{constructor(e,t,n,i,a,o,r=(0,Be.v4)()){this.name=e,this.clientId=t,this._eventData=n,this.originTime=i,this.startTime=a,this.timeoutMs=o,this.id=r,this._isPaused=!1,this.previousStep=A.ck.Unknown,this.sequence=1,this.mode=A.t7.Expanded,this.active=!0,this.onStopCallbacks=[],this.__stepsPerfInfo__=[],this._testingMode=!1,this.timestamps=[],this.intervalTimestamp=a,this.performanceMarker=new rk(this.name,this.id,ek)}addOnStopCallback(e){this.onStopCallbacks.push(e)}get testingMode(){return this._testingMode}set testingMode(e){this._testingMode=e}get isPaused(){return this._isPaused}get eventData(){return this._eventData}get elapsed(){return this.calculateElapsed(Date.now())}get stepDelta(){return this.calculateStepDelta(Date.now())}get delta(){return this.calculateDelta(Date.now())}get isHoisted(){return!1}syncToState(e){this.previousStep=e.previousStep,this.intervalTimestamp=e.lastTimestamp,this.sequence=e.lastSequence}setCrossClientMarkObservable(e){this.markSubscription=e.mark.subscribe((e=>{this.mark(e.step,e.eventData,e.status)})),this.stopSubscription=e.stop.subscribe((e=>{this.stop(e.eventData,e.status)}))}appendEventData(e){this._eventData=Object.assign(Object.assign({},this._eventData),e)}pause(e){this._isPaused=!0}resume(e={}){this._isPaused=!1}cancel(e={}){this.stop(e,"abandoned")}mark(e,t={},n="success"){if(!this.active)return;const{overrideTimestamp:i,offsetCurrentTimeInMs:a}=t,o=(0,l.__rest)(t,["overrideTimestamp","offsetCurrentTimeInMs"]),r=this.getBaseTimestamp(i,a),{delta:s,stepDelta:c,elapsed:d}=this.getScenarioTimingData(r,t),u=e,m={"Scenario.Mode":this.mode,"Scenario.Name":this.name,"Scenario.Status":n,"Scenario.Step":u,InstanceId:this.id,sequence:this.sequence,delta:s,elapsed:d,stepDelta:c};(0,V.Yx)(this.name,Object.assign(Object.assign({},this.eventData),o),m),this.performanceMarker.markPerformanceApi(u,this.clientName),this._testingMode&&this.__stepsPerfInfo__.push({name:m["Scenario.Step"],delta:m.delta,stepDelta:m.stepDelta,status:m["Scenario.Status"]}),this.updateScenarioStatePostMark(u,r)}stop(e={},t="success"){this.mark("stop",Object.assign({previousStep:this.previousStep},e),t),this.active=!1,this.markSubscription&&!this.markSubscription.closed&&this.markSubscription.unsubscribe(),this.stopSubscription&&!this.stopSubscription.closed&&this.stopSubscription.unsubscribe(),this.onStopCallbacks.forEach((e=>e()))}fail(e={}){this.stop(e,"failure")}incomplete(e={}){this.stop(e,"incomplete")}startStep(e){}markAggregateStart(e){}markAggregateStop(e){}getTotalPauseDuration(){return 0}getScenarioTimingData(e,t){return{delta:"number"==typeof t.delta?t.delta:this.calculateDelta(e),elapsed:"number"==typeof t.elapsed?t.elapsed:this.calculateElapsed(e),stepDelta:"number"==typeof t.stepDelta?t.stepDelta:this.calculateStepDelta(e)}}getBaseTimestamp(e,t){return(null!=e?e:Date.now())+(null!=t?t:0)}calculateDelta(e){return e-this.startTime}calculateElapsed(e){return e-this.originTime}calculateStepDelta(e){return e-this.intervalTimestamp}updateScenarioStatePostMark(e,t){this.intervalTimestamp=t,this.previousStep=e,this.sequence++}}const lk=e=>e.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.name]:t.value})),{});class ck{constructor(e,t,n,i){this.originTime=e,this.logger=t,this.factoryFunctions=n,this.finalizeLegacyCrossClient=i,this.scenarioCreated$=new it.xQ,this.scenarioStopped$=new at.y,this.scenarioMarked$=new at.y}loadCallbacks(e){this.scenarioMarked$=new at.y((t=>{e.mark(((e,n,i)=>{const a={step:n,status:i,scenarioName:e.scenarioName,eventData:lk(e.eventData),clientId:e.clientId};t.next(a)}))})),this.scenarioStopped$=new at.y((t=>{e.stop(((e,n)=>{const i={step:"stop",status:n,scenarioName:e.scenarioName,eventData:lk(e.eventData),clientId:e.clientId};t.next(i)}))})),e.start(((e,t)=>{var n,i;const a=this.factoryFunctions.findScenarioByNameAndId(e.scenarioName,e.clientId);if(a)this.logger.debug(`Creating mark observable for existing scenario: name=${e.scenarioName}, clientid=${e.clientId}`),a.appendEventData({"Scenario.CrossClientMode":"existing"}),null===(n=a.setCrossClientMarkObservables)||void 0===n||n.call(a,this.createObservablesForScenario(e.scenarioName,e.clientId));else{const n=this.factoryFunctions.findScenario(e.scenarioName);n?(this.logger.debug(`Creating mark observable for existing scenario (by name): name=${e.scenarioName}, clientid=${e.clientId}`),n.appendEventData({"Scenario.CrossClientMode":"existing"}),null===(i=n.setCrossClientMarkObservables)||void 0===i||i.call(n,this.createObservablesForScenario(e.scenarioName,e.clientId))):this.onStartScenario(e,t)}}))}loadExistingScenarios(e){e.forEach((e=>this.OnExistingScenario(e)))}onStartScenario(e,t){var n;const i=e.scenarioName,a=t.time.getTime(),o=lk(e.eventData),r=this.createNewCrossClient(i,e.clientId,o,a,e.timeout,(0,Be.v4)());r.appendEventData({"Scenario.CrossClientMode":"pure"}),r.addOnStopCallback((()=>{this.factoryFunctions.clearScenario(r)})),null===(n=r.setCrossClientMarkObservable)||void 0===n||n.call(r,this.createObservablesForScenario(r.name,r.clientId)),this.scenarioCreated$.next(r)}OnExistingScenario(e){var t,n,i;const a=null!==(t=e.clientId)&&void 0!==t?t:"",o=lk(null!==(n=e.eventData)&&void 0!==n?n:[]),r=this.createNewCrossClient(e.name,a,o,e.creationTime.time.getTime(),ZS,e.id);r.appendEventData({"Scenario.CrossClientMode":"transferred"}),r.addOnStopCallback((()=>{this.factoryFunctions.clearScenario(r)}));const s=this.finalizeLegacyCrossClient;if(s&&r.addOnStopCallback((()=>{s({scenarioName:r.name})})),null===(i=r.setCrossClientMarkObservable)||void 0===i||i.call(r,this.createObservablesForScenario(r.name,r.clientId)),e.lastMarkStep){const t={previousStep:e.lastMarkStep,lastTimestamp:e.lastMarkTime.time.getTime(),lastSequence:e.sequence};r.syncToState(t)}this.scenarioCreated$.next(r),this.logger.debug(`Created scenario from previous client: name=${e.name}, clientid=${a}`)}createObservablesForScenario(e,t){const n=this.scenarioStopped$.pipe((0,g.h)((n=>n.scenarioName===e&&n.clientId===t)),(0,ok.q)(1));return{mark:this.scenarioMarked$.pipe((0,g.h)((n=>n.scenarioName===e&&n.clientId===t)),(0,g.h)((e=>-1===["stop","start"].indexOf(e.step))),(0,pe.R)(n)),stop:n}}createNewCrossClient(e,t,n,i,a,o){return new sk(e,t,n,this.originTime,i,a,o)}}const dk="scenarioBuffer";class uk{constructor(e,t,n,i,a,o,r,s=e,l=!1,c,d,u,m={}){var p,g,h,v,f;this.startTimestamp=e,this.enableDiagnostics=t,this.context=n,this.memoryAnalyzer=i,this.correlation=a,this.windowId=o,this.clientId=r,this.coreInitTimestamp=s,this.payload=c,this.finalizeLegacyCrossClient=u,this.eventContextData=m,this.crossClientScenarioList=new Set,this.allowedScenarios=new Set,this.scenarioTimeoutMs=ZS,this.telemetryModeLookUp={},this.__isTestingMode__=!1,this.__testingBuffer__=[],this.newScenario=(e,t)=>{if(this.isCrossClientScenarioEnabled(e)){let n;if((null==t?void 0:t.clientId)&&(n=this.findScenarioByNameAndId(e,t.clientId)),n||(n=this.findScenario(e)),n)return n.appendEventData({"Scenario.CrossClientMode":"transferred"}),n;this.telemetryModeLookUp[e]=A.t7.Expanded}const n=this.createScenarioWithoutStarting(e,t);return n.mark(A.ck.Start,t&&{overrideTimestamp:t.overrideTimestamp},void 0,t&&t.monitoringData),n},this.createScenarioWithoutStarting=(e,t={})=>{var n;if(0===this.startTimestamp||!this.isAllowedScenario(e))return new ak(e);const i=void 0===t.captureMemoryUsage||t.captureMemoryUsage,{userObjectId:a,correlationId:o,commandSource:r,tenantId:s}=this.getContextData(),l=(0,j.cloneDeep)(this.eventContextData);l["Panel.WindowID"]=this.windowId,l["UserInfo.Id"]=a,l["UserInfo.TenantId"]=s,l["EventInfo.CorrelationId"]=o,l.commandSource=r,isNaN(t.startTime)||null===t.startTime||(l.overrideTimestamp=t.startTime);const c=t.scenarioId||(0,Be.v4)(),{showAllConsoleLogs:d}=this.context.coreSettings.get(b.J.Telemetry),{showScenarioStepsInPerfTrace:u}=this.context.coreSettings.get(b.J.Host),m=this.telemetryModeLookUp?this.telemetryModeLookUp[e]||(this.telemetryModeLookUp["*"]?this.telemetryModeLookUp["*"]:A.t7.Expanded):A.t7.Expanded,p=new ik(c,e,l,this,this.logger,t.timeoutMs||this.scenarioTimeoutMs,this.context.diagnosticsService,t.callback,i?this.memoryAnalyzer:void 0,this.enableDiagnostics,!!u,!!d,m,t.sequence||0,this.reportActivity,this.context.hostCommunicationService,t.crossClientOptions);e===A.RG.NavigationCommand?p.clientId=null!==(n=t.clientId)&&void 0!==n?n:this.clientId:p.clientId=t.clientId;const g=this.setupScenarioTimeout(p);return this.getActiveScenarios(p.name).push({scenario:p,timeoutId:g}),p},this.cancelExistingAndCreateScenario=(e,t,n,i,a)=>{let o=this.findScenario(e);if(o){const e=[{reason:t}];o.cancel({errors:JSON.stringify(e)})}return o=this.newScenario(e,{timeoutMs:n,callback:i,monitoringData:a}),o},this.stopScenarioIfActive=(e,t,n,i)=>{const a=this.findScenario(e);a&&a.stop(t,n,i)},this.markStep=(e,t,n)=>{const i=this.findScenario(e);i&&i.mark(t,n&&n.eventData,n&&n.status,n&&n.monitoringData)},this.startStep=(e,t)=>{const n=this.findScenario(e);n&&n.startStep(t)},this.findScenario=e=>{if(!e)return null;const t=this.activeScenariosMap.get(e);let n=null,i=null;if(t&&(n=(0,j.find)(t,(t=>t&&t.scenario.name===e||t.scenario.clientId===e))||null),null==n){const t=this.context.scenarioFactory;t&&t!==this&&(i=t.findScenario(e))}return n&&n.scenario||i},this.findScenarioByNameAndId=(e,t)=>{const n=this.activeScenariosMap.get(e);let i=null,a=null;if(n&&(i=(0,j.find)(n,(n=>n.scenario.name===e&&n.scenario.clientId===t))||null),null==i){const n=this.context.scenarioFactory;n&&n!==this&&(a=n.findScenarioByNameAndId(e,t))}return i&&i.scenario||a},this.clearScenario=e=>{const t=this.activeScenariosMap.get(e.name);if(t){const n=(0,j.findIndex)(t,(t=>t.scenario===e));if(n>-1){this.__saveForTestingMode__(e,this.context.coreSettings.get(b.J.Test));const i=t.splice(n,1)[0];0===t.length&&this.activeScenariosMap.delete(i.scenario.name),this.context.windowProvider.clearTimeout(i.timeoutId)}}e.isHoisted&&this.context.scenarioFactory&&this!==this.context.scenarioFactory&&(this.context.scenarioFactory.clearScenario(e),e.isHoisted=!1)},this.setContext=e=>{this.eventContextData=Object.assign(Object.assign({},this.eventContextData),e),this.activeScenariosMap.forEach((t=>{t.map((t=>t.scenario.appendEventData(e)))}))},this.hoistScenarioToCore=e=>{const t=this.context.scenarioFactory;if(t&&t!==this)t.hoistScenarioToCore&&t.hoistScenarioToCore(e);else if(!e.isHoisted){this.getActiveScenarios(e.name).push({scenario:e,timeoutId:0}),e.isHoisted=!0,console.log(`${e.name} hoisted to core factory`)}},this.findAllScenariosByName=e=>this.getActiveScenarios(e).map((e=>e.scenario)),this.changeTimeout=(e,t)=>{var n;const i=null===(n=this.activeScenariosMap.get(e.name))||void 0===n?void 0:n.find((t=>t.scenario.name===e.name&&t.scenario.id===e.id));i&&(i.scenario.timeoutMs=t,this.context.windowProvider.clearTimeout(i.timeoutId),i.timeoutId=this.setupScenarioTimeout(i.scenario))},this.setupScenarioTimeout=(e,t)=>{const n=e.timeoutMs;return this.context.windowProvider.setTimeout((()=>{const n=this.context.coreSettings.get(b.J.Telemetry)||{},{scenariosNotToTimeoutIfPaused:i}=n;e.isPaused&&(null==i?void 0:i.includes(e.name))||e.stop(void 0,"timeout",t)}),n)},this.getContextData=()=>{var e,t,n,i;return{userObjectId:this.environment===he.s.life?null===(e=this.context.authenticationUser)||void 0===e?void 0:e.profile.paddedMsaId:null===(t=this.context.authenticationUser)||void 0===t?void 0:t.profile.objectId,tenantId:null===(i=null===(n=this.context.authenticationUser)||void 0===n?void 0:n.profile)||void 0===i?void 0:i.tenantId,correlationId:this.correlation.id,commandSource:this.correlation.source}},this.getActiveScenarios=e=>{let t=this.activeScenariosMap.get(e);return t||(t=[],this.activeScenariosMap.set(e,t)),t},this.reportActivity=e=>{const t=e["Scenario.Name"];t&&this.isWhitelistedActivity(t)&&this.context.windowProvider.opener.postMessage(R.rY.ActivityEvent,{action:"er:rendererActivityEvents",data:{activityEvents:[{sourceId:this.windowId,events:[`${t}:${e["Scenario.Step"]}`]}]}})},this.isWhitelistedActivity=e=>{switch(e){case A.RG.WindowLaunchTime:case A.RG.ChatSendMessage:case A.RG.CentralDataLayeRequest:case A.RG.UnhandledRejection:case A.RG.FatalError:case A.RG.GlobalWindowError:return!0;default:return!1}},this.isAllowedScenario=e=>!this.coreAllowListEnabled||this.allowedScenarios.has(e),this.isCrossClientScenarioEnabled=e=>this.clientType===si.Bh.Maglev&&this.crossClientScenarioList.has(e)&&void 0!==this.context.hostCommunicationService,this.initializeCrossClientScenarios=(e,t)=>{var n;const i=null!==(n=e.scenarios)&&void 0!==n?n:[],a=e.scenarioFactoryStartTime.time.getTime(),o=this.context.loggerFactory.newLogger("CrossClientCoordinator");i.forEach((e=>{this.crossClientScenarioList.add(e.name),this.telemetryModeLookUp[e.name]=A.t7.Expanded})),this.crossClientCoordinator=new ck(a,o,this,this.finalizeLegacyCrossClient),this.crossClientCoordinator.scenarioCreated$.subscribe((e=>{this.onScenarioFromCoordinator(e)})),t&&(this.crossClientCoordinator.loadCallbacks(t),this.logger.debug("Cross client initializing with callbacks")),this.crossClientCoordinator.loadExistingScenarios(i),this.logger.debug("Cross client coordinator initialized")},this.getTimestamp=e=>{const t=Date.now();return(null==e?void 0:e.isCrossClient)&&this.desktopFactoryTimestamp?t-this.desktopFactoryTimestamp:(null==e?void 0:e.isFromCoreInit)?t-this.coreInitTimestamp:t-this.startTimestamp},this.activeScenariosMap=new Map,this.environment=this.context.coreSettings.get(b.J.Metadata).environment,this.coreAllowListEnabled=null!==(p=this.context.coreSettings.get(b.J.Telemetry).coreAllowListEnabled)&&void 0!==p&&p,this.allowedScenarios=new Set(null!==(g=this.context.coreSettings.get(b.J.Telemetry).coreAllowList)&&void 0!==g?g:[]),this.clientType=null===(v=null===(h=this.context.platformService)||void 0===h?void 0:h.config)||void 0===v?void 0:v.clientType,this.telemetryModeSubscription=this.context.coreSettings.getObservable(b.J.Telemetry).subscribe((e=>this.onReceiveTelemetrySettings(e))),this.__initTestingMode__(this.context.coreSettings.get(b.J.Host)),this.desktopFactoryTimestamp=null===(f=this.payload)||void 0===f?void 0:f.scenarioFactoryStartTime.time.getTime(),this.timestamp=this.getTimestamp;const y=o?`ScenarioFactory-${o}`:"ScenarioFactory";this.logger=this.context.loggerFactory.newLogger(y),this.payload&&this.initializeCrossClientScenarios(this.payload,d),this.startWindowLaunchTimeScenario(l,e),this.logger.debug("Initialized ScenarioFactory")}destroy(){this.telemetryModeSubscription.unsubscribe()}startWindowLaunchTimeScenario(e,t){var n;if(e){const e=this.newScenario(A.RG.WindowLaunchTime,{startTime:t,timeoutMs:6e4});e.appendEventData({workerEnabled:Na(this.context.coreSettings)}),null===(n=this.hoistScenarioToCore)||void 0===n||n.call(this,e)}}__initTestingMode__(e){if(e){const t=e.userType;t&&t.indexOf("test")>-1&&(this.__isTestingMode__=!0,dk in window?this.__testingBuffer__=window.scenarioBuffer:this.__testingBuffer__=window.scenarioBuffer=[])}}__saveForTestingMode__(e,t){this.__isTestingMode__&&this.__testingBuffer__&&(t&&t.scenarioBufferList&&t.scenarioBufferList.length>0?t.scenarioBufferList.indexOf(e.name)>-1&&this.__pushScenarioBuffer__(e):this.__pushScenarioBuffer__(e))}__pushScenarioBuffer__(e){e.isHoisted&&this.__testingBuffer__.length>0&&this.__testingBuffer__[this.__testingBuffer__.length-1].id===e.id||(this.__testingBuffer__.push(e),this.__testingBuffer__.length>100&&this.__testingBuffer__.shift())}onReceiveTelemetrySettings(e){var t;this.telemetryModeLookUp=e.scenarioModes,this.coreAllowListEnabled=Boolean(e.coreAllowListEnabled),this.allowedScenarios=new Set(null!==(t=e.coreAllowList)&&void 0!==t?t:[])}onScenarioFromCoordinator(e){this.telemetryModeLookUp[e.name]=A.t7.Expanded,this.crossClientScenarioList.add(e.name);const{showAllConsoleLogs:t}=this.context.coreSettings.get(b.J.Telemetry);e.testingMode=Boolean(t);const{userObjectId:n,correlationId:i,commandSource:a,tenantId:o}=this.getContextData(),r=(0,j.cloneDeep)(this.eventContextData);r["Panel.WindowID"]=this.windowId,r["UserInfo.Id"]=n,r["UserInfo.TenantId"]=o,r["EventInfo.CorrelationId"]=i,r.commandSource=a,e.appendEventData(r);const s=this.setupScenarioTimeout(e);this.getActiveScenarios(e.name).push({scenario:e,timeoutId:s})}}const mk=["gpu-process","nativeShell","crashpad-handler","renderer","utility","browser"];function pk(e){let t={};const n=hk(e,"gpu-process");n&&(t.Perf_GPU_WorkingSet=n.workingSetSizeKB,t.Perf_GPU_CommitSize=n.commitSizeKB);const i=hk(e,"nativeShell");i&&(t.Perf_NativeShell_WorkingSet=i.workingSetSizeKB,t.Perf_NativeShell_CommitSize=i.commitSizeKB);const a=hk(e,"crashpad-handler");a&&(t.Perf_CrashpadHandler_WorkingSet=a.workingSetSizeKB,t.Perf_CrashpadHandler_CommitSize=a.commitSizeKB);const o=hk(e,"browser");o&&(t.Perf_Browser_WorkingSet=o.workingSetSizeKB,t.Perf_Browser_CommitSize=o.commitSizeKB),t=Object.assign(Object.assign(Object.assign({},t),function(e){const t={},n=function(e){return e.filter((e=>"renderer"===e.type))}(e);(null==n?void 0:n.length)>0&&(t.Perf_Renderer_WorkingSet=(0,j.sumBy)(n,(e=>e.workingSetSizeKB)),t.Perf_Renderer_CommitSize=(0,j.sumBy)(n,(e=>e.commitSizeKB)),t.Perf_Renderer_Count_Processes=n.length);return t}(e)),function(e){const t={},n=vk(e,"NetworkService");n&&(t.Perf_NetworkService_WorkingSet=n.workingSetSizeKB,t.Perf_NetworkService_CommitSize=n.commitSizeKB);const i=vk(e,"StorageService");i&&(t.Perf_StorageService_WorkingSet=i.workingSetSizeKB,t.Perf_StorageService_CommitSize=i.commitSizeKB);const a=vk(e,"AudioService");a&&(t.Perf_AudioService_WorkingSet=a.workingSetSizeKB,t.Perf_AudioService_CommitSize=a.commitSizeKB);return t}(e)),t.Perf_Total_WorkingSet=function(e){return(0,j.sumBy)(e,(e=>e.workingSetSizeKB))}(e),t.Perf_Total_CommitSize=function(e){return(0,j.sumBy)(e,(e=>e.commitSizeKB))}(e);const r=e.filter((e=>!mk.includes(e.type)));return t.Perf_Unknown_Process=r,t.Perf_Unknown_NumberOfProcesses=r.length,t}function gk(e=0){return Math.round(e/1024)}function hk(e,t){return e.find((e=>e.type===t))}function vk(e,t){return e.find((e=>e.utilitySubType.includes(t)))}class fk{constructor(e){this.context=e,this.enableHeartbeatMonitor=!1,this.granularMemoryData=new Map,this.actions=[],this.logger=e.loggerFactory.newLogger("Heartbeat"),this.enableHeartbeatMonitor=this.isHeartbeatMonitorEnabled(),this.enableHeartbeatMonitor?(this.logger.debug("'enableHeartbeatMonitor' flag is enabled"),this.configuration=this.loadConfiguration(),this.logger.debug("Configuration loaded...",this.configuration),this.setActions()):this.logger.warn("'enableHeartbeatMonitor' flag is NOT enabled")}static getInstance(){return fk.instance}isHeartbeatMonitorEnabled(){var e;return!!(null===(e=this.context.coreSettings)||void 0===e?void 0:e.get(b.J.Telemetry).enableHeartbeatMonitor)}loadConfiguration(){var e;this.logger.debug("Trying to load the configuration...");const t=null===(e=this.context.coreSettings)||void 0===e?void 0:e.get(b.J.Telemetry).heartbeatConfiguration;if(t)return t;this.logger.error("Configuration not found.")}start(){var e,t,n;return(0,l.__awaiter)(this,void 0,void 0,(function*(){if(this.logger.debug("Starting the monitor..."),this.configuration){const i=this.configuration.intervalInSeconds*S.B.second;if(this.isHeartbeatMonitorRunning()||(this.heartbeatIntervalId=null===(e=this.context.windowProvider)||void 0===e?void 0:e.setInterval((()=>this.beat()),i)),(null===(t=this.configuration.memoryMetricsCollection)||void 0===t?void 0:t.enabled)&&(null===(n=this.configuration.memoryMetricsCollection)||void 0===n?void 0:n.collectionIntervalInSeconds)){const e=this.configuration.memoryMetricsCollection.collectionIntervalInSeconds*S.B.second;e!==i&&this.startExtraInterval(e,this.collectGranularMemoryData.bind(this))}}yield this.registerScenarios(),fk.instance=this}))}stop(){var e;this.logger.debug("Stopping the monitor..."),this.isHeartbeatMonitorRunning()&&(null===(e=this.context.windowProvider)||void 0===e||e.clearInterval(this.heartbeatIntervalId),this.heartbeatIntervalId=void 0,fk.instance=void 0,this.stopExtraIntervals())}beat(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.collectData();this.setHeartbeatData(e),this.sendHeartbeatData()}))}sendHeartbeatData(){const e=this.getHeartbeatData();e&&(0,V.aA)(e)}setHeartbeatData(e){this.heartbeatData=e}getHeartbeatData(){return this.heartbeatData}isHeartbeatMonitorRunning(){return void 0!==this.heartbeatIntervalId}setActions(){var e,t,n,i,a,o,r,s,l,c;(null===(t=null===(e=this.configuration)||void 0===e?void 0:e.memoryMetricsCollection)||void 0===t?void 0:t.enabled)&&this.actions.push(this.getAverageMemoryMetrics.bind(this)),(null===(i=null===(n=this.configuration)||void 0===n?void 0:n.ariMetricsCollection)||void 0===i?void 0:i.enabled)&&this.actions.push(this.getAriMetrics.bind(this)),(null===(o=null===(a=this.configuration)||void 0===a?void 0:a.dataClientMetricsCollection)||void 0===o?void 0:o.enabled)&&this.actions.push(this.getDataClientMetrics.bind(this)),(null===(s=null===(r=this.configuration)||void 0===r?void 0:r.windowMetricsCollection)||void 0===s?void 0:s.enabled)&&this.actions.push(this.getWindowMetrics.bind(this)),(null===(c=null===(l=this.configuration)||void 0===l?void 0:l.clientStateMetricsCollection)||void 0===c?void 0:c.enabled)&&this.actions.push(this.getClientStateMetrics.bind(this))}getActions(){return this.actions}collectData(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){let e={};for(const t of this.actions){const n=yield t();e=Object.assign(Object.assign({},e),n)}return e}))}startExtraInterval(e,t){var n,i;const a=null===(n=this.context.windowProvider)||void 0===n?void 0:n.setInterval((()=>t()),e);a&&(null===(i=this.extraCollectionIntervalIds)||void 0===i||i.push(a))}stopExtraIntervals(){var e;if(this.extraCollectionIntervalIds&&this.extraCollectionIntervalIds.length>0){for(const t of this.extraCollectionIntervalIds)null===(e=this.context.windowProvider)||void 0===e||e.clearInterval(t);this.extraCollectionIntervalIds=[]}}getAverageMemoryMetrics(){var e,t;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const n=[];null===(e=this.granularMemoryData)||void 0===e||e.forEach(((e,t)=>{const i=(0,j.meanBy)(e,(e=>e.workingSetSizeKB)),a=(0,j.meanBy)(e,(e=>e.commitSizeKB)),o={processId:t,name:e[0].name,type:e[0].type,utilitySubType:e[0].utilitySubType,embeddedBrowserWebView:e[0].embeddedBrowserWebView,cpuCycleTime:e[0].cpuCycleTime,workingSetSizeKB:Math.round(i),commitSizeKB:Math.round(a)};n.push(o)}));const i=pk(n);let a={};if(this.context.windowProvider){a=function(e){return{Perf_JSHeap_TotalSize:e.totalJSHeapSize,Perf_JSHeap_LimitSize:e.jsHeapSizeLimit,Perf_JSHeap_UsedSize:e.usedJSHeapSize}}(function(e){const t=e.performance;let n=0,i=0,a=0;if(null==t?void 0:t.memory){const e=t.memory;n=gk(null==e?void 0:e.jsHeapSizeLimit),i=gk(null==e?void 0:e.totalJSHeapSize),a=gk(null==e?void 0:e.usedJSHeapSize)}return{jsHeapSizeLimit:n,totalJSHeapSize:i,usedJSHeapSize:a}}(this.context.windowProvider))}const o=Object.assign(Object.assign({},i),a);return null===(t=this.granularMemoryData)||void 0===t||t.clear(),o}))}getAriMetrics(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const e={Perf_Ari:""};if(this.context.appResponsivenessService){const t=this.context.appResponsivenessService.getTelemetry();e.Perf_Ari=t,this.context.appResponsivenessService.clearTelemetry()}return Promise.resolve(e)}))}getDataClientMetrics(){const e={Perf_ApolloCacheStats:void 0};if(this.context.dataClientTrackingService){const t=this.context.dataClientTrackingService.getTelemetry();e.Perf_ApolloCacheStats=t}return e}getWindowMetrics(){const e={Perf_WindowStats:void 0};if(this.context.windowTrackerService){const t=this.context.windowTrackerService.getTelemetry();e.Perf_WindowStats=t}return e}getClientStateMetrics(){const e={Perf_IsUserInCall:void 0};if(this.context.clientState){const t=this.context.clientState.getState()===Dn.pk.VeryActive;e.Perf_IsUserInCall=t}return e}collectGranularMemoryData(){var e,t,n,i;return(0,l.__awaiter)(this,void 0,void 0,(function*(){if(this.context.hostCommunicationService){const a=yield function(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const t=[],n=yield null==e?void 0:e.loadModule("heartbeat");if(!(null==n?void 0:n.getPerfMetrics))return t;try{const e=yield n.getPerfMetrics();for(const n of e){const e={processId:n.processId,name:n.name,type:n.type,utilitySubType:n.utilitySubType,embeddedBrowserWebView:n.embeddedBrowserWebView,cpuCycleTime:n.cpuCycleTime,workingSetSizeKB:gk(n.workingSetSizeBytes),commitSizeKB:gk(n.pageFileUsageBytes)};t.push(e)}return t}catch(e){console.error("get-webview-2-metrics, getMetrics: Failed to get metrics.")}return t}))}(this.context.hostCommunicationService);for(const o of a)if(null===(e=this.granularMemoryData)||void 0===e?void 0:e.has(o.processId)){const e=null===(n=this.granularMemoryData)||void 0===n?void 0:n.get(o.processId);e&&(null===(i=this.granularMemoryData)||void 0===i||i.set(o.processId,e.concat(o)))}else null===(t=this.granularMemoryData)||void 0===t||t.set(o.processId,[o])}else this.logger.error("Invalid hostCommunicationService, cannot get metrics from Desktop")}))}registerScenarios(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){if(this.context.hostCommunicationService){const e=yield this.context.hostCommunicationService.loadModule("heartbeat");if(null==e?void 0:e.registerForScenarioStart)try{e.registerForScenarioStart((e=>{this.isHeartbeatMonitorEnabled()}))}catch(e){this.logger.error("Failed to register for listening to host scenarios starting")}if(null==e?void 0:e.registerForScenarioStop)try{e.registerForScenarioStop((e=>{this.isHeartbeatMonitorEnabled()}))}catch(e){this.logger.error("Failed to register for listening to host scenarios stopping")}}}))}}fk.instance=void 0;class yk{constructor(e){var t,n;if(this.context=e,null===(t=this.context.host)||void 0===t?void 0:t.performance){this.deprecatedNavigationTiming=this.context.host.performance.timing,this.navigationStart=null===(n=this.deprecatedNavigationTiming)||void 0===n?void 0:n.navigationStart;const e=this.context.host.performance.getEntriesByType("navigation");e&&e[0]&&(this.navigationTiming=e[0]),this.init()}}get altScenario(){return this._altScenario}markCoreInitSteps(){const e=this.context.host.performance.getEntriesByType("mark");e&&this.processCoreInitPerfMarks(e)}processCoreInitPerfMarks(e){if(this.navigationStart&&this._altScenario){const t=e;for(const e of t)switch(e.name){case`${C}${S.sM.Initialization}`:this._altScenario.mark(A.ck.PreCoreInitializationTasks,{overrideTimestamp:Math.round(e.startTime)+this.navigationStart});continue;default:e.name.startsWith(w)&&this._altScenario.mark(e.name.replace("_end_","_"),{overrideTimestamp:Math.round(e.startTime)+this.navigationStart})}}}init(){var e,t,n,i,a;if(this.navigationStart){if(this._altScenario=null===(e=this.context.scenarioFactory)||void 0===e?void 0:e.newScenario(A.RG.ApplicationLaunchTime,{startTime:this.navigationStart}),this._altScenario){(null===(t=this.navigationTiming)||void 0===t?void 0:t.workerStart)&&this._altScenario.mark(A.ck.IndexServiceWorkerStartup,{overrideTimestamp:this.navigationStart+Math.round(this.navigationTiming.workerStart)}),(null===(n=this.deprecatedNavigationTiming)||void 0===n?void 0:n.fetchStart)&&this._altScenario.mark(A.ck.IndexFetchIPC,{overrideTimestamp:this.deprecatedNavigationTiming.fetchStart}),(null===(i=this.deprecatedNavigationTiming)||void 0===i?void 0:i.requestStart)&&this._altScenario.mark(A.ck.IndexFetchIPCWait,{overrideTimestamp:this.deprecatedNavigationTiming.requestStart}),(null===(a=this.deprecatedNavigationTiming)||void 0===a?void 0:a.responseStart)&&this._altScenario.mark(A.ck.IndexFetchProcessing,{overrideTimestamp:this.deprecatedNavigationTiming.responseStart});const e=this.context.host.performance.getEntriesByName("start-execute-main-bundle","mark");e&&e[0]&&this._altScenario.mark(A.ck.MainBundleDownloadParse,{overrideTimestamp:Math.round(e[0].startTime)+this.navigationStart})}this.markCoreInitSteps()}}}var Sk;!function(e){e[e.ComposeMessageTyping=0]="ComposeMessageTyping",e[e.MessageListScroll=1]="MessageListScroll",e[e.PowerbarTyping=2]="PowerbarTyping",e[e.VirtualTreeListScroll=3]="VirtualTreeListScroll",e[e.FeedsFilterTyping=4]="FeedsFilterTyping",e[e.PeoplePickerTyping=5]="PeoplePickerTyping",e[e.SearchBoxTyping=6]="SearchBoxTyping",e[e.FloodgatePopup=7]="FloodgatePopup",e[e.ChatListSearchFilterTyping=8]="ChatListSearchFilterTyping"}(Sk||(Sk={}));var kk=n(883523);const bk="getAndClearAriTelemetry";class _k{constructor(e,t){this.host=e,this.context=t,this.startSlot=0,this.blinkInterval=100,this.trailingTimespan=S.B.second,this.rafRecords=new Map,this.activeUserActionType=void 0,this.userActions=new Map,this.validActions=new Map,this.lastEventTimeSlot=this.startSlot,this.isDebugging=!1,this.strategies=[{name:"TwoRafAndLimitedStopTimeStrategy",lowestAllowedRafs:2,allowStopTimeOverwrite:!0}],this.logger=t.loggerFactory.newLogger("ARI"),this.initializeOnAppLaunchAndReinit(),this.__initTestingMode__(this.context.coreSettings.get(b.J.Host)),this.defaultHost=e}clearTelemetry(){this.userActions.clear(),this.clearTelemetryTimeoutId&&this.context.windowProvider.clearTimeout(this.clearTelemetryTimeoutId),this.clearTelemetryTimeoutId=this.context.windowProvider.setTimeout((()=>{this.clearTelemetry()}),S.B.tenMinutes,!1)}trackEvent(e,t,n,i,a){const o=this.getUserActionType(e,t),{isDebugging:r,logger:s}=this;if(void 0===o||!(o in Sk))return void(r&&s.debug(`[${this.formatActionKey(e,t)}] TrackEvent | No action found`));const l=this.getMeasurementName(o),c=i.performance.now();r&&s.debug(`[${l} TrackEvent | [${Math.round(n)}...${Math.round(c)}] ${Math.round(c-n)}ms`),void 0===this.activeUserActionType?(r&&s.debug(`[${l}] track-start`),this.startMeasurement(o,n,i,a)):this.activeUserActionType!==o||this.host!==i||this.actionLocation!==a?(r&&s.debug(`[${l}] track-stop`),this.stopMeasurement(i),r&&s.debug(`[${l}] track-start`),this.startMeasurement(o,n,i,a)):(r&&s.debug(`[${l}] track-continue`),this.continueMeasurement(n))}handleUnmount(e){this.stopMeasurement(e)}getTelemetry(){const e={},t={totalIntervalCount:0,passIntervalCount:0};this.userActions.forEach(((n,i)=>{if(void 0!==Sk[n.type]){const a={};n.scores.forEach(((e,n)=>{(e=>{e&&(t.passIntervalCount+=e.passIntervalCount,t.totalIntervalCount+=e.totalIntervalCount)})(e),a[n]=this.getAri(e)})),e[i]=a}})),e.Total=this.getAri(t);let n="";if(this.userActions.size>0)try{n=JSON.stringify(e)}catch(e){this.logger.error("[AppResponsivenessService]: unexpected error parsing log object. Likely because of circular reference.")}return n}initializeOnAppLaunchAndReinit(){this.initSettings(),this.registerValidActions(),this.clearTelemetry()}__initTestingMode__(e){if(e){const t=e.userType;t&&t.indexOf("test")>-1&&(bk in window||(window.getAndClearAriTelemetry=()=>{const e=this.getTelemetry();return this.clearTelemetry(),e}))}}registerValidActions(){this.validActions.set(this.formatActionKey(kk.P.Floodgate,S.f_.System),Sk.FloodgatePopup),this.validActions.set(this.formatActionKey(kk.P.ComposeMessage,S.f_.Keyup),Sk.ComposeMessageTyping),this.validActions.set(this.formatActionKey(kk.P.MessageList,S.f_.Scroll),Sk.MessageListScroll),this.validActions.set(this.formatActionKey(kk.P.Powerbar,S.f_.Keyup),Sk.PowerbarTyping),this.validActions.set(this.formatActionKey(kk.P.VirtualTreeList,S.f_.Scroll),Sk.VirtualTreeListScroll),this.validActions.set(this.formatActionKey(kk.P.FeedsFilter,S.f_.Keyup),Sk.FeedsFilterTyping),this.validActions.set(this.formatActionKey(kk.P.PeoplePicker,S.f_.Keyup),Sk.PeoplePickerTyping),this.validActions.set(this.formatActionKey(kk.P.SearchBox,S.f_.Keyup),Sk.SearchBoxTyping),this.validActions.set(this.formatActionKey(kk.P.ChatListSearchFilter,S.f_.Keyup),Sk.ChatListSearchFilterTyping)}getUserActionType(e,t){const n=this.formatActionKey(t,e);return this.validActions.get(n)}formatActionKey(e,t){return`${e}_${t}`}registerRafCallback(){this.rafCallbackId||(this.rafCallbackId=this.host.requestAnimationFrame((()=>this.measureRaf())))}unregisterRafCallback(){this.rafCallbackId&&(this.host.cancelAnimationFrame(this.rafCallbackId),this.clearRaf())}clearRaf(){this.rafCallbackId=void 0,this.rafRecords.clear()}getAri(e){return e&&0!==e.totalIntervalCount?Math.round(e.passIntervalCount/e.totalIntervalCount*S.B.second)/S.B.second:0}initSettings(){const e=this.context.coreSettings.get(b.J.Telemetry).appResponsivenessConstants;this.isDebugging=this.context.coreSettings.get(b.J.Telemetry).enableAriDebugging||!1,this.blinkInterval=e&&e.blinkInterval||100,this.trailingTimespan=e&&e.trailingTimespan||S.B.second}startMeasurement(e,t,n,i){this.assignHost(n),this.actionLocation=i,this.activeUserActionType=e,this.eventStartTime=t||this.host.performance.now(),this.lastEventTimeSlot=this.getTimeSlot(this.eventStartTime);const a=this.getMeasurementName(e);this.isDebugging&&this.logger.debug(`[${a}] START | ${this.host.performance.now()} | Event: ${this.eventStartTime}`),this.registerRafCallback();let o=this.userActions.get(a);void 0===o&&(o={scores:new Map,startTime:this.startSlot,type:e},this.userActions.set(a,o)),o.startTime=this.eventStartTime}stopMeasurement(e=this.host){if(void 0===this.activeUserActionType)return;const t=this.getMeasurementName(this.activeUserActionType),n=this.userActions.get(t);void 0!==n&&(this.isDebugging&&this.logger.debug(`[${t}] END | ${this.host.performance.now()}`),this.finalizeMeasurement(n),this.unregisterRafCallback(),this.activeUserActionType=void 0,this.actionLocation=void 0,e===this.host&&this.assignHost(this.defaultHost))}continueMeasurement(e){this.lastEventTimeSlot=this.getTimeSlot(e)}finalizeMeasurement(e,t){this.strategies.forEach((n=>{const i=t&&n.allowStopTimeOverwrite?t:this.getCurrentTimeSlot(),a=this.getResponsivenessScore(this.startSlot,i,n),o=e.scores.get(n.name);o?(o.passIntervalCount+=a.passIntervalCount,o.totalIntervalCount+=a.totalIntervalCount):e.scores.set(n.name,{totalIntervalCount:a.totalIntervalCount,passIntervalCount:a.passIntervalCount});const r=(a.passIntervalCount/a.totalIntervalCount).toFixed(2);this.logger.log(`[${this.getMeasurementName(e.type)}] duration: ${Math.round(this.host.performance.now()-e.startTime)}ms measurement: ${a.passIntervalCount}/${a.totalIntervalCount} (${r})`)}))}measureRaf(){const e=this.getCurrentTimeSlot();let t=this.rafRecords.get(e);void 0===t?t=1:t++,e-this.lastEventTimeSlot>=this.trailingTimespan?this.stopMeasurement():(this.rafRecords.size>1e3&&(this.stopMeasurement(),this.rafRecords.clear()),this.rafRecords.set(e,t),this.rafCallbackId=this.host.requestAnimationFrame((()=>this.measureRaf())))}getCurrentTimeSlot(){const e=this.host.performance.now();return this.getTimeSlot(e)}getTimeSlot(e){const t=void 0!==this.eventStartTime?e-this.eventStartTime:-1;return t<0?-1:Math.floor(t/this.blinkInterval)*this.blinkInterval}getResponsivenessScore(e,t,n){let i=0,a=0;for(;e<t;){const t=this.rafRecords.get(e);this.isDebugging&&this.logger.debug(`${e}: ${void 0===t?0:t}`),a+=void 0!==t&&t>=n.lowestAllowedRafs?1:0,i++,e+=this.blinkInterval}return{passIntervalCount:a,totalIntervalCount:i}}assignHost(e){this.host=e}getMeasurementName(e){let t=Sk[e];return this.actionLocation&&(t+=`-${this.actionLocation}`),t}}var Ck=n(944046);const wk=e=>"object"==typeof e;class Tk{constructor(e,t,n){this.shouldCollectStats=e,this.flags=t,this.leakDetectorService=n,t.apolloCacheStatsThrottleTime?this.getTelemetry=(0,j.throttle)((()=>this.getTelemetryInternal()),t.apolloCacheStatsThrottleTime,{leading:!0,trailing:!1}):this.getTelemetry=this.getTelemetryInternal}getTelemetryInternal(){var e,t;const{enableApolloCacheStats:n}=this.flags;if(!n)return;const i=null!==(t=null===(e=this.leakDetectorService)||void 0===e?void 0:e.getReachableObjects("dataClient").size)&&void 0!==t?t:0,a=this.getCaches();if(this.shouldCollectStats()){const e=a.map(Ck.T);return Object.assign(Object.assign({},e.reduce(((e,t)=>({cacheSize:e.cacheSize+t.cacheSize,measuringTime:e.measuringTime+t.measuringTime})),{cacheSize:0,measuringTime:0})),{cacheCount:a.length,clientsCount:i,caches:e})}return{clientsCount:i,cacheCount:a.length}}unthrottle(){"function"==typeof this.getTelemetry.cancel&&this.getTelemetry.cancel()}getCaches(){var e,t;return Array.from(null!==(t=null===(e=this.leakDetectorService)||void 0===e?void 0:e.getReachableObjects("apolloCache"))&&void 0!==t?t:[]).filter(wk)}}const Ek={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"activeWindows"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindows"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isMainWindow"}},{kind:"Field",name:{kind:"Name",value:"activeEntities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mainEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"correlation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]}}]},Ik=new Set([ne.p.breakoutrooms,ne.p.calendar,ne.p.callablechannels,ne.p.callsmain,ne.p.chats,ne.p.schedulingform,ne.p.search,ne.p.store,ne.p.transcriptcontent]);var Nk;!function(e){e.mainActive="mainActive",e.mainContentRecord="mainContentRecord"}(Nk||(Nk={}));class Ak{constructor(){this.active={},this.record={},this.allEntityTypes=new Set,this.usedEntityTypes=new Set,this.monitoredEntityTypes=Ik}update(e,t){this.usedEntityTypes.forEach((e=>{this.active[e]=0})),e.forEach((e=>{const n=e.activeEntities.mainEntity.type;this.allEntityTypes.add(n),this.monitoredEntityTypes.has(n)&&(this.usedEntityTypes.add(n),this.active[n]=(this.active[n]||0)+1,!this.isFirstUse(n)&&this.wasInPreviousUpdate(e,t)||(this.record[n]=(this.record[n]||0)+1))}))}getStats(){return{mainActive:this.active,mainContentRecord:this.record,usedEntityTypes:Array.from(this.usedEntityTypes),allEntityTypes:Array.from(this.allEntityTypes)}}isFirstUse(e){return!this.record[e]}wasInPreviousUpdate(e,t){const n=t.find((t=>t.id===e.id));return!!n&&n.activeEntities.mainEntity.type===e.activeEntities.mainEntity.type&&n.activeEntities.mainEntity.id===e.activeEntities.mainEntity.id&&n.correlation.id===e.correlation.id}}const Mk=new Set([ne.p.calls,ne.p.chats,ne.p.extensions,ne.p.schedulingform]);var Fk;!function(e){e.popOutActive="popOutActive",e.popOutRecord="popOutRecord"}(Fk||(Fk={}));class Rk{constructor(){this.active={},this.record={},this.allEntityTypes=new Set,this.usedEntityTypes=new Set,this.monitoredEntityTypes=Mk}update(e,t){this.usedEntityTypes.forEach((e=>{this.active[e]=0})),e.forEach((e=>{const n=e.activeEntities.mainEntity.type;this.allEntityTypes.add(n),this.monitoredEntityTypes.has(n)&&(this.usedEntityTypes.add(n),this.active[n]=(this.active[n]||0)+1,!this.isFirstUse(n)&&this.wasInPreviousUpdate(e,t)||(this.record[n]=(this.record[n]||0)+1))}))}getStats(){return{popOutActive:this.active,popOutRecord:this.record,usedEntityTypes:Array.from(this.usedEntityTypes),allEntityTypes:Array.from(this.allEntityTypes),hasActivePopout:Object.keys(this.active).some((e=>Number(this.active[e])>0))}}isFirstUse(e){return!this.record[e]}wasInPreviousUpdate(e,t){const n=t.find((t=>t.id===e.id));return!!n&&n.activeEntities.mainEntity.type===e.activeEntities.mainEntity.type}}class Pk{constructor(e){this.isBackInMain=!1,this.main=new Ak,this.popOut=new Rk,this._activeWindowsSubscription=(0,te.G)(e.client.watchQuery({query:Ek})).pipe((0,g.h)((({errors:e,loading:t})=>void 0===e&&!t)),(0,y.U)((({data:{activeWindows:e}})=>(this.isBackInMain=e.some((e=>e.id===S.ew)),e))),(0,tt.G)()).subscribe((([e,t])=>{this.update(e,t)})),this.leakDetectorService=e.leakDetectorService}destroy(){this._activeWindowsSubscription.unsubscribe()}getStats(){var e;const t=null===(e=this.leakDetectorService)||void 0===e?void 0:e.getReachableObjects("unwrappedWindow"),n=this.main.getStats();return{backInMain:this.isBackInMain?{allEntityTypes:n.allEntityTypes,backInMainActive:n.mainActive,backInMainContentRecord:n.mainContentRecord,usedEntityTypes:n.usedEntityTypes}:void 0,t2main:this.isBackInMain?void 0:{allEntityTypes:n.allEntityTypes,t2MainActive:n.mainActive,t2MainContentRecord:n.mainContentRecord,usedEntityTypes:n.usedEntityTypes},popOut:this.popOut.getStats(),windowCount:null==t?void 0:t.size}}update(e,t){this.main.update(t.filter((e=>e.isMainWindow)),e.filter((e=>e.isMainWindow))),this.popOut.update(t.filter((e=>!e.isMainWindow)),e.filter((e=>!e.isMainWindow)))}}class Dk{constructor(e){this.context=e,this.inited=!1,this.logger=e.loggerFactory.newLogger("WindowTrackerService")}init(){var e;if(!this.inited){const{client:t,leakDetectorService:n}=this.context,i=(null!==(e=this.logger.errorToTelemetry)&&void 0!==e?e:this.logger.error).bind(this.logger);if(t){this.inited=!0;try{this.windowEntityTypeStats=new Pk({client:t,leakDetectorService:n})}catch(e){i("Failed to initialize WindowEntityTypeStats","webclient_framework_window_tracker_service")}}else i("Failed to initialize WindowEntityTypeStats - missing client","webclient_framework_window_tracker_service")}}getTelemetry(){var e;return this.inited||this.init(),null===(e=this.windowEntityTypeStats)||void 0===e?void 0:e.getStats()}}var jk,xk=n(505263);!function(e){e[e.telemetry_instrumentation_example_event=0]="telemetry_instrumentation_example_event"}(jk||(jk={}));var Ok=n(989087),Lk=n(937791);const Uk="prod",Bk="general";function Wk(e,t,n){let i,a,o;if(n){const e=n.expConfigMetadata.find((e=>e.client===HS)),t=n.expConfigMetadata.find((e=>e.client===$S));i=null==e?void 0:e.config.eTag,a=null==t?void 0:t.config.eTag,o=n.expConfigMetadata.map((e=>e.config.expIds)).filter((e=>e.length>0)).join(",")}else i=e.eTag||void 0,a=e.hostETag||void 0,e.configIds&&e.configIds.experiments&&(o=e.configIds.experiments.join(","));const r=function(e,t){const n=e.ring&&e.ring.id||Bk;if(t)return n;const i=e.environment||Uk;switch(i){case Uk:return n;case"gcc":return`${n}_gcc`;default:return`${i}-${n}`}}(e,t);return{ring:r,eTag:i,hostETag:a,expIds:o,environment:e.environment||void 0}}var Hk;!function(e){e.Action="panelaction",e.View="panelview"}(Hk||(Hk={}));class $k{constructor(e){this.context=e,this.clickStreamBatchInSeconds=75,this.clickStreamMaxBatchSize=15,this.getBatchNumber=()=>this.userBiCache.batchNumber,this.emptyCacheWithoutRestarting=()=>{this.recordClickStreamEvent({isTimeOut:!1,isBatchSize:!1,disableSetTimeout:!0})},this.addEventToUserBiCache=(e,t)=>{"panelaction"===t?(this.userBiCache.actionCount=this.userBiCache.actionCount+1,e["EventInfo.BaseType"]=Hk.Action):(this.userBiCache.viewCount=this.userBiCache.viewCount+1,e["EventInfo.BaseType"]=Hk.View),this.userBiCache.events.push(e),this.userBiCache.events.length>=this.clickStreamMaxBatchSize&&this.recordClickStreamEvent({isTimeOut:!1,isBatchSize:!0})},this.cacheClickStreamToLocalStorage=()=>{this.userBiCache.events.length>0&&this.telemetrySettings.enableClickStreamUnloadCache&&this.context.localStorage.set("clickstream_cache",JSON.stringify(this.userBiCache))},this.setUpHostListeners=()=>{this.host.addEventListener("beforeunload",(()=>(0,l.__awaiter)(this,void 0,void 0,(function*(){this.cacheClickStreamToLocalStorage(),this.emptyCacheWithoutRestarting(),yield this.telemetryProvider.flush()}))))},this.localStorageFlush=()=>{if(this.telemetrySettings.enableClickStreamUnloadCache){const e=this.context.localStorage.get("clickstream_cache");e&&(0,V.P3)($.x.ClickStream,"clickstream_cached",JSON.parse(e)),this.context.localStorage.remove("clickstream_cache")}},this.setBatchTimeandSize=e=>{e===(si.Bh.Desktop||si.Bh.Maglev)?(this.clickStreamBatchInSeconds=this.telemetrySettings.clickStreamBatchInSeconds||75,this.clickStreamMaxBatchSize=this.telemetrySettings.clickStreamMaxBatchSize||15):(this.clickStreamBatchInSeconds=this.telemetrySettings.clickStreamBatchInSecondsWeb||30,this.clickStreamMaxBatchSize=this.telemetrySettings.clickStreamMaxBatchSizeWeb||5)},this.setupClickStreamTimeout=()=>this.context.windowProvider.setTimeout((()=>{this.recordClickStreamEvent({isTimeOut:!0,isBatchSize:!1})}),1e3*this.clickStreamBatchInSeconds),this.recordClickStreamEvent=e=>{if(this.userBiCache.actionCount>0||this.userBiCache.viewCount>0){this.userBiCache.batchFlushed=e.isBatchSize,this.userBiCache.timeoutFlushed=e.isTimeOut;const t=this.userBiCache;this.telemetrySettings.disable1DSBatching&&(t.latency=4),(0,V.P3)($.x.ClickStream,"clickstream",t),this.userBiCache={events:[],batchStartTime:(new Date).toISOString(),viewCount:0,actionCount:0,batchNumber:t.batchNumber+1,batchFlushed:!1,timeoutFlushed:!1}}this.context.windowProvider.clearTimeout(this.currentTimeoutId),e.disableSetTimeout||(this.currentTimeoutId=this.setupClickStreamTimeout())},this.userBiCache={events:[],batchStartTime:(new Date).toISOString(),viewCount:0,actionCount:0,batchNumber:1,batchFlushed:!1,timeoutFlushed:!1},this.telemetrySettings=this.context.coreSettings.get(b.J.Telemetry);const t=this.context.platformService.config.clientType;this.setBatchTimeandSize(t),this.currentTimeoutId=this.setupClickStreamTimeout(),this.host=this.context.windowProvider,this.localStorageFlush(),this.host&&this.setUpHostListeners(),this.telemetryProvider=(0,Df.Yf)()}}class Vk{constructor(e,t,n){if(this.context=e,this.windowId=t,this.correlation=n,this.experimentationEventData={},this.telemetrySettings={},this.panelContextData={},this.dataBagContextData={},this.recordPanelView=(e,t,n)=>{const i=this.getCombinedDataBagData(n);this.recordBiEvent({eventName:"panelview",data:Object.assign(Object.assign({},i),qk(e))},t)},this.recordPanelAction=(e,t,n)=>{const i=this.getCombinedContextData(n),a=this.getCombinedDataBagData(n);this.recordBiEvent({eventName:"panelaction",data:Object.assign(Object.assign({},a),zk(Object.assign(Object.assign({},i),e)))},t)},this.appendBiData=(e,t)=>{const{dataBag:n}=t,i=(0,l.__rest)(t,["dataBag"]),a=Jk(Oo.g$,e);this.dataBagContextData[a]=Object.assign(Object.assign({},this.dataBagContextData[a]),null==n?void 0:n.data),this.panelContextData[a]=Object.assign(Object.assign({},this.panelContextData[a]),i)},this.removeBiData=(e,t)=>{var n,i;const a=Jk(Oo.g$,e);if(t)for(const e of t)this.dataBagContextData&&(null===(n=this.dataBagContextData[a])||void 0===n||delete n[e]),this.panelContextData&&(null===(i=this.panelContextData[a])||void 0===i||delete i[e]);else delete this.dataBagContextData[a],delete this.panelContextData[a]},this.context&&this.context.coreSettings){const{disableRingNamePrefixing:e}=this.context.coreSettings.get(b.J.Telemetry),t=this.context.coreSettings.getObservable(b.J.Metadata);this.metadataSubscription=t.subscribe((t=>{var n;this.experimentationEventData=function(e,t,n){const i={},a=Wk(e,t,n);return i["UserInfo.Ring"]=a.ring,i["UserInfo.ETag"]=a.eTag,i["UserInfo.HostETag"]=a.hostETag,i["AppInfo.ExpIds"]=a.expIds,i["AppInfo.Environment"]=a.environment,i}(t,!!e,null===(n=this.context)||void 0===n?void 0:n.experimentationService)})),this.environment=this.context.coreSettings.get(b.J.Metadata).environment,this.telemetrySettingsSubscription=this.context.coreSettings.getObservable(b.J.Telemetry).subscribe((e=>this.onReceiveTelemetrySettings(e)))}}destroy(){this.metadataSubscription&&this.metadataSubscription.unsubscribe(),this.telemetrySettingsSubscription&&this.telemetrySettingsSubscription.unsubscribe(),this.clickStreamService&&this.clickStreamService.emptyCacheWithoutRestarting()}onReceiveTelemetrySettings(e){this.telemetrySettings=e,this.context&&this.telemetrySettings.enableClickStreamEvents&&!this.clickStreamService&&(this.clickStreamService=new $k(this.context))}recordBiEvent(e,t){this._applyContextData(e);const n=function(e){const t={};return Object.keys(e).forEach((n=>{(0,j.isNil)(e[n])||(t[n]=e[n])})),t}(e.data);if(this.telemetrySettings.enableClickStreamEvents&&this.clickStreamService){const t=(e.eventName,n);this.telemetrySettings.enableDualClickStreamEvents&&(n.batchNumber=this.clickStreamService.getBatchNumber(),(0,V.P3)($.x.UserBI,e.eventName,n,void 0,void 0,this.telemetrySettings.enableUserBiEventIdentifiers?e.data["EventInfo.Identifier"]:void 0)),this.clickStreamService.addEventToUserBiCache(t,e.eventName)}else(0,V.P3)($.x.UserBI,e.eventName,n,void 0,void 0,this.telemetrySettings.enableUserBiEventIdentifiers?e.data["EventInfo.Identifier"]:void 0);t&&(t.debug(`Analytics: EventType: ${e.eventName}`),t.debug(`Analytics: Type: ${n["Panel.Type"]}`),t.debug("Analytics: Payload:",n))}_applyContextData(e){e.data["Panel.WindowID"]=this.windowId,e.data["EventInfo.CorrelationId"]=this.correlation&&this.correlation.id,e.data["Window.Type"]=this.windowId?xk.N.MW:xk.N.Anglr;const t=(0,F.J)().isFocused();e.data["Window.Focus"]=t?Oo.cb.foreground:Oo.cb.background;const n=t?Oo.Lv.maximized:Oo.Lv.minimized;if(e.data["Window.Status"]=n,this.context&&this.context.authenticationUser){const t=this.environment===he.s.life?this.context.authenticationUser.profile.paddedMsaId:this.context.authenticationUser.profile.objectId;e.data["UserInfo.Id"]=t,e.data["UserInfo.TenantId"]=this.context.authenticationUser.profile.tenantId}e.data=Object.assign(Object.assign({},e.data),this.experimentationEventData)}getCombinedContextData(e){let t={};if(e)for(const n of e){const e=Jk(Oo.g$,n);t=Object.assign(Object.assign({},t),this.panelContextData[e])}return t}getCombinedDataBagData(e){let t={};if(e)for(const n of e){const e=Jk(Oo.g$,n);t=Object.assign(Object.assign({},t),this.dataBagContextData[e])}return t}}function zk(e){const{appName:t,actionGesture:n,actionOutcome:i,actionOutcomeNew:a,actionScenario:o,actionScenarioType:r,actionWorkload:s,actionSubworkload:l,moduleName:c,moduleNameNew:d,moduleType:u,moduleTypeNew:m,debug:p,extensibilityData:g,tabId:h,tabIdNew:v,tabOrdinal:f,tabType:y,tabTypeNew:S,callId:k,eventIdentifier:b}=e,_=Jk(Oo.rA,c),C=Jk(Oo.PO,u),w=Jk(Oo.uS,n),T=Jk(Oo.Tk,o),E=(0,j.isNil)(b)?[_,C,w,T].filter(Boolean).join("_"):Jk(jk,b),I=Object.assign(Object.assign({"Action.Gesture":w,"Action.Outcome":Jk(Oo.$K,i),"Action.OutcomeNew":Jk(Oo.$K,a),"Action.Scenario":T,"Action.ScenarioType":Jk(Oo.Yu,r),"Action.WorkLoad":Jk(Oo.g$,s),"Action.SubWorkLoad":Jk(Oo.Nb,l),"Module.Name":_,"Module.Type":C,"Module.NameNew":Jk(Oo.rA,d),"Module.TypeNew":Jk(Oo.PO,m),"Tab.Id":h,"Tab.Type":y,"Tab.IdNew":v,"Tab.TypeNew":S,"Tab.Ordinal":f,"App.Name":t,"Call.Id":k},qk(e)),Gk(g));return(0,j.isNil)(E)||(I["EventInfo.Identifier"]=E),p&&(I["Action.Debug"]=p),I}function Gk(e){if(e)return{"App.Id":e.id,"App.Name":e.name,"App.Scope":Jk(Ok.Mv,e.scope),"App.ScenarioCapability":Jk(Ok.Ky,e.scenarioCapability),"App.EntryPoint":Jk(Ok.sG,e.entryPoint),"App.ExternalId":e.externalId,"App.IsTenantApp":e.isTenantApp,"App.CapabilityId":e.capabilityId,"App.SceneId":e.sceneId,"Bot.Id":e.botId,"App.MsftPartnerAppID":e.mpnId,"App.Source":Jk(Lk.R,e.appDetailsEntryPoint)}}function qk(e){const{panelRegion:t,panelRegionNew:n,panelType:i,panelTypeNew:a,threadId:o,threadMembers:r,threadType:s,panelLaunchMethod:l,panelUri:c,dataBag:d,extensibilityData:u,eventIdentifier:m}=e,p=Jk(Oo.Ai,t),g=Jk(Oo.wh,i),h=(0,j.isNil)(m)?[p,g].filter(Boolean).join("_"):Jk(jk,m);return Object.assign(Object.assign(Object.assign({"Panel.LaunchMethod":l,"Panel.Region":p,"Panel.Type":g,"Panel.RegionNew":Jk(Oo.Ai,n),"Panel.TypeNew":Jk(Oo.wh,a),"Panel.Uri":c,"Thread.Id":o,"Thread.Type":(0,j.isNil)(s)?void 0:Jk(Oo.Th,s),"Thread.Members":r,"TargetThread.Id":o,"TargetThread.Type":(0,j.isNil)(s)?void 0:Jk(Oo.Th,s),"EventInfo.Identifier":h},d&&d.data),Gk(u)),{"UserInfo.ChannelResourceTenant.Id":e["UserInfo.ChannelResourceTenant.Id"]})}function Jk(e,t){return e[t]}class Kk{constructor(e,t,n,i,a){this.coreInitTimestamp=e,this.coreScenarioFactory=t,this.coreTelemetryContext=n,this.enableDiagnostics=i,this.memoryAnalyzer=a,this.newCoreScenario=(e,t)=>this.coreScenarioFactory.newScenario(e,t),this.stopCoreScenarioIfActive=(e,t,n)=>this.coreScenarioFactory.stopScenarioIfActive(e,t,n),this.createScenarioFactory=(e,t,n,i,a)=>{const{coreSettings:o}=e,{enableCreateWindowLaunchScenarioOnMainWindow:r}=o.get(b.J.Core);return new uk(parseInt(n.startTimestamp,10)||Date.now(),this.enableDiagnostics,e,this.memoryAnalyzer,n,t,i,this.coreInitTimestamp,!!r||t!==S.ew,void 0,void 0,void 0,{"Window.ViewportContext":a})},this.createUserBiService=(e,t,n)=>new Vk(e,t,n),this.setCoreContext=(e,t,n)=>{this.coreTelemetryContext.setContext(e,t,n)},this.setDeviceAuthToken=e=>{this.coreTelemetryContext.setDeviceAuthToken(e)}}}function Qk(e,t){const n=e.location.hostname;return t&&t!==n}var Yk=n(854479);function Xk(e,t,n,i,a,o){const r=o&&o.delta||0,s=function(e,t,n){let i;switch(e){case"share-to-teams":i=function(e,t){let n;if(t.performance&&t.performance.navigation&&0===t.performance.navigation.type){const{s:i}=e.getSearchState();if(i)n=parseInt(i,10);else{const e="outlook"===t.document.head.dataset.host,i=t.localStorage.getItem(Yk.qB.STT_START_TIME);e&&i&&(n=parseInt(i,10),t.localStorage.removeItem(Yk.qB.STT_START_TIME))}}return n}(t,n)}return i}(e,i,a),l=s?{name:A.ck.ClickTimeAction,timestamp:n-r}:void 0,c=l?[l]:[];o&&c.push({name:o.name,timestamp:n});const d=s||n-r,u=t.newScenario(A.RG.ExperienceReady,{startTime:d});c.forEach((e=>{u.mark(e.name,{overrideTimestamp:e.timestamp})}))}function Zk(e,t,n,i,a,o,r={cached:!1}){const s={name:e,delta:0},l=Y(e,t,n,i.performance,o);return void 0!==l&&(s.delta=l,a.createScenarioWithoutStarting(e).stop({delta:l,cached:r.cached})),s}var eb=n(565810);const tb="Teams",nb=/(windows|win32)/i,ib=/ arm;/i,ab=/windows\sphone\s\d+\.\d+/i,ob=/(macintosh|mac os x|mac)/i,rb=/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i,sb=/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,lb=/android/i,cb=(e,t,n,i,a,o)=>{var r;const{browser:s,browserVersion:l,clientContext:c,clientType:d,clientVersion:u,localeCode:m,osPlatform:p,osVersion:g,platformId:h,userAgent:v,userLanguage:f}=n.config,{bootType:y,deviceId:k,panelContext:_,sessionId:C,sessionStartTime:w,startReason:T}=n.host,E=i.get(b.J.Telemetry),{defaultToken:I,enableSharedWorker:N,isSilent:A,telemetryServer:M,enableCustomCacheSize:F,eventsLimitInMem:R,normalPrioritySendTimeInSecs:P,highPrioritySendTimeInSecs:D,autoFlushPercent:j,enableOneDsSdkNs:x,oneDsCollectorUrl:O,enableCompression:L,enablePrivacyGuard:U,enableLoggingGlobalDeviceId:B,privacyGuardIngestionToken:W,disableRingNamePrefixing:H,disablePlatformServiceOsVersion:$}=E,z=i.get(b.J.Metadata),{hostAppWebVersion:G,sharedWorkerUrl:q}=i.get(b.J.Host),J=z.environment===he.s.life?Oo.OV.Life:Oo.OV.Work;if(!M||!I)throw t.error("Telemetry server url or app token not supplied. This is required by Aria"),(0,Z.Tr)("telemetry-initialization",S.jK.Undefined,"init");const K=(e=>{let t=e;return t||(t=(0,Be.v4)()),t})(k),Q=e.windowType!==xk.N.Anglr?"NS":"",Y={userAgent:v,firstLaunchTime:e.appStartTime,tablePostfix:Q,deviceId:K},X=new eb.Mk;X.collectorUrl=M,F&&R&&(X.eventsLimitInMem=R);const ee={config:X,appTokens:{default:I},documentInfo:Y,isSilent:!!A,sessionId:C||void 0,sessionStartTime:w,clientType:d,sharedWorkerUrl:q||void 0,enableSharedWorker:!!N,eventsLimitInMem:R||3e3,normalPrioritySendTimeInSecs:P||15,highPrioritySendTimeInSecs:D||15,autoFlushPercent:j||.33,enableOneDsSdkNs:!!x,oneDsCollectorUrl:O||void 0,enableCompression:!!L,enablePrivacyGuard:!!U,enableLoggingGlobalDeviceId:!!B,privacyGuardIngestionToken:W||void 0};V.ip.getInstance().initialize(ee,t,i);const te=nS();te.isInitialized()||te.initialize(t);const ne=Wk(z,db(!!H,e,a),o).ring,ie=vb(Y.userAgent),ae=yb(Y.userAgent),oe=Sb(!!E.enableRegexRemoval,p),re=kb(p),se=_b();te.setContext("AppInfo.ClientType",null!==(r=e.clientTypeTelemetry)&&void 0!==r?r:d),te.setContext("AppInfo.ClientContext",c),te.setContext("AppInfo.HostAppVersion",ie),te.setContext("AppInfo.ProcessArchitecture",ae),te.setContext("AppInfo.WebVersion",G),G&&te.setContext("AppInfo.HostAppWebVersion",hb(G)),te.setContext("AppInfo.Language",m),te.setContext("AppInfo.Locale",m),te.setContext("AppInfo.PlatformId",h);const le=fb(u,G);return E.enableEnhancedTelemetry?te.setContext("AppInfo.Version",le):te.setContext("AppInfo.Version",u),te.setContext("AppInfo.VersionNew",le),te.setContext("AppInfo.ReactAppVersion",u),te.setContext("AppInfo.ExperienceName",e.experienceName),te.setContext("DeviceInfo.OsName",re),$||te.setContext("DeviceInfo.OsVersion",g),te.setContext("DeviceInfo.OsFamily",oe),te.setContext("EventInfo.isNS",!0),te.setContext("Panel.Context",_),te.setContext("Session.Id",C),te.setContext("startReason",T),te.setContext("UserInfo.Language",f),te.setContext("UserInfo.Ring",ne),te.setContext("UserInfo.TimeZone",se),te.setContext("userAgent",Y.userAgent),te.setContext("Window.Type",e.windowType),te.setContext("DeviceInfo.BrowserName",s),te.setContext("DeviceInfo.BrowserVersion",l),te.setContext("DeviceInfo.Id",Y.deviceId),te.setContext("Tenant.Model",J),te.setContext("Session.TelemetryContext","web"),te.setContext("AppInfo.BootType",y),ub(i,te,e,a,o),mb(i,te),pb(le,i,te),{telemetryContext:te}},db=(e,t,n)=>!(!n||"react-web-client"!==t.experienceName)||e,ub=(e,t,n,i,a)=>{const o=e.getObservable(b.J.Metadata),{disableRingNamePrefixing:r}=e.get(b.J.Telemetry);if(o.subscribe((e=>{null==a||a.updateWebExperimentConfigMetadata(e),null==a||a.communicateWithHost();const o=Wk(e,db(!!r,n,i),a);t.setContext("UserInfo.Ring",o.ring),t.setContext("UserInfo.ETag",o.eTag),t.setContext("UserInfo.HostETag",o.hostETag),t.setContext("AppInfo.ExpIds",o.expIds),t.setContext("AppInfo.Environment",o.environment)})),a){a.ecmObservable.subscribe((e=>{const n=e.find((e=>e.client===$S)),i=e.map((e=>e.config.expIds)).filter((e=>e.length>0)).join(",");t.setContext("UserInfo.HostETag",null==n?void 0:n.config.eTag),t.setContext("AppInfo.ExpIds",i)}))}},mb=(e,t)=>{e.getObservable(b.J.UserResources).subscribe((e=>{const n=e.licenseType||void 0;t.setContext("UserInfo.LicenseType",n)}))},pb=(e,t,n)=>{t.getObservable(b.J.Host).subscribe((i=>{i&&gb(e,t,n,i)}))},gb=(e,t,n,i)=>{const{enableEnhancedTelemetry:a,enableGetUserTypeFromHost:o}=t.get(b.J.Telemetry),r=i.desktopVersion||void 0,s=r?e.concat(",",r):e;r&&n.setContext("AppInfo.DesktopVersion",r),n.setContext("AppInfo.VersionNew",s),i.systemManufacturer&&n.setContext("DeviceInfo.Make",i.systemManufacturer),i.systemProductName&&n.setContext("DeviceInfo.Model",i.systemProductName),n.setContext("rendererCount",i.rendererCount),a&&n.setContext("AppInfo.Version",s),n.setContext("AppInfo.WebVersion",i.hostAppWebVersion),i.hostAppWebVersion&&n.setContext("AppInfo.HostAppWebVersion",hb(i.hostAppWebVersion)),o&&i.userType&&n.setContext("userType",i.userType)},hb=e=>{let t="";const n=e.indexOf("/");return n>-1&&(t=e.substring(n+1,e.length)),t},vb=e=>{let t;const n=e.indexOf(tb);if(n>-1){t=e.substring(n+tb.length+1);const i=t.indexOf(" ");t=t.substring(0,i)}return t},fb=(e,t)=>t?e.concat(",",t):e,yb=e=>{let t=Oo.Wz.unknown;return bb(e,Oo.Wz.x64)?t=Oo.Wz.x64:bb(e,Oo.Wz.x86)?t=Oo.Wz.x86:bb(e,Oo.Wz.ia32)&&(t=Oo.Wz.ia32),t},Sb=(e,t)=>{if(!e){let e=Oo.Zc.UNKNOWN;const n=(null==t?void 0:t.match(nb))||(null==t?void 0:t.match(ib))||(null==t?void 0:t.match(ab)),i=(null==t?void 0:t.match(sb))||(null==t?void 0:t.match(lb)),a=(null==t?void 0:t.match(ob))||(null==t?void 0:t.match(rb));return n?e=Oo.Zc.WINDOWS:i?e=Oo.Zc.UNIX:a&&(e=Oo.Zc.MACOSX),e}switch(t){case si.NR.Windows:case si.NR.WindowsPhone:return Oo.Zc.WINDOWS;case si.NR.ChromeOS:case si.NR.Android:case si.NR.Linux:return Oo.Zc.UNIX;case si.NR.IOS:case si.NR.Mac:return Oo.Zc.MACOSX;default:return Oo.Zc.UNKNOWN}},kb=e=>{switch(e){case si.NR.Windows:return"Windows";case si.NR.Mac:return"Mac OS X";case si.NR.Linux:return"Linux";case si.NR.ChromeOS:return"Chrome OS";case si.NR.Android:return"Android";case si.NR.IOS:return"iOS";case si.NR.WindowsPhone:return"Windows Phone";case si.NR.Unknown:return"Unknown";default:return e}},bb=(e,t)=>!!(e.indexOf(t)>-1),_b=()=>{const e=(new Date).getTimezoneOffset();let t=e%60,n=(e-t)/60;const i=n>0?"-":"+";t=Math.abs(t),n=Math.abs(n);const a=t<10?`0${t}`:t.toString();return`${i}${n<10?`0${n}`:n.toString()}:${a}`};class Cb{constructor(){this.id=S.Yg.InitTelemetry}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const t=e.loggerFactory.newLogger("init-telemetry-task"),{coreSettings:n,hostCommunicationService:i,leakDetectorService:a}=e,o=n.get(b.J.Telemetry),r=this.createMemoryAnalyzer(e,o);this.createAppResponsivenessService(e,o),this.createDataClientTrackerService(e,a),this.createWindowTrackerService(e),yield this.createHeartbeatMonitor(e);const{desktopActiveScenarios:s,crossClientRegistrationMethods:l,deviceInfo:c,systemCpuInfo:d,desktopContext:u,notifyDesktopScenarioFactoryReady:m,finalizeLegacyCrossClient:p}=yield this.initializeCrossClientTelemetry(t,i),g=this.createCoreScenarioFactory(e,o,r,p,s,l);null==m||m(),null==i||i.setScenarioFactory(g),this.createCoreTelemetryService(e,o,r,g,c,d,u),this.createCoreUserBiService(e),this.startAppStartScenarios(e,g),this.createAltScenarioService(e),i&&(yield this.handOffContextCommsCallback(i))}))}initializeCrossClientTelemetry(e,t){var n,i,a;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const o={};if(t){try{const e=yield t.loadModule("scenario");e&&(e.getActiveScenarios&&(o.desktopActiveScenarios=yield e.getActiveScenarios({})),e.setScenarioCompletion&&(o.finalizeLegacyCrossClient=e.setScenarioCompletion),e.registerForScenarioMark&&e.registerForScenarioStart&&e.registerForScenarioStop&&(o.crossClientRegistrationMethods={start:e.registerForScenarioStart,mark:e.registerForScenarioMark,stop:e.registerForScenarioStop}),o.notifyDesktopScenarioFactoryReady=()=>{var t;null===(t=e.setWebAvailability)||void 0===t||t.call(e,!0)})}catch(t){e.error("Failed to load host communication scenario module")}try{const e=yield t.loadModule("osutils");e&&(o.deviceInfo=yield null===(n=e.getDeviceInfo)||void 0===n?void 0:n.call(e),o.systemCpuInfo=yield null===(i=e.getSystemCpuInfo)||void 0===i?void 0:i.call(e))}catch(t){e.error("Failed to load host communication osutils module")}try{const e=yield t.loadModule("telemetry");o.desktopContext=yield null===(a=null==e?void 0:e.getContext)||void 0===a?void 0:a.call(e,{columns:["launchIntent","desktopVersion","deviceAuthToken"]})}catch(t){e.error("Failed to load host communication telemetry module")}}return o}))}handOffContextCommsCallback(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const t=yield e.loadModule("telemetry");if(t&&t.setContext){const e=t.setContext;(0,Df.Yf)().setMultiContextCallback(((t,n)=>e([{column:t,value:n}])))}}))}createMemoryAnalyzer({windowProvider:e},t){const{enableDesktopMemoryAnalyzer:n,isScenarioMemorySnapshotEnabled:i}=t;return n?new XS(!!i,e):void 0}createCoreScenarioFactory(e,t,n,i,a,o){const{config:r,correlation:s}=e,{enableSendTelemetryToDiagnostics:l}=t,c=new uk(r.startTimeMS,!!l,e,n,s,void 0,void 0,void 0,void 0,a,o,i);return e.scenarioFactory=c,c}createHeartbeatMonitor(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const t=new fk(e);yield t.start()}))}createAltScenarioService(e){const{windowProvider:t,loggerFactory:n,coreSettings:i,scenarioFactory:a}=e;e.altScenarioService=new yk({host:t,loggerFactory:n,coreSettings:i,scenarioFactory:a})}createAppResponsivenessService(e,t){const{disableAriService:n}=t;if(!n){const{windowProvider:t,loggerFactory:n,coreSettings:i}=e;e.appResponsivenessService=new _k(t,{loggerFactory:n,windowProvider:t,coreSettings:i})}}createDataClientTrackerService(e,t){const n=e.coreSettings.get(b.J.Core),i=(a=e,function(){return a.appStateService&&[S.eT.Inactive,S.eT.LongInactive].includes(a.appStateService.getState())||a.clientState&&[Dn.pk.Inactive,Dn.pk.LongInactive].includes(a.clientState.getState())||!1});var a;e.dataClientTrackingService=new Tk(i,n,t)}createWindowTrackerService(e){e.windowTrackerService=new Dk(e)}createCoreTelemetryService(e,t,n,i,a,o,r){const{config:s,coreSettings:l,loggerFactory:c,platformService:d,routingServices:u,windowProvider:m,experimentationService:p}=e,{enableSendTelemetryToDiagnostics:g}=t,{telemetryContext:h}=((e,t,n,i,a)=>{const o=t.newLogger("Telemetry");return cb(e,o,n,i,!1,a)})({appStartTime:s.startTimeMS,experienceName:s.experienceName,windowType:s.windowType,clientTypeTelemetry:s.clientTypeTelemetry},c,d,l,p),v=new Kk(s.startTimeMS,i,h,!!g,n);if(m.localStorage){const e=m.localStorage.getItem("ts.latestOid");v.setCoreContext("UserInfo.Id",e)}s.externalCorrelationId&&v.setCoreContext("EventInfo.ExternalCorrelationId",s.externalCorrelationId),s.embedContext&&(v.setCoreContext("Window.EmbedContext",s.embedContext),v.setCoreContext("AppInfo.EmbedReferrer",function(e,t){try{const{referrer:n}=t.getSearchState(),i=e.document.referrer,a=e.parent.opener;let o=n;return Qk(e,o)||(o=i&&(0,li.Lp)(i),Qk(e,o)||(o=a&&a.location&&a.location.hostname,!Qk(e,o)&&e.location.ancestorOrigins&&e.location.ancestorOrigins.length>0&&(o=e.location.ancestorOrigins[0]))),o||""}catch(e){return""}}(m,u.state))),this.setTelemetryContext(v,a,o,r),v.setCoreContext("AppInfo.ArchVersion","V2"),e.telemetryService=v}createCoreUserBiService(e){var t;const{config:n}=e,i=null===(t=e.telemetryService)||void 0===t?void 0:t.createUserBiService(e,S.ew,{id:(0,Be.v4)(),source:k.D.StandAlone,startTimestamp:n.startTimeMS});e.userBiService=i}setTelemetryContext(e,t,n,i){if(t&&(e.setCoreContext("DeviceInfo.Make",t.make),e.setCoreContext("DeviceInfo.Model",t.model),e.setCoreContext("DeviceInfo.CpuArchitecture",t.cpuArchitecture),e.setCoreContext("DeviceInfo.OsVersion",t.osVersion)),n&&(e.setCoreContext("CpuInfo.Cores",n.cpuCores.length.toString()),e.setCoreContext("CpuInfo.Model",n.cpuCores[0].model),e.setCoreContext("CpuInfo.Speed",n.cpuCores[0].speed)),i&&0!==i.length){const t=i.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.column]:t.value})),{}),n=t.launchIntent,a=t.desktopVersion,o=t.deviceAuthToken;n&&e.setCoreContext("AppInfo.LaunchIntent",n),a&&e.setCoreContext("AppInfo.DesktopVersion",a),o&&e.setDeviceAuthToken(o)}}startAppStartScenarios(e,t){const{config:n,loggerFactory:i,routingServices:a,telemetryService:o,windowProvider:r}=e,s=this.getDownloadAndParseStepData(i,t,r);null==o||o.newCoreScenario(A.RG.AppStart,{startTime:n.startTimeMS}),Xk(n.experienceName,t,n.startTimeMS,a.state,r,s)}getDownloadAndParseStepData(e,t,n){let i;if(n.performance){const a=e.newLogger("InitTelemetryTask");n.performance.timing&&t.createScenarioWithoutStarting(A.RG.DomLoadingStart,{startTime:n.performance.timing.domLoading}).stop();const o=n.performance.getEntriesByType("resource").find((e=>"script"===e.initiatorType&&e.name.indexOf("main")>=0)),r=void 0!==o&&0===o.transferSize;i=Zk(A.RG.DownloadAndParse,"execute-index-html-script","start-execute-main-bundle",n,t,a,{cached:r}),Zk(A.RG.ResolveMainImports,"start-execute-main-bundle","resolve-main-imports-end",n,t,a)}return i}}class wb{constructor(){this.id=S.Yg.ReinitSettingsEcsProvider}execute({coreSettingsContext:e,authenticationService:t}){return(0,l.__awaiter)(this,void 0,void 0,(function*(){yield e.reinitializeEcsProvider(t)}))}}class Tb{constructor(){this.id=S.Yg.SetUserOnTelemetryContext}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{telemetryService:t,authenticationUser:n,coreSettings:i,loggerFactory:a}=Ko("SetUserOnTelemetryContextTask",e,"telemetryService","authenticationUser","coreSettings","loggerFactory"),o=n.type===Pv.C.MsaLife||i.get(b.J.Metadata).environment===he.s.life;o&&(n.profile.paddedMsaId=this.getPaddedMsaId(n,a.newLogger("SetUserOnTelemetryContextTask"))),this.setAuthUserOnTelemetryContext(t,n,o)}))}setAuthUserOnTelemetryContext(e,t,n){n&&t.profile.paddedMsaId&&this.setTflUserIdOnTelemetryContext(e,t.profile.paddedMsaId);const i=n&&t.profile.paddedMsaId?t.profile.paddedMsaId:t.profile.objectId;e.setCoreContext("UserInfo.Id",i),e.setCoreContext("UserInfo.TenantId",t.profile.tenantId),e.setCoreContext("UserInfo.Type",t.type),e.setCoreContext("UserInfo.Role",t.role)}setTflUserIdOnTelemetryContext(e,t){const n=t.slice(19).replace("-","");e.setCoreContext("userId",n)}getPaddedMsaId(e,t){const{objectId:n}=e.profile;try{if(/(\w{8})-(\w{4})-(\w{4})-(\w{4})-(\w{12})/.exec(n)&&n.startsWith("00000000-0000-0000-"))return n;{const e=(0,j.padStart)(n,32,"0"),t=/(\w{8})(\w{4})(\w{4})(\w{4})(\w{12})/;return e.replace(t,"$1-$2-$3-$4-$5")}}catch(e){return void t.error("failed_user_padding")}}}function Eb(e){return!!(null==e?void 0:e.isAuthenticated)}function Ib(e,t){const{enableTflFreProfileConsentDialog:n}=e.get(b.J.Fre);return!(!n||t&&"true"===t.get("TflFreProfileCardDisplayed"))}class Nb{constructor(){this.id=S.Yg.SignalCoreLifecycleChangesTask}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,correlation:n,experienceChangeReportingService:i,windowProvider:a,loggerFactory:o,coreSettings:r,localStorage:s}=e,l=hv(a.location,o),c=n.id;Eb(t)&&i.report({correlationId:c,type:fe.yU.UserAuthenticated,context:{target:"core-tasks-signal-core-lifecycle-changes-task"}}),Ib(r,s)||i.report({correlationId:c,type:fe.yU.UserConsentedToConsumeResources,context:{target:"core-tasks-signal-core-lifecycle-changes-task"}});const d=l&&Zh[l.deepLink];d&&i.report({correlationId:c,type:fe.yU.CoreDeepLinkResolved,context:{target:"core-tasks-signal-core-lifecycle-changes-task",deepLinkType:d}})}))}}class Ab{constructor(){this.id=S.Yg.UpdateDataClientContext}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){Jh(e.client,e)}))}}var Mb=n(332304);class Fb{constructor(){this.id=S.Yg.CreateUserOnContextContext}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{authenticationService:t,loggerFactory:n}=e;try{const n=yield t.getUser();e.authenticationUser=(0,Mb.K)(n)}catch(e){n.newLogger("CreateUserOnContextTask").warn("No user returned from authentication: ",e)}}))}}const Rb={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"activeWindows"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindows"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"layoutMode"}},{kind:"Field",name:{kind:"Name",value:"isMainWindow"}}]}}]}}]},Pb=e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{data:t}=yield e.query({query:Rb}),n=null==t?void 0:t.activeWindows.filter((e=>e.isMainWindow&&e.layoutMode===Ie.LayoutModes.standard));return n.length>0?n[0]:void 0}));class Db{constructor(e,t,n){this._commandHandler=e,this._client=t,this._experienceChangeReportingService=n}processEvent(e,t){var n;return(0,l.__awaiter)(this,void 0,void 0,(function*(){this._mainShortcutServiceCallbackWithPayload=()=>{var e;null===(e=this._mainShortcutServiceCallback)||void 0===e||e.call(this,t)};(yield Pb(this._client))?null===(n=this._mainShortcutServiceCallbackWithPayload)||void 0===n||n.call(this):this._subscribeToChangeReportingService(),yield this.openMainApp()}))}addEventListener(e,t){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const n=yield Pb(this._client);(null==n?void 0:n.id)===e&&(this._mainShortcutServiceCallback=t)}))}destroy(){this._subscription&&this._subscription.unsubscribe()}openMainApp(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){return this._commandHandler({entity:{type:ne.p.default,action:ne.u.default},command:{visibilityState:be.fe.show,stateTransition:be.su.flush,correlation:{source:k.D.Core}}})}))}_subscribeToChangeReportingService(){const e=this._experienceChangeReportingService.observeChanges();this._subscription=e.pipe((0,y.U)((e=>(0,l.__awaiter)(this,void 0,void 0,(function*(){if(e.type!==fe.FV.LayoutRenderComplete)return;const t=yield Pb(this._client);e.windowId===(null==t?void 0:t.id)&&this._onMainWindowLayoutRenderComplete()}))))).subscribe()}_onMainWindowLayoutRenderComplete(){var e;null===(e=this._mainShortcutServiceCallbackWithPayload)||void 0===e||e.call(this),this.destroy()}}const jb={Initialization:[new Vo,new iS,new DS,new jy,new Cy,new Mv,new Qo,new Ts,new ey,new class{constructor(){this.id=S.Yg.InitSettingsMaglevHostProvider}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{coreSettingsContext:t,hostCommunicationService:n}=Ko("InitSettingsEcsProviderTask",e,"coreSettingsContext","hostCommunicationService"),{enableMaglevHostProvider:i}=t.getCoreSettings().get(b.J.Core);i&&(yield t.initializeMaglevHostProvider(n))}))}},new Fv,new hy,new class{constructor(){this.id=S.Yg.InitExperimentation}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,hostCommunicationService:n}=Ko("InitExperimentationTask",e,"coreSettings","hostCommunicationService"),i=new VS(t,n);e.experimentationService=i}))}},new Cb,new my,new Uf,new ca,new Ay,new class{constructor(){this.id=S.Yg.CreateAuthStateTask,this._updateTelemetryOnClientStateChange=(e,t)=>{e.observe().subscribe((e=>{t.setCoreContext("AppInfo.AuthState",e)}))}}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{loggerFactory:t,coreSettings:n,telemetryService:i}=e,{enableAuthState:a}=n.get(b.J.Auth);a&&(e.authStateProvider=new _a(t,n),this._updateTelemetryOnClientStateChange(e.authStateProvider,i))}))}},new ka,new Zv,new zf,new zS,new $o,new class{constructor(){this.id=S.Yg.FetchCriticalDynamicImportsTask}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{criticalDynamicImports:t,loggerFactory:n}=e;t&&0!==t.length&&t.forEach((({importFunc:e,chunkName:t})=>{(0,ha.mT)(e,t).catch((e=>n.newLogger("FetchCriticalDynamicImportsTask").error(`Failed to preload chunk ${t} this will regress performance of first load: ${e}`)))}))}))}},new Ev,new xr,new Yh,new ny,new Yo,new class{constructor(){this.id=S.Yg.CreateHostCommunication}execute(e){var t;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{commandHandler:n,client:i,coreSettings:a,experienceChangeReportingService:o}=Ko("CreateCoreShortcutServiceTask",e,"commandHandler","client","coreSettings","experienceChangeReportingService");(null===(t=a.get(b.J.Shortcuts))||void 0===t?void 0:t.enableShortcutPropagation)&&(e.coreShortcutService=new Db(n,i,o))}))}},new wv,new Bf,new class{constructor(){this.id=S.Yg.CreateCommandResultHooksService}execute(e){var t;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{appsRegistryService:n,coreSettings:i,client:a,commandResultChangeReportingService:o,entityCommanding:r}=Ko("CreateCommandReportingServiceTask",e,"appsRegistryService","client","commandResultChangeReportingService","coreSettings","entityCommanding");return(null===(t=i.get(b.J.Core))||void 0===t?void 0:t.enableStandaloneCommandReportingService)&&new Or(n,a,o,r).init(),Promise.resolve()}))}},new $f,new Es,new eS,new class{constructor(){this.id=S.Yg.StoreBuildInfoTask}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{localStorage:t,platformService:n}=e,i=n.config.buildVersion;i&&!i.toLocaleLowerCase().startsWith("local")&&t.set("buildNumber",i,S.fO.Experience)}))}},new wa,new Iy],OnUserAuthenticated:[new Tb,new Fb,new wb,new class{constructor(){this.id=S.Yg.InitDesktopEcsContext}execute(e){var t,n;return(0,l.__awaiter)(this,void 0,void 0,(function*(){const i=yield null===(t=e.hostCommunicationService)||void 0===t?void 0:t.loadModule("ecs");if(i){const t=yield this.getDesktopEcsFilters(e);null===(n=i.setEcsContext)||void 0===n||n.call(i,t)}}))}getDesktopEcsFilters(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,coreSettings:n}=e;if(!t)return Promise.reject("Unable to set ECS context on native client, no authenticationUser found.");const{ring:i,environment:a}=n.get(b.J.Metadata);return{ring:(null==i?void 0:i.id)||"general",cloud:a||"prod",userId:t.profile.objectId,tenantId:t.profile.tenantId}}))}},new class{constructor(){this.id=S.Yg.ReloadExperience,this.isReloadRequired=(e,t)=>e&&t&&e!==t}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,platformService:n,rebootService:i,loggerFactory:a,scenarioFactory:o}=(e=>Ko("ReloadExperienceTask",e,"coreSettings","platformService","rebootService","loggerFactory","scenarioFactory"))(e),{buildRing:r,assignedRing:s}=this.getRings(n,t);if(this.isReloadRequired(r,s)&&s){(yield i.rebootApp("Ring Switch",ev.d.ReloadAppTask,{qsps:{ring:s},maxRetries:1}))||this.reportReloadNotTriggered(r,s,a,o)}else i.clearRetryCount(ev.d.ReloadAppTask)}))}getRings(e,t){const{ring:n}=t.get(b.J.Metadata);return{assignedRing:(null==n?void 0:n.id)||void 0,buildRing:e.ecsOverrides.ring||void 0}}reportReloadNotTriggered(e,t,n,i){n.newLogger("ReloadExperienceTask").warn(`Ring Discreptancy: Assigned: ${t}, Build: ${e} `),i.createScenarioWithoutStarting(A.RG.BuildRingDiscrepancy).fail({message:e})}},new WS,new vy,new Ia,new Ab,new Do,new YS,new class{constructor(){this.id=S.Yg.CreateWebClientUpdate}execute(e,t){return(0,l.__awaiter)(this,void 0,void 0,(function*(){t.webClientUpdateService=new RS(e)}))}},new OS,new Nb,new jS]};class xb{constructor(){this.id=S.Yg.DisableExperience}execute(e){var t,n,i;return(0,l.__awaiter)(this,void 0,void 0,(function*(){if((null===(t=e.config)||void 0===t?void 0:t.isAuthStrap)||!(null===(n=e.coreSettings)||void 0===n?void 0:n.get(b.J.Core).disableExperience))return;throw(null===(i=e.coreSettings)||void 0===i?void 0:i.get(b.J.Core).enableCoreErrorsV2)?new hi.G("EXPERIENCE_DISABLED"):(0,Z.Tr)(S.w5.Core,S.jK.ExperienceDisabled,"DisableExperienceTask",void 0,"Experience is disabled.",void 0)}))}}var Ob;!function(e){e[e.Unknown=5e4]="Unknown",e[e.GetSingletonStoreFailed=4e4]="GetSingletonStoreFailed",e[e.CreateStoreFailed=40001]="CreateStoreFailed",e[e.ActionNotSupported=40002]="ActionNotSupported"}(Ob||(Ob={}));var Lb=n(537330),Ub=n(42103),Bb=n(24932),Wb=n(702760);const Hb={code:Ob.CreateStoreFailed,message:"Store is not available"};function $b(e){return new Vb(e)}class Vb extends at.y{constructor(e){const t=e?zb(e):(0,Lb._)(Hb);super((e=>t.subscribe(e))),this._dispatcher=e?Promise.resolve(e):Promise.reject(Hb)}dispatch(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){return(yield this._dispatcher).dispatch(e)}))}}const zb=e=>(0,u.D)(Promise.resolve(e)).pipe((0,Ub.w)((e=>new at.y((t=>e.subscribe((e=>t.next(e))))))),(0,Bb._)(1),(0,Wb.x)());class Gb extends at.y{constructor(e,t){const n=t.pipe((0,y.U)((t=>{var n;return null===(n=null==t?void 0:t.windows[e])||void 0===n?void 0:n.lifecycle})),(0,$i.x)(j.isEqual),(0,g.h)((e=>void 0!==e)),(0,nt.o)((e=>void 0===e.closedTime),!0));super((e=>n.subscribe(e))),this._id=e,this._dispatcher=t}pushWltMarks(e){return this._dispatcher.dispatch({type:"RECORD_WINDOW_LIFECYCLE_MARKS",windowId:this._id,markers:e})}}var qb=n(962360),Jb=n(841532);class Kb{constructor(e,t,n){if(this.exitFullscreen=e=>this._observableStore.dispatch((e=>({type:"SET_FULLSCREEN",windowId:e,fullscreen:!1}))(e)),this.focus=e=>this._observableStore.dispatch((e=>({type:"FOCUS_WINDOW",windowId:e}))(e)),this.maximize=e=>this._observableStore.dispatch((e=>({type:"TOGGLE_MAXIMIZE_WINDOW",windowId:e}))(e)),this.minimize=e=>this._observableStore.dispatch((e=>({type:"MINIMIZE_WINDOW",windowId:e}))(e)),this.requestFullscreen=e=>this._observableStore.dispatch((e=>({type:"SET_FULLSCREEN",windowId:e,fullscreen:!0}))(e)),this.show=e=>this._observableStore.dispatch((e=>({type:"SHOW_WINDOW",windowId:e}))(e)),this.windowTitleDblClick=e=>this._observableStore.dispatch((e=>({type:"INVOKE_DOUBLE_CLICK",windowId:e}))(e)),e.createInterprocessStore){const i=e.createInterprocessStore({logDebug:(...e)=>t.debug(...e),logError:(...e)=>t.error(...e),logInfo:(...e)=>t.log(...e),logScenario:e=>{n.newScenario(e.name).stop(void 0,e.status)}});this._observableStore=$b(i)}else this._observableStore=$b(null)}onWindowFullscreen(e){return this._observableStore.pipe((0,qb.j)("windows",e),(0,Jb.n)((e=>void 0===e)),(0,nt.o)((e=>{var t;return void 0===(null===(t=e.lifecycle)||void 0===t?void 0:t.closedTime)})),(0,qb.j)("layout","fullscreen"),(0,$i.x)())}onLifecycleMarks(e){return new Gb(e,this._observableStore)}}const Qb={Initialization:[new class{constructor(){this.id=S.Yg.Polyfills}execute(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){this.applyAsyncIteratorPolyfillIfNeeded()}))}applyAsyncIteratorPolyfillIfNeeded(){void 0===Symbol.asyncIterator&&(Symbol.asyncIterator=Symbol.asyncIterator||n(212673).$$asyncIterator)}},new Vo,new iS,new DS,new jy,new class{constructor(){this.id=S.Yg.FetchHostSettingsTask}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{config:t,hostedWindowContext:n,loggerFactory:i,windowProvider:a}=e,{isInCypressFrame:o,isInIframe:r}=n;if(!a)throw new Error("FetchHostSettingsTask: windowProvider does not exist");const s=i.newLogger("FetchHostSettingsTask");if(t.shouldFetchBootstrapData&&r&&!o)try{s.log("Hosted in web. Fetching host settings from host over IPC.");const t=yield a.opener.requestMessage(R.rY.GetStateData,{requestType:"hostSettings"});s.log("Host settings fetched, setting context.hostSettings"),e.hostSettings=Object.assign({},t.hostSettings)}catch(e){s.error(`Error fetching host settings over IPC ${e}`)}else{s.log("Hosted in desktop. Getting host settings from window object.");const t=window;t.hostSettings&&(s.log("Found window.hostSettings."),e.hostSettings=Object.assign({},t.hostSettings),delete t.hostSettings)}}))}},new class{constructor(){this.id=S.Yg.CreateHostedWindowContext}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{hostedWindowContext:t,hostSettings:n}=e,i=null==n?void 0:n.hostSettings;i&&(t.sessionStartTime=i.createdTime,t.localeCode=i.localeCode,t.ring=i.hostRingId),"general_gcc"===t.ring&&(null==i?void 0:i.enableDevTools)&&(t.ring="ring0_gcc")}))}},new Cy,new Mv,new Qo,new Ts,new ey,new xb,new Fv,new hy,new Cb,new my,new Uf,new ca,new class{constructor(){this.id=S.Yg.ClearHostSettingsTask}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{loggerFactory:t}=e,n=t.newLogger("ClearHostSettingsTask");e.hostSettings=void 0,n.log("ClearHostSettingsTask: Host settings cleared from task init context.")}))}},new Ay,new ka,new Zv,new zf,new zS,new $o,new Ev,new xb,new xr,new Yh,new ny,new Yo,new wv,new Bf,new Es,new eS,new $f,new class{constructor(){this.id=S.Yg.InitInterprocessStore}execute(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{windowProvider:t,loggerFactory:n,scenarioFactory:i,coreSettings:a}=e;if(!i)throw new Error("ScenarioFactory is missing from context");(null==a?void 0:a.get(b.J.Core).disableInterprocessStore)||(e.interprocessStoreService=new Kb(t,n.newLogger("InterProcessStore"),i)),delete t.createInterprocessStore}))}},new wa,new Iy],OnUserAuthenticated:[new Tb,new Fb,new wb,new WS,new vy,new Ia,new Ab,new Do,new YS,new OS,new Nb,new jS]};class Yb{constructor(e,t){this.host=t,this.logsProviderTimeoutMs=2e4,this.logsProviders=[],this.logger=e.newLogger("LogsCollectorService")}subscribeToCoreSettings(e){if(!e)return void this.logger.error("Failed to subscribe to core settings");e.getObservable(b.J.Diagnostics).subscribe((e=>{const{logsProviderTimeoutMs:t}=e;t&&(this.logsProviderTimeoutMs=t)}))}registerLogsProvider(e){this.logger.log(`Register logsProvider: ${e.logsProviderName}`),this.logsProviders.push(e)}callOnLogsFiles(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){try{this.logger.log(`Fetching files from providers: ${this.logsProviders.reduce(((e,t)=>e+`${null==t?void 0:t.logsProviderName}, `),"")}`);const t=this.logsProviders.findIndex((e=>e.logsProviderName===I.DIAGNOSTICSSERVICE)),n=this.logsProviders.filter(((e,n)=>n!==t)),i=yield this.callOnLogsFilesOfLogsProviders(n,e);let a=!0;return t>-1&&(a=yield this.callOnLogsFilesOfLogsProviders([this.logsProviders[t]],e)),i&&a}catch(e){return this.logger.error("Error calling callback on logs files from all logs providers - error:",e),!1}}))}getSystemInfo(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){let e=new Map;try{const t=this.logsProviders.map((e=>{let t;return Promise.race([e.getSystemInfo(),new Promise((n=>{t=this.host.setTimeout((()=>{this.logger.error(`Timed out fetching system info from logs provider - ${e.logsProviderName}`),n(new Map)}),this.logsProviderTimeoutMs)}))]).then((e=>(void 0!==t&&this.host.clearTimeout(t),e)))})),n=yield Promise.all(t);n&&n.length>0&&(e=n.reduce(((e,t)=>new Map([...Array.from(e.entries()),...Array.from(t.entries())]))))}catch(e){this.logger.error("Fetching system info from logs providers failed with error:",e)}return e}))}timeoutSafeGetLogsFiles(e){let t;return Promise.race([e.getLogsFiles(),new Promise((n=>{t=this.host.setTimeout((()=>{this.logger.error(`Timed out fetching logs files from logs provider - ${e.logsProviderName}`),n([])}),this.logsProviderTimeoutMs)}))]).then((e=>(void 0!==t&&this.host.clearTimeout(t),e)))}callOnLogsFilesOfLogsProviders(e,t){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const n=e.map((e=>this.timeoutSafeGetLogsFiles(e))),i=yield Promise.all(n),a=[];i.forEach((e=>{e&&e.length>0&&a.push(...e)}));const o=a.map((e=>{try{return t(e)}catch(t){return this.logger.error(`Error calling callback on logs file, ${null==e?void 0:e.fileName} - error:`,t),!1}}));return(yield Promise.all(o)).every((e=>e))}))}}var Xb=n(261169);class Zb{constructor(e){var t,n;this._activeWindows=new c.X([]),this._contextSubject=new d.t(1);const i=new W(H()),a=new Q(i,"00000000-0000-0000-0000-000000000000"),o=new ae(a,e.apps);this._logger=a.newLogger("Core"),this._config=e.config;const r=(0,F.J)(),s=new Yb(a,r);r.addEventListener("downloadLogs",(()=>(0,l.__awaiter)(this,void 0,void 0,(function*(){const e=new Xb.N(a,s);yield e.downloadLogsFiles(r)})))),s.registerLogsProvider(i);const u=null===(n=null===(t=null==r?void 0:r.loader)||void 0===t?void 0:t.getLogsProvider)||void 0===n?void 0:n.call(t);u&&s.registerLogsProvider(u);const m=e.config.useReactWebClientCoreTasks?jb:Qb;this._taskManagerService=new ce(a,o,e.config,e.loadConfigs,this.getDefaultCorrelation(),m,i,s,this.waitForRenderingContextReady.bind(this),this.isEntityInView.bind(this),e.criticalDynamicImports),this._templateGenerator=e.generateChildWindowTemplate,this._trackWindowsOperator=_i}get activeWindows(){return this._activeWindows}init(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){try{const e=yield this.initializeCoreServices();this._config.supportsAsyncUserContext||(yield this.awaitUserContextIfAvailable()),this.signalCoreInitSuccess(e)}catch(e){throw this.reportCoreInitError(e,this._coreServices),e}}))}get coreServices(){if(!this._coreServices)throw(0,Z.Tr)("Entry",S.jK.NotPresent,"CoreServices not available");return this._coreServices}getDefaultCorrelation(){const e=mt({source:k.D.ExternalCommand,externalId:this._config.externalCorrelationId});return e.id=`Core-${e.id}`,e}initializeCoreServices(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const e=yield this._taskManagerService.notifyLifeCycleEvent(S.sM.Initialization),{coreTaskErrors:t}=e,n=(0,l.__rest)(e,["coreTaskErrors"]);this._coreServices=n;const{scenarioFactory:i,coreSettings:a}=n;return this.initializeKPIs(a,i),this.checkAndRethrowCriticalErrors(t,n),this.setupNavigationHandling(n),this.observeAuthenticatedUsers(n),n}))}signalCoreInitSuccess(e){const[t,n]=this.getKPIs(e.coreSettings,e.scenarioFactory);null==n||n.mark(A.ck.InitCoreServicesComplete),null==t||t.mark(A.ck.CoreInitStop),this._logger.log("hostComms::setCoreInitialized"),e.hostCommunicationService.loadModule("core").then((e=>{var t;null===(t=null==e?void 0:e.setCoreInitialized)||void 0===t||t.call(e)})),this.markCoreInitCompleteInAltScenario(e.altScenarioService)}handleError(e){if(this.reportCoreInitError(e,this._coreServices),!this.canDisplayCriticalErrorPage(this._coreServices))throw e;this._contextSubject.error(this.transformIntoCoreError(e))}setupNavigationHandling(e){if(!this.canHandleNavigationIntents(e))throw(0,Z.Tr)(S.w5.Core,S.jK.CoreNavigationServicesMissing,"Unable to process navigation intents");e.coreSettings.get(b.J.Core).enableExperienceInIframe&&(this._trackWindowsOperator=Yn),this.observeWindows(e).subscribe(this._activeWindows),((e,t)=>{const{windowProvider:n,loggerFactory:i,clientState:a,dataClientTrackingService:o,windowTrackerService:r}=e,s=i.newLogger("Main-Window-Event-Listeners");(0,ii.R)(n.opener,R.rY.ShouldShowChatNotification).pipe((0,ai.M)(t,a.observe())).subscribe((([i])=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){try{if(!i||!i.payload||!i.payload.convId)throw new Error(`Invalid payload for shouldShowChatNotification with ${JSON.stringify(i)}`);let a=Ie.EntityType.chats;i.payload.entityType?a=i.payload.entityType:s.log(`null entityType received: ${i.payload.entityType}`),s.log(`Received shouldShowNotification request for conv ${i.payload.convId} with entityType ${a}`);const o=yield xn({action:ne.u.view,id:i.payload.convId,linkedEntity:null,type:a},e.client,s),r=!On(o,t,e.clientState);oi(n,r,o),s.log(`Sending windowid: ${o} and shouldShowChatNotification: ${r} for conv ${i.payload.convId}`)}catch(e){s.error(`Failed to query window for entity with error ${e}`),oi(n,!0,void 0)}})))),null==r||r.init(),(0,ii.R)(n.opener,R.rY.GetWindowEntityTypeStats).subscribe((()=>{n.opener.postMessage(R.rY.GetWindowEntityTypeStats,{windowEntityTypeStats:null==r?void 0:r.getTelemetry()})})),(0,ii.R)(n.opener,R.rY.GetApolloCacheStats).subscribe((()=>{n.opener.postMessage(R.rY.GetApolloCacheStats,{apolloCacheStats:null==o?void 0:o.getTelemetry()})})),(0,ii.R)(n.opener,R.rY.GetHeartbeat).subscribe((()=>{let t="";e.appResponsivenessService&&(t=e.appResponsivenessService.getTelemetry(),e.appResponsivenessService.clearTelemetry()),n.opener.postMessage(R.rY.GetHeartbeat,{windowEntityTypeStats:null==r?void 0:r.getTelemetry(),apolloCacheStats:null==o?void 0:o.getTelemetry(),ariTelemetry:t})}))})(e,this.activeWindows),e.deeplinkService.init()}awaitUserContextIfAvailable(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){yield this._contextSubject.pipe((0,p.P)()).toPromise()}))}initializeKPIs(e,t){var n;if(t&&(null===(n=null==e?void 0:e.get(b.J.Core))||void 0===n?void 0:n.enableClientStartTelemetry)){const e=this.createClientStartScenario(t);e.appendEventData({scenarioPhase:i.CoreInit}),e.mark(A.ck.CoreInitStart)}const a=null==t?void 0:t.findScenario(A.RG.ExperienceReady);null==a||a.mark(A.ck.InitCoreServices),null==a||a.startStep(A.ck.GetAuthUser)}createClientStartScenario(e){var t,n,a,o;const s=(0,F.J)(),l=s.performance.timing.navigationStart;let c=performance.now();const d=X(r.IndexPageStart,performance);d&&(c=d.startTime),c=Math.round(c)+l;const u=e.newScenario(A.RG.ClientStart,{startTime:c});u.appendEventData({scenarioPhase:i.ExpLoader});const m=null===(n=null===(t=null==s?void 0:s.loader)||void 0===t?void 0:t.getClientStartTelemetrySteps)||void 0===n?void 0:n.call(t);return m&&m.length>0&&m.forEach((e=>{u.mark(e.Scenario_Step||"",{overrideTimestamp:e.Scenario_Step===r.IndexPageStart&&d?c:e.timeStamp&&Math.round(e.timeStamp)+l,errors:e.error,retryCount:e.retryCount,retryReason:e.retryReason},e.Scenario_Status)})),null===(o=null===(a=null==s?void 0:s.loader)||void 0===a?void 0:a.clearLoaderMarks)||void 0===o||o.call(a),u}getKPIs(e,t){var n,i,a;let o=null;(null===(n=null==e?void 0:e.get(b.J.Core))||void 0===n?void 0:n.enableClientStartTelemetry)&&(o=null!==(i=null==t?void 0:t.findScenario(A.RG.ClientStart))&&void 0!==i?i:null);return[o,null!==(a=null==t?void 0:t.findScenario(A.RG.ExperienceReady))&&void 0!==a?a:null]}reportCoreInitError(e,t={}){var n,i,a,o,r;const s=e instanceof oe.G?(e=>e.prevError||(0,Z.Tr)(S.w5.Core,S.jK.NotInitialized,e.code,void 0,e.message))(e):e,c=s.context===S.w5.Core?s:(0,Z.Tr)(S.w5.Core,s.code||S.jK.NotInitialized,s.context,{innerError:s}),{coreSettings:d,scenarioFactory:u}=t,m=c.subContext||"UnknownCoreInitFailure",p=(0,G.A)((0,Z.B9)(c));this._logger.warn(`Initializing Core failed. Message: ${p}, subContext: ${m}`);const[g,h]=this.getKPIs(d,u);null==g||g.fail({errorCode:c.code||S.jK.CoreInitFailure,reason:c.message?(0,G.A)(c.message):p}),null==h||h.fail({contentType:(0,G.A)(`${c.context}-${c.subContext}`),errorCode:(0,Z.qZ)(c),errors:p,reason:"init_core_service_failure"}),null===(i=null===(n=null==t?void 0:t.altScenarioService)||void 0===n?void 0:n.altScenario)||void 0===i||i.fail({reason:S.jK.CoreInitFailure}),null===(a=null==t?void 0:t.windowProvider)||void 0===a||a.opener.postMessage(_.W.CoreInitializationFailed,{errorDescription:m}),(null===(r=null===(o=null==t?void 0:t.coreSettings)||void 0===o?void 0:o.get(b.J.Core))||void 0===r?void 0:r.enableTaskbarIconOnCoreInitFailure)&&function(e,t){var n;(0,l.__awaiter)(this,void 0,void 0,(function*(){try{const t=yield null==e?void 0:e.loadModule("taskbar");null===(n=null==t?void 0:t.showBadge)||void 0===n||n.call(t,{icon:{glyphBadge:{glyph:E.attention}}})}catch(e){t.error(`Failed to send host comm request for showing task bar caution indicator, on Core init failures. Error: ${e}`)}}))}(null==t?void 0:t.hostCommunicationService,this._logger)}markCoreInitCompleteInAltScenario(e){var t,n;null===(t=null===performance||void 0===performance?void 0:performance.mark)||void 0===t||t.call(performance,T),null===(n=null==e?void 0:e.altScenario)||void 0===n||n.mark(A.ck.PostCoreInitializationTasks)}waitForRenderingContextReady(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){return this._contextSubject.pipe((0,g.h)((t=>{var n;return!e||!!(null===(n=t.authenticationUser)||void 0===n?void 0:n.isAuthenticated)})),(0,p.P)()).toPromise()}))}observeAuthenticatedUsers(e){this.observeUser(e,this._logger).pipe((0,h.b)((t=>t?(0,u.D)(this.onUserAuthenticated(e,t)):(0,m.of)(this.onUserUnAuthenticated(e)))),(0,v.K)((t=>{var n;this._logger.error("Core Initialization: Error in user renderingContext generation: ",t);const i=(0,Z.Tr)("Core",S.jK.NotInitialized,null===(n=t.prevError)||void 0===n?void 0:n.context,{innerError:t.prevError});throw e.errorState.error=i,e.coreSettings.get(b.J.Core).enableCoreErrorsV2?t:i})),(0,f.b)((()=>{const[t,n]=this.getKPIs(e.coreSettings,e.scenarioFactory);null==t||t.mark(A.ck.CoreRenderingContextReady)}))).subscribe(this._contextSubject)}canDisplayCriticalErrorPage(e){return!!((null==e?void 0:e.rebootService)&&e.i18n&&e.scenarioFactory&&e.coreSettings&&e.hostCommunicationService&&e.coreSettings.get(b.J.Core).enableCoreErrorsV2)}canHandleNavigationIntents(e){return!!((null==e?void 0:e.client)&&e.deeplinkService&&e.entityCommanding)}checkAndRethrowCriticalErrors(e,t){let n;e&&(null==e?void 0:e.length)>0&&(n=(null==t?void 0:t.coreSettings.get(b.J.Core).strictErrorMode)?e[0]:e.find((e=>e instanceof hi.G||e instanceof va.l))),n&&this.handleError(n)}transformIntoCoreError(e){return e instanceof hi.G||e instanceof va.l?e:new hi.G("UNKNOWN",e)}observeWindows(e){return(0,te.G)(e.client.watchQuery({query:de})).pipe((0,g.h)((({errors:e,loading:t})=>void 0===e&&!t)),(0,y.U)((({data:{activeWindows:e}})=>e.map((t=>Object.assign(Object.assign({},t),{screenState:{numOpenWindows:e.length}}))))),this._trackWindowsOperator(this._contextSubject,e,this._templateGenerator))}observeUser(e,t){const n=this.observeUsersEvents(e.client);return(0,te.G)(n).pipe((0,y.U)((e=>this.toUserContext(e,t))),(0,v.K)((e=>{throw this._logger.error("Core Initialization: Error in authenticationUsers subscription: ",e),this.transformIntoCoreError(e)})))}observeUsersEvents(e){const t={filter:{isAuthenticated:!0}},n=e.watchQuery({query:me,variables:t});return n.subscribeToMore({document:ue,variables:t,updateQuery:(e,t)=>t.subscriptionData.data.authenticationUsersEvent}),n}onUserAuthenticated(e,t){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{scenarioFactory:n,coreSettings:i}=e,a=n.findScenario(A.RG.GetAuthUser),[o,r]=this.getKPIs(i,n);null==o||o.mark(A.ck.CoreUserContextStart);try{const n=yield this._taskManagerService.notifyLifeCycleEvent(S.sM.OnUserAuthenticated,Object.assign(Object.assign({},e),{authenticationUser:t})),{coreTaskErrors:i}=n,s=(0,l.__rest)(n,["coreTaskErrors"]);return this.checkAndRethrowCriticalErrors(i,e),a&&a.stop(),null==r||r.mark(A.ck.GetAuthUser),null==o||o.mark(A.ck.CoreUserContextStop),En(s,{})}catch(e){throw a&&a.fail(),null==r||r.mark(A.ck.GetAuthUser,void 0,"failure"),this.transformIntoCoreError(e)}}))}onUserUnAuthenticated(e){return En(e,{user:void 0,authenticationUser:void 0})}toUserContext({data:e,loading:t,errors:n},i){if(n)throw i.error("Error found unable to generate user context"),(0,ee.E6)({graphQLErrors:n.concat(),extraInfo:void 0,networkError:null,name:"AuthenticationUsers subscription error",message:"Error in authentication users subscription"});if(!t){if(!e)return void i.error("Undefined user data returned!");const t=e.authenticationUsers,n=t&&t.length>0&&t[0];if(n){const{isAuthenticated:e,profile:{tenantId:t,objectId:i,puid:a},role:o,type:r,loginUserName:s}=n;return{isAuthenticated:e,profile:{tenantId:t,objectId:i,puid:a},role:o,type:r,loginUserName:s}}}}isEntityInView(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){if(!this._coreServices)return Promise.resolve(!1);const{client:t,clientState:n}=this._coreServices;return function(e,t,n,i,a){return(0,l.__awaiter)(this,void 0,void 0,(function*(){return On(yield xn(e,t,a),i,n)}))}(e,t,n,this._activeWindows,this._logger)}))}}var e_=n(632735),t_=n(110391),n_=n(902024);const i_=e=>{if(a_(e))return o_(e)?{subNavEntity:r_(e),headerEntity:s_(e),startEntity:l_(e),mainEntity:c_(e),endEntity:d_(e)}:null},a_=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[be.lO.focus,be.lO.standard].includes(e),o=[ne.p.attendeeview].includes(i),r=n&&[ne.u.default,ne.u.view].includes(n);return!!(a&&o&&r)},o_=()=>!0,r_=()=>null,s_=()=>null,l_=()=>null,c_=({entity:e})=>e,d_=()=>null,u_=()=>({[be.tF.mainEntity]:{[t_.S.Main]:{isBackgroundTransparent:!0,isThemePinnedToDarkOrHighContrast:!0}}}),m_={id:"com.microsoft.teams.attendee-view",name:"AteendeeViewApp",supportedEntities:[ne.p.attendeeview],supportedRenderModes:[t_.S.Main],windowFeatures:{height:360,width:640,minHeight:360,minWidth:640,offset:20}},p_=()=>Promise.all([n.e(89962),n.e(2845),n.e(41574),n.e(2404),n.e(93438),n.e(33587),n.e(211),n.e(5514),n.e(99383),n.e(26113),n.e(17530)]).then(n.bind(n,343630)),g_=()=>({additionalFeatures:{alwaysOnTop:"true",excludeWindowFromScreenSharing:"true"},top:675,left:1625,width:640,height:360,minWidth:640,minHeight:360});function h_(){const e=()=>null;return{getAppViewEntities:i_,getAppViewEntitiesProps:u_,getAppWindowFeatures:g_,manifest:m_,render:({appRenderMode:t,scenarioFactory:n})=>(0,l.__awaiter)(this,void 0,void 0,(function*(){if(t===t_.S.Main){const{AttendeeView:e}=yield(0,ha.mT)(p_,"attendee-view-app",n);return e_.createElement(n_.f,{namespace:"calling",loaderRenderer:null},e_.createElement(e,null))}return e_.createElement(e,null)}))}}const v_={id:"com.microsoft.teams.biometric-enrollment",name:"BiometricEnrollmentApp",supportedRenderModes:[t_.S.Main],supportedEntities:[ne.p.voiceenrollment,ne.p.faceenrollment],windowFeatures:{minWidth:601,width:601,minHeight:621,height:621}},f_=e=>{if(y_(e))return S_(e)?{subNavEntity:k_(e),headerEntity:b_(e),startEntity:__(e),mainEntity:C_(e),endEntity:w_(e)}:null},y_=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[be.lO.focus,be.lO.standard].includes(e),o=[ne.p.faceenrollment,ne.p.voiceenrollment].includes(i),r=n&&[ne.u.default,ne.u.view].includes(n);return!!(a&&o&&r)},S_=()=>!0,k_=()=>null,b_=()=>null,__=()=>null,C_=({entity:e})=>e,w_=()=>null,T_=()=>Promise.all([n.e(89962),n.e(2845),n.e(41574),n.e(90224),n.e(2404),n.e(80414)]).then(n.bind(n,629404)),E_=()=>v_.windowFeatures||{};function I_(){const e=()=>null;return{getAppViewEntities:f_,getAppWindowFeatures:E_,manifest:v_,render:({appRenderMode:t,scenarioFactory:n})=>(0,l.__awaiter)(this,void 0,void 0,(function*(){if(t===t_.S.Main){const e="biometric-enrollment-entry",{BiometricEnrollmentEntry:t}=yield(0,ha.mT)(T_,e,n);return e_.createElement(t,null)}return e_.createElement(e,null)}))}}var N_=n(665207);const A_=e=>{if(M_(e))return F_(e)?{subNavEntity:R_(e),headerEntity:P_(e),startEntity:D_(e),mainEntity:j_(e),endEntity:x_(e)}:null},M_=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[be.lO.focus,be.lO.standard].includes(e),o=[ne.p.broadcasts].includes(i),r=n&&[ne.u.create,ne.u.default,ne.u.list,ne.u.view,ne.u.info].includes(n);return!!(a&&o&&r)},F_=()=>!0,R_=()=>null,P_=({entity:e})=>e,D_=()=>null,j_=({entity:e})=>e,x_=({contextEntity:e})=>{const{action:t,type:n}=e||{};return e&&n===ne.p.broadcasts&&t===ne.u.info?e:null},O_={id:"com.microsoft.teams.broadcast",name:"Broadcast",supportedEntities:[ne.p.broadcasts,ne.p.broadcastfeedback],supportedRenderModes:[t_.S.HorizontalBar,t_.S.Main,t_.S.Rail],windowFeatures:{minWidth:800,width:800,minHeight:670,height:600}},L_=()=>Promise.all([n.e(89962),n.e(61874),n.e(2845),n.e(41574),n.e(92923),n.e(29138),n.e(38811),n.e(29084),n.e(87851),n.e(84274),n.e(17870),n.e(61385),n.e(68557)]).then(n.bind(n,16449)),U_=()=>O_.windowFeatures||{};function B_(){const e=()=>null;return{getAppViewEntities:A_,getAppWindowFeatures:U_,manifest:O_,render:({appRenderMode:t,scenarioFactory:n})=>(0,l.__awaiter)(this,void 0,void 0,(function*(){switch(t){case t_.S.HorizontalBar:case t_.S.Main:case t_.S.Rail:const i="broadcast-app",{BroadcastViewsRenderer:a}=yield(0,ha.mT)(L_,i,n);return e_.createElement(n_.f,{namespace:"broadcast",loaderRenderer:null},e_.createElement(N_.yx,null,e_.createElement(a,{appRenderMode:t})));default:return e_.createElement(e,null)}}))}}var W_=n(789284),H_=n(381031),$_=n(283634);class V_{constructor(){this.id=S.Yg.CreateAsyncMediaAuth,this.lifeCycleSubscriptions=[S.sM.OnUserAuthenticated]}execute(e,t){return(0,l.__awaiter)(this,void 0,void 0,(function*(){t.mediaAuthService=new $_.b(Us.l,e.gtmRegistry,e.routingServices.state,e.discover,e.loggerFactory,e.coreSettings,e.windowProvider,e.localStorage,e.authenticationService)}))}}const z_={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"sendMessage"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"message"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SendMessageInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"action"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SendMessageAction"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"correlationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sendMessage"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}},{kind:"Argument",name:{kind:"Name",value:"message"},value:{kind:"Variable",name:{kind:"Name",value:"message"}}},{kind:"Argument",name:{kind:"Name",value:"action"},value:{kind:"Variable",name:{kind:"Name",value:"action"}}},{kind:"Argument",name:{kind:"Name",value:"correlationId"},value:{kind:"Variable",name:{kind:"Name",value:"correlationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]};var G_=n(367941),q_=n(143028);const J_=e=>{const{entityCommand:t,entityCommand:{entity:{type:n,action:i},dataOptions:a},requestContext:o}=e;if(!a||!K_(n,i))return Promise.resolve(t);if(!Q_(a)||!a.convId||!a.message)return Promise.reject(dr.ChatActionTypeToNotificationActionFailed);return o.client.mutate({mutation:z_,variables:{convId:a.convId,message:{clientMessageId:(0,G_.K)(),messageType:q_.Cs.HTML,content:a.message},action:Ie.SendMessageAction.Create}}).then((()=>{})).catch((()=>Promise.reject(dr.ChatToastActionMutationFailed)))},K_=(e,t)=>e===ne.p.chats&&t===ne.u.mutate,Q_=e=>e.actionType===$t.quickReply,Y_=()=>Promise.all([n.e(89962),n.e(85256),n.e(63986),n.e(2845),n.e(41574),n.e(92923),n.e(29138),n.e(38811),n.e(68865),n.e(21767),n.e(97725),n.e(29084),n.e(21439),n.e(55837),n.e(98314),n.e(22391),n.e(91607),n.e(78001),n.e(77999),n.e(23741),n.e(17870),n.e(61385),n.e(90864),n.e(58254),n.e(81391),n.e(84593),n.e(30644),n.e(53621),n.e(93438),n.e(8163),n.e(74313),n.e(88612),n.e(51217),n.e(71217),n.e(51427),n.e(14797),n.e(33913),n.e(75516),n.e(38574),n.e(15470),n.e(8093),n.e(26589),n.e(73190),n.e(36378),n.e(14776),n.e(14938),n.e(30970),n.e(30828),n.e(31611),n.e(81647)]).then(n.bind(n,468722)),X_=()=>Promise.all([n.e(89962),n.e(85256),n.e(63986),n.e(2845),n.e(41574),n.e(92923),n.e(29138),n.e(38811),n.e(68865),n.e(21767),n.e(97725),n.e(29084),n.e(21439),n.e(55837),n.e(98314),n.e(22391),n.e(91607),n.e(78001),n.e(77999),n.e(23741),n.e(17870),n.e(61385),n.e(90864),n.e(58254),n.e(81391),n.e(84593),n.e(30644),n.e(53621),n.e(93438),n.e(8163),n.e(74313),n.e(88612),n.e(51217),n.e(71217),n.e(51427),n.e(14797),n.e(33913),n.e(75516),n.e(38574),n.e(15470),n.e(8093),n.e(26589),n.e(73190),n.e(36378),n.e(14776),n.e(14938),n.e(30970),n.e(30828),n.e(31611),n.e(81647)]).then(n.bind(n,208163));var Z_=n(869766);const eC=({action:e,appRenderMode:t,coreSettings:n})=>{const i=new Z_.H,{isHeaderDisabled:a=!1}=n.get(b.J.Core),{chatAppPhaseTimeouts:o,enableComposeCriticalPhaseLoad:r=!1,enableComposeCriticalPhaseLoadForPopout:s=!1,enableComposeCriticalPhaseLoadSecondaryViewport:l=!1,enableComposeCriticalPhaseLoadSecondaryViewportGate:c=!1,enableComposeOrchestrationOnLoad:d=!1}=n.get(b.J.Messaging),u=[],m=[];switch(t){case t_.S.HorizontalBar:tC({action:e,criticalSignals:u,featureFlags:{isHeaderDisabled:a},postCriticalSignals:m});break;case t_.S.Main:nC({action:e,criticalSignals:u,featureFlags:{enableComposeCriticalPhaseLoad:r,enableComposeCriticalPhaseLoadForPopout:s,enableComposeCriticalPhaseLoadSecondaryViewport:l,enableComposeCriticalPhaseLoadSecondaryViewportGate:c,enableComposeOrchestrationOnLoad:d},postCriticalSignals:m});break;case t_.S.Rail:iC({action:e,criticalSignals:u,featureFlags:{enableComposeCriticalPhaseLoad:r,enableComposeCriticalPhaseLoadSecondaryViewport:l,enableComposeCriticalPhaseLoadSecondaryViewportGate:c,enableComposeOrchestrationOnLoad:d},postCriticalSignals:m})}return i.registerAppPhase({phase:W_.nh.CRITICAL,signals:u,timeout:(null==o?void 0:o.critical)||6e4}),i.registerAppPhase({phase:W_.nh.POST_CRITICAL,signals:m,timeout:(null==o?void 0:o.postCritical)||1e4}),i.appPhases},tC=({featureFlags:{isHeaderDisabled:e},postCriticalSignals:t})=>{!e&&t.push(W_.GZ.CHAT_HEADER_BUTTONS_RENDERED)},nC=({action:e,criticalSignals:t,featureFlags:{enableComposeCriticalPhaseLoad:n,enableComposeCriticalPhaseLoadForPopout:i,enableComposeCriticalPhaseLoadSecondaryViewport:a,enableComposeCriticalPhaseLoadSecondaryViewportGate:o,enableComposeOrchestrationOnLoad:r},postCriticalSignals:s})=>{if(e===ne.u.join)return;t.push(W_.GZ.MESSAGES_RENDERED);const l=n||i&&o&&a;l&&t.push(W_.GZ.COMPOSE_LOADED),s.push(W_.GZ.MESSAGE_REACTIONS_RENDERED,W_.GZ.PRESENCES_RENDERED,W_.GZ.VIRTUAL_LIST_RENDER_BUFFER_FILLED),!l&&s.push(W_.GZ.COMPOSE_LOADED),r&&s.push(W_.GZ.COMPOSE_LAYOUT_LOADED)},iC=({action:e,criticalSignals:t,featureFlags:{enableComposeCriticalPhaseLoad:n,enableComposeCriticalPhaseLoadSecondaryViewport:i,enableComposeCriticalPhaseLoadSecondaryViewportGate:a,enableComposeOrchestrationOnLoad:o},postCriticalSignals:r})=>{if(e===ne.u.list)t.push(W_.GZ.CHAT_LIST_ITEMS_RENDERED),r.push(W_.GZ.PRESENCES_RENDERED);else if(e===ne.u.view){t.push(W_.GZ.MESSAGES_RENDERED);const e=a&&i,s=n||e;s&&t.push(W_.GZ.COMPOSE_LOADED),r.push(W_.GZ.MESSAGE_REACTIONS_RENDERED,W_.GZ.PRESENCES_RENDERED,W_.GZ.VIRTUAL_LIST_RENDER_BUFFER_FILLED),!s&&r.push(W_.GZ.COMPOSE_LOADED),o&&r.push(W_.GZ.COMPOSE_LAYOUT_LOADED)}},aC={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"ToastEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toastEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"attributionText"}},{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"interopConversationStatus"}},{kind:"Field",name:{kind:"Name",value:"members"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"givenName"}},{kind:"Field",name:{kind:"Name",value:"displayName"}}]}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"reaction"}},{kind:"Field",name:{kind:"Name",value:"senderDisplayName"}},{kind:"Field",name:{kind:"Name",value:"senderGivenName"}},{kind:"Field",name:{kind:"Name",value:"senderId"}},{kind:"Field",name:{kind:"Name",value:"text"}},{kind:"Field",name:{kind:"Name",value:"timestamp"}},{kind:"Field",name:{kind:"Name",value:"topic"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]};var oC=n(409225);const rC={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"msaUserProfilePicture"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"displayName"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"msaUserProfilePicture"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}},{kind:"Argument",name:{kind:"Name",value:"displayName"},value:{kind:"Variable",name:{kind:"Name",value:"displayName"}}},{kind:"Argument",name:{kind:"Name",value:"profilePictureSize"},value:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}}}]}]}}]},sC={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"msaGroupProfilePicture"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"msaGroupInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MsaGroupProfilePictureInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"msaGroupProfilePicture"},arguments:[{kind:"Argument",name:{kind:"Name",value:"msaGroupInfo"},value:{kind:"Variable",name:{kind:"Name",value:"msaGroupInfo"}}},{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}}}]}]}}]},lC={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"toastImageAsDataUri"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"url"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toastImageAsDataUri"},arguments:[{kind:"Argument",name:{kind:"Name",value:"url"},value:{kind:"Variable",name:{kind:"Name",value:"url"}}}]}]}}]};var cC,dC,uC=n(593909),mC=n(674436);!function(e){e.GroupMessage="GroupMessage",e.Message="Message",e.Mention="Mention",e.Reaction="Reaction"}(cC||(cC={})),function(e){e.Small="HR64x64"}(dC||(dC={}));var pC=n(338870);function gC(e,t,n){return(0,l.__awaiter)(this,void 0,void 0,(function*(){try{const i=n.type===cC.GroupMessage?yield function(e,t){var n;return(0,l.__awaiter)(this,void 0,void 0,(function*(){if(!(null===(n=t.members)||void 0===n?void 0:n.length))return null;const{data:i}=yield e.query({query:sC,variables:{msaGroupInfo:{pictureReadyUsers:t.members.map((({id:e,displayName:t})=>({userId:e,displayName:t}))).slice(0,vo.gT.FOUR),conversationId:t.conversationId}}});return i.msaGroupProfilePicture}))}(e,n):yield function(e,t){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const{data:n}=yield e.query({query:rC,variables:{userId:t.senderId,displayName:t.senderDisplayName,profilePictureSize:dC.Small}});return n.msaUserProfilePicture}))}(e,n);if(!i)return void t.error(dr.ImageUrlGenerationFailed);const a=yield e.query({query:lC,fetchPolicy:"no-cache",variables:{url:i}});return(null==a?void 0:a.data.toastImageAsDataUri)||void 0}catch(e){return void t.error(dr.ImageFetchFailed)}}))}function hC(e,t){return t.interopConversationStatus===q_.uI.AcceptPending?e.stringTranslate("people","tfl_invite_free_chat_notification_title",{displayName:t.senderDisplayName||e.stringTranslate("peoplePicker","unknown_user")}):t.text?vC(t.text):void 0}function vC(e){return((new DOMParser).parseFromString(e,"text/html").body.textContent||"").trim()}function fC(e,t){switch(t.type){case cC.Message:return function(e,t){return Object.assign(Object.assign(Object.assign({},CC(t)),_C(e,t.interopConversationStatus)),{text:hC(e,t),title:yC(e,t)})}(e,t);case cC.GroupMessage:return function(e,t){return Object.assign(Object.assign(Object.assign({},CC(t)),_C(e,t.interopConversationStatus)),{text:kC(e,t),title:t.topic||TC(e,t.members)})}(e,t);case cC.Mention:case cC.Reaction:return function(e,t){return Object.assign(Object.assign({},CC(t)),{text:t.topic||wC(e,t.senderGivenName||t.senderDisplayName,t.members),title:SC(e,t)})}(e,t);default:return}}function yC(e,t){const n=bC(e,t);return pC.e.isTFLSmsMri(t.senderId)?e.stringTranslate("toastNotifications","toast_messaging_sms_user_given_name",{sender:n}):n}function SC(e,t){switch(t.type){case cC.Mention:return`@ ${e.stringTranslate("toastNotifications","toast_messaging_mention",{sender:t.senderGivenName||t.senderDisplayName})}`;case cC.Reaction:const n=uC.uU[t.reaction];return e.stringTranslate("toastNotifications","toast_messaging_reaction",{sender:t.senderGivenName||t.senderDisplayName,emoji:(0,mC.TG)(n)})}}function kC(e,t){if(!t.text)return;const n=vC(t.text),i=t.senderGivenName||bC(e,t);return pC.e.isTFLSmsMri(t.senderId)?e.stringTranslate("toastNotifications","toast_messaging_sms_group_text_with_sender",{sender:i,text:n}):e.stringTranslate("toastNotifications","toast_messaging_group_text_with_sender",{sender:i,text:n})}function bC(e,t){return!t.senderDisplayName||pC.e.isDisplayNameUnknownUser(t.senderDisplayName)?e.stringTranslate("toastNotifications","toast_unknown_user"):t.senderDisplayName}function _C(e,t){return t===q_.uI.AcceptPending||t===q_.uI.Quarantined?{quickReply:!1}:{quickReply:!0,quickReplyPlaceholder:e.stringTranslate("toastNotifications","toast_messaging_quickreply_placeholder_text"),quickReplyButton:e.stringTranslate("toastNotifications","toast_messaging_quickreply_button_text")}}function CC(e){var t;return{attributionText:null!==(t=e.attributionText)&&void 0!==t?t:void 0,conversationId:e.conversationId,messageId:e.messageId,quickReply:!1,time:new Date(+e.timestamp)}}function wC(e,t,n){const i=EC(e,n);return i?e.stringTranslate("toastNotifications",i.count?"toast_messaging_activity_text_with_count":"toast_messaging_activity_text",{participants:i.displayName,count:i.count}):t?e.stringTranslate("toastNotifications","toast_messaging_activity_text",{participants:t}):e.stringTranslate("toastNotifications","toast_messaging_default_group_topic")}function TC(e,t){const n=EC(e,t);return n?e.stringTranslate("toastNotifications",n.count?"toast_messaging_group_topic_with_count":"toast_messaging_group_topic",{participants:n.displayName,count:n.count}):e.stringTranslate("toastNotifications","toast_messaging_default_group_topic")}function EC(e,t){if(!t||!Array.isArray(t)||0===t.length)return;const n=e.stringTranslate("toastNotifications","toast_unknown_user"),i=t.map((e=>e.givenName||n));return(0,oC.N)(i,t.length)}function IC(e,t,n,i,a,o,r){const{enableCommandToHostCommService:s}=e.get(b.J.Core);return{id:"toast-event-subscription",runOncePerId:!0,job:()=>(0,l.__awaiter)(this,void 0,void 0,(function*(){const e=o.newLogger("ToastEventSubscription");s?t.subscribe({query:aC,fetchPolicy:"no-cache"}).forEach(function(e,t,n,i,a,o){return r=>(0,l.__awaiter)(this,void 0,void 0,(function*(){var s;const l=(0,Be.v4)(),c=o.newScenario(A.RG.ToastView);if(c.clientId=l,c.appendEventData({mainEntityType:ne.p.chats}),r.errors){const e=r.errors.map((e=>e.message)).join();return a.error(`${dr.SubscriptionFailed} ${(0,P.u4)(e)}`),void c.fail({errorCode:dr.SubscriptionFailed})}if(!(null===(s=r.data)||void 0===s?void 0:s.toastEvent))return a.error(dr.EmptyEvent),void c.fail({errorCode:dr.EmptyEvent});const{toastEvent:d}=r.data,u=fC(n,d);if(!u)return a.log(`${dr.UnhandledType} ${d.type}`),void c.stop({reason:dr.UnhandledType});const m=yield i({id:u.conversationId,type:ne.p.chats,action:ne.u.view,linkedEntity:null});if(c.mark(A.ck.ConversationFocusChecked),m)return a.log(dr.ToastSuppressedForWindowInFocus),void c.stop({reason:dr.ToastSuppressedForWindowInFocus});const p=yield gC(e,a,d);return c.mark(A.ck.AvatarFetched),p&&(u.mainImage={alt:"",src:p}),t.toasts.showMessage(l,u)}))}(t,n,i,a,e,r)):e.log(dr.NotEnabled)}))}}const NC={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"TaskbarBadgeUpdatedEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"taskbarBadgeUpdatedEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"badgeCount"}}]}}]}}]};var AC=n(986659),MC=n(305653);function FC(e,t,n,i,a){return{id:"taskbar-badge-event-subscription",runOncePerId:!0,job:()=>(0,l.__awaiter)(this,void 0,void 0,(function*(){const o=t.newLogger("TaskbarBadgeEventSubscription");if(i.config.clientType!==si.Bh.Maglev)return void o.log(AC.vc.NotEnabled);const r=new MC.a(t,a,n);e.subscribe({query:NC,fetchPolicy:"no-cache"}).forEach(function(e,t){return n=>(0,l.__awaiter)(this,void 0,void 0,(function*(){var i;if(n.errors){const t=n.errors.map((e=>e.message)).join();return void e.error(`${AC.vc.SubscriptionFailed} ${(0,P.u4)(t)}`)}if(!(null===(i=n.data)||void 0===i?void 0:i.taskbarBadgeUpdatedEvent))return void e.log(AC.vc.EmptyEvent);const{taskbarBadgeUpdatedEvent:a}=n.data,{badgeCount:o}=a;return e.log(`${AC.Bd.UpdatedEvent} ${o}`),t.showBadgeCount(o)}))}(o,r))}))}}const RC=({context:{client:e,coreSettings:t,entityCommanding:n,hostCommunicationService:i,i18n:a,isEntityInView:o,loggerFactory:r,platformService:s,scenarioFactory:l}})=>{const c=e;return[IC(t,c,n,a,o,r,l),FC(c,r,i,s,t)]},PC=({context:{scenarioFactory:e}})=>[{id:"import-chat-bundle",runOncePerId:!0,job:()=>(({scenarioFactory:e})=>{(0,ha.mT)(Y_,"chat-app",e)})({scenarioFactory:e})}];var DC=n(720782),jC=n(261062);const xC=e=>{if(OC(e))return LC(e)?{subNavEntity:UC(e),headerEntity:BC(e),startEntity:WC(e),mainEntity:HC(e),endEntity:$C(e)}:null},OC=({contextEntity:e,entity:t,layoutMode:n})=>{const{action:i=null,type:a}=Object.assign({},t),{type:o,action:r}=e||{},s=[be.lO.standard,be.lO.focus].includes(n),l=i&&[ne.u.create,ne.u.default,ne.u.info,ne.u.join,ne.u.list,ne.u.view].includes(i),c=r&&o,d=[ne.p.chats].includes(a),u=n===be.lO.focus&&i===ne.u.list;return!(!s||!d||!l&&!c||u)},LC=({entity:e,contextEntity:t})=>{const{type:n}=t||{},{action:i=null,type:a}=Object.assign({},e);return!(a!==ne.p.chats||!(i||n&&![ne.p.calls,ne.p.callsgalleryandcontent,ne.p.callsgallery,ne.p.callscontent].includes(n)))},UC=({entity:e,layoutMode:t})=>{if(t===be.lO.focus)return null;const{type:n,action:i}=e;return{action:ne.u.list,entityState:{flushableByLinkedEntity:!0},id:null,linkedEntity:null,options:n===ne.p.chats&&i===ne.u.default?JSON.stringify({focusOnLoad:DC.D.LeftRailSelectedItem}):null,type:n,windowOptions:null}},BC=({entity:e})=>{let t=ne.u.view;const{action:n=null}=Object.assign({},e);return n&&[ne.u.create,ne.u.default,ne.u.join].includes(n)&&(t=n),Object.assign(Object.assign({},e),{action:t})},WC=()=>null,HC=({entity:e,contextEntity:t})=>{let n=ne.u.view;const{action:i=null}=Object.assign({},e);return i&&[ne.u.create,ne.u.default,ne.u.join].includes(i)&&(n=i),t||Object.assign(Object.assign({},e),{action:n})},$C=({entity:e,contextEntity:t,coreSettings:n})=>{if(!(null==n?void 0:n.get(b.J.Messaging).enableChatInfoPane))return null;let i,a;if(({id:i,type:a}=t||e),!(0,jC.wm)(i||"")&&a===ne.p.chats){return{action:ne.u.info,id:i||"",type:a}}return null},VC=({areEmptySlotsTransparent:e})=>({[be.tF.subNavEntity]:{[t_.S.Rail]:{areSlotShadowsDisabled:e,isBackgroundTransparent:e,isColorSchemeDefaultBackground3:!e}},[be.tF.headerEntity]:{[t_.S.HorizontalBar]:{isBackgroundTransparent:e}}}),zC="/l/invite",GC="/l/claim",qC={[GC]:be.DL.Claim,[zC]:be.DL.Invite},JC=new Set([GC,zC]),KC=(e,t)=>Promise.resolve({entityCommand:{entity:{type:ne.p.chats,action:ne.u.join},command:{visibilityState:be.fe.show,stateTransition:be.su.flush,correlation:{id:(0,Be.v4)(),startTimestamp:Date.now(),source:k.D.ExternalCommand}},entityOptions:{inviteLinkType:t,inviteLinkUrl:e.toString()}},metadata:{allowAnonymous:!1}}),QC={id:"com.microsoft.teams.chat",name:"Chat",supportedEntities:[ne.p.alttext,ne.p.chats,ne.p.codesnippet,ne.p.deletechat,ne.p.dlp,ne.p.fluid,ne.p.giphyconsent,ne.p.hyperlink,ne.p.leavechat,ne.p.messagedraft,ne.p.pinnedchatsmaxreached,ne.p.pinnedconversationitems,ne.p.removechatuser,ne.p.reportConcern,ne.p.sharechatlink,ne.p.streamcamera,ne.p.translationfeedback,ne.p.twowaysmsfriendlyname,ne.p.updategroupchatavatar],supportedRenderModes:[t_.S.HorizontalBar,t_.S.Main,t_.S.Modal,t_.S.Rail],defaultCommand:{action:ne.u.default,type:ne.p.chats},windowFeatures:{minWidth:602,width:602,minHeight:500,height:500,offset:20,widthToScreenWidthRatio:.3,heightToWidthRatio:1.125},shouldUseHistoryOnDefaultCommand:!0},YC=e=>{const t=e.command.correlation.source,{entity:n,command:i}=e;return n.type===ne.p.chats&&i.stateTransition===be.su.new&&i.visibilityState===be.fe.show?A.RG.ChatPopOut:n.type!==ne.p.chats||n.action!==ne.u.view&&n.action!==ne.u.default||i.visibilityState!==be.fe.show||t===k.D.StandAlone?A.RG.EntityCommand:n.id===gc.FX?A.RG.NewChat:t===k.D.ChatListMeetingItem||t===k.D.Calendar?A.RG.MeetingChatSwitch:A.RG.ChatSwitch},XC=({coreServices:e,host:t,prevEntityType:n,screenState:i,isResize:a})=>{if(a){if(!QC.windowFeatures)return null;const e=QC.windowFeatures,{offset:t}=e;return(0,l.__rest)(e,["offset"])}if(n===ne.p.chats)return null;if(n){if(!QC.windowFeatures)return null;const e=QC.windowFeatures,{offset:t}=e;return(0,l.__rest)(e,["offset"])}const{height:o,minHeight:r,minWidth:s,offset:c,width:d}=QC.windowFeatures||{},u={left:(null==t?void 0:t.screenX)||0,top:(null==t?void 0:t.screenY)||0},m=((null==i?void 0:i.numOpenWindows)||1)*(c||1);return Object.assign({additionalFeatures:{minHeight:`${r}`,minWidth:`${s}`},height:o,left:(null==u?void 0:u.left)+m,minHeight:r,minWidth:s,top:(null==u?void 0:u.top)+m,width:d},(null==e?void 0:e.coreSettings.get(b.J.Core).enableRatioToScreenBasedSizing)&&function(e,t){const{widthToScreenWidthRatio:n,heightToWidthRatio:i}=t||{};if(!e||!i||!n)return{};const a=n*e.screen.availWidth;return{height:a*i,width:a}}(t,QC.windowFeatures))};function ZC(){return{getAppPhases:eC,getAppViewEntities:xC,getAppViewEntitiesProps:VC,getAppWindowFeatures:XC,getCommandScenarioName:YC,getSlotRenderUpdateSignal:({entity:e,getEntityOptions:t,getPreviousEntityOptions:n})=>{const{type:i,action:a}=e;let o=!1;if(i===ne.p.chats&&a===ne.u.view){const e=t(ne.p.chats,ne.u.view),i=n(ne.p.chats,ne.u.view);o=(null==e?void 0:e.messageId)!==(null==i?void 0:i.messageId)}return{[be.tF.mainEntity]:{[t_.S.Main]:o?{signal:W_.Fm.MESSAGE_FOCUSED}:void 0}}},manifest:QC,onBeforeCommandHandled:J_,onBeforeDeeplinkParsed:{filter:JC,execute:({deeplinkUrl:e,context:t})=>{const n=t.loggerFactory.newLogger("ChatApp");return((e,t,n)=>{const{pathname:i}=n,{enableInviteLinks:a}=e.get(b.J.InviteLinks);for(const e of Array.from(JC))if(i.startsWith(e)){if(!a){const e="Invite link redemption is disabled for this experience";return t.error(e),Promise.reject(e)}const i=qC[e];if(void 0===i){const e="No Invite link type found for the specified prefixType";return t.error(e),Promise.reject(e)}return KC(n,i)}const o="No DeeplinkPrefixType found for the specified deeplinkUrl";return t.error(o),Promise.reject(o)})(t.coreSettings,n,e)}},onPreInit:PC,onPreWarm:RC,onRegister:e=>{e.registerTask(new V_)},render:({appRenderMode:e,onRenderEvent:t,scenarioFactory:n})=>(0,l.__awaiter)(this,void 0,void 0,(function*(){const{ChatViewsRenderer:i,LPC:a}=yield((e,t)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const n="chat-app";t("ChunkLoadStarted",{chunkName:n});const[{ChatViewsRenderer:i},{LPC:a}]=yield Promise.all([(0,ha.mT)(Y_,n,e),(0,ha.mT)(X_,n,e)]);return t("ChunkLoadSucceeded",{chunkName:n}),{ChatViewsRenderer:i,LPC:a}})))(n,t);return e_.createElement(n_.f,{namespaces:["calling","chatList","compose","extensibility","files","lightbox","messaging","urlPreview","videoCapture","videoMessage"],loaderRenderer:null},e_.createElement(a,null,e_.createElement(H_.p3,null,e_.createElement(i,{appRenderMode:e}))))}))}}const ew={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"InitCallingService"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"initCallingService"}}]}}]},tw={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"callingAppEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callingAppEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingAppEvent"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingAppEvent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingAppEvent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"event"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingContentEvent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingAppSetupEvent"}}]}},{kind:"Field",name:{kind:"Name",value:"context"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"externalId"}},{kind:"Field",name:{kind:"Name",value:"timeStamp"}},{kind:"Field",name:{kind:"Name",value:"source"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"description"}}]}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingContentEvent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingContentEvent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"action"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"visibility"}}]}},{kind:"Field",name:{kind:"Name",value:"content"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingWindowingContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingDialogContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingNotificationContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingToChatContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingToChatListContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingToCallListContent"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"callingWindowingContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingWindowingContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"coordsType"}},{kind:"Field",name:{kind:"Name",value:"windowingMode"}},{kind:"Field",name:{kind:"Name",value:"linkedContent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"callingDialogContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingDialogContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"dialogActions"}},{kind:"Field",name:{kind:"Name",value:"dialogStrings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"text"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"callingNotificationContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingNotificationContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"subtitle"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"image"}},{kind:"Field",name:{kind:"Name",value:"time"}},{kind:"Field",name:{kind:"Name",value:"userid"}},{kind:"Field",name:{kind:"Name",value:"actions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"label"}},{kind:"Field",name:{kind:"Name",value:"icon"}},{kind:"Field",name:{kind:"Name",value:"actionType"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"callingToChatContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingToChatContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"messageId"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"callingToChatListContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingToChatListContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"callingToCallListContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingToCallListContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingAppSetupEvent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingAppSetupEvent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"result"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingAppEventsSetupSuccess"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"callingAppEventsSetupSuccess"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingAppEventsSetupSuccess"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"_"}}]}}]}.definitions]}.definitions]};function nw(e,t,n){const{id:i,title:a,subtitle:o,image:r,time:s,actions:l,type:c}=e,d=parseInt(s,10);return{command:{correlation:{source:k.D.Notifications,id:n},stateTransition:Ie.EntityStateTransition.new,visibilityState:Ie.EntityVisibilityState.show},entityOptions:{buttons:null==l?void 0:l.map((e=>function(e,t,n,i){const{actionType:a,label:o,icon:r}=t;return Object.assign(Object.assign({},r&&{image:{alt:o,src:r}}),{targetEntity:{action:Wt.mutate,dataOptions:{actionType:a,toastId:e},id:e,type:Ut.calls},text:o,preferImageOnly:n.get(b.J.Calling).forceTextOnT2Notifications?void 0:!!r,style:iw(a,i)})}(i,e,t,c))),isIncomingCall:!0,mainImage:{alt:a,src:r},targetEntity:{action:Wt.mutate,dataOptions:{actionType:"AcceptIncomingCallWithAudio",toastId:i},id:i,type:Ut.calls},text:o,time:new Date(d),title:a}}}function iw(e,t){if(t!==Ie.NotificationType.Meeting)switch(e){case"RejectIncomingCall":return Ht.critical;default:return Ht.success}}function aw(e,t,n){const{id:i,coordsType:a,windowingMode:o,linkedContent:r}=t,{action:{visibility:s}}=e,{externalId:l,source:c,timeStamp:d}=n,u=function(e){return e===Ie.CallingContentActionVisibility.Show?be.fe.show:be.fe.hide}(s),m=function(e){return e===Ie.WindowingMode.SingleWindow?be.su.flush:be.su.new}(o),p=r&&function(e){if(!e.id)return;return{id:e.id,type:ne.p.chats}}(r);return{entity:{id:i,type:function(e){switch(e){case Ie.WindowingCoordsType.RigelGallery:return ne.p.callsgallery;case Ie.WindowingCoordsType.RigelContent:return ne.p.callscontent;case Ie.WindowingCoordsType.RigelGalleryAndContent:return ne.p.callsgalleryandcontent;default:return ne.p.calls}}(a),action:ne.u.view,linkedEntity:p},command:{visibilityState:u,stateTransition:m,correlation:{id:l||void 0,startTimestamp:d||void 0,source:`${k.D.CallingAppEvent}::${c.name}::${c.description}`}}}}function ow(e,t){switch(e){case Ie.CallingContentActionVisibility.Show:return be.fe.show;case Ie.CallingContentActionVisibility.Hide:return be.fe.hide;default:return t.warn(`${e} cannot be converted to visibility state, defaulting to hide`),be.fe.hide}}function rw(e,t,n){const{id:i,name:a,dialogActions:o,dialogStrings:r}=t,{action:{visibility:s}}=e,{timeStamp:l}=n;let c;if(s===Ie.CallingContentActionVisibility.Show)c=be.fe.show;else{if(s!==Ie.CallingContentActionVisibility.Hide)return;c=be.fe.hide}const d={visibilityState:c,stateTransition:be.su.extend,correlation:{id:i,startTimestamp:l||void 0,source:a}},u=function(e){switch(e){case Ie.DialogName.WindowingError:return ne.p.windowingerrordialog;case Ie.DialogName.CallingRestartRecomendedError:return ne.p.restartrecomendeddialog;case Ie.DialogName.Alert:return ne.p.alertdialog;case Ie.DialogName.CallingUnparkCall:return ne.p.unparkcalldialog;case Ie.DialogName.CallingConfirm:return ne.p.callingconfirmdialog;case Ie.DialogName.MeetingJoinCrossCloud:return ne.p.meetingjoincrossclouddialog;case Ie.DialogName.OptionsSettings:return ne.p.optionssettingsdialog;case Ie.DialogName.PrejoinOverlay:return ne.p.prejoinoverlaydialog;case Ie.DialogName.UserMedia:return ne.p.usermediadialog;default:return}}(a);if(!u)return;const m={dialogActions:o,dialogStrings:r};return{entity:{id:i,type:u,action:ne.u.create},entityOptions:m,command:d}}const sw={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"msaUserProfilePicture"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"displayName"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"msaUserProfilePicture"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}},{kind:"Argument",name:{kind:"Name",value:"displayName"},value:{kind:"Variable",name:{kind:"Name",value:"displayName"}}},{kind:"Argument",name:{kind:"Name",value:"profilePictureSize"},value:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}}}]}]}}]},lw={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"toastImageAsDataUri"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"url"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toastImageAsDataUri"},arguments:[{kind:"Argument",name:{kind:"Name",value:"url"},value:{kind:"Variable",name:{kind:"Name",value:"url"}}}]}]}}]};const cw=new class{constructor(){this.deeplinkEntitySet=!1,this.callingAppEventsSubscribed=!1,this.unlockDeeplinkEntity=()=>{const e=this.deeplinkEntityId;return this.deeplinkEntityId=void 0,this.resolvePromise&&this.resolvePromise(),e},this.lockDeeplinkEntity=e=>{this.deeplinkEntitySet||(this.initializingPromise=new Promise((e=>{this.resolvePromise=()=>{e()}})),this.deeplinkEntityId=e,this.deeplinkEntitySet=!0)},this.getDeeplinkEntityLocked=()=>this.deeplinkEntitySet,this.getDeeplinkReady=()=>this.initializingPromise,this.getCallingAppEventsSubscribed=()=>this.callingAppEventsSubscribed,this.setCallingAppEventsSubscribed=e=>{this.callingAppEventsSubscribed=e}}},dw={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"resolveCallingAppEvent"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callingAppEventResolution"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingAppEventResolution"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"resolveCallingAppEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callingAppEventResolution"},value:{kind:"Variable",name:{kind:"Name",value:"callingAppEventResolution"}}}]}]}}]};function uw(e,t,n){const{eventId:i,resolution:a,context:o}=e,{source:r}=o;return n.log(`[resolveCallingAppEvent] Resolving calling app event [eventId=${i}, source.name=${r.name}, source.description=${r.description}]`),t.mutate({mutation:dw,variables:{callingAppEventResolution:{eventId:i,resolution:a,context:o}},fetchPolicy:"no-cache"})}const mw=(e,t,n,i,a,o)=>()=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const r=n.newLogger("getSetupAppEventsJob");let s=!1;const l=(0,Ua.P)();return cw.setCallingAppEventsSubscribed(!0),e.subscribe({query:tw,fetchPolicy:"no-cache"}).map((({data:e})=>null==e?void 0:e.callingAppEvent)).subscribe({next:o=>{if(!o)return void r.error("[getSetupAppEventsInnerJob] Received undefined calling app event");if("CallingAppSetupEvent"===o.event.__typename&&o.event.result&&"CallingAppEventsSetupSuccess"===o.event.result.__typename)return r.log("[getSetupAppEventsInnerJob] Successfully subscribed."),s=!0,void l.resolve();const{context:c}=o,{source:d}=c;r.log(`[getSetupAppEventsInnerJob] Received calling app event [event.id=${o.id}][context.externalId=${c.externalId}][source.name=${d.name}][source.description=${d.description}]`),pw(o,i,e,t,n,a)},error:e=>{if(r.error(`[getSetupAppEventsInnerJob] Error in calling app events subscription [error.name=${null==e?void 0:e.name}][error.message=${null==e?void 0:e.message}]`),!s){const t=(0,Z.Tr)(o,S.jK.SetupCallingAppEventsJobError,"",{},`[getSetupAppEventsInnerJob] error.name=${null==e?void 0:e.name}, error.message=${null==e?void 0:e.message}`);l.reject(t)}}}),l.promise})),pw=(e,t,n,i,a,o)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{id:r,event:s,context:c}=e;if(!("action"in s)||!("content"in s)){throw a.newLogger("appEventsHandler").error("[getSetupAppEventsInnerJob] Expected event of type CallingAppEvent, not CallingAppSetupEvent."),new Error("IncorrectCallingAppEventTypeError")}switch(s.content.__typename){case"CallingWindowingContent":!function(e,t,n,i,a,o,r){var s;(0,l.__awaiter)(this,void 0,void 0,(function*(){const l=e.newLogger("handleCallingWindowingContentEvent"),{entity:c,command:d}=aw(a,o,r),u=cw.unlockDeeplinkEntity();try{yield t.call.callById(c.id,{visibilityState:d.visibilityState,stateTransition:d.stateTransition,correlation:d.correlation},null===(s=null==c?void 0:c.linkedEntity)||void 0===s?void 0:s.id,c.type,u)}catch(e){const t=(null==e?void 0:e.name)||"unknown-windowing-commanding-error-name",a=(null==e?void 0:e.message)||"unknown-windowing-commanding-error-message";l.error(`[handleCallingWindowingContentEvent] Windowing commanding error [entity.id=${c.id}, errorName=${t}, errorMessage=${a}]`);try{yield uw({eventId:i,resolution:{error:{name:t,message:a}},context:{source:{name:Ie.CallingAppEventResolutionSourceName.WindowingCommandingError,description:`Error processing windowing command [eventId=${i}, entity.id=${c.id}]`}}},n,l)}catch(e){l.error(`[handleCallingWindowingContentEvent] Error when reporting event "error" [eventId=${i}, entity.id=${c.id}, error.name=${null==e?void 0:e.name}, error.message=${null==e?void 0:e.message}]`)}return}l.log(`[handleCallingWindowingContentEvent] Windowing commanding success [eventId=${i}, entity.id=${c.id}]`);try{yield uw({eventId:i,resolution:{success:{_:!0}},context:{source:{name:Ie.CallingAppEventResolutionSourceName.WindowingCommandingSuccess,description:`Windowing command resolved successfully [eventId=${i}, entity.id=${c.id}]`}}},n,l)}catch(e){l.error(`[handleCallingWindowingContentEvent] Error when reporting event "success" [entity.id=${c.id}, error.name=${null==e?void 0:e.name}, error.message=${null==e?void 0:e.message}]`)}}))}(a,i,n,r,s,s.content,c);break;case"CallingToChatContent":!function(e,t,n,i,a){var o;(0,l.__awaiter)(this,void 0,void 0,(function*(){const r=e.newLogger("handleCallingToChatContentEvent"),{entity:s,command:l}=function(e,t,n,i){const a=t.id,{action:{visibility:o}}=e,{externalId:r,timeStamp:s}=i,l=ow(o,n),c=t.messageId?{id:t.messageId,type:ne.p.messages}:void 0;return{entity:{id:a,type:ne.p.chats,action:ne.u.view,linkedEntity:c},command:{visibilityState:l,stateTransition:be.su.none,correlation:{id:r||void 0,startTimestamp:s||void 0,source:k.D.CallingAppEvent}}}}(n,i,r,a);try{yield t.chat.chatById(s.id,{entityCommand:{visibilityState:l.visibilityState,stateTransition:l.stateTransition,correlation:l.correlation},entityOptions:{messageId:null===(o=s.linkedEntity)||void 0===o?void 0:o.id}})}catch(e){r.error(`[getSetupAppEventsInnerJob] Navigation to chat commanding error [entity.id: ${s.id}, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}r.log(`[getSetupAppEventsInnerJob] Navigation to chat commanding success [entity.id: ${s.id}]`)}))}(a,i,s,s.content,c);break;case"CallingToChatListContent":!function(e,t,n,i){(0,l.__awaiter)(this,void 0,void 0,(function*(){const a=e.newLogger("handleCallingToChatListContentEvent"),{command:o}=function(e,t,n){const{action:{visibility:i}}=e,{externalId:a,timeStamp:o}=n,r=ow(i,t);return{entity:{type:ne.p.chats,action:ne.u.view},command:{visibilityState:r,stateTransition:be.su.none,correlation:{id:a||void 0,startTimestamp:o||void 0,source:k.D.CallingAppEvent}}}}(n,a,i);try{yield t.chat.chatList({visibilityState:o.visibilityState,stateTransition:o.stateTransition,correlation:o.correlation})}catch(e){a.error(`[getSetupAppEventsInnerJob] Navigation to chat list commanding error, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}a.log("[getSetupAppEventsInnerJob] Navigation to chat list commanding success")}))}(a,i,s,c);break;case"CallingToCallListContent":!function(e,t,n,i){(0,l.__awaiter)(this,void 0,void 0,(function*(){const a=e.newLogger("handleCallingToCallListContentEvent"),{command:o}=function(e,t,n){const{action:{visibility:i}}=e,{externalId:a,timeStamp:o}=n,r=ow(i,t);return{entity:{type:ne.p.callsmain,action:ne.u.view},command:{visibilityState:r,stateTransition:be.su.none,correlation:{id:a||void 0,startTimestamp:o||void 0,source:k.D.CallingAppEvent}}}}(n,a,i);try{yield t.call.callList({visibilityState:o.visibilityState,stateTransition:o.stateTransition,correlation:o.correlation})}catch(e){a.error(`[getSetupAppEventsInnerJob] Navigation to call list commanding error, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}a.log("[getSetupAppEventsInnerJob] Navigation to call list commanding success")}))}(a,i,s,c);break;case"CallingDialogContent":!function(e,t,n,i,a){(0,l.__awaiter)(this,void 0,void 0,(function*(){const o=e.newLogger("handleCallingDialogContentEvent"),r=rw(n,i,a);if(!r)return void o.error("[getSetupAppEventsInnerJob] Dialog commanding error - no command to fire, entity type is undefined");const{entity:s,entityOptions:l,command:c}=r;if(s.type){try{yield t.call.openDialog(s,c,l)}catch(e){o.error(`[getSetupAppEventsInnerJob] Dialog commanding error [entity.id: ${s.id}, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}o.log(`[getSetupAppEventsInnerJob] Dialog commanding success [entity.id: ${s.id}]`)}else o.error(`[getSetupAppEventsInnerJob] Dialog commanding error - no command to fire, entity type is undefined [entity.id: ${s.id}]`)}))}(a,i,s,s.content,c);break;case"CallingNotificationContent":!function(e,t,n,i,a,o,r){var s;(0,l.__awaiter)(this,void 0,void 0,(function*(){const c=e.newLogger("handleCallingNotificationContentEvent"),d=(0,Be.v4)(),u=r.newScenario(A.RG.ToastView);u.clientId=d,u.appendEventData({mainEntityType:ne.p.calls});const m=nw(n,o,d),p=yield function(e,t){return(0,l.__awaiter)(this,void 0,void 0,(function*(){try{const n=yield e.query({query:sw,variables:{userId:t.userid,displayName:t.title,profilePictureSize:"HR64x64"}}),i=yield e.query({query:lw,fetchPolicy:"no-cache",variables:{url:n.data.msaUserProfilePicture}});return(null==i?void 0:i.data.toastImageAsDataUri)||void 0}catch(e){return}}))}(a,n);p&&m&&m.entityOptions&&m.entityOptions.mainImage&&(m.entityOptions.mainImage={src:p,alt:null!==(s=n.title)&&void 0!==s?s:""},u.mark(A.ck.AvatarFetched));try{yield t.call.callNotification(m,n.id,d,i===Ie.CallingContentActionVisibility.Hide?Ie.CallingContentActionVisibility.Hide:Ie.CallingContentActionVisibility.Show)}catch(e){u.fail({errorCode:dr.SubscriptionFailed}),c.error(`[handleCallingNotificationContentEvent] Notification commanding error [[content.id: ${n.id}], entity.id: toasts , visibility: ${i.toString()}, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}c.log(`[handleCallingNotificationContentEvent] Notification commanding success [content.id: ${n.id}][entity.id: toasts][visibility: ${i.toString()}]`)}))}(a,i,s.content,s.action.visibility,n,t,o)}}));const gw={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"callingClientStateEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callingClientStateEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingClientStateEvent"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"callingClientStateEvent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingClientStateEvent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"inCall"}}]}}]},hw={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"updateClientStateVeryActive"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isVeryActive"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"source"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UpdateClientStateSource"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateClientStateVeryActive"},arguments:[{kind:"Argument",name:{kind:"Name",value:"isVeryActive"},value:{kind:"Variable",name:{kind:"Name",value:"isVeryActive"}}},{kind:"Argument",name:{kind:"Name",value:"source"},value:{kind:"Variable",name:{kind:"Name",value:"source"}}}]}]}}]},vw=(e,t)=>()=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const n=t.newLogger("getCallingClientEventsJob");e.subscribe({query:gw,fetchPolicy:"no-cache"}).subscribe((({data:i,errors:a})=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){if(a){const e=a.map((e=>e.message));n.error(`handleCallingClientStateEvent: Error receiving callingClientStateEvent [Errors: ${e.join()}]`)}else i&&(n.log(`handleCallingClientStateEvent: Processing callingClientStateEvent [Received: ${(0,P.u4)(i)}]`),function(e,t,n){(0,l.__awaiter)(this,void 0,void 0,(function*(){const i=e.newLogger("handleCallingClientStateEvent");i.log(`Event received: ${(0,P.u4)(t)}`);try{yield n.mutate({mutation:hw,variables:{isVeryActive:t.inCall,source:Ie.UpdateClientStateSource.Calling}})}catch(e){i.error(`mutation updateClientStateVeryActiveDocument error, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}}))}(t,i.callingClientStateEvent,e))}))))}));var fw=n(477428);const yw=(e,t,n,i,a,o)=>{const{enableCallingStackInitialization:r,enableCallingClientEvents:s,enableCallingAppEvents:c,enableExternalCallMonitor:d}=a.get(b.J.Calling),u=[];if(r){const t=Sw(i,A.RG.StandupCallingAppJob,o);u.push(((e,t,n,i)=>({id:"standup-calling",runOncePerId:!0,job:()=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){n.mark(A.ck.ExecuteJob);const a=t.newLogger("getStandupCallingJob");a.log("[getStandupCallingJob] Initializing calling service");try{yield e.mutate({mutation:ew})}catch(e){throw a.error(`[getStandupCallingJob] Error initializing calling service [error.name=${null==e?void 0:e.name}, error.message=${null==e?void 0:e.message}]`),n.fail({errors:e.name,message:`${A.ck.ExecuteJob} failed with ${e.message}`}),(0,Z.Tr)(i,S.jK.StandupCallingJobError,"",{},e.message)}a.log("[getStandupCallingJob] Calling service initialized"),n.stop()}))}))(e,n,t,o)),t.mark(A.ck.JobAdded)}return c&&u.push(((e,t,n,i,a,o)=>({id:"setup-calling-app-events",runOncePerId:!0,job:mw(e,t,n,i,a,o)}))(e,t,n,a,i,o)),s&&u.push(((e,t)=>({id:"calling-client-events",runOncePerId:!0,job:vw(e,t)}))(e,n)),d&&u.push(((e,t,n,i)=>({id:"setup-call-monitor",runOncePerId:!0,job:()=>fw.y.initialize(e,t,n,i)}))(n,t,e,a)),u},Sw=(e,t,n)=>{let i=e.findScenario(t);return i||(i=e.newScenario(t)),i.mark(n),i},kw=({context:{client:e,coreSettings:t,entityCommanding:n,loggerFactory:i,scenarioFactory:a}})=>yw(e,n,i,a,t,A.ck.OnAppPreWarm),bw=({context:{client:e,coreSettings:t,entityCommanding:n,loggerFactory:i,scenarioFactory:a}})=>yw(e,n,i,a,t,A.ck.OnAppPreInit);var _w;!function(e){e.EmptyDeeplinkUrl="empty-deeplink-url-received",e.MeetingCodeParse="meeting-code-parse-error"}(_w||(_w={}));const Cw={filter:new Set(["/meet"]),execute:({deeplinkUrl:{pathname:e,search:t,origin:n},context:{coreSettings:i,loggerFactory:a}})=>{const o=a.newLogger("[Calling][onBeforeDeeplinkParsed]"),{allowAnonymousMeetingJoin:r,defaultAnonTenantId:s}=i.get(b.J.Calling);if(o.log(`Parsing pathname: ${e}, search: ${t}, allowAnonymousMeetingJoin: ${r}`),!e)return Promise.reject(_w.EmptyDeeplinkUrl);const l=e.split(/[/?&]/),c=l.indexOf("meet"),d=l[c+1];if(!d||-1===c)return Promise.reject(_w.MeetingCodeParse);const u=new URLSearchParams(t);u.set("anon","true");const m=`${n}/_#${e}?${u.toString()}`;return o.log(`Resolving ${d}`),Promise.resolve({entityCommand:{entity:{type:ne.p.callingdeeplink,action:ne.u.join,id:d},command:{visibilityState:be.fe.show,stateTransition:be.su.new,layoutMode:be.lO.focus,correlation:{id:(0,Be.v4)(),startTimestamp:Date.now(),source:k.D.CallingOnBeforeDeeplinkParsed}},entityOptions:{deeplinkUrl:e,meetingCode:d,meetingUrl:`${n}${e}${t}`,directMeetingLink:m}},metadata:{allowAnonymous:r||!1,tenantId:s||void 0}})}},ww={shouldAddEntitiesToWindowHistory:e=>{var t,n;return(null===(t=e.mainEntity)||void 0===t?void 0:t.type)!==ne.p.callingdeeplink&&(null===(n=e.mainEntity)||void 0===n?void 0:n.type)!==ne.p.calls},shouldRestoreClientToEntities:e=>{var t,n;return(null===(t=e.mainEntity)||void 0===t?void 0:t.type)!==ne.p.callingdeeplink&&(null===(n=e.mainEntity)||void 0===n?void 0:n.type)!==ne.p.calls}},Tw=({appRenderMode:e})=>{const t=new Z_.H;return e!==t_.S.Main||t.registerAppPhase({phase:W_.nh.CRITICAL,signals:[W_.GZ.CALLING_SCREEN_RENDERED],timeout:9e4}),t.appPhases},Ew=e=>{if(Iw(e))return Nw(e)?{subNavEntity:Aw(e),headerEntity:Mw(e),startEntity:Fw(e),mainEntity:Rw(e),endEntity:Pw(e)}:null},Iw=({layoutMode:e,entity:t,contextEntity:n})=>{const{action:i=null,type:a}=Object.assign({},t),o=[be.lO.focus,be.lO.standard].includes(e),r=[ne.p.callingdeeplink,ne.p.calls,ne.p.callsmonitor,ne.p.meetings].includes(a),s=i&&[ne.u.create,ne.u.default,ne.u.list,ne.u.view,ne.u.join].includes(i)||a===ne.p.callingdeeplink&&!i&&!!n;return!!(o&&r&&s)},Nw=({contextEntity:e})=>!e||![ne.p.identity,ne.p.tflfre].includes(e.type),Aw=()=>null,Mw=({entity:e,contextEntity:t})=>e.type===ne.p.callingdeeplink?t||null:e,Fw=()=>null,Rw=({entity:e,contextEntity:t})=>e.type===ne.p.callingdeeplink&&(null==t?void 0:t.type)===ne.p.calls?t:e,Pw=({contextEntity:e})=>e&&e.action&&(e.type===ne.p.chats||e.type===ne.p.devicesettings||e.type===ne.p.meetings||e.type===ne.p.extensions)?e:null,Dw=({entity:e})=>({[be.tF.mainEntity]:{[t_.S.Main]:{doesHeaderOverlapMain:!1,isBackgroundTransparent:!0,isThemePinnedToDarkOrHighContrast:!0}},[be.tF.headerEntity]:{[t_.S.HorizontalBar]:{doesHeaderOverlapMain:!1,isBackgroundTransparent:(null==e?void 0:e.type)===ne.p.callsmonitor}},[be.tF.endEntity]:{[t_.S.Rail]:{doesHeaderOverlapMain:(null==e?void 0:e.type)===ne.p.videobackgrounds,isBackgroundTransparent:(null==e?void 0:e.type)===ne.p.videobackgrounds}}}),jw={id:"com.microsoft.teams.calling",name:"Calls",supportedEntities:[ne.p.callingdeeplink,ne.p.calls,ne.p.callscontent,ne.p.callsgallery,ne.p.callsgalleryandcontent,ne.p.cameraeffects,ne.p.contentcamerasetup,ne.p.callingconfirmdialog,ne.p.unparkcalldialog,ne.p.devicesettings,ne.p.notes,ne.p.mediastreams,ne.p.meetingdetails,ne.p.meetings,ne.p.meetingstream,ne.p.roster,ne.p.videobackgrounds,ne.p.broadcastqna,ne.p.transcript,ne.p.shareMeetingInfo,ne.p.stagecontent,ne.p.breakoutrooms,ne.p.invisionwhiteboard,ne.p.videoeffectscustomization,ne.p.videoeffectsmoreview,ne.p.windowingerrordialog,ne.p.restartrecomendeddialog,ne.p.stagingroomstartmeetingconfirmationdialog],supportedRenderModes:[t_.S.HorizontalBar,t_.S.Main,t_.S.Modal,t_.S.Rail],windowFeatures:{minWidth:800,width:800,minHeight:670,height:600},shouldErrorOnEntityCommandTimeout:!0},xw={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"triggerCallingToastAction"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"notificationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"actionType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"triggerCallingToastAction"},arguments:[{kind:"Argument",name:{kind:"Name",value:"notificationId"},value:{kind:"Variable",name:{kind:"Name",value:"notificationId"}}},{kind:"Argument",name:{kind:"Name",value:"actionType"},value:{kind:"Variable",name:{kind:"Name",value:"actionType"}}}]}]}}]},Ow={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"fireCallingIntent"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callingIntent"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingIntentInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fireCallingIntent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callingIntent"},value:{kind:"Variable",name:{kind:"Name",value:"callingIntent"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},Lw=e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{entityCommand:t,entityCommand:{entity:{type:n,action:i},dataOptions:a},requestContext:o,requestContext:{client:r}}=e;if(Ww(n,i)){const e=t.entityOptions,n=cw.getDeeplinkEntityLocked();if(n||!n&&cw.getCallingAppEventsSubscribed())return cw.getDeeplinkReady()&&(yield cw.getDeeplinkReady()),Hw(o,t);cw.lockDeeplinkEntity(e.meetingCode)}if(!a)return Promise.resolve(t);if(Uw(n,i,a)){const e=a,t=e.toastId,n=e.actionType;return n?r.mutate({mutation:xw,variables:{notificationId:t,actionType:n}}).then((()=>{})).catch((()=>Promise.reject(dr.CallingToastActionMutationFailed))):Promise.reject(dr.CallsActionTypeToNotificationActionFailed)}return Promise.resolve(t)})),Uw=(e,t,n)=>!!Bw(n)&&(!!n.toastId&&e===ne.p.calls&&t===ne.u.mutate&&"Unknown"!==n.actionType),Bw=e=>void 0!==e.toastId,Ww=(e,t)=>e===ne.p.callingdeeplink&&t===ne.u.join,Hw=(e,t)=>{const n=e.loggerFactory.newLogger("CallingOnBeforeCommandHandled[handleDeeplink]");if(!t.entityOptions){const e="No entity options";return n.error(e),Promise.reject(e)}const i=t.entityOptions,{meetingCode:a,meetingUrl:o}=i,r={coordinates:{meetingData:{meetingCode:a,meetingUrl:o}},joinOptions:{outgoingVideo:!1,outgoingAudio:!1,context:"DeepLink",meeting:{showPrejoin:!0,isPSTN:!1}},type:Ie.CallingIntentType.Meeting};return e.client.mutate({mutation:Ow,variables:{callingIntent:r}}).then((()=>{})).catch((e=>(n.error(e),Promise.reject(e))))};var $w=n(303683);const Vw=()=>Promise.all([n.e(89962),n.e(85256),n.e(2845),n.e(41574),n.e(92923),n.e(29138),n.e(38811),n.e(68865),n.e(21767),n.e(97725),n.e(21439),n.e(7001),n.e(91607),n.e(63506),n.e(64430),n.e(54510),n.e(78001),n.e(77999),n.e(23741),n.e(17870),n.e(61385),n.e(90864),n.e(84593),n.e(30644),n.e(53621),n.e(93438),n.e(8163),n.e(88612),n.e(51427),n.e(14797),n.e(33913),n.e(33587),n.e(38574),n.e(4537),n.e(68746),n.e(26589),n.e(29875),n.e(89361),n.e(14938),n.e(65665),n.e(71711),n.e(5514),n.e(74353),n.e(29600),n.e(91929),n.e(87468),n.e(79065),n.e(38123),n.e(37406),n.e(26113),n.e(70326)]).then(n.bind(n,933865)),zw=()=>Promise.all([n.e(89962),n.e(85256),n.e(2845),n.e(41574),n.e(92923),n.e(29138),n.e(38811),n.e(68865),n.e(21767),n.e(97725),n.e(21439),n.e(7001),n.e(91607),n.e(63506),n.e(64430),n.e(54510),n.e(78001),n.e(77999),n.e(23741),n.e(17870),n.e(61385),n.e(90864),n.e(84593),n.e(30644),n.e(53621),n.e(93438),n.e(8163),n.e(88612),n.e(51427),n.e(14797),n.e(33913),n.e(33587),n.e(38574),n.e(4537),n.e(68746),n.e(26589),n.e(29875),n.e(89361),n.e(14938),n.e(65665),n.e(71711),n.e(5514),n.e(74353),n.e(29600),n.e(91929),n.e(87468),n.e(79065),n.e(38123),n.e(37406),n.e(26113),n.e(70326)]).then(n.bind(n,149932)),Gw=()=>Promise.all([n.e(89962),n.e(85256),n.e(2845),n.e(41574),n.e(92923),n.e(29138),n.e(38811),n.e(68865),n.e(21767),n.e(97725),n.e(21439),n.e(7001),n.e(91607),n.e(63506),n.e(64430),n.e(54510),n.e(78001),n.e(77999),n.e(23741),n.e(17870),n.e(61385),n.e(90864),n.e(84593),n.e(30644),n.e(53621),n.e(93438),n.e(8163),n.e(88612),n.e(51427),n.e(14797),n.e(33913),n.e(33587),n.e(38574),n.e(4537),n.e(68746),n.e(26589),n.e(29875),n.e(89361),n.e(14938),n.e(65665),n.e(71711),n.e(5514),n.e(74353),n.e(29600),n.e(91929),n.e(87468),n.e(79065),n.e(38123),n.e(37406),n.e(26113),n.e(70326)]).then(n.bind(n,208163)),qw="calling-app",Jw=({appRenderMode:e,coreSettings:t,host:n,isHeader:i,isMainPanel:a,logger:o,onRenderEvent:r,scenarioFactory:s})=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){o.log(`renderWithLPC: import LPC: isMainPanel=${a} isHeader=${i}`);const l=(0,ha.mT)(Gw,qw,s);if(e===t_.S.Main){r("ChunkLoadStarted",{chunkName:qw});const{chunkLoadTimerPromise:e,chunkLoadTimer:s}=(({coreSettings:e,host:t})=>{let n=0;return{chunkLoadTimerPromise:new Promise(((i,a)=>{let{chunkLoadTimeout:o}=e.get(b.J.Calling);o||(o=Number.MAX_SAFE_INTEGER),n=t.setTimeout(a,o,(0,Z.Tr)("CallingApp",S.jK.ChunkLoadTimedOut,"renderMain"))})),chunkLoadTimer:n}})({coreSettings:t,host:n});yield Promise.race([l,e]).then((()=>clearTimeout(s))).catch((e=>{throw o.error(`renderWithLPC: ChunkLoadTimedOut: isMainPanel=${a} isHeader=${i}`),e})),r("ChunkLoadSucceeded",{chunkName:qw})}const{LPC:c}=yield l;return o.log(`renderWithLPC: construct the slot element: isMainPanel=${a} isHeader=${i}`),c})),Kw=({coreServices:e,host:t,isResize:n})=>{const{minHeight:i,minWidth:a}=jw.windowFeatures||{},o=null==t?void 0:t.screen;if(n&&!o)return jw.windowFeatures||null;if(!o)return null;let{height:r=1,width:s=1}=((e,t)=>{const{minHeight:n=0,minWidth:i=0}=jw.windowFeatures||{};let{width:a,height:o}=jw.windowFeatures||{};if(!t)return{height:o,width:a,minHeight:n,minWidth:i};const{orientation:{type:r}}=e,{landscapeScreenRatio:s,portraitScreenRatio:l,widthHeightRatio:c}=t.coreSettings.get(b.J.Calling);if(s&&l&&c)switch(r){case"landscape-primary":case"landscape-secondary":const t=s*e.availHeight;o=t>n?t:n,a=c*o;break;case"portrait-primary":case"portrait-secondary":const r=l*e.availWidth;a=r>i?r:i,o=1/c*a}return{height:o,width:a}})(o,e);const l=o.availHeight-20,c=s>=o.availWidth||r>=l;c&&(r=o.availHeight,s=o.availWidth);const{left:d,top:u}=((e,t,n,i,a)=>{if(i)return{left:0,top:0};const o="availLeft"in e?e.availLeft:0,r="availTop"in e?e.availTop:0,s=o+e.availWidth/2-t/2;let l;switch(e.orientation.type){case"landscape-primary":case"landscape-secondary":l=r+a;break;default:l=r+e.availHeight/2-n/2}return{left:s,top:l}})(o,s,r,c,20);return{additionalFeatures:{minHeight:`${i}`,minWidth:`${a}`},height:r,width:s,fullScreen:c,left:d,top:u,minHeight:i,minWidth:a}};function Qw(){return{getAppPhases:Tw,getAppViewEntities:Ew,getAppViewEntitiesProps:Dw,getAppWindowFeatures:Kw,manifest:jw,render:({appRenderMode:e,coreSettings:t,host:n,loggerFactory:i,onRenderEvent:a,scenarioFactory:o})=>(0,l.__awaiter)(this,void 0,void 0,(function*(){const r=i.newLogger("CallingApp");if(e===t_.S.HorizontalBar||e===t_.S.Modal){const t=e===t_.S.HorizontalBar,n=e===t_.S.HorizontalBar,i=e===t_.S.Modal;r.log(`render: import the necessary subcomponents: isMainPanel=${t} isHeader=${n} isModal=${i}`);const[{CallingViewsRenderer:a},{CallingContextProvider:s}]=yield Promise.all([(0,ha.mT)(Vw,qw,o),(0,ha.mT)(zw,qw,o)]);return r.log(`render: construct the slot element: isMainPanel=${t} isHeader=${n} isModal=${i}`),e_.createElement(Yw,null,e_.createElement(s,null,e_.createElement(a,{isMainPanel:t,isHeader:n,isModal:i}))," ")}if(e===t_.S.Main||e===t_.S.Rail){const i=e===t_.S.Main,s=!1,l=!1,c=yield Jw({appRenderMode:e,coreSettings:t,host:n,isHeader:s,isMainPanel:i,logger:r,onRenderEvent:a,scenarioFactory:o});r.log(`render: import the necessary subcomponents: isMainPanel=${i} isHeader=${s} isModal=${l}`);const[{CallingViewsRenderer:d},{CallingContextProvider:u}]=yield Promise.all([(0,ha.mT)(Vw,qw,o),(0,ha.mT)(zw,qw,o)]);return r.log(`render: construct the slot element: isMainPanel=${i} isHeader=${s} isModal=${l}`),e_.createElement(Yw,null,e_.createElement(c,null,e_.createElement(H_.p3,null,e_.createElement(u,null,e_.createElement(d,{isMainPanel:i,isHeader:s,isModal:l})))))}return e_.createElement($w.e,null)})),onPreWarm:kw,onPreInit:bw,onBeforeAddToNavigation:ww,onBeforeCommandHandled:Lw,onBeforeDeeplinkParsed:Cw}}const Yw=({children:e})=>e_.createElement(n_.f,{namespaces:["calling","broadcast","extensibility","hololens","messaging","meetingOptions"],loaderRenderer:null},e),Xw=e=>{if(Zw(e))return eT(e)?{subNavEntity:tT(e),headerEntity:nT(e),startEntity:iT(e),mainEntity:aT(e),endEntity:oT(e)}:null},Zw=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[be.lO.focus,be.lO.standard].includes(e),o=[ne.p.callsmain].includes(i),r=n&&[ne.u.create,ne.u.default,ne.u.list,ne.u.view].includes(n);return!!(a&&o&&r)},eT=()=>!0,tT=()=>null,nT=({entity:e})=>e,iT=()=>null,aT=({entity:e})=>e,oT=()=>null,rT={id:"com.microsoft.teams.callsmain",name:"CallsMain",supportedEntities:[ne.p.callsmain],supportedRenderModes:[t_.S.HorizontalBar,t_.S.Main,t_.S.Rail],windowFeatures:{minWidth:800,width:800,minHeight:670,height:600}},sT=()=>Promise.all([n.e(89962),n.e(85256),n.e(2845),n.e(92923),n.e(77999),n.e(8163),n.e(3806),n.e(211),n.e(68740)]).then(n.bind(n,598401)),lT=()=>Promise.all([n.e(89962),n.e(85256),n.e(2845),n.e(92923),n.e(77999),n.e(8163),n.e(3806),n.e(211),n.e(68740)]).then(n.bind(n,306011)),cT=()=>Promise.all([n.e(89962),n.e(85256),n.e(2845),n.e(92923),n.e(77999),n.e(8163),n.e(3806),n.e(211),n.e(68740)]).then(n.bind(n,208163)),dT=()=>rT.windowFeatures||{};function uT(){const e=()=>null;return{getAppViewEntities:Xw,getAppWindowFeatures:dT,manifest:rT,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:i})=>(0,l.__awaiter)(this,void 0,void 0,(function*(){if(t===t_.S.Rail||t===t_.S.Main){const e=t===t_.S.Main,a="calls-main-app";e&&n("ChunkLoadStarted",{chunkName:a});const{LPC:o}=yield(0,ha.mT)(cT,a,i);e&&n("ChunkLoadSucceeded",{chunkName:a});const[{CallsMainViewsRenderer:r},{CallsTabContextProvider:s}]=yield Promise.all([(0,ha.mT)(sT,a,i),(0,ha.mT)(lT,a,i)]);return e_.createElement(n_.f,{namespaces:["calling","hololens","messaging"],loaderRenderer:null},e_.createElement(o,null,e_.createElement(H_.p3,null,e_.createElement(s,null,e_.createElement(r,{isMainPanel:e})))))}return e_.createElement(e,null)}))}}const mT={id:"com.microsoft.teams.cast",name:"CastApp",supportedEntities:[ne.p.cast],supportedRenderModes:[t_.S.Main],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},pT=e=>{if(gT(e))return hT(e)?{subNavEntity:vT(e),headerEntity:fT(e),startEntity:yT(e),mainEntity:ST(e),endEntity:kT(e)}:null},gT=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[be.lO.focus,be.lO.standard].includes(e),o=[ne.p.cast].includes(i),r=n&&[ne.u.default,ne.u.view].includes(n);return!!(a&&o&&r)},hT=()=>!0,vT=()=>null,fT=()=>null,yT=()=>null,ST=({entity:e})=>e,kT=()=>null,bT=()=>({[be.tF.mainEntity]:{[t_.S.Main]:{isBackgroundTransparent:!1,isThemePinnedToDarkOrHighContrast:!0}}}),_T=()=>Promise.all([n.e(89962),n.e(2845),n.e(76657)]).then(n.bind(n,382551)),CT=()=>mT.windowFeatures||{};function wT(){const e=()=>null;return{getAppViewEntities:pT,getAppViewEntitiesProps:bT,getAppWindowFeatures:CT,manifest:mT,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:i})=>(0,l.__awaiter)(this,void 0,void 0,(function*(){if(t===t_.S.Main){const e="cast-app";n("ChunkLoadStarted",{chunkName:e});const{CastWizard:t}=yield(0,ha.mT)(_T,e,i);return n("ChunkLoadSucceeded",{chunkName:e}),e_.createElement(t,null)}return e_.createElement(e,null)}))}}const TT={id:"com.microsoft.teams.gallery",name:"GalleryApp",supportedEntities:[ne.p.gallery],supportedRenderModes:[t_.S.Main],defaultCommand:{type:ne.p.gallery,action:ne.u.view},windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},ET=e=>{if(IT(e))return NT(e)?{subNavEntity:AT(e),headerEntity:MT(e),startEntity:FT(e),mainEntity:RT(e),endEntity:PT(e)}:null},IT=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[be.lO.focus,be.lO.standard].includes(e),o=[ne.p.gallery].includes(i),r=n&&[ne.u.default,ne.u.view].includes(n);return!!(a&&o&&r)},NT=()=>!0,AT=()=>null,MT=()=>null,FT=()=>null,RT=({entity:e})=>e,PT=()=>null,DT=()=>Promise.all([n.e(89962),n.e(2845),n.e(55837),n.e(63506),n.e(64430),n.e(2404),n.e(19753)]).then(n.bind(n,938920));function jT(){const e=()=>null;return{getAppViewEntities:ET,manifest:TT,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:i})=>(0,l.__awaiter)(this,void 0,void 0,(function*(){if(t===t_.S.Main){const e="gallery-app";n("ChunkLoadStarted",{chunkName:e});const{Gallery:t}=yield(0,ha.mT)(DT,e,i);return n("ChunkLoadSucceeded",{chunkName:e}),e_.createElement(t,null)}return e_.createElement(e,null)}))}}const xT={id:"com.microsoft.teams.hybrid",name:"HybridApp",supportedEntities:[ne.p.blank],supportedRenderModes:[t_.S.Main]},OT=e=>{if(LT(e))return UT(e)?{subNavEntity:BT(e),headerEntity:WT(e),startEntity:HT(e),mainEntity:$T(e),endEntity:VT(e)}:null},LT=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[be.lO.standard].includes(e),o={[ne.p.blank]:[ne.u.default,ne.u.view]},r=n&&(o[i]||[]).includes(n);return!(!a||!r)},UT=()=>!0,BT=()=>null,WT=()=>null,HT=()=>null,$T=({entity:e})=>e,VT=()=>null,zT=({areEmptySlotsTransparent:e})=>({[be.tF.mainEntity]:{[t_.S.Main]:{isBackgroundTransparent:e}}});function GT(){const e=()=>null;return{getAppViewEntities:OT,getAppViewEntitiesProps:zT,manifest:xT,render:({onRenderEvent:t,entity:n})=>(0,l.__awaiter)(this,void 0,void 0,(function*(){return t("CriticalInitRender",{isBlanked:n.type===ne.p.blank}),e_.createElement(e,null)}))}}const qT=e=>{if(JT(e))return KT(e)?{subNavEntity:QT(e),headerEntity:YT(e),startEntity:XT(e),mainEntity:ZT(e),endEntity:eE(e)}:null},JT=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[be.lO.focus,be.lO.standard].includes(e),o=[ne.p.meetinganalytics].includes(i),r=n&&[ne.u.default,ne.u.view].includes(n);return!!(a&&o&&r)},KT=()=>!0,QT=()=>null,YT=()=>null,XT=()=>null,ZT=({entity:e})=>e,eE=()=>null,tE={id:"com.microsoft.teams.meetinganalytics",name:"MeetingAnalytics",supportedEntities:[ne.p.meetinganalytics],supportedRenderModes:[t_.S.Main],defaultCommand:{type:ne.p.meetinganalytics,action:ne.u.view},windowFeatures:{minWidth:1600,width:1600,minHeight:1e3,height:1e3,offset:20}},nE=()=>Promise.all([n.e(89962),n.e(2845),n.e(41574),n.e(92923),n.e(29138),n.e(38811),n.e(21767),n.e(97725),n.e(29084),n.e(78001),n.e(77999),n.e(98368)]).then(n.bind(n,912140)),iE=()=>tE.windowFeatures||{};function aE(){const e=()=>null;return{getAppViewEntities:qT,getAppWindowFeatures:iE,manifest:tE,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:i})=>(0,l.__awaiter)(this,void 0,void 0,(function*(){if(t===t_.S.Main){const e="meeting-analytics-app";n("ChunkLoadStarted",{chunkName:e});const{MeetingAnalyticsRenderer:t}=yield(0,ha.mT)(nE,e,i);return n("ChunkLoadSucceeded",{chunkName:e}),e_.createElement(n_.f,{namespaces:["calling","meetingAnalytics","messaging"],loaderRenderer:null},e_.createElement(t,null))}return e_.createElement(e,null)}))}}const oE={defaultCommand:{type:ne.p.meetings,action:ne.u.view},id:"com.microsoft.teams.meeting-options",name:"MeetingOptionsApp",supportedRenderModes:[t_.S.Main,t_.S.Modal],supportedEntities:[ne.p.meetings,ne.p.meetingsettings,ne.p.licenses,ne.p.meetingoptionscreatedialog],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},rE=e=>{if(sE(e))return lE(e)?{subNavEntity:cE(e),headerEntity:dE(e),startEntity:uE(e),mainEntity:mE(e),endEntity:pE(e)}:null},sE=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[be.lO.focus,be.lO.standard].includes(e),o=[ne.p.meetings,ne.p.meetingsettings,ne.p.licenses,ne.p.meetingoptionscreatedialog].includes(i),r=n&&[ne.u.default,ne.u.view].includes(n);return!!(a&&o&&r)},lE=()=>!0,cE=()=>null,dE=()=>null,uE=()=>null,mE=({entity:e})=>e,pE=()=>null,gE=()=>({[be.tF.mainEntity]:{[t_.S.Main]:{isBackgroundTransparent:!0}}}),hE=()=>Promise.all([n.e(89962),n.e(2845),n.e(41574),n.e(92923),n.e(7001),n.e(92935),n.e(2404),n.e(23862),n.e(75558)]).then(n.bind(n,810704));function vE(){return{getAppViewEntities:rE,getAppViewEntitiesProps:gE,manifest:oE,onRegister:e=>{e.registerTask(new V_)},render:({appRenderMode:e,onRenderEvent:t,scenarioFactory:n})=>(0,l.__awaiter)(this,void 0,void 0,(function*(){const i="meeting-options-app";t("ChunkLoadStarted",{chunkName:i});const{MeetingOptions:a}=yield(0,ha.mT)(hE,i,n);return t("ChunkLoadSucceeded",{chunkName:i}),e_.createElement(fE,{scenarioFactory:n},e_.createElement(a,{appRenderMode:e}))}))}}const fE=({scenarioFactory:e,children:t})=>(yE(e),e_.createElement(e_.Fragment,null,t)),yE=e=>{const t=e_.useRef(e.findScenario(A.RG.MeetingOptionsStart));e_.useEffect((()=>{t.current||(t.current=e.cancelExistingAndCreateScenario(A.RG.MeetingOptionsStart,"remount"))}),[e])},SE=e=>{if(kE(e))return bE(e)?{subNavEntity:_E(e),headerEntity:CE(e),startEntity:wE(e),mainEntity:TE(e),endEntity:EE(e)}:null},kE=({contextEntity:e,entity:t,coreSettings:n,layoutMode:i})=>{const{action:a=null,type:o}=Object.assign({},t);if(IE(t,e,n))return!1;const r=[be.lO.focus,be.lO.standard].includes(i),s=[ne.p.platformapp,ne.p.platformappdetails,ne.p.platformapps,ne.p.extensions].includes(o),l=a&&[ne.u.create,ne.u.default,ne.u.list,ne.u.view,ne.u.update].includes(a),c=e&&e.action;return!(!r||!s||!l&&!c)},bE=()=>!0,_E=()=>null,CE=({contextEntity:e,entity:t,coreSettings:n})=>{const i=null==n?void 0:n.get(b.J.Extensibility).enablePlatformHeaderEntry;if(e&&e.action){if(e.type===ne.p.chats)return t;if(e.type===ne.p.extensions&&i)return e}return i?t:null},wE=()=>null,TE=({entity:e,contextEntity:t})=>t&&t.action&&(t.type===ne.p.chats||t.type===ne.p.extensions)?t:e,EE=()=>null,IE=(e,t,n)=>{const i=null==n?void 0:n.get(b.J.Extensibility).enablePlatformHeaderEntry;return e.type===ne.p.extensions&&(null==t?void 0:t.type)===ne.p.extensions&&!i},NE={id:"com.microsoft.teams.platform-app",name:"Platform App",supportedEntities:[ne.p.extensions,ne.p.taskmodule,ne.p.platformapp,ne.p.platformappdetails,ne.p.platformapps,ne.p.platformsubscriptionplans,ne.p.customapp,ne.p.platformauthconsentdialog,ne.p.platformStage,ne.p.workflows,ne.p.selectMediaApi,ne.p.viewImagesApi,ne.p.platformtab,ne.p.locationapi,ne.p.selectpeoplepicker,ne.p.stagedapps,ne.p.manageapps],supportedRenderModes:[t_.S.HorizontalBar,t_.S.Main,t_.S.Modal,t_.S.Rail],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},AE=()=>Promise.all([n.e(89962),n.e(2845),n.e(41574),n.e(70724),n.e(2239),n.e(17870),n.e(61385),n.e(90864),n.e(2404),n.e(74353),n.e(99447),n.e(60941)]).then(n.bind(n,890066)),ME=()=>Promise.all([n.e(89962),n.e(85256),n.e(63986),n.e(2845),n.e(41574),n.e(92923),n.e(29138),n.e(38811),n.e(68865),n.e(21767),n.e(97725),n.e(29084),n.e(21439),n.e(55837),n.e(98314),n.e(22391),n.e(88591),n.e(91607),n.e(98495),n.e(78001),n.e(77999),n.e(23741),n.e(17870),n.e(61385),n.e(90864),n.e(58254),n.e(81391),n.e(84593),n.e(30644),n.e(53621),n.e(93438),n.e(74313),n.e(88612),n.e(51217),n.e(71217),n.e(51427),n.e(14797),n.e(33913),n.e(75516),n.e(38574),n.e(15470),n.e(8093),n.e(68746),n.e(26589),n.e(73190),n.e(36378),n.e(14776),n.e(14938),n.e(30970),n.e(74353),n.e(30828),n.e(4274),n.e(59067)]).then(n.bind(n,196014)),FE=()=>Promise.all([n.e(89962),n.e(85256),n.e(2845),n.e(41574),n.e(92923),n.e(29138),n.e(70724),n.e(7001),n.e(88591),n.e(98495),n.e(80419),n.e(78001),n.e(77999),n.e(17870),n.e(61385),n.e(90864),n.e(74313),n.e(71217),n.e(68746),n.e(65665),n.e(92066),n.e(74453),n.e(4274),n.e(99447),n.e(88919)]).then(n.bind(n,423677));function RE(){const e=()=>null;return{getAppViewEntities:SE,manifest:NE,onRegister:e=>{e.registerTask(new V_)},render:({appRenderMode:t,scenarioFactory:n,onRenderEvent:i})=>(0,l.__awaiter)(this,void 0,void 0,(function*(){switch(t){case t_.S.Modal:{const e="platform-modal",{Modal:t}=yield(0,ha.mT)(FE,e,n);return e_.createElement(n_.f,{namespace:"extensibility",loaderRenderer:null},e_.createElement(t,null))}case t_.S.HorizontalBar:case t_.S.Main:{const e="platform-app";i("ChunkLoadStarted",{chunkName:e});const{PlatformAppViewsEntryRenderer:a}=yield(0,ha.mT)(ME,e,n);return i("ChunkLoadSucceeded",{chunkName:e}),e_.createElement(n_.f,{namespace:"extensibility",loaderRenderer:null},e_.createElement(a,{appRenderMode:t}))}case t_.S.Rail:{const e="platform-app-rail",{PlatformTabPanel:t}=yield(0,ha.mT)(AE,e,n);return e_.createElement(n_.f,{namespace:"extensibility",loaderRenderer:null},e_.createElement(t,null))}default:return e_.createElement(e,null)}}))}}var PE=n(283232);const DE={id:n(423238).Hm,name:"TeamsAndChannelsApp",supportedEntities:[ne.p.channelmanage,ne.p.channels,ne.p.schoolteams,ne.p.teamdiscover,ne.p.teamgallery,ne.p.teammanage,ne.p.teammanagetags,ne.p.teams,ne.p.teamsettings],supportedRenderModes:[t_.S.HorizontalBar,t_.S.Main,t_.S.Rail],defaultCommand:{type:ne.p.channels,action:ne.u.default},windowFeatures:{minWidth:602,width:602,minHeight:500,height:500,offset:20}},jE=e=>{if(xE(e))return OE(e)?{subNavEntity:LE(e),headerEntity:UE(e),startEntity:BE(e),mainEntity:WE(e),endEntity:HE(e)}:null},xE=({layoutMode:e,contextEntity:t,entity:n})=>{const{action:i=null,type:a}=Object.assign({},n),{type:o,action:r}=t||{},s=[be.lO.standard,be.lO.focus].includes(e),l=[ne.p.channelmanage,ne.p.channels,ne.p.schoolteams,ne.p.teamdiscover,ne.p.teammanage,ne.p.teammanagetags,ne.p.teams,ne.p.teamsettings].includes(a),c=i&&[ne.u.create,ne.u.default,ne.u.info,ne.u.list,ne.u.view].includes(i),d=o&&[ne.p.extensions].includes(o),u=r&&[ne.u.view].includes(r);return!(!s||!l||!c&&!(u&&d))},OE=()=>!0,LE=({layoutMode:e,entity:t})=>e===be.lO.focus?null:t.type===ne.p.teams&&t.action===ne.u.create?t:t.type===ne.p.schoolteams&&t.action===ne.u.list?null:t.type===ne.p.schoolteams&&t.action===ne.u.view?t:{action:ne.u.list,entityState:{flushableByLinkedEntity:!0},id:null,linkedEntity:null,options:null,type:ne.p.channels,windowOptions:null},UE=({entity:e})=>e.type===ne.p.schoolteams&&e.action===ne.u.view?null:e,BE=()=>null,WE=({contextEntity:e,entity:t})=>(null==e?void 0:e.type)&&[ne.p.extensions].includes(e.type)?e:t.type===ne.p.schoolteams&&t.action===ne.u.view?null:t,HE=({contextEntity:e})=>{const{action:t,type:n}=e||{};return e&&n===ne.p.channels&&t&&t===ne.u.info?e:null},$E=()=>({[be.tF.subNavEntity]:{[t_.S.Rail]:{areSlotShadowsDisabled:!1,isColorSchemeDefaultBackground3:!0}}}),VE=()=>Promise.all([n.e(89962),n.e(85256),n.e(63986),n.e(2845),n.e(41574),n.e(92923),n.e(29138),n.e(38811),n.e(68865),n.e(21767),n.e(97725),n.e(21439),n.e(55837),n.e(98314),n.e(22391),n.e(91607),n.e(16951),n.e(78001),n.e(77999),n.e(23741),n.e(90864),n.e(58254),n.e(81391),n.e(84593),n.e(30644),n.e(53621),n.e(93438),n.e(8163),n.e(74313),n.e(88612),n.e(51217),n.e(71217),n.e(51427),n.e(14797),n.e(33913),n.e(75516),n.e(38574),n.e(15470),n.e(26589),n.e(73190),n.e(36378),n.e(14776),n.e(31611),n.e(62030)]).then(n.bind(n,221236)),zE=()=>Promise.all([n.e(89962),n.e(85256),n.e(63986),n.e(2845),n.e(41574),n.e(92923),n.e(29138),n.e(38811),n.e(68865),n.e(21767),n.e(97725),n.e(21439),n.e(55837),n.e(98314),n.e(22391),n.e(91607),n.e(16951),n.e(78001),n.e(77999),n.e(23741),n.e(90864),n.e(58254),n.e(81391),n.e(84593),n.e(30644),n.e(53621),n.e(93438),n.e(8163),n.e(74313),n.e(88612),n.e(51217),n.e(71217),n.e(51427),n.e(14797),n.e(33913),n.e(75516),n.e(38574),n.e(15470),n.e(26589),n.e(73190),n.e(36378),n.e(14776),n.e(31611),n.e(62030)]).then(n.bind(n,208163)),GE=()=>DE.windowFeatures||{};function qE(){return{getAppViewEntities:jE,getAppViewEntitiesProps:$E,getAppWindowFeatures:GE,getCommandScenarioName:e=>{const{entity:t,command:n}=e;if(!(t.type!==ne.p.channels||t.action!==ne.u.view&&t.action!==ne.u.default||n.visibilityState!==be.fe.show||n.stateTransition!==be.su.flush&&n.stateTransition!==be.su.new))if(t.id){const e=(0,PE.j)(t.id);if(e)return n.stateTransition===be.su.new?e.replyChainId?A.RG.ChannelSwitchL2Popout:void 0:e.replyChainId?A.RG.ChannelSwitchL2:A.RG.ChannelSwitchL1}else if(t.action===ne.u.default)return A.RG.ChannelSwitchL1},manifest:DE,render:({appRenderMode:e,coreSettings:t,onRenderEvent:n,scenarioFactory:i})=>(0,l.__awaiter)(this,void 0,void 0,(function*(){const a="teams-and-channels-app";n("ChunkLoadStarted",{chunkName:a});const[{TeamsAndChannelsViewsRenderer:o},{LPC:r}]=yield Promise.all([(0,ha.mT)(VE,a,i),(0,ha.mT)(zE,a,i)]);return n("ChunkLoadSucceeded",{chunkName:a}),e_.createElement(r,null,e_.createElement(H_.p3,null,e_.createElement(o,{appRenderMode:e,coreSettings:t})))}))}}var JE=n(891836);const KE=()=>Promise.all([n.e(38294),n.e(86060)]).then(n.bind(n,872268)),QE=e=>({id:"search-data-load",runOncePerId:!0,job:()=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const t=e.newLogger("dataResolverSearchJob");t.log("[dataResolversSearchJob] Initializing calling service");try{yield(0,ha.mT)(KE,"search-data-resolvers")}catch(e){t.error("[dataResolversSearch] Error initializing bundle")}t.log("[dataResolversSearch] Calling service initialized")}))}),YE=({context:{loggerFactory:e}})=>[QE(e)],XE=()=>Promise.all([n.e(89962),n.e(85256),n.e(63986),n.e(2845),n.e(41574),n.e(92923),n.e(29138),n.e(70290),n.e(70724),n.e(6333),n.e(63558),n.e(78001),n.e(77999),n.e(23741),n.e(90864),n.e(84593),n.e(8163),n.e(74313),n.e(71217),n.e(51427),n.e(14797),n.e(15470),n.e(10813),n.e(38294),n.e(56904)]).then(n.bind(n,293109)),ZE=e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{entityCommand:t,entityCommand:{entity:{type:n,action:i}}}=e,a=(t.entityOptions||{}).loadBundle;if(n===ne.p.search&&i===ne.u.view&&a){const e="search-app";return yield(0,ha.mT)(XE,e),Promise.resolve(void 0)}return Promise.resolve(t)})),eI=({appRenderMode:e})=>{const t=new Z_.H,n=[],i=[];switch(e){case t_.S.Main:tI({featureFlags:{},criticalSignals:n,postCriticalSignals:i})}return t.registerAppPhase({phase:W_.nh.CRITICAL,signals:n,timeout:1e4}),t.registerAppPhase({phase:W_.nh.POST_CRITICAL,signals:i,timeout:1e4}),t.appPhases},tI=({criticalSignals:e})=>{e.push(W_.GZ.SEARCH_RESULTS_RENDERED)},nI=e=>{if(iI(e))return aI(e)?{subNavEntity:oI(e),headerEntity:rI(e),startEntity:sI(e),mainEntity:lI(e),endEntity:cI(e)}:null},iI=({contextEntity:e,entity:t,layoutMode:n})=>{const{action:i=null,type:a}=Object.assign({},t),o=[be.lO.focus,be.lO.standard].includes(n),r=[ne.p.search].includes(a),s=i&&[ne.u.default,ne.u.view].includes(i),l=e&&e.action&&e.type===ne.p.chats;return!(!o||!r||!s&&!l)},aI=()=>!0,oI=()=>null,rI=({contextEntity:e})=>e&&e.action&&e.type===ne.p.chats?e:null,sI=()=>null,lI=({entity:e,contextEntity:t})=>t&&t.action&&t.type===ne.p.chats?t:e,cI=()=>null,dI={id:"com.microsoft.teams.search",name:"Search",supportedEntities:[ne.p.search],supportedRenderModes:[t_.S.Main],windowFeatures:{minWidth:1600,width:1600,minHeight:1e3,height:1e3}},uI=()=>Promise.all([n.e(89962),n.e(85256),n.e(63986),n.e(2845),n.e(41574),n.e(92923),n.e(29138),n.e(70290),n.e(70724),n.e(6333),n.e(63558),n.e(78001),n.e(77999),n.e(23741),n.e(90864),n.e(84593),n.e(8163),n.e(74313),n.e(71217),n.e(51427),n.e(14797),n.e(15470),n.e(10813),n.e(38294),n.e(56904)]).then(n.bind(n,293109)),mI=()=>Promise.all([n.e(89962),n.e(85256),n.e(63986),n.e(2845),n.e(41574),n.e(92923),n.e(29138),n.e(70290),n.e(70724),n.e(6333),n.e(63558),n.e(78001),n.e(77999),n.e(23741),n.e(90864),n.e(84593),n.e(8163),n.e(74313),n.e(71217),n.e(51427),n.e(14797),n.e(15470),n.e(10813),n.e(38294),n.e(56904)]).then(n.bind(n,208163)),pI=()=>dI.windowFeatures||{};function gI(){const e=()=>null;return{getAppPhases:eI,onRegister:e=>{e.registerTask(new V_)},getAppViewEntities:nI,getAppWindowFeatures:pI,manifest:dI,render:({appRenderMode:t,onRenderEvent:n})=>(0,l.__awaiter)(this,void 0,void 0,(function*(){if(t===t_.S.Main){const e="search-app";n("ChunkLoadStarted",{chunkName:e});const{SearchViewsRenderer:t}=yield(0,ha.mT)(uI,e);n("ChunkLoadSucceeded",{chunkName:e});const{LPC:i}=yield(0,ha.mT)(mI,e);return e_.createElement(n_.f,{namespace:"messaging",loaderRenderer:null},e_.createElement(i,null,e_.createElement(H_.p3,null,e_.createElement(JE.r,null,e_.createElement(t,null)))))}return e_.createElement(e,null)})),onPreWarm:YE,onBeforeCommandHandled:ZE}}const hI={id:"com.microsoft.teams.store",name:"StoreApp",supportedEntities:[ne.p.store],supportedRenderModes:[t_.S.Main],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},vI=e=>{if(fI(e))return yI(e)?{subNavEntity:SI(e),headerEntity:kI(e),startEntity:bI(e),mainEntity:_I(e),endEntity:CI(e)}:null},fI=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[be.lO.focus,be.lO.standard].includes(e),o=[ne.p.store].includes(i),r=n&&[ne.u.default,ne.u.view].includes(n);return!!(a&&o&&r)},yI=()=>!0,SI=()=>null,kI=()=>null,bI=()=>null,_I=({entity:e})=>e,CI=()=>null,wI=()=>Promise.all([n.e(89962),n.e(2845),n.e(41574),n.e(92923),n.e(29138),n.e(38811),n.e(21767),n.e(97725),n.e(21439),n.e(35794),n.e(78001),n.e(77999),n.e(74453),n.e(97130)]).then(n.bind(n,251705));function TI(){const e=()=>null;return{getAppViewEntities:vI,manifest:hI,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:i})=>(0,l.__awaiter)(this,void 0,void 0,(function*(){if(t===t_.S.Main){const e="store-app";n("ChunkLoadStarted",{chunkName:e});const{StoreEntryRenderer:t}=yield(0,ha.mT)(wI,e,i);return n("ChunkLoadSucceeded",{chunkName:e}),e_.createElement(n_.f,{namespace:"extensibility",loaderRenderer:null},e_.createElement(t,null))}return e_.createElement(e,null)}))}}const EI={id:"com.microsoft.teams.linkedin",name:"LinkedInApp",supportedEntities:[ne.p.linkedin],supportedRenderModes:[t_.S.HorizontalBar,t_.S.Main,t_.S.Rail],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},II=e=>{if(NI(e))return AI(e)?{subNavEntity:MI(e),headerEntity:FI(e),startEntity:RI(e),mainEntity:PI(e),endEntity:DI(e)}:null},NI=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[be.lO.focus,be.lO.standard].includes(e),o=[ne.p.linkedin].includes(i),r=n&&[ne.u.create,ne.u.default,ne.u.list,ne.u.view].includes(n);return!!(a&&o&&r)},AI=()=>!0,MI=({entity:e,layoutMode:t})=>t===be.lO.focus?null:e,FI=({entity:e})=>e,RI=()=>null,PI=({entity:e})=>e,DI=()=>null,jI=()=>Promise.all([n.e(89962),n.e(2845),n.e(70290),n.e(82998),n.e(10813),n.e(33586)]).then(n.bind(n,739345));function xI(){const e=()=>null;return{getAppViewEntities:II,manifest:EI,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:i})=>(0,l.__awaiter)(this,void 0,void 0,(function*(){if(t===t_.S.Main){const e="apps-linkedin";n("ChunkLoadStarted",{chunkName:e});const{LinkedIn:t}=yield(0,ha.mT)(jI,e,i);return n("ChunkLoadSucceeded",{chunkName:e}),e_.createElement(t,null)}return e_.createElement(e,null)}))}}const OI={id:"com.microsoft.teams.survey-form",name:"SurveyFormApp",supportedEntities:[ne.p.survey],supportedRenderModes:[t_.S.Main,t_.S.Modal],windowFeatures:{height:450,width:600,minHeight:400,minWidth:600,offset:20}},LI=e=>{if(UI(e))return BI(e)?{subNavEntity:WI(e),headerEntity:HI(e),startEntity:$I(e),mainEntity:VI(e),endEntity:zI(e)}:null},UI=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[be.lO.focus,be.lO.standard].includes(e),o=[ne.p.survey].includes(i),r=n&&[ne.u.default,ne.u.view].includes(n);return!!(a&&o&&r)},BI=()=>!0,WI=()=>null,HI=()=>null,$I=()=>null,VI=({entity:e})=>e,zI=()=>null,GI={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"bootstrapFloodgate"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"firstLoginInformation"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"bootstrapFloodgate"},arguments:[{kind:"Argument",name:{kind:"Name",value:"firstLoginInformation"},value:{kind:"Variable",name:{kind:"Name",value:"firstLoginInformation"}}}]}]}}]},qI={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"onSurveySend"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"onSurveySend"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},JI={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"firstLoginInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"firstLoginInfo"}}]}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"firstLoginInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"FirstLoginInformation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Web"}},{kind:"Field",name:{kind:"Name",value:"electron"}},{kind:"Field",name:{kind:"Name",value:"ios"}},{kind:"Field",name:{kind:"Name",value:"android"}},{kind:"Field",name:{kind:"Name",value:"surfaceHub"}},{kind:"Field",name:{kind:"Name",value:"espFirstRunStarted"}},{kind:"Field",name:{kind:"Name",value:"espFirstRunCompleted"}}]}}]},KI=(e,t,n,i,a)=>({id:"bootstrap-floodgate",runOncePerId:!0,job:()=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){var o;const r=n.newLogger("getBootstrapFloodgateJob");if(r.log("[getBootstrapFloodgateJob] Initializing floodgate"),a)yield t.esp.displaySurface("newSurveyCoachmark");else{try{const n=yield(s=e,(0,l.__awaiter)(void 0,void 0,void 0,(function*(){var e,t;return null===(t=null===(e=(yield s.query({query:JI})).data)||void 0===e?void 0:e.userPreferences)||void 0===t?void 0:t.firstLoginInformation}))),a=null!==(o=null==n?void 0:n.Web)&&void 0!==o?o:"";yield e.mutate({mutation:GI,variables:{firstLoginInformation:a}});const c=yield e.subscribe({query:qI,fetchPolicy:"no-cache"}).subscribe((({data:e,errors:n})=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){n&&r.error("[getBootstrapFloodgateJob] Error subscribing to floodgate"),e&&(yield t.esp.displaySurface("newSurveyCoachmark"),i.newScenario(A.RG.FloodgateSurvey).stop());try{c.unsubscribe()}catch(e){r.error("[getBootstrapFloodgateJob] Error stopping floodgate")}}))))}catch(e){r.error(`[getBootstrapFloodgateJob] Error initializing floodgate [error.name=${null==e?void 0:e.name}]`)}var s;r.log("[getBootstrapFloodgateJob] Floodgate initialized")}}))}),QI=({context:{client:e,coreSettings:t,loggerFactory:n,entityCommanding:i,scenarioFactory:a}})=>{const{enableFloodgateService:o,debugForceFloodgateCampaigns:r}=t.get(b.J.Feedback),s=[],l=e;return o&&s.push(KI(l,i,n,a,null!=r&&r)),s},YI=()=>Promise.all([n.e(89962),n.e(2845),n.e(41574),n.e(16951),n.e(83278),n.e(2404),n.e(73292)]).then(n.bind(n,908268)),XI=({host:e})=>{if(!e)return null;const{height:t=1,width:n=1,minHeight:i,minWidth:a}=OI.windowFeatures||{},o={left:e.screenX,top:e.screenY};if(e.screen){return{left:o.left+e.screen.availWidth/2-n,top:o.top+e.screen.availHeight/2-t,additionalFeatures:{minHeight:`${i}`,minWidth:`${a}`},minHeight:i,minWidth:a}}return{left:o.left,top:o.top,additionalFeatures:{minHeight:`${i}`,minWidth:`${a}`},minHeight:i,minWidth:a}};function ZI(){const e=()=>null;return{getAppViewEntities:LI,getAppWindowFeatures:XI,manifest:OI,render:({appRenderMode:t,scenarioFactory:n})=>(0,l.__awaiter)(this,void 0,void 0,(function*(){if(t===t_.S.Main||t===t_.S.Modal){const e="survey-forms-app",{SurveyViewsContainer:i}=yield(0,ha.mT)(YI,e,n);return e_.createElement(i,{isModal:t===t_.S.Modal})}return e_.createElement(e,null)})),onPreWarm:QI}}const eN=e=>{if(tN(e))return nN(e)?{subNavEntity:iN(e),headerEntity:aN(e),startEntity:oN(e),mainEntity:rN(e),endEntity:sN(e)}:null},tN=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[be.lO.focus,be.lO.standard].includes(e),o=[ne.p.callablechannels].includes(i),r=n&&[ne.u.create,ne.u.default,ne.u.list,ne.u.view].includes(n);return!!(a&&o&&r)},nN=()=>!0,iN=({entity:e})=>e,aN=({entity:e})=>e,oN=()=>null,rN=({entity:e})=>e,sN=()=>null,lN={id:"com.microsoft.teams.callable-channel",name:"CallableChannelApp",supportedEntities:[ne.p.callablechannels],supportedRenderModes:[t_.S.HorizontalBar,t_.S.Main,t_.S.Rail],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},cN=()=>Promise.all([n.e(89962),n.e(2845),n.e(3806),n.e(211),n.e(24526)]).then(n.bind(n,372555)),dN=()=>Promise.all([n.e(89962),n.e(85256),n.e(2845),n.e(92923),n.e(77999),n.e(8163),n.e(3806),n.e(211),n.e(68740)]).then(n.bind(n,306011)),uN=()=>Promise.all([n.e(89962),n.e(85256),n.e(2845),n.e(92923),n.e(77999),n.e(8163),n.e(3806),n.e(211),n.e(68740)]).then(n.bind(n,208163));function mN(){const e=()=>null;return{getAppViewEntities:eN,manifest:lN,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:i})=>(0,l.__awaiter)(this,void 0,void 0,(function*(){if(t===t_.S.Main){const e="callable-channels-app";n("ChunkLoadStarted",{chunkName:e});const{LPC:t}=yield(0,ha.mT)(uN,e,i);n("ChunkLoadSucceeded",{chunkName:e});const[{CallableChannelEntryContainer:a},{CallsTabContextProvider:o}]=yield Promise.all([(0,ha.mT)(cN,e,i),(0,ha.mT)(dN,e,i)]);return e_.createElement(n_.f,{namespaces:["calling","hololens","messaging"],loaderRenderer:null},e_.createElement(t,null,e_.createElement(H_.p3,null,e_.createElement(o,null,e_.createElement(a,null)))))}return e_.createElement(e,null)}))}}const pN={defaultCommand:{type:ne.p.messages,action:ne.u.create},id:"com.microsoft.teams.share",name:"ShareApp",supportedEntities:[ne.p.messages,ne.p.shareformdialog],supportedRenderModes:[t_.S.Main,t_.S.Modal],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}};var gN=n(347434),hN=n(763498),vN=n(503008);const fN=({children:e})=>{const t=gN.YM,{unblockOutlookDesktopIE11:n,unblockSafari:i}=(0,vN.NC)(b.J.Outlook);if(n&&(t.ie=`>=${gN.Zz}`),i&&(t.safari=`>=${gN.hh}`),!((0,hN.H$)(t)||(0,hN.L5)()&&i))throw(0,Z.Tr)("UnsupportedBrowserCheck",S.jK.FeatureNotSupported,"render",void 0,"Unsupported Browser");if(!i&&(0,hN.Qh)())throw(0,Z.Tr)("UnsupportedBrowserCheck",S.jK.FeatureNotSupported,"render",{itpError:!0},"Unsupported Browser (ITP Enabled)");return e_.createElement(e_.Fragment,null,e)},yN=e=>{if(SN(e))return kN(e)?{subNavEntity:bN(e),headerEntity:_N(e),startEntity:CN(e),mainEntity:wN(e),endEntity:TN(e)}:null},SN=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[be.lO.focus,be.lO.standard].includes(e),o=[ne.p.messages,ne.p.shareformdialog].includes(i),r=n&&[ne.u.default,ne.u.view,ne.u.create].includes(n);return!!(a&&o&&r)},kN=()=>!0,bN=()=>null,_N=()=>null,CN=()=>null,wN=({entity:e})=>e,TN=()=>null,EN=({appRenderMode:e})=>{const t=new Z_.H,n=[];return e===t_.S.Main&&n.push(W_.GZ.SHARE_PAGE_RENDERED),t.registerAppPhase({phase:W_.nh.CRITICAL,signals:n,timeout:2e4}),t.appPhases},IN=()=>Promise.all([n.e(89962),n.e(85256),n.e(2845),n.e(41574),n.e(29138),n.e(70724),n.e(36919),n.e(94526),n.e(78001),n.e(77999),n.e(17870),n.e(61385),n.e(90864),n.e(84593),n.e(30644),n.e(54794),n.e(59567),n.e(36378),n.e(46710),n.e(28729)]).then(n.bind(n,257815)),NN=()=>null;function AN(){return{getAppPhases:EN,getAppViewEntities:yN,manifest:pN,onRegister:e=>{e.registerTask(new V_)},render:({appRenderMode:e,scenarioFactory:t})=>(0,l.__awaiter)(this,void 0,void 0,(function*(){if(e===t_.S.Modal||e===t_.S.Main){const e=yield(0,ha.mT)(IN,"share-form",t),{ShareForm:n}=e;return e_.createElement(fN,null,e_.createElement(n,null))}return e_.createElement(NN,null)}))}}const MN={defaultCommand:{type:ne.p.email,action:ne.u.create},id:"com.microsoft.teams.share-email",name:"ShareEmailApp",supportedEntities:[ne.p.email],supportedRenderModes:[t_.S.Main],windowFeatures:{minWidth:530,width:748,minHeight:490,height:691}},FN=e=>{if(RN(e))return PN(e)?{subNavEntity:DN(e),headerEntity:jN(e),startEntity:xN(e),mainEntity:ON(e),endEntity:LN(e)}:null},RN=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[be.lO.focus,be.lO.standard].includes(e),o=[ne.p.email].includes(i),r=n&&[ne.u.default,ne.u.create].includes(n);return!!(a&&o&&r)},PN=()=>!0,DN=()=>null,jN=()=>null,xN=()=>null,ON=({entity:e})=>e,LN=()=>null,UN=({appRenderMode:e})=>{const t=new Z_.H,n=[];return e===t_.S.Main&&n.push(W_.GZ.SHARE_PAGE_RENDERED),t.registerAppPhase({phase:W_.nh.CRITICAL,signals:n,timeout:2e4}),t.appPhases},BN=()=>Promise.all([n.e(89962),n.e(2845),n.e(41574),n.e(29138),n.e(70724),n.e(36919),n.e(78001),n.e(77999),n.e(90864),n.e(84593),n.e(30644),n.e(54794),n.e(59567),n.e(46710),n.e(63686)]).then(n.bind(n,754960)),WN=e=>{e.registerTask(new V_)},HN=({windowOptions:e})=>{var t,n,i,a;return e?{height:e.height,left:e.left,top:e.top,width:e.width}:{minHeight:null===(t=MN.windowFeatures)||void 0===t?void 0:t.height,minWidth:null===(n=MN.windowFeatures)||void 0===n?void 0:n.width,height:null===(i=MN.windowFeatures)||void 0===i?void 0:i.height,width:null===(a=MN.windowFeatures)||void 0===a?void 0:a.width}};function $N(){const e=()=>null;return{getAppPhases:UN,getAppViewEntities:FN,getAppWindowFeatures:HN,manifest:MN,onRegister:WN,render:({appRenderMode:t,scenarioFactory:n})=>(0,l.__awaiter)(this,void 0,void 0,(function*(){if(t===t_.S.Main){const{ShareFormEmail:e}=yield(0,ha.mT)(BN,"share-form-email-entry",n);return e_.createElement(e,null)}return e_.createElement(e,null)}))}}const VN={defaultCommand:{type:ne.p.lobnotifications,action:ne.u.view},id:"com.microsoft.teams.lob-notifications",name:"LobNotificationsApp",supportedEntities:[ne.p.lobnotifications],supportedRenderModes:[t_.S.Main,t_.S.Rail]},zN=e=>{if(GN(e))return qN(e)?{subNavEntity:JN(e),headerEntity:KN(e),startEntity:QN(e),mainEntity:YN(e),endEntity:XN(e)}:null},GN=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[be.lO.focus,be.lO.standard].includes(e),o=[ne.p.lobnotifications].includes(i),r=n&&[ne.u.default,ne.u.view].includes(n);return!!(a&&o&&r)},qN=()=>!0,JN=({entity:e})=>e,KN=()=>null,QN=()=>null,YN=({entity:e})=>e,XN=()=>null,ZN=()=>Promise.all([n.e(89962),n.e(2845),n.e(3806),n.e(211),n.e(21795)]).then(n.bind(n,339978)),eA=()=>Promise.all([n.e(89962),n.e(85256),n.e(2845),n.e(92923),n.e(77999),n.e(8163),n.e(3806),n.e(211),n.e(68740)]).then(n.bind(n,306011));function tA(){const e=()=>null;return{getAppViewEntities:zN,manifest:VN,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:i})=>(0,l.__awaiter)(this,void 0,void 0,(function*(){if(t===t_.S.Main){const e="lob-notifications";n("ChunkLoadStarted",{chunkName:e});const[{LobNotifications:t},{CallsTabContextProvider:a}]=yield Promise.all([(0,ha.mT)(ZN,e,i),(0,ha.mT)(eA,e,i)]);return n("ChunkLoadSucceeded",{chunkName:e}),e_.createElement(n_.f,{namespace:"extensibility",loaderRenderer:null},e_.createElement(a,null,e_.createElement(t,null)))}return e_.createElement(e,null)}))}}const nA=e=>{if(iA(e))return aA(e)?{subNavEntity:oA(e),headerEntity:rA(e),startEntity:sA(e),mainEntity:lA(e),endEntity:cA(e)}:null},iA=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[be.lO.standard].includes(e),o={[ne.p.brbfeedbackdialog]:[ne.u.default,ne.u.view],[ne.p.tpndialog]:[ne.u.default,ne.u.view],[ne.p.signoutdialog]:[ne.u.default,ne.u.view],[ne.p.bannerNotification]:[ne.u.create,ne.u.delete],[ne.p.hybridplaceholder]:[ne.u.default,ne.u.view],[ne.p.updatemsaprofileavatardialog]:[ne.u.default,ne.u.view],[ne.p.updatemsaprofilenamedialog]:[ne.u.default,ne.u.view]},r=n&&(o[i]||[]).includes(n);return!(!a||!r)},aA=()=>!0,oA=({entity:e})=>e,rA=({entity:e})=>e,sA=({entity:e})=>e,lA=({entity:e})=>e,cA=({entity:e})=>e,dA=({areEmptySlotsTransparent:e})=>({[be.tF.subNavEntity]:{[t_.S.VerticalBar]:{areSlotShadowsDisabled:e,isBackgroundTransparent:e,isColorSchemeDefaultBackground6:!e}},[be.tF.headerEntity]:{[t_.S.VerticalBar]:{areSlotShadowsDisabled:e,isBackgroundTransparent:e,isColorSchemeDefaultBackground6:!e}},[be.tF.startEntity]:{[t_.S.VerticalBar]:{areSlotShadowsDisabled:e,isBackgroundTransparent:e,isColorSchemeDefaultBackground6:!e}},[be.tF.mainEntity]:{[t_.S.ThinHorizontalBar]:{isBackgroundTransparent:e},[t_.S.TitleBar]:{isBackgroundTransparent:!0},[t_.S.VerticalBar]:{areSlotShadowsDisabled:e,isBackgroundTransparent:e,isColorSchemeDefaultBackground6:!e}},[be.tF.endEntity]:{[t_.S.Rail]:{isBackgroundTransparent:e}}}),uA={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetBannerNotificationQueue"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"bannerNotificationQueue"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"bannerId"}},{kind:"Field",name:{kind:"Name",value:"source"}},{kind:"Field",name:{kind:"Name",value:"bannerScenario"}},{kind:"Field",name:{kind:"Name",value:"intentLevel"}},{kind:"Field",name:{kind:"Name",value:"cause"}},{kind:"Field",name:{kind:"Name",value:"props"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"text"}},{kind:"Field",name:{kind:"Name",value:"action"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"text"}},{kind:"Field",name:{kind:"Name",value:"action"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"behavior"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dismissable"}},{kind:"Field",name:{kind:"Name",value:"duration"}}]}}]}}]}}]},mA={[Ie.BannerNotificationIntentLevel.MostSevere]:0,[Ie.BannerNotificationIntentLevel.Severe]:1,[Ie.BannerNotificationIntentLevel.Positive]:2,[Ie.BannerNotificationIntentLevel.Neutral]:3},pA=e=>{var t,n,i;const{bannerId:a,source:o,bannerScenario:r,intentLevel:s,cause:l,props:{text:c,action:d},behavior:u}=e;return{__typename:"BannerNotification",bannerId:a,source:o,bannerScenario:null!=r?r:null,intentLevel:s,cause:null!=l?l:null,props:{__typename:"BannerNotificationProperties",text:null!=c?c:null,action:d?{__typename:"BannerNotificationAction",action:d.action,text:null!==(t=d.text)&&void 0!==t?t:null}:null},behavior:{__typename:"BannerNotificationBehavior",dismissable:null!==(n=null==u?void 0:u.dismissable)&&void 0!==n&&n,duration:null!==(i=null==u?void 0:u.duration)&&void 0!==i?i:0}}},gA=(e,t)=>{var n,i;let a=[];try{a=null!==(i=null===(n=t.readQuery({query:uA}))||void 0===n?void 0:n.bannerNotificationQueue)&&void 0!==i?i:[]}catch(t){e.error("Failed to read banner queue from data client cache. ",t)}return a.map(pA)},hA=(e,t,n)=>{const i={bannerNotificationQueue:n.map(pA)};try{t.writeQuery({query:uA,data:i})}catch(t){e.error("Failed to write banner queue to data client cache. ",t)}},vA={[ne.u.create]:(e,t)=>{const{command:{correlation:{source:n}},entityOptions:i,entity:{id:a}}=t,{client:o,loggerFactory:r}=e,s=r.newLogger("addBannerNotificationToQueue"),c=i;if(c){const{text:e,action:t,dismissable:i,duration:r}=c,d=(0,l.__rest)(c,["text","action","dismissable","duration"]);((e,t,n)=>{let i=gA(e,t);i=i.filter((e=>e.bannerId!==n.bannerId)),i.unshift(n),i=i.sort(((e,t)=>mA[e.intentLevel]-mA[t.intentLevel])),hA(e,t,i)})(s,o,Object.assign(Object.assign({},d),{bannerId:a||"no-id",source:n,props:{text:e,action:t},behavior:{dismissable:i,duration:r}}))}else s.error("entityOptions is missing IBannerNotificationOptions fields. ",i);return Promise.resolve(void 0)},[ne.u.delete]:(e,t)=>{const{entity:{id:n}}=t,{client:i,loggerFactory:a}=e,o=a.newLogger("removeBannerNotificationFromQueue");return n&&((e,t,n)=>{let i=gA(e,t);i=i.filter((e=>e.bannerId!==n)),hA(e,t,i)})(o,i,n),Promise.resolve(void 0)}},fA=e=>{const{entityCommand:t,entityCommand:{entity:{type:n,action:i}},requestContext:a}=e;if(n===ne.p.bannerNotification){const e=vA[i];if(e)return e(a,t)}return Promise.resolve(t)};function yA(e){const{hostCommunicationService:t,loggerFactory:n}=e,i=n.newLogger("auth-notification-job");return{id:"auth-notification",runOncePerId:!0,job:()=>(0,l.__awaiter)(this,void 0,void 0,(function*(){var e;const n=(0,Be.v4)();try{i.debug(`Sending webAuthSucceeded notification start. CorrelationId: ${n}.`);const a=yield t.loadModule("auth");null===(e=null==a?void 0:a.webAuthSucceeded)||void 0===e||e.call(a,{correlationId:n}),i.debug(`Sending webAuthSucceeded notification complete. CorrelationId: ${n}.`)}catch(e){throw i.error(`Sending webAuthSucceeded notification failed. CorrelationId: ${n}. Error: ${(0,P.u4)(e)}`),e}}))}}const SA={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"OnAuthenticationStateChanged"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationStateChanged"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationState"}}]}}]}}]},kA={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"authenticationUsers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationUsers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isAuthenticated"}},{kind:"Field",name:{kind:"Name",value:"profile"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}}]}}]}}]}}]};function bA(e,t){const{client:n,entityCommanding:i,i18n:a,loggerFactory:o}=e,r=o.newLogger("auth-state-job"),s=n,c="auth-banner";let d=!0;return{id:"auth-state-subscription",job:()=>{s.subscribe({query:SA}).filter((e=>{var t,n;return!!(null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.authenticationStateChanged)||void 0===n?void 0:n.authenticationState)})).subscribe((e=>(0,l.__awaiter)(this,void 0,void 0,(function*(){var n,o,l,u;const m=yield s.query({query:kA});if(0===(null===(o=null===(n=null==m?void 0:m.data)||void 0===n?void 0:n.authenticationUsers)||void 0===o?void 0:o.length))return void r.warn("No authenticated user found, not displaying auth-banner.");const p=null===(u=null===(l=null==e?void 0:e.data)||void 0===l?void 0:l.authenticationStateChanged)||void 0===u?void 0:u.authenticationState;switch(p){case Ie.AuthenticationState.AADReconnecting:case Ie.AuthenticationState.SkypeReconnecting:!function(e,t,n,i){let a="",o="";t===Ie.AuthenticationState.AADReconnecting?(a=n.stringTranslate("auth","aad_reconnecting_text"),o="auth_aad_reconnecting"):t===Ie.AuthenticationState.SkypeReconnecting&&(a=n.stringTranslate("auth","skype_reconnecting_text"),o="auth_skype_reconnecting");i.shell.showBanner({id:e,source:k.D.ShellAuthState,intentLevel:Ie.BannerNotificationIntentLevel.Neutral,text:a,dismissable:!0,duration:0,bannerScenario:o})}(c,p,a,i);break;case Ie.AuthenticationState.InteractionRequired:!function(e,t,n){n.shell.showBanner({id:e,source:k.D.ShellAuthState,bannerScenario:"auth_sign_in_required",intentLevel:Ie.BannerNotificationIntentLevel.MostSevere,cause:Ie.BannerNotificationCause.AuthError,text:t.stringTranslate("auth","sign_in_required_text"),action:{text:t.stringTranslate("auth","sign_in_required_cta_text"),action:Ie.BannerNotificationActionType.SignIn},dismissable:!1,duration:0})}(c,a,i);break;case Ie.AuthenticationState.Up:default:!d&&i.shell.dismissBanner(c,k.D.ShellAuthState)}t&&t(),d=!1}))))}}}const _A="offline banner";function CA(e){const{coreSettings:t,entityCommanding:n,i18n:i,loggerFactory:a,networkState:o}=e,r=a.newLogger("network-state-subscription-logger");let s=!0;return{id:"network-state-subscription",job:()=>{t.get(b.J.Core).enableNetworkStateBannerSubscription?o.observe().subscribe((e=>{e===Hi.Offline?(r.debug("showing offline banner"),n.shell.showBanner({id:_A,source:k.D.ShellNetworkState,bannerScenario:"framework_offline_banner",intentLevel:Ie.BannerNotificationIntentLevel.Severe,cause:Ie.BannerNotificationCause.Offline,text:i.stringTranslate("framework","offline_banner_message"),dismissable:!1,duration:0})):s||(r.debug("dismissing offline banner"),n.shell.dismissBanner(_A,k.D.ShellNetworkState)),s=!1})):r.log("network state banner subscription is disabled")}}}const wA={id:"com.microsoft.teams.shell",name:"Shell",supportedEntities:[ne.p.bannerNotification,ne.p.brbfeedbackdialog,ne.p.hybridplaceholder,ne.p.signoutdialog,ne.p.tpndialog,ne.p.updatemsaprofileavatardialog,ne.p.updatemsaprofilenamedialog],supportedRenderModes:[t_.S.Main,t_.S.Modal,t_.S.Rail,t_.S.ThinHorizontalBar,t_.S.TitleBar,t_.S.VerticalBar],windowFeatures:{minWidth:602,width:602,minHeight:500,height:500,offset:20}},TA=()=>Promise.all([n.e(89962),n.e(2845),n.e(41574),n.e(29138),n.e(70290),n.e(38811),n.e(21439),n.e(6222),n.e(13662),n.e(78001),n.e(77999),n.e(23741),n.e(47579),n.e(5271)]).then(n.bind(n,145734)),EA=()=>Promise.all([n.e(89962),n.e(2845),n.e(41574),n.e(24840),n.e(2404),n.e(97526)]).then(n.bind(n,695579)),IA=({host:e,screenState:t,isResize:n})=>{if(n){if(!wA.windowFeatures)return null;const e=wA.windowFeatures,{offset:t}=e;return(0,l.__rest)(e,["offset"])}const{height:i,minHeight:a,minWidth:o,offset:r,width:s}=wA.windowFeatures||{},c={left:(null==e?void 0:e.screenX)||0,top:(null==e?void 0:e.screenY)||0},d=((null==t?void 0:t.numOpenWindows)||1)*(r||1);return{additionalFeatures:{minHeight:`${a}`,minWidth:`${o}`},height:i,left:(null==c?void 0:c.left)+d,minHeight:a,minWidth:o,top:(null==c?void 0:c.top)+d,width:s}};function NA(e){return{getAppViewEntities:nA,getAppViewEntitiesProps:dA,getAppWindowFeatures:IA,manifest:wA,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:i})=>(0,l.__awaiter)(this,void 0,void 0,(function*(){let a;if(e&&e.isMainWindow){const e="shell-app";n("ChunkLoadStarted",{chunkName:e}),a=(yield(0,ha.mT)(TA,e,i)).MainWindowShellViewsRenderer,n("ChunkLoadSucceeded",{chunkName:e})}else{const e="mw-shell-app";n("ChunkLoadStarted",{chunkName:e}),a=(yield(0,ha.mT)(EA,e,i)).ChildWindowShellViewsRenderer,n("ChunkLoadSucceeded",{chunkName:e})}return e_.createElement(a,{appRenderMode:t})})),onPreWarm:e=>{const{context:t}=e;return[yA(t),bA(t),CA(t)]},onBeforeCommandHandled:fA}}const AA=e=>{if(MA(e))return FA(e)?{subNavEntity:RA(e),headerEntity:PA(e),startEntity:DA(e),mainEntity:jA(e),endEntity:xA(e)}:null},MA=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[be.lO.standard,be.lO.focus].includes(e),o=n&&[ne.u.create,ne.u.default,ne.u.view].includes(n),r=[ne.p.calendar,ne.p.schedulingform].includes(i),s=ne.p.schedulingform!==i&&ne.u.view===n&&be.lO.focus===e;return!(!(a&&r&&o)||s)},FA=()=>!0,RA=()=>null,PA=({entity:e,coreSettings:t})=>{const n=null==t?void 0:t.get(b.J.Calendar).enableCalendarSchedulingFormMultiSlot,i=null==t?void 0:t.get(b.J.Calendar).enableFluentCalendarSurface,a=!!n&&e.type===ne.p.schedulingform,o=!!i&&e.type===ne.p.calendar;return a||o?e:null},DA=()=>null,jA=({entity:e})=>e,xA=()=>null,OA={id:"com.microsoft.teams.calendar",name:"CalendarApp",supportedEntities:[ne.p.calendar,ne.p.schedulingform,ne.p.connectedcalendardialog],supportedRenderModes:[t_.S.Main,t_.S.HorizontalBar,t_.S.Modal],defaultCommand:{type:ne.p.calendar,action:ne.u.default},windowFeatures:{minWidth:565,width:1241,minHeight:720,height:720}},LA=()=>Promise.all([n.e(89962),n.e(2845),n.e(41574),n.e(92923),n.e(29138),n.e(70290),n.e(70724),n.e(7001),n.e(4400),n.e(59411),n.e(22184),n.e(6333),n.e(16951),n.e(95595),n.e(51928),n.e(78001),n.e(77999),n.e(23741),n.e(90864),n.e(10813),n.e(32606),n.e(35922),n.e(68413),n.e(10523),n.e(81e3),n.e(55531),n.e(81469),n.e(41292),n.e(68778)]).then(n.bind(n,127105)),UA=()=>OA.windowFeatures||{};function BA(){return{getAppViewEntities:AA,getAppWindowFeatures:UA,getCommandScenarioName:WA,manifest:OA,render:({appRenderMode:e,onRenderEvent:t,scenarioFactory:n})=>(0,l.__awaiter)(this,void 0,void 0,(function*(){const i="calendar-app";t("ChunkLoadStarted",{chunkName:i});const{CalendarViewsRenderer:a}=yield(0,ha.mT)(LA,i,n);return t("ChunkLoadSucceeded",{chunkName:i}),e_.createElement(n_.f,{namespaces:["calendar","compose"],loaderRenderer:null},e_.createElement(a,{appRenderMode:e,onRenderEvent:t,scenarioFactory:n}))}))}}const WA=e=>e.entity.type===ne.p.schedulingform?A.RG.CalSchedulingFormLoad:A.RG.CalendarLoad,HA=e=>{if($A(e))return VA(e)?{subNavEntity:zA(e),headerEntity:GA(e),startEntity:qA(e),mainEntity:JA(e),endEntity:KA(e)}:null},$A=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[be.lO.focus,be.lO.standard].includes(e),o=[ne.p.transcriptcontent].includes(i),r=n&&[ne.u.default,ne.u.view].includes(n);return!!(a&&o&&r)},VA=()=>!0,zA=()=>null,GA=()=>null,qA=()=>null,JA=({entity:e})=>e,KA=()=>null,QA={id:"com.microsoft.teams.transcript-content",name:"TranscriptContentApp",supportedEntities:[ne.p.transcriptcontent],supportedRenderModes:[t_.S.Main],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},YA="transcript-content-app",XA=()=>Promise.all([n.e(89962),n.e(2845),n.e(2404),n.e(3806),n.e(211),n.e(3275)]).then(n.bind(n,561183)),ZA=()=>Promise.all([n.e(89962),n.e(85256),n.e(2845),n.e(92923),n.e(77999),n.e(8163),n.e(3806),n.e(211),n.e(68740)]).then(n.bind(n,306011));function eM(){const e=()=>null;return{getAppViewEntities:HA,manifest:QA,render:({appRenderMode:t,scenarioFactory:n})=>(0,l.__awaiter)(this,void 0,void 0,(function*(){if(t===t_.S.Main){const[{TranscriptContentViews:e},{CallsTabContextProvider:t}]=yield Promise.all([(0,ha.mT)(XA,YA,n),(0,ha.mT)(ZA,YA,n)]);return e_.createElement(n_.f,{namespace:"calling",loaderRenderer:null},e_.createElement(t,null,e_.createElement(e,null)))}return e_.createElement(e,null)}))}}const tM=e=>{if(nM(e))return iM(e)?{subNavEntity:aM(e),headerEntity:oM(e),startEntity:rM(e),mainEntity:sM(e),endEntity:lM(e)}:null},nM=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[be.lO.focus,be.lO.standard].includes(e),o=[ne.p.annotation].includes(i),r=n&&[ne.u.default,ne.u.view].includes(n);return!!(a&&o&&r)},iM=()=>!0,aM=()=>null,oM=()=>null,rM=()=>null,sM=({entity:e})=>e,lM=()=>null,cM=()=>({[be.tF.mainEntity]:{[t_.S.Main]:{isBackgroundTransparent:!0,isThemePinnedToDarkOrHighContrast:!0,isSlotBackgroundTransparent:!0}}}),dM={id:"com.microsoft.teams.annotation",name:"AnnotationApp",supportedEntities:[ne.p.annotation],supportedRenderModes:[t_.S.Main],windowFeatures:{height:720,width:1080,minHeight:720,minWidth:1080}},uM=()=>Promise.all([n.e(89962),n.e(2845),n.e(35270),n.e(17870),n.e(61385),n.e(2404),n.e(93438),n.e(17262),n.e(88357)]).then(n.bind(n,351258)),mM=()=>({additionalFeatures:{alwaysOnTop:"true",excludeWindowFromScreenSharing:"true",transparent:"true",hideWindowControl:"true"},top:0,left:0,width:1080,height:720,minWidth:640,minHeight:360,fullscreen:!0});function pM(){const e=()=>null;return{getAppViewEntities:tM,getAppViewEntitiesProps:cM,getAppWindowFeatures:mM,manifest:dM,render:({appRenderMode:t,scenarioFactory:n})=>(0,l.__awaiter)(this,void 0,void 0,(function*(){if(t===t_.S.Main){const{Annotation:e}=yield(0,ha.mT)(uM,"annotation-app",n);return e_.createElement(n_.f,{namespace:"calling",loaderRenderer:null},e_.createElement(e,null))}return e_.createElement(e,null)}))}}const gM=e=>{if(hM(e))return vM(e)?{subNavEntity:fM(e),headerEntity:yM(e),startEntity:SM(e),mainEntity:kM(e),endEntity:bM(e)}:null},hM=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[be.lO.focus,be.lO.standard].includes(e),o=[ne.p.registration].includes(i),r=n&&[ne.u.default,ne.u.view].includes(n);return!!(a&&o&&r)},vM=()=>!0,fM=()=>null,yM=()=>null,SM=()=>null,kM=({entity:e})=>e,bM=()=>null,_M={defaultCommand:{type:ne.p.registration,action:ne.u.view},id:"com.microsoft.teams.webinar-registration",name:"WebinarRegistrationApp",supportedRenderModes:[t_.S.Main],supportedEntities:[ne.p.registration],windowFeatures:{minWidth:1140,width:1140,minHeight:720,height:720}},CM=()=>Promise.all([n.e(89962),n.e(85256),n.e(61874),n.e(84564),n.e(2845),n.e(41574),n.e(92923),n.e(29138),n.e(38811),n.e(68865),n.e(29084),n.e(87851),n.e(71824),n.e(23741),n.e(84593),n.e(54794),n.e(54937)]).then(n.bind(n,845446)),wM=()=>_M.windowFeatures||{};function TM(){const e=()=>null;return{getAppViewEntities:gM,getAppWindowFeatures:wM,manifest:_M,render:({appRenderMode:t})=>(0,l.__awaiter)(this,void 0,void 0,(function*(){if(t===t_.S.Main){const e="webinar-registration-app",{WebinarRegistrationViewsRenderer:t}=yield(0,ha.mT)(CM,e);return e_.createElement(n_.f,{namespaces:["compose","webinar"],loaderRenderer:null},e_.createElement(t,null))}return e_.createElement(e,null)}))}}const EM={id:"com.microsoft.teams.meeting-room-console",name:"MeetingRoomConsoleApp",supportedEntities:[ne.p.meetingroomconsolecall],supportedRenderModes:[t_.S.Main],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},IM=e=>{if(NM(e))return AM(e)?{subNavEntity:MM(e),headerEntity:FM(e),startEntity:RM(e),mainEntity:PM(e),endEntity:DM(e)}:null},NM=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[be.lO.focus,be.lO.standard].includes(e),o=[ne.p.meetingroomconsolecall].includes(i),r=n&&[ne.u.default,ne.u.view].includes(n);return!!(a&&o&&r)},AM=()=>!0,MM=()=>null,FM=()=>null,RM=()=>null,PM=({entity:e})=>e,DM=()=>null,jM=()=>Promise.all([n.e(89962),n.e(85256),n.e(2845),n.e(41574),n.e(92923),n.e(29138),n.e(7001),n.e(98314),n.e(78001),n.e(77999),n.e(58254),n.e(81391),n.e(30644),n.e(93438),n.e(51217),n.e(3806),n.e(51427),n.e(37498),n.e(65665),n.e(71711),n.e(79065),n.e(44225)]).then(n.bind(n,533753));function xM(){const e=()=>null;return{getAppViewEntities:IM,manifest:EM,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:i})=>(0,l.__awaiter)(this,void 0,void 0,(function*(){if(t===t_.S.Main){const e="meeting-room-console-app";n("ChunkLoadStarted",{chunkName:e});const{MeetingRoomConsoleEntry:t}=yield(0,ha.mT)(jM,e,i);return e_.createElement(t,null)}return e_.createElement(e,null)}))}}const OM={id:"com.microsoft.teams.guardians",name:"GuardiansApp",supportedEntities:[ne.p.guardians],supportedRenderModes:[t_.S.HorizontalBar,t_.S.Main,t_.S.Rail],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},LM=e=>{if(UM(e))return BM(e)?{subNavEntity:WM(e),headerEntity:HM(e),startEntity:$M(e),mainEntity:VM(e),endEntity:zM(e)}:null},UM=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[be.lO.focus,be.lO.standard].includes(e),o=[ne.p.guardians].includes(i),r=n&&[ne.u.list].includes(n);return!!(a&&o&&r)},BM=()=>!0,WM=({entity:e,layoutMode:t})=>t===be.lO.focus?null:e,HM=({entity:e})=>e,$M=()=>null,VM=({entity:e})=>e,zM=()=>null,GM=({appRenderMode:e})=>{const t=new Z_.H,n=[],i=[];switch(e){case t_.S.Main:qM({criticalSignals:n,postCriticalSignals:i,featureFlags:{}});break;case t_.S.HorizontalBar:case t_.S.Rail:}return t.registerAppPhase({phase:W_.nh.CRITICAL,signals:n,timeout:3e4}),t.appPhases},qM=({criticalSignals:e})=>{e.push(W_.GZ.GUARDIANS_TABLE_RENDERED)},JM=()=>Promise.all([n.e(89962),n.e(85256),n.e(2845),n.e(41574),n.e(92923),n.e(29138),n.e(21767),n.e(97725),n.e(78001),n.e(77999),n.e(8163),n.e(47579),n.e(17848),n.e(29861)]).then(n.bind(n,683153)),KM=()=>Promise.all([n.e(89962),n.e(85256),n.e(2845),n.e(41574),n.e(92923),n.e(29138),n.e(21767),n.e(97725),n.e(78001),n.e(77999),n.e(8163),n.e(47579),n.e(17848),n.e(29861)]).then(n.bind(n,208163));function QM(){return{getAppPhases:GM,getAppViewEntities:LM,manifest:OM,render:({appRenderMode:e,onRenderEvent:t})=>(0,l.__awaiter)(this,void 0,void 0,(function*(){const n="guardians-app";t("ChunkLoadStarted",{chunkName:n});const[{GuardiansAppViews:i},{LPC:a}]=yield Promise.all([(0,ha.mT)(JM,n),(0,ha.mT)(KM,n)]);return t("ChunkLoadSucceeded",{chunkName:n}),e_.createElement(a,null,e_.createElement(H_.p3,null,e_.createElement(i,{appRenderMode:e})))}))}}const YM={id:"com.microsoft.teams.esp",name:"EspApp",supportedEntities:[ne.p.esp],supportedRenderModes:[t_.S.Modal],defaultCommand:{type:ne.p.esp,action:ne.u.default},windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},XM=()=>Promise.all([n.e(92923),n.e(35874),n.e(66725)]).then(n.bind(n,543181)),ZM=e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){return(0,ha.mT)(XM,"esp-engine",e)}));function eF(e){const{client:t,coreSettings:n,entityCommanding:i,loggerFactory:a,platformService:o,scenarioFactory:r}=e;return{id:"start-esp",runOncePerId:!0,job:()=>(0,l.__awaiter)(this,void 0,void 0,(function*(){const{enableEsp:e,enableEspAppReadyTrigger:s}=n.get(b.J.Esp);if(!e||!s)return;const l=r.newScenario(A.RG.EspAppReady);try{const{displayEspSurface:e}=yield ZM(r),s=yield e(t,n,a,o);if(l.stop(),s){const{entity:{id:e}}=s;e&&i.esp.launchDialog(e)}}catch(e){l.fail()}}))}}const tF=e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{entityCommand:t,entityCommand:{entity:{type:n,action:i,id:a}},requestContext:{client:o,coreSettings:r,loggerFactory:s,platformService:l,scenarioFactory:c}}=e,{enableEsp:d}=r.get(b.J.Esp),u=a||void 0;if(d&&n===ne.p.esp&&i===ne.u.create){const e=c.newScenario(A.RG.EspDisplaySurface);let n=t;try{const{displayEspSurface:t}=yield ZM(c);n=yield t(o,r,s,l,u),e.stop({surfaceId:u})}catch(t){e.fail({surfaceId:u})}return n}return t})),nF=()=>Promise.all([n.e(89962),n.e(2845),n.e(2404),n.e(49736)]).then(n.bind(n,790432));function iF(){const e=()=>null;return{manifest:YM,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:i})=>(0,l.__awaiter)(this,void 0,void 0,(function*(){if(t===t_.S.Modal){const e="esp-dialog";n("ChunkLoadStarted",{chunkName:e});const{EspDialogComponent:t}=yield(0,ha.mT)(nF,e,i);return n("ChunkLoadSucceeded",{chunkName:e}),e_.createElement(t,null)}return e_.createElement(e,null)})),onPreWarm:e=>{const{context:t}=e;return[eF(t)]},onBeforeCommandHandled:tF}}const aF={calling:{isCallingScreenInteractive:[{entityType:["callscontent","callsgallery","callsgalleryandcontent"],value:!1}],isCallingAlertDismissEnabled:[{entityType:["callscontent","callsgallery","callsgalleryandcontent"],value:!1}],allowMultipleCallingAlertBanners:[{entityType:["callscontent","callsgallery","callsgalleryandcontent","meetingroomconsolecall"],value:!1}],isParticipantRosterDialogSupported:[{entityType:["meetingroomconsolecall"],value:!0}],isMeetingRoomCallingRoster:[{entityType:["meetingroomconsolecall"],value:!0}],isMeetingRoomConsoleUbar:[{entityType:["meetingroomconsolecall"],value:!0}],isMeetingRoomConsoleHome:[{entityType:["meetingroomconsolecall"],value:!0}],isMeetingRoomConsoleCalendar:[{entityType:["meetingroomconsolecall"],value:!0}],isMeetingRoomCallingAlerts:[{entityType:["meetingroomconsolecall"],value:!0}],isTouchOnlySmallDisplay:[{entityType:["meetingroomconsolecall"],value:!0}],allowMultiWindowPinningParticipant:[{entityType:["callscontent","callsgallery","callsgalleryandcontent","meetingroomconsolecall"],value:!0}],allowPinningParticipantFromOutside:[{entityType:["callsgallery","callsgalleryandcontent"],value:!0}],isPtzCameraControlStateSupported:[{entityType:["callsgallery","callsgalleryandcontent"],value:!0}],allowGalleryToggleFromOutside:[{entityType:["callsgallery","callsgalleryandcontent"],value:!0}],isCallingAlertActionEnabled:[{entityType:["callscontent","callsgallery","callsgalleryandcontent","meetingroomconsolecall"],value:!1}],isContentSharingShownOnCallingScreen:[{entityType:["callsgallery"],value:!1}],isContentOnlyCallingScreen:[{entityType:["callscontent","stagecontent"],value:!0}],isLayoutSwitcherSupported:[{entityType:["callsgalleryandcontent"],value:!0}],showAllCallingAlertsAsBanner:[{entityType:["callscontent","callsgallery","callsgalleryandcontent","meetingroomconsolecall"],value:!0}],isContentCameraSharingSupported:[{entityType:["callscontent","callsgallery","callsgalleryandcontent"],value:!0}],isIncomingCallScreenSupported:[{entityType:["callsgallery","callsgalleryandcontent"],value:!0}],enableCallCloseHook:[{entityType:["stagecontent"],value:!1}],enableMeetingReactions:[{entityType:["stagecontent"],value:!1}]},core:{isHeaderDisabled:[{viewportContext:["iFrame"],value:!0}],launchPlatformBIMDialog:[{viewportContext:["iFrame"],value:!0}],isNotificationBannerDisabled:[{viewportContext:["iFrame"],value:!0}],enableWaitForRouteOnSlotTransition:[{viewportContext:["iFrame"],value:!0}],isBorderDisabled:[{viewportContext:["iFrame"],value:!0}],enableTitleBar:[{entityType:["annotation","callscontent","callsgallery","callsgalleryandcontent"],value:!1},{viewportContext:["iFrame"],value:!1}],disableTitleBarForIframe:[{viewportContext:["iFrame"],value:!0}]},search:{enableChannelsInUnifiedSearch:[{entityType:["email"],value:!0}],enablePeopleSearchV2:[{entityType:["email"],value:!0}],enableChatSearchByPartialMembers:[{entityType:["email"],value:!0}],enableRemoveChatDisabledUsers:[{entityType:["email"],value:!0}],enableLoadingSpinnerAtTop:[{entityType:["email"],value:!0}],resultLimitPerSuggestionType:[{entityType:["email"],value:12}],enableEagerSeedSuggestions:[{entityType:["email"],value:!0}],showTopEagerSeedSuggestions:[{entityType:["email"],value:!0}],scenarioName3S:[{entityType:["email"],value:"sharetoteams"}]},auth:{enableLoginFlow:[{viewportContext:["primary"],value:!0}],skipAmsAuthRequest:[{viewportContext:["primary"],value:!1}]},extensibility:{enableAtGetBots:[{entityType:["email"],value:!1}],enableTabsInChannels:[{viewportContext:["secondary"],value:!1}]},files:{showPreferenceDialog:[{viewportContext:["iFrame"],value:!0}],setMessageListenersOnHostForSuperPicker:[{viewportContext:["iFrame"],value:!0}],enablePopups:[{viewportContext:["iFrame"],value:!0}],loadItemsViewStringsFromHost:[{viewportContext:["iFrame"],value:!0}]},messaging:{fluidIsRenderingInPopout:[{viewportContext:["secondary"],value:!0}],isHeaderDisabled:[{viewportContext:["iFrame"],value:!0}],enableChatHeaderPopoutButton:[{viewportContext:["iFrame"],value:!0}],enableChatHeaderMeetingDetailsButton:[{viewportContext:["iFrame"],value:!0}],inlineVideoIsRenderingInPopout:[{viewportContext:["secondary"],value:!0}],notifyMessageListRender:[{viewportContext:["iFrame"],value:!0}],showSingeMessageView:[{viewportContext:["iFrame"],value:!0}],setFocusOnImmersiveReaderClose:[{viewportContext:["iFrame"],value:!1}],enableComposeCriticalPhaseLoadSecondaryViewport:[{viewportContext:["secondary"],value:!1}],enableDraftImageWithServiceWorker:[{viewportContext:["secondary"],value:!1}],entityCommandingTransitionForceFlush:[{viewportContext:["iFrame"],value:!0}],enableLogUnsupportedContent:[{viewportContext:["iFrame"],value:!0}],sendDiscardConversationHideCommand:[{viewportContext:["iFrame"],value:!1}],enableSaveNewChatSelectedUsersOnMainWindow:[{viewportContext:["iFrame"],value:!0}]},csaService:{enableV3ChatsAPI:[{entityType:["email"],value:!0}]},shortcuts:{shortcutsForIframe:[{viewportContext:["iFrame"],value:!0}],shortcutsForPopout:[{viewportContext:["secondary"],value:!0}]},broadcast:{isRenderingInEmbedMode:[{viewportContext:["iFrame"],value:!0},{viewportContext:["primary"],value:!1}]},calendar:{enableCalendarBIMSpecificOperations:[{viewportContext:["iFrame"],value:!0}]},channels:{showCloseButtonInChannelsRepliesPane:[{viewportContext:["iFrame","primary"],value:!0}],allowPostPopout:[{viewportContext:["iFrame","primary"],value:!0}]},cortana:{isCortanaEnabled:[{entityType:["callsgallery","callsgalleryandcontent"],value:!0}]}},oF={mappings:{calling:{allowPrivateCallingPolicy:{name:"callingPolicy.allowPrivateCalling"},myPhoneNumber:{name:"voiceAdminSettings.phoneNumber"},voiceAdminSettings:{name:"voiceAdminSettings"},delegationSettingsPolicy:{name:"voiceAdminSettings.delegationSettings"},dialPlanPolicy:{name:"policySettings.dialPlanPolicy"},safeTransferPolicy:{name:"callingPolicy.safeTransferEnabled"},allowCloudRecordingPolicy:{name:"meetingPolicy.allowCloudRecording"},allowRecordingStorageOutsideRegion:{name:"meetingPolicy.allowRecordingStorageOutsideRegion"},recordingStorageMode:{name:"meetingPolicy.recordingStorageMode"},allowCloudRecordingForCallsPolicy:{name:"callingPolicy.allowCloudRecordingForCalls"},closedCaptionsPolicy:{name:"meetingPolicy.liveCaptionsEnabledType"},enableCoachByPolicy:{name:"meetingPolicy.allowMeetingCoach"},isPptSharingAllowedByPolicy:{name:"meetingPolicy.allowPowerPointSharing"},areMeetingNotesEnabledByPolicy:{name:"meetingPolicy.allowSharedNotes"},customVideoBackgroundsFilterByPolicy:{name:"meetingPolicy.videoFiltersMode"},screenSharingModePolicy:{name:"meetingPolicy.screenSharingMode"},meetingChatEnableTypePolicy:{name:"meetingPolicy.meetingChatEnableType"},allowPrivateMeetingSchedulingPolicy:{name:"meetingPolicy.allowPrivateMeetingScheduling"},allowMeetNowPolicy:{name:"meetingPolicy.allowMeetNow"},isVideoAllowedByPolicy:{name:"meetingPolicy.allowIPVideo"},enableCallTranscriptByPolicy:{name:"meetingPolicy.allowTranscription"},enableCallTranscriptInCallsByPolicy:{name:"callingPolicy.allowTranscriptionForCalling"}},extensibility:{isSideLoadingInteractionEnabled:{name:"tenantSettingsV2.apps.isSideLoadingInteractionEnabled"},storeAppTenantBackground:{name:"tenantSettingsV2.apps.lobBackground"},storeAppTenantLogo:{name:"tenantSettingsV2.apps.lobLogo"},storeAppTenantTextColor:{name:"tenantSettingsV2.apps.lobTextColor"},storeAppTenantIcon:{name:"tenantSettingsV2.apps.lobLogomark"}},files:{nativeFileEntryPoints:{name:"filesPolicy.nativeFileEntryPoints",defaultValue:"Enabled"}},messaging:{allowPasteInternetImage:{name:"messagingPolicy.allowPasteInternetImage",defaultValue:!0},EnableUpToEditInMW:{name:"messagingPolicy.allowUserEditMessage",defaultValue:!0},allowUserEditMessage:{name:"messagingPolicy.allowUserEditMessage",defaultValue:!0},allowGiphy:{name:"messagingPolicy.allowGiphy",defaultValue:!0},allowGiphyDisplay:{name:"messagingPolicy.allowGiphyDisplay",defaultValue:!0},allowStickers:{name:"messagingPolicy.allowStickers",defaultValue:!0},giphyRatingType:{name:"messagingPolicy.giphyRatingType",defaultValue:"Moderate"},allowPriorityMessages:{name:"messagingPolicy.allowPriorityMessages",defaultValue:!0},allowImmersiveReader:{name:"messagingPolicy.allowImmersiveReader",defaultValue:!0},allowUserChat:{name:"messagingPolicy.allowUserChat",defaultValue:!0},allowRemoveUser:{name:"messagingPolicy.allowRemoveUser",defaultValue:!0},areUrlPreviewsAllowed:{name:"messagingPolicy.allowUrlPreviews",defaultValue:!0},allowUserDeleteMessage:{name:"messagingPolicy.allowUserDeleteMessage",defaultValue:!0},enableSms:{name:"voiceAdminSettings.isSmsEnabled"},allowFluidCollaborate:{name:"messagingPolicy.allowFluidCollaborate",defaultValue:!1},allowPrivateMeetingSchedulingPolicy:{name:"meetingPolicy.allowPrivateMeetingScheduling"},isMailboxDiscoverable:{name:"userPropertiesSettings.isMailboxDiscoverable"},isOnCloud:{name:"userPropertiesSettings.isOnCloud"},autodiscoverSettings:{name:"userPropertiesSettings.autodiscoverSettings"},receiptsEnabledType:{name:"messagingPolicy.readReceiptsEnabledType",defaultValue:"UserPreference"},allowSmartReply:{name:"messagingPolicy.allowSmartReply",defaultValue:!0},useQuickRepliesSchema:{name:"messagingPolicy.allowSmartReply",defaultValue:!0},enableSmartRepliesForGroupChat:{name:"messagingPolicy.allowSmartReply",defaultValue:!0},enableSmartFilesSuggestions:{name:"messagingPolicy.allowSmartReply",defaultValue:!0},allowMemes:{name:"messagingPolicy.allowMemes",defaultValue:!0},allowUserTranslation:{name:"messagingPolicy.allowUserTranslation",defaultValue:!1},chatPermissionRole:{name:"messagingPolicy.chatPermissionRole",defaultValue:"Restricted"},allowFullChatPermissionUserToDeleteAnyMessage:{name:"messagingPolicy.allowFullChatPermissionUserToDeleteAnyMessage",defaultValue:!1},allowOwnerDeleteMessage:{name:"messagingPolicy.allowOwnerDeleteMessage",defaultValue:!0},userInitiatedMode:{name:"feedbackPolicy.userInitiatedMode"},enableTeamsConsumerAccess:{name:"externalAccessPolicy.enableTeamsConsumerAccess",defaultValue:!0}},broadcast:{sdnConfiguration:{name:"broadcastMeetingPolicy.broadcastMeetingSDNConfigurationJsonBlob"}},chat:{allowRoleBasedChatPermissions:{name:"clientSettings.allowRoleBasedChatPermissions",defaultValue:!1}},teamsAndChannels:{allowPrivateChannelCreation:{name:"teamsAndChannelsPolicy.allowPrivateChannelCreation"},allowPrivateTeamDiscovery:{name:"teamsAndChannelsPolicy.allowPrivateTeamDiscovery"},allowOrgWideTeamCreation:{name:"teamsAndChannelsPolicy.allowOrgWideTeamCreation"}},calendar:{allowPrivateMeetingSchedulingPolicy:{name:"meetingPolicy.allowPrivateMeetingScheduling"},allowChannelMeetingSchedulingPolicy:{name:"meetingPolicy.allowChannelMeetingScheduling"},isOnCloud:{name:"userPropertiesSettings.isOnCloud"},allowEngagementReportPolicy:{name:"meetingPolicy.allowEngagementReport"},allowFluidCollaboratePolicy:{name:"messagingPolicy.allowFluidCollaborate"},autodiscoverSettings:{name:"userPropertiesSettings.autodiscoverSettings"},allowMeetingRegistrationPolicy:{name:"meetingPolicy.allowMeetingRegistration"},allowBroadcastSchedulingPolicy:{name:"broadcastMeetingPolicy.allowBroadcastScheduling"},whoCanRegisterPolicy:{name:"meetingPolicy.whoCanRegister"}},userResources:{licenseType:{name:"userResourcesSettings.licenseType"},isSfbCloud:{name:"userResourcesSettings.isSfbCloud"},isSipEnabled:{name:"userResourcesSettings.isSipEnabled"},isSfbCloudInBVD:{name:"voiceAdminSettings.isSfbCloud"},isSipEnabledInBVD:{name:"voiceAdminSettings.isSipEnabled"},licenseSettings:{name:"userResourcesSettings.licenseSettings"}},ageConsent:{ageGroup:{name:"ageConsentPolicy.ageGroup"}},channels:{enableChannelMeetNowInPostReply:{name:"tenantSettingsV2.meetups.isAdhocChannelMeetingEnabled"},enableChannelMeetNowInL1Header:{name:"tenantSettingsV2.meetups.isAdhocChannelMeetingEnabled"}},feedback:{allowEmailCollection:{name:"feedbackPolicy.allowEmailCollection"}},peopleTargeting:{tagPermissions:{name:"targetingPolicy.manageTagsPermissionMode"},ownersCanOverwriteTagSettings:{name:"targetingPolicy.teamOwnersEditWhoCanManageTagsMode"},suggestedTags:{name:"targetingPolicy.suggestedPresetTags"},customTagMode:{name:"targetingPolicy.customTagsMode"},disallowedSources:{name:"targetingPolicy.disallowedSources"}}},namespaces:["callingPolicy","voiceAdminSettings","policySettings","meetingPolicy","tenantSettingsV2","filesPolicy","messagingPolicy","userPropertiesSettings","feedbackPolicy","externalAccessPolicy","broadcastMeetingPolicy","clientSettings","teamsAndChannelsPolicy","userResourcesSettings","ageConsentPolicy","targetingPolicy"]};function rF(e){switch(e){case"ag08":return n.e(27573).then(n.bind(n,146858)).then((e=>e.default));case"ag09":return n.e(29709).then(n.bind(n,413221)).then((e=>e.default));case"dev":return n.e(21533).then(n.bind(n,732879)).then((e=>e.default));case"dod":return n.e(48735).then(n.bind(n,926424)).then((e=>e.default));case"gcc":return n.e(24925).then(n.bind(n,120373)).then((e=>e.default));case"gcchigh":return n.e(54668).then(n.bind(n,179020)).then((e=>e.default));case"life":return n.e(72564).then(n.bind(n,344271)).then((e=>e.default));case"prod":return n.e(62376).then(n.bind(n,850629)).then((e=>e.default));case"viewportOverrides":return aF;case"policies":return oF;default:throw new Error(`Requested config does not exist: ${e}`)}}const sF=e=>e instanceof Error?e:(console.error("Promise rejected with non-Error reason",e),(0,Z.Tr)("SanePromise",S.jK.UndefinedGlobalError,"",{reason:e},"Non-Error rejection"));var lF=n(191833),cF=n(142029),dF=n(557351),uF=n(706827);const mF=e=>{if(pF(e))return gF(e)?{subNavEntity:hF(e),headerEntity:vF(e),startEntity:fF(e),mainEntity:yF(e),endEntity:SF(e)}:null},pF=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[be.lO.focus,be.lO.standard].includes(e),o=[ne.p.agendapage].includes(i),r=n&&[ne.u.default,ne.u.view].includes(n);return!!(a&&o&&r)},gF=()=>!0,hF=()=>null,vF=()=>null,fF=()=>null,yF=({entity:e})=>e,SF=()=>null,kF={id:"com.microsoft.teams.agenda-page",name:"AgendaPageApp",supportedEntities:[ne.p.agendapage],supportedRenderModes:[t_.S.Main],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},bF=()=>Promise.all([n.e(89962),n.e(61874),n.e(2845),n.e(41574),n.e(92923),n.e(29138),n.e(38811),n.e(29084),n.e(7001),n.e(98314),n.e(87851),n.e(78001),n.e(77999),n.e(58254),n.e(81391),n.e(30644),n.e(51217),n.e(3806),n.e(37498),n.e(94101)]).then(n.bind(n,821919));function _F(){const e=()=>null;return{getAppViewEntities:mF,manifest:kF,render:({appRenderMode:t,loggerFactory:n,onRenderEvent:i,scenarioFactory:a})=>(0,l.__awaiter)(this,void 0,void 0,(function*(){if(t===t_.S.Main){const e=n.newLogger("AgendaPageApp"),t="agenda-page-app";i("ChunkLoadStarted",{chunkName:t});const{AgendaPage:o}=yield(0,ha.mT)(bF,t,a);return i("ChunkLoadSucceeded",{chunkName:t}),e.log("render: loading agendapage app"),e_.createElement(n_.f,{namespace:"calling",loaderRenderer:null},e_.createElement(o,null))}return e_.createElement(e,null)}))}}var CF=n(755641),wF=n(590158);const TF=W_.WL.END,EF=W_.WL.HEADER,IF=W_.WL.MAIN,NF=W_.WL.MODAL,AF=W_.WL.NOTIFICATIONS,MF=W_.WL.TITLE_BAR,FF="minmax(0, 1fr)",RF="minmax(0, 1fr)",PF=[{slots:[IF,NF,AF],responsiveTemplates:[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n        "${AF}"    auto\n        "${IF}"             ${FF} /\n        ${RF}\n      `}]},{slots:[IF,NF,AF,MF],responsiveTemplates:[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n        "${MF}"         3.9rem\n        "${AF}"    auto\n        "${IF}"             ${FF} /\n        ${RF}\n      `}]},{slots:[EF,IF,NF,AF],responsiveTemplates:[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n        "${AF}"    auto\n        "${EF}"           auto\n        "${IF}"             ${FF} /\n        ${RF}\n      `}]},{slots:[EF,IF,NF,AF,MF],responsiveTemplates:[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n        "${MF}"        3.9rem\n        "${AF}"   auto\n        "${EF}"          auto\n        "${IF}"            ${FF} /\n        ${RF}\n      `}]},{slots:[TF,IF,NF,AF],responsiveTemplates:[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n        "${AF}    ${AF}"    auto\n        "${IF}             ${TF}"              ${FF} /\n        ${RF}         32rem\n      `}]},{slots:[TF,IF,NF,AF,MF],responsiveTemplates:[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n        "${MF}         ${MF}"         3.9rem\n        "${AF}    ${AF}"    auto\n        "${IF}             ${TF}"              ${RF} /\n        ${RF}         32rem\n      `}]},{slots:[TF,EF,IF,NF,AF],responsiveTemplates:[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n        "${AF}    ${AF}"    auto\n        "${EF}           ${EF}"           auto\n        "${IF}             ${TF}"              ${FF} /\n        ${RF}         32rem\n      `}]},{slots:[TF,EF,IF,NF,AF,MF],responsiveTemplates:[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n        "${MF}         ${MF}"         3.9rem\n        "${AF}    ${AF}"    auto\n        "${EF}           ${EF}"           auto\n        "${IF}             ${TF}"              ${FF} /\n        ${RF}         32rem\n      `}]},{layoutKey:CF.F.HYER,slots:[IF,NF,AF],responsiveTemplates:[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n        "${AF}"   auto\n        "${IF}"            ${FF} /\n        ${RF}\n      `}]},{layoutKey:CF.F.HYER,slots:[IF,NF,AF,MF],responsiveTemplates:[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n        "${MF}"        3.9rem\n        "${AF}"   auto\n        "${IF}"            ${FF} /\n        ${RF}\n      `}]},{layoutKey:CF.F.HYER,slots:[EF,IF,NF,AF],responsiveTemplates:[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n        "${AF}"   auto\n        "${EF}"          auto\n        "${IF}"            ${FF} /\n        ${RF}\n      `}]},{layoutKey:CF.F.HYER,slots:[EF,IF,NF,AF,MF],responsiveTemplates:[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n        "${MF}"        3.9rem\n        "${AF}"   auto\n        "${EF}"          auto\n        "${IF}"            ${FF} /\n        ${RF}\n      `}]},{layoutKey:CF.F.HYER,slots:[TF,EF,IF,NF,AF],responsiveTemplates:[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n        "${AF}    ${AF}"    auto\n        "${EF}           ${EF}"           auto\n        "${IF}             ${TF}"              ${FF} /\n        ${RF}        32rem\n      `}]},{layoutKey:CF.F.HYER,slots:[TF,EF,IF,NF,AF,MF],responsiveTemplates:[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n        "${MF}         ${MF}"         3.9rem\n        "${AF}    ${AF}"    auto\n        "${EF}           ${EF}"           auto\n        "${IF}             ${TF}"              ${FF} /\n        ${RF}        32rem\n      `}]},{layoutKey:CF.F.HEADER_AT_BOTTOM,slots:[EF,IF,NF,AF],responsiveTemplates:[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n        "${AF}"    auto\n        "${IF}"             ${FF}\n        "${EF}"           auto /\n        ${RF}\n      `}]},{layoutKey:CF.F.HEADER_AT_BOTTOM,slots:[EF,IF,NF,AF,MF],responsiveTemplates:[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n        "${MF}"        3.9rem\n        "${AF}"   auto\n        "${IF}"            ${FF}\n        "${EF}"          auto /\n        ${RF}\n      `}]},{layoutKey:CF.F.HEADER_AT_BOTTOM,slots:[TF,EF,IF,NF,AF],responsiveTemplates:[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n        "${AF}    ${AF}"    auto\n        "${IF}             ${TF}"              ${FF}\n        "${EF}           ${EF}"           auto /\n        ${RF}         32rem\n      `}]},{layoutKey:CF.F.HEADER_AT_BOTTOM,slots:[TF,EF,IF,NF,AF,MF],responsiveTemplates:[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n        "${MF}         ${MF}"         3.9rem\n        "${AF}    ${AF}"    auto\n        "${IF}             ${TF}"              ${FF}\n        "${EF}           ${EF}"           auto /\n        ${RF}         32rem\n      `}]}],DF="6.1rem",jF=W_.WL.END,xF=W_.WL.HEADER,OF=W_.WL.MAIN,LF=W_.WL.MODAL,UF=W_.WL.NAV,BF=W_.WL.NOTIFICATIONS,WF=W_.WL.SUBNAV,HF=W_.WL.TITLE_BAR,$F=[{slots:[OF,LF,BF],responsiveTemplates:[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n          "${BF}"    auto\n          "${OF}"             minmax(0, 1fr) /\n           minmax(0, 1fr)\n        `}]},{slots:[OF,LF,BF,HF],responsiveTemplates:[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n          "${HF}"         4.8rem\n          "${BF}"    auto\n          "${OF}"             minmax(0, 1fr) /\n           minmax(0, 1fr)\n        `}]},{slots:[xF,OF,LF,BF],responsiveTemplates:[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n          "${BF}"    auto\n          "${xF}"           auto\n          "${OF}"             minmax(0, 1fr) /\n           minmax(0, 1fr)\n        `}]},{slots:[xF,OF,LF,BF,HF],responsiveTemplates:[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n          "${HF}"         4.8rem\n          "${BF}"    auto\n          "${xF}"           auto\n          "${OF}"             minmax(0, 1fr) /\n           minmax(0, 1fr)\n        `}]},{slots:[jF,xF,OF,LF,BF],responsiveTemplates:[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n          "${BF}    ${BF}"    auto\n          "${xF}           ${xF}"           auto\n          "${OF}             ${jF}"              minmax(0, 1fr) /\n           minmax(0, 1fr)        32rem\n        `}]},{slots:[jF,xF,OF,LF,BF,HF],responsiveTemplates:[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n          "${HF}         ${HF}"         4.8rem\n          "${BF}    ${BF}"    auto\n          "${xF}           ${xF}"           auto\n          "${OF}             ${jF}"              minmax(0, 1fr) /\n           minmax(0, 1fr)        32rem\n        `}]},{layoutKey:CF.F.HYER,slots:[xF,OF,LF,BF],responsiveTemplates:e=>{var t,n;const i=(null===(t=e[xF])||void 0===t?void 0:t.height)||DF,a=(null===(n=e[BF])||void 0===n?void 0:n.height)||"auto";return[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n            "${BF}"    ${a}\n            "${xF}"           ${i}\n            "${OF}"             minmax(0, 1fr) /\n             minmax(0, 1fr)\n          `}]}},{layoutKey:CF.F.HYER,slots:[xF,OF,LF,BF,HF],responsiveTemplates:e=>{var t,n;const i=(null===(t=e[xF])||void 0===t?void 0:t.height)||DF,a=(null===(n=e[BF])||void 0===n?void 0:n.height)||"auto";return[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n            "${HF}"         4.8rem\n            "${BF}"    ${a}\n            "${xF}"           ${i}\n            "${OF}"             minmax(0, 1fr) /\n             minmax(0, 1fr)\n          `}]}},{layoutKey:CF.F.HYER,slots:[jF,xF,OF,LF,BF],responsiveTemplates:e=>{var t,n;const i=(null===(t=e[xF])||void 0===t?void 0:t.height)||DF,a=(null===(n=e[BF])||void 0===n?void 0:n.height)||"auto";return[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n            "${BF}    ${BF}"    ${a}\n            "${xF}           ${xF}"           ${i}\n            "${OF}             ${jF}"              minmax(0, 1fr) /\n             minmax(0, 1fr)        32rem\n          `}]}},{layoutKey:CF.F.HYER,slots:[jF,xF,OF,LF,BF,HF],responsiveTemplates:e=>{var t,n;const i=(null===(t=e[xF])||void 0===t?void 0:t.height)||DF,a=(null===(n=e[BF])||void 0===n?void 0:n.height)||"auto";return[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n            "${HF}         ${HF}"         4.8rem\n            "${BF}    ${BF}"    ${a}\n            "${xF}           ${xF}"           ${i}\n            "${OF}             ${jF}"              minmax(0, 1fr) /\n             minmax(0, 1fr)        32rem\n          `}]}},{layoutKey:CF.F.HYER,slots:[OF,LF,UF,BF,HF],responsiveTemplates:e=>{var t;const n=(null===(t=e[BF])||void 0===t?void 0:t.height)||"auto";return[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n            "${HF}    ${HF}"         4.8rem\n            "${UF}         ${BF}"    ${n}\n            "${UF}         ${OF}"             minmax(0, 1fr) /\n             6.8rem    minmax(0, 1fr)\n          `}]}},{layoutKey:CF.F.HYER,slots:[xF,OF,LF,UF,BF,HF],responsiveTemplates:e=>{var t,n;const i=(null===(t=e[xF])||void 0===t?void 0:t.height)||DF,a=(null===(n=e[BF])||void 0===n?void 0:n.height)||"auto";return[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n            "${HF}    ${HF}"         4.8rem\n            "${UF}         ${BF}"    ${a}\n            "${UF}         ${xF}"           ${i}\n            "${UF}         ${OF}"             minmax(0, 1fr) /\n             6.8rem    minmax(0, 1fr)\n          `}]}},{layoutKey:CF.F.HYER,slots:[jF,xF,OF,LF,UF,BF,HF],responsiveTemplates:e=>{var t,n;const i=(null===(t=e[xF])||void 0===t?void 0:t.height)||DF,a=(null===(n=e[BF])||void 0===n?void 0:n.height)||"auto";return[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n            "${HF}    ${HF}         ${HF}"         4.8rem\n            "${UF}         ${BF}    ${BF}"    ${a}\n            "${UF}         ${xF}           ${xF}"           ${i}\n            "${UF}         ${OF}             ${jF}"              minmax(0, 1fr) /\n             6.8rem    minmax(0, 1fr)        32rem\n          `}]}},{layoutKey:CF.F.HYER,slots:[OF,LF,UF,BF,WF,HF],responsiveTemplates:e=>{var t;const n=(null===(t=e[BF])||void 0===t?void 0:t.height)||"auto";return[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n            "${HF}    ${HF}    ${HF}"         4.8rem\n            "${UF}         ${WF}      ${BF}"    ${n}\n            "${UF}         ${WF}      ${OF}"             minmax(0, 1fr) /\n             6.8rem    0              minmax(0, 1fr)\n          `},{minWidthBreakpoint:wF.Rd.IS_AT_LEAST_947,template:`\n            "${HF}    ${HF}    ${HF}"         4.8rem\n            "${UF}         ${WF}      ${BF}"    ${n}\n            "${UF}         ${WF}      ${OF}"             minmax(0, 1fr) /\n             6.8rem    28rem          minmax(0, 1fr)\n          `},{minWidthBreakpoint:wF.Rd.IS_AT_LEAST_1350,template:`\n            "${HF}    ${HF}    ${HF}"         4.8rem\n            "${UF}         ${WF}      ${BF}"    ${n}\n            "${UF}         ${WF}      ${OF}"             minmax(0, 1fr) /\n             6.8rem    32rem          minmax(0, 1fr)\n          `},{minWidthBreakpoint:wF.Rd.IS_AT_LEAST_1500,template:`\n            "${HF}    ${HF}    ${HF}"         4.8rem\n            "${UF}         ${WF}      ${BF}"    ${n}\n            "${UF}         ${WF}      ${OF}"             minmax(0, 1fr) /\n             6.8rem    36rem          minmax(0, 1fr)\n          `}]}},{layoutKey:CF.F.HYER,slots:[xF,OF,LF,UF,BF,WF,HF],responsiveTemplates:e=>{var t,n;const i=(null===(t=e[xF])||void 0===t?void 0:t.height)||DF,a=(null===(n=e[BF])||void 0===n?void 0:n.height)||"auto";return[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n            "${HF}    ${HF}    ${HF}"        4.8rem\n            "${UF}         ${WF}      ${BF}"   ${a}\n            "${UF}         ${WF}      ${xF}"          ${i}\n            "${UF}         ${WF}      ${OF}"            minmax(0, 1fr) /\n             6.8rem    0              minmax(0, 1fr)\n          `},{minWidthBreakpoint:wF.Rd.IS_AT_LEAST_947,template:`\n            "${HF}    ${HF}    ${HF}"        4.8rem\n            "${UF}         ${WF}      ${BF}"   ${a}\n            "${UF}         ${WF}      ${xF}"          ${i}\n            "${UF}         ${WF}      ${OF}"            minmax(0, 1fr) /\n             6.8rem    28rem          minmax(0, 1fr)\n          `},{minWidthBreakpoint:wF.Rd.IS_AT_LEAST_1350,template:`\n            "${HF}    ${HF}    ${HF}"        4.8rem\n            "${UF}         ${WF}      ${BF}"   ${a}\n            "${UF}         ${WF}      ${xF}"          ${i}\n            "${UF}         ${WF}      ${OF}"            minmax(0, 1fr) /\n             6.8rem    32rem          minmax(0, 1fr)\n          `},{minWidthBreakpoint:wF.Rd.IS_AT_LEAST_1500,template:`\n            "${HF}    ${HF}    ${HF}"        4.8rem\n            "${UF}         ${WF}      ${BF}"   ${a}\n            "${UF}         ${WF}      ${xF}"          ${i}\n            "${UF}         ${WF}      ${OF}"            minmax(0, 1fr) /\n             6.8rem    36rem          minmax(0, 1fr)\n          `}]}},{layoutKey:CF.F.HYER,slots:[jF,OF,LF,UF,BF,WF,HF],responsiveTemplates:e=>{var t;const n=(null===(t=e[BF])||void 0===t?void 0:t.height)||"auto";return[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n            "${HF}    ${HF}    ${HF}         ${HF}"         4.8rem\n            "${UF}         ${WF}      ${BF}    ${BF}"    ${n}\n            "${UF}         ${WF}      ${OF}             ${jF}"              minmax(0, 1fr) /\n             6.8rem    0              minmax(0, 1fr)        0\n          `},{minWidthBreakpoint:wF.Rd.IS_AT_LEAST_947,template:`\n            "${HF}    ${HF}    ${HF}         ${HF}"         4.8rem\n            "${UF}         ${WF}      ${BF}    ${BF}"    ${n}\n            "${UF}         ${WF}      ${OF}             ${jF}"              minmax(0, 1fr) /\n             6.8rem    28rem          minmax(0, 1fr)        0\n          `},{minWidthBreakpoint:wF.Rd.IS_AT_LEAST_1350,template:`\n            "${HF}    ${HF}    ${HF}         ${HF}"         4.8rem\n            "${UF}         ${WF}      ${BF}    ${BF}"    ${n}\n            "${UF}         ${WF}      ${OF}             ${jF}"              minmax(0, 1fr) /\n             6.8rem    32rem          minmax(0, 1fr)        32rem\n          `},{minWidthBreakpoint:wF.Rd.IS_AT_LEAST_1500,template:`\n            "${HF}    ${HF}    ${HF}         ${HF}"         4.8rem\n            "${UF}         ${WF}      ${BF}    ${BF}"    ${n}\n            "${UF}         ${WF}      ${OF}             ${jF}"              minmax(0, 1fr) /\n             6.8rem    36rem          minmax(0, 1fr)        32rem\n          `}]}},{layoutKey:CF.F.HYER,slots:[jF,xF,OF,LF,UF,BF,WF,HF],responsiveTemplates:e=>{var t,n;const i=(null===(t=e[xF])||void 0===t?void 0:t.height)||DF,a=(null===(n=e[BF])||void 0===n?void 0:n.height)||"auto";return[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n            "${HF}    ${HF}    ${HF}         ${HF}"         4.8rem\n            "${UF}         ${WF}      ${BF}    ${BF}"    ${a}\n            "${UF}         ${WF}      ${xF}           ${xF}"           ${i}\n            "${UF}         ${WF}      ${OF}             ${jF}"              minmax(0, 1fr) /\n             6.8rem    0              minmax(0, 1fr)        0\n          `},{minWidthBreakpoint:wF.Rd.IS_AT_LEAST_947,template:`\n            "${HF}    ${HF}    ${HF}         ${HF}"         4.8rem\n            "${UF}         ${WF}      ${BF}    ${BF}"    ${a}\n            "${UF}         ${WF}      ${xF}           ${xF}"           ${i}\n            "${UF}         ${WF}      ${OF}             ${jF}"              minmax(0, 1fr) /\n             6.8rem    28rem          minmax(0, 1fr)        0\n          `},{minWidthBreakpoint:wF.Rd.IS_AT_LEAST_1350,template:`\n            "${HF}    ${HF}    ${HF}         ${HF}"         4.8rem\n            "${UF}         ${WF}      ${BF}    ${BF}"    ${a}\n            "${UF}         ${WF}      ${xF}           ${xF}"           ${i}\n            "${UF}         ${WF}      ${OF}             ${jF}"              minmax(0, 1fr) /\n             6.8rem    32rem          minmax(0, 1fr)        32rem\n          `},{minWidthBreakpoint:wF.Rd.IS_AT_LEAST_1500,template:`\n            "${HF}    ${HF}    ${HF}         ${HF}"         4.8rem\n            "${UF}         ${WF}      ${BF}    ${BF}"    ${a}\n            "${UF}         ${WF}      ${xF}           ${xF}"           ${i}\n            "${UF}         ${WF}      ${OF}             ${jF}"              minmax(0, 1fr) /\n             6.8rem    36rem          minmax(0, 1fr)        32rem\n          `}]}},{layoutKey:CF.F.HEADER_AT_BOTTOM,slots:[xF,OF,LF,BF],responsiveTemplates:[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n          "${BF}"    auto\n          "${OF}"             minmax(0, 1fr)\n          "${xF}"           auto /\n           minmax(0, 1fr)\n        `}]},{layoutKey:CF.F.HEADER_AT_BOTTOM,slots:[xF,OF,LF,BF,HF],responsiveTemplates:[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n          "${HF}"        3.9rem\n          "${BF}"   auto\n          "${OF}"            minmax(0, 1fr)\n          "${xF}"          auto /\n           minmax(0, 1fr)\n        `}]},{layoutKey:CF.F.HEADER_AT_BOTTOM,slots:[jF,xF,OF,LF,BF],responsiveTemplates:[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n          "${BF}    ${BF}"    auto\n          "${OF}             ${jF}"              minmax(0, 1fr)\n          "${xF}           ${xF}"           auto /\n           minmax(0, 1fr)        32rem\n        `}]},{layoutKey:CF.F.HEADER_AT_BOTTOM,slots:[jF,xF,OF,LF,BF,HF],responsiveTemplates:[{minWidthBreakpoint:wF.Rd.IS_GREATER_THAN_0,template:`\n          "${HF}         ${HF}"         3.9rem\n          "${BF}    ${BF}"    auto\n          "${OF}             ${jF}"              minmax(0, 1fr)\n          "${xF}           ${xF}"           auto /\n           minmax(0, 1fr)        32rem\n        `}]}];function VF({layoutKey:e,layoutMode:t}){const n={[be.lO.focus]:PF,[be.lO.minimal]:[],[be.lO.standard]:$F};return new CF.Z({layoutKey:e,layoutMode:t,layoutTemplatesPerLayoutMode:n})}performance&&performance.mark&&performance.mark("start-execute-main-bundle");const zF={Application:{onPreWarm:["search-data-load"]}},GF=({osPlatform:e,theme:t,cspNonce:n,publicPathScript:i,containerVer:a})=>{const{favicons:o,preloadTitleBar:r}=lF.L;return uF({htmlWebpackPlugin:{options:{containerVer:a,publicPathScript:i,cspNonce:n,theme:t,partials:{favicons:o(),preloadTitleBar:r({osPlatform:e})}},files:{}}})},qF=(e,t,i)=>{let a=!1;i&&(0,ha.mT)((()=>Promise.all([n.e(89962),n.e(85256),n.e(63986),n.e(2845),n.e(41574),n.e(92923),n.e(29138),n.e(38811),n.e(68865),n.e(21767),n.e(97725),n.e(29084),n.e(21439),n.e(55837),n.e(98314),n.e(22391),n.e(91607),n.e(78001),n.e(77999),n.e(23741),n.e(17870),n.e(61385),n.e(90864),n.e(58254),n.e(81391),n.e(84593),n.e(30644),n.e(53621),n.e(93438),n.e(8163),n.e(74313),n.e(88612),n.e(51217),n.e(71217),n.e(51427),n.e(14797),n.e(33913),n.e(75516),n.e(38574),n.e(15470),n.e(8093),n.e(26589),n.e(73190),n.e(36378),n.e(14776),n.e(14938),n.e(30970),n.e(30828),n.e(31611),n.e(81647)]).then(n.bind(n,468722))),"chat-app",t).catch((t=>{e.newLogger("Multi-Window").error(`Failed to prefetch Chat App: ${t}`)})),(0,ha.mT)((()=>Promise.all([n.e(89962),n.e(85256),n.e(61874),n.e(2845),n.e(41574),n.e(29138),n.e(38811),n.e(68865),n.e(29084),n.e(21439),n.e(55837),n.e(87851),n.e(63506),n.e(4655),n.e(21996),n.e(23741),n.e(89197),n.e(81222),n.e(2054)]).then(n.bind(n,800538))),"core-essentials",t).catch((t=>{e.newLogger("Multi-Window").error(`Failed to prefetch Core Layout: ${t}`),a=a||(e=>((0,F.J)().opener.postMessage(_.W.ExperienceStarted,{message:e.message,errorCode:-1,errorDescription:`${e.code}: ${e.subContext}`}),!0))(t)}))},JF=(e,t)=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const{renderErrorScreen:i}=yield Promise.all([n.e(89962),n.e(61874),n.e(2845),n.e(41574),n.e(29138),n.e(38811),n.e(29084),n.e(87851),n.e(6222),n.e(23741),n.e(81222),n.e(14682)]).then(n.bind(n,587117)),a=document.getElementById("app");a&&i(e,a,(0,F.J)(),void 0,t)}));(()=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){var e;const t=Date.now();(0,F.J)().opener.postMessage(_.W.ExperienceStarted,{message:"beforeCoreStart"});const i=n(759455),a=[_F(),pM(),h_(),I_(),B_(),BA(),mN(),Qw(),uT(),wT(),ZC(),iF(),jT(),QM(),GT(),xI(),tA(),aE(),vE(),xM(),RE(),gI(),AN(),$N(),NA(),TI(),ZI(),qE(),eM(),TM()],o=new Zb({config:Object.assign(Object.assign({},i),{startTimeMS:t,lifeCycleJobPermissions:zF}),apps:a,loadConfigs:rF,generateChildWindowTemplate:GF});let r;try{yield o.init(),r=o.coreServices}catch(e){return void JF(e)}if(!r)return;const{coreSettings:s,loggerFactory:l,scenarioFactory:c}=r,{sanePromise:d}=s.get(b.J.Core),{enableChatPreload:u}=s.get(b.J.Chat);d&&(r.windowProvider.Promise=function(e){var t,n;class i{constructor(t){this[n]=e.prototype[Symbol.toStringTag],this._promise=new e(((e,n)=>{try{t(e,(e=>n(sF(e))))}catch(e){n(sF(e))}}))}then(e,t){return new i(((n,i)=>this._promise.then(e,t).then(n,i)))}catch(e){return new i(((t,n)=>this._promise.catch(e).then(t,n)))}finally(e){return new i(((t,n)=>{let i=!1;return this._promise.catch((e=>(i=!0,e))).then(e).then(i?n:t)}))}always(e){return new i(((t,n)=>this._promise.then((n=>{e(n),t(n)}),(t=>{e(t),n(t)}))))}}return t=Symbol.species,n=Symbol.toStringTag,i.all=t=>new i(((n,i)=>e.all(t).then(n,i))),i.race=t=>new i(((n,i)=>e.race(t).then(n,i))),i.reject=t=>new i(((n,i)=>e.reject(t).then(n,i))),i.resolve=t=>new i(void 0===t?(t,n)=>e.resolve().then(t,n):(n,i)=>e.resolve(t).then(n,i)),i[t]=i,i}(Promise));const m={config:i,getLayoutResponsiveTemplates:VF,uiVariables:{isMultiWindow:!0}};yield(0,cF.o)(o.activeWindows,r,(0,dF.c)(m)),qF(l,c,null!=u&&u),null===(e=r.scenarioFactory.findScenario(A.RG.ExperienceReady))||void 0===e||e.stop()})))().catch((e=>{JF(e)}))},81749:(e,t,n)=>{"use strict";n.d(t,{n:()=>o,a:()=>r});var i=n(231191),a=n(714715);const o=e=>{const{leakDetector:t,cache:n}=e,o=(0,i.__rest)(e,["leakDetector","cache"]);return new a.fe(Object.assign(Object.assign({},o),{cache:n||r({leakDetector:t}),assumeImmutableResults:!0,connectToDevTools:!1}))},r=(e={})=>{var{leakDetector:t}=e,n=(0,i.__rest)(e,["leakDetector"]);const o=new a.h4(n);return null==t||t.track("apolloCache",o),o}},944046:(e,t,n)=>{"use strict";n.d(t,{T:()=>a});var i=n(883180);const a=e=>{const t=performance.now();return{cacheSize:i(e),measuringTime:performance.now()-t}}},603250:(e,t,n)=>{"use strict";n.d(t,{l:()=>a});var i=n(461430);class a extends i.G{constructor(e){if(super({code:"AUTH",prevError:"boolean"==typeof e?void 0:e}),this.offlineErrorCodes=["NoNetwork","RemoteOperationFailed"],"boolean"==typeof e)this.reason=e?"SIGN_IN_RESTRICTIONS":void 0;else{const t=e.code;this.reason="SignInRestrictions"===t?"SIGN_IN_RESTRICTIONS":this.offlineErrorCodes.includes(t)?"OFFLINE":void 0}}getBoundaryProps(){switch(this.reason){case"SIGN_IN_RESTRICTIONS":return{title:"default_signinrestrictions_title",description:"default_signinrestrictions_description",actions:["RESTART"]};case"OFFLINE":return{title:"default_auth_no_network_title",description:"default_auth_no_network_description",actions:["RESTART"]};default:return{title:"default_authentication_title",description:"default_authentication_description",actions:["RESTART","SIGN_OUT"]}}}}},461430:(e,t,n)=>{"use strict";n.d(t,{G:()=>i});class i extends Error{constructor({code:e,message:t,prevError:n}){var i;super(t),this.code=e,this.prevError=n;const a=function(e){var t;return null!==(t=null==e?void 0:e.split("\n").slice(1))&&void 0!==t?t:[]}(null!==(i=null==n?void 0:n.stack)&&void 0!==i?i:this.stack);this.stack=[`${e} Error: ${t}`,...a].join("\n"),Object.setPrototypeOf(this,new.target.prototype)}getBoundaryProps(){return{title:`default_${this.code.toLowerCase()}_title`,description:`default_${this.code.toLowerCase()}_description`}}toLogMessage(){return JSON.stringify(this.toLogEntry())}toLogEntry(){return{code:this.code,message:this.message,stack:this.stack}}}},939632:(e,t,n)=>{"use strict";n.d(t,{U:()=>a,r:()=>o});var i=n(461430);class a extends i.G{get extensions(){return this._extensions||(this._extensions=this.getExtensions()),this._extensions}getExtensions(){return{code:this.code,stack:this.stack,prevError:this.prevError,boundaryProps:this.getBoundaryProps()}}}function o(e){var t,n;return null!=(null===(t=e.extensions)||void 0===t?void 0:t.code)&&null!=(null===(n=e.extensions)||void 0===n?void 0:n.boundaryProps)}},429145:(e,t,n)=>{"use strict";n.d(t,{G:()=>r});var i=n(461430);const a={EXPERIENCE_DISABLED:"Your account needs to be provisioned. Please check out https://aka.ms/ChatSelfhost to troubleshoot.",LAYOUT_PHASE_STATE_MACHINE_TIMEOUT:"Layout phase state machine has timed out triggering a view tear down."},o={EXPERIENCE_DISABLED:{title:"default_experiencedisabled_title",description:"default_experiencedisabled_description"},LAYOUT_PHASE_STATE_MACHINE_TIMEOUT:{title:"default_unknown_title",description:"default_unknown_description",actions:["RETRY"]},NETWORK_OFFLINE:{title:"default_nonetwork_title",description:"error_nonetwork_text"},LAYOUT_ERROR:{title:"default_unknown_title",description:"",actions:["RETRY"]}};class r extends i.G{constructor(e,t){var n,i,o,r,s;super({code:"CORE",message:null!==(s=null!==(n=a[e])&&void 0!==n?n:null===(r=null===(o=null===(i=t)||void 0===i?void 0:i.reason)||void 0===o?void 0:o.innerError)||void 0===r?void 0:r.message)&&void 0!==s?s:null==t?void 0:t.message,prevError:t}),this.reason=e}getBoundaryProps(){var e;return null!==(e=o[this.reason])&&void 0!==e?e:super.getBoundaryProps()}}},232712:(e,t,n)=>{"use strict";var i,a,o,r;n.d(t,{fe:()=>i,su:()=>a,uk:()=>o,py:()=>r}),function(e){e.show="show",e.hide="hide",e.toggle="toggle"}(i||(i={})),function(e){e.none="none",e.flush="flush",e.forceFlush="forceFlush",e.new="new",e.extend="extend"}(a||(a={})),function(e){e.default="default",e.view="view",e.list="list",e.signout="signout",e.updateProfilePicture="updateProfilePicture",e.updateDisplayName="updateDisplayName"}(o||(o={})),function(e){e.identity="identity",e.teams_activity="teams_activity",e.teams_chat="teams_chat",e.teams_channel="teams_channel",e.teams_calendar="teams_calendar",e.teams_calling="teams_calling",e.outlook_mail="outlook_mail",e.outlook_calendar="outlook_calendar",e.outlook_people="outlook_people",e.outlook_fileshub="outlook_fileshub",e.outlook_tasks="outlook_tasks",e.m365_app="m365_app"}(r||(r={}))},283634:(e,t,n)=>{"use strict";n.d(t,{b:()=>k});var i=n(231191),a=n(379922),o=n(772635),r=n(55882),s=n(946101),l=n(352367),c=n(356452),d=n(682796),u=n(459012),m=n(324819),p=n(843149),g=n(9654),h=n(16381),v=n(70941),f=n(775214);const y=3e5,S=new Map([[g.ej.SKYPE_KEY,[s.Pn.ams,s.Pn.amsV2]],[g.ej.MT_KEY,[s.Pn.mtImageService]]]);class k{constructor(e,t,n,i,s,d,u,m,g){var S;this._gtmRegistry=t,this._stateRoutingService=n,this._discover=i,this.coreSettings=d,this.windowProvider=u,this.localStorage=m,this._authenticationService=g,this._imageAuthCookieExpiryTsKey="ImageAuthCookieExpiryTime",this._activeAmsRequest={},this._baseImageUrlSubject=new p.X(null),this._isInitialized=!1,this._isImageAuthCookieValidSubject=new p.X(!1),this.checkImageAuthCookie=()=>{let e=-1;const t=(new Date).getTime()/1e3,n=this.localStorage&&this.localStorage.get(this._imageAuthCookieExpiryTsKey,l.fO.Global)||"-1";e=parseInt(n,10);const i=e>t,a=i?`Image auth cookie has NOT expired. Expiry time stamp: ${e}`:`Image auth cookie has expired. Expiry time stamp: ${e}`;this._logger.log(a),this._isImageAuthCookieValidSubject.next(i),this.startImageAuthCookiePollingTimer(i,e)},this.getRequest=(e,{requestUrl:t,requestBody:n,headers:i,serviceName:a})=>this._gtmRegistry.bind(this._send,e)({url:t,headers:i,credentials:"include",method:"POST",body:n,serviceName:a,apiName:"persistTokenToAMS"}),this._logger=s.newLogger("Content Media Auth"),this._send=(0,a.r)((0,o.B)((0,r.S)(e),c.qb.NO_CONTENT,c.qb.OK),(S=this._logger,{shouldRetry:e=>(0,f.o7)(e)||[c.qb.THROTTLED,-1].indexOf(e)>-1,errorHandler:(e,t)=>{const{serverResponse:{status:n}}=e;if(!t.retriesTable[n])throw new Error(`AsyncMediaAuthServiceRetryPolicy: retry count for ${n} is empty`);return S.error(`asyncMediaAuthServiceRetryPolicy: retrying '[${t.retryCount}]' times due to response status - '[${n}]'`),(0,h._)(t.delay.next())},retryMaxTimeMs:y,maxRetryCount:6,createDelay:()=>new v.df(1e3,2,y)}))}initAsyncMediaAuthService(){if(this._isInitialized)return;const{enableAmsCookieValidation:e}=this.coreSettings.get(d.J.Core),{isImageAuthCookiePollingCheckEnabled:t}=this.coreSettings.get(d.J.People);e&&t?this.checkImageAuthCookie():this._isImageAuthCookieValidSubject.next(!0);const{skipAmsAuthRequest:n}=this.coreSettings.get(d.J.Auth);n?this.initCookieImageAuth().catch((()=>{this._logger.error("Error in initCookieImageAuth")})):(this._discover.validateSkypeToken().catch((()=>{})),this.subscribeToToken(g.ej.SKYPE_KEY),this.subscribeToToken(g.ej.MT_KEY)),this._isInitialized=!0}startImageAuthCookiePollingTimer(e,t){this._imageAuthCookiePollingTimerId&&(this._logger.log(`Clearing image auth cookie polling. Timer ID: ${this._imageAuthCookiePollingTimerId}`),this.windowProvider.clearInterval(this._imageAuthCookiePollingTimerId));const n=1e3*t-((new Date).getTime()+3e4),i=e?n:5e3;this._imageAuthCookiePollingTimerId=this.windowProvider.setInterval((()=>this.checkImageAuthCookie()),i);const a=e?`Image auth cookie valid. expiry check timer started. Timer ID: ${this._imageAuthCookiePollingTimerId}`:`Image auth cookie NOT valid. polling validity timer started. Timer ID: ${this._imageAuthCookiePollingTimerId}`;this._logger.warn(a)}initCookieImageAuth(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=null!==(e=S.get(g.ej.MT_KEY))&&void 0!==e?e:[],n=yield this._discover.regionGtm(t[0]);n&&this._baseImageUrlSubject.next(n)}))}subscribeToToken(e){var t;const n=this._stateRoutingService.getOrigin()||"";e!==g.ej.SKYPE_KEY||-1!==n.indexOf("teams.microsoft.com")||-1!==n.indexOf("teams.live.com")?(e===g.ej.SKYPE_KEY&&this._discover.observeSkypeToken().subscribe((e=>this.persistTokenToAMS(e,g.ej.SKYPE_KEY))),e===g.ej.MT_KEY&&(null===(t=this._authenticationService)||void 0===t||t.observeMiddleTierToken().subscribe((e=>this.persistTokenToAMS(e,g.ej.MT_KEY))))):this._logger.warn("The current origin is not whitelisted with async media service(AMS). Cannot POST skype token the endpoint. This may affect content hosted with this service such as images etc. See Readme for workaround")}getHeaders(e,t){const n={},i=(0,m.v4)();return n.Authorization=`${t===g.ej.SKYPE_KEY?"skype_token":"Bearer"} ${e}`,n["Content-Type"]="application/x-www-form-urlencoded",n.RequestId=i,n.CorrelationId=i,n.TransactionId=i,n}persistTokenToAMS(e,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i,a,o,r=u.EJ.Skype;const s=null!==(n=S.get(t))&&void 0!==n?n:[],l=this.getHeaders(e,t);if(!e)return Promise.resolve(null);if(this._activeAmsRequest[t])return this._activeAmsRequest[t];switch(t){case g.ej.SKYPE_KEY:i=`skypetoken=${e}`,a="v1/skypetokenauth",r=u.EJ.Skype;break;case g.ej.MT_KEY:i=e,a="beta/imageauth/cookie",r=u.EJ.MiddleTier,o=yield this._discover.regionGtm(s[0]);const{requireSkypetokenForMT:t}=this.coreSettings.get(d.J.Auth);t&&(l["x-skypetoken"]=yield this._discover.validateSkypeToken())}return this.queueRequests(s,t,{requestUrl:a,headers:l,requestBody:i,serviceName:r}),Promise.all(this._activeAmsRequest[t]).then((()=>{this._activeAmsRequest[t]=void 0,t===g.ej.MT_KEY&&o&&this._baseImageUrlSubject.next(o)})).catch((e=>{this._logger.error(`Unable to persist skype token to AMS. ${e}`),this._activeAmsRequest[t]=void 0})),this._activeAmsRequest[t]}))}queueRequests(e,t,n){this._activeAmsRequest[t]=[],e.map((e=>{this._activeAmsRequest[t].push(this.getRequest(e,n))}))}get baseImageUrlObservable(){return this._baseImageUrlSubject.asObservable()}get isImageAuthCookieValidObservable(){return this._isImageAuthCookieValidSubject.asObservable()}}},77791:(e,t,n)=>{"use strict";var i;n.d(t,{p:()=>i}),function(e){e.CodeSnippet="application/vnd.microsoft.card.codesnippet",e.Fluid="application/vnd.microsoft.card.fluid"}(i||(i={}))},554067:(e,t,n)=>{"use strict";n.d(t,{i:()=>p,O:()=>g});var i=n(231191),a=n(892891),o=n(682796),r=n(28970),s=n(811675),l=n(536448),c=n(512526),d=n(533439),u=n(77791),m=n(980633);const p="~~~~###@@TACOCAT@@###~~~~";let g=class{transform(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!e||!t.messageProperties)return;this._logger=t.loggerFactory.newLogger("CodeSnippetsSerializer"),this._scenarioFactory=t.scenarioFactory,this._settings=t.coreSettings;const n=(0,a.unescape)(l.N8.DomUtils.getAttributeValue(e,r.Qq)),i=l.N8.DomUtils.getAttributeValue(e,r.fK),[o]=l.N8.DomUtils.getElementsByTagName("code",e);if(!n)return this._logger.error("The props was missing"),null;if(!o)return this._logger.error("The code snippet was missing"),null;if(!i)return this._logger.error("The id of the card was missing"),null;try{yield this._uploadAndUpdateCard(i,JSON.parse(n),o,t);const e=(0,c.ln)("span",{content:i,itemprop:"cardId"}),a=(0,c.ln)("span",{class:"inline-compose-card",itemid:i,itemscope:"",itemtype:d.T.inputExtension});return l.N8.DomUtils.appendChild(a,e),this._logger.debug("Uploaded code snippet",i),a}catch(e){return this._logger.error("Failed to upload the code snippet!"),null}}))}_uploadCodeSnippet(e,t,n){var a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{source:i}=e,r=l.N8.DomUtils.getInnerHTML(t),s=`${i}${p}${r}`,c=null===(a=this._scenarioFactory)||void 0===a?void 0:a.newScenario(m.RG.CodeSnippetUpload);try{const{objectId:e}=yield this._uploadToAMS(s,n,this._logger);return null==c||c.stop(),{objectId:e,uploadType:"AMS"}}catch(e){this._logger.error("_uploadCodeSnippet: code snippet upload to ams failed!"),null==c||c.fail();const{enableCacheStorageInSendMessageMW:t}=this._settings.get(o.J.Messaging);if(t){this._logger.debug("Trying to upload code snippet to cache storage");const{objectId:e}=yield this._uploadToCache(s,n,this._logger);return{objectId:e,uploadType:"OfflineCache"}}throw this._logger.debug("_uploadCodeSnippet: enableCacheStorageInSendMessageMW is not enabled!"),e}finally{null==c||c.stop()}}))}_uploadToAMS(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){n.log("Uploading to code snippet to ams");const{objectId:i}=yield t.asyncMediaService.uploadItem(e,t.conversationId,"DOCUMENT");return{objectId:i}}))}_uploadToCache(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{n.log("uploading inline image to offline cache storage");const[i,a]=yield t.offlineCacheManager.saveDynamic(new Response(e,{headers:new Headers({"Content-Type":"text/html","Cache-Control":"max-age=259200, s-maxage=0, private","Content-Length":`${e.length}`,Date:(new Date).toUTCString()})}));return n.log(`Uploaded image to offline cache, image: ${a} objectId: ${i}`),{objectId:i}}catch(e){throw n.error("_uploadToCache: uploading inline image to offline cache store failed!"),e}}))}_uploadAndUpdateCard(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{amsReferenceId:i}=t,{name:o,language:r,wrap:s}=t,l=a.messageProperties.cards||[];let c={objectId:i,uploadType:"AMS"};if(i||(c=yield this._uploadCodeSnippet(t,n,a)),"AMS"===c.uploadType){const e=a.messageProperties.amsReferences||[];a.messageProperties.amsReferences=[...e,c.objectId]}else if("OfflineCache"===c.uploadType){const e=a.messageProperties.offlineAssets||[];a.messageProperties.offlineAssets=[...e,c.objectId]}a.messageProperties.cards=[...l.filter((t=>t.cardClientId!==e)),{appId:e,cardClientId:e,contentType:u.p.CodeSnippet,content:JSON.stringify({type:u.p.CodeSnippet,editable:!0,id:e,name:o,language:r,wrap:s,lines:n.children?n.children.length:0,cardClientId:e,amsReferenceId:c.objectId})}],a.telemetryDatabag["DataBag.codeSnippets"]=(a.telemetryDatabag["DataBag.codeSnippets"]||0)+1}))}};g=(0,i.__decorate)([(0,s.HR)({name:"CodeSnippets",filter:{[r.$S]:"CodeSnippetCard"}})],g)},889803:(e,t,n)=>{"use strict";n.d(t,{D:()=>p});var i=n(231191),a=n(811675),o=n(533439),r=n(562093),s=n(536448),l=n(892891);const c=new RegExp(/animated-emoticon.*?/),d=/img|table/,u=e=>!!e&&(s.N8.DomUtils.getAttributeValue(e,"itemtype")===o.T.emoji||c.test(s.N8.DomUtils.getAttributeValue(e,"class")||"")||(0,r.x)(e)),m=3;let p=class{preTransform(e,t){const n=(0,l.isUndefined)(t.superSizeEmoticons)?0:t.superSizeEmoticons;var i;"br"===e.name?t.containsPotentiallyIncludedWhitespace=!0:(0,l.isNumber)(n)&&(t.superSizeEmoticons=u(e)?(i=n,!t.containsPotentiallyIncludedWhitespace&&i<m&&i+1):!(e=>e&&!u(e.parent)&&!(e.parent&&u(e.parent.parent))&&(d.test(e.name||"")||!(!e.data||!e.data.replace(" ","").replace(/[\u200B-\u200D\uFEFF]/g,"").trim())))(e)&&n)}};p=(0,i.__decorate)([(0,a.wx)({name:"BigEmoticonPreprocessor",filter:"*"})],p)},569069:(e,t,n)=>{"use strict";n.d(t,{D:()=>Ce,fh:()=>ke,Vf:()=>_e,bl:()=>be});var i=n(231191),a=n(811675),o=n(783642),r=n(147623),s=n(533439),l=n(536448),c=n(512526),d=n(892891),u=n(272009);let m=class{constructor(){this._removeExtraSpacesInMention=e=>{var t;null===(t=e.parent)||void 0===t||t.children.forEach((e=>{"text"===e.type&&" "===e.data&&l.N8.DomUtils.removeElement(e)}))},this._getMentionKey=e=>{var t,n,i;const a=null===(n=null===(t=e.children)||void 0===t?void 0:t[0])||void 0===n?void 0:n.data;return`${null===(i=e.attribs)||void 0===i?void 0:i[o.zj.mri]}_${a}`},this._mergeMentions=(e,t)=>{if(!e.attribs)return;const n=e.attribs[o.zj.mri]||"";let i=this._getNextContigousMention(e,n);for(;e.children&&e.children.length>0&&i;){const a=i.children;if(a&&a.length>0&&a[0].data){const n=this._getMentionKey(i),o=t.get(n);o?t.set(n,o+1):t.set(n,1),e.children[0].data+=` ${a[0].data}`}i=this._getNextContigousMention(i,n)}},this._getNextContigousMention=(e,t)=>{var n;if(!e||!e.next)return null;const i=e.next,a=t===(null===(n=null==i?void 0:i.attribs)||void 0===n?void 0:n[o.zj.mri]);return" "===i.data||a?i:null}}transform(e,t){var n;if(!(e&&t&&t.messageProperties&&l.N8.DomUtils.hasAttrib(e,o.zj.mri)))return;t.seenMentions||(t.seenMentions=new Map);const i=this._getMentionKey(e),a=t.seenMentions.get(i);if(a)return 1===a?t.seenMentions.delete(i):t.seenMentions.set(i,a-1),null;this._mergeMentions(e,t.seenMentions);const{messageProperties:u,telemetryDatabag:m}=t;u.mentions||(u.mentions=[]);const g=`${u.mentions.length}`,h=(0,c.Q)(e),v=(null===(n=null==e?void 0:e.attribs)||void 0===n?void 0:n[o.zj.type])||(p(e)?"bot":"person");m["DataBag.atmentions"]=(m["DataBag.atmentions"]||0)+1;const f=(0,c.ln)(r.s.span),y=(0,c.rw)((0,d.escape)(h)),S=l.N8.DomUtils.hasAttrib(e,o.zj.stale),k=l.N8.DomUtils.getAttributeValue(e,o.zj.mri)||"";return l.N8.DomUtils.appendChild(f,y),S||(u.mentions.push({itemId:g,displayName:h,userId:k,mentionType:v}),f.attribs[o.zj.itemtype]=s.T.mention,f.attribs[o.zj.itemscope]="",f.attribs[o.zj.itemid]=g),this._removeExtraSpacesInMention(e),f}};m=(0,i.__decorate)([(0,a.wx)({name:"AtMentionSerializer",filter:"mention"})],m);const p=e=>{var t;return(0,u.bl)((null===(t=null==e?void 0:e.attribs)||void 0===t?void 0:t[o.zj.mri])||"")};var g=n(674436),h=n(682796);let v=class{transform(e,t){const n=t.superSizeEmoticons?"large":"small",i=(0,g.cn)(n),a=t=>l.N8.DomUtils.getAttributeValue(e,t)||"",o=a("itemid");t.telemetryDatabag&&(t.telemetryDatabag["DataBag.emojiList"]=[...t.telemetryDatabag["DataBag.emojiList"]||[],`Skype.${o}`],t.telemetryDatabag["DataBag.emoji"]=t.telemetryDatabag["DataBag.emojiList"].length);const r=(0,c.ln)("span",{contenteditable:"false",title:a("title"),type:`(${o})`,class:`animated-emoticon-${i}-${o}`}),d=a("alt")||a("itemscope"),u=(0,c.ln)("img",{itemscope:"",itemtype:s.T.emoji,itemid:o,src:(0,g.rO)(o,n,t.coreSettings.get(h.J.Messaging),!1),title:a("title"),alt:d,style:`width:${i}px;height:${i}px;`});return l.N8.DomUtils.appendChild(r,u),r}};v=(0,i.__decorate)([(0,a.wx)({name:"EmoticonSerializer",filter:{itemtype:s.T.emoji}})],v);var f=n(28970),y=n(609356);let S=class{transform(e,t){const n=`${!!t.superSizeEmoticons?f.G4:f.Mw}px`;return e.attribs||(e.attribs={}),e.attribs.height=n,e.attribs.width=n,(0,c.A_)(e,{"max-height":n,"max-width":n,height:n,width:n}),e}};S=(0,i.__decorate)([(0,a.wx)({name:"EmojiOneSerializer",filter:{class:new RegExp(y.Uu)}})],S);var k=n(889803),b=n(76570),_=n(141064),C=n(356452),w=n(502201),T=n(980633);let E=class{constructor(){this.getImageBlobUrlFromCache=(e,t)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield e.offlineCacheManager.get(t),i=yield n.blob();return URL.createObjectURL(i)})),this.processCachedImage=(e,t)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var n;const i=l.N8.DomUtils.getAttributeValue(e,o.zj.cacheKey);if(!i)return void this._logger.error("Cached image missing key attribute.");this._logger.log(`processing cached image: ${i}`);const a=null===(n=this._scenarioFactory)||void 0===n?void 0:n.newScenario(T.RG.SerializeCachedImage);try{const n=l.N8.DomUtils.getAttributeValue(e,"src"),r=!!(null==n?void 0:n.startsWith("blob"));let s;if(r&&n)s=yield(0,w.Hk)(n);else{const e=yield t.offlineCacheManager.get(i);s=yield e.blob()}null==a||a.mark(T.ck.SerializeCachedImageGotData);const c=yield this.uploadImage(s,t);I(e,c,t),null==a||a.mark(T.ck.SerializeCachedImageUploadedData);const d=yield t.offlineCacheManager.delete(i);null==a||a.mark(T.ck.SerializeCachedImageDeletedEntry,void 0,d?"success":"failure"),d||this._logger.warn(`Failed to delete cached image with key: ${i}`),e.attribs&&delete e.attribs[o.zj.cacheKey],r&&n&&(URL.revokeObjectURL(n),null==a||a.mark(T.ck.SerializeCachedImageRevokedBlobUrl))}catch(e){throw this._logger.error(`processCachedImage: Failed to process cached image with key=${i}`),null==a||a.fail(),e}finally{null==a||a.stop()}return e}))}transform(e,t){if(this._logger=t.loggerFactory.newLogger("InlineImageSerializer"),!this.isConfigValid(t))return this._logger.error("invalid config"),Promise.resolve(void 0);this._scenarioFactory=t.scenarioFactory,this._settings=t.coreSettings;const n=l.N8.DomUtils.getAttributeValue(e,"src");if(!n)return this._logger.error("image src is missing"),Promise.resolve(void 0);const i=(0,b.KD)(n);if(i)return this.handleAmsSourceTag(i,e,t);return l.N8.DomUtils.getAttributeValue(e,o.zj.itemtype)===s.T.cachedImage?this.processCachedImage(e,t):n.startsWith("http://")||n.startsWith("https://")?(0,_.kf)(n)?this.processKnownImage(n,t.telemetryDatabag):this.handleKnownProtcolSourceTag(n,"HttpUrl",e,t):n.startsWith("blob:")?this.handleKnownProtcolSourceTag(n,"BlobUrl",e,t):(this._logger.error("Unsupported image! deleting it."),Promise.resolve(null))}handleAmsSourceTag(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const i="AMS",a=yield n.asyncMediaService.forwardContent(e,n.conversationId);return this._logger.log(`forwarded ams image ${e} to ${a.objectId}`),n.messageProperties.amsReferences=[...n.messageProperties.amsReferences||[],a.objectId],I(t,Object.assign(Object.assign({},a),{uploadType:i}),n),t}catch(e){throw this._logger.error("handleAmsSourceTag: forward content failed!"),e}}))}handleKnownProtcolSourceTag(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const i=yield N(e,t,a),o=yield this.uploadImage(i,a);return I(n,o,a),n}catch(e){throw this._logger.error("handleKnownProtcolSourceTag: pasted from web image upload failed"),this.addDiagnosticCodeToError(e),e}}))}uploadImage(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{return yield this.uploadImageToAms(e,t,this._logger)}catch(n){this._logger.error("uploadImage: image upload to AMS failed!");const{enableCacheStorageInSendMessageMW:i}=this._settings.get(h.J.Messaging);if(i){this._logger.debug("Trying to upload inline image to cache storage");return yield this.uploadToCache(e,t,this._logger)}throw this._logger.debug("uploadImage: enableCacheStorageInSendMessageMW is not abled"),n}}))}uploadImageToAms(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=t.asyncMediaService.createAmsScenario(T.RG.AmsImageUpload);try{const a="AMS",o=yield t.asyncMediaService.uploadItem(e,t.conversationId,"IMAGE","MicrosoftTeams-image.png");return n.log(`Uploaded image to ams, image: ${o.inlineSizeUrl} objectId: ${o.objectId}`),i.stop(),t.messageProperties.amsReferences=[...t.messageProperties.amsReferences||[],o.objectId],Object.assign(Object.assign({},o),{uploadType:a})}catch(e){throw i.fail({errors:e.message}),n.error("Ams image upload failed!"),e}}))}uploadToCache(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{n.log("uploading inline image to offline cache storage");const[i,a]=yield t.offlineCacheManager.saveDynamic(new Response(e,{headers:new Headers({"Content-Type":e.type,"Cache-Control":"max-age=259200, s-maxage=0, private","Content-Length":`${e.size}`,Date:(new Date).toUTCString()})}));n.log(`Uploaded image to offline cache, image: ${a} objectId: ${i}`);const o="OfflineCache";t.messageProperties.offlineAssets=[...t.messageProperties.offlineAssets||[],i];return{objectId:i,inlineSizeUrl:yield this.getImageBlobUrlFromCache(t,i),uploadType:o}}catch(e){throw n.error("uploadToCache: uploading inline image to offline cache store failed!"),e}}))}isConfigValid(e){return!!(e&&e.asyncMediaService&&e.messageProperties&&e.imageProxyService&&e.conversationId&&e.telemetryDatabag&&e.offlineCacheManager)}processKnownImage(e,t){return e.endsWith(".gif")&&(t["DataBag.giphy"]=(t["DataBag.giphy"]||0)+1),Promise.resolve(void 0)}addDiagnosticCodeToError(e){if(e.serverResponse&&e.serverResponse.status){switch(e.serverResponse.status){case C.qb.UNSUPPORTED_MEDIA_TYPE:e.reason=Object.assign(Object.assign({},e.reason),{errorCode:b.hA.IMAGE_SIZE_TOO_LARGE})}}}};E=(0,i.__decorate)([(0,a.HR)({name:"InlineImageSerializer",filter:["img","image"]})],E);const I=(e,t,n)=>{e.attribs||(e.attribs={});const i=e.attribs.src;e.attribs.id=t.objectId,e.attribs.itemid=t.objectId,e.attribs.href=t.inlineSizeUrl,e.attribs["target-src"]=t.inlineSizeUrl,e.attribs.src=t.inlineSizeUrl,e.attribs[o.zj.itemtype]="AMS"===t.uploadType?s.T.amsImage:s.T.cachedImage,i&&i.startsWith("blob")&&URL.revokeObjectURL(i),n.telemetryDatabag["DataBag.inlineImages"]=(n.telemetryDatabag["DataBag.inlineImages"]||0)+1},N=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){let i=null;return"BlobUrl"===t?i=yield(0,w.Hk)(e):"HttpUrl"===t&&(i=yield n.imageProxyService.getImageAsBlob(e)),i}));let A=class{transform(e){return e.attribs||(e.attribs={}),e.attribs.class="copy-paste-table",e.attribs.itemprop="copy-paste-table",e}};A=(0,i.__decorate)([(0,a.wx)({name:"TableSerializer",filter:"table",transient:!0})],A);let M=class{transform(e){return(0,d.isEmpty)(e.children)&&l.N8.DomUtils.appendChild(e,(0,c.rw)(" ")),e}};M=(0,i.__decorate)([(0,a.wx)({name:"TableCellSerializer",filter:"td",transient:!0})],M);var F=n(550635);let R=class{transform(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=t.coreSettings.get(h.J.Extensibility).postSendTimeoutInMs||2e3,{areUrlPreviewsAllowed:i}=t.coreSettings.get(h.J.Messaging);if(!!!i||!t.connectedExperienceEnabled||!e||!t.messageProperties||t.messageProperties.urlPreview||!t.urlPreviewService||!t.appBasedLinkService||!l.N8.DomUtils.hasAttrib(e,"href"))return;const a=t.loggerFactory.newLogger("UrlPreviewSerializer"),o=encodeURI(e.attribs.href),r=[this.getUrlPreviewFromAppTimed(o,n,t,a),this.getUrlPreviewTimed(o,n,t,a)],[s,c]=yield Promise.all(r),d=s||c&&P(c);return d?(t.messageProperties.urlPreview=d,e):void 0}))}getUrlPreviewFromAppTimed(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{enableAppBasedLink:i}=n.coreSettings.get(h.J.Extensibility);if(!i)return Promise.resolve(void 0);const o=n.getInstalledMessageExtensionApps();try{return yield(0,F.E)(n.appBasedLinkService.getUrlPreviewFromApp(e,o,n.convId),t,"post send app preview timed out")}catch(t){return void a.warn(`fetching app preview for url: ${e} failed with error: ${t}`)}}))}getUrlPreviewTimed(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{return yield(0,F.E)(n.urlPreviewService.getPreview(e),t,"url preview timed out")}catch(t){return void a.warn(`fetching url preview for url: ${e} failed with error: ${t}`)}}))}};R=(0,i.__decorate)([(0,a.HR)({name:"URLPreviewSerializer",filter:"a",transient:!0})],R);const P=e=>({url:e.url,title:e.title,description:e.description,previewEnabled:!0,thumbnail:e.thumbnail,thumbnailMeta:e.thumbnail_meta}),D="data-only-whitespace",j=/^(\s|[\u200B-\u200D\uFEFF])*$/;let x=class{preTransform(e,t){return O(e)?void(t.whiteSpaceId&&t.whiteSpaceId++):(t.whiteSpaceId||(t.whiteSpaceId=1),e.attribs||(e.attribs={}),e.attribs[D]=`${t.whiteSpaceId+1}`,e)}};x=(0,i.__decorate)([(0,a.wx)({name:"WhiteSpacePreprocessor",filter:["div","p","br","span","text"],transient:!0})],x);const O=e=>!j.test((0,c.Q)(e))||!!l.N8.DomUtils.findOne((e=>{if(e.attribs&&Object.keys(e.attribs).length||!e.name)return!0;switch(e.name.toLowerCase()){case"br":case"div":case"p":case"span":break;default:return!0}return!1}),[e]);let L=class{transform(e,t){const n=l.N8.DomUtils.getAttributeValue(e,D);return!t.whiteSpaceId||!n||+n>t.whiteSpaceId?null:(e.attribs&&delete e.attribs[D],e)}};L=(0,i.__decorate)([(0,a.wx)({name:"TrailingWhiteSpaceSerializer",filter:[D],transient:!0})],L);let U=class{preTransform(e){return null}};U=(0,i.__decorate)([(0,a.wx)({name:"RemoveHiddenSelectionSerializer",filter:["data-cke-hidden-sel"]})],U);var B=n(554067),W=n(907252),H=n(71629);const $=e=>{e&&l.N8.DomUtils.hasAttrib(e,o.zj.type)&&delete e.attribs[o.zj.type]};var V=n(799533),z=n(866020),G=n(635649);const q={fileDetailsPromiseResolved:"file_deatails_promise_resolved"};let J=class{constructor(){this._allowAsyncChicletCreation=!1,this._asyncLinkConversionDetailsByItemId=new Map,this._loggerCb=d.noop,this._timeout=0}preTransform(e,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!e||!t||!l.N8.DomUtils.hasAttrib(e,"href"))return;this._setupConstants(t);const i=e.attribs[o.zj.itemid];if(i){if(this._allowAsyncChicletCreation&&l.N8.DomUtils.hasAttrib(e,o.zj.type)&&e.attribs[o.zj.type]===H.le.asyncLinkToChicletConversionIdentifier){const a=(0,d.unescape)(e.attribs.href),{fileReferenceService:o}=t,r=o.parseFileLabelFromUrl(a);if(!r)return void $(e);const s=null===(n=this._scenarioFactory)||void 0===n?void 0:n.newScenario(T.RG.AsyncLinkToChiclet),l=this._asyncLinkConversionDetailsByItemId.get(i);if(l)return void re(l,a,s,(e=>this._asyncLinkConversionDetailsByItemId.set(i,e)));try{const e=(0,F.E)(o.getFileDetails(r,"chat",["fluid"]),this._timeout,"file details call timed out");this._asyncLinkConversionDetailsByItemId.set(i,{fileDetailsPromise:e,scenario:s,linkInfo:{href:a,count:1}})}catch(t){const n=(null==t?void 0:t.message)||"";return oe(e,s,n)}}return e}}))}transform(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!(e&&l.N8.DomUtils.hasAttrib(e,"href")&&t&&t.files&&t.messageProperties&&t.existingLinks))return;const n=e.attribs[o.zj.itemid];if(!n)return;const i=this._asyncLinkConversionDetailsByItemId.get(n);if(i){const{scenario:n}=i;try{const a=yield Q(t,e,i);return n&&n.stop(),a}catch(t){return $(e),void(0,V.V)(t,this._loggerCb,n)}}if(!l.N8.DomUtils.hasAttrib(e,o.zj.itemProps))return ae(e,t);const{files:a}=t;try{const i=ie(a,e);if(!i)return;const{shareUrl:o,title:r}=i;o&&(e.attribs.href=o),X(e,r,o),Y(i,n,t)}catch(e){return}return e}))}_setupConstants({coreSettings:e,loggerFactory:t,scenarioFactory:n}){this._loggerCb=K(t.newLogger("SharepointLinkSerializer")),this._scenarioFactory=n;const{enableFilesAsyncChicletCreationInMultiWindow:i,asyncChicletCreationTimeout:a}=e.get(h.J.Files);this._allowAsyncChicletCreation=!!i,this._timeout=a||3e3}};J=(0,i.__decorate)([(0,a.HR)({name:"SharepointLinkSerializer",filter:"a"})],J);const K=e=>t=>{e.error(t)},Q=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{fileDetailsPromise:i,scenario:a}=n,o=yield i;return a&&a.mark(q.fileDetailsPromiseResolved),Y(o,o.fileId,e),((e,t)=>{const{files:n}=t;return-1!==n.findIndex((t=>t.id===e.fileId))})(o,e)||ne(e,(({objectUrl:e,shareUrl:t,type:n,fileId:i,title:a,baseUrl:o,shareId:r,fileSourceDetail:s})=>{const l=(0,z.gD)(e),{permissionScope:c}=s||{permissionScope:""};return{id:i,baseUrl:o,objectUrl:e,shareUrl:t,shareId:r,type:n,title:a,permissionScope:c,state:G.FileChicletState.reference,isReferencedFile:!0,serviceName:G.FileViewServiceName.p2p,previewUrl:"",chicletBreadcrumbs:{sourceChannelName:(null==l?void 0:l.sourceChannelName)||null,sourceTeamName:(null==l?void 0:l.sourceTeamName)||null},previewHeight:null,previewWidth:null,progressComplete:null,hasUploadFailed:!1}})(o)),$(t),t})),Y=(e,t,n)=>{const{objectUrl:i,shareUrl:a,title:o,type:r}=e,s=ee({objectUrl:i,shareUrl:a,itemid:t,type:r,title:o});te(n,s)},X=(e,t,n)=>{e.children&&Z(t,e,n)},Z=(e,t,n)=>{const i=[t];for(;0!==i.length;){const a=i.pop();if(a&&a.children)for(const o of a.children){if("text"===o.type&&(0,d.startsWith)(o.data,"https"))return o.data=e,t.attribs&&(t.attribs.title=n),!0;i.push(o)}}return!1},ee=({objectUrl:e,shareUrl:t,itemid:n,type:i,title:a})=>({title:a,objectUrl:e,description:"",fileShareUrlMeta:{id:n,objectUrl:e,type:i,shareUrl:t}}),te=(e,t)=>{e.messageProperties.embeddedLinks=[...e.messageProperties.embeddedLinks||[],t],e.telemetryDatabag["DataBag.links"]=(e.telemetryDatabag["DataBag.links"]||0)+1},ne=(e,t)=>{e.files.push(t)},ie=(e,t)=>{const n=t.attribs[o.zj.itemid],i=e.find((e=>e.id===n));if(i){const{shareUrl:e,title:t,objectUrl:n,type:a}=i;return{shareUrl:e||"",title:t||"",type:a||"",objectUrl:n||""}}if(t.attribs[o.zj.itemtype]===s.T.filesHyperlink){const e=t.attribs[o.zj.itemProps];if(e){const t=(0,d.unescape)((0,d.unescape)(e)),n=JSON.parse(t),{type:i,objectUrl:a,shareUrl:o,title:r}=n;return{shareUrl:o,title:r,objectUrl:a,type:i}}}},ae=(e,t)=>{if(l.N8.DomUtils.hasAttrib(e,"href")){const n=e.attribs.href,i=t.existingLinks.filter((e=>{var t;return(null===(t=e.fileShareUrlMeta)||void 0===t?void 0:t.shareUrl)===n}));if(i&&i.length&&i[0].fileShareUrlMeta)return te(t,(0,W.i)(i[0],"__typename")),e}},oe=(e,t,n)=>{$(e),null==t||t.fail({errorCode:H.le.telemetry.errorCodes.asyncLinkConversionPretransformFailure,errors:JSON.stringify(n)})},re=(e,t,n,i)=>{const{linkInfo:a}=e;let o="";if(a&&t===a.href){const{count:n}=a;o=`Duplicate links: ${n}`,i(Object.assign(Object.assign({},e),{linkInfo:{href:t,count:n+1}}))}else o="Different href for same itemid";null==n||n.incomplete({errorCode:H.le.telemetry.errorCodes.asyncLinkMultiplePretransform,errors:o})};let se=class{transform(e){if(e.data&&f.Eh.test(e.data))return e.data=e.data.replace(new RegExp(f.Eh,"g"),""),e}};se=(0,i.__decorate)([(0,a.wx)({name:"RemoveZwsSerializer",filter:"text",transient:!0})],se);var le=n(664730);const ce=(e,t,n)=>{e.forEach((e=>de(e,t,n)))},de=(e,t,n)=>{(0,le.gU)(e,{type:"TextBlock"},(e=>{ue(e.text,t,n)})),(0,le.gU)(e,{type:"FactSet"},(e=>{e.facts.forEach((e=>{ue(e.title,t,n),ue(e.value,t,n)}))}))},ue=(e,t,n)=>{const i=e.toLowerCase(),a='itemid="',o=i.indexOf(a),r=o+a.length;if(o>-1){const a=i.substring(r,r+1);if(t&&a){const i=me(a,t,n);i&&(e=e.replace(new RegExp(a,"g"),i))}}},me=(e,t,n)=>{let i="";return t.forEach((t=>{if(t.itemId===e){const{messageProperties:e,telemetryDatabag:a}=n;e.mentions||(e.mentions=[]),i=`${e.mentions.length}`;const o=t.displayName||"",r=t.mentionType||"",s=t.userId||"";a["DataBag.atmentions"]=(a["DataBag.atmentions"]||0)+1,e.mentions.push({itemId:i,displayName:o,userId:s,mentionType:r})}})),i};let pe=class{transform(e,t){if(!e||!t||!t.messageProperties)return;const{loggerFactory:n}=t,a=n.newLogger("MessageExtensionCardSerializer"),o=(0,d.unescape)(l.N8.DomUtils.getAttributeValue(e,f.Qq)),r=l.N8.DomUtils.getAttributeValue(e,f.fK);if(!o)return a.error("The props was missing"),null;if(!r)return a.error("The id of the card was missing"),null;try{const e=t.messageProperties.cards||[],{card:n}=JSON.parse(o);if(!(0,d.isObject)(n))throw new Error("not valid JSON object");(0,d.isString)(n.contentType)&&n.contentType.toLowerCase()===le.sj.Adaptive&&n.content&&((e,t)=>{const n=JSON.parse(e),i=n.body,a=(0,le.NI)(n);a&&i&&ce(i,a,t)})(n.content,t);const{__typename:a}=n,u=(0,i.__rest)(n,["__typename"]);u.cardClientId=r,t.messageProperties.cards=[...e,u];const m=(0,c.ln)("span",{content:r,itemprop:"cardId"}),p=(0,c.ln)("span",{class:"inline-compose-card",itemid:r,itemscope:"",itemtype:s.T.inputExtension});return l.N8.DomUtils.appendChild(p,m),p}catch(e){return a.error("Error while adding message extension card to message",e),null}}};pe=(0,i.__decorate)([(0,a.wx)({name:"MessageExtension",filter:{[f.$S]:"MessageExtensionCard"}})],pe);var ge=n(188682);let he=class{constructor(){}transform(e,t){const{loggerFactory:n}=t;if(!e)return;const i=(0,d.unescape)(l.N8.DomUtils.getAttributeValue(e,f.Qq));if(!i)return;const a=(0,ge.D)(i);if((0,d.isEmpty)(a))return void n.newLogger("QuotedReplySerializer").error("Json parsing failed: ",i);const{from:o,messageId:r,preview:u,timestamp:m,userName:p}=a;if(!(o&&r&&u&&p))return void n.newLogger("QuotedReplySerializer").error("Json parsing failed: ",i);const g=(0,c.ln)("blockquote",{itemscope:"",itemtype:s.T.reply,itemid:r}),h=(0,c.ln)("strong",{itemprop:"mri",itemid:o}),v=(0,c.rw)((0,d.escape)(p));if(l.N8.DomUtils.appendChild(h,v),l.N8.DomUtils.appendChild(g,h),m){const e=(0,c.ln)("span",{itemprop:"time",itemid:m.toString()});l.N8.DomUtils.appendChild(g,e)}const y=(0,c.ln)("p",{itemprop:"preview"}),S=(0,c.rw)((0,d.escape)(u));return l.N8.DomUtils.appendChild(y,S),l.N8.DomUtils.appendChild(g,y),g}};he=(0,i.__decorate)([(0,a.wx)({name:"QuotedReply",filter:{[f.$S]:"QuotedReplyCard"}}),(0,i.__metadata)("design:paramtypes",[])],he);var ve=n(264307),fe=n(77791);let ye=class{transform(e,t){const n=l.N8.DomUtils.getAttributeValue(e,"href");if(!n||!e.attribs)return;const i=n.replace(/&amp;/g,"&");l.N8.DomUtils.getAttributeValue(e,o.zj.itemProps)&&delete e.attribs[o.zj.itemProps];const a={appId:"fluid-card",cardClientId:(0,ve.Z)(),contentType:fe.p.Fluid,content:JSON.stringify({componentUrl:i})};return t.messageProperties.cards=[a],t.files=void 0,e}};ye=(0,i.__decorate)([(0,a.wx)({name:"FluidSerializer",filter:{itemtype:s.T.fluidLink}})],ye);let Se=class{transform(e,t){if(!e.attribs)return void t.logger.error("image attribs is missing");const n=l.N8.DomUtils.getAttributeValue(e,o.zj.cacheKey);if(n&&n.length)return e.attribs["data-cke-saved-src"]=void 0,e.attribs.src=t.offlineCacheManager.getCachedUrlByKey(n),e;t.logger.error("image missing cache key")}};Se=(0,i.__decorate)([(0,a.wx)({name:"CachedImageSerializer",filter:[{itemtype:s.T.cachedImage}]})],Se);const ke=[m],be=[se,U,k.D,m,M,A,v,S,x,L,ye,pe,he],_e=[E,B.O,R,J],Ce=[Se]},609356:(e,t,n)=>{"use strict";n.d(t,{hE:()=>i,Uu:()=>a,pT:()=>o,ez:()=>r,rW:()=>s,vH:()=>l});const i=20,a="emojione",o="^:(middle_fin|ok_hand)",r="sake|cocktail|wine|wine_glass|beers?|champagne|tropical_drink|bomb",s="https://statics.teams.cdn.office.net/evergreen-assets/emojioneassets/assets-png/",l=".png"},562093:(e,t,n)=>{"use strict";n.d(t,{x:()=>r,B:()=>s});var i=n(609356),a=n(536448);const o=new RegExp(i.Uu),r=e=>o.test(a.N8.DomUtils.getAttributeValue(e,"class")||""),s=(e,t="")=>{const n=`max-height: ${i.hE}px; max-width: ${i.hE}px; height: ${i.hE}px; width: ${i.hE}px`;return`<img class="${i.Uu}" alt="${t}" src="${e}" width="${i.hE}" height="${i.hE}" style="${n}"/>`}},674436:(e,t,n)=>{"use strict";n.d(t,{L1:()=>l,xU:()=>d,if:()=>u,I:()=>m,Q4:()=>p,uT:()=>g,js:()=>h,_R:()=>v,rO:()=>f,cn:()=>y,Du:()=>S,rJ:()=>k,$w:()=>b,oM:()=>_,TG:()=>C,th:()=>w,QX:()=>T,ct:()=>I,WK:()=>N});var i=n(28970),a=n(533439),o=n(785814),r=n(756532),s=n(593909);const l=4250,c=new Map([["angry","angryV2"]]),d=(e,t)=>"legacy"===t||!e.enableSkypeCMSEmoticons&&"skype"!==t?e.emoticonCdnAssetsUrl||"https://statics.teams.cdn.office.net/evergreen-assets/skype/v2":e.pesEmoticonCdnAssetsUrl||"https://statics.teams.cdn.office.net/evergreen-assets/personal-expressions/v1/assets/emoticons",u=(e,t,n=!1,i=!0)=>{var a;const r=e.description;if(!i&&!n)return r;const{id:s,skinTone:l}=(0,o.M)(e.id),c=(null===(a=e.shortcuts)||void 0===a?void 0:a[0])||`(${s})`;if(e.diverse){const e=t.stringTranslate("funstuff",`emoticon_skintone_${o.j[l].name}`);return n?t.stringTranslate("funstuff","emoticon_combined_skintone_title",{name:r,skinTone:e,shortName:c}):t.stringTranslate("funstuff","emoticon_name_with_skintone",{name:r,skinTone:e})}return n?t.stringTranslate("funstuff","emoticon_combined_title",{name:r,shortName:c}):r},m=(e,t,n)=>{var i,a;const{id:r}=(0,o.M)(e.id),s=(null===(a=null===(i=e.shortcuts)||void 0===i?void 0:i[0])||void 0===a?void 0:a.slice(1,-1))||r;return n?t.stringTranslate("funstuff","emoticon_aria_combined_title",{name:u(e,t,!1,n),shortName:s,openingParenthesis:t.stringTranslate("funstuff","emoticon_aria_opening_parenthesis"),closingParenthesis:t.stringTranslate("funstuff","emoticon_aria_closing_parenthesis")}):e.description},p=(e,t,n=!1)=>e in s.uU?f(g(e,t,n),"small",{enableSkypeCMSEmoticons:t},!0):void 0,g=(e,t,n=!1)=>t?n?(0,r.Z)(e):s.uU[e]:s.Ao[e],h=(e,t=!1)=>{Object.keys(s.uU).forEach((n=>{const i=p(n,e,t);if(i){(new Image).src=i}}))},v=(e,t)=>t.stringTranslate("funstuff",`emoticon_${e}_keywords`),f=(e,t,n,i=!0,a="",r=!1,s=!1,l=null)=>{const u=s?S(t,l,r):y(t,r),{id:m,skinTone:p}=(0,o.M)(e);if(!n||!n.enableSkypeCMSEmoticons&&_(m)&&0===p||s){const e=c.get(m)||m;return`${d(n,"legacy")}/${e}/${u}${i?"a":""}.png`}{const e=p+1,t=0!==p?`_s${e}`:"",o=i?"_anim":"",r=a&&""!==a?`?${a}`:"";return`${d(n,"skype")}/${m}/default/${u}${o}_f${t}.png${r}`}},y=(e,t=!1)=>{switch(e){case"extra-large":return i.hU;case"large":return t?i.hU:i.G4;case"medium":return t?i.$y:i.ZO;case"extra-small":return t?i.Mw:i.fs;case"small":default:return t?i.G4:i.Mw}},S=(e,t=null,n=!1)=>{const i=k(e,t);return n?2*i:i},k=(e,t=null)=>{switch(e){case"meeting-giant":return(null==t?void 0:t.xxxLargeIconSize)||224;case"meeting-jumbo":return(null==t?void 0:t.xxLargeIconSize)||168;case"meeting-overlay":return(null==t?void 0:t.overlayIconSize)||64;case"extra-large":return(null==t?void 0:t.xLargeIconSize)||140;case"large":return(null==t?void 0:t.largeIconSize)||112;case"medium":return(null==t?void 0:t.mediumIconSize)||84;case"small":return(null==t?void 0:t.smallIconSize)||56;case"extra-small":return(null==t?void 0:t.xSmallIconSize)||42;case"meeting-tiny":default:return(null==t?void 0:t.xxSmallIconSize)||32}},b=e=>{switch(e){case i.hU:case i.$y:return i.G4;case i.G4:return i.ZO;case i.ZO:return i.Mw;default:return e}},_=e=>s.uQ.has(e)||s.Ye.has(e),C=e=>{var t,n;return(null===(t=s.uQ.get(e))||void 0===t?void 0:t.unicode)||(null===(n=s.Ye.get(e))||void 0===n?void 0:n.unicode)||void 0},w=(e,t,n,r)=>{if(!e)return t.document.createElement("span");const{id:s,skinTone:l}=(0,o.M)(e.id);let c=`${e.description}`;if(0!==l){const t=`emoticon_skintone_${o.j[l].name}`;c=n.stringTranslate("funstuff","emoticon_name_with_skintone",{name:e.description,skinTone:n.stringTranslate("funstuff",t)})}const d="small",u=t.document.createElement("img"),m=`${y(d)}px`;u.setAttribute("src",f(e.id,d,r,!1,e.etag,t.isHighResolution)),u.setAttribute("alt",e.description),u.setAttribute("draggable","false"),u.setAttribute("width",m),u.setAttribute("height",m),u.setAttribute("aria-label",e.description),u.style.overflow="hidden",u.style.margin="0 1px",r.enableSkypeCMSEmoticons||"yes"!==s||(u.style.transform="scaleX(-1)");const p=t.document.createElement("span");p.textContent=c,p.style.fontSize="0";const g=t.document.createElement(i.Od);return g.setAttribute("contenteditable","false"),g.setAttribute("title",c),g.setAttribute("itemid",e.id),g.setAttribute("itemtype",a.T.emoji),g.setAttribute("itemscope",e.unicode||c),g.setAttribute("aria-label",e.description),g.appendChild(u),g.appendChild(p),g},T=(e,t,n,i=!0,a="funstuff")=>{const o=s.uQ.get(e)||s.Ye.get(e);if(!o)throw new RangeError(`Invalid emoticon ${e}`);const r=o.steps,l=r/o.duration;return{id:e,description:t&&i&&t.stringTranslate(a,`emoticon_${o.pastName||e}_name`)||n||e,unicode:o.unicode,etag:"",animation:{fps:l,firstFrame:"kiss"===e?30:1,framesCount:r}}};let E;const I=()=>(E||(E=new Map,s.uQ.forEach(((e,t)=>e.shortcuts.forEach((e=>E.set(e.toLowerCase(),t)))))),E),N=e=>I().get(e)},785814:(e,t,n)=>{"use strict";n.d(t,{j:()=>i,M:()=>a});const i=[{name:"default"},{name:"light",code:57339},{name:"medium_light",code:57340},{name:"medium",code:57341},{name:"medium_dark",code:57342},{name:"dark",code:57343}],a=e=>{const t=e.match(/(\S+)-tone(\S+)/);return t&&3===t.length?{id:t[1],skinTone:Number.parseInt(t[2],10)}:{id:e,skinTone:0}}},756532:(e,t,n)=>{"use strict";n.d(t,{I:()=>o,Z:()=>r});const i={like:"likeWithFaceMSER",star:"starMSER",yes:"like"},a={angry:"angryface",like:"yes",likeWithFaceMSER:"like",starMSER:"star"},o=e=>{var t;return null!==(t=i[e])&&void 0!==t?t:e},r=e=>{var t;return null!==(t=a[e])&&void 0!==t?t:e}},593909:(e,t,n)=>{"use strict";n.d(t,{uQ:()=>i,Ye:()=>a,uU:()=>o,Ao:()=>r,c$:()=>s});const i=new Map([["smile",{unicode:"🙂",shortcuts:[":)",":-)",":=)","(smile)"],duration:2.2083,steps:53}],["laugh",{unicode:"😁",shortcuts:[":d",":-d",":=d","(laugh)",":>",":->","(lol)"],duration:3.2083,steps:77}],["heart",{unicode:"❤️",shortcuts:["(heart)","<3"],duration:.7083,steps:16}],["kiss",{unicode:"😘",shortcuts:["(kiss)",":*",":-*",":=*","(xo)"],duration:2.875,steps:50}],["sad",{unicode:"🙁",shortcuts:[":(",":-(",":=(","(sad)",":<",":-<"],duration:2.625,steps:63}],["tongueout",{unicode:"😋",shortcuts:[":p",":-p",":=p","(tongueout)","(yum)"],duration:2.9583,steps:71}],["wink",{unicode:"😉",shortcuts:[";)",";-)",";=)","(wink)"],duration:1.5,steps:36}],["cry",{unicode:"😭",shortcuts:[";(",";-(",";=(","(cry)",":'("],duration:2.0833,steps:50}],["inlove",{unicode:"😍",shortcuts:["(inlove)","(love)",":]",":-]"],duration:2.625,steps:63}],["hug",{unicode:"🤗",shortcuts:["(hug)","(bear)"],duration:3.1667,steps:76}],["cwl",{unicode:"😂",shortcuts:["(cwl)","(cryingwithlaughter)"],duration:2.5417,steps:61}],["lips",{unicode:"💋",shortcuts:["(lips)"],duration:3.7083,steps:89}],["blush",{unicode:"😊",shortcuts:[":$",":-$",":=$",':">',"(blush)"],duration:2.875,steps:69}],["surprised",{unicode:"😮",shortcuts:[":o",":-o",":=o","(surprised)"],duration:2.8333,steps:68}],["penguin",{unicode:"🐧",shortcuts:["(penguin)","(dancingpenguin)","(penguindance)"],duration:2.6667,steps:64}],["yes",{unicode:"👍",shortcuts:["(y)","(yes)","(thumbsup)"],duration:1.6667,steps:40}],["cool",{unicode:"😎",shortcuts:["(cool)","8-)","8=)","b-)","b=)","(sunglasses)"],duration:1.5833,steps:38}],["rofl",{unicode:"🤣",shortcuts:["(rofl)","(rotfl)"],duration:3.375,steps:81}],["cat",{unicode:"🐱",shortcuts:["(cat)","(meow)","(kitty)"],duration:5,steps:120}],["monkey",{unicode:"🐵",shortcuts:["(monkey)","(ape)"],duration:2.0833,steps:50}],["hi",{unicode:"👋",shortcuts:["(wave)","(hi)","(bye)"],duration:2.375,steps:57}],["snowangel",{unicode:"⛄",shortcuts:["(snowangel)"],duration:2.5,steps:60}],["flower",{unicode:"🌼",shortcuts:["(flower)"],duration:3.4583,steps:83}],["giggle",{unicode:"🤭",shortcuts:["(chuckle)","(giggle)"],duration:1.875,steps:45}],["devil",{unicode:"😈",shortcuts:["(devil)"],duration:2.7917,steps:67}],["party",{unicode:"🎉",shortcuts:["(party)","<o)","<:o)"],duration:2.9583,steps:71}],["worry",{unicode:"😨",shortcuts:["(worry)",":s",":-s",":=s","(worried)","(scared)"],duration:2.3333,steps:56}],["champagne",{unicode:"🍾",shortcuts:["(champagne)","(sparkling)"],duration:2.5833,steps:62}],["sun",{unicode:"🌞",shortcuts:["(sun)"],duration:1.0833,steps:26}],["star",{unicode:"⭐",shortcuts:["(star)"],duration:2.6667,steps:64}],["polarbear",{unicode:"🐻",shortcuts:["(polarbear)","(polarbearhug)"],duration:5,steps:120}],["dull",{unicode:"🙄",shortcuts:["|-(","|(","|=(","(dull)","(eyeroll)"],duration:3.2083,steps:77}],["speechless",{unicode:"😐",shortcuts:[":|",":-|",":=|","(speechless)"],duration:2.7917,steps:67}],["wonder",{unicode:"🤨",shortcuts:[":^)","(wonder)","(skeptical)"],duration:2.9167,steps:70}],["angry",{unicode:"😡",shortcuts:["(angry)",":@",":-@",":=@","x(","x-(","x=(",";@",";-@","(rage)"],duration:4.375,steps:105}],["puke",{unicode:"🤮",shortcuts:["(puke)",":&",":-&",":=&","+o("],duration:3.2917,steps:79}],["facepalm",{unicode:"🤦‍",shortcuts:["(facepalm)","(fail)"],duration:3.2083,steps:77}],["sweat",{unicode:"😓",shortcuts:["(:|","(sweat)"],duration:2.875,steps:69}],["holidayspirit",{unicode:"🎉",shortcuts:["(holidayspirit)","(crazyxmas)","(crazychristmas)"],duration:1.5,steps:36}],["sleepy",{unicode:"😴",shortcuts:["|-)","i-)","i=)","(snooze)","(sleepy)","(sleeping)"],duration:3,steps:72}],["bow",{unicode:"🙇",shortcuts:["(bow)"],duration:2.5,steps:60}],["makeup",{unicode:"💄",shortcuts:["(makeup)"],duration:4.5,steps:108}],["cash",{unicode:"💰",shortcuts:["(cash)","(money)"],duration:1.125,steps:27}],["lipssealed",{unicode:"🤐",shortcuts:[":x",":-x",":#",":-#",":=x",":=#","(lipssealed)"],duration:2.0833,steps:50}],["shivering",{unicode:"🥶",shortcuts:["(shivering)","(cold)","(freezing)"],duration:7.9167,steps:190}],["cake",{unicode:"🎂",shortcuts:["(cake)"],duration:4.125,steps:99}],["headbang",{unicode:"🤦‍♂️",shortcuts:["(headbang)","(banghead)"],duration:2.9583,steps:71}],["dance",{unicode:"🕺",shortcuts:["o/",":d/","(dance)"],duration:8.5833,steps:206}],["wasntme",{unicode:"😏",shortcuts:["(wasntme)"],duration:3.1667,steps:76}],["hungover",{unicode:"😵",shortcuts:["(hungover)"],duration:3.0417,steps:73}],["yawn",{unicode:"😩",shortcuts:["(yawn)"],duration:3.0833,steps:74}],["gift",{unicode:"🎁",shortcuts:["(gift)"],duration:.5417,steps:13}],["angel",{unicode:"👼",shortcuts:["(angel)"],duration:3.5,steps:84}],["xmastree",{unicode:"🎄",shortcuts:["(xmastree)","(christmastree)"],duration:1.125,steps:27}],["brokenheart",{unicode:"💔",shortcuts:["(brokenheart)"],duration:4.375,steps:105}],["think",{unicode:"🤔",shortcuts:["(think)",":-?",":?",":=?","*-)"],duration:2.4583,steps:59}],["clap",{unicode:"👏",shortcuts:["(clap)"],duration:1.6667,steps:40}],["punch",{unicode:"👊",shortcuts:["(punch)","*|","*-|"],duration:1.8333,steps:44}],["envy",{unicode:"😠",shortcuts:["(envy)"],duration:2.8333,steps:68}],["handshake",{unicode:"🤝",shortcuts:["(handshake)"],duration:2.5833,steps:62}],["nod",{unicode:"👍",shortcuts:["(nod)"],duration:2.125,steps:51}],["nerdy",{unicode:"🤓",shortcuts:["(nerd)","8-|","b-|","8|","b|","8=|","b=|","(nerdy)"],duration:2,steps:48}],["emo",{unicode:"😎",shortcuts:["(emo)"],duration:2.25,steps:54}],["muscle",{unicode:"💪",shortcuts:["(flex)","(muscle)"],duration:2.4583,steps:59}],["mmm",{unicode:"😏",shortcuts:["(mm)","(mmm)","(mmmm)"],duration:3.875,steps:93}],["highfive",{unicode:"✋",shortcuts:["(highfive)","(hifive)","(h5)"],duration:1.5833,steps:38}],["turkey",{unicode:"🦃",shortcuts:["(turkey)","(turkeydance)"],duration:2.0833,steps:50}],["call",{unicode:"🤙",shortcuts:["(call)"],duration:1.9167,steps:46}],["movember",{unicode:"🧐",shortcuts:["(movember)","(moustache)","(mustache)",":{"],duration:4.5833,steps:110}],["dog",{unicode:"🐶",shortcuts:["(dog)"],duration:2.25,steps:54}],["coffee",{unicode:"☕",shortcuts:["(coffee)"],duration:1.1667,steps:28}],["poke",{unicode:"👉",shortcuts:["(poke)","(nudge)"],duration:3.125,steps:75}],["swear",{unicode:"🤬",shortcuts:["(swear)"],duration:3.2083,steps:77}],["donttalktome",{unicode:"😠",shortcuts:["(donttalk)","(donttalktome)"],duration:2.5,steps:60}],["fingerscrossed",{unicode:"🤞",shortcuts:["(fingers)","(fingerscrossed)","(crossedfingers)"],duration:2.6667,steps:64}],["rainbow",{unicode:"🌈",shortcuts:["(rainbow)"],duration:.8333,steps:20}],["headphones",{unicode:"🎧",shortcuts:["(headphones)"],duration:3.5,steps:84}],["waiting",{unicode:"⏰",shortcuts:["(waiting)"],duration:2.125,steps:51}],["festiveparty",{unicode:"🎉",shortcuts:["(festiveparty)"],duration:3.0417,steps:73}],["heidy",{unicode:"🐿️",shortcuts:["(squirrel)","(heidy)"],duration:3.125,steps:75}],["beer",{unicode:"🍺",shortcuts:["(beer)"],duration:3.1667,steps:76}],["doh",{unicode:"😮",shortcuts:["(doh)"],duration:2.5,steps:60}],["bomb",{unicode:"💣",shortcuts:["(bomb)","(explosion)","(explode)"],duration:7.1667,steps:172}],["happy",{unicode:"🙂",shortcuts:["(happy)"],duration:2.9167,steps:70}],["ninja",{unicode:"🤺",shortcuts:["(ninja)"],duration:5.0833,steps:122}]]),a=new Map([["angryface",{unicode:"😡",shortcuts:[],duration:4.375,steps:105,pastName:"angry"}]]),o={like:"yes",heart:"heart",laugh:"laugh",surprised:"surprised",sad:"sad",angry:"angryface"},r=Object.assign(Object.assign({},o),{angry:"angry"}),s=new Map([["laughV2",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["heartV2",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["yesV2",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["clapV2",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["raisehand",{unicode:"",shortcuts:[],duration:2.0833,steps:51}],["laughV3",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["heartV3",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["yesV3",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["clapV3",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["raisehandV3",{unicode:"",shortcuts:[],duration:2.0833,steps:51}],["laughV4",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["heartV4",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["yesV4",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["clapV4",{unicode:"",shortcuts:[],duration:4.25,steps:102}]])},990461:(e,t,n)=>{"use strict";n.d(t,{p0:()=>h,um:()=>p,eG:()=>u,Ax:()=>m,cL:()=>g});const i={"az-az":"az-latn-az","be-by":"ru-ru","de-at":"de-de","en-029":"en-us","en-bz":"en-us","de-ch":"de-de","de-li":"de-de","de-lu":"de-de","en-au":"en-gb","en-ca":"en-gb","en-ie":"en-gb","en-in":"en-gb","en-my":"en-gb","en-nz":"en-gb","en-sg":"en-gb","en-ph":"en-us","en-tt":"en-us","en-za":"en-gb","en-zw":"en-gb","es-419":"es-es","es-ar":"es-mx","es-bo":"es-mx","es-cl":"es-mx","es-co":"es-mx","es-cr":"es-mx","es-do":"es-mx","es-ec":"es-mx","es-gt":"es-mx","es-hn":"es-mx","es-ni":"es-mx","es-pa":"es-mx","es-pe":"es-mx","es-pr":"es-mx","es-py":"es-mx","es-sv":"es-mx","es-us":"es-mx","es-uy":"es-mx","es-ve":"es-mx","fr-be":"fr-fr","fr-ch":"fr-fr","fr-lu":"fr-fr","fr-mc":"fr-fr","it-ch":"it-it","ky-kg":"ru-ru","lb-lu":"de-de","nl-be":"nl-nl","qut-gt":"es-es","quz-pe":"es-es","sr-cyrl":"sr-latn-rs","sr-cyrl-rs":"sr-latn-rs","sr-latn":"sr-latn-rs","sr-rs":"sr-latn-rs","sv-fi":"sv-se","tg-cyrl-tj":"ru-ru","tk-tm":"ru-ru","tt-ru":"ru-ru","ug-cn":"zh-cn","wo-sn":"fr-fr","zh-hans":"zh-cn","zh-hans-cn":"zh-cn","zh-hans-sg":"zh-cn","zh-hant":"zh-tw","zh-hant-hk":"zh-tw","zh-hant-mo":"zh-tw","zh-hant-tw":"zh-tw","zh-hk":"zh-tw","zh-mo":"zh-tw","zh-sg":"zh-cn",ar:"ar-sa",az:"az-latn-az",bg:"bg-bg",ca:"ca-es",cs:"cs-cz",cy:"cy-gb",da:"da-dk",de:"de-de",el:"el-gr",en:"en-us",es:"es-es",et:"et-ee",eu:"eu-es",fi:"fi-fi",fil:"fil-ph",fr:"fr-fr",gl:"gl-es",he:"he-il",hi:"hi-in",hr:"hr-hr",hu:"hu-hu",id:"id-id",is:"is-is",it:"it-it",ja:"ja-jp",ka:"ka-ge",ko:"ko-kr",kk:"kk-kz",lt:"lt-lt",lv:"lv-lv",mk:"mk-mk",nb:"nb-no",nl:"nl-nl",nn:"nn-no",pl:"pl-pl",pt:"pt-br",ro:"ro-ro",ru:"ru-ru",sk:"sk-sk",sl:"sl-si",sr:"sr-latn-rs",sq:"sq-al",sv:"sv-se",th:"th-th",tr:"tr-tr",uk:"uk-ua",vi:"vi-vn",zh:"en-us"};var a=n(25835);const o=e=>{const t=e.trim().toLowerCase();let n=s(t);return i[n]?(n=i[n],{locale:n,reason:"Found in fallback table",originalLocale:e}):r(n)?{locale:n,reason:"Supported language"}:{locale:null,reason:"Didn't find supported language.",originalLocale:e}},r=e=>{const t=e.toLowerCase();for(const e of a.i)if(t===e.code.toLowerCase())return!0;return!1},s=e=>{const t=(new Date).getTimezoneOffset();return"fr"===e&&t>=120&&t<=420?"fr-ca":e},l=["aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","ae","aeb","aec","afb","ajp","apc","apd","ar","arb","arc","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","bcc","bqi","ckb","dv","fa","glk","hbo","he","jpr","ku","men","mzn","nqo","pbt","pbu","peo","pes","pga","pnb","prd","prp","prs","ps","pst","sam","sd","shu","sqr","ssh","ug","ur","xaa","xmn","ydd","yhd","yi","yih","yud"];var c=n(980633);const d={af_ZA:1078,am_ET:1118,ar_AE:14337,ar_BH:15361,ar_DZ:5121,ar_EG:3073,ar_IQ:2049,ar_JO:11265,ar_KW:13313,ar_LB:12289,ar_LY:4097,ar_MA:6145,ar_OM:8193,ar_QA:16385,ar_SA:1025,ar_SY:10241,ar_TN:7169,ar_YE:9217,arn_CL:1146,as_IN:1101,az_AZ:2092,ba_RU:1133,be_BY:1059,bg_BG:1026,bn_IN:1093,bo_BT:2129,bo_CN:1105,br_FR:1150,bs_BA:8218,ca_ES:1027,co_FR:1155,cs_CZ:1029,cy_GB:1106,da_DK:1030,de_AT:3079,de_CH:2055,de_DE:1031,de_LI:5127,de_LU:4103,div_MV:1125,dsb_DE:2094,el_GR:1032,en_AU:3081,en_BZ:10249,en_CA:4105,en_CB:9225,en_GB:2057,en_IE:6153,en_IN:18441,en_JA:8201,en_MY:17417,en_NZ:5129,en_PH:13321,en_TT:11273,en_US:1033,en_ZA:7177,en_ZW:12297,es_AR:11274,es_BO:16394,es_CL:13322,es_CO:9226,es_CR:5130,es_DO:7178,es_EC:12298,es_ES:3082,es_GT:4106,es_HN:18442,es_MX:2058,es_NI:19466,es_PA:6154,es_PE:10250,es_PR:20490,es_PY:15370,es_SV:17418,es_UR:14346,es_US:21514,es_VE:8202,et_EE:1061,eu_ES:1069,fa_IR:1065,fi_FI:1035,fil_PH:1124,fo_FO:1080,fr_BE:2060,fr_CA:3084,fr_CH:4108,fr_FR:1036,fr_LU:5132,fr_MC:6156,fy_NL:1122,ga_IE:2108,gbz_AF:1164,gl_ES:1110,gsw_FR:1156,gu_IN:1095,ha_NG:1128,he_IL:1037,hi_IN:1081,hr_BA:4122,hr_HR:1050,hu_HU:1038,hy_AM:1067,id_ID:1057,ii_CN:1144,is_IS:1039,it_CH:2064,it_IT:1040,iu_CA:2141,ja_JP:1041,ka_GE:1079,kh_KH:1107,kk_KZ:1087,kl_GL:1135,kn_IN:1099,ko_KR:1042,kok_IN:1111,ky_KG:1088,lb_LU:1134,lo_LA:1108,lt_LT:1063,lv_LV:1062,mi_NZ:1153,mk_MK:1071,ml_IN:1100,mn_CN:2128,mn_MN:1104,moh_CA:1148,mr_IN:1102,ms_BN:2110,ms_MY:1086,mt_MT:1082,my_MM:1109,nb_NO:1044,ne_NP:1121,nl_BE:2067,nl_NL:1043,nn_NO:2068,ns_ZA:1132,oc_FR:1154,or_IN:1096,pa_IN:1094,pl_PL:1045,ps_AF:1123,pt_BR:1046,pt_PT:2070,qut_GT:1158,quz_BO:1131,quz_EC:2155,quz_PE:3179,rm_CH:1047,ro_RO:1048,ru_RU:1049,rw_RW:1159,sa_IN:1103,sah_RU:1157,se_FI:3131,se_NO:1083,se_SE:2107,si_LK:1115,sk_SK:1051,sl_SI:1060,sma_NO:6203,sma_SE:7227,smj_NO:4155,smj_SE:5179,smn_FI:9275,sms_FI:8251,sq_AL:1052,sr_BA:7194,sr_SP:3098,sv_FI:2077,sv_SE:1053,sw_KE:1089,syr_SY:1114,ta_IN:1097,te_IN:1098,tg_TJ:1064,th_TH:1054,tk_TM:1090,tmz_DZ:2143,tn_ZA:1074,tr_TR:1055,tt_RU:1092,ug_CN:1152,uk_UA:1058,ur_IN:2080,ur_PK:1056,uz_UZ:2115,vi_VN:1066,wen_DE:1070,wo_SN:1160,xh_ZA:1076,yo_NG:1130,zh_CHS:4,zh_CHT:31748,zh_CN:2052,zh_HK:3076,zh_MO:5124,zh_SG:4100,zh_TW:1028,zu_ZA:1077};function u(e){const[t,n]=e.split("-");let i="";return t&&n&&(i=`${t.toLowerCase()}_${n.toUpperCase()}`),d[i]||d.en_US}function m(e,t,n){let i;return i=n?n.toLowerCase():e.config.localeCode.toLowerCase(),p(t,i)}function p(e,t){const n=(e=>{const t=o(e);return null!==t.locale?t:{locale:"en-us",reason:"No supported language found - falling back to en-us",originalLocale:e}})(t);if(n.locale!==t){e.createScenarioWithoutStarting(c.RG.I18nLangFallback).stop({origin:t,message:n.reason})}return n.locale?n.locale:"en-us"}const g={locale:""};class h{static get locale(){return g.locale}static isRtl(e){return function(e){const t=e.trim().split("-")[0].toLocaleLowerCase();return l.indexOf(t)>-1}(e=e||this.locale)}static setLangAttribute(e,t){t=t||this.locale,e.getAttribute("lang")!==t&&e.setAttribute("lang",t)}static setDirAttribute(e,t,n){void 0===t&&(t=this.isRtl(n||this.locale));const i=e.getAttribute("dir");t&&"rtl"!==i?e.setAttribute("dir","rtl"):t||""===i||"ltr"===i||e.removeAttribute("dir")}}},900984:(e,t,n)=>{"use strict";n.d(t,{o:()=>g,E:()=>m});var i=n(990461),a=n(786744),o=n(416350),r=n(424097),s=n(980633);const l=/[\W]*y+[\.\/-]*/,c=e=>e?e.replace(l,""):e,d={"ar-sa":0,"az-latn-az":1,"bg-bg":1,"ca-es":1,"ca-es-valencia":1,"cs-cz":1,"cy-gb":1,"da-dk":1,"de-at":1,"de-ch":1,"de-de":1,"de-li":1,"de-lu":1,"el-gr":1,"en-029":1,"en-au":1,"en-bz":0,"en-ca":0,"en-gb":1,"en-ie":1,"en-in":1,"en-jm":0,"en-my":0,"en-nz":1,"en-ph":0,"en-sg":0,"en-tt":0,"en-us":0,"en-za":0,"en-zw":0,"es-ar":0,"es-bo":1,"es-cl":1,"es-co":0,"es-cr":1,"es-do":0,"es-ec":1,"es-es":1,"es-gt":0,"es-hn":0,"es-mx":0,"es-ni":0,"es-pa":0,"es-pe":0,"es-pr":0,"es-py":0,"es-sv":0,"es-us":0,"es-uy":1,"es-ve":0,"et-ee":1,"eu-es":1,"fi-fi":1,"fil-ph":0,"fr-be":1,"fr-ca":0,"fr-ch":1,"fr-fr":1,"fr-lu":1,"fr-mc":1,"gl-es":1,"he-il":0,"hi-in":1,"hr-hr":1,"hu-hu":1,"id-id":0,"is-is":1,"it-ch":1,"it-it":1,"ja-jp":0,"ka-ge":1,"kk-kz":1,"ko-kr":0,"lt-lt":1,"lv-lv":1,"mk-mk":1,"nb-no":1,"nl-be":1,"nl-nl":1,"nn-no":1,"pl-pl":1,"pt-br":0,"pt-pt":0,"ro-ro":1,"ru-ru":1,"sk-sk":1,"sl-si":1,"sq-al":1,"sr-latn-rs":1,"sv-fi":1,"sv-se":1,"th-th":1,"tr-tr":1,"uk-ua":1,"vi-vn":1,"zh-cn":1,"zh-hk":0,"zh-mo":0,"zh-sg":0,"zh-tw":0},u=/.*\_mf$/,m=(e,t)=>u.test(e)?Object.assign(Object.assign({},t),{skipInterpolation:!0}):t,p={hour:!0,minute:!0,second:!0};class g{constructor(e){if(this.i18nextWrapper=e,this.timeSettings={},this.scenarioFactory=e.scenarioFactory,!this.i18nextWrapper.osLocaleInfo||!this.isSupportedOsRegionalFormat()){const t=(null==e?void 0:e.locale)||"en-us";return this.dateTimeFormatter=new r.bg(t),void(this.dateTimeFormatterNoYear=this.dateTimeFormatter)}if(this._osLocaleInfo=this.i18nextWrapper.osLocaleInfo,this._osDateTimeLocale=this._osLocaleInfo.regionalFormat,this.isUnsupportedCalendar())return this.dateTimeFormatter=new r.bg(this._osLocaleInfo.regionalFormat),void(this.dateTimeFormatterNoYear=this.dateTimeFormatter);const t={platform:this.i18nextWrapper.osPlatform===a.NR.Mac?"macos":"windows",regionalFormat:this._osLocaleInfo.regionalFormat,shortDate:this.i18nextWrapper.osLocaleInfo.date.shortDate,longDate:this.i18nextWrapper.osLocaleInfo.date.longDate,shortTime:this.i18nextWrapper.osLocaleInfo.date.shortTime,longTime:this.i18nextWrapper.osLocaleInfo.date.longTime},n=Object.assign(Object.assign({},t),{shortDate:c(t.shortDate),longDate:c(t.longDate),shortTime:c(t.shortTime),longTime:c(t.longTime)});this.dateTimeFormatter=new r.bg(t),this.dateTimeFormatterNoYear=new r.bg(n)}get locale(){var e;return(null===(e=this.i18nextWrapper)||void 0===e?void 0:e.locale)||"en-us"}get isRtl(){return i.p0.isRtl(this.locale)}get osDateTimeLocale(){return this._osDateTimeLocale}get osFirstDayOfWeek(){if(this.osLocaleInfo&&this.osLocaleInfo.date){const e=parseInt(this.osLocaleInfo.date.firstDayOfWeek,10);if(!Number.isNaN(e))return e}}get firstDayOfWeek(){var e,t;return null!==(e=this.osFirstDayOfWeek)&&void 0!==e?e:(t=this.i18nextWrapper.originLocale,d[t.toLowerCase()])}get osLocaleInfo(){return this._osLocaleInfo}stringTranslate(e,t,n){this.i18nextWrapper.latestTranslation.namespace=e,this.i18nextWrapper.latestTranslation.key=t;return this.i18nextWrapper.i18next.getFixedT(this.locale,e)(t,m(t,n))}waitForNamespace(e){return this.i18nextWrapper.namespaceLoader.waitForNamespace(this.i18nextWrapper,e)}getNamespaceState(e){return this.i18nextWrapper.namespaceLoader.getState(e)}isNamespaceLoaded(e){const t=this.getNamespaceState(e);return!(t===o.i.Loading||t===o.i.Missing)}formatDateTime(e,t,n){var i,a,o;try{return n?this.dateTimeFormatterNoYear.formatDateTime(e,(e=>{switch(e){case r.s1:return r.WZ;case r.WG:return r.Iy;case r.PB:return r.M2;case r.xH:return r.Kq;case r.CX:return r.Qo;case r.p2:return r.Ct;case r.TF:return r.SD;case r.tu:return r.KO}return e})(t)):this.dateTimeFormatter.formatDateTime(e,t)}catch(n){if(this.shouldLogFormatFallback(t)){const e=`Date format ${JSON.stringify(t)} is not supported, falling back to Intl.DateTimeFormat`;this.scenarioFactory.createScenarioWithoutStarting(s.RG.I18nFallbackToIntl).stop({errors:e,origin:null===(i=this.osLocaleInfo)||void 0===i?void 0:i.regionalFormat})}const l=null!==(o=null===(a=this.osLocaleInfo)||void 0===a?void 0:a.regionalFormat)&&void 0!==o?o:this.locale;try{return(0,r.fM)(l,t).format(e)}catch(n){const i=`Date format ${JSON.stringify(t)} for date ${e.toLocaleString()} fallback failed: ${n&&n.message}`;return this.scenarioFactory.createScenarioWithoutStarting(s.RG.I18nFallbackToIntl).fail({errors:i,origin:l}),""}}}formatNumber(e,t){return Intl.NumberFormat(this.osDateTimeLocale||this.locale,t).format(e)}getStringComparer(e){return Intl.Collator(this.locale,e).compare}sortStrings(e,t){const n=this.getStringComparer(t);return e.sort(n)}getLocaleTimeSettings(){if(this.timeSettings[this.locale])return this.timeSettings[this.locale];const e=new Date(0,0,0,1,2,3).toLocaleTimeString(this.locale).match(new RegExp(`[${this.formatNumber(0)}-${this.formatNumber(9)}]+`,"g")),t={hour:"2-digit",minute:"2-digit",second:"2-digit"};if(Array.isArray(e)){const n=this.formatNumber(1),i=this.formatNumber(2),a=this.formatNumber(3);for(const o of e)o.indexOf(n)>-1?t.hour=1===o.length?"numeric":"2-digit":o.indexOf(i)>-1?t.minute=1===o.length?"numeric":"2-digit":o.indexOf(a)>-1&&(t.second=1===o.length?"numeric":"2-digit")}return this.timeSettings[this.locale]=t,t}isSupportedOsRegionalFormat(){const e=[a.NR.Mac,a.NR.Windows].indexOf(this.i18nextWrapper.osPlatform)>-1;return this.i18nextWrapper.osLocaleInfo&&e&&this.i18nextWrapper.osLocaleInfo.regionalFormat&&"UNKNOWN"!==this.i18nextWrapper.osLocaleInfo.regionalFormat}isUnsupportedCalendar(){return!this.i18nextWrapper.osLocaleInfo||!this.i18nextWrapper.osLocaleInfo.date||"gregorian"!==this.i18nextWrapper.osLocaleInfo.date.calendar&&"1"!==this.i18nextWrapper.osLocaleInfo.date.calendar}shouldLogFormatFallback(e){if(!e)return!0;if(e===r.Eq||e===r.W2)return!1;let t=!1;return Object.keys(e).map((e=>{p[e]||(t=!0)})),t}}},87912:(e,t,n)=>{"use strict";n.d(t,{q8:()=>c,dR:()=>d,Zl:()=>u});var i=n(231191),a=n(708362),o=n(775214),r=n(352367),s=n(980633);const l="Browser does not support IndexedDB APIs";function c(e,t,n,c,d,u){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i;const p=(0,a.J)().indexedDB;return new Promise(((a,g)=>{const h=d.newScenario(s.RG.IndexedDBFetch);h.appendEventData({dataSource:n});try{p||g((0,o.Tr)(r.w5.IndexDb,r.jK.IndexDbException,l)),i=p.open(e,t),i.onerror=()=>{g((0,o.Tr)(r.w5.IndexDb,r.jK.IndexDbException,"Error in indexedDB open request"))},i.onupgradeneeded=e=>{m(t,n,c,i,e,a,g,h)},i.onsuccess=function(e,t,n,i,a,s,l){return()=>{try{const c=e.result,d=c.transaction([t]).objectStore(t),u=l?d.getAll():d.get(n);u.onsuccess=e=>{c.close(),i.stop();const t=e.target.result;a(l?t:t&&(t.value||u.result))},u.onerror=()=>{c.close(),i.fail(),s((0,o.Tr)(r.w5.IndexDb,r.jK.IndexDbException,"Error trying to get chat service sync end point from indexedDB"))}}catch(e){i.fail(),s((0,o.Tr)(r.w5.IndexDb,r.jK.IndexDbException,`Failed to read from '${t}' object store on the indexedDB.`))}}}(i,n,c,h,a,g,u)}catch(e){h.fail({errors:e.message}),g(e)}}))}))}function d(e,t,n,o,r){return(0,i.__awaiter)(this,void 0,void 0,(function*(){{let i;const c=(0,a.J)().indexedDB;return new Promise(((a,d)=>{const u=r.newScenario(s.RG.IndexedDBDelete);u.appendEventData({dataSource:n});try{c||d(new Error(l)),i=c.open(e,t),i.onerror=()=>{d(new Error(l)),u.fail({errors:l})},i.onsuccess=()=>{!function(e,t,n,i,a){try{const o=e.result,r=o.transaction([t],"readwrite"),s=r.objectStore(t).clear();s.onsuccess=e=>{o.close(),n.stop(),i(e.target.result)},s.onerror=e=>{o.close(),n.fail(),a(`Error trying to delete data from indexedDB: ${e}`)}}catch(e){n.fail(),a(`Error trying to delete data from indexedDB: ${e}`)}}(i,n,u,a,d)},i.onupgradeneeded=e=>{m(t,n,o,i,e,a,d,u)}}catch(e){u.fail({errors:e.message}),d(e)}}))}}))}function u(e,t,n,o,r,c){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i;const d=(0,a.J)().indexedDB;return new Promise(((a,u)=>{const p=c.newScenario(s.RG.IndexedDBWrite);p.appendEventData({dataSource:n});try{d||u(new Error(l)),i=d.open(e,t),i.onerror=()=>{u(new Error(l)),p.fail({errors:l})},i.onsuccess=()=>{!function(e,t,n,i,a,o){try{const r=e.result,s=r.transaction([t],"readwrite").objectStore(t);let l;n.forEach((e=>{l=s.put(e),l.onsuccess=e=>{r.close(),i.stop(),a(e.target.result.value)},l.onerror=e=>{r.close(),i.fail(),o(`Error trying to write into indexedDB: ${e}`)}}))}catch(e){i.fail(),o(`Error trying to write into indexedDB: ${e}`)}}(i,n,r,p,a,u)},i.onupgradeneeded=e=>{m(t,n,o,i,e,a,u,p)}}catch(e){p.fail({errors:e.message}),u(e)}}))}))}function m(e,t,n,i,a,o,r,l){try{a.oldVersion<e&&i.result.createObjectStore(t,{keyPath:n}),l.mark(s.ck.IndexedDBUpgrade),o()}catch(e){l.fail(),r(`Failed to create object stores on the indexedDB: ${e}`)}}},261169:(e,t,n)=>{"use strict";n.d(t,{N:()=>o});var i=n(231191),a=n(682796);class o{constructor(e,t,n){this.logsCollectorService=t,this.coreSettings=n,this.defaultLogsFilesDownloadDelayIntervalMs=333,this.logger=e.newLogger("LogsFilesService")}downloadLogsFiles(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let t=!0,n=this.defaultLogsFilesDownloadDelayIntervalMs;if(this.coreSettings){const e=this.coreSettings.get(a.J.Diagnostics);t=e.enableLogsFilesDownload||!1,n=e.logsFilesDownloadDelayIntervalMs||this.defaultLogsFilesDownloadDelayIntervalMs}if(!t)return this.logger.error(`Unabled to download logs files - logs files download is not enabled: ${t}`),!1;if(!e)return this.logger.error(`Unabled to download logs files - no host present: ${e}`),!1;let o=0;const r=yield this.logsCollectorService.callOnLogsFiles((t=>(0,i.__awaiter)(this,void 0,void 0,(function*(){let a;const r=new Promise((r=>{a=e.setTimeout((()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.downloadLogsFile(t,e);r(n)}))),o*n)})).then((t=>(void 0!==a&&e.clearTimeout(a),t)));return o++,r}))));return r||this.logger.error("Failed to download all logs files"),r}))}downloadLogsFile(e,t){let n,i="";const a=URL&&URL.createObjectURL?URL:"undefined"!=typeof webkitURL&&webkitURL&&webkitURL.createObjectURL?webkitURL:void 0;try{if(null==a?void 0:a.createObjectURL){const t=new Blob([null==e?void 0:e.content],{type:"text/plain;charset=utf-8"});i=a.createObjectURL(t)}const o=t.document.createElement("a");if(i)o.setAttribute("href",i);else{const t=`data:text/plain;charset=utf-8,${encodeURIComponent(null==e?void 0:e.content)}`;o.setAttribute("href",t)}o.setAttribute("download",null==e?void 0:e.fileName),o.click(),o.remove(),n=!0}catch(t){this.logger.error(`Failed to download logs file ${null==e?void 0:e.fileName} - error:`,t),n=!1}return i&&(null==a?void 0:a.revokeObjectURL)&&a.revokeObjectURL(i),Promise.resolve(n)}}},356773:(e,t,n)=>{"use strict";n.d(t,{n:()=>te});var i=n(911023),a=n(486410),o=n(773176),r=n(324819),s=n(775214),l=n(352367);class c{constructor(e,t){this.shellComms=e,this.globalWindow=t,this.defaultRequestTimeoutMs=3e4,this.bufferInTimeout=5e3}postMessage(e,t){const n={eventId:e,payload:t,correlationId:(0,r.v4)()};this.shellComms.postMessage(n)}requestMessage(e,t,n=this.defaultRequestTimeoutMs,i){let a;const o=(0,r.v4)(),c=((null==t?void 0:t.timeout)||n)+this.bufferInTimeout;return new Promise(((n,r)=>{const d=t=>{if(this.globalWindow.clearTimeout(a),t&&!t.error){try{i&&i(t.securityContext)}catch(n){r((0,s.Tr)(l.w5.ShellService,l.jK.Forbidden,"requestMessage",{eventName:e,error:t&&t.error,correlationId:o},"Received an error while doing security check"))}n(t.payload)}else r((0,s.Tr)(l.w5.ShellService,l.jK.RemoteOperationFailed,"requestMessage",{eventName:e,error:t&&t.error,correlationId:o},"Received an error from IPC"))};a=this.globalWindow.setTimeout((()=>{this.shellComms.remove(e,d),r((0,s.Tr)(l.w5.ShellService,l.jK.TimedOut,"requestMessage",{eventName:e,correlationId:o}))}),c),this.shellComms.once(e,d,o);const u={eventId:e,correlationId:o,payload:t};this.shellComms.postMessage(u)}))}addEventListener(e,t,n){n&&n.once?this.shellComms.once(e,t):this.shellComms.on(e,t)}removeEventListener(e,t){t?this.shellComms.remove(e,t):this.shellComms.removeAll(e)}open(e,t,n){const i={openType:e,openHandler:t,handlerParams:n};this.postMessage("requestShellToOpen",i)}}class d{constructor(e,t,n){this._globalWindow=e,this.shellComms=t,this.envPerformance={getBlinkMemoryInfo:()=>{},getJSHeapStatistics:()=>{},getMallocMemoryUsage:()=>{},getProcessMemoryInfo:()=>{},getWebCacheInfo:()=>{}};const{isInCypressFrame:i,isInIframe:r}=n;let s=a.QP.standAlone;this.viewportContext=o.R.primary,r&&!i?(s=a.QP.iframe,this.viewportContext=o.R.iFrame):null!==this._globalWindow.opener&&(s=a.QP.secondary,this.viewportContext=o.R.secondary),this._hostedWindowContext=Object.assign(Object.assign({},n),{panelContext:s,startReason:a.zF.userInitiated,__webpack_public_path__:this._globalWindow.__webpack_public_path__}),this.opener=new c(this.shellComms,this._globalWindow)}getHostedWindowContext(){return this._hostedWindowContext}onAppStart(){}}var u=n(51485),m=n(895725);var p=n(632585);class g{constructor(e,t){this.getObservableOn=e=>{const t=this.observableCache,n=t.get(e);if(n)return n;const i=new p.xQ;return t.set(e,i),i},this.next=e=>{this.logger.debug("Incoming message received. Filtering through cached observables.");const t=e.metaData.destination.channel,n=this.observableCache.get(t);n&&n.next(e)},this.error=e=>{const t=e.message?e.message:e;this.logger.error(`Internal Message Source emitted an error - {${t}}. Completing then clearing all observables from cache...`),this.completeAndClearCache()},this.complete=()=>{this.logger.debug("Internal Message Source completed. Completing then clearing all observables from cache..."),this.completeAndClearCache()},this.completeAndClearCache=()=>{this.observableCache.forEach((e=>e.complete())),this.observableCache.clear(),this.logger.debug("Cache cleared")},this.logger=t,this.observableCache=new Map,e.subscribe(this)}}const h="multi-window-manager-channel";var v=n(384986),f=n(798741);class y{constructor(e,t,n){this.postMessage=e=>{this.logger.log("Sending targeted message to host browser only");const t=null!==e.payload&&"object"==typeof e.payload?Object.assign({},e.payload):{payload:e.payload};this.windowReference.parent.postMessage({channel:h,payload:Object.assign(Object.assign({},t),{channel:e.channel})},"*")},this.broadcast=()=>{},this.asObservable=e=>this.shellChannelCache.getObservableOn(e).pipe((0,m.U)((e=>(e=>({channel:e.metaData.destination.channel,payload:e.payload,securityContext:e.securityContext}))(e)))),this.createShellChannelCache=(e,t)=>{t.debug("Creating Shell Channel cache");const n=((e,t)=>v.y.create((n=>{e.addEventListener("message",(e=>{const{eventId:i,channel:a}=e.data;e&&i&&a===h&&(t.debug("Incoming message from post messages"),n.next(Object.assign(Object.assign({},e.data),{securityContext:{senderOrigin:e.origin}})))}))})).pipe((0,f.B)()))(e,t);return new g(n,t)},this.logger=n.newLogger("RndrShComm"),this.processId=e,this.windowReference=t,this.shellChannelCache=this.createShellChannelCache(this.windowReference,this.logger)}}const S="main_process",k="main_renderer";var b;!function(e){e[e.Request=0]="Request",e[e.Response=1]="Response"}(b||(b={}));var _=n(550070),C=n(782801),w=n(192582),T=n(722474),E=n(860467),I=n(283607),N=n(15710),A=n(179032),M=n(21168);const F=5*n(9654).gT.MILLI_PER_SECOND;class R{constructor(e,t,n){this.createResponseFunction=(e,t,n)=>i=>{const a=this.messagePassingService,o={direction:b.Response,responsePayload:i,procedureSignature:n},r={channel:t,payload:o};this.logger.log(`Sending response with signature: ${n}`),a.postMessage(r,[e])};if(3!==arguments.length||e.trim().length<=0)throw(0,s.Tr)("Invalid constructor arguments",l.jK.InvalidInput,typeof R);this.logger=n,this.messagePassingService=t,this.metaData={requestId:e}}send(e,t,n=F){const i=this.messagePassingService,a=this.metaData,o=i.processId,s=a.requestId,l=r.v4(),c=t?[t]:i.processId!==S?[S]:[k],d={channel:s,payload:{direction:b.Request,senderProcessId:o,procedureSignature:l,requestPayload:e}};this.logger.log(`Invoking procedure on ${t} with id, ${l}`);const u=(0,_.c)().pipe((0,T.x)((()=>i.postMessage(d,c)))),m=i.asObservable(s).pipe((0,E.h)((e=>e.payload.direction===b.Response)),(0,I.zg)((e=>{const t=e.payload;return t.procedureSignature===l?(0,C.of)(t.responsePayload):(0,_.c)()})));return(0,w.z)(u,m).pipe((0,N.P)(),(0,A.V)(n))}sendAsPromise(e,t,n=F){return this.logger.debug("Invoking procedure as promise"),new Promise(((i,a)=>{this.send(e,t,n).subscribe((e=>{i(e)}),(e=>{a(e)}))}))}asObservable(){const e=this.messagePassingService,t=this.metaData.requestId;return this.logger.debug("Retreiving observable on request-response procedure"),e.asObservable(t).pipe((0,E.h)((e=>e.payload.direction===b.Request)),(0,M.b)((e=>{this.logger.log(`Incoming request with signature - ${e.payload.procedureSignature}`)})),(0,m.U)((e=>{const n=e.payload,i=n.procedureSignature,a=n.requestPayload,o=n.senderProcessId;return{payload:a,respond:this.createResponseFunction(o,t,i)}})))}}var P=n(597816),D=n(42103),j=n(929331),x=n(892891);class O{constructor(e,t,n){this.setState=e=>{const t=this.metaData,n={lastAuthorMetaData:t,newState:e};this.logger.debug(`Process, ${t.authorId}, is setting the state`),this.stateUpdateSource.next(n)},this.asObservable=()=>(this.logger.debug("Retreiving observable on the state"),this.distinctStateUpdates.pipe((0,m.U)((e=>e.newState)))),this.setupContinuousSyncronizationAcrossShellBoundary=()=>{const e=this.messagePassingService,t=this.metaData,n=this.logger,i=this.stateUpdateSource,a=this.distinctStateUpdates,o=t.storeId;a.pipe((0,E.h)((e=>e.lastAuthorMetaData.authorId===this.metaData.authorId)),(0,M.b)((()=>n.debug("Broadcasting state update")))).subscribe((t=>{const n={payload:t,channel:o};e.broadcast(n)})),e.asObservable(o).pipe((0,E.h)((e=>e.payload.lastAuthorMetaData.authorId!==t.authorId)),(0,M.b)((()=>n.log("State update incoming from message passing service")))).subscribe((e=>{i.next(e.payload)}))},this.setupInitialStateSynchronizationRequest=()=>{const e=this.metaData,t=this.distinctStateUpdates,n=this.messagePassingService,i=e.storeId,a=i.concat("-initial-sync-request");t.pipe((0,M.b)((()=>this.logger.debug("State updated. SwitchMapping to observable on incoming sync requests"))),(0,D.w)((()=>n.asObservable(a)),((e,t)=>{const n=t.payload.requesterMetaData.authorId;return{syncResponseMessage:{channel:i,payload:e},targetId:n}})),(0,M.b)((({targetId:e})=>this.logger.debug(`Incoming initial sync request from ${e}.`)))).subscribe((({syncResponseMessage:e,targetId:t})=>{n.postMessage(e,[t])}));const o={channel:a,payload:{requesterMetaData:e}};this.logger.debug("Sending out initial synchronization request..."),n.broadcast(o)};if(3!==arguments.length||e.trim().length<=0)throw(0,s.Tr)("Invalid constructor arguments",l.jK.InvalidInput,typeof O);const i=t.processId;this.logger=n,this.messagePassingService=t,this.metaData={storeId:e,authorId:i};this.stateUpdateSource=new P.t(1),this.distinctStateUpdates=this.stateUpdateSource.pipe((0,j.x)(((e,t)=>(0,x.isEqual)(e,t)))),this.setupContinuousSyncronizationAcrossShellBoundary(),this.setupInitialStateSynchronizationRequest()}}class L{constructor(e,t,n){if(3!==arguments.length||e.trim().length<=0)throw(0,s.Tr)("Invalid constructor arguments",l.jK.InvalidInput,typeof L);this.logger=n,this.messagePassingService=t,this.metaData={streamId:e}}next(e,...t){const n=this.metaData,i=this.messagePassingService,a=t&&t.length>0?t:this.messagePassingService.processId!==S?[S]:[k],o={channel:n.streamId,payload:e};this.logger.debug(`Invoking stream on targets: ${JSON.stringify(a)}.`),i.postMessage(o,a)}asObservable(){const e=this.messagePassingService,t=this.metaData.streamId;return e.asObservable(t).pipe((0,m.U)((e=>({payload:e.payload,securityContext:e.securityContext}))),(0,M.b)((()=>{this.logger.debug("Handling stream event.")})))}}class U{constructor(e,t){if(this.getRequest=e=>new R(e,this.messagePassingService,this.loggerFactory.newLogger(`ShRqst${e}`)),this.getStream=e=>new L(e,this.messagePassingService,this.loggerFactory.newLogger(`ShStrm${e}`)),this.getStore=e=>new O(e,this.messagePassingService,this.loggerFactory.newLogger(`ShStr${e}`)),!e||!t)throw(0,s.Tr)(`sc: ${e}, lf: ${t}`,l.jK.Undefined,typeof U);this.messagePassingService=e,this.loggerFactory=t}}var B=n(138826),W=n(95717);class H{constructor(e){if(this.windowReference=e,!this.windowReference)throw(0,s.Tr)(l.w5.ShellService,l.jK.Undefined,"constructor");const t={error:()=>{},warn:()=>{},debug:()=>{},info:()=>{},log:()=>{}},n={newLogger:()=>t},i=new y("browserWindow",e,n);this.shellComms=new U(i,n),this.subscriptionManager=new p.xQ}postMessage(e){this.shellComms.getStream(e.eventId).next(e)}on(e,t,n=""){this.createSubscription(e,t,!1,n)}once(e,t,n=""){this.createSubscription(e,t,!0,n)}remove(e,t){this.subscriptionManager.next({channel:e,listener:t})}removeAll(e){this.subscriptionManager.next({channel:e})}createSubscription(e,t,n,i){const a=this.shellComms.getStream(e).asObservable().pipe(this.filterWrapper((e=>{var t;const n=(null==e?void 0:e.correlationId)||(null===(t=null==e?void 0:e.payload)||void 0===t?void 0:t.correlationId);return!e||!n||n===i}))),o=this.registerForUnsubscription(e,t);(n?a.pipe((0,B.q)(1),(0,W.R)(o)):a.pipe((0,W.R)(o))).subscribe((e=>{const n={payload:e.payload,securityContext:e.securityContext};t(n)}),(e=>{throw(0,s.Tr)(l.w5.ShellService,l.jK.RemoteOperationFailed,"createSubscription",{errorMsg:(0,s.B9)(e)})}))}registerForUnsubscription(e,t){return this.subscriptionManager.pipe(this.filterWrapper((n=>n.channel===e&&(void 0===n.listener||n.listener===t))))}filterWrapper(e){return(0,E.h)(e)}}class ${constructor(e){this.globalWindow=e}configureShell(e){const t=this.globalWindow,n=this.createShellCommService(this.globalWindow),i=new d(this.globalWindow,n,e);return{hostedWindowContext:i.getHostedWindowContext(),window:(0,u.So)(t,i)}}createShellCommService(e){return new H(e)}}class V{constructor(e,t,n,r){this.envPerformance=e,this._globalWindow=t,this.shellComms=n,this._hostedWindowContext=Object.assign(Object.assign({},r),{panelContext:a.QP.secondary,startReason:a.zF.userInitiated,__webpack_public_path__:this._globalWindow.__webpack_public_path__}),this.viewportContext=o.R.iFrame,this.opener=new c(n,this._globalWindow),this._globalWindow.addEventListener("unload",(()=>{this.shellComms.postMessage({eventId:i.W.WindowUnloaded})}))}getHostedWindowContext(){return this._hostedWindowContext}onAppStart(){const e={eventId:i.W.WindowAppStart};this.shellComms.postMessage(e)}}var z,G=n(999108);!function(e){e.WindowMinimize="child-window-minimize",e.WindowMaximize="child-window-maximize"}(z||(z={}));const q="experience-renderer-channel";class J{constructor(e){this.ipcRenderer=e,this.onceListenerLookup={},this.listenerLookup={},this.ipcRenderer.on(q,((e,t)=>{if(t&&t.eventId){const e=`${t.eventId}${t.correlationId||""}`;this.onceListenerLookup[e]?(this.onceListenerLookup[e].forEach((e=>e(t))),delete this.onceListenerLookup[e]):this.listenerLookup[e]&&this.listenerLookup[e].forEach((e=>{e(t)}))}}))}postMessage(e){switch(e.eventId){case G.rY.ActivityEvent:case G.rY.CreateWebview:case G.rY.GetWindowLaunchSubSteps:case G.rY.SetTouchBar:case G.rY.ClearTouchBar:case G.rY.ActivateOutlook:this.ipcRenderer.send(q,e);break;case i.W.CoreInitialized:case G.rY.WindowInitialized:this.ipcRenderer.send(q,e),this.ipcRenderer.sendToHost(q,e);break;default:this.ipcRenderer.sendToHost(q,e)}}on(e,t,n=""){const i=`${e}${n}`;this.listenerLookup[i]||(this.listenerLookup[i]=[]),this.listenerLookup[i].push(t)}once(e,t,n=""){const i=`${e}${n}`;this.onceListenerLookup[i]||(this.onceListenerLookup[i]=[]),this.onceListenerLookup[i].push(t)}remove(e,t){e&&t&&(this.onceListenerLookup[e]&&(this.onceListenerLookup[e]=this.onceListenerLookup[e].filter((e=>e!==t)),0===this.onceListenerLookup[e].length&&delete this.onceListenerLookup[e]),this.listenerLookup[e]&&(this.listenerLookup[e]=this.listenerLookup[e].filter((e=>e!==t)),0===this.listenerLookup[e].length&&delete this.listenerLookup[e]))}removeAll(e){delete this.onceListenerLookup[e],delete this.listenerLookup[e]}}class K{constructor(e){this.windowHandle=e,this.ipcRenderer=this.windowHandle.desktop.ipcRenderer,this.webViewCommService=new J(this.ipcRenderer),this.browserShellCommService=new H(e)}postMessage(e){switch(e.eventId){case G.rY.ActivityEvent:case G.rY.CreateWebview:case G.rY.GetWindowLaunchSubSteps:case G.rY.SetTouchBar:case G.rY.ClearTouchBar:this.ipcRenderer.send(q,e);break;case i.W.CoreInitialized:case G.rY.WindowInitialized:this.ipcRenderer.send(q,e),this.browserShellCommService.postMessage(e);break;default:this.browserShellCommService.postMessage(e)}}on(e,t,n=""){this.webViewCommService.on(e,t,n),this.browserShellCommService.on(e,t,n)}once(e,t,n=""){this.webViewCommService.once(e,t,n),this.browserShellCommService.once(e,t,n)}remove(e,t){this.webViewCommService.remove(e,t),this.browserShellCommService.remove(e,t)}removeAll(e){this.webViewCommService.removeAll(e),this.browserShellCommService.removeAll(e)}}class Q{constructor(e){this.globalWindow=e}configureShell(e){const t=this.globalWindow,{isInIframe:n}=e,i=this.extractPerformanceTooling(t),a=n?new K(t):new J(t.desktop.ipcRenderer),o=new V(i,t,a,e);return Object.keys(t.desktop).forEach((e=>{"perf"!==e&&delete t.desktop[e]})),{hostedWindowContext:o.getHostedWindowContext(),window:(0,u.So)(t,o)}}extractPerformanceTooling(e){return e.desktop.perf||{getBlinkMemoryInfo:()=>{},getJSHeapStatistics:()=>{},getMallocMemoryUsage:()=>{},getProcessMemoryInfo:()=>{},getWebCacheInfo:()=>{}}}}var Y=n(745534);class X{constructor(e){this.windowEnvironment=e}configure(){const e={isInCypressFrame:Z(this.windowEnvironment),isInIframe:ee(this.windowEnvironment)};e.isInIframe&&function(e){var t;if(e.navigator){if("Electron"===Y.getParser(null===(t=e.navigator)||void 0===t?void 0:t.userAgent).getBrowserName())return!0}return!1}(this.windowEnvironment)&&function(e){var t;try{const n=e.parent;if(!n||!function(e){return!(!e||!e.electronSafeIpc)}(n))return;e.desktop={perf:null===(t=n.desktop)||void 0===t?void 0:t.perf,ipcRenderer:n.electronSafeIpc},e.createInterprocessStore=n.createInterprocessStore,e.vdiSettings=n.vdiSettings}catch(e){return}}(this.windowEnvironment);return(function(e){return!!(e&&e.desktop&&e.desktop.ipcRenderer)}(this.windowEnvironment)?new Q(this.windowEnvironment):new $(this.windowEnvironment)).configureShell(e)}}function Z(e){try{let t=!!e.Cypress;if(!t){const n=e.top||e.parent;t=!!(null==n?void 0:n.Cypress)}return t}catch(e){return!1}}function ee(e){try{return e.self!==e.top}catch(e){return!0}}class te{constructor(){const e=new X(window);this.config=e.configure(),this.config.window.opener.postMessage(i.W.WindowReady)}static getInstance(){return te.instance||(te.instance=new te),te.instance}get window(){return this.config.window}}},51485:(e,t,n)=>{"use strict";n.d(t,{YR:()=>k,dP:()=>y,So:()=>f});var i=n(786744),a=n(480177),o=n(773176);function r(e){return e.ResizeObserver?e.ResizeObserver:function(t){const n=new Map;let i,a=!1;function o(){if(a||!n.size)return void(i=void 0);const r=[];n.forEach(((e,t)=>{const i=t.getBoundingClientRect();e.height!==i.height&&(n.set(t,i),r.push({target:t,contentRect:i}))})),r.length&&t(r),i=e.requestAnimationFrame(o)}return{observe(t){n.has(t)||(n.set(t,t.getBoundingClientRect()),i||(i=e.requestAnimationFrame(o)))},unobserve(e){n.has(e)&&n.delete(e)},disconnect(){n.clear(),i=void 0,a=!0}}}}var s=n(231191),l=n(319493);class c{constructor(e,t){this._document=e,this._chunkConfig=t,this._loadedItems=new Map,this._loadScript=(0,l.m)(((e,t)=>new Promise(((n,i)=>{if(!e)return n();const a=this._document.createElement("script");a.onload=()=>n(),a.onerror=i,a.async=!0,a.id=`${t}-script`,a.charset="utf-8",a.src=e,this._document.body.appendChild(a)}))),{backoffTime:1e4,retryWindow:3e4,maxRetries:3}),this._loadStyle=(0,l.m)(((e,t)=>new Promise(((n,i)=>{if(!e)return n();const a=this._document.createElement("link");a.onload=()=>n(),a.onerror=i,a.type="text/css",a.rel="stylesheet",a.id=`${t}-style`,a.charset="utf-8",a.href=e,this._document.head.appendChild(a)}))),{backoffTime:1e4,retryWindow:3e4,maxRetries:3}),this.loadChunk=(e,t=!1)=>(0,s.__awaiter)(this,void 0,void 0,(function*(){if(!this._chunkConfig)throw new Error("Chunk loading is not supported in this window or host.");const n=e.reduce(((e,n)=>{const i=this._chunkConfig&&this._chunkConfig[n];if(!i)return e.push(Promise.reject(new Error(`No chunk information found for ${i}.`))),e;const a=i.endsWith(".css")?this._loadStyle:this._loadScript,o=this._loadedItems.get(i)||a(i,n).catch((e=>{throw t&&this._loadedItems.delete(i),e}));return this._loadedItems.has(i)||this._loadedItems.set(i,o),e.push(o),e}),[]);yield Promise.all(n)}))}}var d=n(843149),u=n(550070),m=n(21168),p=n(722474),g=n(929331);const h=e=>!(!e.matchMedia("(display-mode: fullscreen)").matches&&!e.document.fullscreenElement);var v=n(429145);const f=(e,t)=>{var n,i,a;let o;try{o={loader:e.loader,loaderConfig:e.loaderConfig,preCoreUiAdapter:e.preCoreUiAdapter,Cypress:e.Cypress,document:e.document,emitDebugEvent:e.emitDebugEvent,external:e.external,location:e.location,history:e.history,navigator:e.navigator,caches:e.caches,crypto:e.crypto,parent:e.parent,self:e.self,top:e.top,performance:e.performance,msCrypto:e.msCrypto&&e.msCrypto,IntersectionObserver:e.IntersectionObserver,ResizeObserver:r(e),WeakReference:e.WeakReference,chunkLoader:new c(e.document,e.__experienceWindowChunks__),screen:e.screen,viewportContext:t.viewportContext,chrome:e.chrome,open:e.loader&&e.loader.openWindow?e.loader.openWindow.bind(e.loader):e.open.bind(e),fetch:e.fetch&&e.fetch.bind(e),close:e.close.bind(e),alert:e.alert.bind(e),requestAnimationFrame:e.requestAnimationFrame.bind(e),cancelAnimationFrame:e.cancelAnimationFrame.bind(e),requestIdleCallback:e.requestIdleCallback?e.requestIdleCallback.bind(e):e.requestAnimationFrame.bind(e),cancelIdleCallback:e.cancelIdleCallback?e.cancelIdleCallback.bind(e):e.cancelAnimationFrame.bind(e),setInterval:e.setInterval.bind(e),clearInterval:e.clearInterval.bind(e),clearTimeout:e.clearTimeout.bind(e),setTimeout:e.setTimeout.bind(e),addEventListener:e.addEventListener.bind(e),removeEventListener:e.removeEventListener.bind(e),dispatchEvent:e.dispatchEvent.bind(e),focus:e.focus.bind(e),getSelection:e.getSelection.bind(e),getComputedStyle:e.getComputedStyle.bind(e),onpagehide:null===(n=e.onpagehide)||void 0===n?void 0:n.bind(e),setBounds:e.setBounds,setMinimumSize:e.setMinimumSize,createInterprocessStore:e.createInterprocessStore,Logging:e.Logging,matchMedia:e.matchMedia?e.matchMedia.bind(e):null,proxyPostMessage:(t,n,i)=>{e.proxyPostMessage&&e.proxyPostMessage(t,n,i)},getLocaleInfoAsync:()=>e.getLocaleInfoAsync?e.getLocaleInfoAsync():Promise.resolve(void 0),getUserMedia:t=>{var n,i;return(null===(i=null===(n=e.navigator)||void 0===n?void 0:n.mediaDevices)||void 0===i?void 0:i.getUserMedia)?e.navigator.mediaDevices.getUserMedia(t):Promise.reject(new Error("Not available"))},get __experienceWindowChunks__(){return e.__experienceWindowChunks__},get __webpack_nonce__(){return e.__webpack_nonce__},get __webpack_public_path__(){return e.__webpack_public_path__},get devicePixelRatio(){return e.devicePixelRatio},get localStorage(){return e.localStorage},get sessionStorage(){return e.sessionStorage},get indexedDB(){return e.indexedDB},get CKEDITOR(){return e.CKEDITOR},get ITEMS_VIEW_STRINGS(){return e.ITEMS_VIEW_STRINGS},get CodeMirror(){return e.CodeMirror},get MutationObserver(){return e.MutationObserver},get LivePersonaCardStrings(){return e.LivePersonaCardStrings},get LivePersonaCardHoverTargetV2(){return e.LivePersonaCardHoverTargetV2},get LPC(){return e.LPC},get authLogger(){return e.Logging},get Microsoft(){return e.Microsoft},get Office(){return e.Office},get Image(){return e.Image},get DOMParser(){return e.DOMParser},videoRenderer:e.videoRenderer,get FrameSinkReader(){return e.FrameSinkReader},get continueExternalAuth(){return e.continueExternalAuth},set continueExternalAuth(t){e.continueExternalAuth=t},get continueMsaAuth(){return e.continueMsaAuth},set continueMsaAuth(t){e.continueMsaAuth=t},get FabricConfig(){return e.FabricConfig},set FabricConfig(t){e.FabricConfig=t},get CKEDITOR_BASEPATH(){return e.CKEDITOR_BASEPATH},get opener(){return t.opener},get envPerformance(){return t.envPerformance},getHostedWindowContext:t.getHostedWindowContext.bind(t),onAppStart:t.onAppStart.bind(t),get isHighResolution(){if(e){const t=1.3,n=e.navigator&&e.navigator.userAgent&&e.navigator.userAgent.toLowerCase().indexOf("firefox")>-1;if(void 0!==e.devicePixelRatio&&!n)return e.devicePixelRatio>t;if(e.matchMedia){const t="(-webkit-min-device-pixel-ratio: 1.3),            (min--moz-device-pixel-ratio: 1.3),            (-o-min-device-pixel-ratio: 1.3),            (min-resolution: 120dpi)";return e.matchMedia(t).matches}}return!1},get screenX(){return e.screenX},get screenY(){return e.screenY},get innerWidth(){return e.innerWidth},get innerHeight(){return e.innerHeight},isFocused:()=>e.isFocused?e.isFocused():e.document.hasFocus(),onFullscreen:()=>new d.X(!1),exitFullscreen:()=>{},maximize:()=>{},minimize:()=>{},requestFullscreen:()=>{},show:()=>{},windowTitleDblClick:()=>{},clearCache:()=>{var t;return null===(t=e.clearCache)||void 0===t?void 0:t.call(e)},getZoomFactor:()=>e.getZoomFactor?e.getZoomFactor():0,zoomFactors:null!==(i=e.zoomFactors)&&void 0!==i?i:u.E,zoomIn:()=>e.zoomIn?e.zoomIn():void 0,zoomOut:()=>e.zoomOut?e.zoomOut():void 0,zoomReset:()=>e.zoomReset?e.zoomReset():void 0,vdiSettings:e.vdiSettings}}catch(e){throw new v.G("CREATE_WINDOW_WRAPPER",e)}return e.CKEDITOR_BASEPATH=e.CKEDITOR_BASEPATH||`${e.__webpack_public_path__||(null===(a=null==t?void 0:t.getHostedWindowContext())||void 0===a?void 0:a.__webpack_public_path__)||""}ckeditor/4.15.1-msft-7/`||"",o};function y(e,t,n,a,o){const{windowProvider:r}=t,s=e,l=f(s,r),u=k(a,o),v={chunkLoader:new c(s.document,r.__experienceWindowChunks__),parent:r,viewportContext:u,FabricConfig:{mergeStyles:{namespace:"cw"}},exitFullscreen:()=>S("exitFullscreen",e,t,n),focus:()=>S("focus",e,t,n),maximize:()=>S("maximize",e,t,n),minimize:()=>S("minimize",e,t,n),requestFullscreen:()=>S("requestFullscreen",e,t,n),windowTitleDblClick:()=>S("windowTitleDblClick",e,t,n),onFullscreen:()=>((e,t,n)=>{const{interprocessStoreService:a,loggerFactory:o,platformService:r}=e,s=o.newLogger("WindowUtilities");if(r.config.clientType===i.Bh.Desktop)return a?a.onWindowFullscreen(n).pipe((0,m.b)((e=>s.log(`WindowHook[onFullscreen] update to: ${e}`)))):(s.error("WindowHook[onFullscreen] on desktop failed due to interprocessStoreService missing"),new d.X(!1));{const e=t,n=new d.X(h(e)),i=new e.ResizeObserver((()=>n.next(h(e))));return i.observe(e.document.documentElement),n.pipe((0,p.x)((()=>i.disconnect())),(0,g.x)())}})(t,e,n)};return Object.assign(l,v)}function S(e,t,n,a){const{interprocessStoreService:o,loggerFactory:r,platformService:s}=n,l=r.newLogger("WindowUtilities");if(l.log(`Performing action ${e}`),s.config.clientType===i.Bh.Desktop){if("focus"===e&&(null==t?void 0:t.document.hidden)&&(e="show"),!o)return void l.error(`WindowAction[${e}] on Desktop failed due to interprocessStoreService missing`);o[e](a).then((()=>{l.log(`WindowAction[${e}] on Desktop succeeded.`)})).catch((t=>{l.error(`WindowAction[${e}] on Desktop failed with: ${t&&t.message} (${t&&t.code})`)}))}else{const n=t;switch(e){case"exitFullscreen":n.document.exitFullscreen().catch((t=>{l.error(`WindowAction[${e}] on Web failed due to: ${t}.`)}));break;case"requestFullscreen":n.document.documentElement.requestFullscreen().catch((t=>{l.error(`WindowAction[${e}] on Web failed due to: ${t}.`)}));break;default:try{n[e]()}catch(t){l.error(`WindowAction[${e}] on Web failed due to: ${t}.`)}}}}function k(e,t){let n;return n=e?t===a.lO.minimal?o.R.flyout:o.R.primary:o.R.secondary,n}},473554:(e,t,n)=>{"use strict";var i,a;n.d(t,{V:()=>i}),function(e){e[e.BT_STOP=0]="BT_STOP",e[e.BT_STOP_BASE=1]="BT_STOP_BASE",e[e.BT_BOOL=2]="BT_BOOL",e[e.BT_UINT8=3]="BT_UINT8",e[e.BT_UINT16=4]="BT_UINT16",e[e.BT_UINT32=5]="BT_UINT32",e[e.BT_UINT64=6]="BT_UINT64",e[e.BT_FLOAT=7]="BT_FLOAT",e[e.BT_DOUBLE=8]="BT_DOUBLE",e[e.BT_STRING=9]="BT_STRING",e[e.BT_STRUCT=10]="BT_STRUCT",e[e.BT_LIST=11]="BT_LIST",e[e.BT_SET=12]="BT_SET",e[e.BT_MAP=13]="BT_MAP",e[e.BT_INT8=14]="BT_INT8",e[e.BT_INT16=15]="BT_INT16",e[e.BT_INT32=16]="BT_INT32",e[e.BT_INT64=17]="BT_INT64",e[e.BT_WSTRING=18]="BT_WSTRING",e[e.BT_UNAVAILABLE=127]="BT_UNAVAILABLE"}(i||(i={})),function(e){e[e.MARSHALED_PROTOCOL=0]="MARSHALED_PROTOCOL",e[e.MAFIA_PROTOCOL=17997]="MAFIA_PROTOCOL",e[e.COMPACT_PROTOCOL=16963]="COMPACT_PROTOCOL",e[e.JSON_PROTOCOL=21322]="JSON_PROTOCOL",e[e.PRETTY_JSON_PROTOCOL=20554]="PRETTY_JSON_PROTOCOL",e[e.SIMPLE_PROTOCOL=20563]="SIMPLE_PROTOCOL"}(a||(a={}))},556085:(e,t,n)=>{"use strict";n.d(t,{D:()=>i});class i{constructor(){this._buffer=[]}Add(e,t){-1==this._getIndex(e)&&this._buffer.push({Key:e,Value:t})}AddOrReplace(e,t){var n=this._getIndex(e);n>=0?this._buffer[n]={Key:e,Value:t}:this._buffer.push({Key:e,Value:t})}Remove(e){var t=this._getIndex(e);t>=0&&this._buffer.splice(t,1)}Count(){return this._buffer.length}GetBuffer(){return this._buffer}ContainsKey(e){return this._getIndex(e)>=0}Get(e){var t=this._getIndex(e);return t>=0?this._buffer[t].Value:null}_getIndex(e){for(var t=0,n=-1;t<this._buffer.length;++t)if(this._buffer[t].Key==e){n=t;break}return n}}},140518:(e,t,n)=>{"use strict";n.d(t,{di:()=>a,DS:()=>o,Km:()=>r,Ms:()=>s,bv:()=>l,bh:()=>c,if:()=>d,F4:()=>u,MD:()=>m});var i=n(525005);class a{static GetBytes(e){for(var t=[],n=0;n<e.length;++n){var i=e.charCodeAt(n);i<128?t.push(i):i<2048?t.push(192|i>>6,128|63&i):i<55296||i>=57344?t.push(224|i>>12,128|i>>6&63,128|63&i):(i=65536+((1023&i)<<10|1023&e.charCodeAt(++n)),t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return t}}class o{static GetString(e){var t,n,i,a,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=[],s=e.length%3;for(t=0,i=e.length-s;t<i;t+=3)n=(e[t]<<16)+(e[t+1]<<8)+e[t+2],r.push([o.charAt((a=n)>>18&63),o.charAt(a>>12&63),o.charAt(a>>6&63),o.charAt(63&a)].join(""));switch(s){case 1:n=e[e.length-1],r.push(o.charAt(n>>2)),r.push(o.charAt(n<<4&63)),r.push("==");break;case 2:n=(e[e.length-2]<<8)+e[e.length-1],r.push(o.charAt(n>>10)),r.push(o.charAt(n>>4&63)),r.push(o.charAt(n<<2&63)),r.push("=")}return r.join("")}}class r{static GetBytes(e){for(var t=[];4294967168&e;)t.push(127&e|128),e>>>=7;return t.push(127&e),t}}class s{static GetBytes(e){for(var t=e.low,n=e.high,i=[];n||4294967168&t;)i.push(127&t|128),t=(127&n)<<25|t>>>7,n>>>=7;return i.push(127&t),i}}class l{static GetBytes(e){if(i.KS.IsDataViewSupport()){var t=new DataView(new ArrayBuffer(4));t.setFloat32(0,e,!0);for(var n=[],a=0;a<4;++a)n.push(t.getUint8(a));return n}return p.ConvertNumberToArray(e,!1)}}class c{static GetBytes(e){if(i.KS.IsDataViewSupport()){var t=new DataView(new ArrayBuffer(8));t.setFloat64(0,e,!0);for(var n=[],a=0;a<8;++a)n.push(t.getUint8(a));return n}return p.ConvertNumberToArray(e,!0)}}class d{static EncodeZigzag16(e){return(e=i.Mr.ToInt16(e))<<1^e>>15}static EncodeZigzag32(e){return(e=i.Mr.ToInt32(e))<<1^e>>31}static EncodeZigzag64(e){var t=e.low,n=e.high,a=n<<1|t>>>31,o=t<<1;2147483648&n&&(a=~a,o=~o);var r=new i.zM("0");return r.low=o,r.high=a,r}}class u{static GetString(e){for(var t=[],n=0;n<e.length;++n){var i=e[n];if(i<=191)t.push(String.fromCharCode(i));else if(i<=223){var a=e[++n];t.push(String.fromCharCode((31&i)<<6|63&a))}else if(i<=239){a=e[++n];var o=e[++n];t.push(String.fromCharCode((15&i)<<12|(63&a)<<6|63&o))}else{i=(7&i)<<18|(63&(a=e[++n]))<<12|(63&(o=e[++n]))<<6|63&e[++n],i-=65536,t.push(String.fromCharCode(55296|i>>10&1023)),t.push(String.fromCharCode(56320|1023&i))}}return t.join("")}}class m{static GetBytes(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=[],i=0;i<e.length;++i){var a=t.indexOf(e.charAt(i++)),o=t.indexOf(e.charAt(i++)),r=t.indexOf(e.charAt(i++)),s=t.indexOf(e.charAt(i));n.push(a<<2|o>>4),r>=0&&(n.push(o<<4&240|r>>2),s>=0&&n.push(r<<6&192|s))}return n}}class p{static ConvertNumberToArray(e,t){if(!e)return t?this._doubleZero:this._floatZero;var n=t?52:23,i=(1<<(t?11:8)-1)-1,a=1-i,o=i,r=e<0?1:0;e=Math.abs(e);for(var s=Math.floor(e),l=e-s,c=2*(i+2)+n,d=new Array(c),u=0;u<c;)d[u++]=0;for(u=i+2;u&&s;)d[--u]=s%2,s=Math.floor(s/2);for(u=i+1;u<c-1&&l>0;)(l*=2)>=1?(d[++u]=1,--l):d[++u]=0;for(var m=0;m<c&&!d[m];++m);var p=i+1-m,g=m+n;if(d[g+1]){for(u=g;u>m&&!(d[u]=1-d[u]);--u);u==m&&++p}if(p>o||s)return r?t?this._doubleNegInifinity:this._floatNegInifinity:t?this._doubleInifinity:this._floatInifinity;if(p<a)return t?this._doubleZero:this._floatZero;if(t){var h=0;for(u=0;u<20;++u)h=h<<1|d[++m];for(var v=0;u<52;++u)v=v<<1|d[++m];return[255&v,v>>8&255,v>>16&255,v>>>24,255&(h=r<<31|2147483647&(h|=p+i<<20)),h>>8&255,h>>16&255,h>>>24]}var f=0;for(u=0;u<23;++u)f=f<<1|d[++m];return[255&(f=r<<31|2147483647&(f|=p+i<<23)),f>>8&255,f>>16&255,f>>>24]}static ConvertArrayToNumber(e,t){var n=(1<<(t?11:8)-1)-1,a=0!=(128&e[t?7:3]),o=t?(127&e[7])<<4|(240&e[6])>>4:(127&e[3])<<1|(128&e[2])>>7;if(255==o)throw new i.Pp("Not a valid float/double buffer.");var r=1,s=1;if(t){var l=(15&e[6])<<28|(255&e[5])<<20|(255&e[4])<<12,c=e[3]<<24|(255&e[2])<<16|(255&e[1])<<8|255&e[0];if(!o&&!l&&!c)return 0;for(var d=0;d<20;++d)s/=2,l<0&&(r+=s),l<<=1;for(d=0;d<32;++d)s/=2,c<0&&(r+=s),c<<=1}else{var u=(127&e[2])<<25|(255&e[1])<<17|(255&e[0])<<9;if(!o&&!u)return 0;for(d=0;d<23;++d)s/=2,u<0&&(r+=s),u<<=1}return r*=Math.pow(2,o-n),a?0-r:r}}p._floatZero=[0,0,0,0],p._doubleZero=[0,0,0,0,0,0,0,0],p._floatInifinity=[0,0,128,127],p._floatNegInifinity=[0,0,128,255],p._doubleInifinity=[0,0,0,0,0,0,240,127],p._doubleNegInifinity=[0,0,0,0,0,0,240,255]},525005:(e,t,n)=>{"use strict";n.d(t,{ni:()=>o,zM:()=>r,Mr:()=>s,Pp:()=>l,KS:()=>c,rH:()=>d});var i=n(473554),a=n(140518);class o{constructor(e){this.low=0,this.high=0,this.low=parseInt(e),this.low<0&&(this.high=-1)}Equals(e){var t=new o(e);return this.low==t.low&&this.high==t.high}}class r{constructor(e){this.low=0,this.high=0,this.low=parseInt(e)}Equals(e){var t=new r(e);return this.low==t.low&&this.high==t.high}}class s{static ToByte(e){return this.ToUInt8(e)}static ToInt8(e){return 127&e|(128&e)<<24>>24}static ToInt16(e){return 32767&e|(32768&e)<<16>>16}static ToInt32(e){return 2147483647&e|2147483648&e}static ToUInt8(e){return 255&e}static ToUInt16(e){return 65535&e}static ToUInt32(e){return 4294967295&e}}class l{constructor(e){this.Message=e}}class c{static IsDataViewSupport(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView}}class d{constructor(e){this._stream=e}WriteBlob(e){this._stream.Write(e,0,e.length)}WriteBool(e){this._stream.WriteByte(e?1:0)}WriteContainerBegin(e,t){this.WriteUInt8(t),this.WriteUInt32(e)}WriteMapContainerBegin(e,t,n){this.WriteUInt8(t),this.WriteUInt8(n),this.WriteUInt32(e)}WriteContainerEnd(){}WriteDouble(e){var t=a.bh.GetBytes(e);this._stream.Write(t,0,t.length)}WriteFloat(e){var t=a.bv.GetBytes(e);this._stream.Write(t,0,t.length)}WriteFieldBegin(e,t,n){t<=5?this._stream.WriteByte(e|t<<5):t<=255?(this._stream.WriteByte(192|e),this._stream.WriteByte(t)):(this._stream.WriteByte(224|e),this._stream.WriteByte(t),this._stream.WriteByte(t>>8))}WriteFieldEnd(){}WriteFieldOmitted(e,t,n){}WriteInt16(e){e=a.if.EncodeZigzag16(e),this.WriteUInt16(e)}WriteInt32(e){e=a.if.EncodeZigzag32(e),this.WriteUInt32(e)}WriteInt64(e){this.WriteUInt64(a.if.EncodeZigzag64(e))}WriteInt8(e){this._stream.WriteByte(s.ToInt8(e))}WriteString(e){if(""==e)this.WriteUInt32(0);else{var t=a.di.GetBytes(e);this.WriteUInt32(t.length),this._stream.Write(t,0,t.length)}}WriteStructBegin(e,t){}WriteStructEnd(e){this.WriteUInt8(e?i.V.BT_STOP_BASE:i.V.BT_STOP)}WriteUInt16(e){var t=a.Km.GetBytes(s.ToUInt16(e));this._stream.Write(t,0,t.length)}WriteUInt32(e){var t=a.Km.GetBytes(s.ToUInt32(e));this._stream.Write(t,0,t.length)}WriteUInt64(e){var t=a.Ms.GetBytes(e);this._stream.Write(t,0,t.length)}WriteUInt8(e){this._stream.WriteByte(s.ToUInt8(e))}WriteWString(e){this.WriteUInt32(e.length);for(var t=0;t<e.length;++t){var n=e.charCodeAt(t);this._stream.WriteByte(n),this._stream.WriteByte(n>>>8)}}}},313176:(e,t,n)=>{"use strict";n.d(t,{P6:()=>c,A4:()=>o,WV:()=>u,Pm:()=>m,$L:()=>p});var i,a,o,r=n(525005),s=n(473554),l=n(556085);class c{static GetGuid(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1,5)};return[e(),e(),"-",e(),"-",e(),"-",e(),"-",e(),e(),e()].join("")}static GetTimeStamp(){var e=(new Date).getTime(),t=new r.ni("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t}static GetTimeStampWithValue(e){var t=new r.ni("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t}}!function(e){e[e.NotSet=0]="NotSet",e[e.Event=1]="Event",e[e.PerformanceCounter=2]="PerformanceCounter",e[e.Anomaly=3]="Anomaly",e[e.Prediction=4]="Prediction",e[e.TraceLog=5]="TraceLog",e[e.EventSourceLog=6]="EventSourceLog",e[e.HttpLog=7]="HttpLog",e[e.PerformanceCounterAzure=8]="PerformanceCounterAzure",e[e.PerformanceCounterGfs=9]="PerformanceCounterGfs"}(i||(i={})),function(e){e[e.NotSet=0]="NotSet",e[e.O365=1]="O365",e[e.SkypeBI=2]="SkypeBI",e[e.SkypeData=3]="SkypeData"}(a||(a={})),function(e){e[e.NotSet=0]="NotSet",e[e.DistinguishedName=1]="DistinguishedName",e[e.GenericData=2]="GenericData",e[e.IPV4Address=3]="IPV4Address",e[e.IPv6Address=4]="IPv6Address",e[e.MailSubject=5]="MailSubject",e[e.PhoneNumber=6]="PhoneNumber",e[e.QueryString=7]="QueryString",e[e.SipAddress=8]="SipAddress",e[e.SmtpAddress=9]="SmtpAddress",e[e.Identity=10]="Identity",e[e.Uri=11]="Uri",e[e.Fqdn=12]="Fqdn",e[e.IPV4AddressLegacy=13]="IPV4AddressLegacy",e[e.FilePath=14]="FilePath"}(o||(o={}));class d{constructor(){this.ScrubType=a.NotSet,this.Kind=o.NotSet,this.RawContent=""}Write(e){this.WriteImpl(e,!1)}WriteImpl(e,t){e.WriteStructBegin(null,t),this.ScrubType!=a.NotSet?(e.WriteFieldBegin(s.V.BT_INT32,1,null),e.WriteInt32(this.ScrubType),e.WriteFieldEnd()):e.WriteFieldOmitted(s.V.BT_INT32,1,null),this.Kind!=o.NotSet?(e.WriteFieldBegin(s.V.BT_INT32,2,null),e.WriteInt32(this.Kind),e.WriteFieldEnd()):e.WriteFieldOmitted(s.V.BT_INT32,2,null),""!=this.RawContent?(e.WriteFieldBegin(s.V.BT_STRING,3,null),e.WriteString(this.RawContent),e.WriteFieldEnd()):e.WriteFieldOmitted(s.V.BT_STRING,3,null),e.WriteStructEnd(t)}Read(e){this.ReadImpl(e,!1)}ReadImpl(e,t){}}class u{constructor(){this.Id=c.GetGuid(),this.Timestamp=c.GetTimeStamp(),this.Type="",this.EventType="",this.Extension=new l.D,this.RecordType=i.NotSet,this.PIIExtensions=new l.D}AddOrReplacePII(e,t,n){var i=new d;i.RawContent=t,i.Kind=n,i.ScrubType=a.O365,this.PIIExtensions.AddOrReplace(e,i)}Write(e){this.WriteImpl(e,!1)}WriteImpl(e,t){if(e.WriteStructBegin(null,t),""!=this.Id?(e.WriteFieldBegin(s.V.BT_STRING,1,null),e.WriteString(this.Id),e.WriteFieldEnd()):e.WriteFieldOmitted(s.V.BT_STRING,1,null),this.Timestamp.Equals("0")?e.WriteFieldOmitted(s.V.BT_INT64,3,null):(e.WriteFieldBegin(s.V.BT_INT64,3,null),e.WriteInt64(this.Timestamp),e.WriteFieldEnd()),""!=this.Type?(e.WriteFieldBegin(s.V.BT_STRING,5,null),e.WriteString(this.Type),e.WriteFieldEnd()):e.WriteFieldOmitted(s.V.BT_STRING,5,null),""!=this.EventType?(e.WriteFieldBegin(s.V.BT_STRING,6,null),e.WriteString(this.EventType),e.WriteFieldEnd()):e.WriteFieldOmitted(s.V.BT_STRING,6,null),this.Extension.Count()){e.WriteFieldBegin(s.V.BT_MAP,13,null),e.WriteMapContainerBegin(this.Extension.Count(),s.V.BT_STRING,s.V.BT_STRING);for(var n=0;n<this.Extension.GetBuffer().length;++n)e.WriteString(this.Extension.GetBuffer()[n].Key),e.WriteString(this.Extension.GetBuffer()[n].Value);e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(s.V.BT_MAP,13,null);if(this.RecordType!=i.NotSet?(e.WriteFieldBegin(s.V.BT_INT32,24,null),e.WriteInt32(this.RecordType),e.WriteFieldEnd()):e.WriteFieldOmitted(s.V.BT_INT32,24,null),this.PIIExtensions.Count()){e.WriteFieldBegin(s.V.BT_MAP,30,null),e.WriteMapContainerBegin(this.PIIExtensions.Count(),s.V.BT_STRING,s.V.BT_STRUCT);for(var a=0;a<this.PIIExtensions.GetBuffer().length;++a)e.WriteString(this.PIIExtensions.GetBuffer()[a].Key),this.PIIExtensions.GetBuffer()[a].Value.WriteImpl(e,!1);e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(s.V.BT_MAP,30,null);e.WriteStructEnd(t)}Read(e){this.ReadImpl(e,!1)}ReadImpl(e,t){}}class m{constructor(){this.Source="",this.DataPackageId="",this.Timestamp=new r.ni("0"),this.Records=[]}Write(e){this.WriteImpl(e,!1)}WriteImpl(e,t){if(e.WriteStructBegin(null,t),""!=this.Source?(e.WriteFieldBegin(s.V.BT_STRING,2,null),e.WriteString(this.Source),e.WriteFieldEnd()):e.WriteFieldOmitted(s.V.BT_STRING,2,null),""!=this.DataPackageId?(e.WriteFieldBegin(s.V.BT_STRING,5,null),e.WriteString(this.DataPackageId),e.WriteFieldEnd()):e.WriteFieldOmitted(s.V.BT_STRING,5,null),this.Timestamp.Equals("0")?e.WriteFieldOmitted(s.V.BT_INT64,6,null):(e.WriteFieldBegin(s.V.BT_INT64,6,null),e.WriteInt64(this.Timestamp),e.WriteFieldEnd()),this.Records.length){e.WriteFieldBegin(s.V.BT_LIST,8,null),e.WriteContainerBegin(this.Records.length,s.V.BT_STRUCT);for(var n=0;n<this.Records.length;++n)this.Records[n].WriteImpl(e,!1);e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(s.V.BT_LIST,8,null);e.WriteStructEnd(t)}Read(e){this.ReadImpl(e,!1)}ReadImpl(e,t){}}class p{constructor(){this.DataPackages=[],this.RequestRetryCount=0}Write(e){this.WriteImpl(e,!1)}WriteImpl(e,t){if(e.WriteStructBegin(null,t),this.DataPackages.length){e.WriteFieldBegin(s.V.BT_LIST,1,null),e.WriteContainerBegin(this.DataPackages.length,s.V.BT_STRUCT);for(var n=0;n<this.DataPackages.length;++n)this.DataPackages[n].WriteImpl(e,!1);e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(s.V.BT_LIST,1,null);0!=this.RequestRetryCount?(e.WriteFieldBegin(s.V.BT_INT32,2,null),e.WriteInt32(this.RequestRetryCount),e.WriteFieldEnd()):e.WriteFieldOmitted(s.V.BT_INT32,2,null),e.WriteStructEnd(t)}Read(e){this.ReadImpl(e,!1)}ReadImpl(e,t){}}},565810:(e,t,n)=>{"use strict";n.d(t,{Mk:()=>y,sE:()=>S});var i=n(313176);class a{static IsSafariOrFirefox(){return null===a._isSafariOrFirefox&&a._DetectBrowser(),a._isSafariOrFirefox}static ajax(e){var t=a._createConnection();if(e.headers){var n="qsp=true";for(var i in e.headers)n+="&",n+=encodeURIComponent(i),n+="=",n+=encodeURIComponent(e.headers[i]);e.url.indexOf("?")<0?e.url+="?":e.url+="&",e.url+=n}t.open(e.type,e.url),e.complete&&(t.onload=()=>{void 0===t.status&&(t.status=200),e.complete(t)},t.ontimeout=()=>{void 0===t.status&&(t.status=500),e.complete(t)},t.onerror=()=>{e.complete(t)}),t.send(e.data)}static keys(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}static IsUsingXDomainRequest(){null==a._usingXDomainRequest&&(void 0===(new XMLHttpRequest).withCredentials&&"undefined"!=typeof XDomainRequest?a._usingXDomainRequest=!0:a._usingXDomainRequest=!1);return a._usingXDomainRequest}static _createConnection(){var e=new XMLHttpRequest;return a.IsUsingXDomainRequest()?new XDomainRequest:e}static _DetectBrowser(){var e=navigator.userAgent.toLowerCase();(e.indexOf("safari")>=0||e.indexOf("firefox")>=0)&&e.indexOf("chrome")<0?a._isSafariOrFirefox=!0:a._isSafariOrFirefox=!1}}a._isSafariOrFirefox=null,a._usingXDomainRequest=null;var o,r,s,l=n(140518),c=n(525005);class d{constructor(){this._buffer=[]}WriteByte(e){this._buffer.push(c.Mr.ToByte(e))}Write(e,t,n){for(;n--;)this.WriteByte(e[t++])}GetBuffer(){return this._buffer}}class u{constructor(){this.data=[]}WriteBlob(e){let t={type:"blob",value:e};this.data.push(t)}WriteBool(e){let t={type:"boolean",value:e};this.data.push(t)}WriteContainerBegin(e,t){let n={type:"containerBegin",size:e,elementType:t};this.data.push(n)}WriteMapContainerBegin(e,t,n){let i={type:"mapContainerBegin",size:e,keyType:t,valueType:n};this.data.push(i)}WriteContainerEnd(){this.data.push({type:"containerEnd"})}WriteDouble(e){let t={type:"number",value:e};this.data.push(t)}WriteFloat(e){let t={type:"number",value:e};this.data.push(t)}WriteFieldBegin(e,t,n){let i={type:"fieldBegin",id:t};this.data.push(i)}WriteFieldEnd(){this.data.push({type:"fieldEnd"})}WriteFieldOmitted(e,t,n){let i={type:"fieldOmitted",id:t};this.data.push(i)}WriteInt16(e){let t={type:"number",value:e};this.data.push(t)}WriteInt32(e){let t={type:"number",value:e};this.data.push(t)}WriteInt64(e){let t={type:"number",value:4294967296*e.high+e.low};this.data.push(t)}WriteInt8(e){let t={type:"number",value:e};this.data.push(t)}WriteString(e){let t={type:"string",value:e};this.data.push(t)}WriteStructBegin(e,t){let n={type:"structBegin",isBase:t};this.data.push(n)}WriteStructEnd(e){let t={type:"structEnd",isBase:e};this.data.push(t)}WriteUInt16(e){let t={type:"number",value:e};this.data.push(t)}WriteUInt32(e){let t={type:"number",value:e};this.data.push(t)}WriteUInt64(e){let t={type:"number",value:e};this.data.push(t)}WriteUInt8(e){let t={type:"number",value:e};this.data.push(t)}WriteWString(e){let t={type:"string",value:e};this.data.push(t)}}!function(e){e[e.ECS_ERROR_OK=0]="ECS_ERROR_OK",e[e.ECS_ERROR_INVALID_STATUS=1]="ECS_ERROR_INVALID_STATUS",e[e.ECS_ERROR_INVALID_RESPONSE=6]="ECS_ERROR_INVALID_RESPONSE",e[e.ECS_ERROR_INVALID_CONFIG=8]="ECS_ERROR_INVALID_CONFIG"}(o||(o={}));!function(e){e[e.CONFIG_UPDATED=0]="CONFIG_UPDATED",e[e.TOKEN_IS_INVALID=1]="TOKEN_IS_INVALID"}(r||(r={}));class m{}m.Servers=["https://config.teams.microsoft.com/config/v1/Skype/"],m.RefreshIntervalInMS=36e5,m.FailedRetryFactorInMS=1e4,m.MaxRetryIntervalForFailedInMS=36e5,function(e){e[e.Created=0]="Created",e[e.Initialized=1]="Initialized",e[e.Started=2]="Started",e[e.Loading=3]="Loading"}(s||(s={}));var p,g,h,v=n(727455);!function(e){e[e.SENT=0]="SENT",e[e.SEND_FAILED=1]="SEND_FAILED"}(p||(p={})),function(e){e[e.DATARV_ERROR_OK=0]="DATARV_ERROR_OK",e[e.DATARV_ERROR_INVALID_EVENT=1]="DATARV_ERROR_INVALID_EVENT",e[e.DATARV_ERROR_INVALID_CONFIG=2]="DATARV_ERROR_INVALID_CONFIG",e[e.DATARV_ERROR_INVALID_DEPENDENCIES=3]="DATARV_ERROR_INVALID_DEPENDENCIES",e[e.DATARV_ERROR_INVALID_STATUS=4]="DATARV_ERROR_INVALID_STATUS",e[e.DATARV_ERROR_INVALID_ARG=5]="DATARV_ERROR_INVALID_ARG"}(g||(g={}));class f{constructor(e){this._errorCode=g.DATARV_ERROR_OK,this._errorCode=e}ErrorCode(){return this._errorCode}toString(){switch(this._errorCode){case g.DATARV_ERROR_OK:return"DATARV_ERROR_OK";case g.DATARV_ERROR_INVALID_EVENT:return"Event is invalid. Either event.Id is empty, or event.Timestamp is empty, or event.EventType is empty.";case g.DATARV_ERROR_INVALID_CONFIG:return"Invalid configuration. CollectorUrl is missing.";case g.DATARV_ERROR_INVALID_DEPENDENCIES:return"DATARV_ERROR_INVALID_DEPENDENCIES";case g.DATARV_ERROR_INVALID_STATUS:return"Telemetry Manager is not initialized.";case g.DATARV_ERROR_INVALID_ARG:return"TenantToken is null or empty, or events is null.";default:return"Unknown error"}}}class y{constructor(){this.eventsLimitInMem=1e4}}class S{static CreateTelemetryManager(){return new b}}class k{}k.MaxPackageSizeInBytes=3e6,k.TimeIntervalForNextSendInMS=15e3,function(e){e[e.Created=0]="Created",e[e.Initialized=1]="Initialized",e[e.Started=2]="Started"}(h||(h={}));class b{constructor(){this._MaxPackageSizeInBytes=k.MaxPackageSizeInBytes,this._listeners=[],this._status=h.Created,this._ecsClient=null,this._etag=null,this._ecsCallback=null,this._testServerResponseHook=null,this._testHookListeners=[]}Initialize(e){if(this._status!=h.Created)throw new f(g.DATARV_ERROR_INVALID_STATUS);if(!e||!e.collectorUrl)throw new f(g.DATARV_ERROR_INVALID_CONFIG);this._config=e,this._Reset(),this._status=h.Initialized,e.ecsClient&&(this._Verbose("ECS object assigned. Do integration"),this._ecsClient=e.ecsClient),e.overwriteSendTimeInterval&&e.overwriteSendTimeInterval>=0&&(k.TimeIntervalForNextSendInMS=e.overwriteSendTimeInterval),this._Verbose("Initialize() done")}setEventsLimitInMem(e){this._eventsCache.setEventsLimitInMem(e)}AddListener(e){if(this._status<h.Initialized)throw new f(g.DATARV_ERROR_INVALID_STATUS);this._Verbose(["AddListener(), status: ",this._status," old length: ",this._listeners.length," func: ",e].join(""));for(var t=0;t<this._listeners.length;++t)if(this._listeners[t]==e)return void this._Verbose("the listener has been added already, index: "+t);this._listeners.push(e),this._Verbose("AddListener() done, the new length: "+this._listeners.length)}RemoveListener(e){if(this._status<h.Initialized)throw new f(g.DATARV_ERROR_INVALID_STATUS);this._Verbose(["RemoveListener(), status: ",this._status," old length: ",this._listeners.length," func: ",e].join(""));for(var t=0;t<this._listeners.length;++t)if(this._listeners[t]==e)return 1==this._listeners.length?this._listeners=[]:t==this._listeners.length-1?this._listeners.pop():this._listeners[t]=this._listeners.pop(),void this._Verbose(["this listener has been found, index: ",t,"new length: ",this._listeners.length].join(""));this._Verbose("listener isn't been found, new length"+this._listeners.length)}Start(){if(this._status<h.Initialized)throw new f(g.DATARV_ERROR_INVALID_STATUS);this._Verbose(["Start(), status:",this._status,"tag:",b._tag].join(" ")),this._status>=h.Started&&this._Verbose("Start() already, ignore"),this._ecsClient&&(this._ecsCallback=this._CreateEcsCallback(),this._ecsClient.AddListener(this._ecsCallback),this._etag=this._ecsClient.GetETag()),++b._tag,this._status=h.Started,this._Verbose(["Start() done, status: ",this._status,"tag: ",b._tag].join(""))}Stop(){if(this._status<h.Initialized)throw new f(g.DATARV_ERROR_INVALID_STATUS);this._Verbose("Stop(), status: "+this._status),this._status!=h.Initialized?(this._Reset(),this._status=h.Initialized,this._Verbose("Stop() done, status: "+this._status)):this._Verbose("Stop() already, ignore")}Flush(e){this._eventsCache.IsEmpty()||this._WorkThread(e)}SendAsync(e,t){var n;if(this._status<h.Initialized)throw new f(g.DATARV_ERROR_INVALID_STATUS);if(this._Verbose(["SendAsync(), status:",this._status,"tenantToken:",e,"count:",t.length].join(" ")),this._status<h.Started)return this._Info("SendAsync(), not started, ignore, return false"),!1;if(!e||!t)throw this._Error("SendAsync(), tenantToken or events is null or empty"),new f(g.DATARV_ERROR_INVALID_ARG);for(var i=0;i<t.length;++i)if(!t[i].Id||!b._eventTypeRegex.test(t[i].EventType)||t[i].Timestamp.Equals("0"))throw this._Error(["eventId:",t[i].Id,"eventType:",t[i].EventType,"timestamp high:",t[i].Timestamp.high,"timestamp low:",t[i].Timestamp.low].join("")),new f(g.DATARV_ERROR_INVALID_EVENT);return null===(n=this._eventsCache)||void 0===n||n.AddEvents(e,t),this._Verbose(["SendAsync(), currentTimer: ",this._timer,"eventsCacheIsEmpty",this._eventsCache.IsEmpty()].join(" ")),this._eventsCache.IsEmpty()||this._timer||this._ScheduleTimer(!1),this._Verbose("SendAsync() done"),!0}_WorkThread(e){var t;try{var n=Date.now();if(this._Verbose("_WorkThread, status: "+this._status),this._status<h.Started)return void this._Verbose("_WorkThread, status is not started, return");var i=this._eventsCache.DequeuEvents();if(null==i)return this._Verbose("_WorkThread, No events found, return"),void this._CleanTimer();var o=i.events.length,r=this._PackEvents(i.tenantToken,i.events);null===(t=this._eventsCache)||void 0===t||t.AddEvents(i.tenantToken,r.remainedEvents);var s=r.remainedEvents.length;if(null==r.buffer||0==r.buffer.length)return void(this._eventsCache.IsEmpty()?(this._Verbose("eventsCache is empty, stop schedule"),this._CleanTimer()):(this._Verbose("eventsCache is not empty, schedule for next run"),this._ScheduleTimer(!1)));if(this._testHookListeners)for(var c=0;c<this._testHookListeners.length;++c)this._testHookListeners[c](r.sendEvents);if(this._testServerResponseHook){var d=this._testServerResponseHook();return void setTimeout((()=>this._SendCallback(m,i.tenantToken,r.sendEvents,d,null)),100)}var u={type:"POST",url:this._config.collectorUrl,processData:!1,headers:{"content-type":"application/bond-compact-binary","client-id":"NO_AUTH","sdk-version":"ACT-Web-JS-"+v.w.version},complete:t=>this._SendCallback(m,i.tenantToken,r.sendEvents,t,e)};this._config.useJsonTextStream?(u.data=r.buffer,u.headers["content-type"]="application/json"):a.IsSafariOrFirefox()||"undefined"==typeof Uint8Array?(this._Verbose("Uint8Array is undefined, send with base64 encode."),u.data=l.DS.GetString(r.buffer),u.headers["content-encoding"]="base64"):(this._Verbose("Uint8Array is defined, send with binary format directly."),u.data=new Uint8Array(r.buffer)),i.tenantToken&&(u.headers["x-apikey"]=i.tenantToken);var m=b._tag;this._lastActiveTime=(new Date).getTime(),a.ajax(u),this._Verbose("_Workthread, send via jquery, tag: "+m),this._Info("Processing telemetry events took "+(Date.now()-n)+" ms for "+(o-s)+" events with total size of "+r.buffer.length+" bytes, remaining events - "+s)}catch(e){this._Error("_WorkThread, exception: "+e)}}_PackEvents(e,t){this._Verbose("_PackageEvents, total Count: "+t.length);var n,a=new i.$L,o=new i.Pm;o.Source="JS_default_source",o.DataPackageId=i.P6.GetGuid(),o.Timestamp=i.P6.GetTimeStamp();var r=t;if(t=[],r.length>200){var s=r.splice(0,200);t.push.apply(t,r),r=s}for(;o.Records=[],o.Records.push.apply(o.Records,r),a.DataPackages=[],a.DataPackages.push(o),n=this._Serialize(a),this._Verbose(["_PackageEvents, sendEvents.length:",r.length," buffer.length:",n.length," MaxPackageSize:",this._MaxPackageSizeInBytes].join("")),!(n.length<this._MaxPackageSizeInBytes);){if(1==r.length){r=[],n=null;break}var l=r.splice(0,Math.floor(r.length/2));this._Verbose("_PackageEvents, too large, package again"),t.push.apply(t,r),r=l}return this._Verbose(["_PakcageEvents done, sendEventsCount:",r.length,"buffer.length:",null==n?0:n.length,"remained events:",t.length].join("")),{buffer:n,sendEvents:r,remainedEvents:t}}_Serialize(e){if(this._config.useJsonTextStream){var t=new u;return e.Write(t),JSON.stringify(t.data)}var n=new d,i=new c.rH(n);return e.Write(i),n.GetBuffer()}_SendCallback(e,t,n,i,a){var o;if(this._Verbose(["_SendCallback","tag:",e,"current tag:",b._tag,"tenantToken:",t,"events count:",n.length,"jqXHR:",i].join("")),null==a){var r=null!=i&&i.status>=200&&i.status<300;if(this._status<h.Started||e<b._tag)this._Verbose("_SendCallback, is not started, or tag is not the same, return");else{if(!(r||i&&400==i.status))return this._Verbose("retry statusCode: "+(i?i.status:0)),null===(o=this._eventsCache)||void 0===o||o.AddEvents(t,n),void this._ScheduleTimer(!0);for(var s=0;s<this._listeners.length;++s)this._listeners[s](r?p.SENT:p.SEND_FAILED,i?i.status:0,t,n);this._eventsCache.IsEmpty()?(this._Verbose("eventsCache is empty, stop schedule"),this._CleanTimer()):(this._Verbose("eventsCache is not empty, schedule for next run"),this._ScheduleTimer(!1))}}else a(i?i.status:0,t,n)}_CleanTimer(){this._Verbose("_CleanTimer(), timer: "+this._timer),this._timer&&(clearTimeout(this._timer),this._timer=null)}_ScheduleTimer(e){if(this._Verbose("_ScheduleTimer: isRetry: "+e),this._CleanTimer(),e){this._Verbose("_ScheduleTimer, current factor: "+this._rescheduleFactor);t=Math.floor(5*this._rescheduleFactor*(1+Math.random()));this._timer=setTimeout((()=>this._WorkThread(null)),1e3*t),this._Verbose("_ScheduleTimer, next try (s): "+t),this._rescheduleFactor<<=1,this._rescheduleFactor>64&&(this._rescheduleFactor=1)}else{var t=0,n=(new Date).getTime()-this._lastActiveTime;t=n>k.TimeIntervalForNextSendInMS?0:k.TimeIntervalForNextSendInMS-n,this._timer=setTimeout((()=>this._WorkThread(null)),t),this._Verbose("_ScheduleTimer, next try: "+t),this._rescheduleFactor=1}}_Verbose(e){this._config.log&&this._config.log.Verbose("[TelemetryManagerImpl]: "+e)}_Info(e){this._config.log&&this._config.log.Info("[TelemetryManagerImpl]: "+e)}_Error(e){this._config.log&&this._config.log.Error("[TelemetryManagerImpl]: "+e)}_Reset(){this._Verbose("Reset()"),this._CleanTimer(),this._lastActiveTime=0,this._rescheduleFactor=1,this._sendingEvents=[],this._eventsCache=new _(this._config.log,this._config.eventsLimitInMem),this._ecsClient&&(this._ecsClient.RemoveListener(this._ecsCallback),this._ecsCallback=null)}_CreateEcsCallback(){return e=>{e==r.CONFIG_UPDATED&&(this._etag=this._ecsClient.GetETag())}}__AddTestHookListener(e){if(this._status<h.Initialized)throw new f(g.DATARV_ERROR_INVALID_STATUS);for(var t=0;t<this._testHookListeners.length;++t)if(this._testHookListeners[t]==e)return;this._testHookListeners.push(e)}__ClearTestHookListener(){this._testHookListeners=[]}__GetListenerArray(){return this._listeners}__GetTotalEventsCount(){return this._eventsCache.GetTotalEventsCount()}__IsScheduled(){return null!=this._timer}__ChageMaxPackageSizeInKB(e){this._MaxPackageSizeInBytes=1024*e}__SetTestServerResponseHook(e){this._testServerResponseHook=e}}b._eventTypeRegex=/^[a-zA-Z0-9]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,b._tag=0;class _{constructor(e,t){this._logger=e,this._eventsLimitInMem=t,this._events={},this._tokens=[]}AddEvents(e,t){t.length&&(t.length>this._eventsLimitInMem?this._logDroppedEvents(e,t.length):(this._events[e]||(this._events[e]=[],this._tokens.push(e)),this._events[e].push.apply(this._events[e],t)))}IsEmpty(){return 0==this._tokens.length}DequeuEvents(){if(0==this._tokens.length)return null;var e=this._tokens.shift(),t=this._events[e];return delete this._events[e],{tenantToken:e,events:t}}GetTotalEventsCount(){var e=0;for(var t in this._events)e+=this._events[t].length;return e}setEventsLimitInMem(e){this._eventsLimitInMem=e}_logDroppedEvents(e,t){if(!this._logger)return;let n=0;this._events[e]&&(n=this._events[e].length),this._logger.Verbose(`[TelemetryEventCache]: Size of dropped events: ${t},\n      events size currently in queue for tenant ${e}: ${n}`)}}},727455:(e,t,n)=>{"use strict";n.d(t,{w:()=>i});class i{static get version(){return"2.5.0"}}},549717:(e,t,n)=>{"use strict";n.d(t,{V:()=>i,N:()=>a});const i="broadcast-updated-event",a={streamUpdateHubEvent:"streamUpdate",captionsUpdate:"captionsUpdate",subscribeToStreamUpdatesHubEvent:"subscribeToStreamUpdates",notifyStreamSwitch:"notifyStreamSwitch",transcriptionStateUpdate:"transcriptionStateUpdate"}},893302:(e,t,n)=>{"use strict";var i,a;n.d(t,{mN:()=>i,GB:()=>a,yR:()=>o,oo:()=>r,Q0:()=>s,ex:()=>l,PR:()=>c,gh:()=>d,LC:()=>u,Ky:()=>m,ji:()=>p}),function(e){e.InProgress="InProgress",e.Success="Success",e.Error="Error",e.PartialSuccess="PartialSuccess"}(i||(i={})),function(e){e.StatusEntity="Microsoft.SkypeSpaces.MiddleTier.Models.StatusEntity"}(a||(a={}));const o="x-serverrequestid",r="call_blocking_list_refreshed",s=36e5,l="https://teams.microsoft.com/";var c;!function(e){e.getBlockedContacts="getBlockedContacts",e.postBlockedContacts="postBlockedContacts"}(c||(c={}));const d="api/",u=[{id:c.getBlockedContacts,path:"mt/part/msft/beta/userSettings/blocklist"},{id:c.postBlockedContacts,path:"mt/part/msft/beta/userSettings/blocklist/manage"}],m="https://teams.live.com/";var p;!function(e){e.Add="Add",e.Remove="Remove"}(p||(p={}))},477428:(e,t,n)=>{"use strict";n.d(t,{y:()=>r});var i=n(755537),a=n(682796);const o=()=>Promise.all([n.e(51963),n.e(13042)]).then(n.bind(n,526184));class r{static initialize(e,t,n,r){return this.instancePromise=(null==r?void 0:r.get(a.J.Calling).enableExternalCallMonitor)?(0,i.mT)(o,"services-io-data-call-monitor").then((i=>new i.CallMonitorService(e,n,t,r))):Promise.resolve(void 0),this.instancePromise}static getInstance(){return this.instancePromise}static dispose(){this.instancePromise=void 0}}},974280:(e,t,n)=>{"use strict";n.d(t,{w:()=>i});class i extends Error{constructor(e,t,n){super(t),this._code=e,this.message=t,this._subCode=n}get code(){return this._code}get subCode(){return this._subCode}}},108929:(e,t,n)=>{"use strict";n.d(t,{n:()=>s});var i=n(231191),a=n(324819),o=n(273350),r=n(974280);class s{constructor(e,t,n){this.host=n,this.logger=e.newLogger("CallingAppEventsService"),this.asObservable=t.createObservable(),this.deferredEventsResolution=new Map}trigger(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{externalId:n,timeStamp:i,source:s}=e.context,l=Object.assign(e,{id:(0,a.v4)()});if(this.logger.log(`[trigger] Calling app event received [id=${l.id}, externalId=${n}, timeStamp=${i}, source=${s}]`),!t)return this.logger.log(`[trigger] Timeout not provided. Resolving promise immediately [id=${l.id}, externalId=${n}, timeStamp=${i}, source=${s}, timeout=${t}]`),void this.asObservable.trigger(void 0,void 0,l);const c=(0,o.P)();let d;this.deferredEventsResolution.set(l.id,c);const u=new Promise(((e,a)=>{d=this.host.setTimeout((()=>{const e=`[trigger] Timeout waiting for event resolution signal [id=${l.id}, externalId=${n}, timeStamp=${i}, source.name=${s.name}, source.description=${s.description}]`;this.logger.error(e),a(new r.w("event-resolution-timeout",e))}),t)})),m=Promise.race([c.promise,u]);this.asObservable.trigger(void 0,void 0,l);try{yield m}finally{void 0!==d&&this.host.clearTimeout(d),this.deferredEventsResolution.delete(l.id)}}))}resolve(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{eventId:t,resolution:n}=e;this.logger.log(`[resolve] Received event resolution [eventId=${t}, resolutionType=${n.resolutionType}]`);const i=this.deferredEventsResolution.get(t);if(!i){const e=`[resolve] No deferred resolution found for event [eventId=${t}, resolutionType=${n.resolutionType}]`;throw this.logger.error(e),new r.w("event-to-resolve-not-found",e)}if("success"===n.resolutionType)return this.logger.log(`[resolve] Resolving succesful event [eventId=${t}]`),void i.resolve();if("error"===n.resolutionType){const{name:e,message:a}=n,o=`[resolve] Resolving event error from external resolution [eventId=${t}, resolution.name=${e}, resolution.message=${a}]`;return this.logger.error(o),void i.reject(new r.w("external-resolution-error",o,e))}const a=`[resolve] Invalid resolution type received. No changes on deferred promise for event [eventId=${t}]`;throw this.logger.error(a),new r.w("invalid-resolution-type",a)}))}subscribe(e){const t=this.asObservable.subscribe(((t,n)=>{n?e(n):this.logger.error("[subscribe] Received invalid args.")}));return this.trigger({event:{typeName:"calling-setup-event",result:{resultType:"calling-setup-success"}},context:{source:{name:"CallingAppEventsService.subscribe",description:"subscribe"}}}),t}unsubscribe(e){this.asObservable.unsubscribe(e)}}},607110:(e,t,n)=>{"use strict";var i,a,o,r,s,l;n.d(t,{cP:()=>i,cA:()=>a,lC:()=>o,JL:()=>r,WB:()=>s,k$:()=>l}),function(e){e[e.Show=0]="Show",e[e.Hide=1]="Hide"}(i||(i={})),function(e){e[e.Calling=0]="Calling",e[e.RigelGallery=1]="RigelGallery",e[e.RigelContent=2]="RigelContent",e[e.RigelGalleryAndContent=3]="RigelGalleryAndContent"}(a||(a={})),function(e){e.MultiWindow="MultiWindow",e.SingleWindow="SingleWindow"}(o||(o={})),function(e){e[e.Chat=0]="Chat"}(r||(r={})),function(e){e.Alert="Alert",e.CallingConfirm="CallingConfirm",e.CallingUnparkCall="CallingUnparkCall",e.Confirm="ConfirmDialog",e.MeetingJoinCrossCloud="MeeingJoinCrossCloudDialog",e.OptionsSettings="optionsSettingsDialog",e.PrejoinOverlay="PrejoinOverlay",e.UserMedia="GetUserMediaDialog"}(s||(s={})),function(e){e.OneToOne="OneToOne",e.GroupCall="GroupCall",e.Meeting="Meeting",e.Chat="Chat",e.Reply="Reply",e.ReplyToReply="ReplyToReply",e.Like="Like",e.Mention="Mention",e.Download="Download",e.AppUpdated="AppUpdated",e.NeedMoreDiskSpace="NeedMoreDiskSpace",e.TeamMembershipChange="TeamMembershipChange",e.Follow="Follow",e.OneToOnePstn="OneToOnePstn",e.Thirdparty="Thirdparty",e.MessageSendFailed="MessageSendFailed",e.CallTransferFailed="CallTransferFailed",e.ShareFromChat="ShareFromChat",e.Inferred="Inferred",e.Trending="Trending",e.MeetingWentLive="MeetingWentLive",e.PresenceStatus="PresenceStatus",e.Reaction="Reaction",e.Priority="Priority",e.TeamsTasks="TeamsTasks",e.Dlp="Dlp",e.TeamsEngagementActivity="TeamsEngagementActivity",e.MsGraph="MsGraph",e.StaffHub="StaffHub",e.CallAnsweredElsewhere="CallAnsweredElsewhere",e.CallSafeTransferRingback="CallSafeTransferRingback",e.SkypeConsumerCall="SkypeConsumerCall",e.SpamCall="SpamCall",e.Default="Default"}(l||(l={}))},694539:(e,t,n)=>{"use strict";n.d(t,{L:()=>l});var i=n(231191),a=n(682796),o=n(324819),r=n(607110);function s(e){switch(e){case 1:return r.k$.OneToOne;case 2:return r.k$.GroupCall;case 3:return r.k$.Meeting;case 4:return r.k$.Chat;case 5:return r.k$.Reply;case 6:return r.k$.ReplyToReply;case 7:return r.k$.Like;case 8:return r.k$.Mention;case 9:return r.k$.Download;case 10:return r.k$.AppUpdated;case 11:return r.k$.NeedMoreDiskSpace;case 12:return r.k$.TeamMembershipChange;case 13:return r.k$.Follow;case 14:return r.k$.OneToOnePstn;case 15:return r.k$.Thirdparty;case 16:return r.k$.MessageSendFailed;case 19:return r.k$.CallTransferFailed;case 20:return r.k$.ShareFromChat;case 21:return r.k$.Inferred;case 26:return r.k$.Trending;case 27:return r.k$.MeetingWentLive;case 28:return r.k$.PresenceStatus;case 29:return r.k$.Reaction;case 30:return r.k$.Priority;case 34:return r.k$.TeamsTasks;case 35:return r.k$.Dlp;case 36:return r.k$.TeamsEngagementActivity;case 37:return r.k$.MsGraph;case 38:return r.k$.StaffHub;case 40:return r.k$.CallAnsweredElsewhere;case 41:return r.k$.CallSafeTransferRingback;case 42:return r.k$.SkypeConsumerCall;case 43:return r.k$.SpamCall;default:return r.k$.Default}}class l{constructor(e,t,n){this.loggerFactory=e,this.coreSettings=t,this.callingAppEventsService=n,this.logger=this.loggerFactory.newLogger("CallingNotificationService"),this.logger.log("Instantiated CallingNotificationService"),this.notificationsMap=new Map,this.callToNotificationMap=new Map}createNotificationWithActions(e){const{enableCallingNotifications:t,enableOutgoingVideo:n}=this.coreSettings.get(a.J.Calling);if(!t)return this.logger.log(`[createNotificationWithActions] Feature flag enableCallingNotifications, current value: ${t}), is required for incoming call notifications is not enabled`),this.getNoopReturnValue();const i=(0,o.v4)(),l=Date.now(),c=[],d=[],u=e&&e.teamsCallId?e.teamsCallId:-1;if(e.actions)for(const t of e.actions){const e=t.actionType;if(!e||"Unknown"===e)return this.logger.error(`[createNotificationWithActions] unknown action type for action ${t}`),this.getNoopReturnValue();n||"AcceptIncomingCallWithVideo"!==e?(c.push({actionType:e,id:i,label:t.label||"",icon:this.getNotificationIcon(t)}),d.push({action:t.action,actionType:e})):this.logger.log(`[createNotificationWithActions] Feature flag enableOutgoingVideo, current value: ${n}), is not enabled video button cannot be added`)}this.notificationsMap.set(i,d);const m={typeName:"calling-content-event",action:{visibility:r.cP.Show},content:{id:i,contentType:"notification",image:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDIyLjAuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHZpZXdCb3g9IjAgMCAxOTIgMTkyIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAxOTIgMTkyOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+CjxyZWN0IHN0eWxlPSJmaWxsOiNFREVCRTk7IiB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIvPgo8cGF0aCBzdHlsZT0iZmlsbDojNjA1RTVDOyIgZD0iTTY4LjA2MjUsNTQuODg4N2MwLjU5MzMsMC41OTM4LDAuODkwNiwxLjI5NjksMC44OTA2LDIuMTA5NGMwLDAuODEzLTAuMjk3NCwxLjUxNjEtMC44OTA2LDIuMTA5NAoJYy0wLjU5MzgsMC41OTM4LTEuMjk2OSwwLjg5MDYtMi4xMDk0LDAuODkwNmgtM2MtMC44MTMsMC0xLjUxNjEsMC4yOTc0LTIuMTA5NCwwLjg5MDZjLTAuNTkzOCwwLjU5MzgtMC44OTA2LDEuMjk2OS0wLjg5MDYsMi4xMDk0Cgl2M2MwLDAuODEzLTAuMjk3NCwxLjUxNjEtMC44OTA2LDIuMTA5NGMtMC41OTM4LDAuNTkzOC0xLjI5NjksMC44OTA2LTIuMTA5NCwwLjg5MDZjLTAuODEzLDAtMS41MTYxLTAuMjk2OS0yLjEwOTQtMC44OTA2CgljLTAuNTkzOC0wLjU5MzMtMC44OTA2LTEuMjk2NC0wLjg5MDYtMi4xMDk0di0zYzAtMS42MjQ1LDAuNDA1OC0zLjEyNDUsMS4yMTg4LTQuNWMwLjgxMjUtMS4zNzUsMS45MDU4LTIuNDY4MywzLjI4MTItMy4yODEyCgljMS4zNzUtMC44MTI1LDIuODc1LTEuMjE4OCw0LjUtMS4yMTg4aDNDNjYuNzY1Niw1My45OTgsNjcuNDY4OCw1NC4yOTU0LDY4LjA2MjUsNTQuODg4N3ogTTU5LjA2MjUsNzguODg4NwoJYzAuNTkzMywwLjU5MzgsMC44OTA2LDEuMjk2OSwwLjg5MDYsMi4xMDk0djZjMCwwLjgxMy0wLjI5NzQsMS41MTYxLTAuODkwNiwyLjEwOTRjLTAuNTkzOCwwLjU5MzgtMS4yOTY5LDAuODkwNi0yLjEwOTQsMC44OTA2CgljLTAuODEzLDAtMS41MTYxLTAuMjk2OS0yLjEwOTQtMC44OTA2Yy0wLjU5MzgtMC41OTMzLTAuODkwNi0xLjI5NjQtMC44OTA2LTIuMTA5NHYtNmMwLTAuODEyNSwwLjI5NjktMS41MTU2LDAuODkwNi0yLjEwOTQKCWMwLjU5MzMtMC41OTMzLDEuMjk2NC0wLjg5MDYsMi4xMDk0LTAuODkwNkM1Ny43NjU2LDc3Ljk5OCw1OC40Njg4LDc4LjI5NTQsNTkuMDYyNSw3OC44ODg3eiBNNTkuMDYyNSwxMDIuODg4NwoJYzAuNTkzMywwLjU5MzgsMC44OTA2LDEuMjk2OSwwLjg5MDYsMi4xMDk0djZjMCwwLjgxMjUtMC4yOTc0LDEuNTE1Ni0wLjg5MDYsMi4xMDk0Yy0wLjU5MzgsMC41OTM4LTEuMjk2OSwwLjg5MDYtMi4xMDk0LDAuODkwNgoJYy0wLjgxMywwLTEuNTE2MS0wLjI5NjktMi4xMDk0LTAuODkwNmMtMC41OTM4LTAuNTkzOC0wLjg5MDYtMS4yOTY5LTAuODkwNi0yLjEwOTR2LTZjMC0wLjgxMjUsMC4yOTY5LTEuNTE1NiwwLjg5MDYtMi4xMDk0CgljMC41OTMzLTAuNTkzOCwxLjI5NjQtMC44OTA2LDIuMTA5NC0wLjg5MDZDNTcuNzY1NiwxMDEuOTk4LDU4LjQ2ODgsMTAyLjI5NDksNTkuMDYyNSwxMDIuODg4N3ogTTU5LjA2MjUsMTIzLjg4ODcKCWMwLjU5MzMsMC41OTM4LDAuODkwNiwxLjI5NjksMC44OTA2LDIuMTA5NHYzYzAsMC44MTI1LDAuMjk2OSwxLjUxNTYsMC44OTA2LDIuMTA5NGMwLjU5MzMsMC41OTM4LDEuMjk2NCwwLjg5MDYsMi4xMDk0LDAuODkwNmgzCgljMC44MTI1LDAsMS41MTU2LDAuMjk2OSwyLjEwOTQsMC44OTA2YzAuNTkzMywwLjU5MzgsMC44OTA2LDEuMjk2OSwwLjg5MDYsMi4xMDk0cy0wLjI5NzQsMS41MTU2LTAuODkwNiwyLjEwOTQKCWMtMC41OTM4LDAuNTkzOC0xLjI5NjksMC44OTA2LTIuMTA5NCwwLjg5MDZoLTNjLTEuNjI1LDAtMy4xMjUtMC40MDYyLTQuNS0xLjIxODhjLTEuMzc1NS0wLjgxMjUtMi40Njg4LTEuOTA2Mi0zLjI4MTItMy4yODEyCgljLTAuODEzLTEuMzc1LTEuMjE4OC0yLjg3NS0xLjIxODgtNC41di0zYzAtMC44MTI1LDAuMjk2OS0xLjUxNTYsMC44OTA2LTIuMTA5NGMwLjU5MzMtMC41OTM4LDEuMjk2NC0wLjg5MDYsMi4xMDk0LTAuODkwNgoJQzU3Ljc2NTYsMTIyLjk5OCw1OC40Njg4LDEyMy4yOTQ5LDU5LjA2MjUsMTIzLjg4ODd6IE04OS4wNjI1LDU0Ljg4ODdjMC41OTMzLDAuNTkzOCwwLjg5MDYsMS4yOTY5LDAuODkwNiwyLjEwOTQKCWMwLDAuODEzLTAuMjk3NCwxLjUxNjEtMC44OTA2LDIuMTA5NGMtMC41OTM4LDAuNTkzOC0xLjI5NjksMC44OTA2LTIuMTA5NCwwLjg5MDZoLTZjLTAuODEzLDAtMS41MTYxLTAuMjk2OS0yLjEwOTQtMC44OTA2CgljLTAuNTkzOC0wLjU5MzMtMC44OTA2LTEuMjk2NC0wLjg5MDYtMi4xMDk0YzAtMC44MTI1LDAuMjk2OS0xLjUxNTYsMC44OTA2LTIuMTA5NGMwLjU5MzMtMC41OTMzLDEuMjk2NC0wLjg5MDYsMi4xMDk0LTAuODkwNmg2CglDODcuNzY1Niw1My45OTgsODguNDY4OCw1NC4yOTU0LDg5LjA2MjUsNTQuODg4N3ogTTg5LjA2MjUsMTMyLjg4ODdjMC41OTMzLDAuNTkzOCwwLjg5MDYsMS4yOTY5LDAuODkwNiwyLjEwOTQKCXMtMC4yOTc0LDEuNTE1Ni0wLjg5MDYsMi4xMDk0Yy0wLjU5MzgsMC41OTM4LTEuMjk2OSwwLjg5MDYtMi4xMDk0LDAuODkwNmgtNmMtMC44MTMsMC0xLjUxNjEtMC4yOTY5LTIuMTA5NC0wLjg5MDYKCWMtMC41OTM4LTAuNTkzOC0wLjg5MDYtMS4yOTY5LTAuODkwNi0yLjEwOTRzMC4yOTY5LTEuNTE1NiwwLjg5MDYtMi4xMDk0YzAuNTkzMy0wLjU5MzgsMS4yOTY0LTAuODkwNiwyLjEwOTQtMC44OTA2aDYKCUM4Ny43NjU2LDEzMS45OTgsODguNDY4OCwxMzIuMjk0OSw4OS4wNjI1LDEzMi44ODg3eiBNMTEzLjA2MjUsNTQuODg4N2MwLjU5MzgsMC41OTM4LDAuODkwNiwxLjI5NjksMC44OTA2LDIuMTA5NAoJYzAsMC44MTMtMC4yOTY5LDEuNTE2MS0wLjg5MDYsMi4xMDk0Yy0wLjU5MzgsMC41OTM4LTEuMjk2OSwwLjg5MDYtMi4xMDk0LDAuODkwNmgtNmMtMC44MTI1LDAtMS41MTU2LTAuMjk2OS0yLjEwOTQtMC44OTA2CgljLTAuNTkzOC0wLjU5MzMtMC44OTA2LTEuMjk2NC0wLjg5MDYtMi4xMDk0YzAtMC44MTI1LDAuMjk2OS0xLjUxNTYsMC44OTA2LTIuMTA5NGMwLjU5MzgtMC41OTMzLDEuMjk2OS0wLjg5MDYsMi4xMDk0LTAuODkwNmg2CglDMTExLjc2NTYsNTMuOTk4LDExMi40Njg4LDU0LjI5NTQsMTEzLjA2MjUsNTQuODg4N3ogTTExMy4wNjI1LDEzMi44ODg3YzAuNTkzOCwwLjU5MzgsMC44OTA2LDEuMjk2OSwwLjg5MDYsMi4xMDk0CglzLTAuMjk2OSwxLjUxNTYtMC44OTA2LDIuMTA5NHMtMS4yOTY5LDAuODkwNi0yLjEwOTQsMC44OTA2aC02Yy0wLjgxMjUsMC0xLjUxNTYtMC4yOTY5LTIuMTA5NC0wLjg5MDYKCXMtMC44OTA2LTEuMjk2OS0wLjg5MDYtMi4xMDk0czAuMjk2OS0xLjUxNTYsMC44OTA2LTIuMTA5NHMxLjI5NjktMC44OTA2LDIuMTA5NC0wLjg5MDZoNgoJQzExMS43NjU2LDEzMS45OTgsMTEyLjQ2ODgsMTMyLjI5NDksMTEzLjA2MjUsMTMyLjg4ODd6IE0xMzMuNDUzMSw1NS4yMTY4YzEuMzc1LDAuODEzLDIuNDY4OCwxLjkwNjIsMy4yODEyLDMuMjgxMgoJYzAuODEyNSwxLjM3NTUsMS4yMTg4LDIuODc1NSwxLjIxODgsNC41djNjMCwwLjgxMy0wLjI5NjksMS41MTYxLTAuODkwNiwyLjEwOTRjLTAuNTkzOCwwLjU5MzgtMS4yOTY5LDAuODkwNi0yLjEwOTQsMC44OTA2CglzLTEuNTE1Ni0wLjI5NjktMi4xMDk0LTAuODkwNmMtMC41OTM4LTAuNTkzMy0wLjg5MDYtMS4yOTY0LTAuODkwNi0yLjEwOTR2LTNjMC0wLjgxMjUtMC4yOTY5LTEuNTE1Ni0wLjg5MDYtMi4xMDk0CgljLTAuNTkzOC0wLjU5MzMtMS4yOTY5LTAuODkwNi0yLjEwOTQtMC44OTA2aC0zYy0wLjgxMjUsMC0xLjUxNTYtMC4yOTY5LTIuMTA5NC0wLjg5MDZjLTAuNTkzOC0wLjU5MzMtMC44OTA2LTEuMjk2NC0wLjg5MDYtMi4xMDk0CgljMC0wLjgxMjUsMC4yOTY5LTEuNTE1NiwwLjg5MDYtMi4xMDk0YzAuNTkzOC0wLjU5MzMsMS4yOTY5LTAuODkwNiwyLjEwOTQtMC44OTA2aDMKCUMxMzAuNTc4MSw1My45OTgsMTMyLjA3ODEsNTQuNDA0MywxMzMuNDUzMSw1NS4yMTY4eiBNMTM3LjA2MjUsMTIzLjg4ODdjMC41OTM4LDAuNTkzOCwwLjg5MDYsMS4yOTY5LDAuODkwNiwyLjEwOTR2MwoJYzAsMS42MjUtMC40MDYyLDMuMTI1LTEuMjE4OCw0LjVzLTEuOTA2MiwyLjQ2ODgtMy4yODEyLDMuMjgxMnMtMi44NzUsMS4yMTg4LTQuNSwxLjIxODhoLTNjLTAuODEyNSwwLTEuNTE1Ni0wLjI5NjktMi4xMDk0LTAuODkwNgoJcy0wLjg5MDYtMS4yOTY5LTAuODkwNi0yLjEwOTRzMC4yOTY5LTEuNTE1NiwwLjg5MDYtMi4xMDk0czEuMjk2OS0wLjg5MDYsMi4xMDk0LTAuODkwNmgzYzAuODEyNSwwLDEuNTE1Ni0wLjI5NjksMi4xMDk0LTAuODkwNgoJczAuODkwNi0xLjI5NjksMC44OTA2LTIuMTA5NHYtM2MwLTAuODEyNSwwLjI5NjktMS41MTU2LDAuODkwNi0yLjEwOTRzMS4yOTY5LTAuODkwNiwyLjEwOTQtMC44OTA2CglTMTM2LjQ2ODgsMTIzLjI5NDksMTM3LjA2MjUsMTIzLjg4ODd6IE0xMzcuMDYyNSw3OC44ODg3YzAuNTkzOCwwLjU5MzgsMC44OTA2LDEuMjk2OSwwLjg5MDYsMi4xMDk0djYKCWMwLDAuODEzLTAuMjk2OSwxLjUxNjEtMC44OTA2LDIuMTA5NGMtMC41OTM4LDAuNTkzOC0xLjI5NjksMC44OTA2LTIuMTA5NCwwLjg5MDZzLTEuNTE1Ni0wLjI5NjktMi4xMDk0LTAuODkwNgoJYy0wLjU5MzgtMC41OTMzLTAuODkwNi0xLjI5NjQtMC44OTA2LTIuMTA5NHYtNmMwLTAuODEyNSwwLjI5NjktMS41MTU2LDAuODkwNi0yLjEwOTRjMC41OTM4LTAuNTkzMywxLjI5NjktMC44OTA2LDIuMTA5NC0wLjg5MDYKCVMxMzYuNDY4OCw3OC4yOTU0LDEzNy4wNjI1LDc4Ljg4ODd6IE0xMzcuMDYyNSwxMDIuODg4N2MwLjU5MzgsMC41OTM4LDAuODkwNiwxLjI5NjksMC44OTA2LDIuMTA5NHY2CgljMCwwLjgxMjUtMC4yOTY5LDEuNTE1Ni0wLjg5MDYsMi4xMDk0cy0xLjI5NjksMC44OTA2LTIuMTA5NCwwLjg5MDZzLTEuNTE1Ni0wLjI5NjktMi4xMDk0LTAuODkwNnMtMC44OTA2LTEuMjk2OS0wLjg5MDYtMi4xMDk0di02CgljMC0wLjgxMjUsMC4yOTY5LTEuNTE1NiwwLjg5MDYtMi4xMDk0czEuMjk2OS0wLjg5MDYsMi4xMDk0LTAuODkwNlMxMzYuNDY4OCwxMDIuMjk0OSwxMzcuMDYyNSwxMDIuODg4N3oiLz4KPC9zdmc+Cg==",title:e.title,subtitle:e.subtitle||"",time:l,userid:e.callerMri||"",type:s(e.type),actions:c}},p={event:m,context:{source:{name:"CreateNotificationWithActions",description:e.sourceId||"undefinedContextName"}}},g=m.content;return this.logger.log(`triggering callingAppEventsService id=${g.id}, type=${g.type}, teamsCallId=${e.teamsCallId}`),this.callingAppEventsService.trigger(p),this.callToNotificationMap.set(u,p),this.getNotificationWithActions(u)}executeCallingToastCallback(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this.canTryGetEntriesForToastId(e,t))return Promise.resolve(!1);const n=this.tryGetEntriesForToastId(e);if(!n)return Promise.resolve(!1);const i=this.tryGetEntryForActionType(n,e,t);return i?this.tryExecuteCallback(i,e):Promise.resolve(!1)}))}canNotifyForActionNotification(){return this.logger.error("[canNotifyForActionNotification] NYI"),!0}getAppUserSettings(){this.logger.error("[getAppUserSettings] NYI");return{soundsSettings:{alertSound:"All"}}}getAriaShortcutLabel(){return this.logger.error("[getAriaShortcutLabel] NYI"),""}getCallGroupMembershipSettings(){return this.logger.error("[getCallGroupMembershipSettings] NYI"),Promise.resolve({callGroupMembershipDetails:[],callGroupNotificationOverride:"Ring"})}getPanelActionScenario(){this.logger.error("[getPanelActionScenario] NYI")}isSfCNotificationEnabledDesktop(){return this.logger.error("[isSfCNotificationEnabledDesktop] NYI"),!1}isSpamNotificationEnabledDesktop(){return this.logger.error("[isSpamNotificationEnabledDesktop] NYI"),!1}shouldMuteAudio(){return this.logger.error("[shouldMuteAudio] NYI"),!1}getNotificationIcon(e){switch(e.icon){case"call-video":return"msteams-asset://accept-call-video.svg";case"call-audio":return"msteams-asset://accept-call.svg";case"call-reject":return"msteams-asset://decline-call.svg";default:return void(e.icon&&this.logger.error("[getNotificationIcon] Unknown notification action icon",e.icon))}}canTryGetEntriesForToastId(e,t){const{enableCallingNotifications:n}=this.coreSettings.get(a.J.Calling);return n?!(!e||!t)||(this.logger.error(`[canTryGetEntriesForToastId] notificationId and actionType are required to find calling notification action callback. notificationId: ${e}, actionType: ${t}.`),!1):(this.logger.log(`[canTryGetEntriesForToastId] Feature flag enableCallingNotifications, current value: ${n}), required for processing call notification activation is not enabled`),!1)}dismissNotificationFromCall(e){const t=this.callToNotificationMap.get(e);return t&&t.event&&"content"in t.event&&t.event.content&&"notification"===t.event.content.contentType?(t.event.action.visibility=r.cP.Hide,this.callingAppEventsService.trigger(t),Promise.resolve(!0)):(this.logger.error(`[dismissNotificationFromCall] Corresponding event not found. No op [teamsCallId: ${e}]`),Promise.resolve(!1))}getNotificationWithActions(e){return{update:()=>{},cancel:()=>{this.dismissNotificationFromCall(e)}}}tryGetEntriesForToastId(e){const t=this.notificationsMap.get(e);return t||this.logger.error(`[tryGetEntriesForToastId] entries for calling toast with notificationId ${e} not found in notifications map`),t}tryGetEntryForActionType(e,t,n){const i=e.find((e=>this.isMatchingAction(e,n)));if(!i){const e=this.removeFromMap(t);this.logger.error(`[tryGetEntryForActionType] no entry for actionType ${n} found for calling toast activation. ${e}`)}return i}tryExecuteCallback(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!e.action){const e=this.removeFromMap(t);return this.logger.error(`[tryExecuteCallback] no action is defined for calling toast activation with notificationId ${t}. ${e}`),Promise.resolve(!1)}try{yield e.action(),this.logger.log(`[tryExecuteCallback] callback action was executed for calling toast activation with notificationId ${t}.`)}catch(e){this.logger.error(`[tryExecuteCallback] callback action threw an exception with with error: ${e}`)}finally{this.logger.log(this.removeFromMap(t))}return Promise.resolve(!0)}))}isMatchingAction(e,t){return e.actionType===t}removeFromMap(e){return`Removed from map: ${this.notificationsMap.delete(e)}`}getNoopReturnValue(){return{update:()=>{},cancel:()=>{}}}}},324118:(e,t,n)=>{"use strict";n.d(t,{l:()=>l});var i=n(231191),a=n(324819),o=n(130132),r=n(607110),s=n(146589);class l{constructor(e,t){this.logger=e.newLogger("CallingDialogServiceAdapter"),this.callingAppEventsService=t,this.dialogCallback=new Map,this.dialogData=new Map}open(e,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){this.logger.log(`[open] Opening ${e} dialog in dialog service`);const i=(0,a.v4)(),l=(0,s.w5)(t);this.dialogCallback.set(i,l);const c=(0,s.$J)(t);this.dialogData.set(i,{dialogContent:c});const d={event:{typeName:"calling-content-event",content:{contentType:"dialog",id:i,name:e,dialogActions:l.map((e=>e.name)),dialogStrings:c},action:{visibility:r.cP.Show}},context:{source:{name:"DialogOpen",description:e}}};try{yield this.callingAppEventsService.trigger(d)}catch(e){return this.logger.error(`[open] Opening dialog error [dialogId: ${i}, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`),Promise.reject(null)}const u=(null===(n=l.find((e=>e.name===o.lR.PostClose)))||void 0===n?void 0:n.action)||(()=>{});return Promise.resolve({id:i,close:u,closePromise:Promise.resolve({id:"",value:""})})}))}getDialogData(e){if(this.logger.log(`Getting dialog data for dialog ${e}`),!this.dialogData.get(e))throw new Error(`Unable to find out dialog data with id: ${e}`);return this.dialogData.get(e)||{}}executeDialogAction(e,t){var n;this.logger.log(`Attempting to execute ${t.toString()} action for dialog ${e}`);const i=null===(n=this.dialogActions(e).find((e=>e.name===t)))||void 0===n?void 0:n.action;if(!i)throw new Error(`Action ${t.toString()} not found for dialog ${e}`);i()}dialogActions(e){var t;this.logger.log(`Getting actions for dialog ${e}`);return(null===(t=this.dialogCallback)||void 0===t?void 0:t.get(e))||[]}}},130132:(e,t,n)=>{"use strict";var i,a,o;n.d(t,{WB:()=>i,lR:()=>a,_d:()=>o,bZ:()=>r,pg:()=>s,UX:()=>l}),function(e){e.Alert="Alert",e.CallingConfirm="CallingConfirm",e.CallingUnparkCall="CallingUnparkCall",e.MeetingJoinCrossCloud="MeeingJoinCrossCloudDialog",e.OptionsSettings="optionsSettingsDialog",e.PrejoinOverlay="PrejoinOverlay",e.UserMedia="GetUserMediaDialog"}(i||(i={})),function(e){e.PostConfirm="PostConfirm",e.PreClose="PreClose",e.PostClose="PostClose",e.PreActiveElementIds="PreActiveElementIds",e.CloseByDocument="CloseByDocument"}(a||(a={})),function(e){e.DialogTitle="DialogTitle",e.DialogText="DialogText",e.PrimaryButton="PrimaryButton",e.ConfirmMessageTitle="ConfirmMessageTitle",e.ConfirmMessageHtmlBody="ConfirmMessageHtmlBody",e.OkButtonText="OkButtonText"}(o||(o={}));const r="https://go.microsoft.com/fwlink/?linkid=2085124",s=334;var l;!function(e){e[e.AdHocChannelMeetingNotSupported=0]="AdHocChannelMeetingNotSupported",e[e.AdHocPrivateMeetingNotSupported=1]="AdHocPrivateMeetingNotSupported",e[e.MeetingWithoutPstnNotSupported=2]="MeetingWithoutPstnNotSupported"}(l||(l={}))},146589:(e,t,n)=>{"use strict";n.d(t,{QC:()=>r,w5:()=>s,$J:()=>l});var i=n(892891),a=n(610997),o=n(130132);const r=(e,t)=>({hooks:{onConfirmAudioEscalationInContentOnlyMode:()=>t.open(o.WB.CallingConfirm,{dialogTitle:e.stringTranslate("calling","calling_confirm_audio_escalation_dialog_title"),dialogText:e.stringTranslate("calling","calling_confirm_audio_escalation_dialog_text"),primaryButton:{text:e.stringTranslate("calling","calling_confirm_audio_escalation_button_text"),ariaLabel:`${e.stringTranslate("calling","calling_confirm_audio_escalation_button_text")} ${e.stringTranslate("calling","calling_confirm_audio_escalation_dialog_text")}`,isFocusDefault:!0,func:i.noop,outcome:a.E8.confirmAudioEscalation,scenario:a.Lc.escalateAudio,scenarioType:a.JM.openDialog,name:a.vR.escalateAudio,type:a.iF.button,summary:"Confirm audio escalation from dialog"},dialogTelemetry:{panelType:o.pg}}).then((e=>e.closePromise)).then((e=>"Success"===e.value)),onDeepLinkError:n=>t.open(o.WB.Alert,{alertTitle:e.stringTranslate("calling","deep_link_error_dialog_title"),alertMessage:n?e.stringTranslate("calling","deep_link_error_dialog_text_call"):e.stringTranslate("calling","deep_link_error_dialog_text_meeting")}),onNdiNotSupported:()=>t.open(o.WB.Alert,{alertTitle:e.stringTranslate("calling","slash_command_enable_ndi_error_title"),alertMessage:e.stringTranslate("calling","slash_command_enable_ndi_error_description")}),onShowMeetingNotSupportedDialog:n=>{let a="",r="";switch(n){case o.UX.AdHocChannelMeetingNotSupported:a=e.stringTranslate("calling","calling_unsupported_adhoc_channel_meetings_lwj_dialog_title"),r=e.stringTranslate("calling","calling_unsupported_adhoc_channel_meetings_lwj_dialog_text",{learnMore:o.bZ});break;case o.UX.AdHocPrivateMeetingNotSupported:a=e.stringTranslate("calling","calling_unsupported_adhoc_private_meetings_lwj_dialog_title"),r=e.stringTranslate("calling","calling_unsupported_adhoc_private_meetings_lwj_dialog_text",{learnMore:o.bZ});break;case o.UX.MeetingWithoutPstnNotSupported:a=e.stringTranslate("calling","calling_unsupported_meetings_without_pstn_lwj_dialog_title"),r=e.stringTranslate("calling","calling_unsupported_meetings_without_pstn_lwj_dialog_text",{learnMore:o.bZ})}const s={okButtonText:e.stringTranslate("calling","calling_unsupported_open_text"),confirmMessageTitle:a,confirmMessageHtmlBody:r,callback:i.noop};return t.open(o.WB.CallingConfirm,s)},openAppOfflineDialog:()=>t.open(o.WB.Alert,{alertTitle:e.stringTranslate("calling","calendar_meet_now_error_title"),alertMessage:e.stringTranslate("calling","calendar_meet_now_error_message")})}}),s=e=>{if(!e)return[];const t=[];return e.postConfirmCallback&&t.push({name:o.lR.PostConfirm,action:e.postConfirmCallback}),e.preCloseCallback&&t.push({name:o.lR.PreClose,action:e.preCloseCallback}),e.postCloseCallback&&t.push({name:o.lR.PostClose,action:e.postCloseCallback}),e.preActiveElementIds&&t.push({name:o.lR.PreActiveElementIds,action:e.preActiveElementIds}),e.closeByDocument&&t.push({name:o.lR.CloseByDocument,action:e.closeByDocument}),t},l=e=>{if(!e)return[];const t=[];return e.dialogTitle&&t.push({title:o._d.DialogTitle,text:e.dialogTitle}),e.dialogText&&t.push({title:o._d.DialogText,text:e.dialogText}),e.primaryButton&&t.push({title:o._d.PrimaryButton,text:e.primaryButton.text||""}),e.confirmMessageTitle&&t.push({title:o._d.ConfirmMessageTitle,text:e.confirmMessageTitle}),e.confirmMessageHtmlBody&&t.push({title:o._d.ConfirmMessageHtmlBody,text:e.confirmMessageHtmlBody}),e.okButtonText&&t.push({title:o._d.OkButtonText,text:e.okButtonText}),t}},143028:(e,t,n)=>{"use strict";var i;n.d(t,{at:()=>i,iW:()=>a,Ii:()=>o,B3:()=>r,ep:()=>s,XM:()=>l,hV:()=>c,Yv:()=>d,eA:()=>u,g_:()=>m,Jh:()=>p,WX:()=>g,kQ:()=>h,Dr:()=>v,Mt:()=>f,IS:()=>y,M9:()=>S,iO:()=>b,Md:()=>_,YP:()=>C,BQ:()=>w,kK:()=>T,m_:()=>E,Jq:()=>I,GQ:()=>N,pW:()=>A,zt:()=>M,RS:()=>F,f0:()=>R,IK:()=>P,ZI:()=>D,qC:()=>j,DC:()=>x,uV:()=>O,rK:()=>L,dT:()=>U,q0:()=>B,Y3:()=>W,aJ:()=>H,_j:()=>$,Sj:()=>V,B_:()=>z,VJ:()=>G,$H:()=>q,Pc:()=>J,b6:()=>K,EI:()=>Q,rl:()=>Y,wS:()=>Z,wJ:()=>ee,kR:()=>te,Bb:()=>ne,rJ:()=>ie,rf:()=>ae,MW:()=>oe,dh:()=>re,Mp:()=>se,GE:()=>le,QV:()=>ce,d7:()=>de,j2:()=>ue,BB:()=>me,nP:()=>pe,fA:()=>ge,QI:()=>he,X2:()=>ve,At:()=>fe,Q5:()=>ye,yJ:()=>Se,ms:()=>ke,i1:()=>be,uI:()=>_e,Ff:()=>Ce,Th:()=>we,C8:()=>Te,e0:()=>Ee,Cs:()=>Ie,lZ:()=>Ne,BM:()=>Ae,tw:()=>Me,pj:()=>Fe,nL:()=>Pe,Cy:()=>De,UQ:()=>je,UC:()=>xe}),function(e){e.SkypeSpacesThread="19:",e.PrivateFeed="48:",e.SkypeSpacesUser="8:",e.Pstn="4:",e.BotPrefix="28:",e.TFLSmsPrefix="50:sms:"}(i||(i={}));const a=864e13,o=/^[\d]+\:/,r="unq.gbl.spaces",s="messageid=",l=`;${s}`,c=Date.UTC(2e3,0,1),d=new Date("2016-07-01").getTime(),u="4:anonymous",m="teamsvisitor:",p="clientId",g="blah/",h=";messageid=",v="dod:",f="dod-sfb:",y="@sfbonprem.unq.gbl.spaces",S="@fed.unq.gbl.spaces",k="fed:",b="gcch:",_="gcch-sfb:",C="preview-",w="tfl:preview-",T="newchat",E="nativefed:",I="orgid:",N="@sfb.unq.gbl.spaces",A="sfb:",M="sip:",F="@sfc.unq.gbl.spaces",R="orgid:",P="8:",D="28:30005246-e706-444f-ba61-8647ef09db75",j="imBack",x="custom",O="suggestion",L=i.SkypeSpacesUser+R,U=i.SkypeSpacesUser+m,B=i.SkypeSpacesUser+"guest:",W=i.SkypeSpacesUser+"spool:",H=i.SkypeSpacesUser+"acs:",$=i.SkypeSpacesUser+A,V=P+"guest:",z="50:sms:",G="50:smsunverified:",q=["live","sip_profile","myspace","c2c","sms"],J="8:tfloffnetwork:",K=`${J}email:`,Q=`${J}phone:`,Y="Message";var X;!function(e){e.PSTN="PSTN",e.Thread="thread",e.User="user",e.Bot="bot",e.Unknown="unknown"}(X||(X={}));new Map([[i.Pstn,X.PSTN],[i.SkypeSpacesThread,X.Thread],[i.PrivateFeed,X.Thread],[i.SkypeSpacesUser,X.User],[i.BotPrefix,X.Bot]]);const Z="48:calllogs",ee="48:starred",te=`${i.BotPrefix}integration:`,ne=`${i.BotPrefix}app`,ie=`${i.PrivateFeed}notifications`,ae="streamof",oe="notifications",re=(i.BotPrefix,i.SkypeSpacesUser,i.BotPrefix,`${i.SkypeSpacesThread}sfb:`),se="0;0;0",le={VoiceAppPrefix:`${i.BotPrefix}orgid:`,BotPrefixOld:i.SkypeSpacesUser+i.BotPrefix},ce=(i.SkypeSpacesThread,i.SkypeSpacesThread+"sfc:"),de=i.SkypeSpacesUser+I,ue="unknown_email_address@invalid.teams.ms",me={InterceptorBotMris:["28:22e50a9b-80cc-4eab-a092-ce64796d28d7","28:aee3af68-f70b-4f3d-a98e-28acc47ac522","28:6d2635c7-5f7b-4274-b0b5-e44d64e20dd9","28:f7206cef-8727-438b-9724-e1c508e3e54b"]},pe="application/vnd.microsoft.card.adaptive";var ge,he;!function(e){e.NORMAL="normal",e.HIGH="high",e.URGENT="urgent"}(ge||(ge={})),function(e){e[e.NoAccess=209]="NoAccess",e[e.InvalidToken=230]="InvalidToken",e[e.ThreadNotFound=732]="ThreadNotFound"}(he||(he={}));const ve=i.SkypeSpacesThread+k,fe=i.SkypeSpacesThread+E;var ye,Se;!function(e){e.ArchivalLevel="archivalLevel",e.CallableChannel="callableChannel",e.ChannelDefaultSectionId="channelDefaultNotesSectionId",e.ChannelSettings="channelSettings",e.Classification="classification",e.CreatedAt="createdat",e.CreatingFromTemplate="creatingFromTemplate",e.Creator="creator",e.DocumentLibraryId="channelDocsDocumentLibraryId",e.DynamicMembership="dynamicMembership",e.FavDefault="favDefault",e.FolderRelativeUrl="channelDocsFolderRelativeUrl",e.GapDetectionEnabled="gapDetectionEnabled",e.GroupId="groupId",e.GuestUsers="guestUsersCategory",e.DisabledReason="disabledReason",e.GuardianChatInfo="guardianChatInfo",e.HasTranscript="hasTranscript",e.MeetingObjectsConfig="meetingObjectsConfig",e.MeetingContent="meetingContent",e.ImportState="importState",e.ImmutableRoster="immutableRoster",e.Integration="integration:",e.IsDeleted="isdeleted",e.IsFederated="isFederated",e.IsStickyThread="isStickyThread",e.Cfet="cfet",e.ConsumerGroupId="consumerGroupId",e.IsTeamLocked="isTeamLocked",e.IsThreadDisabled="isDisabled",e.MeetingChatPolicy="meetingChatPolicy",e.LastJoinAt="lastjoinat",e.LastLeaveAt="lastleaveat",e.LastSyncTime="lastSyncTime",e.Meeting="meeting",e.MemberLimitExceeded="isMaxMemberLimitExceeded",e.NotebookId="notebookId",e.NotesSectionInfo="notesSectionInfo",e.ParentSpaces="parentSpaces",e.Picture="picture",e.PictureETag="pictureETag",e.RosterVersion="rosterVersion",e.SharepointRootLibrary="sharepointRootLibrary",e.SensitivityLabelDisplayName="sensitivityLabelDisplayName",e.SensitivityLabelId="sensitivityLabelId",e.SensitivityLabelName="sensitivityLabelName",e.SensitivityLabelParentDisplayName="sensitivityLabelParentDisplayName",e.SensitivityLabelParentName="sensitivityLabelParentName",e.SensitivityLabelParentTooltip="sensitivityLabelParentTooltip",e.SensitivityLabelTooltip="sensitivityLabelToolTip",e.SensitivityLabelIsCopyBlocked="sensitivityLabelIsCopyBlocked",e.ShareHistoryTime="sharehistorytime",e.SiteUrl="sharepointSiteUrl",e.SpaceId="spaceId",e.SpaceThreadTopic="spaceThreadTopic",e.SpaceThreadVersion="spaceThreadVersion",e.SpaceType="spaceType",e.SpaceType_Class="class",e.SpaceType_Edu="edu",e.SpaceType_HealthcareCareCoordination="healthcareCareCoordination",e.SpaceType_Plc="plc",e.SpaceType_Staff="staff",e.SpaceType_Standard="standard",e.SpaceTypes="spaceTypes",e.SubstrateGroupId="substrateGroupId",e.SharedInSpaces="sharedInSpaces",e.TabType="tab::",e.TeamAdminSettings="spaceAdminSettings",e.TeamSmtpAddress="teamSmtpAddress",e.TeamStatus="teamStatus",e.TemplateType="templateType",e.TemplateInformation="templateInformation",e.TenantId="tenantid",e.ThreadType="threadType",e.TopicDescription="description",e.TopicThreadTopic="topicThreadTopic",e.TopicThreadVersion="topicThreadVersion",e.Version="version",e.Visibility="visibility",e.Topics="topics",e.Liveness="awareness_conversationLiveState",e.TopicName="topic",e.GroupTemplate="groupTemplate",e.XTeamName="spaceThreadTopic",e.ExtensionDefinitionContainer="extensionDefinitionContainer",e.Hidden="hidden",e.P2PChatDefaultNotesInfo="groupDefaultNotesInfo",e.P2PChatFilesIndexId="chatFilesIndexId",e.P2PChatFilesIndexId_Value="2",e.P2PChatFixedRosters="fixedRoster",e.P2PChatUniqueRosterThread="uniquerosterthread",e.P2PMessagingDisabled="messagingdisabled"}(ye||(ye={})),function(e){e.IsNewConversation="isNewConversation"}(Se||(Se={}));const ke=[ye.IsDeleted,ye.LastJoinAt,ye.LastLeaveAt,ye.ShareHistoryTime,ye.SpaceId,ye.ThreadType,ye.Picture];var be,_e,Ce,we,Te,Ee,Ie;!function(e){e.Chat="Chat",e.Conversation="Conversation",e.Meeting="Meeting",e.OneOnOne="1on1",e.PhoneChat="PhoneChat",e.ReplyChain="ReplyChain",e.Team="Space",e.Thread="Thread",e.Topic="Topic"}(be||(be={})),function(e){e.AcceptPending="AcceptPending",e.Accepted="Accepted",e.Blocked="Blocked",e.Quarantined="Quarantined"}(_e||(_e={})),function(e){e.Alerts="alerts",e.BlockedAtTime="conversationblockedat",e.ClearHistoryTime="clearHistoryTime",e.ChatHistoryHiddenTime="historyHiddenTime",e.Collapsed="collapsed",e.ConsumptionHorizon="consumptionhorizon",e.ConsumptionHorizonBookmark="consumptionHorizonBookmark",e.Favorite="favorite",e.Followed="isfollowed",e.Hidden="hidden",e.HiddenTime="unpinnedTime",e.InteropConversationStatus="interopconversationstatus",e.isDeleted="isDeleted",e.isPinned="ispinned",e.LastImportantImTime="lastimportantimreceivedtime",e.LastUrgentImTime="lasturgentimreceivedtime",e.Loud="loud",e.Muted="muted",e.Normal="normal",e.PinnedConsumptionHorizon="consumptionHorizonForPinnedMessages",e.PinnedItems="pinnedItems",e.RetentionHorizon="retentionHorizon",e.RetentionHorizonV2="retentionHorizonV2",e.SmartReplies="quickReplyAugmentation",e.Subscription="subscription",e.SuggestedActions="augmentation",e.Version="spaceConversationVersion"}(Ce||(Ce={})),function(e){e.Chat="chat",e.Meeting="meeting",e.OneOnOne="1on1",e.PhoneChat="phonechat",e.SfbInteropChat="sfbinteropchat",e.Team="space",e.Topic="topic",e.StreamOfNotifications="streamofnotifications",e.StreamOfCalllogs="streamofcalllogs",e.StreamOfBookmarks="streamofbookmarks"}(we||(we={})),function(e){e.None="none",e.Space="space",e.Topic="topic"}(Te||(Te={})),function(e){e.ChannelOnlyMember="channelOnlyMember",e.ExpirationTime="memberExpirationTime",e.ExplicitlyAdded="explicitlyAdded",e.Following="isFollowing",e.IsFavorite="isFavorite",e.IsModerator="isModerator",e.IsPinned="isPinned",e.Reader="isReader",e.Role="role",e.RelationshipState="relationshipState"}(Ee||(Ee={})),function(e){e.AddCustomApp="ThreadActivity/AddCustomApp",e.AddMember="ThreadActivity/AddMember",e.BotMessageBack="BotMessageBack",e.Call="Event/Call",e.CallPushNotification="Signal/Flamingo",e.CallRecording="RichText/Media_CallRecording",e.CallLogRecording="RichText/Media_CallLogRecording",e.CallTranscript="RichText/Media_CallTranscript",e.CallLogTranscript="RichText/Media_CallLogTranscript",e.MeetingObjects="RichText/Media_MeetingObjects",e.ClearTyping="Control/ClearTyping",e.Collaborate="Collaborate",e.ConsumptionHorizonUpdate="ThreadActivity/MemberConsumptionHorizonUpdate",e.Contacts="RichText/Contacts",e.Custom="Custom",e.DeleteCustomApp="ThreadActivity/DeleteCustomApp",e.DeleteMember="ThreadActivity/DeleteMember",e.Files="RichText/Files",e.FlikMessage="RichText/Media_FlikMsg",e.HistoryDisclosedUpdate="ThreadActivity/HistoryDisclosedUpdate",e.HTML="RichText/Html",e.IsReaderUpdated="ThreadActivity/MemberFeatureFlagUpdate",e.JoiningEnabledUpdate="ThreadActivity/JoiningEnabledUpdate",e.LegacyMemberAdded="ThreadActivity/LegacyMemberAdded",e.LegacyMemberUpgraded="ThreadActivity/LegacyMemberUpgraded",e.Location="RichText/Location",e.MediaCard="RichText/Media_Card",e.Meeting="Meeting",e.MeetingPolicyUpdated="ThreadActivity/MeetingPolicyUpdated",e.MemberConsumptionHorizonUpdate="ThreadActivity/MemberConsumptionHorizonUpdate",e.MemberJoined="ThreadActivity/MemberJoined",e.MemberLeft="ThreadActivity/MemberLeft",e.Moji="RichText/Media_FlikMsg",e.PictureUpdate="ThreadActivity/PictureUpdate",e.RetentionDeleted="ThreadActivity/RetentionDeleted",e.RichText="RichText",e.RoleUpdate="ThreadActivity/RoleUpdate",e.ScreenShare="ScreenShare",e.Sms="RichText/Sms",e.SpaceDescriptionUpdated="ThreadActivity/SpaceDescriptionUpdated",e.SpaceThreadChannelAdded="ThreadActivity/SpaceThreadChannelAdded",e.SpaceTopicUpdated="ThreadActivity/SpaceTopicUpdated",e.TabUpdated="ThreadActivity/TabUpdated",e.Text="Text",e.ThreadActivityMessageTypePrefix="ThreadActivity/",e.ThreadArchivalUpdate="ThreadActivity/ThreadArchivalUpdate",e.TopicDeleted="ThreadActivity/TopicDeleted",e.TopicDescriptionUpdated="ThreadActivity/TopicDescriptionUpdated",e.TopicTopicUpdated="ThreadActivity/TopicTopicUpdated",e.TopicUpdated="ThreadActivity/TopicUpdate",e.ThreadShared="ThreadActivity/ThreadShared",e.Typing="Control/Typing",e.UpdateFavDefault="ThreadActivity/UpdateFavDefault",e.UpgradeCustomApp="ThreadActivity/UpgradeCustomApp",e.URIObject="RichText/UriObject",e.Video="Event/SkypeVideoMessage",e.ShowHiddenChatHistory="ThreadActivity/ShowChatHistory"}(Ie||(Ie={}));const Ne=[Ie.AddMember,Ie.DeleteMember,Ie.RoleUpdate,Ie.ThreadShared,Ie.TopicTopicUpdated,Ie.TopicUpdated,Ie.TopicDeleted,Ie.SpaceTopicUpdated,Ie.SpaceThreadChannelAdded,Ie.SpaceDescriptionUpdated,Ie.TopicDescriptionUpdated,Ie.PictureUpdate,Ie.HistoryDisclosedUpdate,Ie.JoiningEnabledUpdate,Ie.LegacyMemberAdded,Ie.LegacyMemberUpgraded,Ie.AddCustomApp,Ie.DeleteCustomApp,Ie.UpgradeCustomApp,Ie.UpdateFavDefault,Ie.MemberJoined,Ie.MemberLeft,Ie.ThreadArchivalUpdate,Ie.RetentionDeleted,Ie.TabUpdated,Ie.MeetingPolicyUpdated];var Ae,Me,Fe,Re,Pe,De,je,xe;!function(e){e.Activity="activity",e.AdminDelete="adminDelete",e.CallLog="call-log",e.Cards="cards",e.CrossPostId="crossPostId",e.DeleteTime="deletetime",e.DeliveryState="deliveryState",e.EditTime="edittime",e.EmailDetails="emaildetails",e.Emotions="emotions",e.Files="files",e.GenericStreamMetadata="genericStreamMetadata",e.Importance="importance",e.InteropType="interopType",e.IsRead="isread",e.Links="links",e.Meeting="meeting",e.MeetingScheduledInfo="scheduledmeetinginfo",e.MeetingTitle="meetingtitle",e.MeetingType="@type",e.Mentions="mentions",e.OnBehalfOf="onbehalfof",e.Pinned="pinned",e.PolicyViolation="policyViolation",e.ReplyPermissions="replyPermission",e.SkipFanoutToBots="skipfanouttobots",e.Starred="starred",e.Subject="subject",e.SystemDelete="systemdelete",e.Title="title"}(Ae||(Ae={})),function(e){e.ConversationUpdate="ConversationUpdate",e.CustomUserProperties="CustomUserProperties",e.MessageUpdate="MessageUpdate",e.NewMessage="NewMessage",e.ThreadPropertyUpdate="ThreadPropertyUpdate",e.ThreadUpdate="ThreadUpdate"}(Me||(Me={})),function(e){e.MemberConsumptionHorizonUpdate="ThreadActivity/MemberConsumptionHorizonUpdate"}(Fe||(Fe={})),function(e){e[e.None=0]="None",e[e.Network=1]="Network",e[e.Local=2]="Local"}(Re||(Re={})),function(e){e.Admin="Admin",e.User="User",e.Guest="Guest",e.None="None"}(Pe||(Pe={})),function(e){e.MeetingsUserParticipatesIn="participated",e.MeetingsUserIsInvitedTo="all",e.MeetingsManuallyUnmuted="none"}(De||(De={})),function(e){e.Unknown="0",e.Available="1",e.NotAvailable="2"}(je||(je={})),function(e){e[e.ChatWithRestrictedUserNotAllowed=40323]="ChatWithRestrictedUserNotAllowed",e[e.ChatWithLimitedUserNotAllowed=40324]="ChatWithLimitedUserNotAllowed",e[e.GroupChatNotAllowed=40325]="GroupChatNotAllowed",e[e.AddUserToChatNotAllowed=40326]="AddUserToChatNotAllowed",e[e.AddRestrictedUserInvalidOwnerNotAllowed=40327]="AddRestrictedUserInvalidOwnerNotAllowed",e[e.AddRestrictedUserNoOwnerNotAllowed=40328]="AddRestrictedUserNoOwnerNotAllowed",e[e.RemoveChatOwnerNotAllowed=40329]="RemoveChatOwnerNotAllowed",e[e.RemoveUserFromChatNotAllowed=40330]="RemoveUserFromChatNotAllowed",e[e.LeaveChatNotAllowed=40331]="LeaveChatNotAllowed",e[e.ChatWithExternalNotAllowed=40332]="ChatWithExternalNotAllowed",e[e.AddRestrictedUserExternalNotAllowed=40333]="AddRestrictedUserExternalNotAllowed",e[e.RemoveFullUserNotAllowed=40334]="RemoveFullUserNotAllowed",e[e.AddRestrictedUserFederatedChatNotAllowed=40335]="AddRestrictedUserFederatedChatNotAllowed",e[e.RemoveUserFromFederatedChatNotAllowed=40336]="RemoveUserFromFederatedChatNotAllowed"}(xe||(xe={}))},272009:(e,t,n)=>{"use strict";n.d(t,{WD:()=>y,Q5:()=>S,mh:()=>k,W7:()=>b,Nl:()=>_,lp:()=>C,y:()=>w,Q2:()=>T,EG:()=>I,$i:()=>N,xn:()=>A,_c:()=>M,o_:()=>F,P5:()=>R,vB:()=>P,tv:()=>j,uY:()=>x,iK:()=>O,PA:()=>L,Ue:()=>U,Vq:()=>B,bl:()=>W,yj:()=>H,MR:()=>$,vq:()=>V,Q:()=>z,TV:()=>G,eZ:()=>q,kz:()=>J,B4:()=>K,YQ:()=>Q,mA:()=>Y,Cq:()=>X,i4:()=>Z,y1:()=>te,pu:()=>ne,gs:()=>ie,lh:()=>ae,nQ:()=>oe,eb:()=>re,n:()=>se,gu:()=>le,j6:()=>ce});var i=n(313176),a=n(924921),o=n(892891),r=n(638307),s=n(143028),l=n(683103),c=n(517285);const d=s.at.SkypeSpacesUser+s.f0,u=s.at.SkypeSpacesUser+s.iO,m=s.at.SkypeSpacesUser+s.Md,p=s.at.SkypeSpacesUser+s.Dr,g=s.at.SkypeSpacesUser+s.Mt,h="tfl:",v=s.at.SkypeSpacesUser+h;function f(e,t){return!!e&&e.substr(0,t.length)===t}function y(e){return e>=400&&e<500}function S(e,t){return f(e,s.at.SkypeSpacesThread)||k(e,t)}function k(e,t){return f(e,s.at.PrivateFeed)||f(t,s.rf)}function b(e=""){const t=/syncState=([^&]+)/;let n;return e&&t.test(e)&&(n=e.match(t)[1]),n}function _(e){if(!e||!e.startsWith(s.IK))return!1;const t=e.split(":");return 2===t.length||3===t.length&&(n=t[1],-1!==s.$H.indexOf(n));var n}function C(e){return!!e&&(e.startsWith(d)||w(e)||e.startsWith(s.IK+s.pW)||_(e)||e.startsWith(v)||e.startsWith(u)||e.startsWith(m)||e.startsWith(p)||e.startsWith(g))}function w(e){return e.startsWith(s.dT)||e.startsWith(s.Sj)}function T(e){if((0,o.isString)(e)&&!(0,o.isEmpty)(e)){if(I(e))return E("PSTN",e,i.A4.PhoneNumber);if(_(e)||N(e))return E("SfC",e,i.A4.Identity)}return e}const E=(e,t,n)=>`${e}-${new a.F(t,n).scrub()}`;function I(e){return!!e&&0===e.indexOf(s.at.Pstn)}function N(e){return!!e&&e.startsWith(s.Pc)}function A(e){return Boolean("unknown@af4716f4-406e-409b-acc1-b8bf9efe83fa.com"===e||e===s.j2)}function M(e,t){let n=e;return t&&(n=[e,s.XM,t].join("")),n}function F(e){return X((0,r.F)(e.conversationLink)).conversationId}function R(e){if(!e||!e.conversationLink)throw TypeError("Chat-Service-Utils: Missing conversationLink");const t=X((0,o.last)(e.conversationLink.split("/"))||"");return t.isValid?t.itemId:e.id}function P(e,t){return`${e}${t?`${s.kQ}${t}`:""}`}function D(e){const t=Number(e);return!t||t<s.hV}function j(e){return e.properties&&e.properties[s.BM.EditTime]&&Number(e.properties[s.BM.EditTime])}function x(e){return e.properties&&e.properties[s.BM.DeleteTime]&&Number(e.properties[s.BM.DeleteTime])}function O(e,t,n){const i=e;if(t&&(t[s.Q5.ExtensionDefinitionContainer]||t[s.Q5.P2PChatUniqueRosterThread]&&i&&i.length>2)){const{members:t,botMembers:i}=L(e,n);return{members:t,botMembers:i}}return{members:i,botMembers:[]}}function L(e,t){if(e&&e.length>2){const n=(0,o.partition)(e,(e=>!W(e.id)||t&&t.indexOf(e.id)>-1));return{members:n[0],botMembers:n[1]}}return{members:e,botMembers:[]}}const U=e=>e.startsWith(s.eA),B=e=>e.startsWith(s.dT)||e.startsWith(s.eA)||e.startsWith(s.q0)||e.startsWith(s.Y3)||e.startsWith(s.aJ);function W(e){return!!e&&(!e.startsWith(s.GE.VoiceAppPrefix)&&(e.startsWith(s.at.BotPrefix)||e.startsWith(s.GE.BotPrefixOld)))}const H=e=>e.startsWith(s.B_),$=e=>e.startsWith(s.VJ),V=e=>e&&e.split(":")[2]||"",z=e=>_(e)?e.replace(s.at.SkypeSpacesUser,s.at.SkypeSpacesUser+h):e,G=(e,t=s.Jq)=>C(e)||W(e)||I(e)||K(e,t)||H(e)||$(e),q=e=>C(e)&&!B(e),J=e=>{const t=Number(e),n=Date.now()+30*c.Zd;return 0!==t&&!isNaN(t)&&t<n},K=(e,t)=>{const n=s.at.BotPrefix+t;return e.startsWith(n)};function Q(e){return!!W(e)&&s.BB.InterceptorBotMris.some((t=>t===e))}function Y(e){return!!e&&e.includes(s.ep)}function X(e){if(!e)return{isValid:!1,conversationId:"",itemId:""};const t=e.split(";");if(1===t.length)return{isValid:!1,conversationId:t[0],itemId:""};if(2!==t.length||0!==t[1].indexOf(s.ep)||t[1].indexOf(s.Jh)>-1)return{isValid:!1,conversationId:"",itemId:""};const n=t[1].substr(s.ep.length);return{isValid:!D(n),conversationId:t[0],itemId:n}}function Z(e){switch(e){case s.Th.Team:return s.i1.Team;case s.Th.Topic:return s.i1.Topic;case s.Th.SfbInteropChat:case s.Th.Chat:return s.i1.Chat;case s.Th.Meeting:return s.i1.Meeting;case s.Th.PhoneChat:return s.i1.PhoneChat;default:return s.i1.Thread}}function ee(e){return e.properties&&e.properties[s.BM.Importance]||s.fA.NORMAL}function te(e){return ee(e)===s.fA.HIGH}function ne(e){return ee(e)===s.fA.URGENT}function ie(e){return(0,o.includes)(s.lZ,e.messagetype)}function ae(e){switch(e){case l.UB.Admin:return s.nL.Admin;case l.UB.Guest:return s.nL.Guest;case l.UB.User:return s.nL.User;case l.UB.Undefined:default:return s.nL.None}}function oe(e){const{config:{osPlatform:t,osVersion:n,localeCode:i,clientVersion:a}}=e,o=i.split("-")[1],r=function(){const e=(new Date).getTimezoneOffset();let t=Math.floor(e/c.Xg);const n=Math.abs(e%c.Xg);e<0&&(t=n>0?-1-t:-t);const i=10;let a=t.toString(),o=n.toString();t<i&&(a=`0${t}`);n<i&&(o=`0${n}`);return e<=0?`+${a}:${o}`:`-${a}:${o}`}();let s="";const l=Intl.DateTimeFormat()&&Intl.DateTimeFormat().resolvedOptions();return s=l&&l.timeZone,`os=${t}; osVer=${n}; proc=x86; lcid=${i}; deviceType=1; country=${o}; clientName=skypeteams; clientVer=${a}; utcOffset=${r}; timezone=${s}`}const re=(e,t)=>{if(e){const n=e[s.BM.Emotions],i=n&&(0,o.find)(n,{key:"star"}),a=i&&i.users;if(a)return!!(0,o.some)(a,{mri:t})}return!1},se=({resourceType:e,resource:t})=>{switch(e){case"NewMessage":case"MessageUpdate":return t.conversationid||F(t);case"ThreadUpdate":case"ConversationUpdate":return t.id;default:return}},le=({resourceType:e,resource:t})=>{switch(e){case"NewMessage":case"MessageUpdate":return R(t);default:return}},ce=e=>e===s.Th.StreamOfNotifications},944028:(e,t,n)=>{"use strict";n.d(t,{qN:()=>i,iv:()=>a,vO:()=>r,VS:()=>c});var i,a,o,r,s,l=n(143028);!function(e){e[e.Sync=1]="Sync",e[e.LongPoll=2]="LongPoll",e[e.SfB=3]="SfB",e[e.SyncRelated=4]="SyncRelated",e[e.Local=5]="Local",e[e.CSAReplyChain=6]="CSAReplyChain",e[e.DeltaSync=7]="DeltaSync"}(i||(i={})),function(e){e[e.Sending=0]="Sending",e[e.Delivered=1]="Delivered",e[e.Received=2]="Received",e[e.Error=3]="Error",e[e.Deleted=4]="Deleted"}(a||(a={})),function(e){e[e.Muted=0]="Muted",e[e.Simple=1]="Simple",e[e.Important=2]="Important",e[e.Mentioned=3]="Mentioned"}(o||(o={})),function(e){e[e.StartupSyncClean=1]="StartupSyncClean",e[e.StartupSyncUpdate=2]="StartupSyncUpdate",e[e.ThreadDetailsSync=3]="ThreadDetailsSync",e[e.LongPoll=4]="LongPoll",e[e.ResolverPutConversation=5]="ResolverPutConversation",e[e.LocalUpdate=6]="LocalUpdate",e[e.PutConversationLie=7]="PutConversationLie",e[e.AddUsersToConversation=8]="AddUsersToConversation",e[e.ConversationFetchJob=9]="ConversationFetchJob"}(r||(r={}));class c{}c.NotificationConversationId=`${l.at.PrivateFeed}notifications`,c.StarredConversationId=`${l.at.PrivateFeed}starred`,c.CallLogConversationId=`${l.at.PrivateFeed}calllogs`,c.AnnotationsConversationId=`${l.at.PrivateFeed}annotations`,function(e){e[e.Message=0]="Message"}(s||(s={}))},409225:(e,t,n)=>{"use strict";n.d(t,{N:()=>a,H:()=>o});const i=", ",a=(e,t)=>{let n=e[0],i=1;for(;i<e.length&&!(n.length+e[i].length>18);i++)n=n.concat(`, ${e[i]}`);return{displayName:n,count:i<t?t-i+1:void 0}},o=(e,t,n)=>{const o=a(e,t);if(!o.count){const e=o.displayName.split(i);if(e.length>1){const t=new Intl.ListFormat(n).format(e);t.length<=20?o.displayName=t:(o.displayName=e.slice(0,e.length-1).join(i),o.count=2)}}return o}},683103:(e,t,n)=>{"use strict";n.d(t,{wC:()=>i,N:()=>a,x6:()=>o,F3:()=>r,aO:()=>s,Be:()=>l,$_:()=>c,ex:()=>d,Ky:()=>u,LC:()=>m,bn:()=>p,TU:()=>g,C9:()=>h,B5:()=>v,eU:()=>f,tG:()=>S,yt:()=>k,s8:()=>b,jK:()=>_,zW:()=>C,UB:()=>w,XI:()=>T,Wr:()=>E,RQ:()=>I,m1:()=>N,xu:()=>A,Vn:()=>M,wJ:()=>F,fD:()=>R,uN:()=>P,mr:()=>D,eO:()=>j,iO:()=>x,gB:()=>O,k2:()=>L,AO:()=>U,lT:()=>B,FG:()=>W});const i=1,a=200,o="/api/v1/",r="/api/v2/",s="/api/v3/",l=12e4,c=12e4,d="https://chatsvcagg.teams.microsoft.com",u="https://chatsvcagg.teams.microsoft.com",m={startupclean:"teams/users/me",startupdelta:"teams/users/me/updates",startupcleananonymous:"teams/users/anonymous",startupdeltaanonymous:"teams/users/anonymous/updates"},p=100,g=50;var h,v,f,y,S,k,b,_,C,w,T,E,I,N,A,M,F,R,P,D,j,x,O,L,U,B,W;!function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff",e[e.HealthcareCareCoordination=5]="HealthcareCareCoordination"}(h||(h={})),function(e){e.None="none",e.Owners="owners",e.Members="members",e.OwnersAndMembers="ownersAndMembers"}(v||(v={})),function(e){e[e.None=0]="None",e[e.Private=1]="Private",e[e.Secret=2]="Secret",e[e.Public=3]="Public",e[e.HiddenMembership=4]="HiddenMembership",e[e.Unknown=5]="Unknown",e[e.All=6]="All"}(f||(f={})),function(e){e[e.InProgress=0]="InProgress",e[e.Success=1]="Success",e[e.Error=2]="Error"}(y||(y={})),function(e){e[e.None=0]="None",e[e.Private=1]="Private",e[e.TenantWide=2]="TenantWide",e[e.Shared=4]="Shared"}(S||(S={})),function(e){e[e.Everyone=0]="Everyone",e[e.Moderators=1]="Moderators"}(k||(k={})),function(e){e[e.Everyone=0]="Everyone",e[e.Moderators=1]="Moderators"}(b||(b={})),function(e){e[e.NotAllowed=0]="NotAllowed",e[e.Allowed=1]="Allowed"}(_||(_={})),function(e){e[e.NotAllowed=0]="NotAllowed",e[e.Allowed=1]="Allowed"}(C||(C={})),function(e){e[e.Undefined=0]="Undefined",e[e.User=1]="User",e[e.Admin=2]="Admin",e[e.Guest=3]="Guest"}(w||(w={})),function(e){e[e.Everyone=0]="Everyone",e[e.Moderators=1]="Moderators",e[e.EveryoneButGuests=2]="EveryoneButGuests"}(T||(T={})),function(e){e[e.Unknown=-1]="Unknown",e[e.Private=1]="Private",e[e.Channel=2]="Channel"}(E||(E={})),function(e){e[e.AnyonePost=0]="AnyonePost",e[e.AnyoneWithWarning=1]="AnyoneWithWarning",e[e.OwnersPost=2]="OwnersPost"}(I||(I={})),function(e){e[e.Strict=0]="Strict",e[e.Moderate=1]="Moderate",e[e.NoRestriction=2]="NoRestriction"}(N||(N={})),function(e){e[e.Standard=0]="Standard",e[e.Private=1]="Private",e[e.Shared=4]="Shared"}(A||(A={})),function(e){e[e.Single=0]="Single",e[e.Occurrence=1]="Occurrence",e[e.Exception=2]="Exception",e[e.RecurringMaster=3]="RecurringMaster"}(M||(M={})),function(e){e[e.None=0]="None",e[e.Adhoc=1]="Adhoc",e[e.Scheduled=2]="Scheduled",e[e.Recurring=3]="Recurring",e[e.Broadcast=4]="Broadcast",e[e.MeetNow=5]="MeetNow"}(F||(F={})),function(e){e[e.None=0]="None",e[e.Daily=1]="Daily",e[e.Weekly=2]="Weekly",e[e.Monthly=3]="Monthly",e[e.RelativeMonthly=4]="RelativeMonthly",e[e.Yearly=5]="Yearly",e[e.RelativeYearly=6]="RelativeYearly"}(R||(R={})),function(e){e[e.First=0]="First",e[e.Second=1]="Second",e[e.Third=2]="Third",e[e.Fourth=3]="Fourth",e[e.Last=4]="Last"}(P||(P={})),function(e){e[e.January=1]="January",e[e.February=2]="February",e[e.March=3]="March",e[e.April=4]="April",e[e.May=5]="May",e[e.June=6]="June",e[e.July=7]="July",e[e.August=8]="August",e[e.September=9]="September",e[e.October=10]="October",e[e.November=11]="November",e[e.December=12]="December"}(D||(D={})),function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday"}(j||(j={})),function(e){e[e.First=0]="First",e[e.Second=1]="Second",e[e.Third=2]="Third",e[e.Fourth=3]="Fourth",e[e.Last=4]="Last"}(x||(x={})),function(e){e[e.None=0]="None",e[e.Sfb=1]="Sfb"}(O||(O={})),function(e){e[e.Meeting=1]="Meeting",e[e.None=0]="None",e[e.Channel=2]="Channel"}(L||(L={})),function(e){e[e.Success=0]="Success",e[e.TranslationFailed=1]="TranslationFailed",e[e.MessageNotFound=2]="MessageNotFound",e[e.VersionNotFound=3]="VersionNotFound",e[e.SkipTranslation=4]="SkipTranslation",e[e.ContentIsEmpty=5]="ContentIsEmpty",e[e.LanguageDetectionFailed=6]="LanguageDetectionFailed",e[e.UnknownError=10]="UnknownError"}(U||(U={})),function(e){e.Badges="badges",e.Chat="chat",e.ChatMessages="chatmessages",e.ChatMessage="chatmessage",e.Chats="chats",e.ChatsV2="chats_v2",e.ChatsV3="chats_v3",e.ChatsByTitle="chatsByTitle",e.ChatWithUser="chatwithuser",e.GetPost="getPost",e.GetSupportedTranslationLanguages="getSupportedTranslationLanguages",e.PostAuthors="postAuthors",e.ReplyChain="replychain",e.ReplyChains="replychains",e.ReplyChainsV2="replychains_v2",e.RepliesInChain="repliesInChain",e.StartupClean="startupclean",e.StartupDelta="startupdelta",e.ScheduleMessage="schedulemessage",e.Teams="teams",e.TranslateMessages="translatemessages",e.PinnedChannels="pinnedChannels"}(B||(B={})),function(e){e[e.Embed=4]="Embed"}(W||(W={}))},67829:(e,t,n)=>{"use strict";n.d(t,{MJ:()=>c,K6:()=>d,Du:()=>u,ut:()=>m,uY:()=>p,pl:()=>g,ky:()=>h,Fz:()=>v,zb:()=>f,s6:()=>y,rt:()=>S,xb:()=>k,eb:()=>b,HU:()=>C,Dq:()=>w,Jn:()=>E,ys:()=>I,iX:()=>N,S5:()=>A,$V:()=>M,JJ:()=>F,J6:()=>R,sL:()=>P,Cd:()=>D,x:()=>j,Fv:()=>O,hu:()=>L,dO:()=>U,BL:()=>B,jo:()=>W,nZ:()=>H,iE:()=>$,hP:()=>V,xV:()=>J,CB:()=>K,Hs:()=>Q,au:()=>Y,ZY:()=>X,T7:()=>Z,Xg:()=>ee,YP:()=>te,dG:()=>re,mO:()=>se,rP:()=>le,As:()=>ce,nL:()=>de,Bl:()=>ue,Eu:()=>me,hC:()=>pe,DZ:()=>ge,me:()=>he,BU:()=>ve,Ii:()=>fe,$c:()=>ye,tl:()=>Se,Ts:()=>ke,Il:()=>Te,Fx:()=>Ee,rf:()=>Ie,cu:()=>Ne,ln:()=>Ae});var i=n(944028),a=n(892891),o=n(682796),r=n(272009),s=n(143028),l=n(683103);var c;!function(e){e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.TWO=2]="TWO"}(c||(c={}));const d=e=>{const t=b(e);return T(e)?t:t||E(e)},u=e=>{var t;return(null===(t=e.threadProperties)||void 0===t?void 0:t[s.Q5.Creator])||null},m=e=>e.threadProperties&&e.threadProperties[s.Q5.CreatedAt]?e.threadProperties[s.Q5.CreatedAt]:null,p=e=>{if(!e)throw new Error("Invalid conversation passed to isDeleted()");if(!e.threadProperties)return!1;const t=e.threadProperties.isDeleted||e.threadProperties[s.Q5.IsDeleted];return!!t&&("boolean"==typeof t?t:"function"==typeof t.toLowerCase&&"true"===t.toLowerCase())},g=e=>{if(!e)throw new Error("Invalid conversation passed to isConversationDeleted()");if(!e.properties)return!1;const t=e.properties.isDeleted||e.properties[s.Ff.isDeleted];return!!t&&("boolean"==typeof t?t:"function"==typeof t.toLowerCase&&"true"===t.toLowerCase())},h=(e,t)=>{if(!e)throw new Error("Invalid conversation passed to shouldConversationDeletedByDeleteChat()");const n=U(e,t);return 0!==n&&(!(0,a.isNil)(e.lastMessageTimeUtc)&&n>=e.lastMessageTimeUtc)},v=e=>{var t;return!(!e.properties||!e.properties[s.Ff.Followed])&&"true"===(null===(t=e.properties[s.Ff.Followed])||void 0===t?void 0:t.toLowerCase())},f=e=>{var t;return!(!e.properties||!e.properties[s.Ff.Collapsed])&&"true"===(null===(t=e.properties[s.Ff.Collapsed])||void 0===t?void 0:t.toLowerCase())},y=e=>-1===e.detailsVersion?-1===e.threadVersion:0===e.threadVersion,S=e=>y(e)||N(e)&&!V(e);function k(e){return e.includes(s.YP)||e===s.kK}const b=e=>{var t;return(0,r.Q5)(e.id,null===(t=null==e?void 0:e.threadProperties)||void 0===t?void 0:t.threadType)&&k(e.id)},_=e=>e.threadProperties&&!!e.threadProperties[s.Q5.ParentSpaces],C=e=>e.threadProperties&&e.threadProperties[s.Q5.ThreadType]===s.Th.Team&&!_(e);const w=e=>{var t,n;if(e.properties){if(e.properties[s.Ff.Favorite])return"true"===(null===(t=e.properties[s.Ff.Favorite])||void 0===t?void 0:t.toLowerCase());if((n=e).threadProperties&&n.threadProperties[s.Q5.ThreadType]===s.Th.Team)return!0}return!1};function T(e){return((0,a.isString)(e)?e:e.id).endsWith(s.GQ)}const E=e=>T(e),I=(e,t)=>!(T(e)&&!function(e){const{msgEnableSfbCloudFromBVD:t}=e.get(o.J.Messaging),{isSfbCloud:n,isSipEnabled:i,isSfbCloudInBVD:a,isSipEnabledInBVD:r}=e.get(o.J.UserResources);return!!(t?r&&a:i&&n)}(t));const N=(e,t=!1)=>A(e.type,t),A=(e,t=!1)=>!(0,a.isNil)(e)&&(e.toLowerCase()===s.i1.Chat.toLowerCase()||e.toLowerCase()===s.i1.PhoneChat.toLowerCase()||e.toLowerCase()===s.i1.OneOnOne.toLowerCase()||!t&&x(e)),M=e=>{var t;return e.id===i.VS.NotificationConversationId||(0,r.j6)(null===(t=null==e?void 0:e.threadProperties)||void 0===t?void 0:t.threadType)},F=e=>e===i.VS.AnnotationsConversationId,R=e=>e.type===s.i1.Team||e.type===s.i1.Topic,P=e=>function(e){if(!e||!R(e))return;const t=e.threadProperties[s.Q5.SpaceTypes],n=t?parseInt(t,10):0;return e.threadProperties[s.Q5.SubstrateGroupId]?l.xu.Shared:(n&l.tG.Private)===l.tG.Private?l.xu.Private:l.xu.Standard}(e)===l.xu.Shared,D=e=>C(e)&&!!e.memberProperties&&!!e.memberProperties[s.e0.ChannelOnlyMember],j=e=>x(e.type),x=e=>!!e&&e.toLowerCase&&e.toLowerCase()===s.i1.Meeting.toLowerCase(),O=(e,t)=>e.from.substring(e.from.indexOf("/")+1)===(-1===t.indexOf(s.rK)?s.rK+t:t),L=(e,t)=>{if(!e.threadProperties)return 0;const{enableRetentionHorizonBasedPruning:n}=t.get(o.J.Sync),i=n||P(e)?e.threadProperties.retentionHorizonV2:0;return i&&isFinite(Number(i))?Number(i):0},U=(e,t)=>{if(!e.properties)return 0;if(g(e))return e.lastMessageTimeUtc?e.lastMessageTimeUtc+1:864e13;const n=!!t.get(o.J.Messaging).enableDeleteChat&&N(e)?e.properties.clearHistoryTime:0;return n&&isFinite(Number(n))?Number(n):0},B=e=>!!e.mruEvictedTime&&e.mruEvictedTime>0,W=(e,t,n)=>{const i=L(t,n);return!isNaN(Number(e))&&!isNaN(i)&&Number(e)<i},H=(e,t,n)=>{const i=U(t,n),a=Number(e);return!isNaN(a)&&!isNaN(i)&&a<i},$=(e,t,n=!1)=>{var i;if((0,r.Q5)(e.id,null===(i=null==e?void 0:e.threadProperties)||void 0===i?void 0:i.threadType)&&!y(e)){if(e.memberProperties&&n)return e.memberProperties[s.e0.ExpirationTime];if(e.members&&t){const n=(0,a.find)(e.members,(e=>e&&e.id===t));return n&&n.memberExpirationTime}return e.memberProperties&&e.memberProperties[s.e0.ExpirationTime]}},V=(e,t)=>{var n;return!(0,r.Q5)(e.id,null===(n=null==e?void 0:e.threadProperties)||void 0===n?void 0:n.threadType)||!y(e)&&!p(e)&&((0,a.isArray)(e.members)&&t?(0,a.some)(e.members,(e=>e&&e.id===t)):!(e.threadProperties&&R(e)&&!e.threadProperties[s.Q5.LastLeaveAt]&&!e.threadProperties[s.Q5.LastJoinAt])&&!(e.threadProperties&&e.threadProperties[s.Q5.LastLeaveAt]&&(!e.threadProperties[s.Q5.LastJoinAt]||e.threadProperties[s.Q5.LastJoinAt]<e.threadProperties[s.Q5.LastLeaveAt])))};function z(e){return q(e.properties&&e.properties[s.Ff.ConsumptionHorizon]||s.Mp)}function G(e){return q(e.properties&&e.properties[s.Ff.ConsumptionHorizonBookmark]||s.Mp)}function q(e){const[t,n,i]=function(e){const t=3,n=e.split(";");return n&&n.length===t&&n[0]&&!isNaN(Number(n[0]))&&n[1]&&!isNaN(Number(n[1]))&&n[2]&&!(0,a.isNil)(Number(n[2]))?n:s.Mp.split(";")}(e),o=Number(n)||0;return{originalArrivalTime:Number(t)||0,timeStamp:o,clientMessageId:i}}const J=e=>{const t=z(e),n=G(e);return!(0,a.isNil)(e.lastMessageTimeUtc)&&e.lastMessageTimeUtc<=t.originalArrivalTime&&0===n.originalArrivalTime},K=(e,t)=>{var n;if(!!e.threadProperties.isLastMessageFromMe)return!0;const i=null===(n=e.lastMessage)||void 0===n?void 0:n.from;if(!i)return!1;return t===(0,a.last)(i.split("/"))};const Q=(e,t)=>{let n="";e.lastMessage&&((0,r.gs)(e.lastMessage)?n=function(e){let t="";if((0,r.gs)(e)&&e.content){const n=e.content.match(/<initiator>(.*?)<\/initiator>/i);n&&n[1]&&(t=n[1].trim())}return t}(e.lastMessage)||"":e.lastMessage.from&&(n=(0,a.last)(e.lastMessage.from.split("/"))||""));const i=G(e);return J(e)||-1!==n.indexOf(t)&&0===i.originalArrivalTime},Y=(e,t)=>(0,a.reduce)(e.members,((e,n)=>{const i=n.id;return i&&i!==t&&e.push(i),e}),[]),X=(e,t,n)=>{let i;const o=!e.members||!!e.members&&(0,a.some)(e.members,(e=>!e));if(n&&!o){const a=Y(e,t);i=b(e)&&1===a.length?n[a[0]]:n[e.id]}return i},Z=e=>{if(!e)throw new Error("Invalid conversation passed to topicName");if(e.threadProperties){if(N(e)){let t=e.threadProperties.topic;return t&&-1!==t.indexOf(":")&&(t=void 0),t}const t=e.threadProperties.topic,n=e.threadProperties[s.Q5.TopicThreadTopic];if(t&&t.trim())return t;if(n&&n.trim())return n}return""},ee=(e,t=!1)=>N(e,!0)&&!te(e,t),te=(e,t=!1)=>{var n;const i=e.members&&e.members.length<=2;return N(e,!0)&&i&&(b(e)||oe(e)||!t&&ae(e)||ne(e))&&!(null===(n=e.members)||void 0===n?void 0:n.some((e=>(0,r.$i)(e.id))))},ne=e=>e.members&&e.members.length<=2&&ie(e)&&(e.type===s.i1.PhoneChat||e.threadProperties&&e.threadProperties[s.Q5.ThreadType]===s.Th.PhoneChat),ie=e=>(0,a.some)(e.members,(e=>!!e.id&&e.id.startsWith(s.at.Pstn))),ae=e=>N(e,!0)&&e.members&&2===e.members.length&&!(0,a.isNil)(e.threadProperties)&&parseInt(e.threadProperties[s.Q5.CreatedAt],10)<s.Yv,oe=e=>!!e.id&&e.id.indexOf(s.B3)>-1||_e(e),re=e=>e.threadProperties&&e.threadProperties[s.Q5.ThreadType]===s.Th.Topic||se(e),se=e=>e.threadProperties&&e.threadProperties[s.Q5.ThreadType]===s.Th.Team&&_(e),le=e=>(e=>E(e))(e)||(e=>ce(e))(e)||(e=>ue(e&&e.id))(e),ce=e=>{const t=(0,a.isString)(e)?e:e.id;return(0,a.endsWith)(t,s.M9)||(0,a.endsWith)(t,s.IS)||(0,a.startsWith)(t,s.X2)},de=e=>ce(e)||be(e),ue=e=>!!e&&((0,a.endsWith)(e,s.RS)||(0,a.startsWith)(e,s.QV)),me=e=>{const t=(0,a.endsWith)(e,s.M9)||(0,a.endsWith)(e,s.IS)||(0,a.startsWith)(e,s.X2),n=e.endsWith(s.GQ),i=ue(e);return t||n||i},pe=e=>{const t=$(e),n=t&&t<Date.now();return V(e)&&!n},ge=e=>{if(e.threadProperties&&e.threadProperties[s.Q5.Topics]){const t=e.threadProperties[s.Q5.Topics];return"["===t.substr(0,1)?JSON.parse(t):t.split("|").map((e=>({id:e,name:"Unknown"})))}return[]},he=e=>{if(e.threadProperties){if(e.threadProperties[s.Q5.XTeamName])return e.threadProperties[s.Q5.XTeamName];if(e.type===s.i1.Team&&e.threadProperties.topic)return e.threadProperties.topic}},ve=e=>{const t=ge(e),n=he(e);return t.map((t=>{const i={};return i[s.Q5.CreatedAt]=parseInt(t.createdat,10),i[s.Q5.Picture]=t.picture,i[s.Q5.XTeamName]=n,i.topic=t.name,i[s.Q5.LastLeaveAt]=1,i[s.Q5.ThreadType]=s.Th.Topic,i[s.Q5.SpaceId]=e.id,{threadProperties:i,id:t.id,members:[],messages:"",properties:{},version:0,type:s.i1.Topic,threadVersion:0,detailsVersion:-1,oldConsumptionHorizonKeys:[],teamId:e.id,lastMessageTimeUtc:0,isPending:void 0,memberProperties:{},mruEvictedTime:0,rosterVersion:0,rosterSummary:void 0,botMembers:[],lastSeenSkipRosterState:void 0,lastMessage:void 0,localClientId:"",isUserMember:!1,source:e.source}}))},fe=e=>{if(e.parentId)return e.parentId;if(_(e))try{const t=JSON.parse(e.threadProperties[s.Q5.ParentSpaces]),n=t.linkedSpaceInfoItems[0].spaceThreadId;if(!(0,a.isEmpty)(n))return n}catch(e){return}},ye=e=>{const t=e.threadProperties&&e.threadProperties[s.Q5.SpaceId];return(C(e)?e.id:_(e)?fe(e):t)||e.teamId},Se=e=>{var t;return!(!e.properties||!e.properties[s.Ff.Alerts])&&"true"!==(null===(t=e.properties[s.Ff.Alerts])||void 0===t?void 0:t.toLowerCase())},ke=e=>e.threadProperties&&((0,a.isBoolean)(e.threadProperties[s.Q5.GapDetectionEnabled])?e.threadProperties[s.Q5.GapDetectionEnabled]:"true"===(0,a.lowerCase)(e.threadProperties[s.Q5.GapDetectionEnabled])),be=e=>{const t=we(e);return t&&!ce(e)&&te(e)&&(0,a.some)(e.members,(e=>e.tenantId&&e.tenantId!==t))||Ce(e.id)||Ce(e.localClientId||"")},_e=e=>{var t,n;return!(0,a.isNil)(e.threadProperties)&&(e.threadProperties[s.Q5.TemplateType]===s.Q5.ImmutableRoster||"true"===(null===(n=null===(t=e.threadProperties[s.Q5.IsStickyThread])||void 0===t?void 0:t.toString())||void 0===n?void 0:n.toLowerCase()))},Ce=e=>(0,a.startsWith)(e,s.At),we=e=>e.threadProperties&&e.threadProperties[s.Q5.TenantId],Te=e=>{const t=C(e)&&e.threadProperties[s.Q5.ArchivalLevel]&&e.threadProperties[s.Q5.ArchivalLevel].toLowerCase()===s.C8.Space.toLowerCase(),n=R(e)&&e.threadProperties[s.Q5.ArchivalLevel]&&e.threadProperties[s.Q5.ArchivalLevel].toLowerCase()===s.C8.Topic.toLowerCase();return t||n},Ee=e=>function(e){if(!e.properties)return!1;return function(e){if(!e)return 0;const t=new Date(e),n=t?t.getTime():0;return isNaN(n)?0:n}(e.properties[s.Ff.LastImportantImTime])>Number(function(e){return(0,a.isEmpty)(e.properties&&e.properties[s.Ff.ConsumptionHorizonBookmark])?z(e):G(e)}(e).originalArrivalTime)}(e);const Ie=e=>{if(!e||!e.properties)return!1;const t=e.properties[s.Ff.isPinned];return!!t&&("boolean"==typeof t?t:"string"==typeof t&&"true"===t.toLowerCase())},Ne=e=>{var t;const n=null===(t=e.memberProperties)||void 0===t?void 0:t[s.e0.RelationshipState];return!!(null==n?void 0:n.inQuarantine)},Ae=e=>{var t;const n=null===(t=e.memberProperties)||void 0===t?void 0:t[s.e0.RelationshipState];return"number"==typeof(null==n?void 0:n.quarantineCounter)?null==n?void 0:n.quarantineCounter:0}},932252:(e,t,n)=>{"use strict";var i,a;n.d(t,{$:()=>i,f:()=>a}),function(e){e.Locked="Locked",e.Unlocked="Unlocked",e.Unknown="Unknown"}(i||(i={})),function(e){e.Light="Light",e.Dark="Dark",e.Contrast="Contrast",e.OSTheme="OSTheme"}(a||(a={}))},446849:(e,t,n)=>{"use strict";var i,a,o;n.d(t,{TS:()=>i,Cb:()=>a,H8:()=>o}),function(e){e.addToCall="addToCall",e.addToChat="addToChat",e.addToMeeting="addToMeeting",e.addToMeetingForSharedChannel="addToMeetingForSharedChannel",e.addToSpeedDialOrContacts="addToSpeedDialOrContacts",e.addToTeam="addToTeam",e.atMention="atMention",e.callForwardGroupSelection="callForwardGroupSelection",e.callRouting="callToRouting",e.delegationSelection="delegationSelection",e.meetingSchedule="meetingSchedule",e.newChat="newChat",e.orgChart="orgChart",e.presenceSettings="presenceSettings",e.priorityContactsSelection="priorityContactsSelection",e.searchResults="searchResults",e.searchPeopleFilter="searchPeopleFilter",e.searchSuggestions="searchSuggestions",e.shareToTeams="shareToTeams",e.taggedContactsSelection="taggedContactSelection",e.transfer="transfer",e.escalateMessage="escalateMessage",e.allFalse="allFalse",e.allTrue="allTrue",e.custom="custom"}(i||(i={})),function(e){e.AADTenant="AADTenant",e.Bot="Bot",e.CallQandAA="CallQandAA",e.DisabledUser="DisabledUser",e.DL="DL",e.Federated="Federated",e.FederatedConsumer="FederatedConsumer",e.Guest="Guest",e.ModernGroup="ModernGroup",e.PersonalContact="PersonalContact",e.Pstn="Pstn",e.Room="Room",e.UserDefinedGroup="UserDefinedGroup",e.TeamTags="TeamTags",e.PstnNonE164="PstnNonE164",e.LetterMapNumbers="LetterMapNumbers",e.GroupChats="GroupChats",e.Meetings="Meetings",e.Xtap="Xtap"}(a||(a={})),function(e){e.AAD="AAD",e.IndexedDb="IndexedDB",e.MiddleTier="MT",e.Substrate="3S",e.TopNCache="TopNCache"}(o||(o={}))},481545:(e,t,n)=>{"use strict";n.d(t,{a:()=>d,B:()=>c});var i=n(446849);const a=[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.DL,i.Cb.ModernGroup,i.Cb.PersonalContact,i.Cb.UserDefinedGroup,i.Cb.Pstn,i.Cb.CallQandAA,i.Cb.Room,i.Cb.TeamTags,i.Cb.GroupChats,i.Cb.Xtap],o=[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.DL,i.Cb.ModernGroup,i.Cb.PersonalContact,i.Cb.UserDefinedGroup,i.Cb.Pstn,i.Cb.CallQandAA,i.Cb.Room,i.Cb.TeamTags,i.Cb.GroupChats,i.Cb.Xtap,i.Cb.Meetings],r=(i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.DL,i.Cb.ModernGroup,i.Cb.PersonalContact,i.Cb.UserDefinedGroup,i.Cb.Pstn,{[i.TS.callForwardGroupSelection]:[],[i.TS.allTrue]:a,[i.TS.searchSuggestions]:o,[i.TS.addToMeetingForSharedChannel]:a,[i.TS.searchResults]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.ModernGroup,i.Cb.PersonalContact,i.Cb.UserDefinedGroup,i.Cb.Pstn,i.Cb.CallQandAA],[i.TS.addToTeam]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.Pstn],[i.TS.newChat]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.DL,i.Cb.ModernGroup,i.Cb.UserDefinedGroup,i.Cb.TeamTags,i.Cb.Room],[i.TS.transfer]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.DisabledUser,i.Cb.DL,i.Cb.ModernGroup,i.Cb.PersonalContact,i.Cb.UserDefinedGroup,i.Cb.Pstn,i.Cb.CallQandAA],[i.TS.addToCall]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.UserDefinedGroup,i.Cb.Pstn],[i.TS.addToChat]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.DisabledUser,i.Cb.TeamTags],[i.TS.searchPeopleFilter]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.Pstn,i.Cb.TeamTags,i.Cb.PersonalContact],[i.TS.callRouting]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.DL,i.Cb.PersonalContact,i.Cb.UserDefinedGroup,i.Cb.Pstn,i.Cb.CallQandAA],[i.TS.delegationSelection]:[i.Cb.AADTenant],[i.TS.presenceSettings]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.PersonalContact,i.Cb.Pstn],[i.TS.addToMeeting]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.DL,i.Cb.ModernGroup,i.Cb.PersonalContact,i.Cb.UserDefinedGroup,i.Cb.Pstn],[i.TS.meetingSchedule]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.DL,i.Cb.ModernGroup,i.Cb.PersonalContact,i.Cb.Pstn],[i.TS.addToSpeedDialOrContacts]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.PersonalContact,i.Cb.Pstn,i.Cb.CallQandAA],[i.TS.atMention]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Bot,i.Cb.Pstn],[i.TS.orgChart]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Pstn],[i.TS.priorityContactsSelection]:[i.Cb.AADTenant,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Pstn],[i.TS.taggedContactsSelection]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.DL,i.Cb.PersonalContact],[i.TS.shareToTeams]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.DisabledUser,i.Cb.PersonalContact,i.Cb.UserDefinedGroup],[i.TS.escalateMessage]:[i.Cb.AADTenant],[i.TS.allFalse]:[],[i.TS.custom]:[]});var s=n(892891);const l=(e,t)=>(0,s.flatten)(e.filter((([e,n])=>e===t)).map((([e,t])=>t))),c={[i.H8.Substrate]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.GroupChats,i.Cb.DL,i.Cb.ModernGroup],[i.H8.AAD]:[i.Cb.Guest],[i.H8.IndexedDb]:[i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.Pstn],[i.H8.MiddleTier]:[],[i.H8.TopNCache]:[]};class d{constructor(e,t){this.includeFeatures=e,this.name=t,this.includeAADTenant=!1,this.includeGuest=!1,this.includeFederated=!1,this.includeFederatedConsumer=!1,this.includeBot=!1,this.includeDisabledUser=!1,this.includeDL=!1,this.includeModernGroup=!1,this.includePersonalContact=!1,this.includeUserDefinedGroup=!1,this.includePstn=!1,this.includeCallQandAA=!1,this.includeRoom=!1,this.includeTeamTags=!1,this.includeGroupChats=!1,this.includeMeetingChats=!1,this.includeXtap=!1,this.includeAADTenant=(0,s.includes)(e,i.Cb.AADTenant),this.includeGuest=(0,s.includes)(e,i.Cb.Guest),this.includeFederated=(0,s.includes)(e,i.Cb.Federated),this.includeFederatedConsumer=(0,s.includes)(e,i.Cb.FederatedConsumer),this.includeBot=(0,s.includes)(e,i.Cb.Bot),this.includeDisabledUser=(0,s.includes)(e,i.Cb.DisabledUser),this.includeDL=(0,s.includes)(e,i.Cb.DL),this.includeModernGroup=(0,s.includes)(e,i.Cb.ModernGroup),this.includePersonalContact=(0,s.includes)(e,i.Cb.PersonalContact),this.includeUserDefinedGroup=(0,s.includes)(e,i.Cb.UserDefinedGroup),this.includePstn=(0,s.includes)(e,i.Cb.Pstn),this.includeCallQandAA=(0,s.includes)(e,i.Cb.CallQandAA),this.includeRoom=(0,s.includes)(e,i.Cb.Room),this.includeTeamTags=(0,s.includes)(e,i.Cb.TeamTags),this.includeGroupChats=(0,s.includes)(e,i.Cb.GroupChats),this.includeMeetingChats=(0,s.includes)(e,i.Cb.Meetings),this.includeXtap=(0,s.includes)(e,i.Cb.Xtap)}}d.fromName=(e,t=[])=>{if(!(e in r))throw new TypeError("Invalid `name` attribute passed. Please make sure it exists in PEOPLE_FILTER_NAME_CONFIG.");const n=l(t,!0),i=l(t,!1),a=s.without.apply(null,[(0,s.concat)(r[e],n),...i]);return new d(a,e)},d.createFrom=(e,t,n)=>new d(t||e.includeFeatures,n||e.name),d.includesAll=(e,t)=>(0,s.every)(t,(t=>(0,s.includes)(e.includeFeatures,t))),d.includesAny=(e,t)=>(0,s.some)(t,(t=>(0,s.includes)(e.includeFeatures,t)))},189901:(e,t,n)=>{"use strict";n.d(t,{MD:()=>i,t:()=>a,vf:()=>o,cT:()=>r});const i={saveUnknownUser:"unknown_user_profile_generated",unknownUserFromDB:"unknown_user_from_index_db"},a={botType:"BOT"},o={member:"Member",guest:"Guest",voiceApp:"ADVoiceApp",DistributionList:"Group",Bot:"Bot",person:"Person",federated:"Federated",skypeConsumer:"SkypeConsumer",tflUser:"TFLUser",tflOffNetwork:"TFLOffNetwork",tflConsumer:"TflConsumer"},r={showWarningBannerMinimumThreshold:20,type:{team:"team",channel:"channel",person:"person",webhook:"webhook",bot:"BOT",addABot:"addABot",app:"app"},hintElement:"ts-hint"}},338870:(e,t,n)=>{"use strict";n.d(t,{$:()=>v,e:()=>f});var i=n(231191),a=n(446849),o=n(682796),r=n(189901),s=n(517285),l=n(892891),c=n(481545);const d="unknown_email_address@invalid.teams.ms",u=s.Xg*s.A_*16,m=2*s.Yx*s.Ix*s.Xg*s.A_,p="8:tfloffnetwork:",g="50:sms:",h="50:smsunverified:",v="TflContacts";class f{static isUnknownUser(e){return e.email===d||"unknown@af4716f4-406e-409b-acc1-b8bf9efe83fa.com"===e.email}static getUnknownUserEmail(){return d}static getRequestCount(e){return e&&e.requestCount||e.$$requestCount||0}static sanitizeUserProfileObject(e){if(!e)throw new Error("Invalid user profile object passed");const t=Object.assign({isSelf:void 0,managerLevel:void 0},e),{isSelf:n,managerLevel:a,userClassification:o}=t;return(0,i.__rest)(t,["isSelf","managerLevel","userClassification"])}static getCacheExpiryCallbackForUser(e,t=null){return function(n){if(n.isAnonymousUser)return 0;const i=n.skypeTeamsInfo&&n.skypeTeamsInfo.isSkypeTeamsUser,{enableNonTeamsUserShortCacheExpiry:a}=e.get(o.J.People);return a&&!i?u:t||m}}static isEnoughProfileInfoInCache(e,t){return e&&!f.isUnknownUser(e)&&(!t||t&&!(0,l.isUndefined)(e.isShortProfile)&&!e.isShortProfile)}static addDescription(e,t=!1,n=!1){if(e.description||this.isBot(e))return;if(n&&e.type===r.vf.federated)return void(e.description=e.tenantName||"");const i=e.userPrincipalName.substr(0,e.userPrincipalName.indexOf("@")).toUpperCase();e.description=e.jobTitle?`(${i}) ${e.jobTitle}`:e.userType===r.vf.guest||t?e.email||e.userPrincipalName:i}static addUserDisplaynamePostFix(e,t,n){const{enableTaglessNameForAnonConsumerUser:i}=t.get(o.J.People),a=i&&e.isAnonymousUser;return e.displayName=f.removeMismatchedPostFix(i,e.displayName,n),a?this.addExternalIndicator(e,n):this.addGuestIndicator(e,n)}static addExternalIndicator(e,t){const n=t.stringTranslate("peoplePicker","external_user_postfix"),i=e.guestlessDisplayName&&e.guestlessDisplayName.indexOf(n);if(i&&i>=0)return void(e.guestlessDisplayName=e.guestlessDisplayName.substring(0,i-1));!e.displayName.includes(n)&&e.displayName!==t.stringTranslate("peoplePicker","default_external_displayname")&&(e.displayName=`${e.displayName} ${n}`),e.givenName&&(e.guestGivenName=`${e.givenName} ${n}`),e.surname&&(e.guestSurname=`${e.surname} ${n}`)}static addGuestIndicator(e,t){const n=t.stringTranslate("peoplePicker","guest_user_postfix"),i=e.guestlessDisplayName.indexOf(n);i>-1?e.guestlessDisplayName=e.guestlessDisplayName.substring(0,i).trimRight():(e.displayName=`${e.displayName} ${n}`,e.givenName&&(e.guestGivenName=`${e.givenName} ${n}`),e.surname&&(e.guestSurname=`${e.surname} ${n}`))}static getUserDisplaynamePostFix(e,t,n,i,a,r){var s;if(!t)return null;const{enableTaglessNameForAnonConsumerUser:l}=i.get(o.J.People),{isConsumerWindow:c}=i.get(o.J.Calendar),d=e.startsWith("8:teamsvisitor:"),u=e.startsWith("8:guest:");if(c&&u)t=l?f.removeMismatchedPostFix(l,t,a):f.checkAndAddGuestTag(t,a);else if(!c&&d)t=f.removeMismatchedPostFix(l,t,a),t=l?f.checkAndAddExternalTag(t,a):f.checkAndAddGuestTag(t,a);else if(n||r){let e=!1;n&&(e=Boolean(null===(s=null==i?void 0:i.get(o.J.Messaging))||void 0===s?void 0:s.enableConsumerConversations)),e||(t=f.checkAndAddExternalTag(t,a))}return t}static checkAndAddGuestTag(e,t){const n=this.getDefaultGuestDisplayName(t),i=this.getGuestUserTag(t);let a=e;return e.includes(i)||e===n||(a+=` ${i}`),a}static checkAndAddExternalTag(e,t){const n=this.getDefaultExternalDisplayname(t),i=this.getExternalTag(t);let a=e;return e.includes(i)||e===n||(a+=` ${i}`),a}static getDefaultGuestDisplayName(e){return e.stringTranslate("peoplePicker","default_guest_displayname")}static getGuestUserTag(e){return e.stringTranslate("peoplePicker","guest_user_postfix")}static getDefaultExternalDisplayname(e){return e.stringTranslate("peoplePicker","default_external_displayname")}static getExternalTag(e){return e.stringTranslate("peoplePicker","external_user_postfix")}static removeMismatchedPostFix(e,t,n){const i=e?"guest_user_postfix":"external_user_postfix",a=n.stringTranslate("peoplePicker",i),o=t.indexOf(a);return o>-1?t.substring(0,o).trimRight():t}static addUserTypeInfo(e){e.type&&"ADUser"===e.type||"User"===e.objectType?(e.type=r.cT.type.person,e.$$subType="ADUser"):e.type&&(e.$$subType=e.type)}static applyFeatureFlagSettings(e,t){let n=e.includeFeatures;switch(e.name){case a.TS.addToMeeting:case a.TS.meetingSchedule:const{enableBotsInScheduledMeetings:e,enableFederatedUsersInMeetings:i}=t.get(o.J.Federated);i||(n=(0,l.difference)(n,[a.Cb.Federated])),e&&(n=(0,l.difference)(n,[a.Cb.Bot]));break;case a.TS.addToChat:const{enableFederatedUsersInAddToChat:r}=t.get(o.J.Federated);if(Boolean(t.get(o.J.Messaging).enableConsumerConversations)){const{enableTfwFederationOnTfl:e}=t.get(o.J.Messaging);e||(n=(0,l.difference)(n,[a.Cb.Federated]))}else r||(n=(0,l.difference)(n,[a.Cb.Federated]));const{enableDLsInAddToChat:s}=t.get(o.J.DistributionLists);s||(n=(0,l.difference)(n,[a.Cb.DL]));break;case a.TS.addToTeam:const{enableFederatedUsersInAddToTeam:c}=t.get(o.J.Federated);c||(n=(0,l.difference)(n,[a.Cb.Federated]));break;case a.TS.addToSpeedDialOrContacts:const{enableFederatedUsersInAddToSpeedDialOrContacts:d}=t.get(o.J.Federated);d||(n=(0,l.difference)(n,[a.Cb.Federated]))}return c.a.createFrom(e,n)}static filterSearchResults(e,t,n){let i=t;return(e=f.applyFeatureFlagSettings(e,n)).includeFederated||(i=i.filter((e=>!f.isFederatedUser(e)))),e.includeGuest||(i=i.filter((e=>!f.isGuestUser(e)))),e.includeBot||(i=i.filter((e=>!f.isBot(e)))),e.includeDL||(i=i.filter((e=>!f.isDistributionList(e)))),e.includePstn||(i=i.filter((e=>!f.isPSTNUser(e)))),e.includeAADTenant||(i=i.filter((e=>!f.isInTenantUser(e)))),e.includeCallQandAA||(i=i.filter((e=>!f.isCallQorAAUser(e)))),i}static getTflOffNetworkUserDefaultDisplayName(e){return e&&e.substring(e.lastIndexOf(":")+1)}static matchEmailAliasInMeProfile(e,t){return!(0,l.isEmpty)(t)&&(0,l.some)(t,(t=>{var n;return e.toLowerCase()===(null===(n=t.address)||void 0===n?void 0:n.toLowerCase())}))}static matchPhoneAliasInMeProfile(e,t){return!(0,l.isEmpty)(t)&&(0,l.some)(t,(t=>e===t.number))}static generatePstnProfile(e,t){return{mri:e,displayName:t,givenName:t,surname:"",userPrincipalName:e,accountEnabled:!1}}static convertStringToBlobFile(e){const t=e.split(",")[1];if((0,l.isEmpty)(t))return;const n=atob(t),i=e.split(",")[0].split(":")[1].split(";")[0],a=new ArrayBuffer(n.length),o=new Uint8Array(a);for(let e=0;e<n.length;e++)o[e]=n.charCodeAt(e);return new Blob([o],{type:i})}}f.isFederatedUser=e=>!!e.isFederated||e.type===r.vf.federated,f.isGuestUser=e=>e.type===r.vf.guest||e.userType===r.vf.guest,f.isTFLUser=e=>e.type===r.vf.tflUser,f.isTFLConsumerUser=e=>e.type===r.vf.tflConsumer,f.isInTenantUser=e=>!(e.type!==r.cT.type.person&&"ADUser"!==e.type||f.isGuestUser(e)||e.isFederated),f.isBot=e=>{var t;return(null===(t=e.type)||void 0===t?void 0:t.toUpperCase())===r.t.botType},f.isDistributionList=e=>e.type===r.vf.DistributionList&&(!e.objectType||e.objectType===r.vf.DistributionList),f.isPSTNUser=e=>e.mri&&0===e.mri.indexOf("4:"),f.isSfcUser=e=>e.type===r.vf.skypeConsumer,f.isCallQorAAUser=e=>e.type===r.vf.voiceApp,f.isTFLOffNetworkUser=e=>0===(null==e?void 0:e.indexOf(p)),f.isTFLOffNetworkPhoneUser=e=>0===(null==e?void 0:e.indexOf("8:tfloffnetwork:phone:")),f.isTFLOffNetworkEmailUser=e=>0===(null==e?void 0:e.indexOf("8:tfloffnetwork:email:")),f.isTFLSmsUnVerifiedMri=e=>0===(null==e?void 0:e.indexOf(h)),f.isTFLSmsVerifiedMri=e=>0===(null==e?void 0:e.indexOf(g)),f.isTFLSmsMri=e=>0===(null==e?void 0:e.indexOf(g))||0===(null==e?void 0:e.indexOf(h)),f.isEnterpriseUserMri=e=>0===(null==e?void 0:e.indexOf("8:orgid:")),f.isDisplayNameUnknownUser=e=>e&&"Unknown User"===e,f.isConversationItem=e=>{var t;return 0===(null===(t=e.id)||void 0===t?void 0:t.indexOf("19:"))},f.isTag=e=>"Tag"===e.type},425403:(e,t,n)=>{"use strict";n.d(t,{h:()=>i});class i{constructor(){}static getInstance(){return this.platformAppConversationService||(this.platformAppConversationService=new i),this.platformAppConversationService}setSubEntityDeepLinkInfo(e){this.deepLink=e}getSubEntityDeepLinkInfo(){return this.deepLink}setClientMessageId(e){this.clientMessageId=e}getClientMessageId(){return this.clientMessageId}}},986659:(e,t,n)=>{"use strict";n.d(t,{vc:()=>i,Bd:()=>a,d5:()=>o});const i={EmptyEvent:"EmptyEvent",NotEnabled:"NotEnabled",RequiredFieldMissing:"RequiredFieldMissing",SubscriptionFailed:"SubscriptionFailed",MethodNotAvailable:"showBadge not available on taskbar module.",ModuleUnableToLoad:"HostComms is unable to load taskbar module. We are running on Web or Teams 1.0. Bailing out."},a={ModuleLoaded:"HostComms has loaded taskbar module. Setting badge.",UpdatedEvent:"Updated Taskbar Badge Count:"},o="TaskbarService"},305653:(e,t,n)=>{"use strict";n.d(t,{a:()=>r});var i=n(231191),a=n(682796),o=n(986659);class r{constructor(e,t,n){this.coreSettings=t,this.hostCommunicationService=n,this.getBadge=e=>({icon:{countBadge:{value:e}}}),this.logger=e.newLogger(o.d5)}showBadge(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this.enableTaskbarBadgeMaglev)return void this.logger.log(o.vc.NotEnabled);const t=yield this.hostCommunicationService.loadModule("taskbar");if(t){if(t.showBadge)return this.logger.log(o.Bd.ModuleLoaded),t.showBadge(e);this.logger.log(o.vc.MethodNotAvailable)}else this.logger.error(o.vc.ModuleUnableToLoad)}))}showBadgeCount(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return this.showBadge(this.getBadge(e))}))}resetBadge(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return this.showBadgeCount(0)}))}get enableTaskbarBadgeMaglev(){return!!this.coreSettings.get(a.J.Core).enableTaskbarBadgeMaglev}}},388451:(e,t,n)=>{"use strict";n.d(t,{K:()=>b});var i=n(635649),a=n(946101),o=n(459012),r=n(356452),s=n(415e3),l=n(972193);const c=()=>({apiName:"canCreateTWT",url:"beta/teams/canCreateTWT",method:"GET"}),d=e=>({apiName:"createTeam",url:"beta/teams/create",method:"POST",body:JSON.stringify(e),headers:{"content-type":"application/json"}}),u=(e,t)=>({apiName:"editTeam",url:`beta/teams/${e}`,method:"PATCH",body:JSON.stringify(t),headers:{"content-type":"application/json"}}),m=e=>({apiName:"userGroupSettings",url:"beta/users/groupsSettings",method:"POST",body:JSON.stringify(e),headers:{"content-type":"application/json"}}),p=(e,t,n)=>({apiName:"leaveChannel",url:`beta/teams/${e}/channels/${t}/members/${n}`,method:"DELETE",headers:{"content-type":"application/json"}}),g=()=>({apiName:"getSensitivityLabels",url:"beta/users/sensitivityLabels",method:"GET"}),h=()=>({apiName:"getSensitivityPolicySettings",url:"beta/users/sensitivityPolicySettings",method:"GET"}),v=e=>e.body.json().then((e=>e&&e.value)).catch((()=>{throw(0,s.T)(l.A.TransformFailed,e)})),f=e=>({apiName:"validateTeamName",url:"beta/teams/validateNaming",method:"POST",body:JSON.stringify(e),headers:{"content-type":"application/json"}}),y=e=>{const{gtmRegistry:t,discover:n}=e,i=n.regionGtm(a.Pn.middleTier),r=S(i);return{serviceName:o.EJ.MiddleTier,authResource:t.mtAuthWithSkypeXTokenResource,models:{canCreateTWT:r(c),createTeam:r(d).withTransform(v),editTeam:r(u),leaveChannel:r(p),myGroupSettings:r(m),sensitivityLabels:r(g),sensitivityPolicySettings:r(h),validateTeamName:r(f)}}},S=e=>t=>{const n=e.then((e=>function(e,t){return{baseUrl:e,constructRequest:t,allowedResponses:[r.qj.HTTP_2XX]}}(e,t))),i=Object.assign(n,{withTransform:e=>(n.then((t=>t.transformResponse=e)),i)});return i};var k=n(683103);class b{constructor(e){this._transport=e.createApi(y)}canCreateTWT(){return this._transport.canCreateTWT()}createTeam(e){const t=Object.assign(Object.assign({},e),{accessType:this.convertTeamAccessType(e.accessType)});return this._transport.createTeam(t)}editTeam(e,t){return this._transport.editTeam(e,t)}leaveChannel(e,t,n){return this._transport.leaveChannel(e,t,n)}myGroupSettings(e){return this._transport.myGroupSettings(e)}sensitivityLabels(){return this._transport.sensitivityLabels()}sensitivityPolicySettings(){return this._transport.sensitivityPolicySettings()}validateTeamName(e){return this._transport.validateTeamName(e)}convertTeamAccessType(e){switch(e){case i.TeamAccessType.Public:return k.eU.Public;default:return k.eU.Private}}}},369183:(e,t,n)=>{"use strict";n.d(t,{Em:()=>i,kz:()=>o,vi:()=>r,yw:()=>s,eI:()=>l,j7:()=>c,me:()=>d,vH:()=>u,Ju:()=>m,yR:()=>p,VD:()=>g,GF:()=>h,IC:()=>v,ex:()=>f,gh:()=>y,MX:()=>S,Q0:()=>k,Gq:()=>b,Sq:()=>_,LC:()=>C,CQ:()=>w});var i,a=n(498765);!function(e){e.getVoicemails="getVoicemails",e.getAttachments="getAttachments",e.markReadUnread="markReadUnread",e.deleteVoicemail="deleteVoicemail"}(i||(i={}));const o="voicemail-service",r="application/json",s="odata.metadata=none",l="odata.streaming=true",c="odata.metadata=minimal",d="IEEE754Compatible=false",u="charset=utf-8",m=(0,a.LQ)(`${r};${c};${l};${d};${u}`),p="x-serverrequestid",g="<MESSAGE_ID>",h="<GROUP_ID>",v="DeletedItems",f="https://outlook.office.com/",y="api/v2.0/",S="api/beta/",k=9e5,b="voicemails_refreshed",_=(0,a.LQ)("?$expand=SingleValueExtendedProperties($filter=PropertyId eq 'Integer {00020328-0000-0000-C000-000000000046} Id 0x6801' or PropertyId eq 'String {00020386-0000-0000-C000-000000000046} Name X-VoiceMessageConfidenceLevel' or PropertyId eq 'String {00020386-0000-0000-C000-000000000046} Name X-VoiceMessageTranscription')&$filter=SingleValueExtendedProperties/Any(ep: ep/PropertyId eq 'String 0x1a' and ep/Value eq 'IPM.Note.Microsoft.Voicemail.UM.CA')&$top=30&$select=From,Body,IsRead,Id,ReceivedDateTime,InternetMessageHeaders"),C=[{id:i.getVoicemails,path:"me/mailfolders/voicemail/messages"},{id:i.getAttachments,path:"me/messages/<MESSAGE_ID>/attachments"},{id:i.markReadUnread,path:"me/messages/<MESSAGE_ID>"},{id:i.deleteVoicemail,path:"me/messages/<MESSAGE_ID>/move"}],w=[{id:i.getVoicemails,path:"groups/<GROUP_ID>/messages"},{id:i.getAttachments,path:"groups/<GROUP_ID>/messages/<MESSAGE_ID>/attachments"},{id:i.markReadUnread,path:"groups/<GROUP_ID>/messages/<MESSAGE_ID>"},{id:i.deleteVoicemail,path:"groups/<GROUP_ID>/messages/<MESSAGE_ID>/move"}]},940822:(e,t,n)=>{"use strict";n.d(t,{Q:()=>i});class i{constructor(){this.outstandingRequests=void 0,this.mostRecentRequest=void 0,this.requestsMapping=void 0,this.decimalPlaces=void 0,this.subscriber=void 0,this.decimalPlaces=3}static get Instance(){return i._instance||(i._instance=new i),i._instance}processRequest(e,t,n){if(!this.subscriber)return;const{requests:i}=this.outstandingRequests;i.has(e)||i.set(e,{requestsByName:new Map});const{requestsByName:a}=i.get(e),o=a.get(t)||0;a.set(t,o+1),this.requestsMapping.set(n,{operationName:t,operationType:e}),this.notify()}processResponse(e,t){if(!this.subscriber||!this.requestsMapping.has(e))return;const{operationName:n,operationType:i}=this.requestsMapping.get(e);if("subscription"===i)return;this.requestsMapping.delete(e);const a=this.outstandingRequests&&this.outstandingRequests.requests;if(a.has(i)){const{requestsByName:e}=a.get(i);let t=e.get(n);1===t?e.delete(n):t>0&&e.set(n,--t)}const o={requestInfo:{operationName:n,operationType:i},responseTime:t&&parseFloat(t.toFixed(this.decimalPlaces))};this.mostRecentRequest=o,this.notify()}subscribe(e){this.subscriber=e,this.outstandingRequests={requests:new Map},this.requestsMapping=new Map}unsubscribe(){this.subscriber=void 0,this.outstandingRequests=void 0,this.requestsMapping=void 0}notify(){this.subscriber.processUpdate(this.outstandingRequests,this.mostRecentRequest)}}i._instance=void 0},972193:(e,t,n)=>{"use strict";var i;n.d(t,{A:()=>i}),function(e){e.AuthFailed="AuthFailed",e.AuthResolveFailed="AuthResolveFailed",e.FailedToFetch="FailedToFetch",e.InvalidUrl="InvalidUrl",e.InvalidParameters="Invalid pararameters",e.NotImplemented="NotImplemented",e.RejectHttpError="RejectHttpError",e.RequireStatusFailed="RequireStatusFailed",e.RequestCancelled="RequestCancelled",e.TimedOut="TimedOut",e.TransformFailed="TransformFailed"}(i||(i={}))},356452:(e,t,n)=>{"use strict";var i,a,o;n.d(t,{qb:()=>i,qj:()=>a,nz:()=>o}),function(e){e[e.OK=200]="OK",e[e.CREATED=201]="CREATED",e[e.ACCEPTED=202]="ACCEPTED",e[e.NO_CONTENT=204]="NO_CONTENT",e[e.MULTI_STATUS=207]="MULTI_STATUS",e[e.NOT_MODIFIED=304]="NOT_MODIFIED",e[e.BAD_REQUEST=400]="BAD_REQUEST",e[e.NOT_AUTHORIZED=401]="NOT_AUTHORIZED",e[e.PAYMENT_REQUIRED=402]="PAYMENT_REQUIRED",e[e.FORBIDDEN=403]="FORBIDDEN",e[e.NOT_FOUND=404]="NOT_FOUND",e[e.NOT_ALLOWED=405]="NOT_ALLOWED",e[e.NOT_ACCEPTABLE=406]="NOT_ACCEPTABLE",e[e.CONFLICT=409]="CONFLICT",e[e.GONE=410]="GONE",e[e.LENGTH_REQUIRED=411]="LENGTH_REQUIRED",e[e.PRECONDITION_FAILED=412]="PRECONDITION_FAILED",e[e.REQUEST_ENTITY_TOO_LARGE=413]="REQUEST_ENTITY_TOO_LARGE",e[e.UNSUPPORTED_MEDIA_TYPE=415]="UNSUPPORTED_MEDIA_TYPE",e[e.REQUEST_RANGE_NOT_SATISFIABLE=416]="REQUEST_RANGE_NOT_SATISFIABLE",e[e.EXPECTATION_FAILED=417]="EXPECTATION_FAILED",e[e.UNPROCESSABLE_ENTITY=422]="UNPROCESSABLE_ENTITY",e[e.THROTTLED=429]="THROTTLED",e[e.SERVER_ERROR=500]="SERVER_ERROR",e[e.NOT_IMPLEMENTED=501]="NOT_IMPLEMENTED",e[e.BAD_GATEWAY=502]="BAD_GATEWAY",e[e.SERVICE_UNAVAILABLE=503]="SERVICE_UNAVAILABLE",e[e.GATEWAY_TIMEOUT=504]="GATEWAY_TIMEOUT",e[e.INSUFFICIENT_STORAGE=507]="INSUFFICIENT_STORAGE",e[e.BANDWIDTH_LIMIT_EXCEEDED=509]="BANDWIDTH_LIMIT_EXCEEDED",e[e.SERVER_TIMEOUT=599]="SERVER_TIMEOUT"}(i||(i={})),function(e){e.HTTP_2XX="2xx",e.HTTP_5XX="5xx"}(a||(a={})),function(e){e.Initial="Initial",e.Auth="Auth",e.AuthDecorate="AuthDecorate",e.AuthResolve="AuthResolve",e.Retry="Retry",e.RetryDelay="RetryDelay",e.Redirect="Redirect",e.Throttle="Throttle"}(o||(o={}))},415e3:(e,t,n)=>{"use strict";function i(e,t,n){const i=new Error(e);return Object.assign(i,{reason:e,serverResponse:t,innerException:n})}n.d(t,{T:()=>i})},141064:(e,t,n)=>{"use strict";n.d(t,{LP:()=>u,kf:()=>p,Ji:()=>g,Eb:()=>h});var i=n(679750),a=n(909260),o=n(708362);const r=new RegExp("media.*\\.giphy\\.com$","i"),s=new RegExp(["office-int\\.com","officeapps\\.live-int\\.com","dod\\.online\\.office365\\.us","gov\\.online\\.office365\\.us","officeapps\\.live\\.com","officeapps\\.live-int\\.com","officeapps-df\\.live\\.com","online\\.office\\.de","partner\\.officewebapps\\.cn","office\\.net"].map((e=>`ffc-powerpoint\\.${e}`)).join("|"),"i"),l=new RegExp([".*\\.asm\\.skype\\.com$",".*\\.asyncgw\\.teams\\.microsoft\\.com$",".*\\.ams\\.gcc\\.teams\\.microsoft\\.com$",".*\\.ams\\.gov\\.teams\\.microsoft\\.us$",".*\\.ams\\.dod\\.teams\\.microsoft\\.us$","\\urlp\\.sfbassets\\.com$","statics\\.teams\\.microsoft\\.com$","statics\\.teams\\.cdn\\.office\\.net$","staticsint\\.teams\\.cdn\\.office\\.net$","statics-dev\\.teams\\.cdn\\.office\\.net$","statics\\.teams\\.cdn\\.live\\.net$","staticsint\\.teams\\.cdn\\.live\\.net$","statics-dev\\.teams\\.cdn\\.live\\.net$","media.*\\.giphy\\.com$","local\\.teams\\.office\\.com$"].join("|"),"i"),c=new RegExp([".*\\logout*"].join("|"),"i"),d=/^\/asm\/[a-z]+/i,u=e=>`data:${m(e)};base64,${e}`,m=e=>{const t=(0,i.v)(e);let n;return n=255===t[0]&&216===t[1]?"image/jpg":137===t[0]&&80===t[1]&&78===t[2]&&71===t[3]?"image/png":71===t[0]&&73===t[1]&&70===t[2]?"image/gif":66===t[0]&&77===t[1]?"image/bmp":"image/unknown",n},p=e=>(e=>{const t=(0,o.J)().location.origin;if((0,a.nz)(e,t))return!0;const n=(0,a.Lp)(e).toLowerCase(),i=(0,a.DW)(e).toLowerCase();return l.test(n)||"teams.microsoft.com"===n&&d.test(i)})(e)&&(e=>{const t=(0,a.DW)(e).toLowerCase();return!c.test(t)})(e)||e.startsWith("data:image"),g=e=>{const t=(0,a.Lp)(e).toLowerCase();return r.test(t)},h=e=>{const t=(0,a.Lp)(e).toLowerCase();return s.test(t)}},76570:(e,t,n)=>{"use strict";n.d(t,{hA:()=>l,w2:()=>c,KD:()=>d,a:()=>u,$O:()=>m,Pg:()=>p,Q3:()=>g,fY:()=>h,DP:()=>v});var i=n(231191),a=n(909260);const o="/v1/objects",r=/^\/asm\/[a-z]+/i,s=/^\/asm\/[a-z]+\/v1\/objects/i;var l,c;function d(e){if(e&&m(e)){const t=new RegExp("/v1/objects/([\\w|\\-]+)","i"),n=e.match(t);return n&&n[1]||""}return""}function u(e){const t=(0,a.Lp)(e).toLowerCase(),n=(0,a.DW)(e);return t.endsWith("asm.skype.com")||"api.ams.gcc.teams.microsoft.com"===t||"api.ams.dod.teams.microsoft.us"===t||t.endsWith("asyncgw.teams.microsoft.com")||"teams.microsoft.com"===t&&r.test(n)}function m(e){if(v(e))return!0;const t=(0,a.DW)(e);return u(e)&&(t.startsWith(o)||s.test(t))}function p(e){return function(e){const t=(0,a.DW)(e);return u(e)&&t.endsWith("/views/video")}(e)?c.Video:m(e)?c.Image:c.None}function g(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=e instanceof Blob?new Uint8Array(yield null===(t=e.arrayBuffer)||void 0===t?void 0:t.call(e)):e;if(!n||n.length<6)return!1;if(71!==n[0]||73!==n[1]||70!==n[2])return!1;let i=0;for(let e=0;e<n.length-9&&!(33===n[e]&&249===n[e+1]&&4===n[e+2]&&44===n[e+8]&&(i++,i>1));e++);return i>1}))}function h(e,t){if(!e||!m(e)||!t||e.startsWith(t))return e;return[t,new URL(e).pathname.substring(1)].join("")}function v(e){return(0,a.DW)(e).toLowerCase().startsWith("/ams/v1/objects")}!function(e){e[e.IMAGE_SIZE_TOO_LARGE=10001]="IMAGE_SIZE_TOO_LARGE",e[e.UNSUPPORTED_IMAGE_FORMAT=10002]="UNSUPPORTED_IMAGE_FORMAT"}(l||(l={})),function(e){e.None="None",e.Image="Image",e.Video="Video"}(c||(c={}))},708362:(e,t,n)=>{"use strict";n.d(t,{J:()=>a,l:()=>o});var i=n(356773);function a(){return i.n.getInstance().window}function o(e,...t){const n=window.electronSafeIpc;n&&n.send(e,...t)}},367275:(e,t,n)=>{"use strict";n.d(t,{V:()=>i});const i={type:"safelinks",safelinksAtpMT:{type:"safelinksmt",getUrlReputationRestEndpoint:"beta/atpsafelinks/geturlreputationrest/",getpolicyEndpoint:"beta/atpsafelinks/getpolicy/",RESOURCE_KEY:"https://dataservice.o365filtering.com"},telemetry:{getPolicy:"atp_get_policy",getUrlReputation:"atp_get_url_reputation"},policyKey:"atp-safelinks-policy"}},91741:(e,t,n)=>{"use strict";n.d(t,{c:()=>u});var i=n(231191),a=n(682796),o=n(356452),r=n(459012),s=n(980633),l=n(367275),c=n(772635),d=n(40928);class u{constructor(e,t,n,i,a,o){this.send=e,this.authenticationService=t,this.coreSettings=n,this.scenarioFactory=i,this.localStorage=o,this.handleGetATPAuthToken=()=>this.authenticationService.acquireToken(l.V.safelinksAtpMT.RESOURCE_KEY),this.logger=a.newLogger("AtpSafelinksService")}initPolicy(){const e=this.scenarioFactory.newScenario(s.RG.ATPGetPolicyTask);this.getPolicy().then((()=>e.stop())).catch((t=>{const n=`Error getting ATP Safelinks policy: ${t.message||""}`;this.logger.error(n),e.fail({errors:n})}))}getPolicy(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){return null!==(e=this.getPolicyFromLocalStore())&&void 0!==e?e:this.getPolicyFromRemote()}))}getUrlReputationRestMT(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{enabledATPSafelinks:n}=this.coreSettings.get(a.J.Messaging);if(!n||!this._isAtpSafelinksSubscriptionEnabled())return this.logger.log("enabledATPSafelinks false"),{status:o.qb.OK,url:t};try{const n=yield this.handleGetATPAuthToken(),i=yield this._post(l.V.safelinksAtpMT.getUrlReputationRestEndpoint,this._getRequestBody(t,n),this._getHeaders(e));this.logger.log("getUrlReputationRestMT started");const a=yield i.body.json();return{url:t,status:i.status,data:a&&a.isATPSafelinksEnabled?a:{isATPSafelinksEnabled:!1}}}catch(e){return this.logger.error(`AtpSafelinks MT API failed with Error: ${e&&e.message}`),{url:t,status:-1}}}))}getPolicyFromLocalStore(){let e=null;try{const t=this.localStorage.get(l.V.policyKey);if(t){const n=JSON.parse(t);(0,d.z)(n.cookie,n.webAffinitizedUrl)?e=n:this.logger.error("Invalid policy found from localStorage")}}catch(e){this.logger.error(`Error while getting ATP safelinks policy from localStorage: ${e}`)}return e}getPolicyFromRemote(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let e=null;const t=this.scenarioFactory.newScenario(s.RG.ATPGetPolicy);try{const n=yield this._get(l.V.safelinksAtpMT.getpolicyEndpoint),i=yield n.body.json();this.localStorage&&this.localStorage.setSafe(l.V.policyKey,JSON.stringify(i));const a=`getPolicy status: ${n.status}`;this.logger.debug(a),t.stop({reason:a}),e=i}catch(e){this.logger.error(`AtpSafelinks GetPolicy API failed with Error: ${e&&e.message}`),t.fail({errors:`${l.V.telemetry.getPolicy}_failed`})}return e}))}_getRequestBody(e,t){return{urlList:[e],atptoken:t}}_getHeaders(e){const t={"content-type":"application/json"};return e&&(this._addHeader(e.user,"X-sourceUser",t),this._addHeader(e.id,"X-sourceId",t),this._addHeader(e.detail,"X-sourceDetail",t)),t}_addHeader(e,t,n){n[t]=e}_post(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return(0,c.B)(this.send,o.qb.OK)({url:e,method:"POST",body:JSON.stringify(t),headers:n,serviceName:r.EJ.MiddleTier,apiName:"safelink"})}))}_get(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return(0,c.B)(this.send,o.qb.OK)({url:e,method:"GET",serviceName:r.EJ.MiddleTier,apiName:"safelink"})}))}_isAtpSafelinksSubscriptionEnabled(){const{licenseSettings:e}=this.coreSettings.get(a.J.UserResources);return!(!e||!e.isAtpSafelinksEnabled)}}},332304:(e,t,n)=>{"use strict";function i(e){const{oid:t,tid:n,puid:i}=e.profile;return{profile:{objectId:t||`8:defaultOid:${n}`,tenantId:n,puid:i||null},isAuthenticated:e.isAuthenticated,role:e.role,type:e.type,loginUserName:e.userName||null}}n.d(t,{K:()=>i})},931e3:(e,t,n)=>{"use strict";n.d(t,{N6:()=>s,aW:()=>l,xz:()=>c,r1:()=>d,R0:()=>u,Yy:()=>m});var i=n(892891),a=n(635649),o=n(682796),r=n(892946);const s=e=>!e||e.joinType!==a.MeetingJoinType.MeetingData,l=({user:e,coreSettings:t})=>{var n,i;return(0,r.n2)(e)?Boolean(null===(n=t.get(o.J.Calling))||void 0===n?void 0:n.enableImprovedFreemiumExperience):Boolean(null===(i=t.get(o.J.Calling))||void 0===i?void 0:i.enableMeetNowShareInvite)},c=(e,t)=>{const{allowMeetNowPolicy:n}=e.get(o.J.Calling);return Boolean(((e,t)=>{const{enableInstantMeeting:n}=e.get(o.J.Calendar),{enableMeetNowInLandingPage:i,enableMeetNowInChatList:a}=e.get(o.J.Calling);switch(t){case"calendar":case"calendarMigration":return Boolean(n);case"chatList":return Boolean(a);case"landingPage":return Boolean(i);default:return!1}})(e,t)&&n)},d=e=>{const{deepLinkDomain:t,deepLinkPath:n}=e.get(o.J.Calling);return t&&n?t+n:""},u=(e,t,n)=>{var i,a;const r=Boolean(null===(i=t.get(o.J.Calling))||void 0===i?void 0:i.enableShareMeetCode),s=Boolean(null===(a=t.get(o.J.Calling))||void 0===a?void 0:a.allowOnlyMeetCodeLink),l=m(t,n);return r&&l?l:s?null:e},m=(e,t)=>!t||(0,i.isEmpty)(t)?"":t.meetingUrl?t.meetingUrl:`${d(e)}${t.meetingCode}`},892946:(e,t,n)=>{"use strict";n.d(t,{n2:()=>o,L5:()=>r});var i=n(682796),a=n(723128);const o=e=>{var t;return(null===(t=null==e?void 0:e.tenant)||void 0===t?void 0:t.type)===a.OV.Freemium},r=({user:e,coreSettings:t})=>(e=>{var t;return Boolean(null===(t=e.get(i.J.Calling))||void 0===t?void 0:t.enableImprovedFreemiumExperience)})(t)&&o(e)},664730:(e,t,n)=>{"use strict";n.d(t,{sj:()=>i,NI:()=>r,gU:()=>c});var i,a=n(892891);!function(e){e.Adaptive="application/vnd.microsoft.card.adaptive"}(i||(i={}));const o="</at>",r=e=>{var t;const n=null!==(t=e.msTeams)&&void 0!==t?t:e.msteams;if(!n||!(0,a.isObject)(n)||!n.entities)return;let i;try{i=s(n.entities)}catch(e){return}return i},s=e=>{const t=new Map;let n=0;return e.forEach((e=>{e.type&&"mention"===e.type&&!u(e.text)&&e.mentioned&&!u(e.mentioned.id)&&l(e.text)&&!t.has(e.text)&&t.set(e.text,{itemId:(n++).toString(),mentionType:"person",displayName:e.mentioned.name,userId:e.mentioned.id,id:`${e.mentioned.id}|person`})})),t},l=e=>{const t=e.toLowerCase(),n=0===t.lastIndexOf("<at>"),i=t.indexOf(o)===t.length-o.length;return n&&i},c=(e,t,n)=>{d(e,t,n)},d=(e,t,n)=>{(0,a.forEach)(e,((i,o)=>{(0,a.isEqual)(t,{[o]:i})&&n(e),i instanceof Array?(0,a.forEach)(i,(e=>{d(e,t,n)})):(0,a.isObject)(i)&&d(i,t,n)}))},u=e=>!e||!e.trim()},726352:(e,t,n)=>{"use strict";function i(e,t,n){e.splice(function(e,t,n){let i=0,a=e.length;const o=n(t);for(;i<a;){const t=Math.floor((i+a)/2);o<n(e[t])?a=t:i=t+1}return i}(e,t,n),0,t)}n.d(t,{M:()=>i})},502201:(e,t,n)=>{"use strict";n.d(t,{Hk:()=>o,Rd:()=>r,By:()=>s});var i=n(231191);function a(e,t){if(!e.startsWith("blob"))return Promise.reject("invalid blob url");const n=new XMLHttpRequest;return n.open("GET",e,!0),n.responseType=t,new Promise(((e,t)=>{n.onload=()=>{200===n.status&&n.response?e(n.response):t(200!==n.status?{status:n.status,statusText:n.statusText}:{status:404,statusText:"no response data"})},n.send()}))}function o(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return yield a(e,"blob")}))}function r(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=yield a(e,"arraybuffer");return new Uint8Array(t)}))}function s(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return e.then((e=>URL.createObjectURL(e)))}))}},679750:(e,t,n)=>{"use strict";function i(e){if(!e)return new Uint8Array(0);return a(e.split(",")[1])}function a(e){const t=atob(e),n=new Uint8Array(t.length);for(let e=0;e<t.length;e++)n[e]=t.charCodeAt(e);return n}n.d(t,{H:()=>i,v:()=>a})},273350:(e,t,n)=>{"use strict";function i(){const e={};return e.promise=new Promise(((t,n)=>{e.resolve=t,e.reject=n})),e}n.d(t,{P:()=>i})},70941:(e,t,n)=>{"use strict";n.d(t,{cN:()=>i,BC:()=>a,df:()=>o,yX:()=>r,YM:()=>s,cS:()=>l});class i{constructor(e,t,n){this.maxDelay=e,this.initialDelay=t,this.calculate=n,this.errCount=0}get errorCount(){return this.errCount}next(){return Math.min(this.maxDelay,this.calculate(this.initialDelay,++this.errCount))}reset(){this.errCount=0}}class a extends i{constructor(e,t){super(e,t,((e,t)=>Math.pow(e,t)))}}class o extends i{constructor(e,t,n){super(n,e,((e,n)=>e*Math.pow(t,n-1)))}}class r extends i{constructor(e){super(e,e,(()=>e))}}class s extends i{constructor(e){super(e,e,(()=>Math.floor(Math.random()*e)))}}class l extends i{constructor(e,t){super(t,e,((e,t)=>{const n=Math.random()*Math.pow(2,t-1);return Math.floor((.5*Math.pow(4,t-1)+n)*e)}))}}},404657:(e,t,n)=>{"use strict";function i(e){let t=5381;for(let n=0;n<e.length;n++)t=(t<<5)+t+e.charCodeAt(n);return t>>>0}n.d(t,{E:()=>i})},755537:(e,t,n)=>{"use strict";n.d(t,{mT:()=>p});var i=n(231191),a=n(352367),o=n(775214),r=n(980633),s=n(16381),l=n(909260);function c(e){const{code:t=a.jK.Undefined,context:n="DynamicImport",reason:i={innerError:{}}}=e,r=`${n}:${t}`,s=`[${JSON.stringify(e,(0,o.cm)())}]`,c=i.innerError.message,d=i.innerError.request;let u;const m=d&&(0,l.y4)(void 0,(e=>e),d),p=m&&m.hostname,g=m&&m.pathname;if(g){const e=g.slice(g.lastIndexOf("/")+1),t=e.lastIndexOf("-");u=-1!==t?e.slice(0,t):e}return{errorCode:r,errors:s,dataSource:p,referrer:u,message:c}}const d=(e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){let n=0;const r=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const i="DynamicImport",r="recover",l={innerError:e},d=n<2;if(!e.request)throw(0,o.Tr)(i,a.jK.ScriptCodeError,r,l);if(e.type||-1===e.message.indexOf("Loading CSS chunk")){if("ChunkLoadError"===e.name){const n=function(e){let t;switch(e.type){case"missing":t=a.jK.ScriptEvalError;break;case"error":t=a.jK.ScriptLoadError;break;case"timeout":t=a.jK.ChunkLoadTimedOut;break;default:t=a.jK.Undefined}return t}(e),s=(0,o.Tr)(i,n,r,l);if(!d||n===a.jK.ScriptEvalError)throw s;t&&t.appendEventData(c(s))}}else{const e=(0,o.Tr)(i,a.jK.CSSLoadError,r,l);if(!d)throw e;t&&t.appendEventData(c(e))}n++,t&&t.appendEventData({size:n}),"timeout"===e.type&&(n=2),yield(0,s._)(2e3)}));for(;;)try{return yield e()}catch(e){yield r(e)}}));var u;!function(e){e[e.Loading=0]="Loading",e[e.Loaded=1]="Loaded",e[e.Failed=2]="Failed"}(u||(u={}));const m=new Map,p=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const i=!m.has(t)||m.get(t)===u.Failed;i&&m.set(t,u.Loading);const a=i?n&&n.createScenarioWithoutStarting(r.RG.DynamicImport,{timeoutMs:18e4}):void 0;a&&a.appendEventData({origin:t});try{const i=yield d(e,a);if(m.set(t,u.Loaded),a){const e=a.eventData.size;e&&e>0&&a.stop(),n&&n.clearScenario(a)}return i}catch(e){const n=c(e);a&&a.fail(n),m.set(t,u.Failed);const i=n.referrer||t;throw e.subContext=i,e.message=`${e.code}, failed to load bundle: ${i}`,e}}))},498765:(e,t,n)=>{"use strict";n.d(t,{Uw:()=>a,XC:()=>o,ZT:()=>r,LQ:()=>l,u4:()=>c});var i=n(892891);function a(e,t,n){return e=s(e,t,n=n||o),1===t.length&&"object"==typeof t[0]&&(e=s(e,t[0],n)),e}function o(e){if(null===e)return"null";if(void 0===e)return"undefined";const t=typeof e;if("string"===t)return e;if("number"===t||"boolean"===t)return String(e);if("function"===t)return"";if((0,i.isDate)(e))return e.toISOString();try{return JSON.stringify(e)}catch(t){return c(e)}}function r(e,t){if(!t){const t=e;return t.message||t.name||`${t}`}return o(e)}function s(e,t,n){for(const i in t)t.hasOwnProperty(i)&&(e=e.replace(`{${i}}`,n(t[i])));return l(e)}function l(e){return null==e||0===e.length?e:` ${e}`.substr(1)}function c(e,t){const n=new WeakSet;return JSON.stringify(e,((e,t)=>{if(!n.has(t)){if(t&&"object"==typeof t){if(n.add(t),t instanceof Map||t instanceof Set)return Array.from(t);if(t instanceof Error)return`${t.name}: ${t.message}`;if(t.constructor&&t.constructor!==Object&&t.constructor!==Array||t.prototype)return}return t}}),t)}},380889:(e,t,n)=>{"use strict";n.d(t,{Ni:()=>a,CB:()=>d,Qn:()=>u,fC:()=>m,bs:()=>p});const i="((?:(?:(?:(?:ht|f)tp(?:s?)):\\/\\/(?:www\\.)?)|(?:www\\.))(?:\\S+)",a=`${i}(?:[^,\\s]))`,o=`${i}(?:[^\\s]))`,r=new RegExp(`^${a}$`,"i"),s=new RegExp(`^${o}$`,"i"),l=new RegExp(a,"i"),c=new RegExp("^(?:(?:ht|f)tp(?:s?)):\\/\\/\\S+$","i"),d=e=>r.test(e),u=e=>s.test(e),m=e=>l.test(e),p=e=>c.test(e)},188682:(e,t,n)=>{"use strict";n.d(t,{D:()=>i});const i=(e,t={})=>{let n;try{n=JSON.parse(e)}catch(e){n=t}return n}},399019:(e,t,n)=>{"use strict";n.d(t,{J:()=>o,G:()=>r});var i=n(775214),a=n(352367);function o(e){if(!e)throw(0,i.Tr)(a.w5.Authentication,a.jK.InvalidInput,"parseJWT",void 0,`invalid token, value = ${e}`);try{const[,t]=e.split("."),n=r(t);return JSON.parse(n)}catch(t){throw(0,i.Tr)(a.w5.Authentication,a.jK.InvalidInput,"parseJWT",{innerError:t},`token contains dot = ${e.includes(".")}; token length = ${e.length}`)}}function r(e){if(!e)throw(0,i.Tr)(a.w5.Authentication,a.jK.InvalidInput,"base64DecodeStringUrlSafe",void 0,`invalid base64 string input, value = ${e}`);return e=e.replace(/-/g,"+").replace(/_/g,"/"),decodeURIComponent(escape(atob(e)))}},638307:(e,t,n)=>{"use strict";n.d(t,{F:()=>a});var i=n(909260);function a(e){const t=(0,i.y4)(e,(e=>e.pathname),e,"https://example.com");return decodeURIComponent(t.slice(t.lastIndexOf("/")+1))}},213678:(e,t,n)=>{"use strict";n.d(t,{g:()=>a});var i=n(892891);const a=(e,t)=>{if((0,i.isArray)(e))return t}},672488:(e,t,n)=>{"use strict";n.d(t,{O:()=>i,j:()=>a});const i=(e,t)=>100*e/t+"%",a=(e,t,n)=>Math.max(t,Math.min(n,e))},907252:(e,t,n)=>{"use strict";n.d(t,{i:()=>o});var i=n(231191),a=n(892891);function o(e,t){function n(e){if(!(0,a.isArray)(e)&&!(0,a.isObject)(e)||(0,a.isDate)(e))return e;const n={};(0,a.forOwn)(e,((e,i)=>{n[i]=o(e,t)}));const r=n,s=t;r[s];return(0,i.__rest)(r,["symbol"==typeof s?s:s+""])}return(0,a.isArray)(e)?e.map(n):n(e)}},772635:(e,t,n)=>{"use strict";n.d(t,{B:()=>o});var i=n(775214),a=n(352367);function o(e,...t){return n=>e(n).then((e=>{if(t.indexOf(e.status)>-1||t.filter(r).map((e=>new RegExp(e.replace(/x/gi,"\\d")))).some((t=>t.test(e.status.toString()))))return e;throw(0,i.Tr)(a.w5.RequireStatus,a.jK.RemoteOperationFailed,a.w5.RequireStatus,{requiredStatus:1===t.length?t[0]:t,status:e.status},void 0,e)}))}function r(e){return"string"==typeof e}},319493:(e,t,n)=>{"use strict";n.d(t,{X:()=>l,m:()=>c});var i=n(231191),a=n(670250),o=n(775214),r=n(352367),s=n(16381);const l=(e,t)=>(...n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){for(;;)try{return yield e(...n)}catch(e){yield t(e,...n)}})),c=(e,t)=>{const{maxRetries:n,retryWindow:l,backoffTime:c,shouldRetry:d}=t,u=e=>l-(Date.now()-e);return(...t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const i=Date.now();let l=0,m=u(i);for(;l++<=n&&m>0;)try{return yield Promise.resolve(e.apply(e,t))}catch(e){const t=yield(0,a.tE)(e);if(d&&!d(t))throw t?(0,o.Tr)(t.context,t.code,t.subContext?t.subContext:"",t.reason,t.message,t.serverResponse):(0,o.Tr)("RetryWithBackoff",r.jK.MaxLimitReached,"elapsed",void 0,`All retries elapsed or retryWindow expired, RetryCount: ${l}, RemainingTime: ${m}`);if(l>=n||u(i)<=0)break;yield(0,s._)(c),m=u(i)}throw(0,o.Tr)("RetryWithBackoff",r.jK.MaxLimitReached,"elapsed",void 0,`All retries elapsed or retryWindow expired, RetryCount: ${l}, RemainingTime: ${m}`)}))}},850476:(e,t,n)=>{"use strict";function i(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}n.d(t,{is:()=>i,V:()=>a});const a=(e,t)=>!!i(e,t)||null!=e&&null!=t&&(Array.isArray(e)&&Array.isArray(t)?r(e,t):e instanceof Set&&t instanceof Set?o(e,t):s(e,t)),o=(e,t)=>{if(e.size!==t.size)return!1;if(0===e.size)return!0;const n=e.values();let i=n.next();do{if(!t.has(i.value))return!1;i=n.next()}while(!i.done);return!0},r=(e,t)=>{if(e.length!==t.length)return!1;for(let n=e.length-1;n>=0;n--)if(!i(e[n],t[n]))return!1;return!0},s=(e,t)=>{const n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(const a of n)if(!i(e[a],t[a]))return!1;return!0}},16381:(e,t,n)=>{"use strict";function i(e){return new Promise(((t,n)=>{e<0?n(new Error("negative timeout")):setTimeout(t,e)}))}n.d(t,{_:()=>i})},550635:(e,t,n)=>{"use strict";n.d(t,{E:()=>r});var i=n(16381),a=n(775214),o=n(352367);function r(e,t,n,a){return Promise.race([e,(0,i._)(t).then((()=>{throw null==a||a.abort(),s(t,n)}))]).catch((e=>{if(e instanceof DOMException&&"AbortError"===e.name&&20===e.code)throw s(t,n);throw e}))}const s=(e,t)=>(0,a.Tr)(o.w5.Timed,o.jK.TimedOut,o.w5.Timed,{ms:e},t)},909260:(e,t,n)=>{"use strict";n.d(t,{y4:()=>o,N0:()=>r,Lp:()=>s,DW:()=>l,Nm:()=>d,_K:()=>u,ZN:()=>m,nz:()=>p,pZ:()=>g,kU:()=>h,IC:()=>v,eb:()=>f,m:()=>y});var i=n(892891),a=n(380889);function o(e,t,n,i){try{return t(new URL(n,i))}catch(t){return e}}function r(e){const t=new URL(e);return t.protocol+"//"+t.host}function s(e){return c(e)}function l(e){return c(e,!0)}function c(e,t=!1){let n=e.indexOf("://");n=n<=0?0:n+"://".length;const a=e.indexOf(":",n),o=e.indexOf("/",n),r=e.indexOf("?",n),s=[o,r,a,e.length],l=Math.min.apply(Math,(0,i.without)(s,-1));if(!t)return e.slice(n,l).toLowerCase();let c=l;if(a===l){const t=[o,r,e.length];c=Math.min.apply(Math,(0,i.without)(t,-1))}return e.slice(c).toLowerCase()}function d(e,t){if(!e)return"";if(e.startsWith("/"))return e;const n=e.indexOf(":");if(n<=0)return"";const i=(e=(e=(e=(e=e.replace(/(\')/g,"%27")).replace(/(\")/g,"%22")).replace(/{/g,"%7B")).replace(/}/g,"%7D")).substring(0,n).toLowerCase();for(const n of t)if(i===n)return e;return"http"===i?`https${e.substring(n)}`:""}function u(e,t){if(!t)return t;const n=new RegExp(`[?&]${e}=([^&#]*)`).exec(t);return n&&n.length>1?decodeURI(n[1]):""}function m(e,t,n){if(!e||!t||e.match(new RegExp(`[?&]${t}=`)))return e;const i=`${e.indexOf("?")>=0?"&":"?"}${t}=${n}`;if(-1!==e.indexOf("#")){const t=e.split("#");return`${t[0]}${i}#${t[1]}`}return`${e}${i}`}const p=(e,t)=>new RegExp(`^(blob:)(${t})`,"i").test(e),g=e=>/^(data:)/i.test(e),h=e=>/^(http)(s?):\/\//i.test(e);function v(e){if(!e)return e;return e.indexOf("#")>=0?e.substring(0,e.indexOf("#")):e}function f(e){return(0,a.bs)(e)?e:`https://${e}`}const y=e=>{if(e)return"string"!=typeof e&&(e=e),e.endsWith("/")||(e+="/"),e}},9654:(e,t,n)=>{"use strict";var i,a,o;n.d(t,{gT:()=>i,lP:()=>a,ej:()=>o}),function(e){e[e.Two=2]="Two",e[e.FOUR=4]="FOUR",e[e.FIVE=5]="FIVE",e[e.FIFTEEN=15]="FIFTEEN",e[e.SECONDS_PER_MINUTE=60]="SECONDS_PER_MINUTE",e[e.MINUTES_PER_HOUR=60]="MINUTES_PER_HOUR",e[e.MILLI_PER_SECOND=1e3]="MILLI_PER_SECOND",e[e.MILLI_PER_MINUTE=6e4]="MILLI_PER_MINUTE",e[e.MILLISECONDS_PER_HOUR=36e5]="MILLISECONDS_PER_HOUR"}(i||(i={})),function(e){e[e.LOAD_FRAME_TIMEOUT=15e3]="LOAD_FRAME_TIMEOUT",e[e.EXPIRE_OFFSET_SECONDS=600]="EXPIRE_OFFSET_SECONDS",e[e.MT_TOKEN_INTERVAL=12e4]="MT_TOKEN_INTERVAL",e[e.ACQUIRE_TOKEN_TIMEOUT=6e4]="ACQUIRE_TOKEN_TIMEOUT",e[e.DEFAULT_ACQUIRE_TOKEN_MAX_RETRIES=3]="DEFAULT_ACQUIRE_TOKEN_MAX_RETRIES",e[e.DEFAULT_ACQUIRE_TOKEN_RETRY_WINDOW=3e4]="DEFAULT_ACQUIRE_TOKEN_RETRY_WINDOW",e[e.DEFAULT_ACQUIRE_TOKEN_BACKOFF_TIME=2e3]="DEFAULT_ACQUIRE_TOKEN_BACKOFF_TIME",e[e.ELECTRON_ACQUIRE_TOKEN_TIMEOUT=22e4]="ELECTRON_ACQUIRE_TOKEN_TIMEOUT",e[e.ACQUIRE_TOKEN_SCENARIO_TIMEOUT=24e4]="ACQUIRE_TOKEN_SCENARIO_TIMEOUT",e[e.DEFAULT_SKYPE_MAX_DELAY_TIME_MS=3e4]="DEFAULT_SKYPE_MAX_DELAY_TIME_MS",e[e.DEFAULT_SKYPE_MAX_RETRY_DURATION_MS=15e3]="DEFAULT_SKYPE_MAX_RETRY_DURATION_MS",e[e.DEFAULT_SKYPE_MAX_RETRY_COUNT=3]="DEFAULT_SKYPE_MAX_RETRY_COUNT",e[e.DEFAULT_SKYPE_MIN_RETRY_INTERVAL_MS=1e3]="DEFAULT_SKYPE_MIN_RETRY_INTERVAL_MS",e[e.DEFAULT_SKYPE_EXP_DELAY_FACTOR=2]="DEFAULT_SKYPE_EXP_DELAY_FACTOR"}(a||(a={})),function(e){e.LOKI_TFL_AUTH_TOKEN_AUDIENCE="liveprofilecard.access",e.MT_AAD_KEY="https://api.spaces.skype.com",e.MT_KEY="middleTier",e.SKYPE_KEY="skype",e.AUTHZ_DEFAULT_BASE_URL="https://authsvc.teams.microsoft.com/v1.0/authz"}(o||(o={}))},545319:(e,t,n)=>{"use strict";var i,a,o,r,s,l;n.d(t,{NR:()=>i,Q2:()=>a,f8:()=>o,Qs:()=>r,ci:()=>s,s0:()=>l}),function(e){e.Windows="windows",e.Mac="mac",e.Linux="linux",e.ChromeOS="chromeos",e.Android="android",e.IOS="ios",e.WindowsPhone="windowsphone",e.Unknown="unknown"}(i||(i={})),function(e){e.Default="default",e.DefaultV2="defaultV2",e.DefaultTfl="tfl-default",e.Dark="dark",e.DarkV2="darkV2",e.DarkTfl="tfl-dark",e.HighContrast="contrast"}(a||(a={})),function(e){e.Dark="dark",e.Light="light",e.Contrast="contrast"}(o||(o={})),function(e){e.Light="0",e.Dark="1",e.Contrast="2",e.DefaultV2="3",e.DarkV2="4",e.DefaultTfl="5",e.DarkTfl="6"}(r||(r={})),function(e){e.HighContrast="#FFFFFF_#000000_#FFFF00"}(s||(s={})),function(e){e.ColorContrastOverride="(forced-colors: active)",e.Light="(prefers-color-scheme: light)",e.Dark="(prefers-color-scheme: dark)"}(l||(l={}))},25835:(e,t,n)=>{"use strict";n.d(t,{i:()=>i});const i=[{name:"Albanian (Albania)",nativeName:"Shqip (Shqipëri)",code:"sq-al"},{name:"Arabic - Saudi Arabia",nativeName:"العربية (المملكة العربية السعودية)",code:"ar-sa"},{name:"Azerbaijani (Azerbaijan)",nativeName:"Azərbaycan (Azərbaycan)",code:"az-latn-az"},{name:"Basque (Basque)",nativeName:"Euskara (Euskara)",code:"eu-es"},{name:"Bulgarian (Bulgaria)",nativeName:"Български (България)",code:"bg-bg"},{name:"Catalan (Catalan)",nativeName:"Català (Català)",code:"ca-es"},{name:"Chinese (Simplified, PRC)",nativeName:"中文(中国)",code:"zh-cn"},{name:"Chinese (Simplified, Singapore)",nativeName:"中文(新加坡)",code:"zh-sg",translationCode:"zh-cn"},{name:"Chinese (Traditional, Hong Kong S.A.R.)",nativeName:"中文(香港特別行政區)",code:"zh-hk",translationCode:"zh-tw"},{name:"Chinese (Traditional, Macao S.A.R.)",nativeName:"中文(澳門特別行政區)",code:"zh-mo",translationCode:"zh-tw"},{name:"Chinese (Traditional, Taiwan)",nativeName:"中文(台灣)",code:"zh-tw"},{name:"Croatian (Croatia)",nativeName:"Hrvatski (Hrvatska)",code:"hr-hr"},{name:"Czech (Czech Republic)",nativeName:"Čeština (Česká republika)",code:"cs-cz"},{name:"Danish (Denmark)",nativeName:"Dansk (Danmark)",code:"da-dk"},{name:"Dutch (Belgium)",nativeName:"Nederlands (België)",code:"nl-be",translationCode:"nl-nl"},{name:"Dutch (Netherlands)",nativeName:"Nederlands (Nederland)",code:"nl-nl"},{name:"English (Australia)",nativeName:"English (Australia)",code:"en-au",translationCode:"en-gb"},{name:"English (Belize)",nativeName:"English (Belize)",code:"en-bz",translationCode:"en-us"},{name:"English (Canada)",nativeName:"English (Canada)",code:"en-ca",translationCode:"en-gb"},{name:"English (Caribbean)",nativeName:"English (Caribbean)",code:"en-029",translationCode:"en-us"},{name:"English (India)",nativeName:"English (India)",code:"en-in",translationCode:"en-gb"},{name:"English (Ireland)",nativeName:"English (Ireland)",code:"en-ie",translationCode:"en-gb"},{name:"English (Jamaica)",nativeName:"English (Jamaica)",code:"en-jm",translationCode:"en-us"},{name:"English (Malaysia)",nativeName:"English (Malaysia)",code:"en-my",translationCode:"en-gb"},{name:"English (New Zealand)",nativeName:"English (New Zealand)",code:"en-nz",translationCode:"en-gb"},{name:"English (Republic of the Philippines)",nativeName:"English (Philippines)",code:"en-ph",translationCode:"en-us"},{name:"English (Singapore)",nativeName:"English (Singapore)",code:"en-sg",translationCode:"en-gb"},{name:"English (South Africa)",nativeName:"English (South Africa)",code:"en-za",translationCode:"en-gb"},{name:"English (Trinidad and Tobago)",nativeName:"English (Trinidad y Tobago)",code:"en-tt",translationCode:"en-us"},{name:"English (United Kingdom)",nativeName:"English (United Kingdom)",code:"en-gb"},{name:"English (United States)",nativeName:"English (United States)",code:"en-us"},{name:"English (Zimbabwe)",nativeName:"English (Zimbabwe)",code:"en-zw",translationCode:"en-gb"},{name:"Estonian (Estonia)",nativeName:"Eesti (Eesti)",code:"et-ee"},{name:"Filipino (Philippines)",nativeName:"Filipino (Pilipinas)",code:"fil-ph"},{name:"Finnish (Finland)",nativeName:"Suomi (Suomi)",code:"fi-fi"},{name:"French (Belgium)",nativeName:"Français (Belgique)",code:"fr-be",translationCode:"fr-fr"},{name:"French (Canada)",nativeName:"Français (Canada)",code:"fr-ca"},{name:"French (France)",nativeName:"Français (France)",code:"fr-fr"},{name:"French (Luxembourg)",nativeName:"Français (Luxembourg)",code:"fr-lu",translationCode:"fr-fr"},{name:"French (Monaco)",nativeName:"Français (Principauté de Monaco)",code:"fr-mc",translationCode:"fr-fr"},{name:"French (Switzerland)",nativeName:"Français (Suisse)",code:"fr-ch",translationCode:"fr-fr"},{name:"Galician ()",nativeName:"Galego (Galego)",code:"gl-es"},{name:"Georgian (Georgia)",nativeName:"ქართული (საქართველო)",code:"ka-ge"},{name:"German (Austria)",nativeName:"Deutsch (Österreich)",code:"de-at",translationCode:"de-de"},{name:"German (Germany)",nativeName:"Deutsch (Deutschland)",code:"de-de"},{name:"German (Liechtenstein)",nativeName:"Deutsch (Liechtenstein)",code:"de-li",translationCode:"de-de"},{name:"German (Luxembourg)",nativeName:"Deutsch (Luxemburg)",code:"de-lu",translationCode:"de-de"},{name:"German (Switzerland)",nativeName:"Deutsch (Schweiz)",code:"de-ch",translationCode:"de-de"},{name:"Greek (Greece)",nativeName:"Ελληνικά (Ελλάδας)",code:"el-gr"},{name:"Hebrew (Israel)",nativeName:"עברית (ישראל)",code:"he-il"},{name:"Hindi (India)",nativeName:"हिन्दी (भारत)",code:"hi-in"},{name:"Hungarian (Hungary)",nativeName:"Magyar (Magyarország)",code:"hu-hu"},{name:"Icelandic (Iceland)",nativeName:"Íslenska (Ísland)",code:"is-is"},{name:"Indonesian (Indonesia)",nativeName:"Bahasa Indonesia (Indonesia)",code:"id-id"},{name:"Italian (Italy)",nativeName:"Italiano (Italia)",code:"it-it"},{name:"Italian (Switzerland)",nativeName:"Italiano (Svizzera)",code:"it-ch",translationCode:"it-it"},{name:"Japanese (Japan)",nativeName:"日本語 (日本)",code:"ja-jp"},{name:"Kazakh (Kazakhstan)",nativeName:"Қазақ (Қазақстан)",code:"kk-kz"},{name:"Korean (Korea)",nativeName:"한국어 (대한민국)",code:"ko-kr"},{name:"Latvian (Latvia)",nativeName:"Latviešu (Latvija)",code:"lv-lv"},{name:"Lithuanian (Lithuania)",nativeName:"Lietuvių (Lietuva)",code:"lt-lt"},{name:"Macedonian (North Macedonia)",nativeName:"Mакедонски (Северна Македонија)",code:"mk-mk"},{name:"Norwegian, Bokmål (Norway)",nativeName:"Norsk, Bokmål (Norge)",code:"nb-no"},{name:"Norwegian, Nynorsk (Norway)",nativeName:"Norsk, Nynorsk (Norge)",code:"nn-no"},{name:"Polish (Poland)",nativeName:"Polski (Polska)",code:"pl-pl"},{name:"Pseudo",nativeName:"Pseudo",code:"pseudo"},{name:"Portuguese (Brazil)",nativeName:"Português (Brasil)",code:"pt-br"},{name:"Portuguese (Portugal)",nativeName:"Português (Portugal)",code:"pt-pt"},{name:"Romanian (Romania)",nativeName:"Română (România)",code:"ro-ro"},{name:"RTL English",nativeName:"Shilgny (The Upsidedown)",code:"fl-ip",translationCode:"en-us"},{name:"Russian (Russia)",nativeName:"Русский (Россия)",code:"ru-ru"},{name:"Serbian (Latin, Serbia)",nativeName:"Srpski (Srbija)",code:"sr-latn-rs"},{name:"Slovak (Slovakia)",nativeName:"Slovenčina (Slovenská republika)",code:"sk-sk"},{name:"Slovenian (Slovenia)",nativeName:"Slovenščina (Slovenija)",code:"sl-si"},{name:"Spanish (Argentina)",nativeName:"Español (Argentina)",code:"es-ar",translationCode:"es-mx"},{name:"Spanish (Bolivarian Republic of Venezuela)",nativeName:"Español (Republica Bolivariana de Venezuela)",code:"es-ve",translationCode:"es-mx"},{name:"Spanish (Bolivia)",nativeName:"Español (Bolivia)",code:"es-bo",translationCode:"es-mx"},{name:"Spanish (Chile)",nativeName:"Español (Chile)",code:"es-cl",translationCode:"es-mx"},{name:"Spanish (Colombia)",nativeName:"Español (Colombia)",code:"es-co",translationCode:"es-es"},{name:"Spanish (Costa Rica)",nativeName:"Español (Costa Rica)",code:"es-cr",translationCode:"es-mx"},{name:"Spanish (Dominican Republic)",nativeName:"Español (República Dominicana)",code:"es-do",translationCode:"es-mx"},{name:"Spanish (Ecuador)",nativeName:"Español (Ecuador)",code:"es-ec",translationCode:"es-mx"},{name:"Spanish (El Salvador)",nativeName:"Español (El Salvador)",code:"es-sv",translationCode:"es-mx"},{name:"Spanish (Guatemala)",nativeName:"Español (Guatemala)",code:"es-gt",translationCode:"es-mx"},{name:"Spanish (Honduras)",nativeName:"Español (Honduras)",code:"es-hn",translationCode:"es-mx"},{name:"Spanish (Mexico)",nativeName:"Español (México)",code:"es-mx"},{name:"Spanish (Nicaragua)",nativeName:"Español (Nicaragua)",code:"es-ni",translationCode:"es-mx"},{name:"Spanish (Paraguay)",nativeName:"Español (Paraguay)",code:"es-py",translationCode:"es-mx"},{name:"Spanish (Panama)",nativeName:"Español (Panamá)",code:"es-pa",translationCode:"es-mx"},{name:"Spanish (Peru)",nativeName:"Español (Perú)",code:"es-pe",translationCode:"es-mx"},{name:"Spanish (Puerto Rico)",nativeName:"Español (Puerto Rico)",code:"es-pr",translationCode:"es-mx"},{name:"Spanish (Spain, International Sort)",nativeName:"Español (España, alfabetización internacional)",code:"es-es"},{name:"Spanish (United States)",nativeName:"Español (Estados Unidos)",code:"es-us",translationCode:"es-mx"},{name:"Spanish (Uruguay)",nativeName:"Español (Uruguay)",code:"es-uy",translationCode:"es-es"},{name:"Swedish (Finland)",nativeName:"Svenska (Finland)",code:"sv-fi",translationCode:"sv-se"},{name:"Swedish (Sweden)",nativeName:"Svenska (Sverige)",code:"sv-se"},{name:"Thai (Thailand)",nativeName:"ไทย (ไทย)",code:"th-th"},{name:"Turkish (Turkey)",nativeName:"Türkçe (Türkiye)",code:"tr-tr"},{name:"Ukrainian (Ukraine)",nativeName:"Українська (Україна)",code:"uk-ua"},{name:"Valencian (Spain)",nativeName:"Valencià (Espanya)",code:"ca-es-valencia"},{name:"Vietnamese (Vietnam)",nativeName:"Tiếng Việt (Việt Nam)",code:"vi-vn"},{name:"Welsh (United Kingdom)",nativeName:"Cymraeg (Y Deyrnas Unedig)",code:"cy-gb"}]},955731:(e,t,n)=>{"use strict";var i;n.d(t,{V:()=>i}),function(e){e.User="8:orgid:",e.Pstn="4:",e.Bot="28:"}(i||(i={}))},517285:(e,t,n)=>{"use strict";n.d(t,{A_:()=>i,kg:()=>a,Xg:()=>o,Yr:()=>r,JJ:()=>s,NO:()=>l,Ix:()=>c,Yx:()=>d,F8:()=>u,vx:()=>m,Zd:()=>p,tL:()=>g,qc:()=>h});const i=6e4,a=1e3,o=60,r=3600,s=60,l=1e3,c=24,d=7,u=12,m="h:mm a",p=864e5,g=300;var h;!function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday"}(h||(h={}))},670250:(e,t,n)=>{"use strict";n.d(t,{E6:()=>r,xn:()=>s,tE:()=>l});var i=n(231191),a=n(352367),o=n(775214);const r=e=>{if(!e)return null;const{graphQLErrors:t}=e;return t&&t.length>0&&t[0]&&t[0].originalError?(0,o.Jn)(t[0].originalError,a.w5.Apollo,a.jK.ApolloError,"getOriginalError",{status:t[0].originalError.code}):null},s=e=>{var t,n;const i=null===(n=null===(t=e.graphQLErrors)||void 0===t?void 0:t[0])||void 0===n?void 0:n.extensions;return i?i.prevError&&"UNKNOWN"===i.code?(0,o.Jn)(new Error(e.graphQLErrors[0].message),i.prevError.context,i.prevError.code,i.prevError.subContext,i.prevError.reason):(0,o.Jn)(new Error(e.graphQLErrors[0].message),i.context,i.code,i.subContext,i.reason):null},l=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(!e)return null;let t=null;const{graphQLErrors:n,networkError:r}=e;var s;return r&&(t=c(r)),!t&&n&&n.length>0&&n[0].originalError&&(t=yield(s=n[0],(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e,t,n;let i=null;try{if(i=s.originalError,!(null===(e=null==i?void 0:i.serverResponse)||void 0===e?void 0:e.body))return i;const a=null===(t=null==i?void 0:i.serverResponse)||void 0===t?void 0:t.status,o=yield null===(n=null==i?void 0:i.serverResponse)||void 0===n?void 0:n.body.json();if(!p(o))return i;i.reason={status:a,errorCode:o.errorCode,errorSubCode:o.errorSubCode}}catch(e){}return i})))),t||(t=n&&n.length>0&&n[0]&&n[0].originalError?(0,o.Jn)(n[0].originalError,a.w5.Apollo,a.jK.ApolloError,"getOriginalError",{status:n[0].originalError.code}):null),t})),c=e=>{let t=null;try{const n=JSON.parse(e.message);if(n){const i=JSON.parse(n.message);if(i){const n=JSON.parse(i.reason);n&&(t=Object.assign(Object.assign({},e),{reason:{status:m(n)?n.status:void 0,errorCode:p(n)?n.errorCode:void 0}}))}}}catch(n){t=d(e)}return t},d=e=>e.serverResponse?(0,o.Tr)(e.context,e.code,e.subContext?e.subContext:"",{status:e.serverResponse.status,errorCode:e.reason?e.reason.errorCode:void 0,reason:e.reason},e.message,e.serverResponse):null,u=e=>"number"==typeof e,m=e=>!!e&&void 0!==e.status&&u(e.status),p=e=>!!e&&void 0!==e.errorCode&&u(e.errorCode)},775214:(e,t,n)=>{"use strict";n.d(t,{o7:()=>o,zg:()=>r,Tr:()=>s,Jn:()=>l,dK:()=>c,O$:()=>d,B9:()=>u,VK:()=>m,qZ:()=>p,cm:()=>v});var i=n(892891),a=n(352367);function o(e,t=[]){return e>=500&&e<600&&-1===t.indexOf(e)}function r(e){return a.lX.get(e)||a.jK.Unknown}function s(e,t,n,i,a=`${e}::${n}::${t}`,o,r){const s=new Error(a);return Object.assign(s,{context:e,subContext:n,reason:i,code:t,serverResponse:o,isExpected:r})}function l(e,t,n,i,a,o){const r=s(t,n,i,a,o);return r.reason=r.reason||{},r.reason.innerError=e,r}function c(e,t,n,a,o){return!(!(t||n||a||o)||!e)&&((void 0===t||e.context===t)&&(void 0===n||e.code===n)&&(void 0===a||!!e.reason&&(0,i.every)(a,((t,n)=>{const a=(null==e?void 0:e.reason)?e.reason[n]:null;return Array.isArray(t)?t.some((e=>(0,i.isEqual)(e,a))):(0,i.isEqual)(t,a)})))&&(void 0===o||e.subContext===o))}function d(e,t,n){return e&&e.reason&&void 0!==e.reason[t]?e.reason[t]:n}function u(e){return e&&e.message?e.message:e}function m(e,t=!0){if(null==e)return"";if("string"==typeof e)return e;try{return JSON.stringify(e,h(g(t)))}catch(e){return"Stringifying error failed"}}function p(e){return e&&e.code?e.code:a.jK.Unknown}const g=(e=!1)=>(t,n)=>n instanceof Error?Object.assign({name:n.name,message:n.message,stack:e?[]:("string"==typeof n.stack?n.stack:"").split("\n").map((e=>e.trim())).filter((e=>!!e))},n):n,h=e=>{const t=new WeakSet;return(n,i)=>{if("object"==typeof i&&null!==i){if(t.has(i))return;t.add(i)}return e(n,i)}},v=()=>h(g())},40928:(e,t,n)=>{"use strict";n.d(t,{z:()=>i});const i=(e,t)=>{if(e&&t){const t=/^(.*); expires=(.*); path=\/$/,n=2,i=e.match(t);if(i){return new Date(i[n]).getTime()>Date.now()}}return!1}},261062:(e,t,n)=>{"use strict";n.d(t,{Fd:()=>r,UV:()=>s,s3:()=>l,HC:()=>c,wm:()=>d,LY:()=>u,Bj:()=>m});var i=n(892891),a=n(439146),o=n(143028);function r(e,t){if(-1!==e.indexOf("local.teams.office.com"))return!0;const n=s(e);for(const a of(0,i.uniqBy)(t,(e=>e.toLowerCase()))){let t="";const i=a.split(".");for(let e=0;e<i.length;e++)t+=(e>0?"[.]":"")+i[e].replace("*","[^/^.]+");const o=new RegExp(`^https://${t}((/|\\?).*)?$`,"i");if(e.match(o)||n.match(o))return!0}return!1}const s=e=>new URL(e).href,l=e=>{let t="";if(!e.id||d(e.id))return t;switch(e.type){case a.p.extensions:try{t=JSON.parse(e.id).threadId}catch(n){t=e.id}break;case a.p.chats:t=e.id.replace("replyChainId","messageid");break;default:t=e.id}return t},c=e=>e&&e.replace(new RegExp(`^${o.at.BotPrefix}`),""),d=e=>"newchat"===e||(null==e?void 0:e.includes("preview")),u=(e,t=o.Cs.Call)=>t===o.Cs.Call&&/<partlist/.test(e)&&!m(e,t),m=(e,t=o.Cs.Call)=>t===o.Cs.Call&&(-1!==e.indexOf("<ended/>")||/^<partlist[^>]*type="ended"/.test(e))},60261:(e,t,n)=>{"use strict";n.d(t,{X:()=>i,si:()=>o,D:()=>r});const i="other";var a;function o(e){return!!a[e]}function r(){return Object.keys(a).filter((e=>isNaN(Number(e))))}!function(e){e[e["3mf"]=0]="3mf",e[e.cool=1]="cool",e[e.glb=2]="glb",e[e.gltf=3]="gltf",e[e.obj=4]="obj",e[e.stl=5]="stl",e[e.movie=6]="movie",e[e.pages=7]="pages",e[e.pict=8]="pict",e[e.sketch=9]="sketch",e[e.ai=10]="ai",e[e.pdf=11]="pdf",e[e.psb=12]="psb",e[e.psd=13]="psd",e[e["3g2"]=14]="3g2",e[e["3gp"]=15]="3gp",e[e.asf=16]="asf",e[e.bmp=17]="bmp",e[e.hevc=18]="hevc",e[e.m2ts=19]="m2ts",e[e.m4v=20]="m4v",e[e.mov=21]="mov",e[e.mp3=22]="mp3",e[e.mp4=23]="mp4",e[e.mp4v=24]="mp4v",e[e.mts=25]="mts",e[e.ts=26]="ts",e[e.wmv=27]="wmv",e[e.dwg=28]="dwg",e[e.fbx=29]="fbx",e[e.erf=30]="erf",e[e.zip=31]="zip",e[e["7z"]=32]="7z",e[e.z=33]="z",e[e.dcm=34]="dcm",e[e.dcm30=35]="dcm30",e[e.dicm=36]="dicm",e[e.dicom=37]="dicom",e[e.ply=38]="ply",e[e.hcp=39]="hcp",e[e.gif=40]="gif",e[e.heic=41]="heic",e[e.heif=42]="heif",e[e.jpeg=43]="jpeg",e[e.jpg=44]="jpg",e[e.jpe=45]="jpe",e[e.mef=46]="mef",e[e.mrw=47]="mrw",e[e.nef=48]="nef",e[e.nrw=49]="nrw",e[e.orf=50]="orf",e[e.pano=51]="pano",e[e.pef=52]="pef",e[e.png=53]="png",e[e.rw2=54]="rw2",e[e.spm=55]="spm",e[e.tif=56]="tif",e[e.tiff=57]="tiff",e[e.xbm=58]="xbm",e[e.xcf=59]="xcf",e[e.key=60]="key",e[e.csv=61]="csv",e[e.dic=62]="dic",e[e.doc=63]="doc",e[e.docm=64]="docm",e[e.docx=65]="docx",e[e.dot=66]="dot",e[e.dotm=67]="dotm",e[e.dotx=68]="dotx",e[e.pot=69]="pot",e[e.potm=70]="potm",e[e.potx=71]="potx",e[e.pps=72]="pps",e[e.ppsm=73]="ppsm",e[e.ppsx=74]="ppsx",e[e.ppt=75]="ppt",e[e.pptm=76]="pptm",e[e.pptx=77]="pptx",e[e.xd=78]="xd",e[e.xls=79]="xls",e[e.xlsb=80]="xlsb",e[e.xlsm=81]="xlsm",e[e.xlsx=82]="xlsx",e[e.sltx=83]="sltx",e[e.eml=84]="eml",e[e.msg=85]="msg",e[e.vsd=86]="vsd",e[e.vsdx=87]="vsdx",e[e.cur=88]="cur",e[e.ico=89]="ico",e[e.icon=90]="icon",e[e.epub=91]="epub",e[e.odp=92]="odp",e[e.ods=93]="ods",e[e.odt=94]="odt",e[e.arw=95]="arw",e[e.cr2=96]="cr2",e[e.crw=97]="crw",e[e.dng=98]="dng",e[e.rtf=99]="rtf",e[e.abap=100]="abap",e[e.ada=101]="ada",e[e.adp=102]="adp",e[e.ahk=103]="ahk",e[e.as=104]="as",e[e.as3=105]="as3",e[e.asc=106]="asc",e[e.ascx=107]="ascx",e[e.asm=108]="asm",e[e.asp=109]="asp",e[e.awk=110]="awk",e[e.bas=111]="bas",e[e.bash=112]="bash",e[e.bash_login=113]="bash_login",e[e.bash_logout=114]="bash_logout",e[e.bash_profile=115]="bash_profile",e[e.bashrc=116]="bashrc",e[e.bat=117]="bat",e[e.bib=118]="bib",e[e.bsh=119]="bsh",e[e.build=120]="build",e[e.builder=121]="builder",e[e.c=122]="c",e[e.capfile=123]="capfile",e[e.cbk=124]="cbk",e[e.cc=125]="cc",e[e.cfc=126]="cfc",e[e.cfm=127]="cfm",e[e.cfml=128]="cfml",e[e.cl=129]="cl",e[e.clj=130]="clj",e[e.cmake=131]="cmake",e[e.cmd=132]="cmd",e[e.coffee=133]="coffee",e[e.cpp=134]="cpp",e[e.cpt=135]="cpt",e[e.cpy=136]="cpy",e[e.cs=137]="cs",e[e.cshtml=138]="cshtml",e[e.cson=139]="cson",e[e.csproj=140]="csproj",e[e.css=141]="css",e[e.ctp=142]="ctp",e[e.cxx=143]="cxx",e[e.d=144]="d",e[e.ddl=145]="ddl",e[e.dif=146]="dif",e[e.diff=147]="diff",e[e.disco=148]="disco",e[e.dml=149]="dml",e[e.dtd=150]="dtd",e[e.dtml=151]="dtml",e[e.el=152]="el",e[e.emake=153]="emake",e[e.erb=154]="erb",e[e.erl=155]="erl",e[e.f90=156]="f90",e[e.f95=157]="f95",e[e.fluid=158]="fluid",e[e.fs=159]="fs",e[e.fsi=160]="fsi",e[e.fsscript=161]="fsscript",e[e.fsx=162]="fsx",e[e.gemfile=163]="gemfile",e[e.gemspec=164]="gemspec",e[e.gitconfig=165]="gitconfig",e[e.go=166]="go",e[e.groovy=167]="groovy",e[e.gvy=168]="gvy",e[e.h=169]="h",e[e.haml=170]="haml",e[e.handlebars=171]="handlebars",e[e.hbs=172]="hbs",e[e.hrl=173]="hrl",e[e.hs=174]="hs",e[e.htc=175]="htc",e[e.hxx=176]="hxx",e[e.idl=177]="idl",e[e.iim=178]="iim",e[e.inc=179]="inc",e[e.inf=180]="inf",e[e.ini=181]="ini",e[e.inl=182]="inl",e[e.ipp=183]="ipp",e[e.ipynb=184]="ipynb",e[e.irbrc=185]="irbrc",e[e.jade=186]="jade",e[e.jav=187]="jav",e[e.java=188]="java",e[e.jfif=189]="jfif",e[e.js=190]="js",e[e.json=191]="json",e[e.jsp=192]="jsp",e[e.jsx=193]="jsx",e[e.l=194]="l",e[e.less=195]="less",e[e.lhs=196]="lhs",e[e.lisp=197]="lisp",e[e.log=198]="log",e[e.lst=199]="lst",e[e.ltx=200]="ltx",e[e.lua=201]="lua",e[e.m=202]="m",e[e.make=203]="make",e[e.markdn=204]="markdn",e[e.mdown=205]="mdown",e[e.mkdn=206]="mkdn",e[e.ml=207]="ml",e[e.mli=208]="mli",e[e.mll=209]="mll",e[e.mly=210]="mly",e[e.mm=211]="mm",e[e.mud=212]="mud",e[e.nfo=213]="nfo",e[e.opml=214]="opml",e[e.osascript=215]="osascript",e[e.out=216]="out",e[e.p=217]="p",e[e.pas=218]="pas",e[e.patch=219]="patch",e[e.php=220]="php",e[e.php2=221]="php2",e[e.php3=222]="php3",e[e.php4=223]="php4",e[e.php5=224]="php5",e[e.pl=225]="pl",e[e.plist=226]="plist",e[e.pm=227]="pm",e[e.pod=228]="pod",e[e.pp=229]="pp",e[e.profile=230]="profile",e[e.properties=231]="properties",e[e.ps=232]="ps",e[e.ps1=233]="ps1",e[e.pt=234]="pt",e[e.py=235]="py",e[e.pyw=236]="pyw",e[e.r=237]="r",e[e.rake=238]="rake",e[e.rb=239]="rb",e[e.rbx=240]="rbx",e[e.rc=241]="rc",e[e.re=242]="re",e[e.readme=243]="readme",e[e.reg=244]="reg",e[e.rest=245]="rest",e[e.resw=246]="resw",e[e.resx=247]="resx",e[e.rhtml=248]="rhtml",e[e.rjs=249]="rjs",e[e.rprofile=250]="rprofile",e[e.rpy=251]="rpy",e[e.rss=252]="rss",e[e.rst=253]="rst",e[e.rxml=254]="rxml",e[e.s=255]="s",e[e.sass=256]="sass",e[e.scala=257]="scala",e[e.scm=258]="scm",e[e.sconscript=259]="sconscript",e[e.sconstruct=260]="sconstruct",e[e.script=261]="script",e[e.scss=262]="scss",e[e.sgml=263]="sgml",e[e.sh=264]="sh",e[e.shtml=265]="shtml",e[e.sml=266]="sml",e[e.sql=267]="sql",e[e.sty=268]="sty",e[e.tcl=269]="tcl",e[e.tex=270]="tex",e[e.text=271]="text",e[e.textile=272]="textile",e[e.tld=273]="tld",e[e.tli=274]="tli",e[e.tmpl=275]="tmpl",e[e.tpl=276]="tpl",e[e.txt=277]="txt",e[e.vb=278]="vb",e[e.vi=279]="vi",e[e.vim=280]="vim",e[e.wsdl=281]="wsdl",e[e.xaml=282]="xaml",e[e.xhtml=283]="xhtml",e[e.xoml=284]="xoml",e[e.xml=285]="xml",e[e.xsd=286]="xsd",e[e.xsl=287]="xsl",e[e.xslt=288]="xslt",e[e.yaml=289]="yaml",e[e.yaws=290]="yaws",e[e.yml=291]="yml",e[e.zsh=292]="zsh",e[e.htm=293]="htm",e[e.html=294]="html",e[e.markdown=295]="markdown",e[e.md=296]="md",e[e.url=297]="url",e[e.one=298]="one",e[e.note=299]="note"}(a||(a={}))},71629:(e,t,n)=>{"use strict";n.d(t,{le:()=>i,bx:()=>a,Np:()=>o});const i={filePickerSource:{upload_from_pc:"upload_from_pc",share_from_odb:{key:"share_from_odb",sourceName:"OneDrive",icon:"fluent-onedrive"}},telemetry:{errorCodes:{messageSentBeforeSyncLinkConversion:"MessageAlreadySent",asyncLinkConversionPretransformFailure:"PretransformRuntimeError",asyncLinkMultiplePretransform:"MultiplePretransform",fileSharingErrorBoundaryError:"FileSharingErrorBoundaryError",asyncImportFailed:"AsyncImportFailed",pickerLocaleLoadFailed:"PickerLocaleLoadFailed",itemsViewStringsNotPresentInWindow:"ItemsViewStringsNotPresentInWindow",siteInfoError:"SiteInfoError"},errors:{messageSentBeforeLinkConversion:"message_sent_before_link_conversion"},markers:{async_bundle_import_start:"async_bundle_import_start",async_bundle_import_complete:"async_bundle_import_complete",picker_locale_load_start:"locale_load_start",picker_locale_retry:"picker_locale_retry",picker_locale_load_end:"picker_locale_load_end",items_view_strings_loaded_on_host:"items_view_strings_loaded_on_host",items_view_strings_loaded_on_parent:"items_view_strings_loaded_on_parent"},reasons:{async_bundle_import_fail:"async_bundle_import_fail",picker_locale_load_fail:"picker_locale_load_fail",error_loading_component_package:"error_loading_component_package"}},localeRetries:1,asyncLinkToChicletConversionIdentifier:"unprocessed-filelink"};var a,o;!function(e){e.Treatment="TEAMS-TREATMENT",e.Control="TEAMS-CONTROL"}(a||(a={})),function(e){e.teamsElectron="TEAMS-ELECTRON",e.teamsWeb="TEAMS-WEB"}(o||(o={}))},866020:(e,t,n)=>{"use strict";n.d(t,{gD:()=>u,fM:()=>m});var i=n(537329),a=n(119064);const o=new RegExp(a.yH.oneNoteTargetRegex),r=new RegExp(a.yH.oneNoteSectionRegex),s=e=>{const t=o.exec(e);let n="";return t&&(n=t[1]),n},l=e=>{const t=r.exec(e);let n="";return t&&(n=t[1]),n},c=new RegExp(a.yH.oneDriveFile),d=new RegExp(a.yH.sharePointFile),u=(e,t,n)=>{const o=(0,i.Q)(e),r=o?o.replace(a.yH.trailingSlashRegex,""):"";let s=null;if(c.test(e)){s={sourceTeamName:a.HV.personal,sourceChannelName:r.split("/").pop()}}else if(d.test(e)){const t=r.split("/").pop()||"",n=2;s={sourceTeamName:decodeURIComponent(t),sourceChannelName:decodeURIComponent(e.substring(r.length-1).split("/")[n])}}if(t===a.BY.extension&&-1!==(null==n?void 0:n.indexOf(a.BY.extensionWithDot))){const e=p(n);(null==e?void 0:e.sectionGroup)&&s&&(s.sourceChannelName=`${s.sourceChannelName} > ${e.sectionGroup}`),(null==e?void 0:e.section)&&s&&(s.sourceChannelName=`${s.sourceChannelName} > ${e.section}`)}return s},m=(e,t)=>{let n=null;const i=decodeURIComponent(e);let a=s(i),o=l(a),r="";if(o.includes("/")){const e=o.lastIndexOf("/");a=a.substring(e+1),o=o.substring(e+1)}const c=t;t=o;const d=a.indexOf("/");if(-1!==d){const e=a.lastIndexOf("|");t=a.substring(d+1,e),r=o}return n={title:t,noteBook:c,section:r},n},p=e=>{let t=null,n="",i="",a="";e&&(n=decodeURIComponent(e));let o=s(n),r=l(o);if(r.includes("/")){const e=r.lastIndexOf("/");if(a=r.substring(0,e),a){const e=a.split("/");let t="";e.forEach((e=>{t=""===t?e:`${t} > ${e}`})),a=t}o=o.substring(e+1),r=r.substring(e+1)}return-1!==o.indexOf("/")&&(i=r),t={sectionGroup:a,section:i},t}},537329:(e,t,n)=>{"use strict";n.d(t,{Q:()=>r});var i=n(119064);const a=new RegExp(i.yH.oneDriveFile),o=new RegExp(i.yH.sharePointFile),r=(e,t)=>{if(t){const n=t.replace(i.yH.leadingAndTrailingSlashesRegex,"").split("/");n.pop();const a=n.join("/");return`${new URL(e).origin}/${a}/`}if(o.test(e)){const t=e.match(o);return t?t[0]:null}if(a.test(e)){const t=e.match(a);return t?t[0]:null}return e}},702482:(e,t,n)=>{"use strict";n.d(t,{W$:()=>a,mD:()=>o});var i=n(892891);const a=e=>{const t=/\ \(([1-9]\d*)\)$/g;let n=1,i=(e=>{if(e){if(-1===e.indexOf("."))return e;{const t=/(.+)\.[^.]+$/.exec(e);if(null==t)return e;{const e=t[1];return void 0!==e?e:""}}}return""})(e);const a=t.exec(i);if(a){const e=i.search(t);n=parseInt(a[1],10)+1,i=i.substring(0,e)}return`${i} (${n}).${o(e)}`},o=e=>{const t=new RegExp("(?:\\.([^.]+))?$").exec(e);return(0,i.toLower)(t&&t[1]?t[1]:"")}},119064:(e,t,n)=>{"use strict";n.d(t,{as:()=>i,Ho:()=>a,HV:()=>o,Hr:()=>r,yH:()=>s,v$:()=>l,wg:()=>c,BY:()=>d,Y_:()=>u,Bx:()=>m,MI:()=>p,Aq:()=>g,N0:()=>h,BS:()=>v,Fk:()=>f,Z2:()=>y,Z$:()=>S,ov:()=>k,Mc:()=>b,p5:()=>_,xK:()=>C,_v:()=>w});const i={url:{getDriveItemAndPermissions:"/_api/v2.0/shares/{shareID}",fetchShareInfo:"/_api/v2.0/shares/{shareID}/driveItem",getDriveItemWithId:"/_api/v2.0/sites/root/items/{fileId}/driveItem",defaultPermissionsWithFileId:"/_api/v2.0/sites/root/items/{fileID}/driveItem/commands",getLinkPermissions:"/_api/v2.0/shares/{shareID}/permission",fetchVideoInfoWithThumbnails:"/_api/v2.0/shares/{shareID}/driveItem?$expand=thumbnails"}},a={THREAD_ID_UPDATE_URL:"beta/teams/recent/files/backfillSpoIds?threadId={channelThreadId}",THREAD_ID_UPDATE_APINAME:"backfillSpoIds"},o={personal:"personal",teams:"teams"},r={bim:"bim",mw:"mw",ns:"ns"},s={leadingAndTrailingSlashesRegex:/(^\/|\/$)/g,oneDriveFile:`.*/${o.personal}/[^/]*/`,sharePointFile:`.*/(${o.teams}|sites)/[^/]*/`,trailingSlashRegex:/\/$/,oneNoteTargetRegex:/target\((.*)\/\)/,oneNoteSectionRegex:/(.*).one\|/,title:/^[^\\\/\:\*\?\"\<\>\|\#\%\t]*$/},l={personal:"personal",sharePoint:"share-point"},c={states:{active:"active",deleted:"deleted",reference:"reference",removed:"removed"}},d={type:"oneNote",extension:"one",extensionWithDot:".one"},u={editInTeams:"EditInTeams",openInOfficeOnline:"OpenInOfficeOnline",openInOfficeClient:"OpenInOfficeClient"},m={clientError:-1,ok:200,badRequest:400,unauthorizedAccess:401,forbidden:403,notFound:404,notAcceptable:406,conflict:409,locked:423,tooManyRequests:429,internalServerError:500,serviceUnavailable:503,notModified:304},p={uploadCancelled:"UPLOAD_CANCELLED",conflicted:"-2130575257",conflicted_v2:"-2147024816",folderDoesNotExist:"-2147024893",locked:"-2147018894",spQuotaReached:"-2147023080",fileNotFound:"-2130575338",fileAccessDenied:"FileAccessDenied",sessionInProgress:"-2130575142",unauthorizedAccessException:"-2147024891",cobaltException:"-1, Cobalt.ErrorException",resourceLockedException:"-2147018887",audienceUriValidationFailedException:"Microsoft.IdentityModel.Tokens.AudienceUriValidationFailedException",siteRenameFailure:"-2147024809"};var g,h,v,f;!function(e){e.filePropertiesMissing="FILE_PROPERTIES_MISSING",e.maxFilesAttachment="MAX_FILES_ATTACHMENT",e.nullFiles="NULL_FILES",e.zeroSizeFile="ZERO_SIZE_FILE",e.titleContainSpecialCharacter="TITLE_CONTAIN_SPECIAL_CHARACTER",e.blacklistedFiletype="BLACK_LIST_FILE_TYPE",e.fileNameTooLong="FILE_NAME_TOO_LONG",e.siteInfoNotFound="SITE_INFO_NOT_FOUND",e.spQuotaReached="SP_QUOTA_REACHED",e.fileNotPresent="FILE_NOT_PRESENT",e.fileAccessDenied="FILE_ACCESS_DENIED",e.fileLocked="FILE_LOCKED",e.siteNotProvisioned="SITE_NOT_PROVISIONED",e.siteNotProvisionedSubtext="SITE_NOT_PROVISIONED_SUBTEXT",e.channelSiteNotProvisioned="CHANNEL_SITE_NOT_PROVISIONED",e.channelSiteNotProvisionedSubtext="CHANNEL_SITE_NOT_PROVISIONED_SUBTEXT",e.fileAlreadyAttachedInMessage="FILE_WITH_SAME_NAME_ALREADY_ATTACHED_IN_MESSAGE",e.audienceUriValidationFailed="INVALID_AUDIENCE_URI"}(g||(g={})),function(e){e.UNKNOWN_UPLOAD_ERROR="UNKNOWN_UPLOAD_ERROR"}(h||(h={})),function(e){e.InvalidRequest="invalidRequest",e.Unhandled="Unhandled"}(v||(v={})),function(e){e.ShareLinkCSL="files_messages_sharelink_cs",e.ShareLinkPSLWithoutIndividualAccess="files_messages_sharelink_psl_without_individual_access",e.ShareLinkPSLWithoutIndividualWrite="files_messages_sharelink_psl_without_individual_write_access",e.ShareLinkPSLWithoutFutureAccess="files_messages_sharelink_psl_without_future_access",e.ShareLinkPSLWithoutFullAndFutureAccess="files_messages_sharelink_psl_without_full_and_future_access",e.ShareLinkPSLWithoutWriteAndFutureAccess="files_messages_sharelink_psl_without_write_and_future_access"}(f||(f={}));const y=100,S=10485760,k=12e4,b=3e5,_=600;var C;!function(e){e.GRAPH_URL_KEY="@microsoft.graph.downloadUrl",e.CONTENT_URL_KEY="@content.downloadUrl"}(C||(C={}));const w="/_layouts/15/Doc.aspx?OR=teams&action=edit&sourcedoc="},22287:(e,t,n)=>{"use strict";var i;n.d(t,{z:()=>i}),function(e){e.logErrorMessage="logErrorMessage",e.internalErrorCode="internalErrorCode",e.correlationId="correlationId",e.httpCode="httpCode"}(i||(i={}))},940141:(e,t,n)=>{"use strict";n.d(t,{X:()=>a});var i=n(119064);const a=e=>{switch(e){case i.Bx.clientError:case i.Bx.badRequest:case i.Bx.internalServerError:case i.Bx.serviceUnavailable:case i.Bx.tooManyRequests:case i.Bx.unauthorizedAccess:return!0;default:return!1}}},799533:(e,t,n)=>{"use strict";n.d(t,{V:()=>s});var i=n(22287),a=n(940141),o=n(119064),r=n(775214);const s=(e,t,n)=>{const s=c(e),d=(0,r.O$)(e,i.z.internalErrorCode),u=(0,r.O$)(e,i.z.httpCode,(null==e?void 0:e.code)||d||""),m={errorMessage:s,serverRequestId:(0,r.O$)(e,i.z.correlationId)};t(s),(0,a.X)(parseInt(u||"",10))&&!l(parseInt(u||"",10),d)?n&&n.fail({errors:JSON.stringify(m),errorCode:`${u}`}):n&&n.incomplete({errors:JSON.stringify(m),errorCode:`${u||o.BS.Unhandled}`})},l=(e,t)=>e&&e===o.Bx.badRequest&&t&&t===o.BS.InvalidRequest,c=e=>{let t=(0,r.O$)(e,i.z.logErrorMessage,(null==e?void 0:e.message)||"");const n=(0,r.O$)(e,"innerError",{message:""});t=`${t}. ${n?n.message:""}`;const a={context:null==e?void 0:e.context,subContext:null==e?void 0:e.subContext};return t=`${t}. ${JSON.stringify(a)}`,t}},783642:(e,t,n)=>{"use strict";var i;n.d(t,{zj:()=>i,Dx:()=>a,$4:()=>o}),function(e){e.color="color",e.bgColor="background-color",e.background="background",e.itemProps="data-itemprops",e.itemtype="itemtype",e.mentionId="data-mention-id",e.height="height",e.itemid="itemid",e.itemscope="itemscope",e.src="src",e.style="style",e.width="width",e.alt="alt",e.mri="mri",e.stale="stale",e.type="type",e.originalSrc="originalsrc",e.cacheKey="data-cache-key",e.duration="data-duration",e.uploadProgress="data-upload-progress",e.thumbnailUploadProgress="data-thumbnail-upload-progress"}(i||(i={}));const a=["abbr","align","alt","axis","aria-label","bgcolor","border","cellpadding","cellspacing","class","clear","color","cols","colspan","compact","content","contenteditable","coords","data-ams-src","data-duration","data-itemprops","data-preview-src","data-src","data-ts-imgid","data-ts-imglen","dir","face","fluid-url","headers","height","href","hreflang","hspace","id","ismap","itemid","itemprop","itemscope","itemtype","lang","language","nohref","nowrap","rel","rev","rows","rowspan","rules","scope","scrolling","shape","size","span","src","start","style","summary","target","title","type","usemap","valign","value","vspace","width",...[i.mri,i.type,i.originalSrc,i.stale,i.cacheKey]],o="data-ignore-semantic-link"},147623:(e,t,n)=>{"use strict";var i;n.d(t,{s:()=>i,e:()=>o}),function(e){e.span="span",e.mention="mention",e.sematicObject="semantic-object",e.card="card",e.readonly="readonly",e.spacer="spacer",e.video="video"}(i||(i={}));const a=[i.mention,i.sematicObject,i.card,i.readonly,i.spacer,i.video],o=["a","abbr","acronym","address","area","article","aside","b","bdi","bdo","big","blockquote","br","caption","center","cite","code","col","colgroup","dd","del","dfn","dir","div","dl","dt","em","figcaption","figure","font","footer","h1","h2","h3","h4","h5","h6","header","hgroup","hr","i","img","img","ins","kbd","label","li","map","map","mark","menu","nav","ol","p","pre","q","rp","rp","rt","rt","ruby","s","samp","section","small",i.span,"strike","strong","sub","sup","table","tbody","td","tfoot","th","thead","time","tr","tt","u","ul","var","wbr",...a]},533439:(e,t,n)=>{"use strict";var i;n.d(t,{T:()=>i}),function(e){e.mention="http://schema.skype.com/Mention",e.inputExtension="http://schema.skype.com/InputExtension",e.amsVideo="http://schema.skype.com/AMSVideo",e.amsImage="http://schema.skype.com/AMSImage",e.emoji="http://schema.skype.com/Emoji",e.live="http://schema.skype.com/Live",e.giphy="http://schema.skype.com/Giphy",e.filesHyperlink="http://schema.skype.com/HyperLink/Files",e.hyperLink="http://schema.skype.com/HyperLink",e.reply="http://schema.skype.com/Reply",e.fluidLink="http://schema.skype.com/FluidLink",e.cachedImage="http://schema.skype.com/CachedImage",e.scheduledMeetingCreated="http://schema.skype.com/ScheduledMeetingCreated",e.scheduledMeetingUpdated="http://schema.skype.com/ScheduledMeetingUpdated",e.scheduledMeetingCancelled="http://schema.skype.com/ScheduledMeetingCancelled"}(i||(i={}))},854479:(e,t,n)=>{"use strict";n.d(t,{qB:()=>i,rF:()=>a,IJ:()=>o,Zw:()=>r});const i={SSO_TOKEN:"OutlookSSOToken",ADDIN_ERROR:"OutlookAddInError",SSO_READY:"OutlookSSOReady",USE_CACHED_SSO_TOKEN:"OutlookUseCachedSSOToken",SSO_COMPLETE_TIME:"OutlookSSOCompleteTime",DIALOG_TRIGGER_TIME:"OutlookDialogTriggerTime",CONTEXT:"STTOutlookContext",STEP_MARKERS:"STTOutlookStepMarkers",AUTH_STRAP_ERROR:"STTOutlookAuthStrapError",AUTH_STRAP_REDIRECT_TIME:"STTOutlookAuthStrapRedirect",OAUTH_START_TIME:"OutlookOAuthStartTime",OAUTH_ELAPSED_TIME:"OutlookOAuthElapsedTime",PLATFORM_INFO:"OutlookPlatformInfo",STT_START_TIME:"STTExperienceStartTime"};var a,o,r;!function(e){e[e.HOURS_PER_DAY=24]="HOURS_PER_DAY",e[e.MINUTES_PER_HOUR=60]="MINUTES_PER_HOUR",e[e.SECONDS_PER_MINUTE=60]="SECONDS_PER_MINUTE",e[e.MILLISECS_PER_SECOND=1e3]="MILLISECS_PER_SECOND",e[e.TOKEN_EXP_MINUTE=10]="TOKEN_EXP_MINUTE",e[e.SSO_TIMEOUT_MILLISEC=7e3]="SSO_TIMEOUT_MILLISEC",e[e.SSO_RETRY_INTERVAL=100]="SSO_RETRY_INTERVAL",e[e.SSO_CLAIM_TIMEOUT_MINUTES=5]="SSO_CLAIM_TIMEOUT_MINUTES",e[e.SSO_CLAIM_TIMEOUT_MILLISEC=3e5]="SSO_CLAIM_TIMEOUT_MILLISEC",e[e.SSO_CLAIM_RETRY_INTERVAL=1e3]="SSO_CLAIM_RETRY_INTERVAL",e[e.STT_USAGE_EXPIRATION_DAYS=15]="STT_USAGE_EXPIRATION_DAYS",e[e.STT_USAGE_EXPIRATION_MILLISEC=1296e6]="STT_USAGE_EXPIRATION_MILLISEC"}(a||(a={})),function(e){e.NotProvided="NotProvided",e.Expired="Expired",e.Valid="Valid",e.Invalid="Invalid"}(o||(o={})),function(e){e.SSO="SSO",e.OAuth="OAuth"}(r||(r={}))},823845:(e,t,n)=>{"use strict";n.d(t,{EG:()=>a,of:()=>s,_7:()=>l,Ol:()=>c});var i=n(955731);const a=e=>Boolean(e&&e.startsWith(i.V.Pstn)),o=/4:[^-_]*-[^-_]*-[^-_]*-[^-_]*-.*/,r=e=>e.indexOf("_"),s=e=>{const t=e.slice(i.V.Pstn.length);return-1!==r(t)},l=(e,t)=>o.test(e)&&t,c=e=>{let t=e.slice(i.V.Pstn.length);const n=r(t);return-1!==n&&(t=t.slice(0,n)),t}},927346:(e,t,n)=>{"use strict";function i(e=1){const t=new Uint32Array(e),i=n.g;if(i.msCrypto)i.msCrypto.getRandomValues(t);else if(i.crypto)i.crypto.getRandomValues(t);else{let n=e;for(;n--;){const e=4294967296;t[n]=Math.floor(Math.random()*e)}}return Array.from(t)}n.d(t,{M:()=>i})},355304:(e,t,n)=>{"use strict";n.d(t,{G:()=>o});var i=n(632585),a=n(384986);const o=e=>e instanceof i.xQ?e.asObservable():e instanceof a.y?e:new a.y((t=>e.subscribe(t)))},324273:(e,t,n)=>{"use strict";n.d(t,{j:()=>r});var i=n(136295),a=n(226568),o=n(895725);const r=(e,t,n,r)=>(0,i.z)((0,a.R)(((n,i)=>Array.from(function*(e,t,n,i){const a=e[Symbol.iterator](),o=t[Symbol.iterator]();let r=a.next(),s=o.next();for(;!s.done||!r.done;)s.done||!r.done&&s.value.id>r.value[0].id?(i(r.value[1]),r=a.next()):r.done||s.value.id<r.value[0].id?(yield[s.value,n(s.value)],s=o.next()):(yield[s.value,r.value[1]],r=a.next(),s=o.next())}(n,Array.from(i).sort(((e,t)=>e.id.localeCompare(t.id))),(t=>{try{return{type:"value",value:e(t)}}catch(e){return r&&r(t,e),{type:"error",error:e}}}),(e=>{if("error"!==e.type)return t(e.value)})))),[]),(0,o.U)((e=>e.filter((e=>"value"===e[1].type)).map((e=>n(e[0],e[1].value))))))},636554:(e,t,n)=>{"use strict";n.d(t,{hN:()=>i,jE:()=>o,mo:()=>d,Np:()=>v,cE:()=>y,cI:()=>b,t_:()=>_,gC:()=>T});var i,a,o,r=n(143028),s=n(272009),l=n(892891),c=n(189901);!function(e){e.TeamsOnly="TeamsOnly",e.SfBOnly="SfBOnly",e.SfBWithTeamsCollab="SfBWithTeamsCollab",e.SfBWithTeamsCollabAndMeetings="SfBWithTeamsCollabAndMeetings",e.Islands="Islands",e.IslandsWithTempInterop="IslandsWithTempInterop",e.IslandsWithVoipDeepLinking="IslandsWithVoipDeepLinking"}(i||(i={})),function(e){e[e.Islands=1]="Islands",e[e.IslandsWithTempInterop=2]="IslandsWithTempInterop",e[e.IslandsWithVoipDeepLinking=3]="IslandsWithVoipDeepLinking",e[e.SfBOnly=4]="SfBOnly",e[e.SfBWithTeamsCollab=5]="SfBWithTeamsCollab",e[e.SfBWithTeamsCollabAndMeetings=6]="SfBWithTeamsCollabAndMeetings",e[e.TeamsOnly=7]="TeamsOnly",e[e.Legacy=8]="Legacy"}(a||(a={})),function(e){e[e.Teams=0]="Teams",e[e.SfB=1]="SfB",e[e.Federated=2]="Federated",e[e.NativeFederated=3]="NativeFederated"}(o||(o={}));const d=e=>!!(e&&e.coExistenceMode&&i[e.coExistenceMode]),u=e=>!(e!==i.TeamsOnly),m=e=>!(-1===[i.Islands,i.IslandsWithTempInterop,i.IslandsWithVoipDeepLinking].indexOf(e)),p=e=>!(-1===[i.SfBOnly,i.SfBWithTeamsCollab,i.SfBWithTeamsCollabAndMeetings].indexOf(e)),g=(e,t,n=!1)=>{const i=[r.Jq,r.Dr,r.iO],a=e.split(":");return i.some((e=>{const i=a.findIndex((t=>t===e.slice(0,-1)));return i>=0&&(n?a.splice(i+1,1):a.splice(i+1,0,t.slice(0,-1)),!0)})),a.join(":")},h=e=>!!e&&!(0,l.startsWith)(r.at.SkypeSpacesUser+r.pW,e)&&e.includes(r.pW),v=e=>!e||h(e)?e:e.includes(r.at.SkypeSpacesUser)?g(e,r.pW):void 0,f=e=>!!e&&!(0,l.startsWith)(r.at.SkypeSpacesUser+r.m_,e)&&e.includes(r.m_),y=e=>!e||f(e)?e:e.includes(r.at.SkypeSpacesUser)?g(e,r.m_):void 0,S=e=>{if(e){if(h(e))return g(e,r.pW,!0);if(f(e))return g(e,r.m_,!0)}return e},k={isAllowed:!1},b=(e,t,n,i,a,o,r,s)=>{const l=r&&r.coExistenceMode,c=o&&o.coExistenceMode;if(!l||!c)return{isAllowed:!0};if(i){const i=((e,t,n,i,a,o,r)=>{const s=r.newLogger("sfb-interop");return o.isFederated?i?o.coExistenceMode&&a.coExistenceMode?e&&n&&u(a.coExistenceMode)&&u(o.coExistenceMode)?{isAllowed:!1,mri:y(o.mri||"")}:n||t||!m(a.coExistenceMode)&&!m(o.coExistenceMode)?!n&&p(o.coExistenceMode)?{isAllowed:!1,toInterop:!0,mri:o.mri||""}:{isAllowed:!0}:{isAllowed:!1,toInterop:!0,mri:o.mri}:(s.log("Chat Enabled: TeamsUpgradePolicy is not defined for both users"),{isAllowed:!0}):(s.log("Chat Disabled: current user is not provisioned on Sfb online"),k):(s.log("Federated Chat Disabled: recipient user is not federated"),(e=>({isAllowed:!1,toInterop:!1,mri:e.mri}))(o))})(e,t,n,a,o,r,s);if(!i.isAllowed)return i}else{const e=((e,t)=>t.coExistenceMode?e&&u(t.coExistenceMode)?{isAllowed:!1,mri:S(t.mri||"")}:!e&&p(t.coExistenceMode)?{isAllowed:!1,mri:v(t.mri||""),toInterop:!0}:{isAllowed:!0}:{isAllowed:!0})(n,r);if(!e.isAllowed)return e}return{isAllowed:!0}},_=e=>{const t=f(e);return C(e)||h(e)||t?t?e.replace(r.m_,""):e.replace(r.pW,"").replace(r.zt,""):e},C=e=>!!e&&!(0,l.startsWith)(r.at.SkypeSpacesUser+r.zt,e)&&e.includes(r.zt),w=(e,t,n,i)=>{const o=e.isFederated,r=(s=e.mri||"",(0,l.endsWith)(s,"@sfbonprem.unq.gbl.spaces"));var s;if(t&&o&&!r&&e.coExistenceMode){const t=a[e.coExistenceMode],o=n===a.TeamsOnly&&t===a.TeamsOnly;return o||i.log(`isNativeFederationMode is false - currentUserMessagingPolicyMode:${a[n]} recipientCoexistenceMode:${a[t]}`),o}return i.log(`isNativeFederationMode is false - enableNativeP2PFederatedChats:${t} isFederated:${o} isOnPremFederated:${r} coExistenceMode:${e.coExistenceMode}`),!1},T=(e,t,n,i,r,l)=>{if(!(e&&e.mri&&e.userType!==c.vf.guest&&e.type!==c.vf.skypeConsumer&&e.type!==c.vf.tflUser&&(0,s.eZ)(e.mri)))return n.log("getUserChatMode - Defaulting to teams chat mode as user profile is undefined or Guest or TFL user or is not a real user mri"),o.Teams;if(e.isFederated)return n.log(`getUserChatMode - federated user - mri: ${e.mri}, coExistenceMode: ${e.coExistenceMode}`),w(e,r,l,n)?o.NativeFederated:o.Federated;const d=((e,t,n)=>{const i=e.coExistenceMode,r=a[i];if(n.log(`getCoexistenceChatMode - caller: ${t}, mri: ${e.mri}, isShortProfile: ${e.isShortProfile}, coExistenceMode: ${a[r]}, MT coExistenceMode: ${i}`),a[r]!==i&&n.error(`getUserChatMode - Mapping error - coExistenceMode : ${a[r]}, MT coExistenceMode: ${i}`),r){const e=[a.SfBOnly,a.SfBWithTeamsCollab,a.SfBWithTeamsCollabAndMeetings],t=[a.TeamsOnly,a.Islands,a.IslandsWithVoipDeepLinking];if(e.includes(r))return o.SfB;if(t.includes(r))return o.Teams;n.warn(`getUserChatMode - unknown coExistenceMode ${a[r]}`)}else e.isShortProfile||n.warn(`getUserChatMode - full profile has no coExistenceMode for mri ${e.mri}`)})(e,t,n);if(d)return d;const u=h(e.mri),m=e.isSkypeTeamsUser,p=(e=>!(!e.isFederated&&void 0!==e.isPrivateChatEnabled)||e.isPrivateChatEnabled)(e);return n.log(`getUserChatMode - caller: ${t}, mri: ${e.mri}, isSfbMri: ${u}, isTeamsChatEnabled: ${p}, hasLoggedInToTeams: ${m}, isSipDisabled: ${e.isSipDisabled}, isSfBEligible: ${i}`),!u&&m&&p||e.isSipDisabled||!i?o.Teams:o.SfB}},823931:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(545319);const a=(e,t)=>{try{return e.matchMedia(i.s0.ColorContrastOverride).matches?i.f8.Contrast:e.matchMedia(i.s0.Dark).matches?i.f8.Dark:i.f8.Light}catch(e){return void(null==t||t.log(`Couldn't resolve getOsTheme: ${e.message}`))}}},916501:(e,t,n)=>{"use strict";n.d(t,{as:()=>i});const i=(e,t)=>{if(e.is(t))return t;throw new TypeError}},122057:(e,t,n)=>{var i={"./ar-sa/activity.js":[null],"./ar-sa/auth.js":[null],"./ar-sa/autosuggest.js":[null],"./ar-sa/avatar.js":[607748,25622],"./ar-sa/biometric-enrollment.js":[772192,75363],"./ar-sa/breakout-rooms.js":[992492,14646],"./ar-sa/broadcast.js":[567708,10412],"./ar-sa/calendar.js":[864153,42143],"./ar-sa/calling.js":[195108,96624],"./ar-sa/cast.js":[74267,63408],"./ar-sa/channels.js":[141251,38457],"./ar-sa/chat-list.js":[445002,89649],"./ar-sa/coach-report.js":[null],"./ar-sa/compose.js":[548512,89649],"./ar-sa/contacts.js":[null],"./ar-sa/datepicker.js":[316194,82989],"./ar-sa/desktop.js":[null],"./ar-sa/digital-signage.js":[null],"./ar-sa/edu.js":[934064,31513],"./ar-sa/embed.js":[null],"./ar-sa/errors.js":[null],"./ar-sa/esp.js":[601750,10828],"./ar-sa/extensibility-ptz-extension.js":[null],"./ar-sa/extensibility-room-remote.js":[null],"./ar-sa/extensibility.js":[114969,385],"./ar-sa/files.js":[832242,74574],"./ar-sa/framework.js":[6173,25622],"./ar-sa/freemium.js":[null],"./ar-sa/funstuff.js":[137745,89649],"./ar-sa/gallery.js":[358430,74917],"./ar-sa/guardians.js":[975917,41795],"./ar-sa/hololens.js":[500181,96624],"./ar-sa/lightbox.js":[405856,89649],"./ar-sa/live-persona-card.js":[435088,25622],"./ar-sa/lms-integration.js":[null],"./ar-sa/meeting-analytics.js":[179106,629],"./ar-sa/meeting-flyout.js":[363053,31286],"./ar-sa/meeting-meet-app.js":[null],"./ar-sa/meeting-options.js":[325264,8656],"./ar-sa/meeting-room-console.js":[991860,61518],"./ar-sa/meeting-stream-app.js":[null],"./ar-sa/messaging.js":[185498,89649],"./ar-sa/nova.js":[null],"./ar-sa/people-app.js":[null],"./ar-sa/people-picker.js":[591045,25622],"./ar-sa/people-targeting.js":[967062,51704],"./ar-sa/people.js":[null],"./ar-sa/pre-core.js":[null],"./ar-sa/recurrence.js":[738554,96362],"./ar-sa/search.js":[212523,82989],"./ar-sa/semantic-object.js":[256916,4317],"./ar-sa/settings.js":[null],"./ar-sa/share-to-teams-outlook-addin.js":[null],"./ar-sa/share-to-teams.js":[455594,74853],"./ar-sa/shortcut.js":[null],"./ar-sa/survey.js":[271363,34287],"./ar-sa/sv-flyout.js":[null],"./ar-sa/teams-and-channels.js":[364241,15523],"./ar-sa/tfl-onboarding.js":[null],"./ar-sa/toast-notifications.js":[null],"./ar-sa/unified-search.js":[295939,74853],"./ar-sa/url-preview.js":[622171,89649],"./ar-sa/video-capture.js":[21592,89649],"./ar-sa/video-message.js":[131535,89649],"./ar-sa/virtual-events.js":[null],"./ar-sa/webinar.js":[987909,69621],"./az-latn-az/activity.js":[null],"./az-latn-az/auth.js":[null],"./az-latn-az/autosuggest.js":[null],"./az-latn-az/avatar.js":[455166,51822],"./az-latn-az/biometric-enrollment.js":[312605,96555],"./az-latn-az/breakout-rooms.js":[37296,59663],"./az-latn-az/broadcast.js":[242698,12243],"./az-latn-az/calendar.js":[784508,72324],"./az-latn-az/calling.js":[23929,97686],"./az-latn-az/cast.js":[429021,57545],"./az-latn-az/channels.js":[892980,20029],"./az-latn-az/chat-list.js":[935940,21632],"./az-latn-az/coach-report.js":[null],"./az-latn-az/compose.js":[459118,21632],"./az-latn-az/contacts.js":[null],"./az-latn-az/datepicker.js":[877411,80016],"./az-latn-az/desktop.js":[null],"./az-latn-az/digital-signage.js":[null],"./az-latn-az/edu.js":[581861,30236],"./az-latn-az/embed.js":[null],"./az-latn-az/errors.js":[null],"./az-latn-az/esp.js":[34051,5406],"./az-latn-az/extensibility-ptz-extension.js":[null],"./az-latn-az/extensibility-room-remote.js":[null],"./az-latn-az/extensibility.js":[639092,57900],"./az-latn-az/files.js":[305138,87808],"./az-latn-az/framework.js":[967296,51822],"./az-latn-az/freemium.js":[null],"./az-latn-az/funstuff.js":[304579,21632],"./az-latn-az/gallery.js":[13550,88146],"./az-latn-az/guardians.js":[615265,6767],"./az-latn-az/hololens.js":[381837,97686],"./az-latn-az/lightbox.js":[463515,21632],"./az-latn-az/live-persona-card.js":[20600,51822],"./az-latn-az/lms-integration.js":[null],"./az-latn-az/meeting-analytics.js":[175229,69482],"./az-latn-az/meeting-flyout.js":[893412,67997],"./az-latn-az/meeting-meet-app.js":[null],"./az-latn-az/meeting-options.js":[884935,83695],"./az-latn-az/meeting-room-console.js":[656869,64110],"./az-latn-az/meeting-stream-app.js":[null],"./az-latn-az/messaging.js":[146971,21632],"./az-latn-az/nova.js":[null],"./az-latn-az/people-app.js":[null],"./az-latn-az/people-picker.js":[257045,51822],"./az-latn-az/people-targeting.js":[33099,24677],"./az-latn-az/people.js":[null],"./az-latn-az/pre-core.js":[null],"./az-latn-az/recurrence.js":[981881,24092],"./az-latn-az/search.js":[456853,80016],"./az-latn-az/semantic-object.js":[986718,70293],"./az-latn-az/settings.js":[null],"./az-latn-az/share-to-teams-outlook-addin.js":[null],"./az-latn-az/share-to-teams.js":[673975,54423],"./az-latn-az/shortcut.js":[null],"./az-latn-az/survey.js":[772445,72479],"./az-latn-az/sv-flyout.js":[null],"./az-latn-az/teams-and-channels.js":[642409,74403],"./az-latn-az/tfl-onboarding.js":[null],"./az-latn-az/toast-notifications.js":[null],"./az-latn-az/unified-search.js":[541976,54423],"./az-latn-az/url-preview.js":[579462,21632],"./az-latn-az/video-capture.js":[97013,21632],"./az-latn-az/video-message.js":[486314,21632],"./az-latn-az/virtual-events.js":[null],"./az-latn-az/webinar.js":[469951,16804],"./bg-bg/activity.js":[null],"./bg-bg/auth.js":[null],"./bg-bg/autosuggest.js":[null],"./bg-bg/avatar.js":[571935,50747],"./bg-bg/biometric-enrollment.js":[584703,87417],"./bg-bg/breakout-rooms.js":[286088,84265],"./bg-bg/broadcast.js":[245489,43890],"./bg-bg/calendar.js":[535505,92712],"./bg-bg/calling.js":[367578,54788],"./bg-bg/cast.js":[699103,70041],"./bg-bg/channels.js":[906821,62556],"./bg-bg/chat-list.js":[334918,97436],"./bg-bg/coach-report.js":[null],"./bg-bg/compose.js":[40584,97436],"./bg-bg/contacts.js":[null],"./bg-bg/datepicker.js":[757005,93050],"./bg-bg/desktop.js":[null],"./bg-bg/digital-signage.js":[null],"./bg-bg/edu.js":[979877,6659],"./bg-bg/embed.js":[null],"./bg-bg/errors.js":[null],"./bg-bg/esp.js":[153596,87921],"./bg-bg/extensibility-ptz-extension.js":[null],"./bg-bg/extensibility-room-remote.js":[null],"./bg-bg/extensibility.js":[30873,64754],"./bg-bg/files.js":[447659,74188],"./bg-bg/framework.js":[374608,50747],"./bg-bg/freemium.js":[null],"./bg-bg/funstuff.js":[82961,97436],"./bg-bg/gallery.js":[310654,40416],"./bg-bg/guardians.js":[924970,84975],"./bg-bg/hololens.js":[722758,54788],"./bg-bg/lightbox.js":[79091,97436],"./bg-bg/live-persona-card.js":[960370,50747],"./bg-bg/lms-integration.js":[null],"./bg-bg/meeting-analytics.js":[971873,98696],"./bg-bg/meeting-flyout.js":[611422,5724],"./bg-bg/meeting-meet-app.js":[null],"./bg-bg/meeting-options.js":[786780,72333],"./bg-bg/meeting-room-console.js":[956165,20274],"./bg-bg/meeting-stream-app.js":[null],"./bg-bg/messaging.js":[153968,97436],"./bg-bg/nova.js":[null],"./bg-bg/people-app.js":[null],"./bg-bg/people-picker.js":[358008,50747],"./bg-bg/people-targeting.js":[809330,63237],"./bg-bg/people.js":[null],"./bg-bg/pre-core.js":[null],"./bg-bg/recurrence.js":[232682,4685],"./bg-bg/search.js":[185417,93050],"./bg-bg/semantic-object.js":[66619,38652],"./bg-bg/settings.js":[null],"./bg-bg/share-to-teams-outlook-addin.js":[null],"./bg-bg/share-to-teams.js":[501089,56738],"./bg-bg/shortcut.js":[null],"./bg-bg/survey.js":[82625,78864],"./bg-bg/sv-flyout.js":[null],"./bg-bg/teams-and-channels.js":[689885,30235],"./bg-bg/tfl-onboarding.js":[null],"./bg-bg/toast-notifications.js":[null],"./bg-bg/unified-search.js":[27584,56738],"./bg-bg/url-preview.js":[989155,97436],"./bg-bg/video-capture.js":[896494,97436],"./bg-bg/video-message.js":[808889,97436],"./bg-bg/virtual-events.js":[null],"./bg-bg/webinar.js":[756834,28488],"./ca-es-valencia/activity.js":[null],"./ca-es-valencia/auth.js":[null],"./ca-es-valencia/autosuggest.js":[null],"./ca-es-valencia/avatar.js":[252446,7056],"./ca-es-valencia/biometric-enrollment.js":[240891,62716],"./ca-es-valencia/breakout-rooms.js":[682573,65477],"./ca-es-valencia/broadcast.js":[748779,84441],"./ca-es-valencia/calendar.js":[945905,78220],"./ca-es-valencia/calling.js":[618139,56722],"./ca-es-valencia/cast.js":[340614,51292],"./ca-es-valencia/channels.js":[255741,89275],"./ca-es-valencia/chat-list.js":[632874,822],"./ca-es-valencia/coach-report.js":[null],"./ca-es-valencia/compose.js":[374365,822],"./ca-es-valencia/contacts.js":[null],"./ca-es-valencia/datepicker.js":[372784,1400],"./ca-es-valencia/desktop.js":[null],"./ca-es-valencia/digital-signage.js":[null],"./ca-es-valencia/edu.js":[988085,15750],"./ca-es-valencia/embed.js":[null],"./ca-es-valencia/errors.js":[null],"./ca-es-valencia/esp.js":[775643,74837],"./ca-es-valencia/extensibility-ptz-extension.js":[null],"./ca-es-valencia/extensibility-room-remote.js":[null],"./ca-es-valencia/extensibility.js":[318357,46149],"./ca-es-valencia/files.js":[226584,49808],"./ca-es-valencia/framework.js":[55604,7056],"./ca-es-valencia/freemium.js":[null],"./ca-es-valencia/funstuff.js":[628342,822],"./ca-es-valencia/gallery.js":[196271,30191],"./ca-es-valencia/guardians.js":[435602,86855],"./ca-es-valencia/hololens.js":[929743,56722],"./ca-es-valencia/lightbox.js":[405037,822],"./ca-es-valencia/live-persona-card.js":[463066,7056],"./ca-es-valencia/lms-integration.js":[null],"./ca-es-valencia/meeting-analytics.js":[396298,10652],"./ca-es-valencia/meeting-flyout.js":[626336,74449],"./ca-es-valencia/meeting-meet-app.js":[null],"./ca-es-valencia/meeting-options.js":[988223,45915],"./ca-es-valencia/meeting-room-console.js":[830171,88876],"./ca-es-valencia/meeting-stream-app.js":[null],"./ca-es-valencia/messaging.js":[3674,822],"./ca-es-valencia/nova.js":[null],"./ca-es-valencia/people-app.js":[null],"./ca-es-valencia/people-picker.js":[281561,7056],"./ca-es-valencia/people-targeting.js":[864092,31402],"./ca-es-valencia/people.js":[null],"./ca-es-valencia/pre-core.js":[null],"./ca-es-valencia/recurrence.js":[460728,91643],"./ca-es-valencia/search.js":[499971,1400],"./ca-es-valencia/semantic-object.js":[2617,17638],"./ca-es-valencia/settings.js":[null],"./ca-es-valencia/share-to-teams-outlook-addin.js":[null],"./ca-es-valencia/share-to-teams.js":[928115,906],"./ca-es-valencia/shortcut.js":[null],"./ca-es-valencia/survey.js":[794807,70706],"./ca-es-valencia/sv-flyout.js":[null],"./ca-es-valencia/teams-and-channels.js":[17256,95589],"./ca-es-valencia/tfl-onboarding.js":[null],"./ca-es-valencia/toast-notifications.js":[null],"./ca-es-valencia/unified-search.js":[451392,906],"./ca-es-valencia/url-preview.js":[275142,822],"./ca-es-valencia/video-capture.js":[547471,822],"./ca-es-valencia/video-message.js":[732839,822],"./ca-es-valencia/virtual-events.js":[null],"./ca-es-valencia/webinar.js":[34011,13478],"./ca-es/activity.js":[null],"./ca-es/auth.js":[null],"./ca-es/autosuggest.js":[null],"./ca-es/avatar.js":[596172,83240],"./ca-es/biometric-enrollment.js":[101372,6279],"./ca-es/breakout-rooms.js":[340251,27648],"./ca-es/broadcast.js":[366520,64078],"./ca-es/calendar.js":[65327,45196],"./ca-es/calling.js":[277835,96079],"./ca-es/cast.js":[806436,45882],"./ca-es/channels.js":[886868,87024],"./ca-es/chat-list.js":[668979,5599],"./ca-es/coach-report.js":[null],"./ca-es/compose.js":[961357,5599],"./ca-es/contacts.js":[null],"./ca-es/datepicker.js":[630467,99648],"./ca-es/desktop.js":[null],"./ca-es/digital-signage.js":[null],"./ca-es/edu.js":[271104,83795],"./ca-es/embed.js":[null],"./ca-es/errors.js":[null],"./ca-es/esp.js":[80584,3626],"./ca-es/extensibility-ptz-extension.js":[null],"./ca-es/extensibility-room-remote.js":[null],"./ca-es/extensibility.js":[142619,23850],"./ca-es/files.js":[908523,56481],"./ca-es/framework.js":[408222,83240],"./ca-es/freemium.js":[null],"./ca-es/funstuff.js":[187769,5599],"./ca-es/gallery.js":[380508,5363],"./ca-es/guardians.js":[129003,37232],"./ca-es/hololens.js":[178328,96079],"./ca-es/lightbox.js":[114404,5599],"./ca-es/live-persona-card.js":[784037,83240],"./ca-es/lms-integration.js":[null],"./ca-es/meeting-analytics.js":[415163,35020],"./ca-es/meeting-flyout.js":[313713,40433],"./ca-es/meeting-meet-app.js":[null],"./ca-es/meeting-options.js":[739407,17589],"./ca-es/meeting-room-console.js":[595939,73804],"./ca-es/meeting-stream-app.js":[null],"./ca-es/messaging.js":[969388,5599],"./ca-es/nova.js":[null],"./ca-es/people-app.js":[null],"./ca-es/people-picker.js":[121792,83240],"./ca-es/people-targeting.js":[908073,27639],"./ca-es/people.js":[null],"./ca-es/pre-core.js":[null],"./ca-es/recurrence.js":[698906,87237],"./ca-es/search.js":[969225,99648],"./ca-es/semantic-object.js":[697997,16676],"./ca-es/settings.js":[null],"./ca-es/share-to-teams-outlook-addin.js":[null],"./ca-es/share-to-teams.js":[716774,94772],"./ca-es/shortcut.js":[null],"./ca-es/survey.js":[92859,84765],"./ca-es/sv-flyout.js":[null],"./ca-es/teams-and-channels.js":[860774,76001],"./ca-es/tfl-onboarding.js":[null],"./ca-es/toast-notifications.js":[null],"./ca-es/unified-search.js":[790744,94772],"./ca-es/url-preview.js":[860458,5599],"./ca-es/video-capture.js":[111666,5599],"./ca-es/video-message.js":[286812,5599],"./ca-es/virtual-events.js":[null],"./ca-es/webinar.js":[745923,57405],"./cs-cz/activity.js":[null],"./cs-cz/auth.js":[null],"./cs-cz/autosuggest.js":[null],"./cs-cz/avatar.js":[569204,32076],"./cs-cz/biometric-enrollment.js":[720178,42985],"./cs-cz/breakout-rooms.js":[947363,24417],"./cs-cz/broadcast.js":[529226,95844],"./cs-cz/calendar.js":[582789,20132],"./cs-cz/calling.js":[643919,53615],"./cs-cz/cast.js":[886323,35577],"./cs-cz/channels.js":[890629,42575],"./cs-cz/chat-list.js":[901315,98170],"./cs-cz/coach-report.js":[null],"./cs-cz/compose.js":[676964,98170],"./cs-cz/contacts.js":[null],"./cs-cz/datepicker.js":[469988,284],"./cs-cz/desktop.js":[null],"./cs-cz/digital-signage.js":[null],"./cs-cz/edu.js":[951703,54980],"./cs-cz/embed.js":[null],"./cs-cz/errors.js":[null],"./cs-cz/esp.js":[539044,7536],"./cs-cz/extensibility-ptz-extension.js":[null],"./cs-cz/extensibility-room-remote.js":[null],"./cs-cz/extensibility.js":[155869,17342],"./cs-cz/files.js":[879807,38008],"./cs-cz/framework.js":[587042,32076],"./cs-cz/freemium.js":[null],"./cs-cz/funstuff.js":[883899,98170],"./cs-cz/gallery.js":[270755,62990],"./cs-cz/guardians.js":[436047,43212],"./cs-cz/hololens.js":[770883,53615],"./cs-cz/lightbox.js":[727105,98170],"./cs-cz/live-persona-card.js":[447546,32076],"./cs-cz/lms-integration.js":[null],"./cs-cz/meeting-analytics.js":[960296,11637],"./cs-cz/meeting-flyout.js":[966953,70182],"./cs-cz/meeting-meet-app.js":[null],"./cs-cz/meeting-options.js":[835352,59166],"./cs-cz/meeting-room-console.js":[250572,4818],"./cs-cz/meeting-stream-app.js":[null],"./cs-cz/messaging.js":[214264,98170],"./cs-cz/nova.js":[null],"./cs-cz/people-app.js":[null],"./cs-cz/people-picker.js":[180046,32076],"./cs-cz/people-targeting.js":[1236,40824],"./cs-cz/people.js":[null],"./cs-cz/pre-core.js":[null],"./cs-cz/recurrence.js":[582906,98857],"./cs-cz/search.js":[792429,284],"./cs-cz/semantic-object.js":[492091,85869],"./cs-cz/settings.js":[null],"./cs-cz/share-to-teams-outlook-addin.js":[null],"./cs-cz/share-to-teams.js":[359768,25532],"./cs-cz/shortcut.js":[null],"./cs-cz/survey.js":[716441,88207],"./cs-cz/sv-flyout.js":[null],"./cs-cz/teams-and-channels.js":[665418,26263],"./cs-cz/tfl-onboarding.js":[null],"./cs-cz/toast-notifications.js":[null],"./cs-cz/unified-search.js":[364298,25532],"./cs-cz/url-preview.js":[629621,98170],"./cs-cz/video-capture.js":[512694,98170],"./cs-cz/video-message.js":[216950,98170],"./cs-cz/virtual-events.js":[null],"./cs-cz/webinar.js":[194524,51397],"./cy-gb/activity.js":[null],"./cy-gb/auth.js":[null],"./cy-gb/autosuggest.js":[null],"./cy-gb/avatar.js":[314393,52344],"./cy-gb/biometric-enrollment.js":[756524,17734],"./cy-gb/breakout-rooms.js":[515442,98629],"./cy-gb/broadcast.js":[676909,18364],"./cy-gb/calendar.js":[551864,77661],"./cy-gb/calling.js":[549471,5875],"./cy-gb/cast.js":[284581,88409],"./cy-gb/channels.js":[859756,2764],"./cy-gb/chat-list.js":[536168,24179],"./cy-gb/coach-report.js":[null],"./cy-gb/compose.js":[402422,24179],"./cy-gb/contacts.js":[null],"./cy-gb/datepicker.js":[940215,98842],"./cy-gb/desktop.js":[null],"./cy-gb/digital-signage.js":[null],"./cy-gb/edu.js":[707153,75294],"./cy-gb/embed.js":[null],"./cy-gb/errors.js":[null],"./cy-gb/esp.js":[200144,59982],"./cy-gb/extensibility-ptz-extension.js":[null],"./cy-gb/extensibility-room-remote.js":[null],"./cy-gb/extensibility.js":[809065,99334],"./cy-gb/files.js":[393450,86798],"./cy-gb/framework.js":[221199,52344],"./cy-gb/freemium.js":[null],"./cy-gb/funstuff.js":[851538,24179],"./cy-gb/gallery.js":[666524,54009],"./cy-gb/guardians.js":[230418,94476],"./cy-gb/hololens.js":[311440,5875],"./cy-gb/lightbox.js":[702070,24179],"./cy-gb/live-persona-card.js":[552222,52344],"./cy-gb/lms-integration.js":[null],"./cy-gb/meeting-analytics.js":[668957,91041],"./cy-gb/meeting-flyout.js":[298702,79297],"./cy-gb/meeting-meet-app.js":[null],"./cy-gb/meeting-options.js":[450017,10122],"./cy-gb/meeting-room-console.js":[100544,9293],"./cy-gb/meeting-stream-app.js":[null],"./cy-gb/messaging.js":[199699,24179],"./cy-gb/nova.js":[null],"./cy-gb/people-app.js":[null],"./cy-gb/people-picker.js":[143781,52344],"./cy-gb/people-targeting.js":[950071,14044],"./cy-gb/people.js":[null],"./cy-gb/pre-core.js":[null],"./cy-gb/recurrence.js":[588834,40125],"./cy-gb/search.js":[407976,98842],"./cy-gb/semantic-object.js":[95257,55200],"./cy-gb/settings.js":[null],"./cy-gb/share-to-teams-outlook-addin.js":[null],"./cy-gb/share-to-teams.js":[733739,30588],"./cy-gb/shortcut.js":[null],"./cy-gb/survey.js":[257311,50936],"./cy-gb/sv-flyout.js":[null],"./cy-gb/teams-and-channels.js":[781786,24444],"./cy-gb/tfl-onboarding.js":[null],"./cy-gb/toast-notifications.js":[null],"./cy-gb/unified-search.js":[597371,30588],"./cy-gb/url-preview.js":[842671,24179],"./cy-gb/video-capture.js":[216894,24179],"./cy-gb/video-message.js":[47900,24179],"./cy-gb/virtual-events.js":[null],"./cy-gb/webinar.js":[87450,55320],"./da-dk/activity.js":[null],"./da-dk/auth.js":[null],"./da-dk/autosuggest.js":[null],"./da-dk/avatar.js":[432169,6990],"./da-dk/biometric-enrollment.js":[560380,33884],"./da-dk/breakout-rooms.js":[688180,94598],"./da-dk/broadcast.js":[748687,64009],"./da-dk/calendar.js":[544983,826],"./da-dk/calling.js":[948710,10319],"./da-dk/cast.js":[885723,14526],"./da-dk/channels.js":[832977,65748],"./da-dk/chat-list.js":[387150,45871],"./da-dk/coach-report.js":[null],"./da-dk/compose.js":[533217,45871],"./da-dk/contacts.js":[null],"./da-dk/datepicker.js":[269252,4120],"./da-dk/desktop.js":[null],"./da-dk/digital-signage.js":[null],"./da-dk/edu.js":[59300,36333],"./da-dk/embed.js":[null],"./da-dk/errors.js":[null],"./da-dk/esp.js":[639958,45560],"./da-dk/extensibility-ptz-extension.js":[null],"./da-dk/extensibility-room-remote.js":[null],"./da-dk/extensibility.js":[45056,73717],"./da-dk/files.js":[888405,21689],"./da-dk/framework.js":[828214,6990],"./da-dk/freemium.js":[null],"./da-dk/funstuff.js":[877967,45871],"./da-dk/gallery.js":[83627,57426],"./da-dk/guardians.js":[788317,52876],"./da-dk/hololens.js":[548706,10319],"./da-dk/lightbox.js":[461895,45871],"./da-dk/live-persona-card.js":[453175,6990],"./da-dk/lms-integration.js":[null],"./da-dk/meeting-analytics.js":[685983,7004],"./da-dk/meeting-flyout.js":[358957,61176],"./da-dk/meeting-meet-app.js":[null],"./da-dk/meeting-options.js":[106372,10749],"./da-dk/meeting-room-console.js":[443478,58758],"./da-dk/meeting-stream-app.js":[null],"./da-dk/messaging.js":[812086,45871],"./da-dk/nova.js":[null],"./da-dk/people-app.js":[null],"./da-dk/people-picker.js":[209706,6990],"./da-dk/people-targeting.js":[2432,14533],"./da-dk/people.js":[null],"./da-dk/pre-core.js":[null],"./da-dk/recurrence.js":[487004,23280],"./da-dk/search.js":[631926,4120],"./da-dk/semantic-object.js":[122623,3966],"./da-dk/settings.js":[null],"./da-dk/share-to-teams-outlook-addin.js":[null],"./da-dk/share-to-teams.js":[507669,74120],"./da-dk/shortcut.js":[null],"./da-dk/survey.js":[233911,74590],"./da-dk/sv-flyout.js":[null],"./da-dk/teams-and-channels.js":[727218,17044],"./da-dk/tfl-onboarding.js":[null],"./da-dk/toast-notifications.js":[null],"./da-dk/unified-search.js":[993456,74120],"./da-dk/url-preview.js":[169296,45871],"./da-dk/video-capture.js":[807026,45871],"./da-dk/video-message.js":[231422,45871],"./da-dk/virtual-events.js":[null],"./da-dk/webinar.js":[492657,78755],"./de-de/activity.js":[null],"./de-de/auth.js":[null],"./de-de/autosuggest.js":[null],"./de-de/avatar.js":[368491,36397],"./de-de/biometric-enrollment.js":[539415,62050],"./de-de/breakout-rooms.js":[764295,96893],"./de-de/broadcast.js":[729303,67131],"./de-de/calendar.js":[621183,68734],"./de-de/calling.js":[957171,97507],"./de-de/cast.js":[339457,4601],"./de-de/channels.js":[772757,14377],"./de-de/chat-list.js":[22592,88059],"./de-de/coach-report.js":[null],"./de-de/compose.js":[371071,88059],"./de-de/contacts.js":[null],"./de-de/datepicker.js":[924189,9545],"./de-de/desktop.js":[null],"./de-de/digital-signage.js":[null],"./de-de/edu.js":[232394,50970],"./de-de/embed.js":[null],"./de-de/errors.js":[null],"./de-de/esp.js":[397492,59048],"./de-de/extensibility-ptz-extension.js":[null],"./de-de/extensibility-room-remote.js":[null],"./de-de/extensibility.js":[774283,52944],"./de-de/files.js":[789749,49333],"./de-de/framework.js":[709707,36397],"./de-de/freemium.js":[null],"./de-de/funstuff.js":[899793,88059],"./de-de/gallery.js":[765771,32106],"./de-de/guardians.js":[146923,57052],"./de-de/hololens.js":[147035,97507],"./de-de/lightbox.js":[980893,88059],"./de-de/live-persona-card.js":[1878,36397],"./de-de/lms-integration.js":[null],"./de-de/meeting-analytics.js":[931236,75667],"./de-de/meeting-flyout.js":[714761,10056],"./de-de/meeting-meet-app.js":[null],"./de-de/meeting-options.js":[136940,14464],"./de-de/meeting-room-console.js":[12206,63017],"./de-de/meeting-stream-app.js":[null],"./de-de/messaging.js":[32515,88059],"./de-de/nova.js":[null],"./de-de/people-app.js":[null],"./de-de/people-picker.js":[724989,36397],"./de-de/people-targeting.js":[583277,44465],"./de-de/people.js":[null],"./de-de/pre-core.js":[null],"./de-de/recurrence.js":[865561,30590],"./de-de/search.js":[253013,9545],"./de-de/semantic-object.js":[677039,4288],"./de-de/settings.js":[null],"./de-de/share-to-teams-outlook-addin.js":[null],"./de-de/share-to-teams.js":[290598,21514],"./de-de/shortcut.js":[null],"./de-de/survey.js":[622225,55204],"./de-de/sv-flyout.js":[null],"./de-de/teams-and-channels.js":[489562,41272],"./de-de/tfl-onboarding.js":[null],"./de-de/toast-notifications.js":[null],"./de-de/unified-search.js":[717065,21514],"./de-de/url-preview.js":[267432,88059],"./de-de/video-capture.js":[236313,88059],"./de-de/video-message.js":[623652,88059],"./de-de/virtual-events.js":[null],"./de-de/webinar.js":[748598,81516],"./el-gr/activity.js":[null],"./el-gr/auth.js":[null],"./el-gr/autosuggest.js":[null],"./el-gr/avatar.js":[894735,84766],"./el-gr/biometric-enrollment.js":[666654,92186],"./el-gr/breakout-rooms.js":[779262,21822],"./el-gr/broadcast.js":[27555,52433],"./el-gr/calendar.js":[822575,16487],"./el-gr/calling.js":[282770,23762],"./el-gr/cast.js":[13288,29477],"./el-gr/channels.js":[121906,95830],"./el-gr/chat-list.js":[507330,95268],"./el-gr/coach-report.js":[null],"./el-gr/compose.js":[113030,95268],"./el-gr/contacts.js":[null],"./el-gr/datepicker.js":[629617,39387],"./el-gr/desktop.js":[null],"./el-gr/digital-signage.js":[null],"./el-gr/edu.js":[891581,27006],"./el-gr/embed.js":[null],"./el-gr/errors.js":[null],"./el-gr/esp.js":[267187,29475],"./el-gr/extensibility-ptz-extension.js":[null],"./el-gr/extensibility-room-remote.js":[null],"./el-gr/extensibility.js":[661032,31624],"./el-gr/files.js":[185425,63616],"./el-gr/framework.js":[13107,84766],"./el-gr/freemium.js":[null],"./el-gr/funstuff.js":[416644,95268],"./el-gr/gallery.js":[366956,90265],"./el-gr/guardians.js":[215036,22799],"./el-gr/hololens.js":[105183,23762],"./el-gr/lightbox.js":[649702,95268],"./el-gr/live-persona-card.js":[557221,84766],"./el-gr/lms-integration.js":[null],"./el-gr/meeting-analytics.js":[849150,96105],"./el-gr/meeting-flyout.js":[490626,36783],"./el-gr/meeting-meet-app.js":[null],"./el-gr/meeting-options.js":[545427,95002],"./el-gr/meeting-room-console.js":[923164,95972],"./el-gr/meeting-stream-app.js":[null],"./el-gr/messaging.js":[780246,95268],"./el-gr/nova.js":[null],"./el-gr/people-app.js":[null],"./el-gr/people-picker.js":[77290,84766],"./el-gr/people-targeting.js":[505038,59752],"./el-gr/people.js":[null],"./el-gr/pre-core.js":[null],"./el-gr/recurrence.js":[334927,33925],"./el-gr/search.js":[52655,39387],"./el-gr/semantic-object.js":[544916,92521],"./el-gr/settings.js":[null],"./el-gr/share-to-teams-outlook-addin.js":[null],"./el-gr/share-to-teams.js":[140749,1199],"./el-gr/shortcut.js":[null],"./el-gr/survey.js":[285738,66953],"./el-gr/sv-flyout.js":[null],"./el-gr/teams-and-channels.js":[490614,11265],"./el-gr/tfl-onboarding.js":[null],"./el-gr/toast-notifications.js":[null],"./el-gr/unified-search.js":[62625,1199],"./el-gr/url-preview.js":[44554,95268],"./el-gr/video-capture.js":[705381,95268],"./el-gr/video-message.js":[420374,95268],"./el-gr/virtual-events.js":[null],"./el-gr/webinar.js":[189920,98654],"./en-gb/activity.js":[null],"./en-gb/auth.js":[null],"./en-gb/autosuggest.js":[null],"./en-gb/avatar.js":[183536,24937],"./en-gb/biometric-enrollment.js":[46759,86608],"./en-gb/breakout-rooms.js":[977996,22042],"./en-gb/broadcast.js":[379249,73851],"./en-gb/calendar.js":[155841,33580],"./en-gb/calling.js":[441651,94057],"./en-gb/cast.js":[243677,48113],"./en-gb/channels.js":[139958,93048],"./en-gb/chat-list.js":[34324,32071],"./en-gb/coach-report.js":[null],"./en-gb/compose.js":[829922,32071],"./en-gb/contacts.js":[null],"./en-gb/datepicker.js":[988078,93820],"./en-gb/desktop.js":[null],"./en-gb/digital-signage.js":[null],"./en-gb/edu.js":[172255,99329],"./en-gb/embed.js":[null],"./en-gb/errors.js":[null],"./en-gb/esp.js":[538378,39886],"./en-gb/extensibility-ptz-extension.js":[null],"./en-gb/extensibility-room-remote.js":[null],"./en-gb/extensibility.js":[106415,98217],"./en-gb/files.js":[133060,27662],"./en-gb/framework.js":[847093,24937],"./en-gb/freemium.js":[null],"./en-gb/funstuff.js":[842870,32071],"./en-gb/gallery.js":[754447,44284],"./en-gb/guardians.js":[645655,88664],"./en-gb/hololens.js":[209137,94057],"./en-gb/lightbox.js":[539703,32071],"./en-gb/live-persona-card.js":[705762,24937],"./en-gb/lms-integration.js":[null],"./en-gb/meeting-analytics.js":[53171,99290],"./en-gb/meeting-flyout.js":[323951,5579],"./en-gb/meeting-meet-app.js":[null],"./en-gb/meeting-options.js":[840957,36821],"./en-gb/meeting-room-console.js":[688717,50946],"./en-gb/meeting-stream-app.js":[null],"./en-gb/messaging.js":[969756,32071],"./en-gb/nova.js":[null],"./en-gb/people-app.js":[null],"./en-gb/people-picker.js":[940872,24937],"./en-gb/people-targeting.js":[852248,80648],"./en-gb/people.js":[null],"./en-gb/pre-core.js":[null],"./en-gb/recurrence.js":[841212,37390],"./en-gb/search.js":[365631,93820],"./en-gb/semantic-object.js":[281596,6396],"./en-gb/settings.js":[null],"./en-gb/share-to-teams-outlook-addin.js":[null],"./en-gb/share-to-teams.js":[879578,39370],"./en-gb/shortcut.js":[null],"./en-gb/survey.js":[988810,42549],"./en-gb/sv-flyout.js":[null],"./en-gb/teams-and-channels.js":[611512,63823],"./en-gb/tfl-onboarding.js":[null],"./en-gb/toast-notifications.js":[null],"./en-gb/unified-search.js":[601166,39370],"./en-gb/url-preview.js":[999474,32071],"./en-gb/video-capture.js":[960443,32071],"./en-gb/video-message.js":[255755,32071],"./en-gb/virtual-events.js":[null],"./en-gb/webinar.js":[361179,33105],"./en-us/activity.js":[null],"./en-us/auth.js":[null],"./en-us/autosuggest.js":[null],"./en-us/avatar.js":[665401,50906],"./en-us/biometric-enrollment.js":[232769,44667],"./en-us/breakout-rooms.js":[712680,23893],"./en-us/broadcast.js":[6162,88811],"./en-us/calendar.js":[158300,36537],"./en-us/calling.js":[102466,46657],"./en-us/cast.js":[78499,44699],"./en-us/channels.js":[814117,41309],"./en-us/chat-list.js":[889367,41143],"./en-us/coach-report.js":[null],"./en-us/compose.js":[652407,41143],"./en-us/contacts.js":[null],"./en-us/datepicker.js":[843754,20538],"./en-us/desktop.js":[null],"./en-us/digital-signage.js":[null],"./en-us/edu.js":[136835,10166],"./en-us/embed.js":[null],"./en-us/errors.js":[null],"./en-us/esp.js":[898367,17797],"./en-us/extensibility-ptz-extension.js":[null],"./en-us/extensibility-room-remote.js":[null],"./en-us/extensibility.js":[837705,54069],"./en-us/files.js":[341579,41720],"./en-us/framework.js":[954208,50906],"./en-us/freemium.js":[null],"./en-us/funstuff.js":[251122,41143],"./en-us/gallery.js":[484025,11746],"./en-us/guardians.js":[98822,58259],"./en-us/hololens.js":[98998,46657],"./en-us/lightbox.js":[394736,41143],"./en-us/live-persona-card.js":[982513,50906],"./en-us/lms-integration.js":[null],"./en-us/meeting-analytics.js":[243650,90631],"./en-us/meeting-flyout.js":[210370,39307],"./en-us/meeting-meet-app.js":[null],"./en-us/meeting-options.js":[875934,92819],"./en-us/meeting-room-console.js":[703249,7761],"./en-us/meeting-stream-app.js":[null],"./en-us/messaging.js":[17698,41143],"./en-us/nova.js":[null],"./en-us/people-app.js":[null],"./en-us/people-picker.js":[511645,50906],"./en-us/people-targeting.js":[506156,20443],"./en-us/people.js":[null],"./en-us/pre-core.js":[null],"./en-us/recurrence.js":[647048,2525],"./en-us/search.js":[327920,20538],"./en-us/semantic-object.js":[229442,87562],"./en-us/settings.js":[null],"./en-us/share-to-teams-outlook-addin.js":[null],"./en-us/share-to-teams.js":[848498,35626],"./en-us/shortcut.js":[null],"./en-us/survey.js":[162863,67569],"./en-us/sv-flyout.js":[null],"./en-us/teams-and-channels.js":[55662,26819],"./en-us/tfl-onboarding.js":[null],"./en-us/toast-notifications.js":[null],"./en-us/unified-search.js":[593988,35626],"./en-us/url-preview.js":[645425,41143],"./en-us/video-capture.js":[961970,41143],"./en-us/video-message.js":[744954,41143],"./en-us/virtual-events.js":[null],"./en-us/webinar.js":[689665,21372],"./es-es/activity.js":[null],"./es-es/auth.js":[null],"./es-es/autosuggest.js":[null],"./es-es/avatar.js":[580284,80184],"./es-es/biometric-enrollment.js":[241924,95859],"./es-es/breakout-rooms.js":[759383,73339],"./es-es/broadcast.js":[754019,21033],"./es-es/calendar.js":[951608,83992],"./es-es/calling.js":[930887,44570],"./es-es/cast.js":[388307,30185],"./es-es/channels.js":[405974,26025],"./es-es/chat-list.js":[656660,82722],"./es-es/coach-report.js":[null],"./es-es/compose.js":[622715,82722],"./es-es/contacts.js":[null],"./es-es/datepicker.js":[644563,86549],"./es-es/desktop.js":[null],"./es-es/digital-signage.js":[null],"./es-es/edu.js":[50357,30018],"./es-es/embed.js":[null],"./es-es/errors.js":[null],"./es-es/esp.js":[494736,76605],"./es-es/extensibility-ptz-extension.js":[null],"./es-es/extensibility-room-remote.js":[null],"./es-es/extensibility.js":[303399,47468],"./es-es/files.js":[432527,72638],"./es-es/framework.js":[481449,80184],"./es-es/freemium.js":[null],"./es-es/funstuff.js":[772684,82722],"./es-es/gallery.js":[448441,46477],"./es-es/guardians.js":[84722,36153],"./es-es/hololens.js":[638974,44570],"./es-es/lightbox.js":[280407,82722],"./es-es/live-persona-card.js":[483468,80184],"./es-es/lms-integration.js":[null],"./es-es/meeting-analytics.js":[906702,53069],"./es-es/meeting-flyout.js":[617018,33199],"./es-es/meeting-meet-app.js":[null],"./es-es/meeting-options.js":[173523,140],"./es-es/meeting-room-console.js":[528226,52443],"./es-es/meeting-stream-app.js":[null],"./es-es/messaging.js":[899921,82722],"./es-es/nova.js":[null],"./es-es/people-app.js":[null],"./es-es/people-picker.js":[671397,80184],"./es-es/people-targeting.js":[549834,71409],"./es-es/people.js":[null],"./es-es/pre-core.js":[null],"./es-es/recurrence.js":[316710,58276],"./es-es/search.js":[83360,86549],"./es-es/semantic-object.js":[538243,4904],"./es-es/settings.js":[null],"./es-es/share-to-teams-outlook-addin.js":[null],"./es-es/share-to-teams.js":[183534,59258],"./es-es/shortcut.js":[null],"./es-es/survey.js":[227518,5170],"./es-es/sv-flyout.js":[null],"./es-es/teams-and-channels.js":[322393,73773],"./es-es/tfl-onboarding.js":[null],"./es-es/toast-notifications.js":[null],"./es-es/unified-search.js":[223872,59258],"./es-es/url-preview.js":[281735,82722],"./es-es/video-capture.js":[701394,82722],"./es-es/video-message.js":[668243,82722],"./es-es/virtual-events.js":[null],"./es-es/webinar.js":[360716,38261],"./es-mx/activity.js":[null],"./es-mx/auth.js":[null],"./es-mx/autosuggest.js":[null],"./es-mx/avatar.js":[215e3,2701],"./es-mx/biometric-enrollment.js":[942753,56149],"./es-mx/breakout-rooms.js":[803811,51570],"./es-mx/broadcast.js":[490022,12502],"./es-mx/calendar.js":[580521,38885],"./es-mx/calling.js":[806645,57699],"./es-mx/cast.js":[96347,84063],"./es-mx/channels.js":[731075,28400],"./es-mx/chat-list.js":[709393,11157],"./es-mx/coach-report.js":[null],"./es-mx/compose.js":[924017,11157],"./es-mx/contacts.js":[null],"./es-mx/datepicker.js":[632446,49810],"./es-mx/desktop.js":[null],"./es-mx/digital-signage.js":[null],"./es-mx/edu.js":[961422,34027],"./es-mx/embed.js":[null],"./es-mx/errors.js":[null],"./es-mx/esp.js":[942730,15580],"./es-mx/extensibility-ptz-extension.js":[null],"./es-mx/extensibility-room-remote.js":[null],"./es-mx/extensibility.js":[22685,57711],"./es-mx/files.js":[214835,26822],"./es-mx/framework.js":[163817,2701],"./es-mx/freemium.js":[null],"./es-mx/funstuff.js":[253692,11157],"./es-mx/gallery.js":[202797,11136],"./es-mx/guardians.js":[882238,58686],"./es-mx/hololens.js":[336898,57699],"./es-mx/lightbox.js":[34357,11157],"./es-mx/live-persona-card.js":[882517,2701],"./es-mx/lms-integration.js":[null],"./es-mx/meeting-analytics.js":[933253,47331],"./es-mx/meeting-flyout.js":[957743,73956],"./es-mx/meeting-meet-app.js":[null],"./es-mx/meeting-options.js":[283775,40553],"./es-mx/meeting-room-console.js":[886657,54347],"./es-mx/meeting-stream-app.js":[null],"./es-mx/messaging.js":[332222,11157],"./es-mx/nova.js":[null],"./es-mx/people-app.js":[null],"./es-mx/people-picker.js":[740055,2701],"./es-mx/people-targeting.js":[566666,94543],"./es-mx/people.js":[null],"./es-mx/pre-core.js":[null],"./es-mx/recurrence.js":[602910,8275],"./es-mx/search.js":[95644,49810],"./es-mx/semantic-object.js":[142505,67442],"./es-mx/settings.js":[null],"./es-mx/share-to-teams-outlook-addin.js":[null],"./es-mx/share-to-teams.js":[647085,46402],"./es-mx/shortcut.js":[null],"./es-mx/survey.js":[697422,10501],"./es-mx/sv-flyout.js":[null],"./es-mx/teams-and-channels.js":[964913,82856],"./es-mx/tfl-onboarding.js":[null],"./es-mx/toast-notifications.js":[null],"./es-mx/unified-search.js":[81793,46402],"./es-mx/url-preview.js":[381097,11157],"./es-mx/video-capture.js":[127209,11157],"./es-mx/video-message.js":[758468,11157],"./es-mx/virtual-events.js":[null],"./es-mx/webinar.js":[94914,33454],"./et-ee/activity.js":[null],"./et-ee/auth.js":[null],"./et-ee/autosuggest.js":[null],"./et-ee/avatar.js":[402085,68304],"./et-ee/biometric-enrollment.js":[838819,96148],"./et-ee/breakout-rooms.js":[891978,89907],"./et-ee/broadcast.js":[738635,20957],"./et-ee/calendar.js":[991415,75],"./et-ee/calling.js":[526163,46978],"./et-ee/cast.js":[148416,21838],"./et-ee/channels.js":[754586,76355],"./et-ee/chat-list.js":[579300,63957],"./et-ee/coach-report.js":[null],"./et-ee/compose.js":[241010,63957],"./et-ee/contacts.js":[null],"./et-ee/datepicker.js":[82211,94819],"./et-ee/desktop.js":[null],"./et-ee/digital-signage.js":[null],"./et-ee/edu.js":[565355,67658],"./et-ee/embed.js":[null],"./et-ee/errors.js":[null],"./et-ee/esp.js":[799e3,19521],"./et-ee/extensibility-ptz-extension.js":[null],"./et-ee/extensibility-room-remote.js":[null],"./et-ee/extensibility.js":[211870,65110],"./et-ee/files.js":[639447,79754],"./et-ee/framework.js":[495682,68304],"./et-ee/freemium.js":[null],"./et-ee/funstuff.js":[366681,63957],"./et-ee/gallery.js":[194436,74224],"./et-ee/guardians.js":[45202,56275],"./et-ee/hololens.js":[370602,46978],"./et-ee/lightbox.js":[609622,63957],"./et-ee/live-persona-card.js":[551955,68304],"./et-ee/lms-integration.js":[null],"./et-ee/meeting-analytics.js":[582659,58359],"./et-ee/meeting-flyout.js":[553895,77953],"./et-ee/meeting-meet-app.js":[null],"./et-ee/meeting-options.js":[185354,96007],"./et-ee/meeting-room-console.js":[420900,96149],"./et-ee/meeting-stream-app.js":[null],"./et-ee/messaging.js":[333965,63957],"./et-ee/nova.js":[null],"./et-ee/people-app.js":[null],"./et-ee/people-picker.js":[854962,68304],"./et-ee/people-targeting.js":[793712,50138],"./et-ee/people.js":[null],"./et-ee/pre-core.js":[null],"./et-ee/recurrence.js":[689783,68074],"./et-ee/search.js":[429304,94819],"./et-ee/semantic-object.js":[722356,45898],"./et-ee/settings.js":[null],"./et-ee/share-to-teams-outlook-addin.js":[null],"./et-ee/share-to-teams.js":[182010,3184],"./et-ee/shortcut.js":[null],"./et-ee/survey.js":[394068,14309],"./et-ee/sv-flyout.js":[null],"./et-ee/teams-and-channels.js":[757738,82703],"./et-ee/tfl-onboarding.js":[null],"./et-ee/toast-notifications.js":[null],"./et-ee/unified-search.js":[143886,3184],"./et-ee/url-preview.js":[309119,63957],"./et-ee/video-capture.js":[509784,63957],"./et-ee/video-message.js":[863588,63957],"./et-ee/virtual-events.js":[null],"./et-ee/webinar.js":[442460,13750],"./eu-es/activity.js":[null],"./eu-es/auth.js":[null],"./eu-es/autosuggest.js":[null],"./eu-es/avatar.js":[823511,24278],"./eu-es/biometric-enrollment.js":[279216,60684],"./eu-es/breakout-rooms.js":[10731,62472],"./eu-es/broadcast.js":[38816,62457],"./eu-es/calendar.js":[368562,17253],"./eu-es/calling.js":[653569,82522],"./eu-es/cast.js":[405943,29731],"./eu-es/channels.js":[996216,95487],"./eu-es/chat-list.js":[835853,89683],"./eu-es/coach-report.js":[null],"./eu-es/compose.js":[391961,89683],"./eu-es/contacts.js":[null],"./eu-es/datepicker.js":[419554,30078],"./eu-es/desktop.js":[null],"./eu-es/digital-signage.js":[null],"./eu-es/edu.js":[49911,66129],"./eu-es/embed.js":[null],"./eu-es/errors.js":[null],"./eu-es/esp.js":[683922,33665],"./eu-es/extensibility-ptz-extension.js":[null],"./eu-es/extensibility-room-remote.js":[null],"./eu-es/extensibility.js":[23633,64270],"./eu-es/files.js":[439641,75613],"./eu-es/framework.js":[651524,24278],"./eu-es/freemium.js":[null],"./eu-es/funstuff.js":[867807,89683],"./eu-es/gallery.js":[245213,83393],"./eu-es/guardians.js":[991313,23246],"./eu-es/hololens.js":[572081,82522],"./eu-es/lightbox.js":[543936,89683],"./eu-es/live-persona-card.js":[55273,24278],"./eu-es/lms-integration.js":[null],"./eu-es/meeting-analytics.js":[122863,81897],"./eu-es/meeting-flyout.js":[685555,30748],"./eu-es/meeting-meet-app.js":[null],"./eu-es/meeting-options.js":[974300,97782],"./eu-es/meeting-room-console.js":[542021,29290],"./eu-es/meeting-stream-app.js":[null],"./eu-es/messaging.js":[614744,89683],"./eu-es/nova.js":[null],"./eu-es/people-app.js":[null],"./eu-es/people-picker.js":[771884,24278],"./eu-es/people-targeting.js":[886710,88216],"./eu-es/people.js":[null],"./eu-es/pre-core.js":[null],"./eu-es/recurrence.js":[766539,43642],"./eu-es/search.js":[743441,30078],"./eu-es/semantic-object.js":[770134,82023],"./eu-es/settings.js":[null],"./eu-es/share-to-teams-outlook-addin.js":[null],"./eu-es/share-to-teams.js":[394733,26916],"./eu-es/shortcut.js":[null],"./eu-es/survey.js":[566436,73166],"./eu-es/sv-flyout.js":[null],"./eu-es/teams-and-channels.js":[714714,95691],"./eu-es/tfl-onboarding.js":[null],"./eu-es/toast-notifications.js":[null],"./eu-es/unified-search.js":[312528,26916],"./eu-es/url-preview.js":[388353,89683],"./eu-es/video-capture.js":[146239,89683],"./eu-es/video-message.js":[372996,89683],"./eu-es/virtual-events.js":[null],"./eu-es/webinar.js":[381415,92680],"./fi-fi/activity.js":[null],"./fi-fi/auth.js":[null],"./fi-fi/autosuggest.js":[null],"./fi-fi/avatar.js":[176776,16211],"./fi-fi/biometric-enrollment.js":[72159,23035],"./fi-fi/breakout-rooms.js":[634632,54125],"./fi-fi/broadcast.js":[863833,60347],"./fi-fi/calendar.js":[772100,22125],"./fi-fi/calling.js":[790322,79316],"./fi-fi/cast.js":[710808,79088],"./fi-fi/channels.js":[611536,35004],"./fi-fi/chat-list.js":[775782,6472],"./fi-fi/coach-report.js":[null],"./fi-fi/compose.js":[742372,6472],"./fi-fi/contacts.js":[null],"./fi-fi/datepicker.js":[102489,78746],"./fi-fi/desktop.js":[null],"./fi-fi/digital-signage.js":[null],"./fi-fi/edu.js":[282388,85843],"./fi-fi/embed.js":[null],"./fi-fi/errors.js":[null],"./fi-fi/esp.js":[425519,37364],"./fi-fi/extensibility-ptz-extension.js":[null],"./fi-fi/extensibility-room-remote.js":[null],"./fi-fi/extensibility.js":[724029,17968],"./fi-fi/files.js":[864567,23020],"./fi-fi/framework.js":[351030,16211],"./fi-fi/freemium.js":[null],"./fi-fi/funstuff.js":[761401,6472],"./fi-fi/gallery.js":[537011,39117],"./fi-fi/guardians.js":[853678,56774],"./fi-fi/hololens.js":[756399,79316],"./fi-fi/lightbox.js":[17410,6472],"./fi-fi/live-persona-card.js":[974357,16211],"./fi-fi/lms-integration.js":[null],"./fi-fi/meeting-analytics.js":[658574,65469],"./fi-fi/meeting-flyout.js":[683930,13353],"./fi-fi/meeting-meet-app.js":[null],"./fi-fi/meeting-options.js":[412314,80473],"./fi-fi/meeting-room-console.js":[937178,80093],"./fi-fi/meeting-stream-app.js":[null],"./fi-fi/messaging.js":[879263,6472],"./fi-fi/nova.js":[null],"./fi-fi/people-app.js":[null],"./fi-fi/people-picker.js":[709714,16211],"./fi-fi/people-targeting.js":[197569,96380],"./fi-fi/people.js":[null],"./fi-fi/pre-core.js":[null],"./fi-fi/recurrence.js":[255619,47573],"./fi-fi/search.js":[359217,78746],"./fi-fi/semantic-object.js":[842940,80293],"./fi-fi/settings.js":[null],"./fi-fi/share-to-teams-outlook-addin.js":[null],"./fi-fi/share-to-teams.js":[340398,47663],"./fi-fi/shortcut.js":[null],"./fi-fi/survey.js":[90076,19353],"./fi-fi/sv-flyout.js":[null],"./fi-fi/teams-and-channels.js":[529514,28437],"./fi-fi/tfl-onboarding.js":[null],"./fi-fi/toast-notifications.js":[null],"./fi-fi/unified-search.js":[663361,47663],"./fi-fi/url-preview.js":[607534,6472],"./fi-fi/video-capture.js":[90196,6472],"./fi-fi/video-message.js":[741061,6472],"./fi-fi/virtual-events.js":[null],"./fi-fi/webinar.js":[452711,3683],"./fil-ph/activity.js":[null],"./fil-ph/auth.js":[null],"./fil-ph/autosuggest.js":[null],"./fil-ph/avatar.js":[578622,80117],"./fil-ph/biometric-enrollment.js":[969410,71920],"./fil-ph/breakout-rooms.js":[476595,67883],"./fil-ph/broadcast.js":[473904,41445],"./fil-ph/calendar.js":[246720,70913],"./fil-ph/calling.js":[771276,67083],"./fil-ph/cast.js":[597460,86146],"./fil-ph/channels.js":[444221,65556],"./fil-ph/chat-list.js":[285882,34055],"./fil-ph/coach-report.js":[null],"./fil-ph/compose.js":[722503,34055],"./fil-ph/contacts.js":[null],"./fil-ph/datepicker.js":[630231,45153],"./fil-ph/desktop.js":[null],"./fil-ph/digital-signage.js":[null],"./fil-ph/edu.js":[873011,57002],"./fil-ph/embed.js":[null],"./fil-ph/errors.js":[null],"./fil-ph/esp.js":[446525,64422],"./fil-ph/extensibility-ptz-extension.js":[null],"./fil-ph/extensibility-room-remote.js":[null],"./fil-ph/extensibility.js":[552317,42282],"./fil-ph/files.js":[324255,63825],"./fil-ph/framework.js":[812749,80117],"./fil-ph/freemium.js":[null],"./fil-ph/funstuff.js":[979310,34055],"./fil-ph/gallery.js":[853632,57510],"./fil-ph/guardians.js":[901554,62294],"./fil-ph/hololens.js":[925333,67083],"./fil-ph/lightbox.js":[767186,34055],"./fil-ph/live-persona-card.js":[604394,80117],"./fil-ph/lms-integration.js":[null],"./fil-ph/meeting-analytics.js":[127860,87408],"./fil-ph/meeting-flyout.js":[836257,22928],"./fil-ph/meeting-meet-app.js":[null],"./fil-ph/meeting-options.js":[59820,61320],"./fil-ph/meeting-room-console.js":[810442,13428],"./fil-ph/meeting-stream-app.js":[null],"./fil-ph/messaging.js":[102910,34055],"./fil-ph/nova.js":[null],"./fil-ph/people-app.js":[null],"./fil-ph/people-picker.js":[75778,80117],"./fil-ph/people-targeting.js":[326156,77233],"./fil-ph/people.js":[null],"./fil-ph/pre-core.js":[null],"./fil-ph/recurrence.js":[295980,471],"./fil-ph/search.js":[604374,45153],"./fil-ph/semantic-object.js":[623143,76317],"./fil-ph/settings.js":[null],"./fil-ph/share-to-teams-outlook-addin.js":[null],"./fil-ph/share-to-teams.js":[987129,20351],"./fil-ph/shortcut.js":[null],"./fil-ph/survey.js":[495581,21346],"./fil-ph/sv-flyout.js":[null],"./fil-ph/teams-and-channels.js":[243085,57944],"./fil-ph/tfl-onboarding.js":[null],"./fil-ph/toast-notifications.js":[null],"./fil-ph/unified-search.js":[102366,20351],"./fil-ph/url-preview.js":[374594,34055],"./fil-ph/video-capture.js":[864657,34055],"./fil-ph/video-message.js":[648792,34055],"./fil-ph/virtual-events.js":[null],"./fil-ph/webinar.js":[76429,81249],"./fr-ca/activity.js":[null],"./fr-ca/auth.js":[null],"./fr-ca/autosuggest.js":[null],"./fr-ca/avatar.js":[465979,57164],"./fr-ca/biometric-enrollment.js":[500534,48098],"./fr-ca/breakout-rooms.js":[397153,3813],"./fr-ca/broadcast.js":[915395,67847],"./fr-ca/calendar.js":[103426,52287],"./fr-ca/calling.js":[828390,57069],"./fr-ca/cast.js":[954416,35940],"./fr-ca/channels.js":[392389,42120],"./fr-ca/chat-list.js":[54650,6457],"./fr-ca/coach-report.js":[null],"./fr-ca/compose.js":[762766,6457],"./fr-ca/contacts.js":[null],"./fr-ca/datepicker.js":[878690,80253],"./fr-ca/desktop.js":[null],"./fr-ca/digital-signage.js":[null],"./fr-ca/edu.js":[68031,97554],"./fr-ca/embed.js":[null],"./fr-ca/errors.js":[null],"./fr-ca/esp.js":[131376,85381],"./fr-ca/extensibility-ptz-extension.js":[null],"./fr-ca/extensibility-room-remote.js":[null],"./fr-ca/extensibility.js":[415046,8111],"./fr-ca/files.js":[191376,26828],"./fr-ca/framework.js":[695512,57164],"./fr-ca/freemium.js":[null],"./fr-ca/funstuff.js":[707710,6457],"./fr-ca/gallery.js":[180299,46713],"./fr-ca/guardians.js":[766222,61235],"./fr-ca/hololens.js":[804749,57069],"./fr-ca/lightbox.js":[279371,6457],"./fr-ca/live-persona-card.js":[459093,57164],"./fr-ca/lms-integration.js":[null],"./fr-ca/meeting-analytics.js":[836961,85340],"./fr-ca/meeting-flyout.js":[504710,93300],"./fr-ca/meeting-meet-app.js":[null],"./fr-ca/meeting-options.js":[322593,82222],"./fr-ca/meeting-room-console.js":[542085,25447],"./fr-ca/meeting-stream-app.js":[null],"./fr-ca/messaging.js":[44231,6457],"./fr-ca/nova.js":[null],"./fr-ca/people-app.js":[null],"./fr-ca/people-picker.js":[474569,57164],"./fr-ca/people-targeting.js":[74142,59360],"./fr-ca/people.js":[null],"./fr-ca/pre-core.js":[null],"./fr-ca/recurrence.js":[520121,75123],"./fr-ca/search.js":[820388,80253],"./fr-ca/semantic-object.js":[830692,81879],"./fr-ca/settings.js":[null],"./fr-ca/share-to-teams-outlook-addin.js":[null],"./fr-ca/share-to-teams.js":[491806,92966],"./fr-ca/shortcut.js":[null],"./fr-ca/survey.js":[759606,57760],"./fr-ca/sv-flyout.js":[null],"./fr-ca/teams-and-channels.js":[470546,19135],"./fr-ca/tfl-onboarding.js":[null],"./fr-ca/toast-notifications.js":[null],"./fr-ca/unified-search.js":[21756,92966],"./fr-ca/url-preview.js":[49769,6457],"./fr-ca/video-capture.js":[259914,6457],"./fr-ca/video-message.js":[311355,6457],"./fr-ca/virtual-events.js":[null],"./fr-ca/webinar.js":[683620,82831],"./fr-fr/activity.js":[null],"./fr-fr/auth.js":[null],"./fr-fr/autosuggest.js":[null],"./fr-fr/avatar.js":[653487,60325],"./fr-fr/biometric-enrollment.js":[610251,37249],"./fr-fr/breakout-rooms.js":[545472,11290],"./fr-fr/broadcast.js":[601885,17794],"./fr-fr/calendar.js":[603217,44778],"./fr-fr/calling.js":[43915,637],"./fr-fr/cast.js":[976631,37811],"./fr-fr/channels.js":[468332,54578],"./fr-fr/chat-list.js":[917655,45930],"./fr-fr/coach-report.js":[null],"./fr-fr/compose.js":[134120,45930],"./fr-fr/contacts.js":[null],"./fr-fr/datepicker.js":[441859,39090],"./fr-fr/desktop.js":[null],"./fr-fr/digital-signage.js":[null],"./fr-fr/edu.js":[462012,91596],"./fr-fr/embed.js":[null],"./fr-fr/errors.js":[null],"./fr-fr/esp.js":[786857,34179],"./fr-fr/extensibility-ptz-extension.js":[null],"./fr-fr/extensibility-room-remote.js":[null],"./fr-fr/extensibility.js":[443598,76205],"./fr-fr/files.js":[569471,64897],"./fr-fr/framework.js":[956931,60325],"./fr-fr/freemium.js":[null],"./fr-fr/funstuff.js":[495557,45930],"./fr-fr/gallery.js":[977803,58035],"./fr-fr/guardians.js":[277551,42469],"./fr-fr/hololens.js":[413765,637],"./fr-fr/lightbox.js":[915013,45930],"./fr-fr/live-persona-card.js":[616866,60325],"./fr-fr/lms-integration.js":[null],"./fr-fr/meeting-analytics.js":[607816,60785],"./fr-fr/meeting-flyout.js":[834686,38195],"./fr-fr/meeting-meet-app.js":[null],"./fr-fr/meeting-options.js":[804758,28087],"./fr-fr/meeting-room-console.js":[1971,42699],"./fr-fr/meeting-stream-app.js":[null],"./fr-fr/messaging.js":[936121,45930],"./fr-fr/nova.js":[null],"./fr-fr/people-app.js":[null],"./fr-fr/people-picker.js":[390128,60325],"./fr-fr/people-targeting.js":[346755,13739],"./fr-fr/people.js":[null],"./fr-fr/pre-core.js":[null],"./fr-fr/recurrence.js":[364561,38552],"./fr-fr/search.js":[756845,39090],"./fr-fr/semantic-object.js":[517889,93870],"./fr-fr/settings.js":[null],"./fr-fr/share-to-teams-outlook-addin.js":[null],"./fr-fr/share-to-teams.js":[938173,2774],"./fr-fr/shortcut.js":[null],"./fr-fr/survey.js":[433828,87844],"./fr-fr/sv-flyout.js":[null],"./fr-fr/teams-and-channels.js":[717977,54067],"./fr-fr/tfl-onboarding.js":[null],"./fr-fr/toast-notifications.js":[null],"./fr-fr/unified-search.js":[415529,2774],"./fr-fr/url-preview.js":[162812,45930],"./fr-fr/video-capture.js":[120220,45930],"./fr-fr/video-message.js":[386549,45930],"./fr-fr/virtual-events.js":[null],"./fr-fr/webinar.js":[32433,78800],"./gl-es/activity.js":[null],"./gl-es/auth.js":[null],"./gl-es/autosuggest.js":[null],"./gl-es/avatar.js":[232794,34496],"./gl-es/biometric-enrollment.js":[12414,96057],"./gl-es/breakout-rooms.js":[843392,41627],"./gl-es/broadcast.js":[432191,6942],"./gl-es/calendar.js":[462507,49590],"./gl-es/calling.js":[933004,21833],"./gl-es/cast.js":[480749,43469],"./gl-es/channels.js":[646590,94766],"./gl-es/chat-list.js":[483567,70279],"./gl-es/coach-report.js":[null],"./gl-es/compose.js":[664900,70279],"./gl-es/contacts.js":[null],"./gl-es/datepicker.js":[95348,69971],"./gl-es/desktop.js":[null],"./gl-es/digital-signage.js":[null],"./gl-es/edu.js":[133824,1573],"./gl-es/embed.js":[null],"./gl-es/errors.js":[null],"./gl-es/esp.js":[836739,31908],"./gl-es/extensibility-ptz-extension.js":[null],"./gl-es/extensibility-room-remote.js":[null],"./gl-es/extensibility.js":[297867,90477],"./gl-es/files.js":[808151,82922],"./gl-es/framework.js":[115333,34496],"./gl-es/freemium.js":[null],"./gl-es/funstuff.js":[814974,70279],"./gl-es/gallery.js":[256650,57449],"./gl-es/guardians.js":[231265,74687],"./gl-es/hololens.js":[306819,21833],"./gl-es/lightbox.js":[557918,70279],"./gl-es/live-persona-card.js":[463133,34496],"./gl-es/lms-integration.js":[null],"./gl-es/meeting-analytics.js":[397258,5954],"./gl-es/meeting-flyout.js":[537582,53909],"./gl-es/meeting-meet-app.js":[null],"./gl-es/meeting-options.js":[323492,88787],"./gl-es/meeting-room-console.js":[777670,85991],"./gl-es/meeting-stream-app.js":[null],"./gl-es/messaging.js":[335954,70279],"./gl-es/nova.js":[null],"./gl-es/people-app.js":[null],"./gl-es/people-picker.js":[945315,34496],"./gl-es/people-targeting.js":[360847,18228],"./gl-es/people.js":[null],"./gl-es/pre-core.js":[null],"./gl-es/recurrence.js":[876569,70200],"./gl-es/search.js":[32893,69971],"./gl-es/semantic-object.js":[865204,33981],"./gl-es/settings.js":[null],"./gl-es/share-to-teams-outlook-addin.js":[null],"./gl-es/share-to-teams.js":[888687,93200],"./gl-es/shortcut.js":[null],"./gl-es/survey.js":[161333,13749],"./gl-es/sv-flyout.js":[null],"./gl-es/teams-and-channels.js":[945788,88558],"./gl-es/tfl-onboarding.js":[null],"./gl-es/toast-notifications.js":[null],"./gl-es/unified-search.js":[886752,93200],"./gl-es/url-preview.js":[385698,70279],"./gl-es/video-capture.js":[434895,70279],"./gl-es/video-message.js":[131718,70279],"./gl-es/virtual-events.js":[null],"./gl-es/webinar.js":[961330,34257],"./he-il/activity.js":[null],"./he-il/auth.js":[null],"./he-il/autosuggest.js":[null],"./he-il/avatar.js":[959602,85333],"./he-il/biometric-enrollment.js":[725446,99598],"./he-il/breakout-rooms.js":[613801,68781],"./he-il/broadcast.js":[957221,54541],"./he-il/calendar.js":[680733,21777],"./he-il/calling.js":[104053,44047],"./he-il/cast.js":[390480,5089],"./he-il/channels.js":[388121,84787],"./he-il/chat-list.js":[177459,62985],"./he-il/coach-report.js":[null],"./he-il/compose.js":[851415,62985],"./he-il/contacts.js":[null],"./he-il/datepicker.js":[186840,49120],"./he-il/desktop.js":[null],"./he-il/digital-signage.js":[null],"./he-il/edu.js":[279873,69622],"./he-il/embed.js":[null],"./he-il/errors.js":[null],"./he-il/esp.js":[978759,13666],"./he-il/extensibility-ptz-extension.js":[null],"./he-il/extensibility-room-remote.js":[null],"./he-il/extensibility.js":[947426,8631],"./he-il/files.js":[923499,19050],"./he-il/framework.js":[622681,85333],"./he-il/freemium.js":[null],"./he-il/funstuff.js":[413215,62985],"./he-il/gallery.js":[834354,9981],"./he-il/guardians.js":[464657,97202],"./he-il/hololens.js":[280646,44047],"./he-il/lightbox.js":[908591,62985],"./he-il/live-persona-card.js":[532384,85333],"./he-il/lms-integration.js":[null],"./he-il/meeting-analytics.js":[110754,98261],"./he-il/meeting-flyout.js":[955884,74783],"./he-il/meeting-meet-app.js":[null],"./he-il/meeting-options.js":[645997,47838],"./he-il/meeting-room-console.js":[648773,91941],"./he-il/meeting-stream-app.js":[null],"./he-il/messaging.js":[146480,62985],"./he-il/nova.js":[null],"./he-il/people-app.js":[null],"./he-il/people-picker.js":[62058,85333],"./he-il/people-targeting.js":[627426,44975],"./he-il/people.js":[null],"./he-il/pre-core.js":[null],"./he-il/recurrence.js":[88528,809],"./he-il/search.js":[919336,49120],"./he-il/semantic-object.js":[480295,37131],"./he-il/settings.js":[null],"./he-il/share-to-teams-outlook-addin.js":[null],"./he-il/share-to-teams.js":[976007,65466],"./he-il/shortcut.js":[null],"./he-il/survey.js":[528169,26816],"./he-il/sv-flyout.js":[null],"./he-il/teams-and-channels.js":[510202,22413],"./he-il/tfl-onboarding.js":[null],"./he-il/toast-notifications.js":[null],"./he-il/unified-search.js":[330809,65466],"./he-il/url-preview.js":[823822,62985],"./he-il/video-capture.js":[143989,62985],"./he-il/video-message.js":[824559,62985],"./he-il/virtual-events.js":[null],"./he-il/webinar.js":[906705,11957],"./hi-in/activity.js":[null],"./hi-in/auth.js":[null],"./hi-in/autosuggest.js":[null],"./hi-in/avatar.js":[428229,70716],"./hi-in/biometric-enrollment.js":[844642,69338],"./hi-in/breakout-rooms.js":[348325,44585],"./hi-in/broadcast.js":[369479,36227],"./hi-in/calendar.js":[647248,80262],"./hi-in/calling.js":[143354,34349],"./hi-in/cast.js":[551565,10784],"./hi-in/channels.js":[571109,60060],"./hi-in/chat-list.js":[72517,93295],"./hi-in/coach-report.js":[null],"./hi-in/compose.js":[616649,93295],"./hi-in/contacts.js":[null],"./hi-in/datepicker.js":[286977,23794],"./hi-in/desktop.js":[null],"./hi-in/digital-signage.js":[null],"./hi-in/edu.js":[96499,35106],"./hi-in/embed.js":[null],"./hi-in/errors.js":[null],"./hi-in/esp.js":[468717,29046],"./hi-in/extensibility-ptz-extension.js":[null],"./hi-in/extensibility-room-remote.js":[null],"./hi-in/extensibility.js":[542502,97758],"./hi-in/files.js":[934060,87598],"./hi-in/framework.js":[521740,70716],"./hi-in/freemium.js":[null],"./hi-in/funstuff.js":[882656,93295],"./hi-in/gallery.js":[195232,30922],"./hi-in/guardians.js":[86813,6336],"./hi-in/hololens.js":[97717,34349],"./hi-in/lightbox.js":[513271,93295],"./hi-in/live-persona-card.js":[868120,70716],"./hi-in/lms-integration.js":[null],"./hi-in/meeting-analytics.js":[68836,10589],"./hi-in/meeting-flyout.js":[798545,8568],"./hi-in/meeting-meet-app.js":[null],"./hi-in/meeting-options.js":[112298,93337],"./hi-in/meeting-room-console.js":[128899,8609],"./hi-in/meeting-stream-app.js":[null],"./hi-in/messaging.js":[757891,93295],"./hi-in/nova.js":[null],"./hi-in/people-app.js":[null],"./hi-in/people-picker.js":[866391,70716],"./hi-in/people-targeting.js":[981659,35833],"./hi-in/people.js":[null],"./hi-in/pre-core.js":[null],"./hi-in/recurrence.js":[991822,22999],"./hi-in/search.js":[691101,23794],"./hi-in/semantic-object.js":[608386,97606],"./hi-in/settings.js":[null],"./hi-in/share-to-teams-outlook-addin.js":[null],"./hi-in/share-to-teams.js":[289648,41064],"./hi-in/shortcut.js":[null],"./hi-in/survey.js":[43284,65054],"./hi-in/sv-flyout.js":[null],"./hi-in/teams-and-channels.js":[161806,29922],"./hi-in/tfl-onboarding.js":[null],"./hi-in/toast-notifications.js":[null],"./hi-in/unified-search.js":[798871,41064],"./hi-in/url-preview.js":[577308,93295],"./hi-in/video-capture.js":[951548,93295],"./hi-in/video-message.js":[231582,93295],"./hi-in/virtual-events.js":[null],"./hi-in/webinar.js":[697294,93288],"./hr-hr/activity.js":[null],"./hr-hr/auth.js":[null],"./hr-hr/autosuggest.js":[null],"./hr-hr/avatar.js":[556611,89109],"./hr-hr/biometric-enrollment.js":[101619,33075],"./hr-hr/breakout-rooms.js":[294497,25570],"./hr-hr/broadcast.js":[864623,83654],"./hr-hr/calendar.js":[279118,71216],"./hr-hr/calling.js":[532841,42044],"./hr-hr/cast.js":[824457,22555],"./hr-hr/channels.js":[145796,28205],"./hr-hr/chat-list.js":[444600,89544],"./hr-hr/coach-report.js":[null],"./hr-hr/compose.js":[466539,89544],"./hr-hr/contacts.js":[null],"./hr-hr/datepicker.js":[827327,70723],"./hr-hr/desktop.js":[null],"./hr-hr/digital-signage.js":[null],"./hr-hr/edu.js":[505418,38221],"./hr-hr/embed.js":[null],"./hr-hr/errors.js":[null],"./hr-hr/esp.js":[490035,88910],"./hr-hr/extensibility-ptz-extension.js":[null],"./hr-hr/extensibility-room-remote.js":[null],"./hr-hr/extensibility.js":[63702,99927],"./hr-hr/files.js":[898204,17652],"./hr-hr/framework.js":[225667,89109],"./hr-hr/freemium.js":[null],"./hr-hr/funstuff.js":[784273,89544],"./hr-hr/gallery.js":[301895,16746],"./hr-hr/guardians.js":[610263,89118],"./hr-hr/hololens.js":[882032,42044],"./hr-hr/lightbox.js":[891561,89544],"./hr-hr/live-persona-card.js":[496288,89109],"./hr-hr/lms-integration.js":[null],"./hr-hr/meeting-analytics.js":[821137,56312],"./hr-hr/meeting-flyout.js":[349010,82754],"./hr-hr/meeting-meet-app.js":[null],"./hr-hr/meeting-options.js":[710573,55228],"./hr-hr/meeting-room-console.js":[131554,38756],"./hr-hr/meeting-stream-app.js":[null],"./hr-hr/messaging.js":[147983,89544],"./hr-hr/nova.js":[null],"./hr-hr/people-app.js":[null],"./hr-hr/people-picker.js":[917806,89109],"./hr-hr/people-targeting.js":[23585,89167],"./hr-hr/people.js":[null],"./hr-hr/pre-core.js":[null],"./hr-hr/recurrence.js":[671969,66467],"./hr-hr/search.js":[495394,70723],"./hr-hr/semantic-object.js":[32077,71678],"./hr-hr/settings.js":[null],"./hr-hr/share-to-teams-outlook-addin.js":[null],"./hr-hr/share-to-teams.js":[305436,82749],"./hr-hr/shortcut.js":[null],"./hr-hr/survey.js":[707897,82117],"./hr-hr/sv-flyout.js":[null],"./hr-hr/teams-and-channels.js":[552242,9436],"./hr-hr/tfl-onboarding.js":[null],"./hr-hr/toast-notifications.js":[null],"./hr-hr/unified-search.js":[890274,82749],"./hr-hr/url-preview.js":[958494,89544],"./hr-hr/video-capture.js":[651386,89544],"./hr-hr/video-message.js":[697410,89544],"./hr-hr/virtual-events.js":[null],"./hr-hr/webinar.js":[185866,77869],"./hu-hu/activity.js":[null],"./hu-hu/auth.js":[null],"./hu-hu/autosuggest.js":[null],"./hu-hu/avatar.js":[589162,20323],"./hu-hu/biometric-enrollment.js":[429251,14727],"./hu-hu/breakout-rooms.js":[491897,23046],"./hu-hu/broadcast.js":[989321,12671],"./hu-hu/calendar.js":[627163,98805],"./hu-hu/calling.js":[527362,99592],"./hu-hu/cast.js":[235279,1496],"./hu-hu/channels.js":[831005,33637],"./hu-hu/chat-list.js":[703405,63233],"./hu-hu/coach-report.js":[null],"./hu-hu/compose.js":[615903,63233],"./hu-hu/contacts.js":[null],"./hu-hu/datepicker.js":[328628,53715],"./hu-hu/desktop.js":[null],"./hu-hu/digital-signage.js":[null],"./hu-hu/edu.js":[853212,5324],"./hu-hu/embed.js":[null],"./hu-hu/errors.js":[null],"./hu-hu/esp.js":[101303,96449],"./hu-hu/extensibility-ptz-extension.js":[null],"./hu-hu/extensibility-room-remote.js":[null],"./hu-hu/extensibility.js":[878493,49721],"./hu-hu/files.js":[365766,54177],"./hu-hu/framework.js":[99476,20323],"./hu-hu/freemium.js":[null],"./hu-hu/funstuff.js":[692889,63233],"./hu-hu/gallery.js":[89249,77527],"./hu-hu/guardians.js":[762806,27910],"./hu-hu/hololens.js":[51030,99592],"./hu-hu/lightbox.js":[834396,63233],"./hu-hu/live-persona-card.js":[708236,20323],"./hu-hu/lms-integration.js":[null],"./hu-hu/meeting-analytics.js":[664611,37589],"./hu-hu/meeting-flyout.js":[380084,66693],"./hu-hu/meeting-meet-app.js":[null],"./hu-hu/meeting-options.js":[67270,50391],"./hu-hu/meeting-room-console.js":[188236,28135],"./hu-hu/meeting-stream-app.js":[null],"./hu-hu/messaging.js":[592174,63233],"./hu-hu/nova.js":[null],"./hu-hu/people-app.js":[null],"./hu-hu/people-picker.js":[92469,20323],"./hu-hu/people-targeting.js":[588313,2488],"./hu-hu/people.js":[null],"./hu-hu/pre-core.js":[null],"./hu-hu/recurrence.js":[604825,27269],"./hu-hu/search.js":[803125,53715],"./hu-hu/semantic-object.js":[394881,98993],"./hu-hu/settings.js":[null],"./hu-hu/share-to-teams-outlook-addin.js":[null],"./hu-hu/share-to-teams.js":[684468,78609],"./hu-hu/shortcut.js":[null],"./hu-hu/survey.js":[512483,7545],"./hu-hu/sv-flyout.js":[null],"./hu-hu/teams-and-channels.js":[646870,85608],"./hu-hu/tfl-onboarding.js":[null],"./hu-hu/toast-notifications.js":[null],"./hu-hu/unified-search.js":[517904,78609],"./hu-hu/url-preview.js":[334218,63233],"./hu-hu/video-capture.js":[942464,63233],"./hu-hu/video-message.js":[506789,63233],"./hu-hu/virtual-events.js":[null],"./hu-hu/webinar.js":[751170,6355],"./id-id/activity.js":[null],"./id-id/auth.js":[null],"./id-id/autosuggest.js":[null],"./id-id/avatar.js":[352273,3846],"./id-id/biometric-enrollment.js":[497856,74896],"./id-id/breakout-rooms.js":[382830,17695],"./id-id/broadcast.js":[88468,3817],"./id-id/calendar.js":[596288,34884],"./id-id/calling.js":[842720,824],"./id-id/cast.js":[976031,37437],"./id-id/channels.js":[400717,2849],"./id-id/chat-list.js":[561838,8124],"./id-id/coach-report.js":[null],"./id-id/compose.js":[586157,8124],"./id-id/contacts.js":[null],"./id-id/datepicker.js":[535325,84517],"./id-id/desktop.js":[null],"./id-id/digital-signage.js":[null],"./id-id/edu.js":[557966,82418],"./id-id/embed.js":[null],"./id-id/errors.js":[null],"./id-id/esp.js":[758262,76370],"./id-id/extensibility-ptz-extension.js":[null],"./id-id/extensibility-room-remote.js":[null],"./id-id/extensibility.js":[916235,2708],"./id-id/files.js":[313630,45170],"./id-id/framework.js":[977620,3846],"./id-id/freemium.js":[null],"./id-id/funstuff.js":[598990,8124],"./id-id/gallery.js":[604464,83059],"./id-id/guardians.js":[89568,45965],"./id-id/hololens.js":[168420,824],"./id-id/lightbox.js":[515570,8124],"./id-id/live-persona-card.js":[417981,3846],"./id-id/lms-integration.js":[null],"./id-id/meeting-analytics.js":[528262,97620],"./id-id/meeting-flyout.js":[540518,86358],"./id-id/meeting-meet-app.js":[null],"./id-id/meeting-options.js":[150396,71993],"./id-id/meeting-room-console.js":[799790,66694],"./id-id/meeting-stream-app.js":[null],"./id-id/messaging.js":[184210,8124],"./id-id/nova.js":[null],"./id-id/people-app.js":[null],"./id-id/people-picker.js":[486492,3846],"./id-id/people-targeting.js":[393998,1659],"./id-id/people.js":[null],"./id-id/pre-core.js":[null],"./id-id/recurrence.js":[889886,67681],"./id-id/search.js":[263449,84517],"./id-id/semantic-object.js":[680061,89676],"./id-id/settings.js":[null],"./id-id/share-to-teams-outlook-addin.js":[null],"./id-id/share-to-teams.js":[288333,89509],"./id-id/shortcut.js":[null],"./id-id/survey.js":[526293,73170],"./id-id/sv-flyout.js":[null],"./id-id/teams-and-channels.js":[446983,48943],"./id-id/tfl-onboarding.js":[null],"./id-id/toast-notifications.js":[null],"./id-id/unified-search.js":[655984,89509],"./id-id/url-preview.js":[946876,8124],"./id-id/video-capture.js":[419699,8124],"./id-id/video-message.js":[192688,8124],"./id-id/virtual-events.js":[null],"./id-id/webinar.js":[667844,76141],"./is-is/activity.js":[null],"./is-is/auth.js":[null],"./is-is/autosuggest.js":[null],"./is-is/avatar.js":[84050,53993],"./is-is/biometric-enrollment.js":[116939,45801],"./is-is/breakout-rooms.js":[513181,31597],"./is-is/broadcast.js":[210414,46873],"./is-is/calendar.js":[26375,73312],"./is-is/calling.js":[549134,81706],"./is-is/cast.js":[77199,89430],"./is-is/channels.js":[142562,65647],"./is-is/chat-list.js":[5169,64876],"./is-is/coach-report.js":[null],"./is-is/compose.js":[299106,64876],"./is-is/contacts.js":[null],"./is-is/datepicker.js":[825719,7620],"./is-is/desktop.js":[null],"./is-is/digital-signage.js":[null],"./is-is/edu.js":[901525,36688],"./is-is/embed.js":[null],"./is-is/errors.js":[null],"./is-is/esp.js":[444941,23402],"./is-is/extensibility-ptz-extension.js":[null],"./is-is/extensibility-room-remote.js":[null],"./is-is/extensibility.js":[727824,98889],"./is-is/files.js":[331673,45877],"./is-is/framework.js":[862425,53993],"./is-is/freemium.js":[null],"./is-is/funstuff.js":[632337,64876],"./is-is/gallery.js":[235860,29837],"./is-is/guardians.js":[629994,97596],"./is-is/hololens.js":[107399,81706],"./is-is/lightbox.js":[256370,64876],"./is-is/live-persona-card.js":[384842,53993],"./is-is/lms-integration.js":[null],"./is-is/meeting-analytics.js":[402334,6552],"./is-is/meeting-flyout.js":[600797,586],"./is-is/meeting-meet-app.js":[null],"./is-is/meeting-options.js":[654528,13692],"./is-is/meeting-room-console.js":[920661,13872],"./is-is/meeting-stream-app.js":[null],"./is-is/messaging.js":[475169,64876],"./is-is/nova.js":[null],"./is-is/people-app.js":[null],"./is-is/people-picker.js":[443950,53993],"./is-is/people-targeting.js":[946242,15078],"./is-is/people.js":[null],"./is-is/pre-core.js":[null],"./is-is/recurrence.js":[705605,13838],"./is-is/search.js":[642507,7620],"./is-is/semantic-object.js":[545366,13507],"./is-is/settings.js":[null],"./is-is/share-to-teams-outlook-addin.js":[null],"./is-is/share-to-teams.js":[593252,80127],"./is-is/shortcut.js":[null],"./is-is/survey.js":[851432,23968],"./is-is/sv-flyout.js":[null],"./is-is/teams-and-channels.js":[274137,93400],"./is-is/tfl-onboarding.js":[null],"./is-is/toast-notifications.js":[null],"./is-is/unified-search.js":[258366,80127],"./is-is/url-preview.js":[741075,64876],"./is-is/video-capture.js":[515739,64876],"./is-is/video-message.js":[448634,64876],"./is-is/virtual-events.js":[null],"./is-is/webinar.js":[421989,64010],"./it-it/activity.js":[null],"./it-it/auth.js":[null],"./it-it/autosuggest.js":[null],"./it-it/avatar.js":[113258,1983],"./it-it/biometric-enrollment.js":[217654,14095],"./it-it/breakout-rooms.js":[661054,93241],"./it-it/broadcast.js":[398028,62382],"./it-it/calendar.js":[181531,45999],"./it-it/calling.js":[899116,97119],"./it-it/cast.js":[10294,66610],"./it-it/channels.js":[51845,94061],"./it-it/chat-list.js":[594336,91143],"./it-it/coach-report.js":[null],"./it-it/compose.js":[561395,91143],"./it-it/contacts.js":[null],"./it-it/datepicker.js":[776049,76293],"./it-it/desktop.js":[null],"./it-it/digital-signage.js":[null],"./it-it/edu.js":[5866,45328],"./it-it/embed.js":[null],"./it-it/errors.js":[null],"./it-it/esp.js":[148165,17984],"./it-it/extensibility-ptz-extension.js":[null],"./it-it/extensibility-room-remote.js":[null],"./it-it/extensibility.js":[963736,47511],"./it-it/files.js":[173495,67326],"./it-it/framework.js":[426910,1983],"./it-it/freemium.js":[null],"./it-it/funstuff.js":[224927,91143],"./it-it/gallery.js":[54677,7215],"./it-it/guardians.js":[601728,3301],"./it-it/hololens.js":[939027,97119],"./it-it/lightbox.js":[847917,91143],"./it-it/live-persona-card.js":[490468,1983],"./it-it/lms-integration.js":[null],"./it-it/meeting-analytics.js":[35350,91068],"./it-it/meeting-flyout.js":[295002,5589],"./it-it/meeting-meet-app.js":[null],"./it-it/meeting-options.js":[864705,56864],"./it-it/meeting-room-console.js":[434179,69085],"./it-it/meeting-stream-app.js":[null],"./it-it/messaging.js":[210444,91143],"./it-it/nova.js":[null],"./it-it/people-app.js":[null],"./it-it/people-picker.js":[388501,1983],"./it-it/people-targeting.js":[875195,61537],"./it-it/people.js":[null],"./it-it/pre-core.js":[null],"./it-it/recurrence.js":[962813,25312],"./it-it/search.js":[745475,76293],"./it-it/semantic-object.js":[775580,48923],"./it-it/settings.js":[null],"./it-it/share-to-teams-outlook-addin.js":[null],"./it-it/share-to-teams.js":[447229,65844],"./it-it/shortcut.js":[null],"./it-it/survey.js":[838575,64279],"./it-it/sv-flyout.js":[null],"./it-it/teams-and-channels.js":[218005,81933],"./it-it/tfl-onboarding.js":[null],"./it-it/toast-notifications.js":[null],"./it-it/unified-search.js":[134738,65844],"./it-it/url-preview.js":[702626,91143],"./it-it/video-capture.js":[381812,91143],"./it-it/video-message.js":[386781,91143],"./it-it/virtual-events.js":[null],"./it-it/webinar.js":[770361,11969],"./ja-jp/activity.js":[null],"./ja-jp/auth.js":[null],"./ja-jp/autosuggest.js":[null],"./ja-jp/avatar.js":[103314,4615],"./ja-jp/biometric-enrollment.js":[438159,20545],"./ja-jp/breakout-rooms.js":[600172,13847],"./ja-jp/broadcast.js":[936844,7783],"./ja-jp/calendar.js":[886239,22423],"./ja-jp/calling.js":[254014,42337],"./ja-jp/cast.js":[660853,54573],"./ja-jp/channels.js":[618273,30864],"./ja-jp/chat-list.js":[111241,91487],"./ja-jp/coach-report.js":[null],"./ja-jp/compose.js":[994212,91487],"./ja-jp/contacts.js":[null],"./ja-jp/datepicker.js":[656517,40221],"./ja-jp/desktop.js":[null],"./ja-jp/digital-signage.js":[null],"./ja-jp/edu.js":[261419,12782],"./ja-jp/embed.js":[null],"./ja-jp/errors.js":[null],"./ja-jp/esp.js":[943975,6373],"./ja-jp/extensibility-ptz-extension.js":[null],"./ja-jp/extensibility-room-remote.js":[null],"./ja-jp/extensibility.js":[626302,11827],"./ja-jp/files.js":[854450,17475],"./ja-jp/framework.js":[482063,4615],"./ja-jp/freemium.js":[null],"./ja-jp/funstuff.js":[238081,91487],"./ja-jp/gallery.js":[964809,33603],"./ja-jp/guardians.js":[261537,62036],"./ja-jp/hololens.js":[622894,42337],"./ja-jp/lightbox.js":[28375,91487],"./ja-jp/live-persona-card.js":[748622,4615],"./ja-jp/lms-integration.js":[null],"./ja-jp/meeting-analytics.js":[281811,16705],"./ja-jp/meeting-flyout.js":[446786,67450],"./ja-jp/meeting-meet-app.js":[null],"./ja-jp/meeting-options.js":[326721,5421],"./ja-jp/meeting-room-console.js":[176045,77285],"./ja-jp/meeting-stream-app.js":[null],"./ja-jp/messaging.js":[674781,91487],"./ja-jp/nova.js":[null],"./ja-jp/people-app.js":[null],"./ja-jp/people-picker.js":[782286,4615],"./ja-jp/people-targeting.js":[980739,20267],"./ja-jp/people.js":[null],"./ja-jp/pre-core.js":[null],"./ja-jp/recurrence.js":[854420,37458],"./ja-jp/search.js":[216316,40221],"./ja-jp/semantic-object.js":[686134,4289],"./ja-jp/settings.js":[null],"./ja-jp/share-to-teams-outlook-addin.js":[null],"./ja-jp/share-to-teams.js":[966618,99951],"./ja-jp/shortcut.js":[null],"./ja-jp/survey.js":[354003,35110],"./ja-jp/sv-flyout.js":[null],"./ja-jp/teams-and-channels.js":[353520,23891],"./ja-jp/tfl-onboarding.js":[null],"./ja-jp/toast-notifications.js":[null],"./ja-jp/unified-search.js":[555706,99951],"./ja-jp/url-preview.js":[743275,91487],"./ja-jp/video-capture.js":[764734,91487],"./ja-jp/video-message.js":[804636,91487],"./ja-jp/virtual-events.js":[null],"./ja-jp/webinar.js":[877228,44126],"./ka-ge/activity.js":[null],"./ka-ge/auth.js":[null],"./ka-ge/autosuggest.js":[null],"./ka-ge/avatar.js":[854187,10562],"./ka-ge/biometric-enrollment.js":[979622,4411],"./ka-ge/breakout-rooms.js":[701408,81381],"./ka-ge/broadcast.js":[942527,38653],"./ka-ge/calendar.js":[440981,87310],"./ka-ge/calling.js":[377770,53613],"./ka-ge/cast.js":[420824,14381],"./ka-ge/channels.js":[504426,52995],"./ka-ge/chat-list.js":[315898,23516],"./ka-ge/coach-report.js":[null],"./ka-ge/compose.js":[54162,23516],"./ka-ge/contacts.js":[null],"./ka-ge/datepicker.js":[609074,18026],"./ka-ge/desktop.js":[null],"./ka-ge/digital-signage.js":[null],"./ka-ge/edu.js":[266675,34526],"./ka-ge/embed.js":[null],"./ka-ge/errors.js":[null],"./ka-ge/esp.js":[999189,22842],"./ka-ge/extensibility-ptz-extension.js":[null],"./ka-ge/extensibility-room-remote.js":[null],"./ka-ge/extensibility.js":[393009,3232],"./ka-ge/files.js":[503075,93007],"./ka-ge/framework.js":[872417,10562],"./ka-ge/freemium.js":[null],"./ka-ge/funstuff.js":[609678,23516],"./ka-ge/gallery.js":[114852,2559],"./ka-ge/guardians.js":[18825,84197],"./ka-ge/hololens.js":[119428,53613],"./ka-ge/lightbox.js":[318997,23516],"./ka-ge/live-persona-card.js":[140020,10562],"./ka-ge/lms-integration.js":[null],"./ka-ge/meeting-analytics.js":[577252,91504],"./ka-ge/meeting-flyout.js":[574546,98436],"./ka-ge/meeting-meet-app.js":[null],"./ka-ge/meeting-options.js":[34332,28256],"./ka-ge/meeting-room-console.js":[413182,14166],"./ka-ge/meeting-stream-app.js":[null],"./ka-ge/messaging.js":[856109,23516],"./ka-ge/nova.js":[null],"./ka-ge/people-app.js":[null],"./ka-ge/people-picker.js":[513957,10562],"./ka-ge/people-targeting.js":[740518,39435],"./ka-ge/people.js":[null],"./ka-ge/pre-core.js":[null],"./ka-ge/recurrence.js":[853475,98872],"./ka-ge/search.js":[496668,18026],"./ka-ge/semantic-object.js":[207404,23169],"./ka-ge/settings.js":[null],"./ka-ge/share-to-teams-outlook-addin.js":[null],"./ka-ge/share-to-teams.js":[985756,94259],"./ka-ge/shortcut.js":[null],"./ka-ge/survey.js":[203471,27954],"./ka-ge/sv-flyout.js":[null],"./ka-ge/teams-and-channels.js":[725321,3983],"./ka-ge/tfl-onboarding.js":[null],"./ka-ge/toast-notifications.js":[null],"./ka-ge/unified-search.js":[24541,94259],"./ka-ge/url-preview.js":[76306,23516],"./ka-ge/video-capture.js":[265605,23516],"./ka-ge/video-message.js":[660584,23516],"./ka-ge/virtual-events.js":[null],"./ka-ge/webinar.js":[886662,32719],"./kk-kz/activity.js":[null],"./kk-kz/auth.js":[null],"./kk-kz/autosuggest.js":[null],"./kk-kz/avatar.js":[644035,78456],"./kk-kz/biometric-enrollment.js":[608197,68597],"./kk-kz/breakout-rooms.js":[747723,21311],"./kk-kz/broadcast.js":[398711,54270],"./kk-kz/calendar.js":[992264,83772],"./kk-kz/calling.js":[986196,39079],"./kk-kz/cast.js":[279850,57561],"./kk-kz/channels.js":[44654,83438],"./kk-kz/chat-list.js":[233306,68722],"./kk-kz/coach-report.js":[null],"./kk-kz/compose.js":[816436,68722],"./kk-kz/contacts.js":[null],"./kk-kz/datepicker.js":[565151,80570],"./kk-kz/desktop.js":[null],"./kk-kz/digital-signage.js":[null],"./kk-kz/edu.js":[940059,1876],"./kk-kz/embed.js":[null],"./kk-kz/errors.js":[null],"./kk-kz/esp.js":[270787,18418],"./kk-kz/extensibility-ptz-extension.js":[null],"./kk-kz/extensibility-room-remote.js":[null],"./kk-kz/extensibility.js":[724784,58557],"./kk-kz/files.js":[610795,52781],"./kk-kz/framework.js":[636806,78456],"./kk-kz/freemium.js":[null],"./kk-kz/funstuff.js":[862722,68722],"./kk-kz/gallery.js":[53175,85421],"./kk-kz/guardians.js":[853197,24149],"./kk-kz/hololens.js":[544318,39079],"./kk-kz/lightbox.js":[780100,68722],"./kk-kz/live-persona-card.js":[560367,78456],"./kk-kz/lms-integration.js":[null],"./kk-kz/meeting-analytics.js":[405663,97282],"./kk-kz/meeting-flyout.js":[248562,2060],"./kk-kz/meeting-meet-app.js":[null],"./kk-kz/meeting-options.js":[71884,97014],"./kk-kz/meeting-room-console.js":[774387,82901],"./kk-kz/meeting-stream-app.js":[null],"./kk-kz/messaging.js":[696721,68722],"./kk-kz/nova.js":[null],"./kk-kz/people-app.js":[null],"./kk-kz/people-picker.js":[479879,78456],"./kk-kz/people-targeting.js":[303664,53267],"./kk-kz/people.js":[null],"./kk-kz/pre-core.js":[null],"./kk-kz/recurrence.js":[703317,35568],"./kk-kz/search.js":[96959,80570],"./kk-kz/semantic-object.js":[245439,2016],"./kk-kz/settings.js":[null],"./kk-kz/share-to-teams-outlook-addin.js":[null],"./kk-kz/share-to-teams.js":[937697,53228],"./kk-kz/shortcut.js":[null],"./kk-kz/survey.js":[280171,89043],"./kk-kz/sv-flyout.js":[null],"./kk-kz/teams-and-channels.js":[700601,5462],"./kk-kz/tfl-onboarding.js":[null],"./kk-kz/toast-notifications.js":[null],"./kk-kz/unified-search.js":[254145,53228],"./kk-kz/url-preview.js":[945944,68722],"./kk-kz/video-capture.js":[395765,68722],"./kk-kz/video-message.js":[570918,68722],"./kk-kz/virtual-events.js":[null],"./kk-kz/webinar.js":[430398,55192],"./ko-kr/activity.js":[null],"./ko-kr/auth.js":[null],"./ko-kr/autosuggest.js":[null],"./ko-kr/avatar.js":[142220,67526],"./ko-kr/biometric-enrollment.js":[172785,31811],"./ko-kr/breakout-rooms.js":[339255,76274],"./ko-kr/broadcast.js":[799877,5400],"./ko-kr/calendar.js":[918398,11943],"./ko-kr/calling.js":[613762,74515],"./ko-kr/cast.js":[799895,45924],"./ko-kr/channels.js":[611674,2308],"./ko-kr/chat-list.js":[997333,39845],"./ko-kr/coach-report.js":[null],"./ko-kr/compose.js":[533207,39845],"./ko-kr/contacts.js":[null],"./ko-kr/datepicker.js":[951748,7523],"./ko-kr/desktop.js":[null],"./ko-kr/digital-signage.js":[null],"./ko-kr/edu.js":[546534,12657],"./ko-kr/embed.js":[null],"./ko-kr/errors.js":[null],"./ko-kr/esp.js":[473811,94658],"./ko-kr/extensibility-ptz-extension.js":[null],"./ko-kr/extensibility-room-remote.js":[null],"./ko-kr/extensibility.js":[893292,29497],"./ko-kr/files.js":[829761,67742],"./ko-kr/framework.js":[539406,67526],"./ko-kr/freemium.js":[null],"./ko-kr/funstuff.js":[287325,39845],"./ko-kr/gallery.js":[673912,54223],"./ko-kr/guardians.js":[576846,65025],"./ko-kr/hololens.js":[863448,74515],"./ko-kr/lightbox.js":[129202,39845],"./ko-kr/live-persona-card.js":[38663,67526],"./ko-kr/lms-integration.js":[null],"./ko-kr/meeting-analytics.js":[963234,67960],"./ko-kr/meeting-flyout.js":[45488,90720],"./ko-kr/meeting-meet-app.js":[null],"./ko-kr/meeting-options.js":[92316,50480],"./ko-kr/meeting-room-console.js":[9559,33738],"./ko-kr/meeting-stream-app.js":[null],"./ko-kr/messaging.js":[688132,39845],"./ko-kr/nova.js":[null],"./ko-kr/people-app.js":[null],"./ko-kr/people-picker.js":[275250,67526],"./ko-kr/people-targeting.js":[390319,2376],"./ko-kr/people.js":[null],"./ko-kr/pre-core.js":[null],"./ko-kr/recurrence.js":[252254,19856],"./ko-kr/search.js":[987897,7523],"./ko-kr/semantic-object.js":[538807,88531],"./ko-kr/settings.js":[null],"./ko-kr/share-to-teams-outlook-addin.js":[null],"./ko-kr/share-to-teams.js":[419049,55206],"./ko-kr/shortcut.js":[null],"./ko-kr/survey.js":[340334,772],"./ko-kr/sv-flyout.js":[null],"./ko-kr/teams-and-channels.js":[579635,62763],"./ko-kr/tfl-onboarding.js":[null],"./ko-kr/toast-notifications.js":[null],"./ko-kr/unified-search.js":[160176,55206],"./ko-kr/url-preview.js":[806062,39845],"./ko-kr/video-capture.js":[6559,39845],"./ko-kr/video-message.js":[254545,39845],"./ko-kr/virtual-events.js":[null],"./ko-kr/webinar.js":[452066,67949],"./lt-lt/activity.js":[null],"./lt-lt/auth.js":[null],"./lt-lt/autosuggest.js":[null],"./lt-lt/avatar.js":[560712,81205],"./lt-lt/biometric-enrollment.js":[419061,74471],"./lt-lt/breakout-rooms.js":[508157,27112],"./lt-lt/broadcast.js":[382227,19534],"./lt-lt/calendar.js":[759586,64878],"./lt-lt/calling.js":[208768,53247],"./lt-lt/cast.js":[894308,96848],"./lt-lt/channels.js":[323301,18927],"./lt-lt/chat-list.js":[144462,29569],"./lt-lt/coach-report.js":[null],"./lt-lt/compose.js":[941041,29569],"./lt-lt/contacts.js":[null],"./lt-lt/datepicker.js":[726576,9014],"./lt-lt/desktop.js":[null],"./lt-lt/digital-signage.js":[null],"./lt-lt/edu.js":[381101,43532],"./lt-lt/embed.js":[null],"./lt-lt/errors.js":[null],"./lt-lt/esp.js":[183465,33488],"./lt-lt/extensibility-ptz-extension.js":[null],"./lt-lt/extensibility-room-remote.js":[null],"./lt-lt/extensibility.js":[18564,99182],"./lt-lt/files.js":[841429,6055],"./lt-lt/framework.js":[996939,81205],"./lt-lt/freemium.js":[null],"./lt-lt/funstuff.js":[30081,29569],"./lt-lt/gallery.js":[676475,93467],"./lt-lt/guardians.js":[533745,99710],"./lt-lt/hololens.js":[239435,53247],"./lt-lt/lightbox.js":[416221,29569],"./lt-lt/live-persona-card.js":[589988,81205],"./lt-lt/lms-integration.js":[null],"./lt-lt/meeting-analytics.js":[750474,58670],"./lt-lt/meeting-flyout.js":[266175,28859],"./lt-lt/meeting-meet-app.js":[null],"./lt-lt/meeting-options.js":[85676,8735],"./lt-lt/meeting-room-console.js":[772153,29559],"./lt-lt/meeting-stream-app.js":[null],"./lt-lt/messaging.js":[807707,29569],"./lt-lt/nova.js":[null],"./lt-lt/people-app.js":[null],"./lt-lt/people-picker.js":[135602,81205],"./lt-lt/people-targeting.js":[561677,29401],"./lt-lt/people.js":[null],"./lt-lt/pre-core.js":[null],"./lt-lt/recurrence.js":[18321,35551],"./lt-lt/search.js":[631250,9014],"./lt-lt/semantic-object.js":[700448,43505],"./lt-lt/settings.js":[null],"./lt-lt/share-to-teams-outlook-addin.js":[null],"./lt-lt/share-to-teams.js":[624078,50293],"./lt-lt/shortcut.js":[null],"./lt-lt/survey.js":[489045,15522],"./lt-lt/sv-flyout.js":[null],"./lt-lt/teams-and-channels.js":[747538,92444],"./lt-lt/tfl-onboarding.js":[null],"./lt-lt/toast-notifications.js":[null],"./lt-lt/unified-search.js":[381320,50293],"./lt-lt/url-preview.js":[833398,29569],"./lt-lt/video-capture.js":[216140,29569],"./lt-lt/video-message.js":[434840,29569],"./lt-lt/virtual-events.js":[null],"./lt-lt/webinar.js":[914362,38693],"./lv-lv/activity.js":[null],"./lv-lv/auth.js":[null],"./lv-lv/autosuggest.js":[null],"./lv-lv/avatar.js":[890133,926],"./lv-lv/biometric-enrollment.js":[995924,34869],"./lv-lv/breakout-rooms.js":[508130,35731],"./lv-lv/broadcast.js":[733048,57610],"./lv-lv/calendar.js":[28132,9372],"./lv-lv/calling.js":[93116,17542],"./lv-lv/cast.js":[933752,98787],"./lv-lv/channels.js":[444587,25026],"./lv-lv/chat-list.js":[31725,26858],"./lv-lv/coach-report.js":[null],"./lv-lv/compose.js":[842524,26858],"./lv-lv/contacts.js":[null],"./lv-lv/datepicker.js":[99505,58444],"./lv-lv/desktop.js":[null],"./lv-lv/digital-signage.js":[null],"./lv-lv/edu.js":[692181,94779],"./lv-lv/embed.js":[null],"./lv-lv/errors.js":[null],"./lv-lv/esp.js":[913396,46697],"./lv-lv/extensibility-ptz-extension.js":[null],"./lv-lv/extensibility-room-remote.js":[null],"./lv-lv/extensibility.js":[715985,86018],"./lv-lv/files.js":[939108,5053],"./lv-lv/framework.js":[991326,926],"./lv-lv/freemium.js":[null],"./lv-lv/funstuff.js":[669100,26858],"./lv-lv/gallery.js":[122904,987],"./lv-lv/guardians.js":[573703,11908],"./lv-lv/hololens.js":[837548,17542],"./lv-lv/lightbox.js":[272099,26858],"./lv-lv/live-persona-card.js":[462857,926],"./lv-lv/lms-integration.js":[null],"./lv-lv/meeting-analytics.js":[664849,68312],"./lv-lv/meeting-flyout.js":[548682,71835],"./lv-lv/meeting-meet-app.js":[null],"./lv-lv/meeting-options.js":[688730,67977],"./lv-lv/meeting-room-console.js":[303599,78402],"./lv-lv/meeting-stream-app.js":[null],"./lv-lv/messaging.js":[647054,26858],"./lv-lv/nova.js":[null],"./lv-lv/people-app.js":[null],"./lv-lv/people-picker.js":[622496,926],"./lv-lv/people-targeting.js":[394882,73523],"./lv-lv/people.js":[null],"./lv-lv/pre-core.js":[null],"./lv-lv/recurrence.js":[841922,48683],"./lv-lv/search.js":[69441,58444],"./lv-lv/semantic-object.js":[741570,88901],"./lv-lv/settings.js":[null],"./lv-lv/share-to-teams-outlook-addin.js":[null],"./lv-lv/share-to-teams.js":[229842,51317],"./lv-lv/shortcut.js":[null],"./lv-lv/survey.js":[290285,47282],"./lv-lv/sv-flyout.js":[null],"./lv-lv/teams-and-channels.js":[951495,8174],"./lv-lv/tfl-onboarding.js":[null],"./lv-lv/toast-notifications.js":[null],"./lv-lv/unified-search.js":[213720,51317],"./lv-lv/url-preview.js":[871092,26858],"./lv-lv/video-capture.js":[529535,26858],"./lv-lv/video-message.js":[701829,26858],"./lv-lv/virtual-events.js":[null],"./lv-lv/webinar.js":[622197,34255],"./mk-mk/activity.js":[null],"./mk-mk/auth.js":[null],"./mk-mk/autosuggest.js":[null],"./mk-mk/avatar.js":[317522,38437],"./mk-mk/biometric-enrollment.js":[329561,60100],"./mk-mk/breakout-rooms.js":[941650,36720],"./mk-mk/broadcast.js":[602441,42119],"./mk-mk/calendar.js":[437019,21978],"./mk-mk/calling.js":[720616,57],"./mk-mk/cast.js":[245263,67676],"./mk-mk/channels.js":[361645,76940],"./mk-mk/chat-list.js":[248254,36794],"./mk-mk/coach-report.js":[null],"./mk-mk/compose.js":[637823,36794],"./mk-mk/contacts.js":[null],"./mk-mk/datepicker.js":[673538,673],"./mk-mk/desktop.js":[null],"./mk-mk/digital-signage.js":[null],"./mk-mk/edu.js":[180414,58485],"./mk-mk/embed.js":[null],"./mk-mk/errors.js":[null],"./mk-mk/esp.js":[127773,70602],"./mk-mk/extensibility-ptz-extension.js":[null],"./mk-mk/extensibility-room-remote.js":[null],"./mk-mk/extensibility.js":[21305,9082],"./mk-mk/files.js":[108999,65151],"./mk-mk/framework.js":[463391,38437],"./mk-mk/freemium.js":[null],"./mk-mk/funstuff.js":[972483,36794],"./mk-mk/gallery.js":[635976,21786],"./mk-mk/guardians.js":[559779,53277],"./mk-mk/hololens.js":[723614,57],"./mk-mk/lightbox.js":[280982,36794],"./mk-mk/live-persona-card.js":[889510,38437],"./mk-mk/lms-integration.js":[null],"./mk-mk/meeting-analytics.js":[895901,37689],"./mk-mk/meeting-flyout.js":[800708,44264],"./mk-mk/meeting-meet-app.js":[null],"./mk-mk/meeting-options.js":[769873,78334],"./mk-mk/meeting-room-console.js":[692662,14368],"./mk-mk/meeting-stream-app.js":[null],"./mk-mk/messaging.js":[742921,36794],"./mk-mk/nova.js":[null],"./mk-mk/people-app.js":[null],"./mk-mk/people-picker.js":[500598,38437],"./mk-mk/people-targeting.js":[170001,52683],"./mk-mk/people.js":[null],"./mk-mk/pre-core.js":[null],"./mk-mk/recurrence.js":[757355,81102],"./mk-mk/search.js":[431751,673],"./mk-mk/semantic-object.js":[264360,21083],"./mk-mk/settings.js":[null],"./mk-mk/share-to-teams-outlook-addin.js":[null],"./mk-mk/share-to-teams.js":[298113,29122],"./mk-mk/shortcut.js":[null],"./mk-mk/survey.js":[705062,39308],"./mk-mk/sv-flyout.js":[null],"./mk-mk/teams-and-channels.js":[648120,69177],"./mk-mk/tfl-onboarding.js":[null],"./mk-mk/toast-notifications.js":[null],"./mk-mk/unified-search.js":[511422,29122],"./mk-mk/url-preview.js":[77556,36794],"./mk-mk/video-capture.js":[801625,36794],"./mk-mk/video-message.js":[612707,36794],"./mk-mk/virtual-events.js":[null],"./mk-mk/webinar.js":[682103,87329],"./nb-no/activity.js":[null],"./nb-no/auth.js":[null],"./nb-no/autosuggest.js":[null],"./nb-no/avatar.js":[597638,4128],"./nb-no/biometric-enrollment.js":[757379,97704],"./nb-no/breakout-rooms.js":[946421,51359],"./nb-no/broadcast.js":[859035,22312],"./nb-no/calendar.js":[22512,63054],"./nb-no/calling.js":[789290,44145],"./nb-no/cast.js":[57023,1556],"./nb-no/channels.js":[699907,74322],"./nb-no/chat-list.js":[157447,25471],"./nb-no/coach-report.js":[null],"./nb-no/compose.js":[506129,25471],"./nb-no/contacts.js":[null],"./nb-no/datepicker.js":[271741,38699],"./nb-no/desktop.js":[null],"./nb-no/digital-signage.js":[null],"./nb-no/edu.js":[927034,54594],"./nb-no/embed.js":[null],"./nb-no/errors.js":[null],"./nb-no/esp.js":[565991,32897],"./nb-no/extensibility-ptz-extension.js":[null],"./nb-no/extensibility-room-remote.js":[null],"./nb-no/extensibility.js":[343131,70542],"./nb-no/files.js":[254800,15783],"./nb-no/framework.js":[466244,4128],"./nb-no/freemium.js":[null],"./nb-no/funstuff.js":[389772,25471],"./nb-no/gallery.js":[550744,77067],"./nb-no/guardians.js":[211555,96793],"./nb-no/hololens.js":[112147,44145],"./nb-no/lightbox.js":[405336,25471],"./nb-no/live-persona-card.js":[39571,4128],"./nb-no/lms-integration.js":[null],"./nb-no/meeting-analytics.js":[757084,21993],"./nb-no/meeting-flyout.js":[140228,7169],"./nb-no/meeting-meet-app.js":[null],"./nb-no/meeting-options.js":[950514,33346],"./nb-no/meeting-room-console.js":[423661,80540],"./nb-no/meeting-stream-app.js":[null],"./nb-no/messaging.js":[762883,25471],"./nb-no/nova.js":[null],"./nb-no/people-app.js":[null],"./nb-no/people-picker.js":[64498,4128],"./nb-no/people-targeting.js":[308676,34279],"./nb-no/people.js":[null],"./nb-no/pre-core.js":[null],"./nb-no/recurrence.js":[993668,73142],"./nb-no/search.js":[91168,38699],"./nb-no/semantic-object.js":[625061,20573],"./nb-no/settings.js":[null],"./nb-no/share-to-teams-outlook-addin.js":[null],"./nb-no/share-to-teams.js":[203257,97548],"./nb-no/shortcut.js":[null],"./nb-no/survey.js":[742775,26332],"./nb-no/sv-flyout.js":[null],"./nb-no/teams-and-channels.js":[120451,99617],"./nb-no/tfl-onboarding.js":[null],"./nb-no/toast-notifications.js":[null],"./nb-no/unified-search.js":[844892,97548],"./nb-no/url-preview.js":[73737,25471],"./nb-no/video-capture.js":[76751,25471],"./nb-no/video-message.js":[393337,25471],"./nb-no/virtual-events.js":[null],"./nb-no/webinar.js":[333161,48226],"./nl-nl/activity.js":[null],"./nl-nl/auth.js":[null],"./nl-nl/autosuggest.js":[null],"./nl-nl/avatar.js":[84998,34652],"./nl-nl/biometric-enrollment.js":[912494,74801],"./nl-nl/breakout-rooms.js":[390829,90580],"./nl-nl/broadcast.js":[379404,20158],"./nl-nl/calendar.js":[505173,36406],"./nl-nl/calling.js":[624511,82098],"./nl-nl/cast.js":[136668,83423],"./nl-nl/channels.js":[116294,94219],"./nl-nl/chat-list.js":[781037,17285],"./nl-nl/coach-report.js":[null],"./nl-nl/compose.js":[588338,17285],"./nl-nl/contacts.js":[null],"./nl-nl/datepicker.js":[197339,39036],"./nl-nl/desktop.js":[null],"./nl-nl/digital-signage.js":[null],"./nl-nl/edu.js":[426291,13271],"./nl-nl/embed.js":[null],"./nl-nl/errors.js":[null],"./nl-nl/esp.js":[781514,1924],"./nl-nl/extensibility-ptz-extension.js":[null],"./nl-nl/extensibility-room-remote.js":[null],"./nl-nl/extensibility.js":[270966,21167],"./nl-nl/files.js":[891205,95772],"./nl-nl/framework.js":[957889,34652],"./nl-nl/freemium.js":[null],"./nl-nl/funstuff.js":[606518,17285],"./nl-nl/gallery.js":[267378,8118],"./nl-nl/guardians.js":[773846,6929],"./nl-nl/hololens.js":[842646,82098],"./nl-nl/lightbox.js":[517741,17285],"./nl-nl/live-persona-card.js":[599794,34652],"./nl-nl/lms-integration.js":[null],"./nl-nl/meeting-analytics.js":[296833,7850],"./nl-nl/meeting-flyout.js":[369413,48550],"./nl-nl/meeting-meet-app.js":[null],"./nl-nl/meeting-options.js":[271238,6063],"./nl-nl/meeting-room-console.js":[318826,658],"./nl-nl/meeting-stream-app.js":[null],"./nl-nl/messaging.js":[695026,17285],"./nl-nl/nova.js":[null],"./nl-nl/people-app.js":[null],"./nl-nl/people-picker.js":[597558,34652],"./nl-nl/people-targeting.js":[382970,32085],"./nl-nl/people.js":[null],"./nl-nl/pre-core.js":[null],"./nl-nl/recurrence.js":[729195,15999],"./nl-nl/search.js":[246018,39036],"./nl-nl/semantic-object.js":[258087,45702],"./nl-nl/settings.js":[null],"./nl-nl/share-to-teams-outlook-addin.js":[null],"./nl-nl/share-to-teams.js":[31033,54569],"./nl-nl/shortcut.js":[null],"./nl-nl/survey.js":[997613,73051],"./nl-nl/sv-flyout.js":[null],"./nl-nl/teams-and-channels.js":[747540,95052],"./nl-nl/tfl-onboarding.js":[null],"./nl-nl/toast-notifications.js":[null],"./nl-nl/unified-search.js":[871460,54569],"./nl-nl/url-preview.js":[667828,17285],"./nl-nl/video-capture.js":[356066,17285],"./nl-nl/video-message.js":[936528,17285],"./nl-nl/virtual-events.js":[null],"./nl-nl/webinar.js":[374272,20397],"./nn-no/activity.js":[null],"./nn-no/auth.js":[null],"./nn-no/autosuggest.js":[null],"./nn-no/avatar.js":[895426,23190],"./nn-no/biometric-enrollment.js":[811554,49241],"./nn-no/breakout-rooms.js":[921195,53637],"./nn-no/broadcast.js":[110069,14712],"./nn-no/calendar.js":[599780,91138],"./nn-no/calling.js":[56636,79355],"./nn-no/cast.js":[216462,11131],"./nn-no/channels.js":[214962,33485],"./nn-no/chat-list.js":[898327,85358],"./nn-no/coach-report.js":[null],"./nn-no/compose.js":[11995,85358],"./nn-no/contacts.js":[null],"./nn-no/datepicker.js":[64047,66525],"./nn-no/desktop.js":[null],"./nn-no/digital-signage.js":[null],"./nn-no/edu.js":[792650,4822],"./nn-no/embed.js":[null],"./nn-no/errors.js":[null],"./nn-no/esp.js":[64748,92784],"./nn-no/extensibility-ptz-extension.js":[null],"./nn-no/extensibility-room-remote.js":[null],"./nn-no/extensibility.js":[804227,72297],"./nn-no/files.js":[758782,11125],"./nn-no/framework.js":[24013,23190],"./nn-no/freemium.js":[null],"./nn-no/funstuff.js":[321986,85358],"./nn-no/gallery.js":[24587,85470],"./nn-no/guardians.js":[141296,4299],"./nn-no/hololens.js":[664119,79355],"./nn-no/lightbox.js":[18645,85358],"./nn-no/live-persona-card.js":[992348,23190],"./nn-no/lms-integration.js":[null],"./nn-no/meeting-analytics.js":[330444,61386],"./nn-no/meeting-flyout.js":[182268,86194],"./nn-no/meeting-meet-app.js":[null],"./nn-no/meeting-options.js":[503481,14834],"./nn-no/meeting-room-console.js":[443166,90658],"./nn-no/meeting-stream-app.js":[null],"./nn-no/messaging.js":[439151,85358],"./nn-no/nova.js":[null],"./nn-no/people-app.js":[null],"./nn-no/people-picker.js":[622566,23190],"./nn-no/people-targeting.js":[819662,64108],"./nn-no/people.js":[null],"./nn-no/pre-core.js":[null],"./nn-no/recurrence.js":[42812,17662],"./nn-no/search.js":[812534,66525],"./nn-no/semantic-object.js":[251843,74786],"./nn-no/settings.js":[null],"./nn-no/share-to-teams-outlook-addin.js":[null],"./nn-no/share-to-teams.js":[778777,96317],"./nn-no/shortcut.js":[null],"./nn-no/survey.js":[638835,90189],"./nn-no/sv-flyout.js":[null],"./nn-no/teams-and-channels.js":[967152,27214],"./nn-no/tfl-onboarding.js":[null],"./nn-no/toast-notifications.js":[null],"./nn-no/unified-search.js":[872692,96317],"./nn-no/url-preview.js":[242629,85358],"./nn-no/video-capture.js":[126574,85358],"./nn-no/video-message.js":[72223,85358],"./nn-no/virtual-events.js":[null],"./nn-no/webinar.js":[988642,60767],"./pl-pl/activity.js":[null],"./pl-pl/auth.js":[null],"./pl-pl/autosuggest.js":[null],"./pl-pl/avatar.js":[15265,83062],"./pl-pl/biometric-enrollment.js":[920024,13794],"./pl-pl/breakout-rooms.js":[807319,1440],"./pl-pl/broadcast.js":[719136,88282],"./pl-pl/calendar.js":[807137,60639],"./pl-pl/calling.js":[68270,62245],"./pl-pl/cast.js":[17348,57048],"./pl-pl/channels.js":[591371,11849],"./pl-pl/chat-list.js":[40991,91716],"./pl-pl/coach-report.js":[null],"./pl-pl/compose.js":[135028,91716],"./pl-pl/contacts.js":[null],"./pl-pl/datepicker.js":[438941,59860],"./pl-pl/desktop.js":[null],"./pl-pl/digital-signage.js":[null],"./pl-pl/edu.js":[298698,1498],"./pl-pl/embed.js":[null],"./pl-pl/errors.js":[null],"./pl-pl/esp.js":[76643,89139],"./pl-pl/extensibility-ptz-extension.js":[null],"./pl-pl/extensibility-room-remote.js":[null],"./pl-pl/extensibility.js":[548400,49752],"./pl-pl/files.js":[365233,22803],"./pl-pl/framework.js":[160633,83062],"./pl-pl/freemium.js":[null],"./pl-pl/funstuff.js":[347447,91716],"./pl-pl/gallery.js":[195924,66144],"./pl-pl/guardians.js":[240128,89903],"./pl-pl/hololens.js":[114447,62245],"./pl-pl/lightbox.js":[595961,91716],"./pl-pl/live-persona-card.js":[978570,83062],"./pl-pl/lms-integration.js":[null],"./pl-pl/meeting-analytics.js":[113523,66435],"./pl-pl/meeting-flyout.js":[708332,22750],"./pl-pl/meeting-meet-app.js":[null],"./pl-pl/meeting-options.js":[18731,27030],"./pl-pl/meeting-room-console.js":[349651,93202],"./pl-pl/meeting-stream-app.js":[null],"./pl-pl/messaging.js":[802794,91716],"./pl-pl/nova.js":[null],"./pl-pl/people-app.js":[null],"./pl-pl/people-picker.js":[308929,83062],"./pl-pl/people-targeting.js":[299965,88437],"./pl-pl/people.js":[null],"./pl-pl/pre-core.js":[null],"./pl-pl/recurrence.js":[393577,20904],"./pl-pl/search.js":[425579,59860],"./pl-pl/semantic-object.js":[435149,13418],"./pl-pl/settings.js":[null],"./pl-pl/share-to-teams-outlook-addin.js":[null],"./pl-pl/share-to-teams.js":[213139,22628],"./pl-pl/shortcut.js":[null],"./pl-pl/survey.js":[639840,75519],"./pl-pl/sv-flyout.js":[null],"./pl-pl/teams-and-channels.js":[976834,62531],"./pl-pl/tfl-onboarding.js":[null],"./pl-pl/toast-notifications.js":[null],"./pl-pl/unified-search.js":[125967,22628],"./pl-pl/url-preview.js":[231369,91716],"./pl-pl/video-capture.js":[666752,91716],"./pl-pl/video-message.js":[666998,91716],"./pl-pl/virtual-events.js":[null],"./pl-pl/webinar.js":[497858,68472],"./pt-br/activity.js":[null],"./pt-br/auth.js":[null],"./pt-br/autosuggest.js":[null],"./pt-br/avatar.js":[658613,90928],"./pt-br/biometric-enrollment.js":[570519,37446],"./pt-br/breakout-rooms.js":[457624,89847],"./pt-br/broadcast.js":[639510,75413],"./pt-br/calendar.js":[798999,63185],"./pt-br/calling.js":[548913,88478],"./pt-br/cast.js":[917282,68640],"./pt-br/channels.js":[21182,95339],"./pt-br/chat-list.js":[653759,58622],"./pt-br/coach-report.js":[null],"./pt-br/compose.js":[496313,58622],"./pt-br/contacts.js":[null],"./pt-br/datepicker.js":[4099,66761],"./pt-br/desktop.js":[null],"./pt-br/digital-signage.js":[null],"./pt-br/edu.js":[859541,24657],"./pt-br/embed.js":[null],"./pt-br/errors.js":[null],"./pt-br/esp.js":[850317,2771],"./pt-br/extensibility-ptz-extension.js":[null],"./pt-br/extensibility-room-remote.js":[null],"./pt-br/extensibility.js":[788446,98865],"./pt-br/files.js":[321724,12359],"./pt-br/framework.js":[539618,90928],"./pt-br/freemium.js":[null],"./pt-br/funstuff.js":[312557,58622],"./pt-br/gallery.js":[108396,13652],"./pt-br/guardians.js":[804950,29741],"./pt-br/hololens.js":[51957,88478],"./pt-br/lightbox.js":[942735,58622],"./pt-br/live-persona-card.js":[135158,90928],"./pt-br/lms-integration.js":[null],"./pt-br/meeting-analytics.js":[222049,91736],"./pt-br/meeting-flyout.js":[102962,62580],"./pt-br/meeting-meet-app.js":[null],"./pt-br/meeting-options.js":[195102,13680],"./pt-br/meeting-room-console.js":[197840,17726],"./pt-br/meeting-stream-app.js":[null],"./pt-br/messaging.js":[848531,58622],"./pt-br/nova.js":[null],"./pt-br/people-app.js":[null],"./pt-br/people-picker.js":[47823,90928],"./pt-br/people-targeting.js":[20714,95768],"./pt-br/people.js":[null],"./pt-br/pre-core.js":[null],"./pt-br/recurrence.js":[801452,17293],"./pt-br/search.js":[299690,66761],"./pt-br/semantic-object.js":[658323,72501],"./pt-br/settings.js":[null],"./pt-br/share-to-teams-outlook-addin.js":[null],"./pt-br/share-to-teams.js":[692514,69144],"./pt-br/shortcut.js":[null],"./pt-br/survey.js":[242805,98972],"./pt-br/sv-flyout.js":[null],"./pt-br/teams-and-channels.js":[110995,30242],"./pt-br/tfl-onboarding.js":[null],"./pt-br/toast-notifications.js":[null],"./pt-br/unified-search.js":[341837,69144],"./pt-br/url-preview.js":[183678,58622],"./pt-br/video-capture.js":[52013,58622],"./pt-br/video-message.js":[746346,58622],"./pt-br/virtual-events.js":[null],"./pt-br/webinar.js":[556296,30637],"./pt-pt/activity.js":[null],"./pt-pt/auth.js":[null],"./pt-pt/autosuggest.js":[null],"./pt-pt/avatar.js":[98575,97828],"./pt-pt/biometric-enrollment.js":[89021,53460],"./pt-pt/breakout-rooms.js":[808300,42065],"./pt-pt/broadcast.js":[892508,62351],"./pt-pt/calendar.js":[412986,74249],"./pt-pt/calling.js":[846015,52534],"./pt-pt/cast.js":[747009,41897],"./pt-pt/channels.js":[799753,35409],"./pt-pt/chat-list.js":[496413,97778],"./pt-pt/coach-report.js":[null],"./pt-pt/compose.js":[999750,97778],"./pt-pt/contacts.js":[null],"./pt-pt/datepicker.js":[226297,46804],"./pt-pt/desktop.js":[null],"./pt-pt/digital-signage.js":[null],"./pt-pt/edu.js":[674461,45138],"./pt-pt/embed.js":[null],"./pt-pt/errors.js":[null],"./pt-pt/esp.js":[661125,51106],"./pt-pt/extensibility-ptz-extension.js":[null],"./pt-pt/extensibility-room-remote.js":[null],"./pt-pt/extensibility.js":[634363,10649],"./pt-pt/files.js":[3530,43665],"./pt-pt/framework.js":[831538,97828],"./pt-pt/freemium.js":[null],"./pt-pt/funstuff.js":[646615,97778],"./pt-pt/gallery.js":[933024,92278],"./pt-pt/guardians.js":[713065,61074],"./pt-pt/hololens.js":[34533,52534],"./pt-pt/lightbox.js":[783176,97778],"./pt-pt/live-persona-card.js":[932134,97828],"./pt-pt/lms-integration.js":[null],"./pt-pt/meeting-analytics.js":[555926,66894],"./pt-pt/meeting-flyout.js":[400487,3779],"./pt-pt/meeting-meet-app.js":[null],"./pt-pt/meeting-options.js":[884274,8521],"./pt-pt/meeting-room-console.js":[466176,17428],"./pt-pt/meeting-stream-app.js":[null],"./pt-pt/messaging.js":[380504,97778],"./pt-pt/nova.js":[null],"./pt-pt/people-app.js":[null],"./pt-pt/people-picker.js":[706549,97828],"./pt-pt/people-targeting.js":[675764,69380],"./pt-pt/people.js":[null],"./pt-pt/pre-core.js":[null],"./pt-pt/recurrence.js":[347869,78433],"./pt-pt/search.js":[330729,46804],"./pt-pt/semantic-object.js":[730949,61539],"./pt-pt/settings.js":[null],"./pt-pt/share-to-teams-outlook-addin.js":[null],"./pt-pt/share-to-teams.js":[7677,40042],"./pt-pt/shortcut.js":[null],"./pt-pt/survey.js":[513346,39888],"./pt-pt/sv-flyout.js":[null],"./pt-pt/teams-and-channels.js":[686933,74217],"./pt-pt/tfl-onboarding.js":[null],"./pt-pt/toast-notifications.js":[null],"./pt-pt/unified-search.js":[668658,40042],"./pt-pt/url-preview.js":[828316,97778],"./pt-pt/video-capture.js":[99582,97778],"./pt-pt/video-message.js":[480059,97778],"./pt-pt/virtual-events.js":[null],"./pt-pt/webinar.js":[420379,65065],"./ro-ro/activity.js":[null],"./ro-ro/auth.js":[null],"./ro-ro/autosuggest.js":[null],"./ro-ro/avatar.js":[823678,51554],"./ro-ro/biometric-enrollment.js":[676284,13737],"./ro-ro/breakout-rooms.js":[684740,78994],"./ro-ro/broadcast.js":[265880,56679],"./ro-ro/calendar.js":[612622,83107],"./ro-ro/calling.js":[468587,83017],"./ro-ro/cast.js":[263684,64423],"./ro-ro/channels.js":[228217,29782],"./ro-ro/chat-list.js":[731310,17002],"./ro-ro/coach-report.js":[null],"./ro-ro/compose.js":[937636,17002],"./ro-ro/contacts.js":[null],"./ro-ro/datepicker.js":[521579,79010],"./ro-ro/desktop.js":[null],"./ro-ro/digital-signage.js":[null],"./ro-ro/edu.js":[134068,19493],"./ro-ro/embed.js":[null],"./ro-ro/errors.js":[null],"./ro-ro/esp.js":[75637,56633],"./ro-ro/extensibility-ptz-extension.js":[null],"./ro-ro/extensibility-room-remote.js":[null],"./ro-ro/extensibility.js":[266561,56795],"./ro-ro/files.js":[895747,43795],"./ro-ro/framework.js":[295766,51554],"./ro-ro/freemium.js":[null],"./ro-ro/funstuff.js":[75189,17002],"./ro-ro/gallery.js":[65073,65041],"./ro-ro/guardians.js":[210511,13968],"./ro-ro/hololens.js":[55806,83017],"./ro-ro/lightbox.js":[870197,17002],"./ro-ro/live-persona-card.js":[737564,51554],"./ro-ro/lms-integration.js":[null],"./ro-ro/meeting-analytics.js":[548295,96137],"./ro-ro/meeting-flyout.js":[264371,5058],"./ro-ro/meeting-meet-app.js":[null],"./ro-ro/meeting-options.js":[959265,132],"./ro-ro/meeting-room-console.js":[381233,7676],"./ro-ro/meeting-stream-app.js":[null],"./ro-ro/messaging.js":[618390,17002],"./ro-ro/nova.js":[null],"./ro-ro/people-app.js":[null],"./ro-ro/people-picker.js":[312150,51554],"./ro-ro/people-targeting.js":[341708,78052],"./ro-ro/people.js":[null],"./ro-ro/pre-core.js":[null],"./ro-ro/recurrence.js":[739585,17418],"./ro-ro/search.js":[478226,79010],"./ro-ro/semantic-object.js":[125769,73696],"./ro-ro/settings.js":[null],"./ro-ro/share-to-teams-outlook-addin.js":[null],"./ro-ro/share-to-teams.js":[869947,61183],"./ro-ro/shortcut.js":[null],"./ro-ro/survey.js":[895972,598],"./ro-ro/sv-flyout.js":[null],"./ro-ro/teams-and-channels.js":[930783,26447],"./ro-ro/tfl-onboarding.js":[null],"./ro-ro/toast-notifications.js":[null],"./ro-ro/unified-search.js":[207718,61183],"./ro-ro/url-preview.js":[10134,17002],"./ro-ro/video-capture.js":[449780,17002],"./ro-ro/video-message.js":[36541,17002],"./ro-ro/virtual-events.js":[null],"./ro-ro/webinar.js":[390210,5049],"./ru-ru/activity.js":[null],"./ru-ru/auth.js":[null],"./ru-ru/autosuggest.js":[null],"./ru-ru/avatar.js":[405055,14743],"./ru-ru/biometric-enrollment.js":[228323,3940],"./ru-ru/breakout-rooms.js":[110455,85565],"./ru-ru/broadcast.js":[617766,78981],"./ru-ru/calendar.js":[683780,50636],"./ru-ru/calling.js":[933397,37754],"./ru-ru/cast.js":[457770,79104],"./ru-ru/channels.js":[537241,83619],"./ru-ru/chat-list.js":[219352,7022],"./ru-ru/coach-report.js":[null],"./ru-ru/compose.js":[205132,7022],"./ru-ru/contacts.js":[null],"./ru-ru/datepicker.js":[372548,54180],"./ru-ru/desktop.js":[null],"./ru-ru/digital-signage.js":[null],"./ru-ru/edu.js":[100948,75402],"./ru-ru/embed.js":[null],"./ru-ru/errors.js":[null],"./ru-ru/esp.js":[773652,71021],"./ru-ru/extensibility-ptz-extension.js":[null],"./ru-ru/extensibility-room-remote.js":[null],"./ru-ru/extensibility.js":[217243,56712],"./ru-ru/files.js":[220465,41188],"./ru-ru/framework.js":[11500,14743],"./ru-ru/freemium.js":[null],"./ru-ru/funstuff.js":[736101,7022],"./ru-ru/gallery.js":[101785,23954],"./ru-ru/guardians.js":[653887,28254],"./ru-ru/hololens.js":[859784,37754],"./ru-ru/lightbox.js":[9608,7022],"./ru-ru/live-persona-card.js":[941872,14743],"./ru-ru/lms-integration.js":[null],"./ru-ru/meeting-analytics.js":[715725,45730],"./ru-ru/meeting-flyout.js":[14663,84021],"./ru-ru/meeting-meet-app.js":[null],"./ru-ru/meeting-options.js":[406126,56641],"./ru-ru/meeting-room-console.js":[746307,17270],"./ru-ru/meeting-stream-app.js":[null],"./ru-ru/messaging.js":[100987,7022],"./ru-ru/nova.js":[null],"./ru-ru/people-app.js":[null],"./ru-ru/people-picker.js":[966786,14743],"./ru-ru/people-targeting.js":[995855,65758],"./ru-ru/people.js":[null],"./ru-ru/pre-core.js":[null],"./ru-ru/recurrence.js":[842750,6389],"./ru-ru/search.js":[268345,54180],"./ru-ru/semantic-object.js":[212536,54122],"./ru-ru/settings.js":[null],"./ru-ru/share-to-teams-outlook-addin.js":[null],"./ru-ru/share-to-teams.js":[790822,96334],"./ru-ru/shortcut.js":[null],"./ru-ru/survey.js":[335117,55340],"./ru-ru/sv-flyout.js":[null],"./ru-ru/teams-and-channels.js":[452713,61090],"./ru-ru/tfl-onboarding.js":[null],"./ru-ru/toast-notifications.js":[null],"./ru-ru/unified-search.js":[920647,96334],"./ru-ru/url-preview.js":[146631,7022],"./ru-ru/video-capture.js":[318322,7022],"./ru-ru/video-message.js":[826779,7022],"./ru-ru/virtual-events.js":[null],"./ru-ru/webinar.js":[477637,96802],"./sk-sk/activity.js":[null],"./sk-sk/auth.js":[null],"./sk-sk/autosuggest.js":[null],"./sk-sk/avatar.js":[388928,27199],"./sk-sk/biometric-enrollment.js":[240670,57441],"./sk-sk/breakout-rooms.js":[195187,88441],"./sk-sk/broadcast.js":[689891,80839],"./sk-sk/calendar.js":[184297,62781],"./sk-sk/calling.js":[498735,12090],"./sk-sk/cast.js":[148919,44696],"./sk-sk/channels.js":[429604,23540],"./sk-sk/chat-list.js":[823741,37762],"./sk-sk/coach-report.js":[null],"./sk-sk/compose.js":[118387,37762],"./sk-sk/contacts.js":[null],"./sk-sk/datepicker.js":[126616,2883],"./sk-sk/desktop.js":[null],"./sk-sk/digital-signage.js":[null],"./sk-sk/edu.js":[771430,84885],"./sk-sk/embed.js":[null],"./sk-sk/errors.js":[null],"./sk-sk/esp.js":[352007,38461],"./sk-sk/extensibility-ptz-extension.js":[null],"./sk-sk/extensibility-room-remote.js":[null],"./sk-sk/extensibility.js":[535243,36142],"./sk-sk/files.js":[941573,63903],"./sk-sk/framework.js":[887181,27199],"./sk-sk/freemium.js":[null],"./sk-sk/funstuff.js":[772466,37762],"./sk-sk/gallery.js":[997577,41491],"./sk-sk/guardians.js":[980127,71515],"./sk-sk/hololens.js":[632475,12090],"./sk-sk/lightbox.js":[162779,37762],"./sk-sk/live-persona-card.js":[254117,27199],"./sk-sk/lms-integration.js":[null],"./sk-sk/meeting-analytics.js":[860698,98167],"./sk-sk/meeting-flyout.js":[171654,86007],"./sk-sk/meeting-meet-app.js":[null],"./sk-sk/meeting-options.js":[370356,44470],"./sk-sk/meeting-room-console.js":[21813,48370],"./sk-sk/meeting-stream-app.js":[null],"./sk-sk/messaging.js":[856016,37762],"./sk-sk/nova.js":[null],"./sk-sk/people-app.js":[null],"./sk-sk/people-picker.js":[71385,27199],"./sk-sk/people-targeting.js":[13684,38806],"./sk-sk/people.js":[null],"./sk-sk/pre-core.js":[null],"./sk-sk/recurrence.js":[183644,40238],"./sk-sk/search.js":[416134,2883],"./sk-sk/semantic-object.js":[166645,65240],"./sk-sk/settings.js":[null],"./sk-sk/share-to-teams-outlook-addin.js":[null],"./sk-sk/share-to-teams.js":[864323,73826],"./sk-sk/shortcut.js":[null],"./sk-sk/survey.js":[361437,38685],"./sk-sk/sv-flyout.js":[null],"./sk-sk/teams-and-channels.js":[607780,16478],"./sk-sk/tfl-onboarding.js":[null],"./sk-sk/toast-notifications.js":[null],"./sk-sk/unified-search.js":[724273,73826],"./sk-sk/url-preview.js":[174514,37762],"./sk-sk/video-capture.js":[26776,37762],"./sk-sk/video-message.js":[901103,37762],"./sk-sk/virtual-events.js":[null],"./sk-sk/webinar.js":[20889,38021],"./sl-si/activity.js":[null],"./sl-si/auth.js":[null],"./sl-si/autosuggest.js":[null],"./sl-si/avatar.js":[146457,59151],"./sl-si/biometric-enrollment.js":[690237,7015],"./sl-si/breakout-rooms.js":[501549,14590],"./sl-si/broadcast.js":[86739,36856],"./sl-si/calendar.js":[605202,55625],"./sl-si/calling.js":[830794,35588],"./sl-si/cast.js":[626547,73795],"./sl-si/channels.js":[865780,59518],"./sl-si/chat-list.js":[643083,40150],"./sl-si/coach-report.js":[null],"./sl-si/compose.js":[75805,40150],"./sl-si/contacts.js":[null],"./sl-si/datepicker.js":[314853,25509],"./sl-si/desktop.js":[null],"./sl-si/digital-signage.js":[null],"./sl-si/edu.js":[736319,28395],"./sl-si/embed.js":[null],"./sl-si/errors.js":[null],"./sl-si/esp.js":[327044,43589],"./sl-si/extensibility-ptz-extension.js":[null],"./sl-si/extensibility-room-remote.js":[null],"./sl-si/extensibility.js":[721004,34548],"./sl-si/files.js":[413794,75546],"./sl-si/framework.js":[419960,59151],"./sl-si/freemium.js":[null],"./sl-si/funstuff.js":[263616,40150],"./sl-si/gallery.js":[256615,89905],"./sl-si/guardians.js":[833798,31167],"./sl-si/hololens.js":[936776,35588],"./sl-si/lightbox.js":[657826,40150],"./sl-si/live-persona-card.js":[481028,59151],"./sl-si/lms-integration.js":[null],"./sl-si/meeting-analytics.js":[898889,6194],"./sl-si/meeting-flyout.js":[648439,71482],"./sl-si/meeting-meet-app.js":[null],"./sl-si/meeting-options.js":[771467,59401],"./sl-si/meeting-room-console.js":[502547,82080],"./sl-si/meeting-stream-app.js":[null],"./sl-si/messaging.js":[20294,40150],"./sl-si/nova.js":[null],"./sl-si/people-app.js":[null],"./sl-si/people-picker.js":[408059,59151],"./sl-si/people-targeting.js":[628879,58392],"./sl-si/people.js":[null],"./sl-si/pre-core.js":[null],"./sl-si/recurrence.js":[659552,39974],"./sl-si/search.js":[789091,25509],"./sl-si/semantic-object.js":[956373,78130],"./sl-si/settings.js":[null],"./sl-si/share-to-teams-outlook-addin.js":[null],"./sl-si/share-to-teams.js":[568974,14268],"./sl-si/shortcut.js":[null],"./sl-si/survey.js":[671737,5188],"./sl-si/sv-flyout.js":[null],"./sl-si/teams-and-channels.js":[330058,13392],"./sl-si/tfl-onboarding.js":[null],"./sl-si/toast-notifications.js":[null],"./sl-si/unified-search.js":[464621,14268],"./sl-si/url-preview.js":[521807,40150],"./sl-si/video-capture.js":[100617,40150],"./sl-si/video-message.js":[43131,40150],"./sl-si/virtual-events.js":[null],"./sl-si/webinar.js":[104843,88725],"./sq-al/activity.js":[null],"./sq-al/auth.js":[null],"./sq-al/autosuggest.js":[null],"./sq-al/avatar.js":[849476,61331],"./sq-al/biometric-enrollment.js":[401762,99030],"./sq-al/breakout-rooms.js":[683985,13354],"./sq-al/broadcast.js":[598979,50215],"./sq-al/calendar.js":[408264,61543],"./sq-al/calling.js":[118658,3405],"./sq-al/cast.js":[279616,58486],"./sq-al/channels.js":[889190,91282],"./sq-al/chat-list.js":[456280,23400],"./sq-al/coach-report.js":[null],"./sq-al/compose.js":[342515,23400],"./sq-al/contacts.js":[null],"./sq-al/datepicker.js":[705296,27172],"./sq-al/desktop.js":[null],"./sq-al/digital-signage.js":[null],"./sq-al/edu.js":[723498,106],"./sq-al/embed.js":[null],"./sq-al/errors.js":[null],"./sq-al/esp.js":[155304,1129],"./sq-al/extensibility-ptz-extension.js":[null],"./sq-al/extensibility-room-remote.js":[null],"./sq-al/extensibility.js":[313457,78580],"./sq-al/files.js":[466125,94253],"./sq-al/framework.js":[616396,61331],"./sq-al/freemium.js":[null],"./sq-al/funstuff.js":[99063,23400],"./sq-al/gallery.js":[120439,20948],"./sq-al/guardians.js":[599568,45885],"./sq-al/hololens.js":[976293,3405],"./sq-al/lightbox.js":[390301,23400],"./sq-al/live-persona-card.js":[599445,61331],"./sq-al/lms-integration.js":[null],"./sq-al/meeting-analytics.js":[274438,83906],"./sq-al/meeting-flyout.js":[850998,24944],"./sq-al/meeting-meet-app.js":[null],"./sq-al/meeting-options.js":[965149,78537],"./sq-al/meeting-room-console.js":[578344,67409],"./sq-al/meeting-stream-app.js":[null],"./sq-al/messaging.js":[486002,23400],"./sq-al/nova.js":[null],"./sq-al/people-app.js":[null],"./sq-al/people-picker.js":[102044,61331],"./sq-al/people-targeting.js":[545943,49663],"./sq-al/people.js":[null],"./sq-al/pre-core.js":[null],"./sq-al/recurrence.js":[356012,52708],"./sq-al/search.js":[464060,27172],"./sq-al/semantic-object.js":[585307,47140],"./sq-al/settings.js":[null],"./sq-al/share-to-teams-outlook-addin.js":[null],"./sq-al/share-to-teams.js":[845858,12776],"./sq-al/shortcut.js":[null],"./sq-al/survey.js":[387196,60005],"./sq-al/sv-flyout.js":[null],"./sq-al/teams-and-channels.js":[389095,3034],"./sq-al/tfl-onboarding.js":[null],"./sq-al/toast-notifications.js":[null],"./sq-al/unified-search.js":[556793,12776],"./sq-al/url-preview.js":[781233,23400],"./sq-al/video-capture.js":[520395,23400],"./sq-al/video-message.js":[697841,23400],"./sq-al/virtual-events.js":[null],"./sq-al/webinar.js":[140773,69120],"./sr-latn-rs/activity.js":[null],"./sr-latn-rs/auth.js":[null],"./sr-latn-rs/autosuggest.js":[null],"./sr-latn-rs/avatar.js":[201424,45285],"./sr-latn-rs/biometric-enrollment.js":[117127,32426],"./sr-latn-rs/breakout-rooms.js":[11543,81565],"./sr-latn-rs/broadcast.js":[952543,77153],"./sr-latn-rs/calendar.js":[788352,69006],"./sr-latn-rs/calling.js":[146906,92525],"./sr-latn-rs/cast.js":[671298,76327],"./sr-latn-rs/channels.js":[924575,72001],"./sr-latn-rs/chat-list.js":[149520,24073],"./sr-latn-rs/coach-report.js":[null],"./sr-latn-rs/compose.js":[4031,24073],"./sr-latn-rs/contacts.js":[null],"./sr-latn-rs/datepicker.js":[511378,75447],"./sr-latn-rs/desktop.js":[null],"./sr-latn-rs/digital-signage.js":[null],"./sr-latn-rs/edu.js":[221638,80282],"./sr-latn-rs/embed.js":[null],"./sr-latn-rs/errors.js":[null],"./sr-latn-rs/esp.js":[287289,44565],"./sr-latn-rs/extensibility-ptz-extension.js":[null],"./sr-latn-rs/extensibility-room-remote.js":[null],"./sr-latn-rs/extensibility.js":[411333,6768],"./sr-latn-rs/files.js":[699049,76426],"./sr-latn-rs/framework.js":[572242,45285],"./sr-latn-rs/freemium.js":[null],"./sr-latn-rs/funstuff.js":[711784,24073],"./sr-latn-rs/gallery.js":[913797,95787],"./sr-latn-rs/guardians.js":[935629,74604],"./sr-latn-rs/hololens.js":[979632,92525],"./sr-latn-rs/lightbox.js":[351808,24073],"./sr-latn-rs/live-persona-card.js":[374260,45285],"./sr-latn-rs/lms-integration.js":[null],"./sr-latn-rs/meeting-analytics.js":[424236,52354],"./sr-latn-rs/meeting-flyout.js":[584422,9675],"./sr-latn-rs/meeting-meet-app.js":[null],"./sr-latn-rs/meeting-options.js":[996501,19599],"./sr-latn-rs/meeting-room-console.js":[164242,67769],"./sr-latn-rs/meeting-stream-app.js":[null],"./sr-latn-rs/messaging.js":[422600,24073],"./sr-latn-rs/nova.js":[null],"./sr-latn-rs/people-app.js":[null],"./sr-latn-rs/people-picker.js":[613438,45285],"./sr-latn-rs/people-targeting.js":[371646,77747],"./sr-latn-rs/people.js":[null],"./sr-latn-rs/pre-core.js":[null],"./sr-latn-rs/recurrence.js":[557309,24013],"./sr-latn-rs/search.js":[72226,75447],"./sr-latn-rs/semantic-object.js":[944166,94444],"./sr-latn-rs/settings.js":[null],"./sr-latn-rs/share-to-teams-outlook-addin.js":[null],"./sr-latn-rs/share-to-teams.js":[47943,18846],"./sr-latn-rs/shortcut.js":[null],"./sr-latn-rs/survey.js":[194514,75504],"./sr-latn-rs/sv-flyout.js":[null],"./sr-latn-rs/teams-and-channels.js":[986777,96696],"./sr-latn-rs/tfl-onboarding.js":[null],"./sr-latn-rs/toast-notifications.js":[null],"./sr-latn-rs/unified-search.js":[529999,18846],"./sr-latn-rs/url-preview.js":[133875,24073],"./sr-latn-rs/video-capture.js":[122080,24073],"./sr-latn-rs/video-message.js":[600323,24073],"./sr-latn-rs/virtual-events.js":[null],"./sr-latn-rs/webinar.js":[445407,1612],"./sv-se/activity.js":[null],"./sv-se/auth.js":[null],"./sv-se/autosuggest.js":[null],"./sv-se/avatar.js":[814878,88681],"./sv-se/biometric-enrollment.js":[875637,56010],"./sv-se/breakout-rooms.js":[573026,97550],"./sv-se/broadcast.js":[11405,61922],"./sv-se/calendar.js":[2633,509],"./sv-se/calling.js":[505313,31374],"./sv-se/cast.js":[337010,61145],"./sv-se/channels.js":[626452,77750],"./sv-se/chat-list.js":[183940,83593],"./sv-se/coach-report.js":[null],"./sv-se/compose.js":[5208,83593],"./sv-se/contacts.js":[null],"./sv-se/datepicker.js":[921850,46981],"./sv-se/desktop.js":[null],"./sv-se/digital-signage.js":[null],"./sv-se/edu.js":[950259,81683],"./sv-se/embed.js":[null],"./sv-se/errors.js":[null],"./sv-se/esp.js":[331998,54068],"./sv-se/extensibility-ptz-extension.js":[null],"./sv-se/extensibility-room-remote.js":[null],"./sv-se/extensibility.js":[714268,51295],"./sv-se/files.js":[866139,83110],"./sv-se/framework.js":[120102,88681],"./sv-se/freemium.js":[null],"./sv-se/funstuff.js":[256247,83593],"./sv-se/gallery.js":[939060,55550],"./sv-se/guardians.js":[69834,70175],"./sv-se/hololens.js":[181258,31374],"./sv-se/lightbox.js":[836210,83593],"./sv-se/live-persona-card.js":[606610,88681],"./sv-se/lms-integration.js":[null],"./sv-se/meeting-analytics.js":[634955,37472],"./sv-se/meeting-flyout.js":[619604,35185],"./sv-se/meeting-meet-app.js":[null],"./sv-se/meeting-options.js":[352,66073],"./sv-se/meeting-room-console.js":[717546,74135],"./sv-se/meeting-stream-app.js":[null],"./sv-se/messaging.js":[889162,83593],"./sv-se/nova.js":[null],"./sv-se/people-app.js":[null],"./sv-se/people-picker.js":[724198,88681],"./sv-se/people-targeting.js":[938185,45270],"./sv-se/people.js":[null],"./sv-se/pre-core.js":[null],"./sv-se/recurrence.js":[828493,90565],"./sv-se/search.js":[83607,46981],"./sv-se/semantic-object.js":[473151,46462],"./sv-se/settings.js":[null],"./sv-se/share-to-teams-outlook-addin.js":[null],"./sv-se/share-to-teams.js":[670219,40879],"./sv-se/shortcut.js":[null],"./sv-se/survey.js":[465444,7205],"./sv-se/sv-flyout.js":[null],"./sv-se/teams-and-channels.js":[682173,83400],"./sv-se/tfl-onboarding.js":[null],"./sv-se/toast-notifications.js":[null],"./sv-se/unified-search.js":[424957,40879],"./sv-se/url-preview.js":[771259,83593],"./sv-se/video-capture.js":[841305,83593],"./sv-se/video-message.js":[597550,83593],"./sv-se/virtual-events.js":[null],"./sv-se/webinar.js":[386673,96836],"./th-th/activity.js":[null],"./th-th/auth.js":[null],"./th-th/autosuggest.js":[null],"./th-th/avatar.js":[236175,76240],"./th-th/biometric-enrollment.js":[189018,66736],"./th-th/breakout-rooms.js":[944235,40866],"./th-th/broadcast.js":[706426,23493],"./th-th/calendar.js":[802119,48451],"./th-th/calling.js":[578920,31963],"./th-th/cast.js":[510733,46739],"./th-th/channels.js":[645252,33772],"./th-th/chat-list.js":[566880,46563],"./th-th/coach-report.js":[null],"./th-th/compose.js":[883654,46563],"./th-th/contacts.js":[null],"./th-th/datepicker.js":[956180,85550],"./th-th/desktop.js":[null],"./th-th/digital-signage.js":[null],"./th-th/edu.js":[488113,88927],"./th-th/embed.js":[null],"./th-th/errors.js":[null],"./th-th/esp.js":[748737,37965],"./th-th/extensibility-ptz-extension.js":[null],"./th-th/extensibility-room-remote.js":[null],"./th-th/extensibility.js":[149772,28716],"./th-th/files.js":[4008,22012],"./th-th/framework.js":[523631,76240],"./th-th/freemium.js":[null],"./th-th/funstuff.js":[688322,46563],"./th-th/gallery.js":[103207,60713],"./th-th/guardians.js":[424362,85503],"./th-th/hololens.js":[274414,31963],"./th-th/lightbox.js":[767564,46563],"./th-th/live-persona-card.js":[649431,76240],"./th-th/lms-integration.js":[null],"./th-th/meeting-analytics.js":[420284,42182],"./th-th/meeting-flyout.js":[32879,61880],"./th-th/meeting-meet-app.js":[null],"./th-th/meeting-options.js":[386194,95571],"./th-th/meeting-room-console.js":[956477,20668],"./th-th/meeting-stream-app.js":[null],"./th-th/messaging.js":[139743,46563],"./th-th/nova.js":[null],"./th-th/people-app.js":[null],"./th-th/people-picker.js":[129986,76240],"./th-th/people-targeting.js":[334433,34379],"./th-th/people.js":[null],"./th-th/pre-core.js":[null],"./th-th/recurrence.js":[896828,96650],"./th-th/search.js":[272657,85550],"./th-th/semantic-object.js":[128170,64403],"./th-th/settings.js":[null],"./th-th/share-to-teams-outlook-addin.js":[null],"./th-th/share-to-teams.js":[733234,13752],"./th-th/shortcut.js":[null],"./th-th/survey.js":[222671,80956],"./th-th/sv-flyout.js":[null],"./th-th/teams-and-channels.js":[773966,30783],"./th-th/tfl-onboarding.js":[null],"./th-th/toast-notifications.js":[null],"./th-th/unified-search.js":[132052,13752],"./th-th/url-preview.js":[755499,46563],"./th-th/video-capture.js":[727971,46563],"./th-th/video-message.js":[489088,46563],"./th-th/virtual-events.js":[null],"./th-th/webinar.js":[861e3,10728],"./tr-tr/activity.js":[null],"./tr-tr/auth.js":[null],"./tr-tr/autosuggest.js":[null],"./tr-tr/avatar.js":[615204,92574],"./tr-tr/biometric-enrollment.js":[801094,35392],"./tr-tr/breakout-rooms.js":[626132,28489],"./tr-tr/broadcast.js":[231259,94411],"./tr-tr/calendar.js":[962472,78641],"./tr-tr/calling.js":[655526,33611],"./tr-tr/cast.js":[298701,64749],"./tr-tr/channels.js":[310152,31354],"./tr-tr/chat-list.js":[264765,89483],"./tr-tr/coach-report.js":[null],"./tr-tr/compose.js":[507535,89483],"./tr-tr/contacts.js":[null],"./tr-tr/datepicker.js":[684477,37514],"./tr-tr/desktop.js":[null],"./tr-tr/digital-signage.js":[null],"./tr-tr/edu.js":[220057,17124],"./tr-tr/embed.js":[null],"./tr-tr/errors.js":[null],"./tr-tr/esp.js":[869045,28862],"./tr-tr/extensibility-ptz-extension.js":[null],"./tr-tr/extensibility-room-remote.js":[null],"./tr-tr/extensibility.js":[945022,45321],"./tr-tr/files.js":[218560,60111],"./tr-tr/framework.js":[952269,92574],"./tr-tr/freemium.js":[null],"./tr-tr/funstuff.js":[161294,89483],"./tr-tr/gallery.js":[307086,35821],"./tr-tr/guardians.js":[958927,76118],"./tr-tr/hololens.js":[17003,33611],"./tr-tr/lightbox.js":[142517,89483],"./tr-tr/live-persona-card.js":[978433,92574],"./tr-tr/lms-integration.js":[null],"./tr-tr/meeting-analytics.js":[218178,66235],"./tr-tr/meeting-flyout.js":[806427,93446],"./tr-tr/meeting-meet-app.js":[null],"./tr-tr/meeting-options.js":[145723,42944],"./tr-tr/meeting-room-console.js":[71655,75041],"./tr-tr/meeting-stream-app.js":[null],"./tr-tr/messaging.js":[938294,89483],"./tr-tr/nova.js":[null],"./tr-tr/people-app.js":[null],"./tr-tr/people-picker.js":[723176,92574],"./tr-tr/people-targeting.js":[652842,57721],"./tr-tr/people.js":[null],"./tr-tr/pre-core.js":[null],"./tr-tr/recurrence.js":[267978,24665],"./tr-tr/search.js":[544725,37514],"./tr-tr/semantic-object.js":[984903,59746],"./tr-tr/settings.js":[null],"./tr-tr/share-to-teams-outlook-addin.js":[null],"./tr-tr/share-to-teams.js":[220280,70881],"./tr-tr/shortcut.js":[null],"./tr-tr/survey.js":[35707,50439],"./tr-tr/sv-flyout.js":[null],"./tr-tr/teams-and-channels.js":[887059,62139],"./tr-tr/tfl-onboarding.js":[null],"./tr-tr/toast-notifications.js":[null],"./tr-tr/unified-search.js":[229654,70881],"./tr-tr/url-preview.js":[814332,89483],"./tr-tr/video-capture.js":[911505,89483],"./tr-tr/video-message.js":[594144,89483],"./tr-tr/virtual-events.js":[null],"./tr-tr/webinar.js":[916198,44386],"./uk-ua/activity.js":[null],"./uk-ua/auth.js":[null],"./uk-ua/autosuggest.js":[null],"./uk-ua/avatar.js":[229230,64618],"./uk-ua/biometric-enrollment.js":[129867,34250],"./uk-ua/breakout-rooms.js":[783613,7776],"./uk-ua/broadcast.js":[543266,42239],"./uk-ua/calendar.js":[503762,88458],"./uk-ua/calling.js":[223720,42558],"./uk-ua/cast.js":[773628,26958],"./uk-ua/channels.js":[851403,24860],"./uk-ua/chat-list.js":[763488,66152],"./uk-ua/coach-report.js":[null],"./uk-ua/compose.js":[465639,66152],"./uk-ua/contacts.js":[null],"./uk-ua/datepicker.js":[225443,23025],"./uk-ua/desktop.js":[null],"./uk-ua/digital-signage.js":[null],"./uk-ua/edu.js":[175553,78773],"./uk-ua/embed.js":[null],"./uk-ua/errors.js":[null],"./uk-ua/esp.js":[958789,22064],"./uk-ua/extensibility-ptz-extension.js":[null],"./uk-ua/extensibility-room-remote.js":[null],"./uk-ua/extensibility.js":[473901,74282],"./uk-ua/files.js":[882483,78858],"./uk-ua/framework.js":[613932,64618],"./uk-ua/freemium.js":[null],"./uk-ua/funstuff.js":[862529,66152],"./uk-ua/gallery.js":[63761,20741],"./uk-ua/guardians.js":[555240,59930],"./uk-ua/hololens.js":[951854,42558],"./uk-ua/lightbox.js":[379117,66152],"./uk-ua/live-persona-card.js":[300715,64618],"./uk-ua/lms-integration.js":[null],"./uk-ua/meeting-analytics.js":[673591,74906],"./uk-ua/meeting-flyout.js":[111983,79019],"./uk-ua/meeting-meet-app.js":[null],"./uk-ua/meeting-options.js":[9964,90166],"./uk-ua/meeting-room-console.js":[930655,99981],"./uk-ua/meeting-stream-app.js":[null],"./uk-ua/messaging.js":[651010,66152],"./uk-ua/nova.js":[null],"./uk-ua/people-app.js":[null],"./uk-ua/people-picker.js":[155837,64618],"./uk-ua/people-targeting.js":[48988,3979],"./uk-ua/people.js":[null],"./uk-ua/pre-core.js":[null],"./uk-ua/recurrence.js":[518742,76807],"./uk-ua/search.js":[303876,23025],"./uk-ua/semantic-object.js":[803810,80699],"./uk-ua/settings.js":[null],"./uk-ua/share-to-teams-outlook-addin.js":[null],"./uk-ua/share-to-teams.js":[18758,56477],"./uk-ua/shortcut.js":[null],"./uk-ua/survey.js":[855305,95121],"./uk-ua/sv-flyout.js":[null],"./uk-ua/teams-and-channels.js":[446784,16918],"./uk-ua/tfl-onboarding.js":[null],"./uk-ua/toast-notifications.js":[null],"./uk-ua/unified-search.js":[244115,56477],"./uk-ua/url-preview.js":[240361,66152],"./uk-ua/video-capture.js":[374562,66152],"./uk-ua/video-message.js":[729690,66152],"./uk-ua/virtual-events.js":[null],"./uk-ua/webinar.js":[999832,37378],"./vi-vn/activity.js":[null],"./vi-vn/auth.js":[null],"./vi-vn/autosuggest.js":[null],"./vi-vn/avatar.js":[185937,69545],"./vi-vn/biometric-enrollment.js":[16008,54515],"./vi-vn/breakout-rooms.js":[234104,9252],"./vi-vn/broadcast.js":[160050,25110],"./vi-vn/calendar.js":[679304,10284],"./vi-vn/calling.js":[474946,5750],"./vi-vn/cast.js":[697324,98750],"./vi-vn/channels.js":[731841,91510],"./vi-vn/chat-list.js":[779056,34425],"./vi-vn/coach-report.js":[null],"./vi-vn/compose.js":[353838,34425],"./vi-vn/contacts.js":[null],"./vi-vn/datepicker.js":[64963,23065],"./vi-vn/desktop.js":[null],"./vi-vn/digital-signage.js":[null],"./vi-vn/edu.js":[999803,45005],"./vi-vn/embed.js":[null],"./vi-vn/errors.js":[null],"./vi-vn/esp.js":[622426,46584],"./vi-vn/extensibility-ptz-extension.js":[null],"./vi-vn/extensibility-room-remote.js":[null],"./vi-vn/extensibility.js":[461588,40583],"./vi-vn/files.js":[293521,34322],"./vi-vn/framework.js":[350930,69545],"./vi-vn/freemium.js":[null],"./vi-vn/funstuff.js":[452065,34425],"./vi-vn/gallery.js":[953437,79957],"./vi-vn/guardians.js":[14011,397],"./vi-vn/hololens.js":[295299,5750],"./vi-vn/lightbox.js":[689403,34425],"./vi-vn/live-persona-card.js":[737915,69545],"./vi-vn/lms-integration.js":[null],"./vi-vn/meeting-analytics.js":[843877,29813],"./vi-vn/meeting-flyout.js":[357046,16622],"./vi-vn/meeting-meet-app.js":[null],"./vi-vn/meeting-options.js":[205063,68935],"./vi-vn/meeting-room-console.js":[985899,58814],"./vi-vn/meeting-stream-app.js":[null],"./vi-vn/messaging.js":[843458,34425],"./vi-vn/nova.js":[null],"./vi-vn/people-app.js":[null],"./vi-vn/people-picker.js":[696589,69545],"./vi-vn/people-targeting.js":[796927,56652],"./vi-vn/people.js":[null],"./vi-vn/pre-core.js":[null],"./vi-vn/recurrence.js":[674312,96387],"./vi-vn/search.js":[183911,23065],"./vi-vn/semantic-object.js":[898713,6091],"./vi-vn/settings.js":[null],"./vi-vn/share-to-teams-outlook-addin.js":[null],"./vi-vn/share-to-teams.js":[681154,84399],"./vi-vn/shortcut.js":[null],"./vi-vn/survey.js":[713806,25442],"./vi-vn/sv-flyout.js":[null],"./vi-vn/teams-and-channels.js":[892760,9940],"./vi-vn/tfl-onboarding.js":[null],"./vi-vn/toast-notifications.js":[null],"./vi-vn/unified-search.js":[694155,84399],"./vi-vn/url-preview.js":[856241,34425],"./vi-vn/video-capture.js":[529188,34425],"./vi-vn/video-message.js":[466538,34425],"./vi-vn/virtual-events.js":[null],"./vi-vn/webinar.js":[890513,91496],"./zh-cn/activity.js":[null],"./zh-cn/auth.js":[null],"./zh-cn/autosuggest.js":[null],"./zh-cn/avatar.js":[886898,42742],"./zh-cn/biometric-enrollment.js":[513806,38355],"./zh-cn/breakout-rooms.js":[379667,17121],"./zh-cn/broadcast.js":[64529,75895],"./zh-cn/calendar.js":[719643,84836],"./zh-cn/calling.js":[716281,30291],"./zh-cn/cast.js":[272930,72767],"./zh-cn/channels.js":[670970,88909],"./zh-cn/chat-list.js":[304345,44586],"./zh-cn/coach-report.js":[null],"./zh-cn/compose.js":[242487,44586],"./zh-cn/contacts.js":[null],"./zh-cn/datepicker.js":[169918,31506],"./zh-cn/desktop.js":[null],"./zh-cn/digital-signage.js":[null],"./zh-cn/edu.js":[946605,66167],"./zh-cn/embed.js":[null],"./zh-cn/errors.js":[null],"./zh-cn/esp.js":[457560,74847],"./zh-cn/extensibility-ptz-extension.js":[null],"./zh-cn/extensibility-room-remote.js":[null],"./zh-cn/extensibility.js":[958025,14151],"./zh-cn/files.js":[441773,91910],"./zh-cn/framework.js":[695029,42742],"./zh-cn/freemium.js":[null],"./zh-cn/funstuff.js":[32028,44586],"./zh-cn/gallery.js":[900966,27455],"./zh-cn/guardians.js":[662570,60273],"./zh-cn/hololens.js":[688174,30291],"./zh-cn/lightbox.js":[985381,44586],"./zh-cn/live-persona-card.js":[435788,42742],"./zh-cn/lms-integration.js":[null],"./zh-cn/meeting-analytics.js":[588370,19109],"./zh-cn/meeting-flyout.js":[422752,74237],"./zh-cn/meeting-meet-app.js":[null],"./zh-cn/meeting-options.js":[290677,27217],"./zh-cn/meeting-room-console.js":[716135,18143],"./zh-cn/meeting-stream-app.js":[null],"./zh-cn/messaging.js":[693396,44586],"./zh-cn/nova.js":[null],"./zh-cn/people-app.js":[null],"./zh-cn/people-picker.js":[910892,42742],"./zh-cn/people-targeting.js":[356579,67008],"./zh-cn/people.js":[null],"./zh-cn/pre-core.js":[null],"./zh-cn/recurrence.js":[534246,77357],"./zh-cn/search.js":[816563,31506],"./zh-cn/semantic-object.js":[796499,7368],"./zh-cn/settings.js":[null],"./zh-cn/share-to-teams-outlook-addin.js":[null],"./zh-cn/share-to-teams.js":[215069,61038],"./zh-cn/shortcut.js":[null],"./zh-cn/survey.js":[767507,14287],"./zh-cn/sv-flyout.js":[null],"./zh-cn/teams-and-channels.js":[846982,33371],"./zh-cn/tfl-onboarding.js":[null],"./zh-cn/toast-notifications.js":[null],"./zh-cn/unified-search.js":[385901,61038],"./zh-cn/url-preview.js":[74485,44586],"./zh-cn/video-capture.js":[554348,44586],"./zh-cn/video-message.js":[252011,44586],"./zh-cn/virtual-events.js":[null],"./zh-cn/webinar.js":[117122,53154],"./zh-tw/activity.js":[null],"./zh-tw/auth.js":[null],"./zh-tw/autosuggest.js":[null],"./zh-tw/avatar.js":[429188,35921],"./zh-tw/biometric-enrollment.js":[605248,63732],"./zh-tw/breakout-rooms.js":[873803,66833],"./zh-tw/broadcast.js":[53403,54761],"./zh-tw/calendar.js":[213374,3461],"./zh-tw/calling.js":[531351,86347],"./zh-tw/cast.js":[727508,21933],"./zh-tw/channels.js":[940702,81916],"./zh-tw/chat-list.js":[867761,83549],"./zh-tw/coach-report.js":[null],"./zh-tw/compose.js":[550178,83549],"./zh-tw/contacts.js":[null],"./zh-tw/datepicker.js":[348684,27521],"./zh-tw/desktop.js":[null],"./zh-tw/digital-signage.js":[null],"./zh-tw/edu.js":[716469,63871],"./zh-tw/embed.js":[null],"./zh-tw/errors.js":[null],"./zh-tw/esp.js":[679569,16045],"./zh-tw/extensibility-ptz-extension.js":[null],"./zh-tw/extensibility-room-remote.js":[null],"./zh-tw/extensibility.js":[192149,63235],"./zh-tw/files.js":[702479,40370],"./zh-tw/framework.js":[713717,35921],"./zh-tw/freemium.js":[null],"./zh-tw/funstuff.js":[62451,83549],"./zh-tw/gallery.js":[672091,67103],"./zh-tw/guardians.js":[256596,8954],"./zh-tw/hololens.js":[122119,86347],"./zh-tw/lightbox.js":[118871,83549],"./zh-tw/live-persona-card.js":[176190,35921],"./zh-tw/lms-integration.js":[null],"./zh-tw/meeting-analytics.js":[141160,83226],"./zh-tw/meeting-flyout.js":[188527,36279],"./zh-tw/meeting-meet-app.js":[null],"./zh-tw/meeting-options.js":[701654,89183],"./zh-tw/meeting-room-console.js":[573920,93121],"./zh-tw/meeting-stream-app.js":[null],"./zh-tw/messaging.js":[376764,83549],"./zh-tw/nova.js":[null],"./zh-tw/people-app.js":[null],"./zh-tw/people-picker.js":[946184,35921],"./zh-tw/people-targeting.js":[769922,19237],"./zh-tw/people.js":[null],"./zh-tw/pre-core.js":[null],"./zh-tw/recurrence.js":[181825,60988],"./zh-tw/search.js":[908461,27521],"./zh-tw/semantic-object.js":[359856,19495],"./zh-tw/settings.js":[null],"./zh-tw/share-to-teams-outlook-addin.js":[null],"./zh-tw/share-to-teams.js":[547527,81783],"./zh-tw/shortcut.js":[null],"./zh-tw/survey.js":[115564,19078],"./zh-tw/sv-flyout.js":[null],"./zh-tw/teams-and-channels.js":[65512,37025],"./zh-tw/tfl-onboarding.js":[null],"./zh-tw/toast-notifications.js":[null],"./zh-tw/unified-search.js":[688295,81783],"./zh-tw/url-preview.js":[329381,83549],"./zh-tw/video-capture.js":[192776,83549],"./zh-tw/video-message.js":[738426,83549],"./zh-tw/virtual-events.js":[null],"./zh-tw/webinar.js":[854344,65238]};function a(e){if(!n.o(i,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],a=t[0];return Promise.all(t.slice(1).map(n.e)).then((()=>n(a)))}a.keys=()=>Object.keys(i),a.id=122057,e.exports=a},668397:e=>{"use strict";e.exports=ITEMS_VIEW_STRINGS},32668:()=>{},817774:()=>{},759455:e=>{"use strict";e.exports=JSON.parse('{"clientId":"5e3ce6c0-2b1f-4285-8d4b-75ee78787346","basePath":"multi-window","experienceName":"multi-window","fallbackLocale":"en-us","shouldFetchBootstrapData":true,"webAuth":{"cacheLocation":"localStorage","navigateToLoginRequestUrl":true,"top":{"popUp":true},"iframe":{"redirectPath":"auth"}},"ring":{"id":"ring0"},"cdnVersion":4,"enableDevTools":true,"windowType":"MW","lpcRegion":"df","isLPCEnabled":true,"preloadedI18nNamespaces":["avatar","breakoutRooms","framework","gallery","livePersonaCard","peoplePicker","peopleTargeting","recurrence"]}')}},__webpack_module_cache__={},deferred,leafPrototypes,getProto,inProgress,dataWebpackPrefix,policy,chunkToChildrenMap;function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.loaded=!0,n.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.amdO={},deferred=[],__webpack_require__.O=(e,t,n,i)=>{if(!t){var a=1/0;for(l=0;l<deferred.length;l++){for(var[t,n,i]=deferred[l],o=!0,r=0;r<t.length;r++)(!1&i||a>=i)&&Object.keys(__webpack_require__.O).every((e=>__webpack_require__.O[e](t[r])))?t.splice(r--,1):(o=!1,i<a&&(a=i));if(o){deferred.splice(l--,1);var s=n();void 0!==s&&(e=s)}}return e}i=i||0;for(var l=deferred.length;l>0&&deferred[l-1][2]>i;l--)deferred[l]=deferred[l-1];deferred[l]=[t,n,i]},__webpack_require__.F={},__webpack_require__.E=e=>{Object.keys(__webpack_require__.F).map((t=>{__webpack_require__.F[t](e)}))},__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},getProto=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,__webpack_require__.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var n=Object.create(null);__webpack_require__.r(n);var i={};leafPrototypes=leafPrototypes||[null,getProto({}),getProto([]),getProto(getProto)];for(var a=2&t&&e;"object"==typeof a&&!~leafPrototypes.indexOf(a);a=getProto(a))Object.getOwnPropertyNames(a).forEach((t=>i[t]=()=>e[t]));return i.default=()=>e,__webpack_require__.d(n,i),n},__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.f={},__webpack_require__.e=e=>Promise.all(Object.keys(__webpack_require__.f).reduce(((t,n)=>(__webpack_require__.f[n](e,t),t)),[])),__webpack_require__.u=e=>(({57:"calling-locale-mk-mk",75:"calendar-locale-et-ee",106:"school-locale-sq-al",132:"meeting-options-locale-ro-ro",140:"meeting-options-locale-es-es",145:"components-screen-recorder2",229:"data-resolvers-browser-share",284:"search-locale-cs-cz",385:"extensibility-locale-ar-sa",397:"guardians-locale-vi-vn",471:"recurrence-locale-fil-ph",488:"data-resolvers-browser-calls-screen",509:"calendar-locale-sv-se",586:"meetingFlyout-locale-is-is",588:"data-resolvers-toast",598:"survey-locale-ro-ro",629:"meeting-analytics-locale-ar-sa",637:"calling-locale-fr-fr",658:"meeting-room-console-locale-nl-nl",673:"search-locale-mk-mk",675:"services-io-connected-calendar",772:"survey-locale-ko-kr",809:"recurrence-locale-he-il",822:"messaging-locale-ca-es-valencia",824:"calling-locale-id-id",826:"calendar-locale-da-dk",906:"share-email-locale-ca-es-valencia",923:"services-distribution-list",926:"main-locale-lv-lv",987:"gallery-locale-lv-lv",1129:"esp-locale-sq-al",1172:"services-voicemail",1199:"share-email-locale-el-gr",1264:"components-calling-paywall-image-lazy",1400:"search-locale-ca-es-valencia",1420:"data-resolvers-appbar",1440:"breakoutRooms-locale-pl-pl",1496:"cast-locale-hu-hu",1498:"school-locale-pl-pl",1555:"calls-app",1556:"cast-locale-nb-no",1573:"school-locale-gl-es",1612:"webinar-locale-sr-latn-rs",1659:"people-targeting-locale-id-id",1741:"teams-compose-box",1876:"school-locale-kk-kz",1924:"esp-locale-nl-nl",1983:"main-locale-it-it",2016:"semantic-object-locale-kk-kz",2054:"core-essentials",2060:"meetingFlyout-locale-kk-kz",2066:"services-manage-tenant",2078:"services-substrate-meeting-recommendations",2090:"data-resolvers-reply-chains",2219:"ariawrapper",2308:"channels-locale-ko-kr",2376:"people-targeting-locale-ko-kr",2488:"people-targeting-locale-hu-hu",2525:"recurrence-locale-en-us",2559:"gallery-locale-ka-ge",2600:"deferredcomponents",2653:"services-file-download-manager",2701:"main-locale-es-mx",2708:"extensibility-locale-id-id",2764:"channels-locale-cy-gb",2771:"esp-locale-pt-br",2774:"share-email-locale-fr-fr",2849:"channels-locale-id-id",2883:"search-locale-sk-sk",3034:"teams-and-channels-locale-sq-al",3137:"services-files",3184:"share-email-locale-et-ee",3232:"extensibility-locale-ka-ge",3275:"transcript-content-app",3301:"guardians-locale-it-it",3405:"calling-locale-sq-al",3420:"hostUxStrings6",3461:"calendar-locale-zh-tw",3576:"hostUxStrings18",3626:"esp-locale-ca-es",3683:"webinar-locale-fi-fi",3698:"components-calendar-peek",3762:"components-screen-recorder64",3779:"meetingFlyout-locale-pt-pt",3813:"breakoutRooms-locale-fr-ca",3817:"broadcast-locale-id-id",3842:"breakout-rooms",3846:"main-locale-id-id",3940:"biometric-enrollment-locale-ru-ru",3966:"semantic-object-locale-da-dk",3979:"people-targeting-locale-uk-ua",3983:"teams-and-channels-locale-ka-ge",3998:"services-guardians",4120:"search-locale-da-dk",4128:"main-locale-nb-no",4177:"components-screen-recorder84",4214:"components-teams-stardust-ui",4288:"semantic-object-locale-de-de",4289:"semantic-object-locale-ja-jp",4299:"guardians-locale-nn-no",4317:"semantic-object-locale-ar-sa",4346:"hostUxStrings32",4411:"biometric-enrollment-locale-ka-ge",4601:"cast-locale-de-de",4609:"services-policies",4615:"main-locale-ja-jp",4685:"recurrence-locale-bg-bg",4818:"meeting-room-console-locale-cs-cz",4822:"school-locale-nn-no",4904:"semantic-object-locale-es-es",5049:"webinar-locale-ro-ro",5053:"files-locale-lv-lv",5058:"meetingFlyout-locale-ro-ro",5089:"cast-locale-he-il",5170:"survey-locale-es-es",5188:"survey-locale-sl-si",5203:"services-apps-platform",5250:"collaborative-web-content",5271:"shell-app",5324:"school-locale-hu-hu",5363:"gallery-locale-ca-es",5400:"broadcast-locale-ko-kr",5406:"esp-locale-az-latn-az",5421:"meeting-options-locale-ja-jp",5443:"hostUxStrings10",5462:"teams-and-channels-locale-kk-kz",5579:"meetingFlyout-locale-en-gb",5589:"meetingFlyout-locale-it-it",5599:"messaging-locale-ca-es",5632:"data-resolvers-calendar",5724:"meetingFlyout-locale-bg-bg",5750:"calling-locale-vi-vn",5754:"components-files-super-picker",5794:"services-dynamics-marketing",5875:"calling-locale-cy-gb",5954:"meeting-analytics-locale-gl-es",6020:"data-resolvers-calling",6055:"files-locale-lt-lt",6063:"meeting-options-locale-nl-nl",6091:"semantic-object-locale-vi-vn",6194:"meeting-analytics-locale-sl-si",6279:"biometric-enrollment-locale-ca-es",6317:"adaptivecard",6336:"guardians-locale-hi-in",6355:"webinar-locale-hu-hu",6366:"hostUxStrings40",6373:"esp-locale-ja-jp",6389:"recurrence-locale-ru-ru",6396:"semantic-object-locale-en-gb",6408:"services-tpn-notice",6431:"hostUxStrings23",6457:"messaging-locale-fr-ca",6472:"messaging-locale-fi-fi",6545:"services-refresh-site-url",6552:"meeting-analytics-locale-is-is",6659:"school-locale-bg-bg",6693:"data-client-calling",6767:"guardians-locale-az-latn-az",6768:"extensibility-locale-sr-latn-rs",6929:"guardians-locale-nl-nl",6942:"broadcast-locale-gl-es",6990:"main-locale-da-dk",6994:"teams-post-compose-box",7004:"meeting-analytics-locale-da-dk",7015:"biometric-enrollment-locale-sl-si",7022:"messaging-locale-ru-ru",7056:"main-locale-ca-es-valencia",7169:"meetingFlyout-locale-nb-no",7178:"chat-screen-share-button",7205:"survey-locale-sv-se",7215:"gallery-locale-it-it",7261:"./svg/something-went-wrong-empty-state.svg",7368:"semantic-object-locale-zh-cn",7523:"search-locale-ko-kr",7536:"esp-locale-cs-cz",7545:"survey-locale-hu-hu",7598:"data-resolvers-search-suggestions",7620:"search-locale-is-is",7676:"meeting-room-console-locale-ro-ro",7684:"bridge-migration-components-transcript",7729:"hostUxStrings52",7761:"meeting-room-console-locale-en-us",7776:"breakoutRooms-locale-uk-ua",7783:"broadcast-locale-ja-jp",7850:"meeting-analytics-locale-nl-nl",7959:"fluid-component-renderer",8049:"hostUxStrings2",8108:"o365-connector-card",8111:"extensibility-locale-fr-ca",8118:"gallery-locale-nl-nl",8124:"messaging-locale-id-id",8174:"teams-and-channels-locale-lv-lv",8275:"recurrence-locale-es-mx",8521:"meeting-options-locale-pt-pt",8535:"hostUxStrings78",8568:"meetingFlyout-locale-hi-in",8609:"meeting-room-console-locale-hi-in",8631:"extensibility-locale-he-il",8656:"meeting-options-locale-ar-sa",8687:"data-resolvers-meeting-analytics",8725:"components-files-personal-picker",8735:"meeting-options-locale-lt-lt",8806:"data-resolvers-browser-ams",8954:"guardians-locale-zh-tw",9014:"search-locale-lt-lt",9082:"extensibility-locale-mk-mk",9252:"breakoutRooms-locale-vi-vn",9293:"meeting-room-console-locale-cy-gb",9355:"data-resolvers-offline-actions",9372:"calendar-locale-lv-lv",9436:"teams-and-channels-locale-hr-hr",9469:"hostUxStrings81",9495:"meeting-options-panel",9505:"hostUxStrings56",9545:"search-locale-de-de",9675:"meetingFlyout-locale-sr-latn-rs",9778:"hostUxStrings48",9940:"teams-and-channels-locale-vi-vn",9981:"gallery-locale-he-il",10056:"meetingFlyout-locale-de-de",10104:"data-resolvers-browser-live-stream-rendering",10122:"meeting-options-locale-cy-gb",10166:"school-locale-en-us",10203:"create-folder-wizard",10284:"calendar-locale-vi-vn",10319:"calling-locale-da-dk",10412:"broadcast-locale-ar-sa",10501:"survey-locale-es-mx",10562:"main-locale-ka-ge",10589:"meeting-analytics-locale-hi-in",10649:"extensibility-locale-pt-pt",10652:"meeting-analytics-locale-ca-es-valencia",10683:"data-resolvers-activity",10728:"webinar-locale-th-th",10749:"meeting-options-locale-da-dk",10784:"cast-locale-hi-in",10828:"esp-locale-ar-sa",10841:"meeting-analytics-teams-app-wrapper",10880:"calling-umd-bundle",11125:"files-locale-nn-no",11131:"cast-locale-nn-no",11136:"gallery-locale-es-mx",11157:"messaging-locale-es-mx",11265:"teams-and-channels-locale-el-gr",11290:"breakoutRooms-locale-fr-fr",11637:"meeting-analytics-locale-cs-cz",11682:"components-screen-recorder74",11746:"gallery-locale-en-us",11827:"extensibility-locale-ja-jp",11846:"services-breakout-rooms",11849:"channels-locale-pl-pl",11908:"guardians-locale-lv-lv",11943:"calendar-locale-ko-kr",11957:"webinar-locale-he-il",11969:"webinar-locale-it-it",12002:"reactions-overlay-renderer",12090:"calling-locale-sk-sk",12190:"calling-roster",12243:"broadcast-locale-az-latn-az",12353:"data-resolvers-browser-broadcast-attendee",12359:"files-locale-pt-br",12486:"hostUxStrings76",12502:"broadcast-locale-es-mx",12549:"services-broadcast-signalr",12610:"components-screen-recorder24",12657:"school-locale-ko-kr",12671:"broadcast-locale-hu-hu",12767:"data-resolvers-compose-language",12776:"share-email-locale-sq-al",12782:"school-locale-ja-jp",13042:"services-io-data-call-monitor",13271:"school-locale-nl-nl",13353:"meetingFlyout-locale-fi-fi",13354:"breakoutRooms-locale-sq-al",13386:"splash-screen-image",13392:"teams-and-channels-locale-sl-si",13418:"semantic-object-locale-pl-pl",13428:"meeting-room-console-locale-fil-ph",13478:"webinar-locale-ca-es-valencia",13507:"semantic-object-locale-is-is",13549:"services-user-profile",13652:"gallery-locale-pt-br",13666:"esp-locale-he-il",13680:"meeting-options-locale-pt-br",13692:"meeting-options-locale-is-is",13737:"biometric-enrollment-locale-ro-ro",13739:"people-targeting-locale-fr-fr",13749:"survey-locale-gl-es",13750:"webinar-locale-et-ee",13752:"share-email-locale-th-th",13794:"biometric-enrollment-locale-pl-pl",13838:"recurrence-locale-is-is",13847:"breakoutRooms-locale-ja-jp",13872:"meeting-room-console-locale-is-is",13968:"guardians-locale-ro-ro",14044:"people-targeting-locale-cy-gb",14095:"biometric-enrollment-locale-it-it",14151:"extensibility-locale-zh-cn",14166:"meeting-room-console-locale-ka-ge",14268:"share-email-locale-sl-si",14287:"survey-locale-zh-cn",14309:"survey-locale-et-ee",14368:"meeting-room-console-locale-mk-mk",14377:"channels-locale-de-de",14381:"cast-locale-ka-ge",14408:"services-live-stream-renderer",14421:"calling-meeting-options-form",14442:"chat-pane-header",14464:"meeting-options-locale-de-de",14526:"cast-locale-da-dk",14533:"people-targeting-locale-da-dk",14590:"breakoutRooms-locale-sl-si",14621:"services-developer-switchers",14646:"breakoutRooms-locale-ar-sa",14682:"global-error-boundary",14712:"broadcast-locale-nn-no",14727:"biometric-enrollment-locale-hu-hu",14743:"main-locale-ru-ru",14787:"msal-service",14826:"services-url-preview",14834:"meeting-options-locale-nn-no",15078:"people-targeting-locale-is-is",15522:"survey-locale-lt-lt",15523:"teams-and-channels-locale-ar-sa",15580:"esp-locale-es-mx",15750:"school-locale-ca-es-valencia",15783:"files-locale-nb-no",15793:"services-share",15923:"platform-app-service",15999:"recurrence-locale-nl-nl",16014:"services-translate",16045:"esp-locale-zh-tw",16095:"hostUxStrings42",16147:"components-screen-recorder102",16151:"services-people",16211:"main-locale-fi-fi",16316:"hostUxStrings53",16347:"calling-meeting-details-panel",16366:"data-resolvers-chat",16419:"metaos-core",16478:"teams-and-channels-locale-sk-sk",16487:"calendar-locale-el-gr",16622:"meetingFlyout-locale-vi-vn",16676:"semantic-object-locale-ca-es",16702:"services-calling-service-adapters",16705:"meeting-analytics-locale-ja-jp",16746:"gallery-locale-hr-hr",16804:"webinar-locale-az-latn-az",16907:"components-screen-recorder76",16918:"teams-and-channels-locale-uk-ua",17002:"messaging-locale-ro-ro",17044:"teams-and-channels-locale-da-dk",17097:"data-resolvers-azure-maps",17121:"breakoutRooms-locale-zh-cn",17124:"school-locale-tr-tr",17253:"calendar-locale-eu-es",17263:"components-screen-recorder28",17270:"meeting-room-console-locale-ru-ru",17285:"messaging-locale-nl-nl",17293:"recurrence-locale-pt-br",17342:"extensibility-locale-cs-cz",17400:"data-resolvers-meeting-options",17418:"recurrence-locale-ro-ro",17428:"meeting-room-console-locale-pt-pt",17475:"files-locale-ja-jp",17530:"attendee-view-app",17542:"calling-locale-lv-lv",17589:"meeting-options-locale-ca-es",17624:"hostUxStrings62",17638:"semantic-object-locale-ca-es-valencia",17652:"files-locale-hr-hr",17662:"recurrence-locale-nn-no",17695:"breakoutRooms-locale-id-id",17726:"meeting-room-console-locale-pt-br",17734:"biometric-enrollment-locale-cy-gb",17794:"broadcast-locale-fr-fr",17797:"esp-locale-en-us",17902:"data-resolvers-teams-meeting-policies",17965:"services-instant-answers",17968:"extensibility-locale-fi-fi",17984:"esp-locale-it-it",18026:"search-locale-ka-ge",18035:"meeting-lock-back-image",18129:"diagnostics-panel-renderer",18143:"meeting-room-console-locale-zh-cn",18223:"document-creator",18228:"people-targeting-locale-gl-es",18364:"broadcast-locale-cy-gb",18418:"esp-locale-kk-kz",18491:"hostUxStrings21",18500:"chat-list-apollo",18639:"connected-calendar-app",18773:"message-escalate-dialog",18846:"share-email-locale-sr-latn-rs",18927:"channels-locale-lt-lt",19002:"components-screen-recorder70",19050:"files-locale-he-il",19078:"survey-locale-zh-tw",19109:"meeting-analytics-locale-zh-cn",19135:"teams-and-channels-locale-fr-ca",19161:"services-search-substrate",19237:"people-targeting-locale-zh-tw",19319:"emoji-one-service",19330:"hostUxStrings36",19353:"survey-locale-fi-fi",19493:"school-locale-ro-ro",19495:"semantic-object-locale-zh-tw",19521:"esp-locale-et-ee",19534:"broadcast-locale-lt-lt",19599:"meeting-options-locale-sr-latn-rs",19753:"gallery-app",19778:"data-resolvers-esp",19856:"recurrence-locale-ko-kr",19997:"components-screen-recorder21",20029:"channels-locale-az-latn-az",20047:"hostUxStrings71",20058:"data-resolvers-activity-settings",20132:"calendar-locale-cs-cz",20158:"broadcast-locale-nl-nl",20267:"people-targeting-locale-ja-jp",20274:"meeting-room-console-locale-bg-bg",20323:"main-locale-hu-hu",20351:"share-email-locale-fil-ph",20397:"webinar-locale-nl-nl",20443:"people-targeting-locale-en-us",20516:"services-meeting-options",20538:"search-locale-en-us",20545:"biometric-enrollment-locale-ja-jp",20573:"semantic-object-locale-nb-no",20668:"meeting-room-console-locale-th-th",20672:"services-bots-platform",20718:"content-bubble-container",20741:"gallery-locale-uk-ua",20765:"components-screen-recorder110",20904:"recurrence-locale-pl-pl",20948:"gallery-locale-sq-al",20957:"broadcast-locale-et-ee",21033:"broadcast-locale-es-es",21083:"semantic-object-locale-mk-mk",21112:"hostUxStrings25",21167:"extensibility-locale-nl-nl",21174:"services-esp",21264:"hostUxStrings30",21311:"breakoutRooms-locale-kk-kz",21346:"survey-locale-fil-ph",21372:"webinar-locale-en-us",21514:"share-email-locale-de-de",21529:"components-screen-recorder88",21533:"config-dev",21632:"messaging-locale-az-latn-az",21689:"files-locale-da-dk",21705:"breakout-rooms-assign-dialog",21706:"data-schema-cdl",21777:"calendar-locale-he-il",21786:"gallery-locale-mk-mk",21795:"lob-notifications-entry",21822:"breakoutRooms-locale-el-gr",21833:"calling-locale-gl-es",21838:"cast-locale-et-ee",21933:"cast-locale-zh-tw",21978:"calendar-locale-mk-mk",21993:"meeting-analytics-locale-nb-no",22012:"files-locale-th-th",22042:"breakoutRooms-locale-en-gb",22064:"esp-locale-uk-ua",22121:"services-file-upload",22125:"calendar-locale-fi-fi",22312:"broadcast-locale-nb-no",22413:"teams-and-channels-locale-he-il",22423:"calendar-locale-ja-jp",22479:"ot",22540:"data-resolvers-browser-lms-integration",22555:"cast-locale-hr-hr",22581:"services-lms-integration",22616:"data-resolvers-people-avatar",22628:"share-email-locale-pl-pl",22750:"meetingFlyout-locale-pl-pl",22765:"deferredoperations",22799:"guardians-locale-el-gr",22803:"files-locale-pl-pl",22842:"esp-locale-ka-ge",22928:"meetingFlyout-locale-fil-ph",22999:"recurrence-locale-hi-in",23020:"files-locale-fi-fi",23025:"search-locale-uk-ua",23035:"biometric-enrollment-locale-fi-fi",23046:"breakoutRooms-locale-hu-hu",23065:"search-locale-vi-vn",23088:"services-invite-links",23169:"semantic-object-locale-ka-ge",23172:"chat-pane-image",23190:"main-locale-nn-no",23246:"guardians-locale-eu-es",23280:"recurrence-locale-da-dk",23363:"services-scis",23400:"messaging-locale-sq-al",23402:"esp-locale-is-is",23493:"broadcast-locale-th-th",23516:"messaging-locale-ka-ge",23540:"channels-locale-sk-sk",23762:"calling-locale-el-gr",23794:"search-locale-hi-in",23850:"extensibility-locale-ca-es",23890:"hostUxStrings17",23891:"teams-and-channels-locale-ja-jp",23893:"breakoutRooms-locale-en-us",23924:"phone-number-service",23954:"gallery-locale-ru-ru",23968:"survey-locale-is-is",24013:"recurrence-locale-sr-latn-rs",24073:"messaging-locale-sr-latn-rs",24092:"recurrence-locale-az-latn-az",24149:"guardians-locale-kk-kz",24179:"messaging-locale-cy-gb",24197:"fluid-compose-container",24257:"ResizeObserverPolyfill",24278:"main-locale-eu-es",24417:"breakoutRooms-locale-cs-cz",24444:"teams-and-channels-locale-cy-gb",24526:"callable-channels-app",24541:"components-screen-recorder100",24632:"hostUxStrings7",24657:"school-locale-pt-br",24665:"recurrence-locale-tr-tr",24677:"people-targeting-locale-az-latn-az",24860:"channels-locale-uk-ua",24925:"config-gcc",24937:"main-locale-en-gb",24944:"meetingFlyout-locale-sq-al",25026:"channels-locale-lv-lv",25067:"calendar-meeting-recommendations",25110:"broadcast-locale-vi-vn",25270:"data-resolvers-store",25312:"recurrence-locale-it-it",25343:"sb-config",25442:"survey-locale-vi-vn",25447:"meeting-room-console-locale-fr-ca",25471:"messaging-locale-nb-no",25509:"search-locale-sl-si",25532:"share-email-locale-cs-cz",25570:"breakoutRooms-locale-hr-hr",25604:"header-search-input-container",25622:"main-locale-ar-sa",25841:"components-screen-recorder106",26025:"channels-locale-es-es",26124:"data-resolvers-browser-webinar",26205:"hostUxStrings45",26263:"teams-and-channels-locale-cs-cz",26332:"survey-locale-nb-no",26340:"splash-screen",26447:"teams-and-channels-locale-ro-ro",26510:"broadcast-qna",26759:"data-resolvers-pstn",26816:"survey-locale-he-il",26819:"teams-and-channels-locale-en-us",26822:"files-locale-es-mx",26828:"files-locale-fr-ca",26842:"core-services-settings-debug",26858:"messaging-locale-lv-lv",26916:"share-email-locale-eu-es",26958:"cast-locale-uk-ua",27006:"school-locale-el-gr",27030:"meeting-options-locale-pl-pl",27112:"breakoutRooms-locale-lt-lt",27133:"data-resolvers-developer-switchers",27172:"search-locale-sq-al",27199:"main-locale-sk-sk",27214:"teams-and-channels-locale-nn-no",27217:"meeting-options-locale-zh-cn",27269:"recurrence-locale-hu-hu",27386:"components-screen-recorder42",27455:"gallery-locale-zh-cn",27490:"data-resolvers-browser-voicemail",27521:"search-locale-zh-tw",27573:"config-ag08",27639:"people-targeting-locale-ca-es",27648:"breakoutRooms-locale-ca-es",27662:"files-locale-en-gb",27910:"guardians-locale-hu-hu",27954:"survey-locale-ka-ge",28087:"meeting-options-locale-fr-fr",28135:"meeting-room-console-locale-hu-hu",28205:"channels-locale-hr-hr",28224:"components-screen-recorder48",28254:"guardians-locale-ru-ru",28256:"meeting-options-locale-ka-ge",28395:"school-locale-sl-si",28400:"channels-locale-es-mx",28420:"msal2-service",28437:"teams-and-channels-locale-fi-fi",28488:"webinar-locale-bg-bg",28489:"breakoutRooms-locale-tr-tr",28497:"hostUxStrings79",28508:"pstn-dialog-manager",28560:"services-broadcast-captions",28716:"extensibility-locale-th-th",28729:"share-form",28859:"meetingFlyout-locale-lt-lt",28862:"esp-locale-tr-tr",29046:"esp-locale-hi-in",29122:"share-email-locale-mk-mk",29290:"meeting-room-console-locale-eu-es",29401:"people-targeting-locale-lt-lt",29475:"esp-locale-el-gr",29477:"cast-locale-el-gr",29497:"extensibility-locale-ko-kr",29533:"hostUxStrings38",29559:"meeting-room-console-locale-lt-lt",29569:"messaging-locale-lt-lt",29709:"config-ag09",29731:"cast-locale-eu-es",29741:"guardians-locale-pt-br",29782:"channels-locale-ro-ro",29813:"meeting-analytics-locale-vi-vn",29837:"gallery-locale-is-is",29861:"guardians-app",29916:"smart-device-page-component",29922:"teams-and-channels-locale-hi-in",29959:"components-screen-recorder108",30018:"school-locale-es-es",30038:"data-resolvers-browser-calendar",30040:"unified-bar-container-manager",30078:"search-locale-eu-es",30087:"data-resolvers-bots-platform",30185:"cast-locale-es-es",30191:"gallery-locale-ca-es-valencia",30235:"teams-and-channels-locale-bg-bg",30236:"school-locale-az-latn-az",30242:"teams-and-channels-locale-pt-br",30288:"services-sharepoint-share",30291:"calling-locale-zh-cn",30588:"share-email-locale-cy-gb",30590:"recurrence-locale-de-de",30637:"webinar-locale-pt-br",30702:"hostUxStrings0",30748:"meetingFlyout-locale-eu-es",30783:"teams-and-channels-locale-th-th",30864:"channels-locale-ja-jp",30922:"gallery-locale-hi-in",31063:"components-screen-recorder66",31167:"guardians-locale-sl-si",31192:"data-resolvers-dynamics-marketing",31286:"meetingFlyout-locale-ar-sa",31354:"channels-locale-tr-tr",31374:"calling-locale-sv-se",31402:"people-targeting-locale-ca-es-valencia",31506:"search-locale-zh-cn",31513:"school-locale-ar-sa",31597:"breakoutRooms-locale-is-is",31624:"extensibility-locale-el-gr",31811:"biometric-enrollment-locale-ko-kr",31908:"esp-locale-gl-es",31963:"calling-locale-th-th",31986:"hostUxStrings74",32034:"services-connected-accounts",32057:"viewimages",32071:"messaging-locale-en-gb",32076:"main-locale-cs-cz",32085:"people-targeting-locale-nl-nl",32106:"gallery-locale-de-de",32334:"react-virtualized-tree-list",32426:"biometric-enrollment-locale-sr-latn-rs",32528:"codemirror",32529:"data-resolvers-import-msa-contacts",32719:"webinar-locale-ka-ge",32897:"esp-locale-nb-no",33075:"biometric-enrollment-locale-hr-hr",33097:"components-calendar-app-host",33105:"webinar-locale-en-gb",33199:"meetingFlyout-locale-es-es",33346:"meeting-options-locale-nb-no",33371:"teams-and-channels-locale-zh-cn",33454:"webinar-locale-es-mx",33485:"channels-locale-nn-no",33488:"esp-locale-lt-lt",33580:"calendar-locale-en-gb",33586:"apps-linkedin",33603:"gallery-locale-ja-jp",33611:"calling-locale-tr-tr",33637:"channels-locale-hu-hu",33642:"hostUxStrings3",33665:"esp-locale-eu-es",33738:"meeting-room-console-locale-ko-kr",33772:"channels-locale-th-th",33884:"biometric-enrollment-locale-da-dk",33885:"sp-filter-actions",33925:"recurrence-locale-el-gr",33981:"semantic-object-locale-gl-es",34027:"school-locale-es-mx",34055:"messaging-locale-fil-ph",34179:"esp-locale-fr-fr",34250:"biometric-enrollment-locale-uk-ua",34255:"webinar-locale-lv-lv",34257:"webinar-locale-gl-es",34279:"people-targeting-locale-nb-no",34287:"survey-locale-ar-sa",34322:"files-locale-vi-vn",34349:"calling-locale-hi-in",34379:"people-targeting-locale-th-th",34425:"messaging-locale-vi-vn",34496:"main-locale-gl-es",34526:"school-locale-ka-ge",34548:"extensibility-locale-sl-si",34602:"components-screen-recorder37",34652:"main-locale-nl-nl",34653:"data-resolvers-callable-channel",34692:"services-chat-endpoint-provider",34869:"biometric-enrollment-locale-lv-lv",34882:"data-schema",34884:"calendar-locale-id-id",35004:"channels-locale-fi-fi",35020:"meeting-analytics-locale-ca-es",35106:"school-locale-hi-in",35110:"survey-locale-ja-jp",35185:"meetingFlyout-locale-sv-se",35241:"data-resolvers-browser-teams",35392:"biometric-enrollment-locale-tr-tr",35409:"channels-locale-pt-pt",35413:"components-stream-camera",35551:"recurrence-locale-lt-lt",35568:"recurrence-locale-kk-kz",35577:"cast-locale-cs-cz",35588:"calling-locale-sl-si",35626:"share-email-locale-en-us",35731:"breakoutRooms-locale-lv-lv",35821:"gallery-locale-tr-tr",35833:"people-targeting-locale-hi-in",35921:"main-locale-zh-tw",35940:"cast-locale-fr-ca",36009:"components-screen-recorder16",36142:"extensibility-locale-sk-sk",36153:"guardians-locale-es-es",36227:"broadcast-locale-hi-in",36279:"meetingFlyout-locale-zh-tw",36333:"school-locale-da-dk",36397:"main-locale-de-de",36406:"calendar-locale-nl-nl",36537:"calendar-locale-en-us",36552:"components-screen-recorder10",36688:"school-locale-is-is",36720:"breakoutRooms-locale-mk-mk",36783:"meetingFlyout-locale-el-gr",36794:"messaging-locale-mk-mk",36821:"meeting-options-locale-en-gb",36856:"broadcast-locale-sl-si",37025:"teams-and-channels-locale-zh-tw",37131:"semantic-object-locale-he-il",37209:"hostUxStrings77",37232:"guardians-locale-ca-es",37249:"biometric-enrollment-locale-fr-fr",37301:"data-resolvers-files",37364:"esp-locale-fi-fi",37378:"webinar-locale-uk-ua",37390:"recurrence-locale-en-gb",37437:"cast-locale-id-id",37446:"biometric-enrollment-locale-pt-br",37458:"recurrence-locale-ja-jp",37472:"meeting-analytics-locale-sv-se",37481:"components-screen-recorder34",37514:"search-locale-tr-tr",37589:"meeting-analytics-locale-hu-hu",37673:"hostUxStrings44",37689:"meeting-analytics-locale-mk-mk",37754:"calling-locale-ru-ru",37762:"messaging-locale-sk-sk",37811:"cast-locale-fr-fr",37965:"esp-locale-th-th",38008:"files-locale-cs-cz",38021:"webinar-locale-sk-sk",38195:"meetingFlyout-locale-fr-fr",38221:"school-locale-hr-hr",38261:"webinar-locale-es-es",38355:"biometric-enrollment-locale-zh-cn",38431:"services-suggestions",38437:"main-locale-mk-mk",38457:"channels-locale-ar-sa",38461:"esp-locale-sk-sk",38552:"recurrence-locale-fr-fr",38564:"FluidFramework-HashFallback",38652:"semantic-object-locale-bg-bg",38653:"broadcast-locale-ka-ge",38685:"survey-locale-sk-sk",38693:"webinar-locale-lt-lt",38699:"search-locale-nb-no",38756:"meeting-room-console-locale-hr-hr",38783:"components-screen-recorder12",38806:"people-targeting-locale-sk-sk",38885:"calendar-locale-es-mx",39036:"search-locale-nl-nl",39079:"calling-locale-kk-kz",39090:"search-locale-fr-fr",39117:"gallery-locale-fi-fi",39307:"meetingFlyout-locale-en-us",39308:"survey-locale-mk-mk",39370:"share-email-locale-en-gb",39387:"search-locale-el-gr",39412:"hostUxStrings80",39435:"people-targeting-locale-ka-ge",39845:"messaging-locale-ko-kr",39886:"esp-locale-en-gb",39888:"survey-locale-pt-pt",39974:"recurrence-locale-sl-si",40042:"share-email-locale-pt-pt",40060:"services-brb",40114:"components-screen-recorder25",40125:"recurrence-locale-cy-gb",40150:"messaging-locale-sl-si",40221:"search-locale-ja-jp",40238:"recurrence-locale-sk-sk",40370:"files-locale-zh-tw",40416:"gallery-locale-bg-bg",40433:"meetingFlyout-locale-ca-es",40553:"meeting-options-locale-es-mx",40583:"extensibility-locale-vi-vn",40824:"people-targeting-locale-cs-cz",40826:"components-screen-recorder104",40866:"breakoutRooms-locale-th-th",40868:"data-resolvers-browser-floodgate",40879:"share-email-locale-sv-se",41007:"hostUxStrings41",41064:"share-email-locale-hi-in",41071:"hostUxStrings63",41127:"webview2-service",41143:"messaging-locale-en-us",41188:"files-locale-ru-ru",41272:"teams-and-channels-locale-de-de",41309:"channels-locale-en-us",41445:"broadcast-locale-fil-ph",41491:"gallery-locale-sk-sk",41557:"platform-app-metaos-service",41627:"breakoutRooms-locale-gl-es",41720:"files-locale-en-us",41795:"guardians-locale-ar-sa",41809:"data-resolvers-pinned-channels",41897:"cast-locale-pt-pt",42044:"calling-locale-hr-hr",42065:"breakoutRooms-locale-pt-pt",42119:"broadcast-locale-mk-mk",42120:"channels-locale-fr-ca",42143:"calendar-locale-ar-sa",42182:"meeting-analytics-locale-th-th",42239:"broadcast-locale-uk-ua",42282:"extensibility-locale-fil-ph",42337:"calling-locale-ja-jp",42371:"itemsview-deferredactions",42461:"services-petrol",42469:"guardians-locale-fr-fr",42516:"video-player",42549:"survey-locale-en-gb",42558:"calling-locale-uk-ua",42575:"channels-locale-cs-cz",42699:"meeting-room-console-locale-fr-fr",42742:"main-locale-zh-cn",42917:"components-screen-recorder46",42944:"meeting-options-locale-tr-tr",42985:"biometric-enrollment-locale-cs-cz",43212:"guardians-locale-cs-cz",43364:"hostUxStrings19",43458:"search-lazy-chunk",43469:"cast-locale-gl-es",43505:"semantic-object-locale-lt-lt",43532:"school-locale-lt-lt",43589:"esp-locale-sl-si",43642:"recurrence-locale-eu-es",43665:"files-locale-pt-pt",43795:"files-locale-ro-ro",43890:"broadcast-locale-bg-bg",44047:"calling-locale-he-il",44126:"webinar-locale-ja-jp",44145:"calling-locale-nb-no",44225:"meeting-room-console-entry",44264:"meetingFlyout-locale-mk-mk",44284:"gallery-locale-en-gb",44357:"hostUxStrings33",44386:"webinar-locale-tr-tr",44462:"data-resolvers-search-prefetch",44465:"people-targeting-locale-de-de",44470:"meeting-options-locale-sk-sk",44565:"esp-locale-sr-latn-rs",44570:"calling-locale-es-es",44585:"breakoutRooms-locale-hi-in",44586:"messaging-locale-zh-cn",44667:"biometric-enrollment-locale-en-us",44696:"cast-locale-sk-sk",44699:"cast-locale-en-us",44731:"hostUxStrings75",44778:"calendar-locale-fr-fr",44949:"ams-video-player",44975:"people-targeting-locale-he-il",45005:"school-locale-vi-vn",45029:"data-resolvers-host-updates",45138:"school-locale-pt-pt",45153:"search-locale-fil-ph",45170:"files-locale-id-id",45196:"calendar-locale-ca-es",45270:"people-targeting-locale-sv-se",45285:"main-locale-sr-latn-rs",45321:"extensibility-locale-tr-tr",45328:"school-locale-it-it",45560:"esp-locale-da-dk",45626:"services-meeting-artifacts",45702:"semantic-object-locale-nl-nl",45730:"meeting-analytics-locale-ru-ru",45742:"hostUxStrings43",45801:"biometric-enrollment-locale-is-is",45871:"messaging-locale-da-dk",45877:"files-locale-is-is",45882:"cast-locale-ca-es",45885:"guardians-locale-sq-al",45898:"semantic-object-locale-et-ee",45915:"meeting-options-locale-ca-es-valencia",45924:"cast-locale-ko-kr",45930:"messaging-locale-fr-fr",45933:"components-screen-recorder18",45965:"guardians-locale-id-id",45999:"calendar-locale-it-it",46119:"cortana-popup",46149:"extensibility-locale-ca-es-valencia",46232:"slimcore-webview2-bundle",46310:"data-resolvers-browser-call-recording",46402:"share-email-locale-es-mx",46433:"onePlayerLoader",46462:"semantic-object-locale-sv-se",46477:"gallery-locale-es-es",46563:"messaging-locale-th-th",46584:"esp-locale-vi-vn",46657:"calling-locale-en-us",46697:"esp-locale-lv-lv",46713:"gallery-locale-fr-ca",46739:"cast-locale-th-th",46789:"hostUxStrings73",46804:"search-locale-pt-pt",46848:"components-screen-recorder96",46873:"broadcast-locale-is-is",46978:"calling-locale-et-ee",46981:"search-locale-sv-se",47140:"semantic-object-locale-sq-al",47282:"survey-locale-lv-lv",47331:"meeting-analytics-locale-es-mx",47339:"hostUxStrings11",47468:"extensibility-locale-es-es",47511:"extensibility-locale-it-it",47573:"recurrence-locale-fi-fi",47639:"calendar-agenda-view",47663:"share-email-locale-fi-fi",47806:"data-resolvers-suggestions",47838:"meeting-options-locale-he-il",48098:"biometric-enrollment-locale-fr-ca",48113:"cast-locale-en-gb",48129:"data-resolvers-live-state-broadcast",48195:"data-resolvers-breakout-rooms",48226:"webinar-locale-nb-no",48370:"meeting-room-console-locale-sk-sk",48451:"calendar-locale-th-th",48550:"meetingFlyout-locale-nl-nl",48557:"message-extension-flyout-popup-container",48683:"recurrence-locale-lv-lv",48693:"services-item-crud",48715:"hostUxStrings5",48735:"config-dod",48840:"data-resolvers-browser-logs-files",48923:"semantic-object-locale-it-it",48943:"teams-and-channels-locale-id-id",49073:"data-resolvers-activity-bell-count",49087:"data-resolvers-loki",49120:"search-locale-he-il",49241:"biometric-enrollment-locale-nn-no",49333:"files-locale-de-de",49590:"calendar-locale-gl-es",49663:"people-targeting-locale-sq-al",49721:"extensibility-locale-hu-hu",49736:"esp-dialog",49752:"extensibility-locale-pl-pl",49784:"meeting-room-front-of-room-home",49808:"files-locale-ca-es-valencia",49810:"search-locale-es-mx",50104:"services-msa-authentication",50138:"people-targeting-locale-et-ee",50215:"broadcast-locale-sq-al",50284:"hostUxStrings16",50293:"share-email-locale-lt-lt",50391:"meeting-options-locale-hu-hu",50439:"survey-locale-tr-tr",50480:"meeting-options-locale-ko-kr",50636:"calendar-locale-ru-ru",50718:"services-files-personal",50747:"main-locale-bg-bg",50899:"tfl-calendar-people-picker",50906:"main-locale-en-us",50936:"survey-locale-cy-gb",50946:"meeting-room-console-locale-en-gb",50970:"school-locale-de-de",51106:"esp-locale-pt-pt",51292:"cast-locale-ca-es-valencia",51295:"extensibility-locale-sv-se",51309:"services-teams-and-channels",51317:"share-email-locale-lv-lv",51359:"breakoutRooms-locale-nb-no",51397:"webinar-locale-cs-cz",51425:"services-fluid",51554:"main-locale-ro-ro",51570:"breakoutRooms-locale-es-mx",51661:"data-resolvers-targeting-hierarchy",51704:"people-targeting-locale-ar-sa",51792:"services-webinar",51822:"main-locale-az-latn-az",51949:"data-resolvers-browser-mention",52287:"calendar-locale-fr-ca",52324:"components-screen-recorder90",52344:"main-locale-cy-gb",52354:"meeting-analytics-locale-sr-latn-rs",52433:"broadcast-locale-el-gr",52443:"meeting-room-console-locale-es-es",52534:"calling-locale-pt-pt",52683:"people-targeting-locale-mk-mk",52708:"recurrence-locale-sq-al",52713:"components-screen-recorder86",52761:"services-targeting-hierarchy",52781:"files-locale-kk-kz",52849:"components-screen-recorder80",52876:"guardians-locale-da-dk",52944:"extensibility-locale-de-de",52995:"channels-locale-ka-ge",53046:"hostUxStrings84",53069:"meeting-analytics-locale-es-es",53154:"webinar-locale-zh-cn",53228:"share-email-locale-kk-kz",53247:"calling-locale-lt-lt",53267:"people-targeting-locale-kk-kz",53277:"guardians-locale-mk-mk",53326:"hostUxStrings67",53460:"biometric-enrollment-locale-pt-pt",53613:"calling-locale-ka-ge",53615:"calling-locale-cs-cz",53637:"breakoutRooms-locale-nn-no",53715:"search-locale-hu-hu",53892:"closed-captions",53909:"meetingFlyout-locale-gl-es",53993:"main-locale-is-is",54009:"gallery-locale-cy-gb",54067:"teams-and-channels-locale-fr-fr",54068:"esp-locale-sv-se",54069:"extensibility-locale-en-us",54122:"semantic-object-locale-ru-ru",54125:"breakoutRooms-locale-fi-fi",54165:"services-people-targeting",54167:"sb-plugins",54177:"files-locale-hu-hu",54180:"search-locale-ru-ru",54198:"components-compose-extensions",54223:"gallery-locale-ko-kr",54270:"broadcast-locale-kk-kz",54347:"meeting-room-console-locale-es-mx",54423:"share-email-locale-az-latn-az",54447:"components-screen-recorder56",54515:"biometric-enrollment-locale-vi-vn",54541:"broadcast-locale-he-il",54569:"share-email-locale-nl-nl",54573:"cast-locale-ja-jp",54578:"channels-locale-fr-fr",54594:"school-locale-nb-no",54668:"config-gcchigh",54692:"services-toast-image",54761:"broadcast-locale-zh-tw",54788:"calling-locale-bg-bg",54937:"webinar-registration-app",54980:"school-locale-cs-cz",55046:"components-screen-recorder54",55143:"components-file-sharing-dialog",55192:"webinar-locale-kk-kz",55200:"semantic-object-locale-cy-gb",55204:"survey-locale-de-de",55206:"share-email-locale-ko-kr",55221:"data-resolvers-browser-files",55228:"meeting-options-locale-hr-hr",55279:"components-screen-recorder114",55320:"webinar-locale-cy-gb",55340:"survey-locale-ru-ru",55393:"chat-reject-call-button",55550:"gallery-locale-sv-se",55625:"calendar-locale-sl-si",55627:"components-screen-recorder60",55919:"data-resolvers-user-preferences",56010:"biometric-enrollment-locale-sv-se",56149:"biometric-enrollment-locale-es-mx",56244:"hostUxStrings9",56255:"services-biometric-enrollment",56275:"guardians-locale-et-ee",56312:"meeting-analytics-locale-hr-hr",56477:"share-email-locale-uk-ua",56481:"files-locale-ca-es",56633:"esp-locale-ro-ro",56641:"meeting-options-locale-ru-ru",56652:"people-targeting-locale-vi-vn",56679:"broadcast-locale-ro-ro",56712:"extensibility-locale-ru-ru",56722:"calling-locale-ca-es-valencia",56737:"services-collab-object",56738:"share-email-locale-bg-bg",56774:"guardians-locale-fi-fi",56795:"extensibility-locale-ro-ro",56864:"meeting-options-locale-it-it",56874:"data-resolvers-banners",56904:"search-app",57002:"school-locale-fil-ph",57048:"cast-locale-pl-pl",57052:"guardians-locale-de-de",57069:"calling-locale-fr-ca",57164:"main-locale-fr-ca",57405:"webinar-locale-ca-es",57426:"gallery-locale-da-dk",57441:"biometric-enrollment-locale-sk-sk",57449:"gallery-locale-gl-es",57510:"gallery-locale-fil-ph",57545:"cast-locale-az-latn-az",57561:"cast-locale-kk-kz",57610:"broadcast-locale-lv-lv",57699:"calling-locale-es-mx",57711:"extensibility-locale-es-mx",57721:"people-targeting-locale-tr-tr",57760:"survey-locale-fr-ca",57900:"extensibility-locale-az-latn-az",57944:"teams-and-channels-locale-fil-ph",57969:"midgard-bootstrapper",58035:"gallery-locale-fr-fr",58259:"guardians-locale-en-us",58276:"recurrence-locale-es-es",58359:"meeting-analytics-locale-et-ee",58392:"people-targeting-locale-sl-si",58444:"search-locale-lv-lv",58485:"school-locale-mk-mk",58486:"cast-locale-sq-al",58557:"extensibility-locale-kk-kz",58622:"messaging-locale-pt-br",58670:"meeting-analytics-locale-lt-lt",58686:"guardians-locale-es-mx",58758:"meeting-room-console-locale-da-dk",58814:"meeting-room-console-locale-vi-vn",59048:"esp-locale-de-de",59067:"platform-app",59098:"services-store",59151:"main-locale-sl-si",59166:"meeting-options-locale-cs-cz",59206:"common-post-types",59258:"share-email-locale-es-es",59360:"people-targeting-locale-fr-ca",59401:"meeting-options-locale-sl-si",59518:"channels-locale-sl-si",59616:"services-user-license",59663:"breakoutRooms-locale-az-latn-az",59746:"semantic-object-locale-tr-tr",59752:"people-targeting-locale-el-gr",59753:"hostUxStrings70",59818:"auth",59831:"components-screen-recorder30",59860:"search-locale-pl-pl",59923:"components-screen-recorder14",59930:"guardians-locale-uk-ua",59982:"esp-locale-cy-gb",60005:"survey-locale-sq-al",60060:"channels-locale-hi-in",60100:"biometric-enrollment-locale-mk-mk",60111:"files-locale-tr-tr",60115:"data-resolvers-policies",60123:"hostUxStrings27",60273:"guardians-locale-zh-cn",60325:"main-locale-fr-fr",60347:"broadcast-locale-fi-fi",60532:"data-resolvers-presence",60639:"calendar-locale-pl-pl",60684:"biometric-enrollment-locale-eu-es",60695:"cypress-tests-only",60698:"selectmedia",60713:"gallery-locale-th-th",60767:"webinar-locale-nn-no",60785:"meeting-analytics-locale-fr-fr",60941:"platform-app-rail",60988:"recurrence-locale-zh-tw",61033:"hostUxStrings24",61038:"share-email-locale-zh-cn",61051:"create-folder-dialog",61074:"guardians-locale-pt-pt",61090:"teams-and-channels-locale-ru-ru",61145:"cast-locale-sv-se",61176:"meetingFlyout-locale-da-dk",61183:"share-email-locale-ro-ro",61235:"guardians-locale-fr-ca",61286:"hostUxStrings1",61320:"meeting-options-locale-fil-ph",61330:"hostUxStrings8",61331:"main-locale-sq-al",61386:"meeting-analytics-locale-nn-no",61518:"meeting-room-console-locale-ar-sa",61537:"people-targeting-locale-it-it",61539:"semantic-object-locale-pt-pt",61543:"calendar-locale-sq-al",61627:"data-resolvers-contacts-sync-banner",61880:"meetingFlyout-locale-th-th",61922:"broadcast-locale-sv-se",62030:"teams-and-channels-app",62036:"guardians-locale-ja-jp",62050:"biometric-enrollment-locale-de-de",62058:"multi-window-dashboard-renderer",62139:"teams-and-channels-locale-tr-tr",62151:"calling-debug-participants",62198:"hostUxStrings28",62245:"calling-locale-pl-pl",62294:"guardians-locale-fil-ph",62351:"broadcast-locale-pt-pt",62376:"config-prod",62382:"broadcast-locale-it-it",62437:"services-tenant-membership",62457:"broadcast-locale-eu-es",62472:"breakoutRooms-locale-eu-es",62531:"teams-and-channels-locale-pl-pl",62556:"channels-locale-bg-bg",62580:"meetingFlyout-locale-pt-br",62665:"components-screen-recorder82",62716:"biometric-enrollment-locale-ca-es-valencia",62763:"teams-and-channels-locale-ko-kr",62781:"calendar-locale-sk-sk",62985:"messaging-locale-he-il",62990:"gallery-locale-cs-cz",63017:"meeting-room-console-locale-de-de",63054:"calendar-locale-nb-no",63184:"hostUxStrings66",63185:"calendar-locale-pt-br",63233:"messaging-locale-hu-hu",63235:"extensibility-locale-zh-tw",63237:"people-targeting-locale-bg-bg",63366:"fluid-picker-renderer",63402:"hostUxStrings57",63408:"cast-locale-ar-sa",63616:"files-locale-el-gr",63685:"services-broadcast-attendee",63686:"share-form-email-entry",63732:"biometric-enrollment-locale-zh-tw",63823:"teams-and-channels-locale-en-gb",63825:"files-locale-fil-ph",63871:"school-locale-zh-tw",63903:"files-locale-sk-sk",63936:"meeting-apps-flyout-renderer",63957:"messaging-locale-et-ee",64009:"broadcast-locale-da-dk",64010:"webinar-locale-is-is",64055:"bridge-migration-components-calendar-app-host",64078:"broadcast-locale-ca-es",64108:"people-targeting-locale-nn-no",64110:"meeting-room-console-locale-az-latn-az",64270:"extensibility-locale-eu-es",64279:"survey-locale-it-it",64403:"semantic-object-locale-th-th",64422:"esp-locale-fil-ph",64423:"cast-locale-ro-ro",64574:"services-sharepoint-client",64618:"main-locale-uk-ua",64749:"cast-locale-tr-tr",64754:"extensibility-locale-bg-bg",64876:"messaging-locale-is-is",64878:"calendar-locale-lt-lt",64897:"files-locale-fr-fr",65025:"guardians-locale-ko-kr",65041:"gallery-locale-ro-ro",65054:"survey-locale-hi-in",65065:"webinar-locale-pt-pt",65110:"extensibility-locale-et-ee",65151:"files-locale-mk-mk",65238:"webinar-locale-zh-tw",65240:"semantic-object-locale-sk-sk",65242:"fluid-message-container",65365:"data-resolvers-teams",65398:"data-resolvers-msa-authentication",65466:"share-email-locale-he-il",65469:"meeting-analytics-locale-fi-fi",65471:"spaddondeferred",65477:"breakoutRooms-locale-ca-es-valencia",65556:"channels-locale-fil-ph",65647:"channels-locale-is-is",65707:"lms-integration-image-default-export",65748:"channels-locale-da-dk",65758:"people-targeting-locale-ru-ru",65844:"share-email-locale-it-it",66073:"meeting-options-locale-sv-se",66129:"school-locale-eu-es",66144:"gallery-locale-pl-pl",66152:"messaging-locale-uk-ua",66167:"school-locale-zh-cn",66204:"chat-call-button",66235:"meeting-analytics-locale-tr-tr",66263:"data-resolvers-fluid",66435:"meeting-analytics-locale-pl-pl",66467:"recurrence-locale-hr-hr",66525:"search-locale-nn-no",66610:"cast-locale-it-it",66693:"meetingFlyout-locale-hu-hu",66694:"meeting-room-console-locale-id-id",66725:"esp-engine",66736:"biometric-enrollment-locale-th-th",66761:"search-locale-pt-br",66833:"breakoutRooms-locale-zh-tw",66894:"meeting-analytics-locale-pt-pt",66953:"survey-locale-el-gr",67008:"people-targeting-locale-zh-cn",67083:"calling-locale-fil-ph",67103:"gallery-locale-zh-tw",67131:"broadcast-locale-de-de",67326:"files-locale-it-it",67409:"meeting-room-console-locale-sq-al",67417:"call-blocking-service",67442:"semantic-object-locale-es-mx",67450:"meetingFlyout-locale-ja-jp",67526:"main-locale-ko-kr",67569:"survey-locale-en-us",67658:"school-locale-et-ee",67676:"cast-locale-mk-mk",67681:"recurrence-locale-id-id",67742:"files-locale-ko-kr",67767:"data-resolvers-distribution-list",67769:"meeting-room-console-locale-sr-latn-rs",67785:"data-resolvers-team-settings",67847:"broadcast-locale-fr-ca",67883:"breakoutRooms-locale-fil-ph",67949:"webinar-locale-ko-kr",67960:"meeting-analytics-locale-ko-kr",67973:"components-screen-recorder72",67977:"meeting-options-locale-lv-lv",67997:"meetingFlyout-locale-az-latn-az",68054:"data-resolvers-localization-settings",68074:"recurrence-locale-et-ee",68304:"main-locale-et-ee",68312:"meeting-analytics-locale-lv-lv",68341:"hostUxStrings51",68400:"data-resolvers-mfu-contacts",68472:"webinar-locale-pl-pl",68557:"broadcast-app",68597:"biometric-enrollment-locale-kk-kz",68640:"cast-locale-pt-br",68677:"hostUxStrings59",68722:"messaging-locale-kk-kz",68734:"calendar-locale-de-de",68740:"calls-main-app",68778:"calendar-app",68781:"breakoutRooms-locale-he-il",68880:"hostUxStrings55",68935:"meeting-options-locale-vi-vn",69006:"calendar-locale-sr-latn-rs",69081:"services-external-accounts",69085:"meeting-room-console-locale-it-it",69120:"webinar-locale-sq-al",69144:"share-email-locale-pt-br",69177:"teams-and-channels-locale-mk-mk",69338:"biometric-enrollment-locale-hi-in",69380:"people-targeting-locale-pt-pt",69482:"meeting-analytics-locale-az-latn-az",69541:"components-screen-recorder32",69545:"main-locale-vi-vn",69621:"webinar-locale-ar-sa",69622:"school-locale-he-il",69971:"search-locale-gl-es",70041:"cast-locale-bg-bg",70152:"tti-polyfill",70175:"guardians-locale-sv-se",70182:"meetingFlyout-locale-cs-cz",70200:"recurrence-locale-gl-es",70225:"data-resolvers-shell",70245:"components-screen-recorder50",70279:"messaging-locale-gl-es",70293:"semantic-object-locale-az-latn-az",70326:"calling-app",70357:"data-resolvers-browser-url-preview",70421:"components-screen-recorder58",70542:"extensibility-locale-nb-no",70602:"esp-locale-mk-mk",70706:"survey-locale-ca-es-valencia",70716:"main-locale-hi-in",70723:"search-locale-hr-hr",70881:"share-email-locale-tr-tr",70913:"calendar-locale-fil-ph",70972:"services-import-msa-contacts",71021:"esp-locale-ru-ru",71216:"calendar-locale-hr-hr",71401:"services-async-media",71409:"people-targeting-locale-es-es",71482:"meetingFlyout-locale-sl-si",71515:"guardians-locale-sk-sk",71678:"semantic-object-locale-hr-hr",71835:"meetingFlyout-locale-lv-lv",71920:"biometric-enrollment-locale-fil-ph",71993:"meeting-options-locale-id-id",72001:"channels-locale-sr-latn-rs",72297:"extensibility-locale-nn-no",72324:"calendar-locale-az-latn-az",72333:"meeting-options-locale-bg-bg",72479:"survey-locale-az-latn-az",72501:"semantic-object-locale-pt-br",72564:"config-life",72638:"files-locale-es-es",72767:"cast-locale-zh-cn",73051:"survey-locale-nl-nl",73142:"recurrence-locale-nb-no",73166:"survey-locale-eu-es",73170:"survey-locale-id-id",73206:"officeFluidOneDsSink",73292:"survey-forms-app",73312:"calendar-locale-is-is",73339:"breakoutRooms-locale-es-es",73523:"people-targeting-locale-lv-lv",73533:"components-screen-recorder36",73676:"data-resolvers-user",73696:"semantic-object-locale-ro-ro",73717:"extensibility-locale-da-dk",73773:"teams-and-channels-locale-es-es",73795:"cast-locale-sl-si",73804:"meeting-room-console-locale-ca-es",73806:"services-giphy",73826:"share-email-locale-sk-sk",73836:"itemsettileslist",73851:"broadcast-locale-en-gb",73956:"meetingFlyout-locale-es-mx",73969:"data-resolvers-browser-survey",74120:"share-email-locale-da-dk",74135:"meeting-room-console-locale-sv-se",74188:"files-locale-bg-bg",74217:"teams-and-channels-locale-pt-pt",74224:"gallery-locale-et-ee",74237:"meetingFlyout-locale-zh-cn",74249:"calendar-locale-pt-pt",74282:"extensibility-locale-uk-ua",74322:"channels-locale-nb-no",74403:"teams-and-channels-locale-az-latn-az",74449:"meetingFlyout-locale-ca-es-valencia",74471:"biometric-enrollment-locale-lt-lt",74515:"calling-locale-ko-kr",74516:"mo-people-selection",74574:"files-locale-ar-sa",74590:"survey-locale-da-dk",74604:"guardians-locale-sr-latn-rs",74687:"guardians-locale-gl-es",74783:"meetingFlyout-locale-he-il",74786:"semantic-object-locale-nn-no",74801:"biometric-enrollment-locale-nl-nl",74837:"esp-locale-ca-es-valencia",74847:"esp-locale-zh-cn",74853:"share-email-locale-ar-sa",74863:"hostUxStrings12",74896:"biometric-enrollment-locale-id-id",74906:"meeting-analytics-locale-uk-ua",74917:"gallery-locale-ar-sa",74934:"hostUxStrings35",75041:"meeting-room-console-locale-tr-tr",75123:"recurrence-locale-fr-ca",75292:"hostUxStrings4",75294:"school-locale-cy-gb",75363:"biometric-enrollment-locale-ar-sa",75402:"school-locale-ru-ru",75413:"broadcast-locale-pt-br",75447:"search-locale-sr-latn-rs",75499:"data-resolvers-coach-report",75504:"survey-locale-sr-latn-rs",75519:"survey-locale-pl-pl",75546:"files-locale-sl-si",75558:"meeting-options-app",75613:"files-locale-eu-es",75667:"meeting-analytics-locale-de-de",75810:"calling-empty-notes-page",75833:"hostUxStrings37",75895:"broadcast-locale-zh-cn",75925:"services-calling",76001:"teams-and-channels-locale-ca-es",76003:"data-resolvers-connected-calendar",76023:"data-resolvers-browser-tpn",76102:"components-calendar-surface-all-day-events",76118:"guardians-locale-tr-tr",76130:"services-presence",76138:"data-resolvers-biometric-enrollment",76141:"webinar-locale-id-id",76205:"extensibility-locale-fr-fr",76240:"main-locale-th-th",76274:"breakoutRooms-locale-ko-kr",76293:"search-locale-it-it",76317:"semantic-object-locale-fil-ph",76327:"cast-locale-sr-latn-rs",76355:"channels-locale-et-ee",76370:"esp-locale-id-id",76426:"files-locale-sr-latn-rs",76605:"esp-locale-es-es",76657:"cast-app",76738:"hostUxStrings68",76803:"components-screen-recorder94",76807:"recurrence-locale-uk-ua",76808:"services-report-concern",76912:"hostUxStrings31",76940:"channels-locale-mk-mk",77060:"components-screen-recorder52",77067:"gallery-locale-nb-no",77153:"broadcast-locale-sr-latn-rs",77159:"components-screen-recorder0",77209:"services-chat",77233:"people-targeting-locale-fil-ph",77285:"meeting-room-console-locale-ja-jp",77357:"recurrence-locale-zh-cn",77412:"services-third-party-calendar",77527:"gallery-locale-hu-hu",77649:"components-screen-recorder68",77661:"calendar-locale-cy-gb",77747:"people-targeting-locale-sr-latn-rs",77750:"channels-locale-sv-se",77767:"customSearchPage",77772:"components-screen-recorder44",77793:"hostUxStrings64",77869:"webinar-locale-hr-hr",77953:"meetingFlyout-locale-et-ee",78052:"people-targeting-locale-ro-ro",78053:"services-search-prefetch",78092:"hostUxStrings85",78130:"semantic-object-locale-sl-si",78220:"calendar-locale-ca-es-valencia",78334:"meeting-options-locale-mk-mk",78402:"meeting-room-console-locale-lv-lv",78433:"recurrence-locale-pt-pt",78456:"main-locale-kk-kz",78537:"meeting-options-locale-sq-al",78580:"extensibility-locale-sq-al",78594:"data-resolvers-apps-platform",78609:"share-email-locale-hu-hu",78641:"calendar-locale-tr-tr",78729:"hostUxStrings13",78746:"search-locale-fi-fi",78755:"webinar-locale-da-dk",78773:"school-locale-uk-ua",78800:"webinar-locale-fr-fr",78832:"services-emoticon",78858:"files-locale-uk-ua",78864:"survey-locale-bg-bg",78866:"data-resolvers-team-gallery",78981:"broadcast-locale-ru-ru",78994:"breakoutRooms-locale-ro-ro",78996:"data-resolvers-meeting-templates",79010:"search-locale-ro-ro",79019:"meetingFlyout-locale-uk-ua",79088:"cast-locale-fi-fi",79104:"cast-locale-ru-ru",79297:"meetingFlyout-locale-cy-gb",79316:"calling-locale-fi-fi",79355:"calling-locale-nn-no",79455:"data-resolvers-browser-virtual-events",79506:"services-search",79629:"hostUxStrings15",79737:"hostUxStrings29",79754:"files-locale-et-ee",79932:"data-resolvers-people-targeting",79957:"gallery-locale-vi-vn",80016:"search-locale-az-latn-az",80052:"chat-join-screen-share-button",80093:"meeting-room-console-locale-fi-fi",80117:"main-locale-fil-ph",80127:"share-email-locale-is-is",80129:"hostUxStrings82",80184:"main-locale-es-es",80243:"hostUxStrings47",80253:"search-locale-fr-ca",80262:"calendar-locale-hi-in",80282:"school-locale-sr-latn-rs",80293:"semantic-object-locale-fi-fi",80414:"biometric-enrollment-entry",80473:"meeting-options-locale-fi-fi",80540:"meeting-room-console-locale-nb-no",80570:"search-locale-kk-kz",80574:"data-resolvers-taskbar",80648:"people-targeting-locale-en-gb",80699:"semantic-object-locale-uk-ua",80839:"broadcast-locale-sk-sk",80956:"survey-locale-th-th",81102:"recurrence-locale-mk-mk",81148:"deferred",81205:"main-locale-lt-lt",81249:"webinar-locale-fil-ph",81293:"components-screen-recorder92",81381:"breakoutRooms-locale-ka-ge",81439:"hostUxStrings20",81516:"webinar-locale-de-de",81565:"breakoutRooms-locale-sr-latn-rs",81641:"calendar-scheduling-form-app",81647:"chat-app",81683:"school-locale-sv-se",81694:"data-resolvers-third-party-calendar",81706:"calling-locale-is-is",81783:"share-email-locale-zh-tw",81879:"semantic-object-locale-fr-ca",81897:"meeting-analytics-locale-eu-es",81916:"channels-locale-zh-tw",81933:"teams-and-channels-locale-it-it",82023:"semantic-object-locale-eu-es",82080:"meeting-room-console-locale-sl-si",82098:"calling-locale-nl-nl",82117:"survey-locale-hr-hr",82222:"meeting-options-locale-fr-ca",82271:"react-diagnostics",82290:"broadcast-producer-screen",82329:"data-resolvers-platform-tabs",82418:"school-locale-id-id",82522:"calling-locale-eu-es",82703:"teams-and-channels-locale-et-ee",82722:"messaging-locale-es-es",82749:"share-email-locale-hr-hr",82754:"meetingFlyout-locale-hr-hr",82831:"webinar-locale-fr-ca",82856:"teams-and-channels-locale-es-mx",82901:"meeting-room-console-locale-kk-kz",82922:"files-locale-gl-es",82989:"search-locale-ar-sa",82991:"data-resolvers-channels",83017:"calling-locale-ro-ro",83028:"data-resolvers-update-client-state",83059:"gallery-locale-id-id",83062:"main-locale-pl-pl",83107:"calendar-locale-ro-ro",83110:"files-locale-sv-se",83226:"meeting-analytics-locale-zh-tw",83240:"main-locale-ca-es",83393:"gallery-locale-eu-es",83400:"teams-and-channels-locale-sv-se",83423:"cast-locale-nl-nl",83438:"channels-locale-kk-kz",83483:"services-google-calendar-authentication",83549:"messaging-locale-zh-tw",83593:"messaging-locale-sv-se",83619:"channels-locale-ru-ru",83654:"broadcast-locale-hr-hr",83663:"components-screen-recorder62",83695:"meeting-options-locale-az-latn-az",83772:"calendar-locale-kk-kz",83795:"school-locale-ca-es",83819:"components-screen-recorder112",83906:"meeting-analytics-locale-sq-al",83992:"calendar-locale-es-es",84004:"components-calling-quality-feedback",84021:"meetingFlyout-locale-ru-ru",84042:"data-resolvers-brb",84063:"cast-locale-es-mx",84091:"data-resolvers-invite-links",84197:"guardians-locale-ka-ge",84226:"data-resolvers-contacts-sync-settings",84265:"breakoutRooms-locale-bg-bg",84335:"data-resolvers-user-license",84399:"share-email-locale-vi-vn",84441:"broadcast-locale-ca-es-valencia",84517:"search-locale-id-id",84548:"components-screen-recorder8",84586:"holographic-canvas",84615:"services-call-recording",84765:"survey-locale-ca-es",84766:"main-locale-el-gr",84787:"channels-locale-he-il",84836:"calendar-locale-zh-cn",84843:"components-screen-recorder6",84885:"school-locale-sk-sk",84975:"guardians-locale-bg-bg",85077:"services-io-browser-calling-video-rendering",85108:"services-app-based-link",85333:"main-locale-he-il",85340:"meeting-analytics-locale-fr-ca",85358:"messaging-locale-nn-no",85381:"esp-locale-fr-ca",85421:"gallery-locale-kk-kz",85470:"gallery-locale-nn-no",85503:"guardians-locale-th-th",85550:"search-locale-th-th",85565:"breakoutRooms-locale-ru-ru",85608:"teams-and-channels-locale-hu-hu",85843:"school-locale-fi-fi",85869:"semantic-object-locale-cs-cz",85991:"meeting-room-console-locale-gl-es",86007:"meetingFlyout-locale-sk-sk",86018:"extensibility-locale-lv-lv",86060:"data-resolvers-search",86146:"cast-locale-fil-ph",86194:"meetingFlyout-locale-nn-no",86205:"data-resolvers-teams-and-channels",86347:"calling-locale-zh-tw",86358:"meetingFlyout-locale-id-id",86395:"hostUxStrings22",86549:"search-locale-es-es",86608:"biometric-enrollment-locale-en-gb",86639:"data-resolvers-channel-messages",86793:"hostUxStrings83",86798:"files-locale-cy-gb",86855:"guardians-locale-ca-es-valencia",86910:"hostUxStrings34",87024:"channels-locale-ca-es",87227:"data-resolvers-system-settings",87237:"recurrence-locale-ca-es",87309:"reactions-overlay-webgl-renderer",87310:"calendar-locale-ka-ge",87311:"hostUxStrings39",87314:"data-resolvers-contacts-sync",87329:"webinar-locale-mk-mk",87408:"meeting-analytics-locale-fil-ph",87417:"biometric-enrollment-locale-bg-bg",87480:"services-image-proxy",87562:"semantic-object-locale-en-us",87574:"data-resolvers-esp-target",87598:"files-locale-hi-in",87644:"new-chat-header",87808:"files-locale-az-latn-az",87844:"survey-locale-fr-fr",87921:"esp-locale-bg-bg",87927:"services-io-azure-maps",88026:"calling-cdl",88059:"messaging-locale-de-de",88137:"services-meeting-templates",88146:"gallery-locale-az-latn-az",88207:"survey-locale-cs-cz",88216:"people-targeting-locale-eu-es",88282:"broadcast-locale-pl-pl",88314:"data-resolvers-browser-chat",88357:"annotation-app",88409:"cast-locale-cy-gb",88437:"people-targeting-locale-pl-pl",88441:"breakoutRooms-locale-sk-sk",88458:"calendar-locale-uk-ua",88478:"calling-locale-pt-br",88531:"semantic-object-locale-ko-kr",88540:"data-resolvers-tenant-membership",88542:"data-resolvers-external-accounts",88558:"teams-and-channels-locale-gl-es",88664:"guardians-locale-en-gb",88681:"main-locale-sv-se",88725:"webinar-locale-sl-si",88729:"components-screen-recorder98",88787:"meeting-options-locale-gl-es",88811:"broadcast-locale-en-us",88876:"meeting-room-console-locale-ca-es-valencia",88901:"semantic-object-locale-lv-lv",88909:"channels-locale-zh-cn",88910:"esp-locale-hr-hr",88919:"platform-modal",88927:"school-locale-th-th",88975:"services-logs-files",89043:"survey-locale-kk-kz",89109:"main-locale-hr-hr",89118:"guardians-locale-hr-hr",89139:"esp-locale-pl-pl",89167:"people-targeting-locale-hr-hr",89183:"meeting-options-locale-zh-tw",89275:"channels-locale-ca-es-valencia",89430:"cast-locale-is-is",89483:"messaging-locale-tr-tr",89509:"share-email-locale-id-id",89544:"messaging-locale-hr-hr",89649:"messaging-locale-ar-sa",89676:"semantic-object-locale-id-id",89683:"messaging-locale-eu-es",89829:"services-loki",89847:"breakoutRooms-locale-pt-br",89903:"guardians-locale-pl-pl",89905:"gallery-locale-sl-si",89907:"breakoutRooms-locale-et-ee",89962:"fluentui",90166:"meeting-options-locale-uk-ua",90170:"data-resolvers-browser-guardians",90189:"survey-locale-nn-no",90265:"gallery-locale-el-gr",90477:"extensibility-locale-gl-es",90565:"recurrence-locale-sv-se",90580:"breakoutRooms-locale-nl-nl",90631:"meeting-analytics-locale-en-us",90658:"meeting-room-console-locale-nn-no",90720:"meetingFlyout-locale-ko-kr",90928:"main-locale-pt-br",90963:"data-resolvers-browser-audience",91025:"calling-meeting-info-panel",91029:"data-resolvers-browser-meeting-artifacts",91036:"teams-search-prefetch-configs",91041:"meeting-analytics-locale-cy-gb",91068:"meeting-analytics-locale-it-it",91138:"calendar-locale-nn-no",91143:"messaging-locale-it-it",91282:"channels-locale-sq-al",91443:"data-resolvers-cypress-only",91487:"messaging-locale-ja-jp",91494:"services-atp-safelinks",91496:"webinar-locale-vi-vn",91504:"meeting-analytics-locale-ka-ge",91510:"channels-locale-vi-vn",91596:"school-locale-fr-fr",91643:"recurrence-locale-ca-es-valencia",91716:"messaging-locale-pl-pl",91736:"meeting-analytics-locale-pt-br",91789:"calling",91910:"files-locale-zh-cn",91920:"sb-stream-policy",91941:"meeting-room-console-locale-he-il",92186:"biometric-enrollment-locale-el-gr",92278:"gallery-locale-pt-pt",92326:"hostUxStrings46",92444:"teams-and-channels-locale-lt-lt",92521:"semantic-object-locale-el-gr",92525:"calling-locale-sr-latn-rs",92574:"main-locale-tr-tr",92680:"webinar-locale-eu-es",92712:"calendar-locale-bg-bg",92729:"hostUxStrings54",92784:"esp-locale-nn-no",92819:"meeting-options-locale-en-us",92966:"share-email-locale-fr-ca",93007:"files-locale-ka-ge",93048:"channels-locale-en-gb",93050:"search-locale-bg-bg",93121:"meeting-room-console-locale-zh-tw",93186:"hostUxStrings58",93200:"share-email-locale-gl-es",93202:"meeting-room-console-locale-pl-pl",93241:"breakoutRooms-locale-it-it",93288:"webinar-locale-hi-in",93295:"messaging-locale-hi-in",93300:"meetingFlyout-locale-fr-ca",93337:"meeting-options-locale-hi-in",93376:"services-io-calendar",93393:"services-pstn",93400:"teams-and-channels-locale-is-is",93446:"meetingFlyout-locale-tr-tr",93467:"gallery-locale-lt-lt",93553:"data-resolvers-browser-settings",93820:"search-locale-en-gb",93844:"data-resolvers-people-picker",93870:"semantic-object-locale-fr-fr",93902:"data-resolvers-privacy-settings",94057:"calling-locale-en-gb",94061:"channels-locale-it-it",94101:"agenda-page-app",94159:"hostUxStrings65",94166:"services-floodgate",94219:"channels-locale-nl-nl",94236:"calling-debug",94248:"services-gallery",94253:"files-locale-sq-al",94259:"share-email-locale-ka-ge",94411:"broadcast-locale-tr-tr",94421:"addon-sp-deferredactions",94444:"semantic-object-locale-sr-latn-rs",94462:"spaddondataonlydeferred",94476:"guardians-locale-cy-gb",94543:"people-targeting-locale-es-mx",94598:"breakoutRooms-locale-da-dk",94601:"call-transcript-panel",94637:"callable-channel-calls-app",94658:"esp-locale-ko-kr",94766:"channels-locale-gl-es",94772:"share-email-locale-ca-es",94779:"school-locale-lv-lv",94819:"search-locale-et-ee",95002:"meeting-options-locale-el-gr",95014:"workflow-flyout-container",95052:"teams-and-channels-locale-nl-nl",95121:"survey-locale-uk-ua",95268:"messaging-locale-el-gr",95339:"channels-locale-pt-br",95341:"hostUxStrings26",95487:"channels-locale-eu-es",95571:"meeting-options-locale-th-th",95589:"teams-and-channels-locale-ca-es-valencia",95691:"teams-and-channels-locale-eu-es",95768:"people-targeting-locale-pt-br",95772:"files-locale-nl-nl",95787:"gallery-locale-sr-latn-rs",95830:"channels-locale-el-gr",95844:"broadcast-locale-cs-cz",95859:"biometric-enrollment-locale-es-es",95972:"meeting-room-console-locale-el-gr",96007:"meeting-options-locale-et-ee",96008:"hostUxStrings14",96057:"biometric-enrollment-locale-gl-es",96079:"calling-locale-ca-es",96105:"meeting-analytics-locale-el-gr",96106:"auth_v2",96137:"meeting-analytics-locale-ro-ro",96148:"biometric-enrollment-locale-et-ee",96149:"meeting-room-console-locale-et-ee",96317:"share-email-locale-nn-no",96334:"share-email-locale-ru-ru",96362:"recurrence-locale-ar-sa",96380:"people-targeting-locale-fi-fi",96386:"data-resolvers-bots-platform-worker",96387:"recurrence-locale-vi-vn",96449:"esp-locale-hu-hu",96555:"biometric-enrollment-locale-az-latn-az",96624:"calling-locale-ar-sa",96650:"recurrence-locale-th-th",96656:"components-screen-recorder4",96696:"teams-and-channels-locale-sr-latn-rs",96698:"esp-coachmark",96708:"msteams/components-meet-now-panel",96728:"hostUxStrings50",96793:"guardians-locale-nb-no",96802:"webinar-locale-ru-ru",96836:"webinar-locale-sv-se",96848:"cast-locale-lt-lt",96893:"breakoutRooms-locale-de-de",96978:"services-live-state-broadcast",97014:"meeting-options-locale-kk-kz",97119:"calling-locale-it-it",97130:"store-app",97202:"guardians-locale-he-il",97282:"meeting-analytics-locale-kk-kz",97323:"data-resolvers-gallery",97423:"fluid-paste-container",97436:"messaging-locale-bg-bg",97507:"calling-locale-de-de",97526:"mw-shell-app",97548:"share-email-locale-nb-no",97550:"breakoutRooms-locale-sv-se",97554:"school-locale-fr-ca",97596:"guardians-locale-is-is",97606:"semantic-object-locale-hi-in",97620:"meeting-analytics-locale-id-id",97686:"calling-locale-az-latn-az",97704:"biometric-enrollment-locale-nb-no",97758:"extensibility-locale-hi-in",97778:"messaging-locale-pt-pt",97782:"meeting-options-locale-eu-es",97828:"main-locale-pt-pt",98068:"holographic-toolbar",98163:"components-screen-recorder78",98167:"meeting-analytics-locale-sk-sk",98170:"messaging-locale-cs-cz",98176:"hostUxStrings61",98217:"extensibility-locale-en-gb",98261:"meeting-analytics-locale-he-il",98278:"hostUxStrings72",98368:"meeting-analytics-app",98436:"meetingFlyout-locale-ka-ge",98498:"hostUxStrings69",98629:"breakoutRooms-locale-cy-gb",98654:"webinar-locale-el-gr",98696:"meeting-analytics-locale-bg-bg",98722:"data-resolvers-browser-core",98750:"cast-locale-vi-vn",98787:"cast-locale-lv-lv",98805:"calendar-locale-hu-hu",98842:"search-locale-cy-gb",98857:"recurrence-locale-cs-cz",98865:"extensibility-locale-pt-br",98872:"recurrence-locale-ka-ge",98889:"extensibility-locale-is-is",98972:"survey-locale-pt-br",98993:"semantic-object-locale-hu-hu",99030:"biometric-enrollment-locale-sq-al",99182:"extensibility-locale-lt-lt",99240:"hostUxStrings49",99290:"meeting-analytics-locale-en-gb",99306:"hostUxStrings60",99329:"school-locale-en-gb",99334:"extensibility-locale-cy-gb",99367:"data-resolvers-manage-tenant",99592:"calling-locale-hu-hu",99598:"biometric-enrollment-locale-he-il",99617:"teams-and-channels-locale-nb-no",99648:"search-locale-ca-es",99684:"calendar-fluent-surface",99710:"guardians-locale-lt-lt",99793:"components-screen-recorder20",99856:"apps-platform-data.mock",99927:"extensibility-locale-hr-hr",99928:"components-screen-recorder40",99951:"share-email-locale-ja-jp",99981:"meeting-room-console-locale-uk-ua"}[e]||e)+"-"+{57:"fbf0d8ed8b76b0e5",75:"79b981b704bcff39",106:"c162c9dc77d7023c",132:"d28a5c72b3b9b493",140:"befc7deba390c20d",145:"043318ae96b68363",211:"1bb3c80d3590677a",229:"fe17af6fd4ac72df",284:"4f075fc40bec43c3",385:"046844d2251d7ffe",397:"c82864774e75d04e",471:"dc49a322b1e890ea",488:"c15f8f4f6eda55f6",509:"ec5d31e712df8e8b",586:"a43de12aecead8b9",588:"7e4d3907af5da02b",598:"582f08e1db7ae049",629:"52b7c8b606e072b9",637:"408100d7e1d539dd",658:"d7265a550416c232",673:"b1b556733784619a",675:"11ea68fb776563b4",772:"9749583dfc8e8aa4",809:"6922d3007e3b7698",822:"e4df6cc6e5db274c",824:"8fca3fd5da64b77e",826:"7b4b947ce43f1ae3",906:"2a44be9916e7db8a",923:"df01425a5fee2ad2",926:"0316956a2dd16dda",987:"cf67b2b06e99cf07",1129:"68dd6f1ca4a36c0c",1172:"4ac372f54dd6f415",1199:"cbc47fd38e674147",1264:"00d0b6f2dc76d0d5",1400:"e5bbfa496c5872a0",1420:"067409c6ac0dd485",1440:"d523216a2517c4cc",1496:"7a7646f4bc49c452",1498:"cc430f9b4435525d",1555:"04b583e73e68f29f",1556:"64e6dac05f3e9d63",1573:"9be93fb74a7cf948",1612:"fbafd4acacb54d40",1659:"bec391a4ad46f21c",1741:"03341692d0a5a278",1876:"0a576d433c53c43e",1924:"d5b6c825e058ae88",1983:"227476e81f3fa55e",2016:"cff96a09902cfc01",2054:"aaafbd69f7e9c087",2060:"e57c3a880832fa18",2066:"1cfb5c0e9a7e6068",2078:"3bfd9fa64c1616a0",2090:"4a8f71ea0fc43840",2219:"5ba2bee301297d26",2239:"ccfdbc8be3860a13",2308:"f24558b6c26e8e89",2376:"24f91ec5f21d77ad",2404:"614fae3c22c188de",2488:"a77a851f1e46e35a",2525:"4719232aaecc29ce",2559:"9179d3c0ae872f5e",2600:"e434f0e321e9463d",2653:"6a441fa8b8d09b56",2701:"73bafc86c6610b23",2708:"09a31c146ddc7282",2764:"ff9222655d688948",2771:"88af3c295fbe5e69",2774:"e3cdbcdb37a21f5f",2845:"17c5ac283e0db11b",2849:"0778d52b6878e974",2883:"d24215eb92d0dbec",3034:"a50d39eec305fe72",3137:"946c0a9a102fc460",3184:"3bd8ad8933e5b0e9",3232:"909eba29bd4b0059",3275:"aa55e63b36dbf1d4",3301:"c745b09173cc7edc",3405:"2503460e1d41a305",3420:"b170b3e0b51abe74",3461:"4f8e96679672b438",3576:"e261aea189f6346a",3626:"a70ab09cbe3587ab",3683:"6885b3b74ee9bdf2",3698:"7a5350c22cb8c9de",3762:"8cc8f03d5104307b",3779:"77cb1caae7138edd",3806:"294c000c09215456",3813:"af62243872f0178d",3817:"15d13dbe92a3e890",3842:"62a2e9c31ab77f92",3846:"2878dfc4e1bf60ff",3893:"5f140e3a7042bccd",3940:"4284913d8d718efd",3966:"4352bd4d46ff0be8",3979:"d4da0bf8cb00f8f9",3983:"493dca6af2900dcf",3998:"559e5c177ff12718",4120:"0217f21401c70274",4128:"2d05ddaa1dac57ae",4177:"3eb6bbb1e6691397",4214:"5ec876ba6348fb11",4274:"e09cdfcb0a4b7f70",4288:"2422e7100a1ebf3b",4289:"f19f6afea9d3cdc7",4299:"3b392be83aee9dc0",4317:"32e7d4f11d15f4e0",4346:"f184660d5be156a5",4400:"849fb464736a2003",4411:"3ea14f6781b5ddb7",4537:"1bf42832a92a550e",4601:"c4d8ebdb4a9da463",4609:"9815c9f908007074",4615:"a192a9d5f6fe67b6",4655:"4f330191c40c3d0b",4685:"46bc0eebe6bd1e89",4818:"330db8e9f9566371",4822:"5ca9ef63dd992174",4867:"b33828b0a4b68efb",4904:"7630b904b9cdccfe",5049:"603fe8c0f19f2972",5053:"7fc9c84b0e0231ab",5058:"fcc3f6c0bfcd7ea9",5089:"1e5b148dc0a6bb92",5170:"0a65a714a23a2237",5188:"164232eaa484c7e1",5203:"0db3ae8fe89d3692",5250:"3cf2f5834118238a",5271:"0054afbef110dad4",5324:"589a47c2bb1e365c",5363:"d6a192bbf3b263ef",5400:"a61f9c94a1ec76de",5406:"1fa2503279be60aa",5421:"ff0d614f067e799e",5443:"2316f09e71ce85b0",5462:"773e60801686bed1",5514:"4084bf078bee87c8",5579:"60376a3a15021105",5589:"ae20c0e3379e5771",5599:"71758bad44a17644",5632:"3ccd59184aa21df5",5724:"b216fe59793f082d",5750:"9aa22659a72278d6",5754:"e4fa5d6b4721d0c1",5794:"936bb0fdbba165ef",5875:"f02c266ee6e2fd01",5954:"8641dc4a76f4d4d9",6020:"0895d9062841467e",6055:"9f7bca04e4f1b7c8",6063:"0411e40c116914ce",6091:"48cec31e15a5cf1b",6194:"af9273f6f57dea34",6222:"2280e286721dd5a5",6279:"840c42f6a1cadb30",6317:"d87eb1b3a9bad282",6333:"b2de32f187a13705",6336:"d852ede72af66581",6355:"d64f06dc3f4b88df",6366:"db71c43aa6b74f92",6373:"d683f73f8f56c19a",6389:"791544f482ac8d66",6396:"2dbde223fc864df1",6408:"f102d523bec1c2a2",6431:"4b109afdfbaee9d7",6457:"ba47c695f322f6ed",6472:"8662123ee01da816",6545:"9a1386d6885bc683",6552:"167f677417f628a8",6659:"1eca178056357812",6693:"f6851af691e12dac",6767:"cef58d9517c78a02",6768:"82bb05849a907bfc",6929:"6085bdb1d9d68f93",6942:"8c934cd737c505fc",6990:"d548a6cdd315e83d",6994:"582e29ba61009304",7001:"9df9ac656607ed47",7004:"818e849eaf825374",7015:"ecaf83a0283bcd4d",7022:"388414ee0631e8c1",7056:"b40341c33599b021",7169:"5601ce43c2fd6456",7178:"807de1b8710e6d2d",7205:"9e7f15c12ef8c930",7215:"2394505d271e0c00",7261:"a76994927d7a124a",7368:"ddc50cfea1d8d402",7523:"b257c3c01940e5a7",7536:"1d4a5494b4326359",7545:"766f1963fce2b3e1",7598:"a740a59fc942fbfd",7620:"cfe6af5cdb240bd2",7676:"43ae99ee90daca50",7684:"892641406c7dd4e1",7729:"e6bf9fb3c4c03a1c",7761:"1b0555af3c6080a0",7776:"9e33005d4bff7dcc",7783:"e2e0f84f3055c605",7850:"66ceee3d2813148e",7959:"973424dd87c06538",8049:"a6d42de94a8e753d",8093:"b17bf23726270e51",8108:"6c1915f82e2fc0f9",8111:"888fe4a96d8dcc0b",8118:"560f0e5738a57f5a",8124:"7870d5e7b4a052ca",8163:"288fb64f1ebb9c13",8174:"44b2f1ce269e2302",8275:"b49e0938ea93c719",8521:"4b731cf9d4e39fdf",8535:"793e3e0483fc91e9",8556:"41ade2a588a7e30d",8568:"88cacd7def995bbf",8609:"9dff62025177cdec",8631:"38e0798e4c30555c",8656:"3614a4fef962fa3d",8687:"c0668aa739c6330f",8725:"07fd8dfa5f637fac",8735:"8330f88db04609fb",8806:"2b3dc8fbd558ea74",8922:"e1a66c2e85c3124c",8954:"bf813ea840570ac4",9014:"dc7524707c330014",9082:"0a1787372627cfe9",9129:"1629de4fe37519a2",9252:"b7d9a098ea71a096",9293:"c8199e2d3d789b78",9355:"a480a6bebf335e09",9372:"40f2290baff976ba",9436:"54e6db0ece6ddd48",9469:"78f43dbbcd50aaa0",9495:"071abf63b86b225a",9505:"f93344bdaa8b0ac1",9545:"f41b4d1c7b4fd775",9675:"a4b1d759fc8f6955",9778:"90baeec3eabf8998",9940:"eb908c6001fc18dd",9981:"3052b549f2b2e67c",10056:"8811ad8904d9889d",10104:"f97be47d466d382a",10122:"3a27e75233f20b0e",10166:"66e84e1972c04dc1",10203:"17f6c4e92daca6b4",10284:"d184030f45d45ee4",10319:"ab07781200147886",10412:"540d7212e05cebb3",10501:"97cfafeb02c1502e",10523:"71d5cbe9f71095d1",10562:"44953f2d7002f6d9",10589:"811d9e114bfa6940",10649:"7070f7035d55da98",10652:"ade711a14bb8dee4",10683:"9297dffe88ae0672",10728:"7991d371979ec91a",10749:"5f7e02efd5699d1a",10784:"527927cfbc5d2079",10813:"65a5076d4032a5a3",10828:"3f4ac45788ea720e",10841:"666da4184d24e493",10880:"6d5ef1bc1353fd36",11125:"5c0a3c5049f2ca6d",11131:"d33b82018b9cfa8c",11136:"554bfd2a77b3cb7e",11157:"b51287d86630aafa",11265:"d5ed31025914a742",11290:"9989464678a027fe",11637:"ba8e65860075b016",11682:"080fb69ac9de658e",11746:"bdcb52972fc24983",11807:"2b2eeef102c0049b",11827:"9a1061cc8ea3ee4e",11846:"22e09ce890f55d49",11849:"510d6089bd64128b",11908:"40f8ff541f2b8059",11943:"e358f015aad9d2c8",11957:"6a0416dd74513dcd",11969:"9252d4bd37fa3aeb",12002:"34a6bff767f13cb4",12084:"f254880e5361bdba",12090:"1862444af78182ec",12190:"512b4c077d251e60",12243:"1a53859dccd903f1",12353:"d9c83d62ef0d1d90",12359:"6d6d4c229eac81d1",12486:"15dff575a98eb73a",12502:"26cf4ac7e1be7b71",12549:"cdef17a771f95599",12610:"0b5da3cc5728cc07",12657:"51eebc588b5f99bb",12671:"cb7e641fe97eabd4",12724:"4ae442b084901ae8",12767:"dbf020a5cd41fbcf",12776:"1eb70dea9fd4d6f4",12782:"d48ad630e46c68cf",12935:"8b298c934359efd6",13042:"c221b775ca6827be",13271:"1ca114771d99b526",13333:"a3fced2532eae4c5",13350:"62d3750b5c35eace",13353:"437782d31897287a",13354:"ed0474beac154f1a",13386:"85b964917e0da590",13392:"affcc8931411320a",13418:"9db783e73094c117",13428:"4566479029edb388",13478:"3469f818c4307a2b",13507:"e39007a0169732a3",13549:"ba7a4bd8d1d74841",13652:"623bf17de6bdaffa",13662:"4477e0bb9aa025a1",13666:"c9da9e6ae1e610f3",13680:"eee7558f189625bd",13692:"f5487a4c19ea9bc2",13737:"97fc80baf342ce53",13739:"1a1fb756b4294b6e",13749:"196b75bbe4a5555b",13750:"892f7236ace25ba1",13752:"de357f9d9b34bb30",13794:"5b093686475ba397",13838:"b722fe236542d162",13847:"a09de1bab80ad9dd",13872:"e6d95a2e9995288d",13907:"d74d410e4f2125aa",13968:"87ba3f735f95112f",14044:"718c5a852aa67ac9",14095:"04487eeb49a46cb4",14151:"e013dcc195b1856b",14166:"7c69d6026d0760d1",14268:"c0158916e1a1da68",14287:"861a35c82b8c77de",14309:"7119f4c5de5717a2",14368:"0d770650178b1ed3",14377:"af8111c3a49e473d",14381:"c1258bdea8cd3ad2",14408:"fd31c9d70e707b9f",14421:"33a073220b98dd82",14442:"b795e8afd74ff170",14464:"741da58e748eae67",14526:"355bf573ad72f5de",14533:"bdb2a7ce0cad52a2",14590:"d57c245c6765e4cc",14621:"640ba58451d6809b",14646:"b23670ed22e50f68",14682:"b4aa188b41057662",14712:"7d05684efea1f38a",14727:"fe7d3e97365dd3f1",14743:"8872933197351bf8",14776:"45fbc4634fec96f7",14787:"ef3ca280a17a6798",14797:"5da8cce4b28a4be5",14826:"33687719a9e87bd1",14834:"e3c32d1fcd1bb00c",14938:"5c28d5bee6fbab6e",15078:"579bbf26f1e1364f",15470:"ed136e8c84e2acdf",15522:"9b2fa7d537a39661",15523:"f9942a00e4e92cc7",15580:"a75b9350ca9a859b",15750:"8eecc71b0caa4349",15783:"7cf1515043cae54d",15793:"2c9509dff6f7ab30",15923:"a16fd13d8bd10e3e",15999:"a4e2d124b4df28ea",16014:"47f28571892a084c",16045:"4da0656abddf1532",16095:"eb695ff12842be1c",16147:"0f95df74ba889ca0",16151:"4f48b416d3626bda",16211:"eaa6a1ae81534cd0",16316:"23ae6ed7e819e1b7",16347:"ea4d56797325fd93",16366:"571aeb9c3c3b4b0a",16419:"b140fcc6d900be29",16478:"93a7371e456423ff",16487:"9ae3482527403268",16526:"2d92fa982951daa5",16622:"c1ed2e6e850bfc6b",16676:"78286d10cf007874",16702:"83aa42d967d81c14",16705:"6224cebebdaa1cd6",16746:"24678723e5ad9d5b",16804:"511d5293c61a9efb",16907:"5fcf6a9c5f157840",16918:"053a552c6b9a579a",16951:"93bf191d4fee492d",17002:"3390ba3a343a7f2e",17044:"443171589cc5e1df",17097:"031e2d43c0359654",17121:"bcb3d922235eb1b8",17124:"21c296f4bae4ffe2",17253:"3c23dec6109246c7",17262:"4cfe9a69ab3b0cfb",17263:"e5b7483582add79a",17270:"418ebcd69cb0d762",17285:"84e3339b2d078489",17293:"5cafe0c31b845cb9",17342:"6361aa1adeecb849",17400:"99fa62398e893259",17418:"3a7a6ef0a42dd4de",17428:"66c62862787a60b4",17475:"9179a0e954c4fd8b",17530:"29c1745b9ecc289a",17542:"5b54a8db6e00c53e",17589:"d9b469def8d914e5",17624:"32e9b6006a7ea3c0",17638:"a7b6207bb77ef15a",17652:"fdb0686757a58438",17662:"d43188c4b822374d",17695:"1ef640442de565f0",17726:"e6da3d7e48b2d490",17734:"b88d56ddb6554de9",17794:"10e966e465e895c1",17797:"4311269ccf558bbf",17848:"ebd364880c91f365",17870:"4d0bf58f49443a07",17902:"a2eb38a149492714",17965:"0a91dccd0cbfeb06",17968:"f65e97e2234d4863",17984:"d06d2ec817791654",18026:"d448f654ad67ed4f",18035:"04eed517d2396ac6",18129:"e395bbc5096db46d",18143:"9f92cce12d3c1b38",18223:"bdf594c8be0f78fa",18228:"9acef6f1eea9772c",18364:"260bb8b207952ab5",18418:"5968e8a526b776d1",18491:"2403dd9de62d155b",18500:"3fe478027923f088",18545:"765f459589065422",18639:"144a270ae2eaf3b6",18773:"b92df24c01910113",18846:"d08d4f19a696c9fb",18927:"aea842c9e584a692",19002:"9aa200c03edc4eaa",19050:"5eab475ac0471743",19078:"7c12f1685578fa34",19109:"e423f9989f7c7023",19135:"b0d8a272bcd866f6",19161:"eae38c3c8f6d8f8d",19237:"ed726a9288984298",19319:"1906a1e2b7562c7b",19330:"f15eceb5bd8e062b",19353:"fc578319cea2d643",19493:"c5423c36955443a2",19495:"6cf348624425b67f",19521:"c2a30b32c059ee0b",19534:"87dd74f6650e2883",19599:"36a993477ffe7fbd",19753:"45e779a4531d92e4",19778:"f12203a71e9b28c9",19856:"601a7ee876f577ff",19997:"1d638d45a0e45bbf",20029:"ab330189b006e16f",20047:"b8d58c085ed1849b",20058:"7ffe99ac4eebe774",20132:"89ba606292021133",20158:"61ce65ab9fbfee8d",20248:"5f5b1ef79c0da38a",20267:"8ef1d0d3c872ceac",20274:"ef6c1edf8603d8ac",20323:"1ddd23643e776404",20351:"6e55851fdadce60d",20397:"ed38096f94507bfb",20443:"e0319d7ed493e63b",20516:"054806f7b5e567bb",20538:"18248274d84bd3d9",20545:"0939742bc5090e90",20573:"89b7543f3881eb15",20668:"7176ad7ef8138907",20672:"9d7c604b4ae4f787",20718:"3f65d857f612f37d",20741:"0f5436f5e420c4d9",20765:"1de5743dea404e00",20904:"38a114769b846bfc",20948:"23b94d7b92e7772c",20957:"eff003a1aadba214",21033:"a533a9e0e7738354",21083:"72af3e47d742c552",21112:"89c36c0d834250e2",21167:"67d7cac3cc622c31",21174:"7cd49f043a22871c",21264:"05017b1fb7e972d6",21311:"7ae5407332969219",21346:"1d2cee5464f6a5a8",21372:"cf1b612093d0ae8b",21439:"4ee89b24964d8553",21514:"66b0afa4748bf287",21529:"f0afeb830c4484bf",21533:"bef2a8630fd27ad2",21632:"580032824acc7abf",21689:"261100374a83f036",21705:"f64f2979f832d46f",21706:"75cd80202108e66d",21767:"96779e6f971f7076",21777:"a0fadc283f0379eb",21786:"e254e36705f5495f",21795:"2d1de9acd3d7a6c6",21822:"951a36308c6c9daa",21833:"640201d3783e09f4",21838:"f2abbc49b0fc12f9",21933:"e398ff6f814af7ed",21978:"65246ec799fe4973",21993:"58f0afd916f9c913",21996:"d5e042d27750cb58",22012:"00f8dec2269bdc46",22042:"ef46815f0aa9d140",22064:"844b6eb79d3e3c3e",22121:"29070e2bbd58bf7a",22125:"b9eb7058bac94962",22184:"dd199838dbd09db8",22312:"6157c26b4fa5f96f",22391:"9b110b015fb1e944",22413:"79631d9076890cdb",22423:"cb203f7dbd42a66e",22479:"b587a08d097b1a29",22540:"73d2a7ecf86dc5e1",22555:"118ebdfe5d75b6a7",22581:"fdfe435dd229d574",22616:"a104784f75164bf0",22628:"eae87b6556f3d944",22750:"d7022a61e17ddae8",22765:"12c6cc064ac46a4d",22799:"ba1e78d05a6a9a29",22803:"eaa683c5f87947b7",22842:"90e15bab26fdea81",22928:"619ce34cfce212db",22999:"b89d25b403c4adad",23020:"84a3524b5134258c",23025:"48e74efb07f40a24",23035:"c9537f8c9dc1737a",23046:"112faf158c4715b7",23065:"6a22e3baf5ca344b",23088:"1b5652cc4aa1bc81",23091:"78060d0f4901b9d4",23169:"3a01161b0104197b",23172:"8a461af6e5a15933",23190:"098136d3b977c4ce",23246:"aae9ab19efc222fc",23280:"ca6c75b02be650a1",23363:"8940086d0d352a69",23400:"df43b1ffbc917854",23402:"a421483298e694b3",23493:"865e1371c8fdc827",23516:"0646030a342683ff",23540:"d85da9fc5fce3eb0",23741:"eb5a3d49a54a5775",23762:"77de6cda4e179241",23794:"a30c73e00c30350f",23850:"6a64e3f2b7ff6a50",23862:"91b7151799e90de3",23890:"081bb34cabdd0f7e",23891:"1c8b16c351330d12",23893:"e4779b8c5ee2f57f",23924:"03ca0c6f3ef4ec0b",23954:"bf37aacc292a7ff7",23968:"111484a049b635e9",24013:"149fe534b8615ed2",24073:"0300b7a12d8b0453",24092:"aca3bfcea9265bb3",24149:"a63cecf60f19f411",24179:"38b825016709e9e7",24197:"c76c119ebcbb33bc",24257:"2bced6fb39f22d6d",24278:"efa96dcddaf1f23c",24417:"e69ecbd8e1ada5ba",24444:"9a04e34619eede90",24526:"d2a54f323a0f16b0",24541:"345d728b7f2415b8",24632:"c2780f59392596d3",24657:"febd601fc503d741",24665:"5bfbe4ee8df83689",24677:"92a77aa9cf8254cf",24840:"5bab8fded10deb56",24860:"c72c5d604e4fd758",24925:"fb80d74e7dc52d65",24937:"200a434bb1afb1bb",24944:"c11dd4453147cc51",25026:"08be8e67f9f5666d",25067:"d54d5a6c1405f085",25110:"93fe53a0e819665d",25270:"d53337529683bdb4",25312:"5edaff9a72ba6d93",25343:"090275df9fdd23d6",25442:"1d6dc222fa53f236",25447:"a26be9f9fabc5a63",25471:"c32b7e598845de76",25509:"e03c790581263bf1",25532:"6612df8702733124",25570:"9adfdd3be9a7b2b1",25604:"1dc2bec85b83ea47",25622:"fe74875947b0e839",25841:"382b8d4f934465a3",26025:"625cbc2810a3926b",26113:"26f1bd25d51df484",26124:"42766780914c4196",26179:"6b06925a016eee71",26205:"501cd8ada61eb4b2",26263:"d788eac99007a8ce",26332:"aa82fb92b0750f3d",26340:"8978aba4dc7b5037",26447:"0ad82609c2351b31",26510:"8ba02ac8d9cd83fa",26589:"b890e77aa4325a44",26759:"e05a5b98e2684191",26816:"6bcb2f23aa5e82f1",26819:"d6d62c79b5f08663",26822:"77591839a4f3213a",26828:"0fa88b9387603821",26842:"63fbdc914be972bd",26858:"37e46c08c5e41153",26916:"da1a3fa9255a78a5",26958:"47c47cff34684ee7",27006:"a4546409217ce653",27030:"d60a29889d458ebb",27112:"ddc844ec6bab4c43",27133:"2dabd03a8234c6d1",27172:"491a75ed6ebcd49a",27199:"5d89b0b57f8cfef5",27214:"2298c80b0d790b89",27217:"cdd78002186f7af4",27269:"6ff96252fa915938",27386:"5b76efcc2bcc0f85",27437:"81440fc39af0b785",27455:"11ec0ba395a0205d",27490:"76d23baa12769cdf",27521:"8753e3bd407a3777",27573:"e700ba4b47d7058b",27639:"1eeeea0471fd6444",27648:"c8bde1f5f600f76c",27662:"a7b9a81e54a69405",27910:"2380b0e8b889a6e9",27954:"c8f1b0a65c51454d",28087:"6bdb4dcac4b9a6be",28135:"ad6a8c49e2d6498e",28205:"24324f7b6136bdbc",28224:"10265e52a00719bd",28254:"59f5853568e4ccab",28256:"6ad5854d4709e551",28395:"5cf9155680e7e058",28400:"d7ce73ace2cacc7a",28420:"9a6e5ab423916d65",28437:"5c101e7cd6938b25",28488:"6d857c47f1821275",28489:"01f84c6bb3af3ab8",28497:"2dbe0f00ea909aba",28508:"b82e7955b59872c3",28560:"fbd36a531e3078a5",28664:"68499dec8afa0f80",28716:"72c853317f97fb3e",28729:"2db4e874d1b85f0a",28859:"192b780a67e2d3a6",28862:"8442079e12523a99",29046:"e419fc4d00de0369",29084:"0f1bea2aa4ef9568",29122:"7ea6a991b13bc5ee",29138:"aebffba2f8e4bb40",29290:"103770a632786eb8",29401:"a5210ee90a8940a6",29475:"eae26d077ae9e5f1",29477:"be23325a31be57bc",29497:"a2756a4d40eeb8ac",29533:"488b4ac1fe57e702",29559:"aef3aa9e6bfd1e02",29569:"1fb0670d2d66534a",29600:"0d3af59551301817",29709:"240b12480dafbbfe",29731:"d96a3a3b70518489",29741:"0acd7a770cb46baf",29782:"ba96c3b86d778eb0",29813:"14fa1cbfc7d2d75e",29837:"421e5df0ad6dda82",29861:"a19f2a1c4cf39a56",29862:"25879080e58ca83b",29875:"f59fca03722b4850",29916:"df3275f8f74f6e32",29922:"89d7fbe0980640d3",29959:"c80a639a3e374591",30018:"24068476c9dd0a99",30038:"e52916f53b3b3ffd",30040:"f41cef5c457d05fa",30078:"29cb4fafcb15779b",30087:"59aa4142ccd6b996",30185:"6626fd2948c7cd60",30191:"49706430831b0043",30235:"504a8ef2281b587f",30236:"6518305392649557",30242:"a378afbc657705b5",30288:"17b1265b74c936cd",30291:"fa3b9a50ce5f2193",30318:"754476661d6854c4",30588:"1cc5d0d5166de1bb",30590:"22abcc2e55ca136a",30637:"e2b7254b733a3272",30644:"c6cae18cde1f2297",30702:"415b47c98d35b5ad",30748:"b0f3db8ac3124a09",30783:"9178ee0f0ef1a4e2",30828:"0776d558102f2248",30864:"faebc36dbe83ea80",30922:"1d8dde908f178b10",30970:"39d285d2c2ce1ae5",31020:"b0e8019b066d4aae",31063:"dc0ef176c5c305ce",31167:"bbe8b4e9ca3f6d33",31192:"dc7664acfe6a0194",31286:"57fc4ada3deccca8",31354:"7fc7d5cd63207a81",31374:"424f213f1ee530f6",31402:"12b3888a0ce590de",31506:"39c2c17a2288788d",31513:"e5ddba7a7eae5859",31597:"472f0b9ad7754f64",31611:"778e4187f539b6a1",31624:"97a733891bf89050",31742:"7f9575569d7fdf8e",31811:"3e2906b147116ecf",31908:"f761f1632c962e8e",31963:"4f3344d4d23114eb",31986:"91a9b6c0733ae236",32034:"b8bf4242ad1758eb",32057:"fe55630cd6787fea",32071:"7bf3bc9519c692f7",32076:"e6f16359952bdda2",32085:"d8d94f3b19be4a30",32106:"f91444e0dbd02b4b",32334:"eff1a77750b1359a",32426:"dccf83bc8e6c1c29",32504:"f93a5d56fe29414a",32528:"5d085af1d6fa0cc1",32529:"3eeb71123b19c4cd",32606:"7d064807580c320e",32719:"5add4f07b5443d9a",32897:"51e1dc923db29e23",33075:"7037fb59d870f6a5",33097:"ed22fab48225ccb3",33105:"346c50e8d632757f",33199:"880ee2458ab2cca3",33272:"4701dc3ac5a9b3bf",33346:"6b61affacaf1a03a",33371:"7a01406494768ebe",33454:"22a6e35447b4fa68",33485:"4e7717e6262786a8",33488:"a1f2ae97075831bb",33580:"07a80b9e5f942995",33586:"f1d8f25ccde387b0",33587:"77afe572267b453f",33603:"aef394ace636ec0d",33611:"50bc55a8f908851b",33637:"2e7d4c65c50b399b",33642:"b8fe3d378a59db6e",33665:"91c11f5055ca7552",33738:"75923f8c57133728",33772:"7d61d40e2ddb105f",33884:"c339bbbc96f55fbb",33885:"5418c6d1c96bc633",33913:"bd7dabf07e28196f",33925:"5d66be10dbc85fde",33937:"61f792a36e38db91",33981:"ce3cddbd8f12d1ec",34027:"6eaf7ca7f5f8c4e7",34055:"c25d3a72f86c550d",34179:"4f9897a28d49fa51",34250:"257e165b0138c6ee",34255:"84e4b77c19c4af0d",34257:"fd88ec4e9099cde4",34279:"d2264cff3552ff17",34287:"9f667600e1eb9b7e",34322:"f72723e95303f04c",34349:"4d497815845f7915",34379:"961e21ae627b284b",34425:"c9c35e30f235f29c",34496:"120a01eb3964b654",34526:"5ed1f554c2310acb",34536:"67165a0a5ee5c59e",34548:"1ae195bb214a4c44",34602:"3a00eb48e2498a63",34652:"761931e697fc6566",34653:"2a610a6dff052d79",34692:"c1f96c504d9aaf96",34869:"294813314b0fabb2",34882:"ffb9ae4196480ab0",34884:"af484ce3348c04e6",35004:"7b58d7bb726f1c61",35020:"76601fcc713aad7d",35106:"530ab956674982b7",35110:"d347367d1b7c7c84",35185:"3c34599d53464061",35241:"52311ee086d9269e",35270:"8e395d5b142fa340",35359:"b2430d4b15d60de9",35392:"ba81280211777bcd",35409:"bcbbe1a2ba7d1d7f",35413:"5dd6a66c0dfa476a",35551:"8ac1c723b5642746",35568:"52d7d74e3e5474eb",35577:"673bfc555a597b62",35588:"faf1066f4331e635",35626:"ecbc60a5dd65bc86",35731:"20f4b77f05b493da",35794:"73a64c2c1be9dcac",35821:"e6134a5cd2218d34",35833:"46e83ef9d5d7e349",35874:"0c3d82896dd861ba",35910:"3ec989d60314b64f",35921:"aaaa3cf9ff4e6aa6",35922:"d02656b1b2947968",35940:"3c283e69354f7a5d",36009:"889f43e3f17e5b5a",36142:"4787f377ca099ce7",36153:"3ce3afa8df9e89a0",36227:"538af2a979a2e145",36279:"74206c003eaf93a6",36333:"0ce8d423d6fe7727",36378:"2f5226163edf83d1",36397:"dd6f95eb9d2692a8",36406:"447b282c3678c338",36537:"94ce0561d36f87c9",36552:"fefaa6b725fb6dc7",36688:"8c3b50a48d8c6b23",36720:"c4bde4704e40acbb",36783:"5f7a6ba524547055",36794:"29c0463362a8a83e",36821:"eb2f9912143cc975",36856:"a0686d20cb102100",36919:"b316ab563f9ed829",37025:"c430c43e550b16d0",37131:"1f6aa676d4ee828d",37209:"6a7bffa791851300",37232:"3f6bde12814c5df5",37249:"719918d94cf08273",37301:"3527d17a845bdcda",37364:"eea8ec9a8110d2e0",37378:"417052e4368460fd",37390:"5215fda67ee418ef",37406:"c093f85753820b2f",37437:"7610ac1358570f94",37446:"622bc14dce89b229",37458:"396142d559c1925f",37472:"3aa1bace44047b36",37481:"1536cc02027dc220",37498:"f9e710d852b47036",37514:"32775d71f1e9e721",37589:"6d8af5f1854161c1",37673:"7d7209c51519da49",37689:"07c238addff5d367",37754:"3dd9a420195d47d3",37762:"80e89163e11cc357",37811:"47db9c3851b73aee",37814:"75a545739ce6f357",37965:"a3cf93d5f7e10e53",38008:"75d8f5475fa2f165",38021:"dbc81c6f45b811b5",38123:"2d711731d862f0be",38195:"617dc62b6a410d1f",38221:"5e28bf4a8722d157",38261:"b4613a5ee1b2bb8a",38294:"2a819eb8d13eed03",38355:"6ae1eac983331cb5",38431:"9d5e69aad2be3d08",38437:"6b538881560b067a",38457:"fb47b12554be8a93",38461:"23d70cae7f685468",38552:"d62737057c887003",38564:"bbeb6b80d5e77b5a",38574:"7fa4ad551b0563d0",38652:"ab8944edebbf94bd",38653:"f7c7f5aacf4df9eb",38685:"0d2d789685f8ea0d",38693:"b91312f14ed4eeba",38699:"5e17b643bb3da312",38756:"6324b116abbdd51b",38783:"6122f5ba6c4a4b32",38806:"0e42d9aee57555a9",38811:"c1158e827e6ad729",38885:"b52baa5fed2fb50e",39036:"b7760f2fc186cb19",39079:"26c7495862960516",39090:"4bebea0e0e1b7a02",39117:"0e4012ed7d555ef4",39307:"95953ac74057e140",39308:"65044d0d1575e755",39370:"f1337fc84da4a06b",39387:"ba42253918ef5738",39396:"0d433d2c2c75d837",39412:"e1a15df698d19b08",39435:"752e354f4abbc6a3",39845:"de7ff7f2793d1d3a",39886:"cf9ab67b85058759",39888:"68c045b7f2ec8b46",39974:"a5dadd6fbff4ca37",40042:"d9442a6ef2983c8d",40060:"ed71906ca753c922",40114:"fbadc3895c85c57c",40125:"3ee6a84ee5871701",40150:"64462d6ae379cfc4",40221:"31e0f067950c6aa8",40238:"0c90d4d72a3db60b",40369:"9cc7d2945c0a896c",40370:"4b6a744dc62c28c9",40416:"64701c8ee6fcd87b",40433:"210ff8d51683f394",40553:"cae0db753ca86574",40583:"0720dadb6a932de2",40824:"900be84da8c744c3",40826:"ef22b0a39316f681",40866:"4f64dd7be88a8ee9",40868:"64e1f6dedaec289d",40879:"37c8e23b632d06bb",41007:"a06848b0fcc659dd",41064:"6038952c04ef4dee",41071:"6a84a39f573d083b",41127:"0a914fb3770b1bef",41143:"c299a6c6380a0598",41188:"f4e154a2eb7f6c47",41272:"1c7f39ae06b555ef",41292:"076ffb601afae696",41309:"500226f30283df3d",41445:"c8fe1225f3dd59a7",41491:"e495e493bfd23e7f",41557:"5f6d7a286dcac4a9",41574:"a0ec58384eb056b7",41627:"bc5a9a695fd8e3bf",41720:"f44b7b488a6ad12c",41795:"c71216cc87edc43d",41809:"6d75b4670a8d2f70",41897:"9dd24196e7cde591",42044:"2d9cf0a6df21aaa7",42065:"21725844bdcf5bed",42119:"ed8314949e4d43e4",42120:"5a87355866e89464",42143:"7010cb4eba79f6ac",42182:"e79acfa843d1cb8f",42239:"9b6fbb201d8dfd30",42282:"87b0c50c2cf40550",42337:"9d53dad44ec05826",42371:"662ab3dbb6a14e55",42461:"b418bdbcc2ab075e",42469:"3fcd14a94cf94c5b",42516:"bd5ee6b904a850c9",42549:"ec25c0fa537e101e",42558:"0c9d3442d55bd277",42575:"d7bc9821820b3659",42699:"d680c5f7571e1f26",42742:"572b98e0da9233b7",42917:"7d7f85cd59f5371a",42944:"f0e45ee848aeda78",42985:"eeb08c3e8825c268",43115:"1bb418c124c77a3e",43212:"6d4689f9a57d1327",43213:"541b1cf85c911809",43364:"e41ac544c2069c46",43458:"95c88293a67913b2",43469:"24c408ffe563b333",43505:"8c7fe8135f5580ab",43532:"2e8dc3091cdaffb6",43589:"3a0add72cc2e94a7",43612:"1b1c20c903e03b58",43642:"6175086b18fac859",43665:"0797757dcb888d15",43795:"2c18d3ac3786bf8d",43890:"23c010884881a20f",44047:"add453284c9c14bc",44126:"08ed1d7985a4b536",44145:"6efa568762fe57e4",44225:"398de84674f189c8",44264:"60d9b87e4a513ae4",44284:"c6c0f2f6a77cf41d",44357:"f55f2e6a6badd669",44386:"d7be84a27c5c615a",44462:"a84c1a36c8d818c8",44465:"18af44d061d62035",44470:"2b3b27a9b5c16e41",44565:"8b39c9acfd0b6022",44570:"a31e2b5e7c176bfd",44585:"f616cae6284881de",44586:"1d1033f8cf0d9509",44667:"377347f8b422a8d1",44696:"561232aebb56ee5e",44699:"e7db498d91ceeef2",44731:"14a2f2c3aec55431",44778:"dbed39d343b98d70",44949:"d741d56a13be8180",44975:"f273068fc75c54f8",45005:"a00bf6bc89acfdd2",45029:"d731d3da078be955",45138:"63d0632d0e66369f",45153:"a59565de1638f2be",45170:"19c964045619ac56",45196:"3e64fe0f73a73d03",45270:"66e24766737c266a",45285:"3568ebaac0100fa5",45321:"9848577d704807fe",45328:"6308ecb995e353b9",45560:"f871a6572f296849",45626:"79359dfb25f42818",45702:"0b4c54e306af60ba",45730:"4b7e6be723919e42",45742:"42557550c575899c",45801:"d9d5b2ee8e1721f1",45814:"a9dbada9a01d52a9",45871:"5b530fa454deed6c",45877:"53d30244d167398b",45882:"83e3a8a28f57db04",45885:"836ec1e4be7c7127",45898:"cbaff28fa7738a68",45915:"7612c50ee1ed8b97",45924:"cccaab33fbdac675",45930:"697f6251b1e52080",45933:"2f5eaf50cab2c08e",45965:"3d06550d16cacb00",45999:"5496624aaadc5225",46119:"ceddda6ae36c076c",46149:"5d88ca09d82e4b82",46232:"287d54f1e8fb43ad",46310:"bae34e66e5834609",46402:"45f1e28dfc688038",46433:"99b22b2c1524e30b",46462:"5666219ca3542b2f",46477:"7583646bd4e043ea",46563:"1fdb7112d9caeb54",46584:"28ef7321ba8d62e3",46657:"e82e22d7e03d613b",46697:"69f32932c518d0df",46710:"26abe201de78e291",46713:"f605bc65d605c975",46739:"25602be568194ae6",46789:"0d631f27a00fc54f",46804:"86dfd49474408838",46848:"2919f7afadb00d5a",46873:"fc4a5ce04f1a1ffc",46978:"5ba7c556b0579d6a",46981:"4698b0245b84dcf6",47140:"af8f2655d55fd313",47282:"4f5c47b35be56858",47331:"a8a366a862b4d7ab",47339:"496427f27d8234ce",47468:"5f7d8dc14401e87a",47511:"7aed41ff76f148ce",47573:"bc9046c19cab3ecc",47579:"6ffd132199c1ce63",47639:"f1ee28315902508d",47663:"513178a5945bf82a",47806:"696fc217f753d1aa",47838:"56f93654657c418b",47933:"a01fbc5fce25456a",48098:"08e04f6a7804c4c8",48113:"975887bfb2579af8",48129:"212f1b41cdd9ddd9",48195:"5305aaeb6d9d9d14",48226:"486d1a54341bf68a",48370:"8860a2c282a5de7a",48451:"511f4e61dca4cf31",48550:"9390174e54bd6b5a",48557:"baf1242483dd9749",48683:"7ecb567dd219cba4",48693:"b8f6f7901c654623",48715:"1d1db301084e259e",48735:"0c96b105a70f0c81",48840:"1efc0bbc796f3fba",48923:"226dff281945a2b8",48943:"8fbc2982d66f8f4f",49073:"78bd5c992fafc841",49087:"4fead036a8eba8bc",49120:"3ec9693a49596363",49241:"a33419439ecaba5d",49333:"ac0a914055dcc1fe",49590:"09983fd1cb27919f",49663:"678dec2eb65ea2b1",49721:"6eda49488afaf94d",49736:"c422b3b3c5aa7b15",49752:"772032614876a4b3",49784:"7c83ba894864e1db",49808:"5a1bebc09d7060ef",49810:"7a6bc455965855d6",50104:"6e1edc3904ea5952",50138:"9a888931366cdb6b",50215:"2ccb0fd0729c72cc",50284:"c6e112804e087518",50293:"3492043f2bdfa7c1",50391:"c489966e976af052",50439:"b7946aad81cb1e99",50480:"10492665813924b6",50636:"a259ff81caccd38b",50718:"1aafa6b5b3449fab",50747:"b08d820223e5c7d9",50899:"ff436fe9db95d71f",50906:"be95a82cc8560a97",50936:"f46bfadc76f1b8f7",50946:"bc7e243083244e9b",50970:"1c36f4647d06d75a",51032:"da229ec50719b153",51106:"f829b1fd98d0366c",51217:"c06c68324e9105fa",51292:"c3ac91ca242ba0d4",51295:"3f91bead5f671aae",51305:"5c30f0fecabdc9a6",51309:"268a4181dbba5a7f",51317:"f32088f71fa689f1",51359:"1ea9bf327cbed719",51397:"c525ea391fa37352",51425:"f52fe3c69c6e0106",51427:"4905cafe5d433271",51554:"229f03aef30b1eca",51570:"380dd16df32be5e2",51661:"7d1b52398f049e09",51704:"c840583e5840a624",51792:"255ab83d89253eb7",51822:"fe7777483682e408",51928:"28e8e2b4502af2e0",51949:"bd20dfc6b672adea",51963:"d013be2f4920f93b",52287:"4fa08669e21fd7aa",52324:"23d1e7ed88688993",52344:"63c92abf0f4b6d63",52354:"f27755b931cb30f3",52433:"584b8d1373aaa506",52443:"7371c2a26cae1c5c",52534:"d7b06b2ca68366b9",52683:"f4b2f08a86746152",52708:"bbe86423148af9b0",52713:"6880891af06500cc",52761:"b656e89e0c885171",52781:"818885a289a9d034",52849:"dc7be4a1a5519609",52876:"6d4db42819467202",52944:"84a34e177d948975",52995:"868ca37b75c85a27",53046:"a631e9aa940a975b",53069:"0d2a3e2a021b71b8",53154:"245971f2835f1638",53228:"3bc0a33114103a11",53247:"c9650454ff3944dd",53267:"328600945e7ad070",53277:"c59ed4315e7dd0a8",53326:"166585032f4e7d8f",53460:"5c7600604bf2cfd7",53613:"00ac077bb5a4157d",53615:"903d9f4c4a57b43d",53621:"ae6981b20cc200ff",53637:"68adf5822c402f2d",53715:"79e22901d814e3db",53892:"8b9dafa0d5e5ea15",53909:"77299fa22db93071",53993:"562af38bd461af3c",54009:"0571fdf58ab25c53",54067:"9aa1c5f84b648242",54068:"f1b34915ec3a49c6",54069:"21fa03c25ff5bb47",54122:"924b64cea5a7621e",54125:"00ff5311e3f4d878",54165:"a9e30a2e0386d1dd",54167:"5eec0ef70167ede9",54177:"80b73f2fba491080",54180:"0fe9b209e93f3723",54198:"d259c68ab2db4212",54223:"14177e944c2ab0a8",54270:"5f78d67ada0879f4",54347:"dff0550abe9d1e97",54423:"95f955b91e0fc3bd",54447:"e3e98c3a6da9da33",54510:"915278b26d3659f8",54515:"d3141b1d0886357e",54541:"95e714865d1d187e",54569:"f3deaf4b810a9f3a",54573:"575f5adad97a69e7",54578:"98aba0461412a2b7",54594:"503ce3ebc8653c76",54668:"56b919c0b790231e",54692:"fd19cdeefd7e8fe0",54761:"4f078048e7dc4e81",54788:"e426b90989c616c9",54794:"948370c9959ab16d",54937:"057bd21518d8e03f",54980:"db6ebc3ea0fd53dd",55046:"208547968d855574",55143:"d6b5cfd35538649a",55192:"5fd12ca324e428ab",55200:"1d6711be627d91a3",55204:"100593a728ad3ab0",55206:"dee342a700131f5a",55221:"85be6bdfe994920c",55228:"c346dc2be45d2b4c",55279:"c5be35076b67b04d",55320:"047008e9d55fe0d1",55340:"6a5ec91b5026c26e",55393:"6c98d2e52d1c7a81",55531:"07aebe6fb12b0580",55550:"37a5bb3a62ea41aa",55625:"a9b713221ca56e43",55627:"50bbad149a0eaf56",55837:"676f0cff1e335481",55919:"434a73881bc7a7f8",56010:"c29ec79a6bd7db6c",56149:"b6a6b0c577b0f68c",56242:"24d55f643b020372",56244:"e4f6a1df6ac04c62",56255:"b58f7a2067c0d1dc",56275:"3d57362cc7f82b5c",56312:"b8b7a8106fd61751",56477:"3a036c6eb50b962e",56481:"7ae26bfbd01eb198",56633:"01476c5a5e1cf743",56641:"7c8e7f10b4cc9196",56652:"ab443e795d8cb767",56679:"b0cebb8e42a66c27",56712:"23a1c233d542be20",56722:"224df172da1ddd5c",56737:"80128d2e31b1ee67",56738:"9f57a019c2b18cbc",56774:"342076690cf8aa92",56795:"d2670a196472935e",56864:"32b8c8ce77d6c195",56874:"d0114e9840e274e2",56904:"d4ac617c2dc81e96",57002:"2648f4a195284260",57048:"650380e2c6071621",57052:"b881925a580f6447",57069:"e888d5c9ef399877",57164:"e4879f8bb05a9473",57405:"4bbde990cea6bac6",57426:"f7d51e72e326f0ab",57441:"ed9e0c0ecdac841e",57449:"f6da57cd693db7e7",57510:"a8f81ce99d82426c",57545:"20301119b4142b86",57561:"c65dcdd11bff7c8d",57610:"f5c55eef715d5b45",57699:"d5bc9c230160ef39",57711:"baaf72709d661bae",57721:"67d720a1d5c4a013",57760:"e5cad6ddc5cc6457",57900:"84b66bd641817b8c",57944:"5f8370d18b81a1b2",57969:"72024110c62bd35d",58035:"b42674cdb50b5906",58254:"46de7622db4cc5b9",58259:"a99178218a88baea",58276:"cc653384d64dd37f",58359:"1d84dea8a2b3d67c",58392:"1da9f35a359e9ae9",58444:"987c636aad272e3e",58485:"34abdf3288d4683e",58486:"af02f8abc36156d5",58557:"1a5c74f7cf3d7268",58622:"9ab766e23b0d631d",58670:"f6242ea799bd3f5b",58686:"c36e92eee2b4ebc0",58758:"10572f64752ee645",58814:"d0fa77ad4a4631bf",59048:"c38f1815f3654a8f",59067:"d2f1859432a07331",59098:"1952ddf2f1dda61c",59151:"6214409802643ae2",59166:"70f2d3b4caad722e",59206:"e5415ff8b1dd7264",59258:"cb90c44e686591f2",59360:"2330d8cdfb4982df",59401:"94f7ca5dda99a5ad",59411:"ac82614837ba8f8e",59518:"cc655da879e84899",59567:"104a2833a4af4f29",59616:"50435e43ad8c0580",59663:"8b3abe0d8a8a7c6b",59746:"977067f58350f5fd",59752:"8ba5925db24b72ef",59753:"34cfa3ab5d4a4168",59818:"58d1bd7c0c409dba",59831:"0b9e0cbe6f24fdcb",59860:"1d97ef15d66fb6b6",59923:"7bff94112e81c686",59930:"63499ff8c53a1981",59982:"da65707fa1877924",60005:"38d47ffcbe845516",60060:"fd2dc5d866ccd4b5",60100:"f00e749fdfd5eb90",60111:"3664df2ca55a2501",60115:"bc0a03e910848fb3",60123:"19bc06148481b061",60273:"6d47148324ef82f5",60325:"c61e53746ac0b798",60347:"412b6869659397a5",60532:"77d2444c9b5a54fb",60625:"051153d78d224af7",60639:"79694d069f91d0b1",60684:"5f6831f1db1589d2",60695:"488217f3123e0fff",60698:"3f5996bfdd488452",60713:"2d9aa30646aae3e6",60767:"cfd9c4102e2ef34e",60785:"f6f53a46bc7b9d1d",60941:"e6cbc50f8412b6a3",60979:"c5e04386c9bec464",60988:"2b3a2ca0602ea3ee",61033:"91720f7f1471c92f",61038:"5506bf0c7f9ddefe",61051:"bf625311b90b384a",61074:"d85d0bf94849b1dc",61090:"1cd79f5124b506fa",61145:"50651bd8b2616d43",61176:"1b427bc7956f238c",61183:"0fd8082cd0be7075",61235:"9f54e8bc23638e19",61286:"2f53a464c193989e",61320:"45bc4d0cc653cc58",61330:"a79d1a52fcc7a536",61331:"6ab95cbf35080f94",61385:"c4ec431c3a262461",61386:"59cd540d8fe3d65a",61518:"2931ccd2ab0378af",61537:"aa4fb7d211ff0f13",61539:"1acec286dd9effa4",61543:"f49cdea92ddecaf8",61627:"80afe317799f1dac",61803:"5112e8fc84ef1f8f",61874:"252de229c42371b7",61880:"784097f73b7e4538",61922:"382c242253341968",62030:"53e8e0f3ff1a10b9",62036:"9c3dc152bd295f75",62050:"e36cdd824c82949a",62058:"c9ea081dc33b2760",62139:"78f038d3fb22a2c1",62151:"0a0a6d938b5ebf21",62198:"b84b177cefbdbb31",62245:"97fe060491227602",62294:"d99403f695ebdb59",62351:"1adb0355538edf8e",62376:"80b6f429d2538eb7",62382:"ed220ef0a36d3306",62437:"2c0f97ac8da0577e",62457:"e0823796852b9b39",62472:"867901bf206cf943",62531:"bdbf7b3160abd28b",62556:"d932802e67985d36",62580:"88f78de4cadd88d7",62665:"064885542a726a7f",62716:"f2a6fc0249287585",62763:"fe0b0592baa5b2c4",62781:"7600ceb55331369d",62790:"25040b0d93e54d3e",62985:"c539a0ed819d7d8f",62990:"b40ac63932b0358f",63017:"dc9894af29157ceb",63054:"b64c91e1a80c753f",63184:"5bd33d9ebe0d2725",63185:"c83ad259a4c6d56c",63233:"b5e249c2f441355b",63235:"8883b789ead6dda0",63237:"43a708b86bac169f",63366:"28d83366f5b0cc30",63402:"d1affa7d871ddde4",63408:"533965967a706cdb",63506:"104c530d216c887e",63558:"d0da7d89f9c7d285",63616:"5f5bbe8dcf4c9006",63685:"1c815fd3a35aa94f",63686:"6fb6b69ee6e527a4",63732:"08c4d2649d3a2c99",63823:"65d9cf357636e701",63825:"fd939d3332e7a7e6",63871:"febb740a5dfe2059",63903:"22c16577ef6e1924",63936:"e25a752d1fb8afe2",63957:"e197e230abfb413f",63986:"945ca8855aab7a08",64009:"2881f106b09ad0fb",64010:"c879c2059b819d6c",64055:"56dd41f22923d9af",64078:"766af478c942481c",64108:"0036197ddad0c2f2",64110:"ff97cc9155d62db7",64270:"d8f243d0fc8909d8",64279:"e9743dc43dde3081",64330:"83d8fe36777bc461",64403:"f2c79885a4bfb2a7",64422:"176d36c2635d0f52",64423:"531d21e02513ac24",64430:"41b75c7216d53b5c",64574:"3d695c38750d378a",64618:"22af9ef50a5b9355",64749:"3779200aa63c4cd9",64754:"fceb57780fffef44",64876:"8bdd233c72d542f8",64878:"27c5eccc7aa3923e",64897:"cce8d63d8328006e",65025:"14560b13078a81f9",65041:"8b63f1cf26b6fbd3",65054:"2018d452548b7422",65065:"0a6ab10891a1b8d7",65110:"3ba36b503488ab86",65151:"918f9d8b4b18b3c8",65238:"317446ad20a3b9bc",65240:"a5dd9f2f0cf32a2b",65242:"9aa8d5454debc1f6",65365:"802bea12eb1187c8",65398:"006b02d5c01ee33a",65466:"57c9734296a130d5",65469:"fb40c379ab313343",65471:"613b503475a7dbf7",65477:"7431b3711c1de281",65556:"1d2a4342601cd93e",65647:"38676e301bdb8c24",65665:"0b4064f0448cb753",65707:"cfc58054f832af2d",65748:"70d5d398a36564ab",65758:"4bf2af2625b81616",65844:"53ab5a9ecf1aa1e2",66073:"75ded2057cbca0a0",66129:"2eed319d4038d7e8",66144:"d4acb8f69e33d60f",66152:"5965547e741d272d",66167:"782638e1a29c16c6",66204:"33756fdcb7c35434",66235:"dab048e55e2fc513",66263:"e048a045958a5fdb",66435:"1b72fc1b6c11998b",66467:"22df382703e2982f",66475:"11c2596c699347fd",66525:"082182495c665fab",66610:"5e4b3a6e001b87f4",66693:"f24f7e304a5343a9",66694:"101b056674f92445",66725:"4894e0f5d25b0c38",66736:"b065fcd5ca759649",66761:"539203b08a6a1500",66833:"f99eee645e47a00a",66894:"be23389656c2c98d",66953:"706c2e58f13a2e10",67008:"f5a073b28f10e74b",67083:"03d5101890427ef0",67103:"15c08428a4a7c53f",67131:"9d8d5908ca2cd96a",67289:"38d7dac49bd0d567",67326:"b3305b17f0040fb0",67368:"7c39651e7529fb7d",67409:"1b18d3eede07483e",67417:"204a147c2a9d91ee",67442:"17046130ce6af366",67450:"fad2e6787e1a62f0",67526:"9a4686ffcc92e860",67569:"963edd500ed061ca",67658:"269ff8f0114fa28b",67676:"5a4d705678870c8b",67681:"dac96377d260a374",67742:"2494e80cf6b331e7",67767:"c04df6237007c37c",67769:"b4065ce234b050b9",67785:"2a0b022238990a40",67847:"5fe156aab79ee65b",67883:"21f866c30b2ea0d2",67949:"c54fdcff5e41ede1",67960:"680b82d248229deb",67973:"8342951b542c0c04",67977:"de9158f8f675b9ba",67997:"528e9aa44eb6631d",68054:"e1e8339d5fbaf36d",68074:"55ebe37845094fe6",68304:"58e9971018b6764e",68312:"64e4f992a92bfbd2",68341:"7591b50248fae4ca",68400:"24e851150f2bc3ff",68413:"27e94e1d76476846",68472:"0d662b6cb36053e8",68557:"4efcbfe9e2ec4d03",68597:"433890fc1db0d84b",68640:"5c68207d6214c50d",68677:"b8518eef75d8e23c",68722:"087662f1d80c3ae7",68734:"4285f4aba5c7091a",68740:"e946be0a9d441b51",68746:"7b951f8c9b7739e3",68778:"eaf9a3ab0c9162c9",68781:"3f6554b7e1ad8b1e",68865:"6d1491c44a1a41dd",68880:"02371e21ec32d798",68935:"b06c4205cb09a607",69006:"2d8c14f0841fe736",69081:"9c627690e570e92e",69085:"b40ca8b4124a3e2e",69120:"6fd78b5e9f0aad19",69144:"bfcea90011a587af",69177:"91477658568b49a6",69338:"f53c7b335e91ac1f",69380:"ab4306022ab8f52a",69432:"f5ad006b9489f83c",69482:"f725c8bfd7c1e1bd",69541:"af2b2ce910398902",69545:"89638316146ba79f",69621:"96423390e8ce2096",69622:"469658295dd755cb",69971:"3c57934fa488ba5e",70041:"dbcece7a1f350ca0",70152:"9296b023cd5a7c24",70175:"c9fd9101b456abe6",70182:"71d1152411b00ebe",70200:"95fd510514cd9f75",70225:"90e8aaa50e67765e",70245:"7cb423eca2f3b287",70279:"c91d1b2a00a6e118",70290:"9dac9e673db681fb",70293:"38bb02410c1655a6",70326:"ccab95ddca022125",70357:"7e6ac10c9bce1253",70421:"6c49d4c6d7ea31f1",70542:"8d4044d5bc49fada",70602:"512b63f20e41d1b3",70706:"556357ada58213f7",70716:"6581a878531328cc",70723:"c18befa3ee31c7a4",70724:"2b9b5c2bf7397274",70881:"278872f40472aff9",70913:"7e695637676182b0",70972:"9821a333aaa60248",71021:"716bc98591da3af3",71216:"5ca0ae6371201739",71217:"66bd6d414919cb68",71401:"8f6c866b781ab1ad",71409:"90490b731ede84f2",71482:"09790091c0c3f2c9",71515:"e30f4ac20bf549f3",71678:"787b85b96b284ff9",71711:"513bffc6f5528c6c",71824:"675c53be15f4fd1f",71835:"0183e7f0334a04ae",71920:"61022785b5b8c4e6",71993:"126eda7380ff5748",72001:"09495f9c53ea4c08",72297:"28773b3ff4ceb9c2",72324:"3c126a375f54e025",72333:"b6aff61ca5afe63a",72479:"ea0ae637a9f1b99d",72501:"22b97173b7740125",72564:"f5b907b2b1afe710",72617:"88aaa8ad4d292b4e",72638:"1700ed50ec217338",72748:"8ef7b9ae60c44d21",72767:"c505d25348d6e29b",73051:"8fd38051b2e21edc",73142:"5899456c672e103b",73166:"7f2195506806b1ae",73170:"876b61cc938df046",73190:"a700bd3ef81d4cb7",73206:"0880239dd78269f2",73292:"53220e17253a09df",73312:"7332b516c52b3c44",73339:"f22749fa5862f18d",73523:"1b6ed16e18ec6ad4",73533:"d961f446103536f3",73676:"628ea538eb4ceb3c",73696:"906334b95fd10191",73717:"a8fe0f8fc9f1a404",73773:"12f6d5e28c150548",73792:"635640e1dbce576d",73795:"6fd9c8de5fafd02b",73804:"f591805d94474871",73806:"da853f1a9ce8a8b3",73826:"8c6ad5cc83befe0e",73836:"db33315862c84e1d",73851:"0f376963c2734793",73956:"d4e846369de1496d",73969:"676325c4ee93ef88",74120:"fba6696dfa90c0da",74135:"d5db4c47fd0edf99",74188:"26c8e5a1f032290a",74217:"f7b9ba081b6df44f",74224:"119c8c6e22f22773",74237:"88c63620153812b5",74249:"c1209df7cbe73c43",74282:"d59eed88e0ac47f8",74313:"c7f3b9e1bf15c36b",74322:"5b52c4dcd3b932de",74353:"3d0465b6163553ad",74403:"e433e806859acc18",74449:"a348f42748f6225c",74453:"b78569975a647ccf",74471:"8334e7f6ae327f34",74515:"a7ae8c42a2c635e0",74516:"8b352e08ddceae29",74574:"91242c0d052e07f7",74590:"74db8ce6dbe9869f",74604:"d2f29018d1bafbe9",74687:"e25f5c614aa51c15",74783:"f5dc822359f6030a",74786:"ffa35206b03cadf0",74801:"cf6beeb3305d19a9",74837:"576302269796c946",74847:"3d0fe4180cf6d4fe",74853:"10c5b57e913ba7c5",74863:"3209be44a6a18122",74896:"12afe50deb87ce39",74906:"bdc704478676b896",74917:"e25c57ec94557e8a",74934:"bb5b3591d1012f2b",75041:"0b4c956ab6dba806",75123:"b4f519ef6afd1d18",75292:"c2335d48ca7c8244",75294:"2f3fe0532e1c67a4",75363:"bd66ad5f5d89f925",75402:"99250866e36d6b36",75413:"b334f691e48610f9",75447:"7f4a8c7978402fad",75499:"1c23bfdf9dca1049",75503:"84d1df4b1c46e267",75504:"44dbf4ba4f13d500",75516:"6ca4a09d45a4686d",75519:"9c336be27115b2d0",75546:"4500632b2a3e599e",75558:"f90c35957f9f9ed9",75613:"cd5858ffd799342e",75667:"eb6d1957d965e764",75810:"9d5ab9d419a7c5b7",75833:"14ab703e9ba46293",75895:"a17cad90ca203a33",75925:"986eb631879d0061",76001:"fd6cf2d5fe904947",76003:"d7434a1aa9788e4e",76023:"30c7c7f5b9d71ae8",76102:"eee45b13021f74bd",76118:"b0f10c8c79ca03a3",76130:"f5d42f79106c5925",76138:"98cd23e9ab282a8f",76141:"eec2a03b0bfbaa3e",76205:"0af3975e9c5f2907",76240:"af3271f9cca712fd",76274:"3f99bcb7bc189eb5",76293:"aecb8662d29890f5",76317:"5310d9b5193e05c7",76327:"7a16e2ccd82001eb",76355:"6344194acbb9ef06",76370:"2d142b9212b2156b",76426:"6274e47bfe40ca72",76542:"f47213dd5239fe8d",76605:"e5b237060deea9e7",76657:"d8dee37774a6517d",76738:"4d53310c583b024a",76803:"4428aac6357dc5d0",76807:"a8fd57285a699757",76808:"7ff5ac0e2517f268",76912:"f26fe19b8c78169c",76940:"6becb4875b17e8dc",77060:"e706f31a0cbca2a1",77067:"4948b1552a7c5e9b",77153:"55501620cc68ba25",77159:"1e72f57ccdc89d95",77209:"6a27b5966dd7025b",77233:"86c35888c613f8ef",77285:"b65265af4f2e8612",77351:"6047bf5348f77547",77357:"ecb19d20d5d3bd2e",77412:"cdc38ee740ac7e85",77527:"be4072eaaa9dc708",77649:"5ffc776dcc0f5a01",77661:"c5ca3f1055db25a5",77747:"92c91cb8b2216aa4",77750:"160298fd926fbcad",77767:"c371b0c284bbbbf8",77772:"c8c80fa11be45816",77793:"ad9f00d9cb4d830b",77869:"33cd2bc0f962ad2c",77953:"beab67ad37acdc02",77999:"c726ae4e757cfe0f",78001:"b239a0d01a9a9760",78002:"9e2cefcd00ad78f1",78052:"a97cd9fc5c3dc275",78053:"4cf367ddf6bd97b5",78092:"45ea188707987bd1",78130:"f8a5ec6844352d7c",78220:"f23c5623022b355b",78334:"8a6639655cd2fcdc",78402:"21adb321bc17b827",78433:"e9c5ab9b70a3bef5",78456:"7c2f7663efeb129c",78537:"7c9f8e3f8647fdfe",78580:"013e2489e30b4c91",78594:"765d6787ce94b35a",78609:"414bd86988dfb200",78641:"90dcd7187b34b157",78729:"95c56eef4daf7a86",78746:"5c09f7b8eacff5fb",78755:"951eac775ab442ae",78768:"cb26ce5d90206bc7",78773:"f6f669ee86b6b1ae",78800:"71a64b99fd354f52",78832:"8924230d4c3cd6d0",78858:"77290e31fe388be9",78864:"89e49fbdccc5521d",78866:"11b25efe26dda06a",78981:"5fb4359db2d70579",78994:"9a536b84764d7732",78996:"0e3e73f06c4c936a",79010:"1c84f445dedc775f",79019:"fc706d3b0084d41f",79065:"1cca820c9c7ac3ef",79088:"905ae3ad8a61c5af",79104:"053b1b064b86a9e9",79297:"4188c1e161a9fe33",79316:"2d0576c34958d077",79355:"6ded0882e66045f9",79455:"3b6b9b2f44a9ab68",79506:"63e0301021f9d86e",79629:"80c8adaa748cafa2",79737:"33cc85efd8fed74e",79754:"72b44628fc439ad2",79932:"262295f7d04a970b",79957:"b9b51c1111709536",80016:"61ecfcc9acb3f158",80052:"9de1cc5ac850f8ee",80093:"76c731907a915a01",80117:"7df66d3bfc8e4f98",80127:"54854664d0553cb1",80129:"6a3bced9ebef4983",80184:"1f5587aba0fda4e7",80243:"04d0b0e875b11453",80253:"d7d3118cfafa99f9",80262:"d7f0b30602fc484d",80282:"d36fd8f338418563",80293:"200d047310b14c67",80414:"78ba57012933a82f",80419:"ae775e110aaf41a6",80473:"03b4b53de46b6a71",80540:"f3fb877fd438a4ff",80570:"0bd1ffe95bf94cf3",80574:"3f257f92dbc802db",80648:"0541fb0976fee952",80699:"9d341196cb30348d",80839:"55947927ddea5ec4",80956:"9cd053edc95d405f",81e3:"6b4bd322749f23f2",81102:"57ff9e15acc250f9",81148:"b42b4aa0159363d4",81205:"df95cef7b3a8919c",81222:"1716206613ca1edf",81249:"577400194cbfc0f6",81293:"8acfd8ca93527f44",81381:"b93d6a324470f2ad",81391:"578ca9ab01717b96",81439:"acee9d86ac425369",81469:"0d49727c2703137f",81516:"04d17bbe7a39e070",81565:"2a0e8d05f417a57d",81641:"50449f9ea7f68583",81647:"efa4bdd10c8db238",81683:"bb947ce2793c19f3",81694:"cb0b256f195c9945",81706:"75a56f3e9fce2c87",81783:"e20f60e1c69e7eb4",81842:"914938b742713af3",81879:"4b736d7221003b8d",81897:"04551db5ebc9d58c",81916:"12fb37a67ebc7c0f",81933:"7e6ce09f77a375e9",82023:"8ca812cd124b8815",82080:"c5bfdaa6a72f2f89",82098:"1bc9b5f788b646bd",82117:"45e437c22c792b96",82222:"706cfae3897a1429",82271:"5ef0cae13a80eed9",82290:"19c5871bda10f3d3",82329:"4cd11d5b7d19724b",82401:"9083a388c48ba1f1",82418:"fca3e0044dca472c",82522:"1657fc0da97331bd",82703:"a8325b9c339e7091",82722:"62b26636f6c25e22",82749:"390b85c6d348c624",82754:"3dc5bc8ab39b70ab",82831:"b841ee2238334519",82846:"e082ede71d7f7c95",82856:"0adef60ddd8648e4",82901:"cab88efd212cfd52",82922:"f3cc9d1ca0067515",82989:"e7fef1ef7d2af3bf",82991:"1ef215d5f906e3e6",82998:"aae1b55b1f082803",83017:"d507dce2f0a54a0b",83028:"2fa62486fd65a77d",83059:"2660c2aa9e58e687",83062:"0b5220233ce470e3",83107:"bf6afd5ea1a0290b",83110:"0d352c89b8e30b89",83226:"de435b5a41c7dbb6",83240:"4fe5204d2e91bf0a",83266:"f94e32efac63a9b0",83278:"90219142884bc856",83393:"35e3bb5a2700148f",83400:"bc18455adf9f7aaf",83423:"b51d15c4d390d989",83438:"6af021bd5aa45e8b",83483:"8dc8c1e5e0fb6953",83549:"354552e1b3af406c",83593:"31bbc3378cd3d24f",83619:"81fd9ab290ca9015",83654:"c765702e1358d88b",83663:"dbcf3a6fd9c23f2f",83691:"48a36e499afed143",83695:"71dca5b0bfa06ba1",83772:"f5f7a911f630e6e0",83795:"8b8fa7c15743ae9e",83819:"08959061b5dbb531",83836:"7b422d92f98af12f",83906:"b4b52d567e8a5266",83992:"c9b5be380d2e5dfb",84004:"5b2f3017c2a8fe41",84021:"ef2beaf015a2ecfc",84042:"e55c4cd21c13ac78",84063:"271c188789ec7aad",84091:"d6111fb34b2a6075",84197:"0c7aed9daa8d1e8d",84226:"c7700621ed2107b3",84265:"811faf6d7d3a595e",84274:"296c70f3bd24b669",84335:"7dc560a3c23bb2fe",84399:"3fd74f763be859f7",84441:"4a4f3fa31b2a4014",84517:"a8802ed9bdec6498",84540:"aedbae12f79e673e",84548:"90becb4db100b2ae",84564:"b14639b735022ad8",84586:"209accca7dc7e5e3",84593:"894d91fa6666138f",84615:"f278bd3bad388d93",84765:"144d20a8a79db4e5",84766:"bcf8521f4097ef81",84787:"4aaafddacd1b3cfe",84836:"ab1525b6148d574e",84843:"858ba617e60d36a4",84885:"901a43520067c519",84975:"8bd0b145e1263c6b",85077:"0b42ea5f6efe9575",85108:"3053ade234620a27",85256:"1a4bf8ac256f2168",85333:"41cf5c1c0b75a9e7",85340:"4d51f6bb889bc50f",85358:"fb0f455754422f2d",85381:"ea36131c83bca8dc",85421:"366b71803698ecff",85470:"33ad1a3bc48393df",85483:"f26a71f3de46107c",85503:"2a11fe9979b719c7",85550:"818d6e97af25742c",85552:"2121f0fa4567b0ed",85565:"3b8705a091174505",85608:"9c6393789f571966",85843:"d631ef72e4903af9",85869:"f29ee3090935ee38",85991:"07e47e8a0c547671",86007:"3ae10b98de24e9a8",86018:"38434e5d4b691ac8",86060:"e214e47a5bcd1e1c",86146:"9472b330bb68918f",86194:"20ec9d3747db863b",86205:"b53130835e0b0a42",86347:"f7717c99c44a22e9",86358:"dd243e76bf151fb5",86395:"f9444a635250a994",86549:"196e6d971af6d6f3",86608:"bef61f0fd0b44823",86639:"787e055b8cdb4e86",86649:"9957173c0a87c3a2",86793:"523c26054a35f229",86798:"df898212038eaf1f",86855:"a601752754a50ebc",86910:"064d78633619328d",86967:"2ea7ca3a79ed19ea",86984:"2f494f79822212fe",87024:"b649c52c73225512",87227:"69add22eb87ea19a",87237:"36423077f605ffae",87309:"d7ed5f0eb213236e",87310:"26a0681c6efed29a",87311:"e252b609f2644621",87314:"b5b55a63d4f0d92d",87329:"290153ffb84816a3",87408:"618f3cefc9386357",87417:"c7667c7f0ed94043",87468:"a90d056a06bc0c90",87480:"918e2bdfaa6fc591",87562:"e182fecc08882bd2",87574:"b2065aef6a2bc620",87598:"dd517e46d13a27ae",87644:"cea8f6e7b33f2d9e",87808:"b89af5f46371c051",87844:"df8e628bc4847273",87851:"1177ed31d6d5f3f3",87921:"247f271e3051e6f9",87927:"639f6b612796ba1a",88026:"c1f13998b398f109",88059:"a55bd6eae202c122",88137:"ff3d7d5182cae33d",88146:"051603a685c15306",88207:"03f816bf78756633",88216:"9804975385ac8725",88282:"93ff1ee00690670e",88314:"cb6aff4598fe99ef",88357:"fa786c7be9042fb9",88409:"84f991657e02e6d3",88437:"c47ac11f3919eeba",88441:"35867a3351204002",88458:"7be54b28593cdccb",88478:"68dcf5620003030c",88531:"0d3dd623d992a8f3",88540:"b4468be972816bf7",88542:"9d9487bfcd46aec1",88558:"522b7cb6cb146df7",88591:"68f26add10c5944c",88612:"e0487c270780b25c",88664:"cbe5a7dafc22d882",88681:"cda30d3d3d297b4e",88725:"84808d8cabcdff95",88729:"c944131bfee633c9",88787:"1aa9bfacf1a544be",88811:"e3ca53a22892fa24",88876:"721d327790912fcf",88901:"c4179343a525964a",88909:"8c3ac1fff98f1361",88910:"8d04a992c7809025",88919:"686f3ef944a16a31",88927:"c246514489594917",88975:"b2d25ab5ef66b142",89043:"6a8b1c7ee28e85d8",89109:"ddae1efd1884055c",89118:"1c1584adab9a2d6c",89139:"c5ada61cb6ae51ee",89167:"21b256ceecd4739f",89183:"a1fedffe535c5aa3",89197:"82302255940dfe78",89275:"78b7cba72647bf27",89361:"abc1c8b62b605e6e",89430:"0d37543c7346c9dc",89483:"ababa19c92902b5a",89509:"58e224376e5683ca",89544:"b6bdb74ae3a4b563",89649:"1f5f9c86c67ea23f",89676:"9538badcf7a61b3e",89683:"dfa342c45d4b9ef2",89829:"6c05559feb7d4bd3",89847:"b9e265634c79aebb",89903:"a240d77129b75946",89905:"dc091e4b699f7733",89907:"91237b3a470642ac",89962:"9d53c5a8af8090ef",90070:"618246dc0e57b892",90166:"2263c72c5c45fe08",90170:"b90d6dfa91d66210",90189:"56be1aeac40cd9c0",90224:"d070793076b9ed49",90265:"fc2136391d257890",90477:"62ab89269edf1435",90565:"776793040ad1c3d2",90580:"0bf17814a763ce15",90631:"6012f02d4b85206f",90658:"a3ffb3974237a638",90720:"a5317542b0b496ad",90864:"f654dee26bdd176d",90928:"5f8bbfd677c27b66",90963:"85a2e3d80a108ab5",91025:"83212841e8315709",91029:"a65076d1aecba81f",91036:"e3471b894c8be286",91041:"bb49cc2ada1d6be1",91068:"59d1b32170d0a9b5",91138:"7863fd9e780e97b6",91143:"ee8fab1b08243a9b",91282:"c9106198a46e1a37",91443:"8e71680e865df235",91487:"d7748689803fee38",91494:"7010fc9d11e7b523",91496:"210cd649336903ef",91504:"9731b8c135412c50",91510:"e4dc07869d78a7f1",91596:"544a96498b6bf4d0",91607:"64dfae68fc35c661",91643:"d528d8af14c568c1",91716:"1d4fb6276c16c26a",91736:"a1949a67097b8bde",91789:"f70f829c02e81d03",91910:"0cf25cf411bd9dde",91920:"724cfa74ad24ca1b",91929:"ea51d58b24895566",91941:"1ba5d1480e20dc41",91942:"efa5db29ec96c4bc",92066:"77ea65bf6d84bfca",92186:"c647abdb4daf87bc",92213:"a9bf83d31f07296f",92278:"f0dd6e335183f4c2",92326:"cf85a12f7b2b6c79",92444:"b7d951fdf5e968c8",92521:"4cc2021bb0309a0e",92525:"ae8288b3c771b063",92574:"f936a0d54eddc4ac",92680:"3b74626770daafd0",92712:"2115645d6443f38b",92729:"4d772255af17ec03",92784:"1da42ebf03d254a6",92819:"9552486da352cf25",92923:"cd36a5dce5b772fd",92935:"92a815212703dbd6",92966:"acd7cee86d8ce668",93007:"83c7ba7187fd01a3",93048:"dd7f319ff610908c",93050:"d21f6fbed5b90dc7",93121:"67a174f66e1f305b",93186:"ca7608fbc11cec44",93200:"79e0e098c1696f45",93202:"00e7d362254e1fe2",93241:"7193d1eb9be3f544",93288:"627cd3d11f6785d4",93295:"6a5f2e01efc8eed4",93300:"5f34da8f473e76aa",93337:"944719161631a31b",93376:"f377da2da0deba00",93393:"381f398cffdf5592",93400:"6d4c313bc639b55d",93438:"b1ddbcc276c582ed",93446:"6e9ba4c917b20ec6",93467:"1bba870c151aa923",93553:"bdba2c1ba177249d",93820:"62a7a46ecfef6ec3",93844:"3554aeabe7bc66f9",93870:"13b06f7d0eebc63b",93902:"786d3f00b5587a1f",94057:"52e2a303dcc336c5",94061:"78a9f3b5703a9e56",94101:"aca71cfa12bbe5e5",94159:"79d7d1cca5c2cb27",94166:"171c5dbe496479c9",94219:"3b7cc689d9c58202",94236:"8a88687572c4e487",94248:"ae9152520e4b496c",94253:"6a28804924e4b1d6",94259:"87c416e448122f8d",94320:"e2e8b22e41ce3c48",94411:"9ffa87b044cc7029",94421:"572cbf805cc6f11c",94444:"34c84f21307d3c51",94462:"e23c930316d3d496",94476:"d2e413c50ae815ed",94526:"39c2e22f7d5f3ea3",94543:"6228bd6b615f75b3",94598:"df2e00c72ef805ea",94601:"263849c70a0fb950",94637:"94855136cc3b4768",94658:"63725b5a6616691e",94766:"38e15b430d3dc08d",94772:"2e03f72c44dc0be6",94777:"1a51b82a19ff8213",94779:"b28404230a76ae08",94819:"e22dde7925894d51",95002:"c298f641ab392898",95014:"4cd65cb4359af9be",95052:"e91d1649435407cd",95121:"27e599d72978197e",95268:"807965e575eb97ba",95339:"59f9a444223bc905",95341:"f7efe37f29f5ebe2",95487:"cc04ffb0595794d8",95571:"83a6c7ed069c49fe",95589:"4590342c3f65fb85",95595:"10d709fe97d54c48",95691:"a42881c9a49fadb6",95768:"76d6c158aa773dc1",95772:"2ef487b3e67047ec",95787:"725e787dd6aa0447",95830:"550959e59a2fb463",95844:"b3540bccd42b6f2b",95859:"341a43d49d3c4c62",95972:"7b133df6aac12ee4",96007:"9897c64b4aac294e",96008:"65b410111a9be352",96057:"348d21adb04fa30d",96079:"65a14cf612a59245",96105:"5a413866a97e141c",96106:"b7c6ddccea049bda",96137:"26029f9891fe9fe3",96148:"02722521f4e7217f",96149:"737d498f14939d59",96317:"8a9ae2f6a7ac6e1c",96334:"7e7657f64ec4e22b",96362:"d356064f3c6686fb",96380:"6e6ad0f74962ab7d",96386:"89cd126b9033712c",96387:"18669412d9cb16de",96449:"5d3e00c4129d576c",96555:"a8165809c475abd0",96624:"61d8009f1fa089bc",96650:"2437571dfdde5d22",96656:"b26d37192cc43169",96696:"081b673d49aae245",96698:"bcba842fbe216b9a",96708:"ebfa4e29433a9388",96728:"2dece8fa375b50d6",96793:"ae4b6498f9f516da",96802:"e1b168facc3a4002",96836:"520059bc0c416f04",96848:"12d38cffc1480ac3",96893:"6bd54dff63d387eb",96978:"e91c4a045d610690",97014:"7ccfa17196d01145",97119:"5466a86602c3fd91",97130:"816df651607b7cc2",97202:"6ae1bb699b084bed",97282:"fea293aee45f40aa",97323:"61f8cd1363154ee2",97423:"e84672897691cfa2",97436:"11e01ed4235de8c7",97507:"5e8fe4e75cf9b8f6",97526:"0dc476c930de42e9",97533:"abc4fb3ea7927e72",97548:"d903df3a32c6e6a4",97550:"2b42c2e790c65f08",97554:"b11a6cd5077d002b",97596:"11df9a40a27d7464",97606:"9bddcaa4b0cdb63f",97620:"213453a4707d06ae",97686:"6e7a864bcf4e0989",97704:"1d9279d6ecaad525",97725:"1198f3bb735e9c9e",97758:"11ffdd2cfca07379",97778:"06e52f92ecc2a3ff",97782:"a83e9c2b83140dd5",97828:"452c4e95b41e8813",98068:"15537f03d8a37932",98163:"f30690176532f4cb",98167:"7bb7d304c45c4e5d",98170:"b3444955e81bfb79",98176:"a9114e331900cf78",98217:"e6fb1900c822b390",98261:"f984284e4c72cd64",98278:"8466a8475d43b4b6",98314:"770c929ed1c84640",98368:"6cd1b2ec4bc8b546",98436:"b98c0914dfde20b6",98495:"d73dc8b2a8eed272",98498:"980db0b587b44e2b",98629:"529a24a415778253",98654:"6956247cea3cd104",98696:"030a6928779dad23",98722:"cab6e39697395e0b",98750:"ebb7ed4cdf08de4a",98787:"7d122a771e5ba316",98805:"c8bf6946a5d7e210",98842:"df43ec52c9f03460",98857:"39f891aace0186c3",98865:"9db9ead3d86f252c",98872:"f494d5eb58f2f341",98889:"bb081c91a939604d",98972:"05bb3093365759df",98993:"d0221c7f9c5fd0d0",99030:"a6b0534891be5478",99110:"b3a84561ffc4c716",99182:"c9f8a2a70271e6fd",99240:"e31fae6ad0bf23de",99290:"6c53ef79120c00ab",99306:"7f1e2dc5d6c12971",99329:"084365f52b6d4fc6",99334:"5cdbb44918fe4a76",99367:"2ad09b68b16103f5",99383:"e4444ce39e286b66",99447:"40de730c600e978f",99592:"a1b56bed91e6fde6",99598:"f0ab94c0b5ee33d6",99617:"989b26d754c4b1a1",99648:"f7cd0cb8686f04e2",99684:"93c28edaa2235d46",99710:"cc9d59f5f0d9a73f",99793:"306190d6d35b372d",99856:"dd010b28e7caa1a0",99927:"a607f6d95bab8fb3",99928:"960aab57c6030b3f",99951:"3343d0b60bcd6a06",99981:"c2f01528b220e481"}[e]+".js"),__webpack_require__.miniCssF=e=>{},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),inProgress={},dataWebpackPrefix="@msteams/multi-window:",__webpack_require__.l=(e,t,n,i)=>{if(inProgress[e])inProgress[e].push(t);else{var a,o;if(void 0!==n)for(var r=document.getElementsByTagName("script"),s=0;s<r.length;s++){var l=r[s];if(l.getAttribute("src")==e||l.getAttribute("data-webpack")==dataWebpackPrefix+n){a=l;break}}a||(o=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=60,__webpack_require__.nc&&a.setAttribute("nonce",__webpack_require__.nc),a.setAttribute("data-webpack",dataWebpackPrefix+n),a.src=__webpack_require__.tu(e)),inProgress[e]=[t];var c=(t,n)=>{a.onerror=a.onload=null,clearTimeout(d);var i=inProgress[e];if(delete inProgress[e],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach((e=>e(n))),t)return t(n)},d=setTimeout(c.bind(null,void 0,{type:"timeout",target:a}),6e4);a.onerror=c.bind(null,a.onerror),a.onload=c.bind(null,a.onload),o&&document.head.appendChild(a)}},__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),__webpack_require__.tu=e=>(void 0===policy&&(policy={createScriptURL:e=>e},"undefined"!=typeof trustedTypes&&trustedTypes.createPolicy&&(policy=trustedTypes.createPolicy("@msteams/multi-window",policy))),policy.createScriptURL(e)),__webpack_require__.p="https://statics.teams.cdn.office.net/teams-modular-packages/hashed-assets/",(()=>{if(void 0!==__webpack_require__){var e=__webpack_require__.u,t=__webpack_require__.e,n=new Map,i=new Map;__webpack_require__.u=function(t){return e(t)+(n.has(t)?"?"+n.get(t):"")},__webpack_require__.e=function(a){return t(a).catch((function(t){var o=i.has(a)?i.get(a):1;if(o<1){var r=e(a);throw t.message="Loading chunk "+a+" failed after 1 retries.\n("+r+")",t.request=r,t}var s="ts="+Date.now();return n.set(a,s),i.set(a,o-1),__webpack_require__.e(a)}))}}})(),void 0!==__webpack_require__&&(__webpack_require__.p=__webpack_require__.g&&__webpack_require__.g.__webpack_public_path__||__webpack_require__.p),(()=>{var e={40179:0};__webpack_require__.f.j=(t,n)=>{var i=__webpack_require__.o(e,t)?e[t]:void 0;if(0!==i)if(i)n.push(i[2]);else{var a=new Promise(((n,a)=>i=e[t]=[n,a]));n.push(i[2]=a);var o=__webpack_require__.p+__webpack_require__.u(t),r=new Error;__webpack_require__.l(o,(n=>{if(__webpack_require__.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var a=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;r.message="Loading chunk "+t+" failed.\n("+a+": "+o+")",r.name="ChunkLoadError",r.type=a,r.request=o,i[1](r)}}),"chunk-"+t,t)}},__webpack_require__.F.j=t=>{if(!__webpack_require__.o(e,t)||void 0===e[t]){e[t]=null;var n=document.createElement("link");__webpack_require__.nc&&n.setAttribute("nonce",__webpack_require__.nc),n.rel="prefetch",n.as="script",n.href=__webpack_require__.p+__webpack_require__.u(t),document.head.appendChild(n)}},__webpack_require__.O.j=t=>0===e[t];var t=(t,n)=>{var i,a,[o,r,s]=n,l=0;if(o.some((t=>0!==e[t]))){for(i in r)__webpack_require__.o(r,i)&&(__webpack_require__.m[i]=r[i]);if(s)var c=s(__webpack_require__)}for(t&&t(n);l<o.length;l++)a=o[l],__webpack_require__.o(e,a)&&e[a]&&e[a][0](),e[o[l]]=0;return __webpack_require__.O(c)},n=this.webpackChunk_msteams_multi_window=this.webpackChunk_msteams_multi_window||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),chunkToChildrenMap={56904:[89962,18545,58254,81391,86967,43458]},__webpack_require__.f.prefetch=(e,t)=>Promise.all(t).then((()=>{var t=chunkToChildrenMap[e];Array.isArray(t)&&t.map(__webpack_require__.E)}));var __webpack_exports__=__webpack_require__.O(void 0,[62967,56065],(()=>__webpack_require__(164995)));__webpack_exports__=__webpack_require__.O(__webpack_exports__)})();